<p-toast></p-toast>
<!-- Forgot Password Popup (top of page) -->
<!-- <div class="forgot-password-modal" *ngIf="showForgotPasswordPopup">
  <div class="modal-content">
    <button type="button" class="close-modal" (click)="closeForgotPasswordPopup()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>
    <h2 class="forgot-heading">Forgot Password</h2>
    <div class="forgot-box">
      <div class="forgot-info">If you have forgotten your password you can reset it here.</div>
      <form (ngSubmit)="submitForgotPassword()" class="forgot-form">
        <input type="text" [(ngModel)]="forgotEmail" name="forgotEmail" required placeholder="Enter Email/UserName" class="forgot-input" />
        <button type="submit" class="btn forgot-btn">Send OTP</button>
      </form>
    </div>
  </div>
</div> -->

<!-- <div class="forgot-password-modal" *ngIf="showForgotPasswordPopup">
  <div class="modal-content">
    <button type="button" class="close-modal" (click)="closeForgotPasswordPopup()" aria-label="Close">
      <span aria-hidden="true">&times;</span>
    </button>

    <h2 class="forgot-heading">Forgot Password</h2>

   
    <div *ngIf="!otpSent && !otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">If you have forgotten your password you can reset it here.</div>
        <form (ngSubmit)="submitForgotPassword()" class="forgot-form">
          <input type="text" [(ngModel)]="forgotEmail" name="forgotEmail" required placeholder="Enter Email/UserName"
            class="forgot-input" />
          <button type="submit" class="btn forgot-btn">Send OTP</button>
        </form>
      </div>
    </div>

   
    <div *ngIf="otpSent && !otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">An OTP has been sent to your email. Please enter it below.</div>
        <form (ngSubmit)="verifyOtp()" class="forgot-form">
          <input type="text" [(ngModel)]="enteredOtp" name="enteredOtp" required placeholder="Enter OTP"
            class="forgot-input" maxlength="6" />
          <button type="submit" class="btn forgot-btn">Verify OTP</button>
          <button type="button" class="btn resend-btn" (click)="resendOtp()" style="margin-top: 10px;">Resend OTP</button>
        </form>
      </div>
    </div>

    
    <div *ngIf="otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">OTP verified. Enter your new password below.</div>
        <form (ngSubmit)="resetPassword()" class="forgot-form">
          <input type="password" [(ngModel)]="newPassword" name="newPassword" required placeholder="New Password"
            class="forgot-input" />
          <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" required
            placeholder="Confirm Password" class="forgot-input" />
          <div class="password-match" *ngIf="newPassword && confirmPassword && newPassword !== confirmPassword" 
               style="color: red; font-size: 12px; margin-top: 5px;">
            Passwords do not match
          </div>
          <button type="submit" class="btn forgot-btn">Reset Password</button>
        </form>
      </div>
    </div>
  </div>
</div> -->


<div class="forgot-password-modal" *ngIf="showForgotPasswordPopup">
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close-modal" (click)="closeForgotPasswordPopup()" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
      <div class="modal-icon">
        <i class="pi pi-lock"></i>
      </div>
      <h2 class="forgot-heading">Forgot Password</h2>
    </div>

    <!-- Step 1: Send OTP -->
    <div *ngIf="!otpSent && !otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">Enter your email and we'll send you a verification code to reset your password.</div>
        <form (ngSubmit)="submitForgotPassword()" class="forgot-form">
          <input type="text" [(ngModel)]="forgotEmail" name="forgotEmail" required placeholder="Enter Email/Username"
            class="forgot-input" />
          <button type="submit" class="btn forgot-btn">Send OTP</button>
        </form>
      </div>
    </div>

    <!-- Other steps remain the same -->
    <!-- Step 2: Verify OTP -->
    <div *ngIf="otpSent && !otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">An OTP has been sent to your email. Please enter it below.</div>
        <form (ngSubmit)="verifyOtp()" class="forgot-form">
          <input type="text" [(ngModel)]="enteredOtp" name="enteredOtp" required placeholder="Enter OTP"
            class="forgot-input" maxlength="6" />
          <button type="submit" class="btn forgot-btn">Verify OTP</button>
          <button type="button" class="btn resend-btn" (click)="resendOtp()">Resend OTP</button>
        </form>
      </div>
    </div>

    <!-- Step 3: Reset Password -->
    <div *ngIf="otpVerified">
      <div class="forgot-box">
        <div class="forgot-info">OTP verified. Enter your new password below.</div>
        <form (ngSubmit)="resetPassword()" class="forgot-form">
          <input type="password" [(ngModel)]="newPassword" name="newPassword" required placeholder="New Password"
            class="forgot-input" />
          <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" required
            placeholder="Confirm Password" class="forgot-input" />
          <div class="password-match" *ngIf="newPassword && confirmPassword && newPassword !== confirmPassword">
            Passwords do not match
          </div>
          <button type="submit" class="btn forgot-btn">Reset Password</button>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="login-wrapper">
  <div class="login-box">
    <div class="logo">
      <img src="../../../assets/Images/Black Icon.png" alt="EMS Logo" />
    </div>

    <div class="avatar">
      <span class="page-title">Employee Management System</span>
    </div>
    <form (ngSubmit)="login()">
      <!-- <div class="form-group">
        <label>Username</label>
        <input
          type="text"
          [(ngModel)]="username"
          name="username"
          required
        />
      </div> -->

      <div class="form-group">
        <label>Employee ID / Email</label>
        <input type="text" [(ngModel)]="email" name="email" required />
      </div>

      <div class="form-group">
        <label>Password</label>
        <div class="password-container">
          <input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="password" name="password" required />
          <button type="button" (click)="togglePassword()" class="toggle-password">
            <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
            </svg>
            <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.442-4.362m3.31-2.478A9.956 9.956 0 0112 5c4.477 0 8.268 2.943 9.542 7a9.973 9.973 0 01-4.422 5.255M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3l18 18" />
            </svg>
          </button>
        </div>
      </div>
      <div class="form-options">
        <a style="margin-top:-13px;" class="forgot-link" (click)="openForgotPasswordPopup()">Forgot Password?</a>
      </div>
      <div class="form-options"></div>

      <button class="btn login-btn" type="submit">Login</button>
    </form>
  </div>
</div>