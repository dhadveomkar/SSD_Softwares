(()=>{var e=document.currentScript;define("7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0",["react","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@msinternal/sp-component-utilities","@msinternal/swc-helpers-bundle","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c)=>(()=>{"use strict";var d={891:(e,t,n)=>{n.d(t,{Up:()=>i,XA:()=>r,Yg:()=>s,jF:()=>o});var a=n(676);function i(){return a._SPKillSwitch.isActivated("f3b11671-f43f-4e6d-8d17-b66bc86f4838")}function r(){return a._SPKillSwitch.isActivated("b0861b96-5b5e-484d-9bca-5f32b00504ac")}function o(){return a._SPKillSwitch.isActivated("f6d97b40-3ab5-40c6-8152-aaeff09f013c")}function s(){return a._SPKillSwitch.isActivated("62be4d8d-22b6-4f17-a78c-7dc8c6c234b4")}}
,424:e=>{e.exports=r},676:e=>{e.exports=n},207:e=>{e.exports=a},414:e=>{e.exports=c},141:e=>{e.exports=i},718:e=>{e.exports=o},592:e=>{e.exports=s},959:e=>{e.exports=t}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={exports:{}};return d[e](n,n.exports,u),n.exports}u.m=d;var f,p,m,_={"654":"pgYfSyX8LVb6fJj2V44v8LSyot6tacx5yYlKrWdnLno=","863":"ijgNsBCHvcQRmm0A8AzDJnuwUrLt0zwO+Vf3yGcFAso="};u.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return u.d(t,{a:t}),t},u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.f={},u.e=e=>Promise.all(Object.keys(u.f).reduce((t,n)=>(u.f[n](e,t),t),[])),u.u=e=>"chunk."+(863===e?"live-persona-card-loader":e)+"_none_"+{654:"981abbed989127a74868",863:"c1a210c0195847832bf7"}[e]+".js",u.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),f={},p="7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0:",u.l=(e,t,n,a)=>{if(f[e])f[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==p+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.setAttribute("data-webpack",p+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(_[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}f[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(m);var a=f[e];if(delete f[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},m=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m=e?e.src:"",u.p=m.slice(0,m.lastIndexOf("/")+1),u.f.compat=(e,t)=>{for(var n=function(e){var t={i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280};return{654:[t],863:[{i:"1c4541f7-5c31-41aa-9fa8-fbc9dc14c0a8",v:"1.22.0",m:408},{i:"cc2cc925-b5be-41bb-880a-f0f8030c6aff",v:"5.6.542",m:810},{i:"8217e442-8ed3-41fd-957d-b112e841286a",v:"0.35.83",m:519},{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:506},t,{i:"2e09fb9b-13bb-48f2-859f-97d6fff71176",v:"1.5.20",m:277}]}[e]||[]}(e),a=0;a<n.length;a++)u.m[n[a].m]||(e=>{t.push(h.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{u.m[e.m]=e=>e.exports=t}))})(n[a])};var h=u(414);(()=>{var e={541:0};u.f.j=(t,n)=>{var a=u.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=u.p+u.u(t),o=new Error;u.l(r,n=>{if(u.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)u.o(o,a)&&(u.m[a]=o[a]);s&&s(u)}for(t&&t(n);c<r.length;c++)i=r[c],u.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0"]=self["webpackJsonp_7d834519-e86f-4d2b-ad52-b9b35dab66f1_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var b={};return(()=>{u.r(b),u.d(b,{LivePersonaCard:()=>v,TopicCardHoverTarget:()=>y,bootstrapLPC:()=>h,openLivePersonaCard:()=>S});var e=u(592),t=u(959),n=u(676),a=u(207),i=u(141),r=u(424);(0,r.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);class o extends t.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);o._getDedicatedDomNode(t||1).appendChild(n)}}static _getDedicatedDomNode(e){o._alertNode&&document.body.removeChild(o._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),o._alertNode=t,o._alertNode}componentDidMount(){o.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||o.read(this.props.message,this.props.readingMode)}render(){return!1}}var s=u(718);function c(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}r.loadStyles(".l_oIYYJ_7m4Cd{cursor:pointer}.l_oIYYJ_7m4Cd:hover{outline:none}",!0);const d=JSON.parse('{"hT":"Opens Profile Card for {0}","dR":"Opens Profile Card","_Q":"Getting detailsâ€¦","Pq":"Topic {0}"}');class l{static isTenantAdminLightDarkThemeFlightEnabled(){return n._SPFlight.isEnabled(1723)}}var f=u(891);const p="SPPeopleWebPart";class m{getLPCLoader(){return Promise.all([u.e(654),u.e(863)]).then(u.bind(u,96)).then(e=>e.default)}}(0,e._ts_decorate)([(0,s.monitor)("LivePersonaCard.Load")],m.prototype,"getLPCLoader",null);const _=new m;function h(e,t=p,n="User",a){return _.getLPCLoader().then(i=>i.bootstrap(e,t,n,...l.isTenantAdminLightDarkThemeFlightEnabled()?[void 0,void 0,a]:[]))}const g="Mouse";class v extends t.PureComponent{static _isLivePersonaCardFlightEnabled(){return n._SPFlight.isEnabled(809)}static get livePersonaCardHoverTarget(){return window.LivePersonaCardHoverTargetV2}componentWillUnmount(){this._isUnMounted=!0}render(){if(this.props.disabled)return t.Children.only(this.props.children);if(l.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme&&window.LPC?.loadTheme(this._theme),n._BrowserUtilities.isMobileWebView())return t.cloneElement(t.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:{upn:this.props.legacyUpn,...n._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName}}}),onClick:()=>{}});const e=this.props.useSpan?"span":"div",a=this.props.disableClick?void 0:e=>this._triggerBootstrap(e,g),r=this.props.disableHover?void 0:e=>this._triggerBootstrap(e,g),o=this.props.disableHover?void 0:()=>{this.setState({shouldOpenLpcAfterBundleLoaded:!1})};return t.createElement(e,{className:(0,i.css)(this.props.className,"l_oIYYJ_7m4Cd"),onClickCapture:a,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:r,onMouseLeave:o,ref:this._ref},this._renderContent())}_renderContent(){const e={cardParameters:{personaInfo:{identifiers:{PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:this.props.topicCardProps?.topicId,...this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}},topicMetadata:this.props.topicCardProps?.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:(0,i.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode,...this.props.locationToOpen&&{locationToOpen:this.props.locationToOpen}},ariaLabel:this.props.ariaLabel,...!(0,f.jF)()&&{disableAccessibilityDefaults:this.props.disableAccessibilityDefaults}},tabIndex:this.props.tabIndex},a=Boolean(this.props.legacyUpn||this.props.topicCardProps?.topicId||this.props.upn||this.props.email);return a&&this._isLPCBundleLoaded()?t.createElement(v.livePersonaCardHoverTarget,{...e,onCardOpen:this._handleCardOpen},t.Children.only(this.props.children)):!a||this._isLPCBundleLoaded()||!(0,f.jF)()&&this.props.disableAccessibilityDefaults?t.Children.only(this.props.children):t.cloneElement(t.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?n.Text.format(d.hT,this.props.displayName):d.dR),"aria-haspopup":"dialog"})}_isLPCBundleLoaded(){return this.state.isBundleLoaded&&!!v.livePersonaCardHoverTarget}get _logScenario(){return this.props.clientScenario||"unset"}_updateBundleMountedState(e){this.setState({isBundleLoaded:!0},()=>this._manuallyDispatchEventToTriggerCallout(e))}get _clientType(){return this.props.clientType||p}get _theme(){return this.props.m365Theme}get _personaType(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"}constructor(e){super(e),this._isUnMounted=!1,this.openCard=e=>{this._triggerBootstrap(e,g),this._isLPCBundleLoaded()&&this._manuallyDispatchEventToTriggerCallout(c())},this._bootstrapLivePersonaCard=e=>!v._isLivePersonaCardFlightEnabled()||n._BrowserUtilities.isMobileWebView()?Promise.resolve():v.livePersonaCardHoverTarget?(this._updateBundleMountedState(e?.nativeEvent),Promise.resolve()):(this._loadPromise||(this._loadPromise=this._bootstrapCore(e?.nativeEvent)),this._loadPromise),this._bootstrapCore=e=>(a._TraceLogger.logVerbose(this._logSource,"LivePersonaCard._bootstrapCore"),_.getLPCLoader().then(e=>e.bootstrap(this.props.serviceScope,this._clientType,this._personaType,this.props.clientScenario,this.props.topicCardProps,...l.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme?[this._theme]:[],...!(0,f.Yg)()&&this.props.getLokiAuthToken?[this.props.getLokiAuthToken]:[])).then(()=>{this._isUnMounted||this._updateBundleMountedState(e)}).catch(e=>{a._TraceLogger.logError(this._logSource,e,"BootstrapLivePersonaCard")})),this._manuallyDispatchEventToTriggerCallout=e=>{if(!(0,f.Up)()&&this.props.openCardBySpaceKeyOnly&&this._ref.current)return(0,i.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),void this._ref.current.firstElementChild?.dispatchEvent(c());"keydown"===e?.type&&this._ref.current&&((0,i.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),this._ref.current.firstElementChild?.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});const e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),"mouseover"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableHover&&this._ref.current.firstElementChild?.dispatchEvent(c()),"click"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableClick&&this._ref.current.firstElementChild?.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}())},this._triggerBootstrap=(e,t)=>{a._EngagementLogger.logEventWithLogEntry(new a._LogEntry("LivePersonaCard",`${this._logScenario}.Trigger`,a._LogType.Event,{hasUPN:Boolean(this.props.legacyUpn||this.props.upn).toString(),source:t,isBundleLoaded:this.state.isBundleLoaded.toString()})),this._isLPCBundleLoaded()||(this.setState({shouldOpenLpcAfterBundleLoaded:!0}),this._bootstrapLivePersonaCard(e).catch(this._traceBootstrapFailure))},this._triggerBootstrapByKeyboard=e=>{"Enter"===e.key&&(this._triggerBootstrap(e,"Keyboard"),this._isLPCBundleLoaded()||((0,f.XA)()?s.ScreenReaderAlert.read(d._Q):o.read(d._Q)))},this._handleCardOpen=()=>{a._EngagementLogger.logEvent(`LivePersonaCard.${this._logScenario}`,"Open");const{onCardOpen:e}=this.props;e&&e()},this._traceBootstrapFailure=e=>{a._TraceLogger.logError(this._logSource,e,"LivePersonaCard.bootstrap")},this._logSource=a._LogSource.create("LivePersonaCard"),this._ref=t.createRef(),this.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1}}}function y(e){const a=n.Text.format(d.Pq,e.displayName||""),i=new URL(window.location.href).pathname.toLowerCase();return t.createElement(v,{ref:e.lpcRef,...e,ariaLabel:e.ariaLabel||a,...-1!==i.toLowerCase().indexOf("_layouts/15/")&&{topicCardProps:{...e.topicCardProps,topicCardMetadata:{...e.topicCardProps?.topicCardMetadata,hideFeedbackQuestions:!0,hideEntityAndContextQuestion:!0}}}})}async function S(e){const{serviceScope:t,target:n,persona:{upn:i,email:r,displayName:o,personaType:s="User"},behavior:c,openCardTriggerType:d="MouseHover",clientType:l=p}=e,u=new a._QosMonitor(`${l}.openLivePersonaCard`);try{await h(t,l,s)}catch(e){return void u.writeUnexpectedFailure("Bootstrap Failure",e)}const f=window.LPC;f&&"function"==typeof f.openCard?f.openCard(n,{personaInfo:{identifiers:{Upn:i,Smtp:r,PersonaType:s},displayName:o},behavior:c,openCardTriggerType:d}):u.writeUnexpectedFailure("Failed to access window.LPC.openCard")}})(),b})())})();