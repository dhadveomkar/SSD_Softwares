/*! For license information please see sp-image-edit-next_en-us_cbb36db1d5e6660496ef.js.LICENSE.txt */
(()=>{var e=document.currentScript;define("12e94922-76ea-4654-88ff-a149979a3d3e_1.0.0",["react","@msinternal/odsp-utilities-bundle","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@msinternal/sp-component-utilities","@msinternal/odsp-core-bundle","@microsoft/sp-core-library","@microsoft/sp-page-context","@msinternal/sp-rich-image","@msinternal/sp-ai-reach","@microsoft/sp-diagnostics","@msinternal/sp-fluentui-migration-link-bundle","@msinternal/sp-fluentui-migration-tooltip-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sp-webpart-shared-editmode","@microsoft/sp-image-helper","react-dom","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/swc-helpers-bundle","@microsoft/sp-lodash-subset","@msinternal/sp-webpart-shared","@msinternal/sp-a11y","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/sp-fluentui-migration-spinner-bundle","@msinternal/sp-fluentui-migration-callout-bundle","@msinternal/sp-fluentui-migration-textfield-bundle","@msinternal/sp-edit-customer-promise","@msinternal/sp-image-shapes-read","@msinternal/sp-image-read","@msinternal/sp-image-url-cache-manager","@msinternal/sp-coachmark-utility","@msinternal/sp-advanced-image-editor","@msinternal/sp-image-shapes","@msinternal/sp-pages-core","@msinternal/sp-telemetry","@msinternal/sp-image-tools","@msinternal/sp-dataproviders","@msinternal/sp-fluentui-migration-customizer-bundle","@msinternal/sp-fluentui-migration-messagebar-bundle","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B)=>(()=>{var j={1967:(e,t,n)=>{"use strict";n.d(t,{NuT:()=>r,vJR:()=>i});var a=n(3937);const i=(0,a.U)("TeardropBottomRight20Regular","20",["M2 10a8 8 0 1 1 16 0v6a2 2 0 0 1-2 2h-6a8 8 0 0 1-8-8Zm8-7a7 7 0 0 0 0 14h6a1 1 0 0 0 1-1v-6a7 7 0 0 0-7-7Z"]),r=(0,a.U)("TextBold20Regular","20",["M5.5 4.25C5.5 3.56 6.06 3 6.75 3h3.5a4 4 0 0 1 3.17 6.44c.9.7 1.58 1.8 1.58 3.31A4.23 4.23 0 0 1 10.75 17h-4c-.69 0-1.25-.56-1.25-1.25V4.25ZM8 11v3.5h2.75c.81 0 1.75-.62 1.75-1.75S11.56 11 10.75 11H8Zm0-2.5h2.25a1.5 1.5 0 1 0 0-3H8v3Z"])}
,3937:(e,t,n)=>{"use strict";n.d(t,{U:()=>d});var a=n(5959);const i=a.createContext(void 0),r={};i.Provider;var o=n(606);const s=(0,o.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),c=(e,t)=>{const{title:n,primaryFill:c="currentColor",...d}=e,l={...d,title:void 0,fill:c},u=s(),f=a.useContext(i)?a.useContext(i):r;return l.className=(0,o.mergeClasses)(u.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==f?void 0:f.textDirection)&&u.rtl,l.className),n&&(l["aria-label"]=n),l["aria-label"]||l["aria-labelledby"]?l.role="img":l["aria-hidden"]=!0,l},d=(e,t,n,i)=>{const r="1em"===t?"20":t,o=a.forwardRef((e,o)=>{const s={...c(e,{flipInRtl:null==i?void 0:i.flipInRtl}),ref:o,width:t,height:t,viewBox:`0 0 ${r} ${r}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?a.createElement("svg",{...s,dangerouslySetInnerHTML:{__html:n}}):a.createElement("svg",s,...n.map(e=>a.createElement("path",{d:e,fill:s.fill})))});return o.displayName=e,o}}
,5838:(e,t,n)=>{"use strict";function a(e){var t,n,i="";if("string"==typeof e||"number"==typeof e)i+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=a(e[t]))&&(i&&(i+=" "),i+=n);else for(t in e)e[t]&&(i&&(i+=" "),i+=t);return i}function i(){for(var e,t,n=0,i="";n<arguments.length;)(e=arguments[n++])&&(t=a(e))&&(i&&(i+=" "),i+=t);return i}n.r(t),n.d(t,{clsx:()=>i,default:()=>r});const r=i}
,400:function(e){e.exports=function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function t(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?e(Object(a),!0).forEach(function(e){r(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var c="undefined"!=typeof window&&void 0!==window.document,d=c?window:{},l=!(!c||!d.document.documentElement)&&"ontouchstart"in d.document.documentElement,u=!!c&&"PointerEvent"in d,f="cropper",p="all",m="crop",_="move",h="zoom",b="e",g="w",v="s",y="n",S="ne",D="nw",I="se",x="sw",C="".concat(f,"-crop"),O="".concat(f,"-disabled"),w="".concat(f,"-hidden"),E="".concat(f,"-hide"),A="".concat(f,"-invisible"),L="".concat(f,"-modal"),k="".concat(f,"-move"),M="".concat(f,"Action"),P="".concat(f,"Preview"),T="crop",U="move",F="none",H="crop",R="cropend",N="cropmove",B="cropstart",j="dblclick",V=u?"pointerdown":l?"touchstart":"mousedown",z=u?"pointermove":l?"touchmove":"mousemove",G=u?"pointerup pointercancel":l?"touchend touchcancel":"mouseup",K="ready",W="resize",q="wheel",Q="zoom",Y="image/jpeg",J=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,X=/^data:/,Z=/^data:image\/jpeg;base64,/,$=/^img|canvas$/i,ee={viewMode:0,dragMode:T,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},te=Number.isNaN||d.isNaN;function ne(e){return"number"==typeof e&&!te(e)}var ae=function(e){return e>0&&e<1/0};function ie(e){return void 0===e}function re(e){return"object"===n(e)&&null!==e}var oe=Object.prototype.hasOwnProperty;function se(e){if(!re(e))return!1;try{var t=e.constructor,n=t.prototype;return t&&n&&oe.call(n,"isPrototypeOf")}catch(e){return!1}}function ce(e){return"function"==typeof e}var de=Array.prototype.slice;function le(e){return Array.from?Array.from(e):de.call(e)}function ue(e,t){return e&&ce(t)&&(Array.isArray(e)||ne(e.length)?le(e).forEach(function(n,a){t.call(e,n,a,e)}):re(e)&&Object.keys(e).forEach(function(n){t.call(e,e[n],n,e)})),e}var fe=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return re(e)&&n.length>0&&n.forEach(function(t){re(t)&&Object.keys(t).forEach(function(n){e[n]=t[n]})}),e},pe=/\.\d*(?:0|9){12}\d*$/;function me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return pe.test(e)?Math.round(e*t)/t:e}var _e=/^width|height|left|top|marginLeft|marginTop$/;function he(e,t){var n=e.style;ue(t,function(e,t){_e.test(t)&&ne(e)&&(e="".concat(e,"px")),n[t]=e})}function be(e,t){if(t)if(ne(e.length))ue(e,function(e){be(e,t)});else if(e.classList)e.classList.add(t);else{var n=e.className.trim();n?n.indexOf(t)<0&&(e.className="".concat(n," ").concat(t)):e.className=t}}function ge(e,t){t&&(ne(e.length)?ue(e,function(e){ge(e,t)}):e.classList?e.classList.remove(t):e.className.indexOf(t)>=0&&(e.className=e.className.replace(t,"")))}function ve(e,t,n){t&&(ne(e.length)?ue(e,function(e){ve(e,t,n)}):n?be(e,t):ge(e,t))}var ye=/([a-z\d])([A-Z])/g;function Se(e){return e.replace(ye,"$1-$2").toLowerCase()}function De(e,t){return re(e[t])?e[t]:e.dataset?e.dataset[t]:e.getAttribute("data-".concat(Se(t)))}function Ie(e,t,n){re(n)?e[t]=n:e.dataset?e.dataset[t]=n:e.setAttribute("data-".concat(Se(t)),n)}var xe=/\s\s*/,Ce=function(){var e=!1;if(c){var t=!1,n=function(){},a=Object.defineProperty({},"once",{get:function(){return e=!0,t},set:function(e){t=e}});d.addEventListener("test",n,a),d.removeEventListener("test",n,a)}return e}();function Oe(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n;t.trim().split(xe).forEach(function(t){if(!Ce){var r=e.listeners;r&&r[t]&&r[t][n]&&(i=r[t][n],delete r[t][n],0===Object.keys(r[t]).length&&delete r[t],0===Object.keys(r).length&&delete e.listeners)}e.removeEventListener(t,i,a)})}function we(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n;t.trim().split(xe).forEach(function(t){if(a.once&&!Ce){var r=e.listeners,o=void 0===r?{}:r;i=function(){delete o[t][n],e.removeEventListener(t,i,a);for(var r=arguments.length,s=new Array(r),c=0;c<r;c++)s[c]=arguments[c];n.apply(e,s)},o[t]||(o[t]={}),o[t][n]&&e.removeEventListener(t,o[t][n],a),o[t][n]=i,e.listeners=o}e.addEventListener(t,i,a)})}function Ee(e,t,n){var a;return ce(Event)&&ce(CustomEvent)?a=new CustomEvent(t,{detail:n,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent")).initCustomEvent(t,!0,!0,n),e.dispatchEvent(a)}function Ae(e){var t=e.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}var Le=d.location,ke=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function Me(e){var t=e.match(ke);return null!==t&&(t[1]!==Le.protocol||t[2]!==Le.hostname||t[3]!==Le.port)}function Pe(e){var t="timestamp=".concat((new Date).getTime());return e+(-1===e.indexOf("?")?"?":"&")+t}function Te(e){var t=e.rotate,n=e.scaleX,a=e.scaleY,i=e.translateX,r=e.translateY,o=[];ne(i)&&0!==i&&o.push("translateX(".concat(i,"px)")),ne(r)&&0!==r&&o.push("translateY(".concat(r,"px)")),ne(t)&&0!==t&&o.push("rotate(".concat(t,"deg)")),ne(n)&&1!==n&&o.push("scaleX(".concat(n,")")),ne(a)&&1!==a&&o.push("scaleY(".concat(a,")"));var s=o.length?o.join(" "):"none";return{WebkitTransform:s,msTransform:s,transform:s}}function Ue(e,n){var a=e.pageX,i=e.pageY,r={endX:a,endY:i};return n?r:t({startX:a,startY:i},r)}function Fe(e){var t=e.aspectRatio,n=e.height,a=e.width,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",r=ae(a),o=ae(n);if(r&&o){var s=n*t;"contain"===i&&s>a||"cover"===i&&s<a?n=a/t:a=n*t}else r?n=a/t:o&&(a=n*t);return{width:a,height:n}}function He(e,t,n,a){var i=t.aspectRatio,r=t.naturalWidth,s=t.naturalHeight,c=t.rotate,d=void 0===c?0:c,l=t.scaleX,u=void 0===l?1:l,f=t.scaleY,p=void 0===f?1:f,m=n.aspectRatio,_=n.naturalWidth,h=n.naturalHeight,b=a.fillColor,g=void 0===b?"transparent":b,v=a.imageSmoothingEnabled,y=void 0===v||v,S=a.imageSmoothingQuality,D=void 0===S?"low":S,I=a.maxWidth,x=void 0===I?1/0:I,C=a.maxHeight,O=void 0===C?1/0:C,w=a.minWidth,E=void 0===w?0:w,A=a.minHeight,L=void 0===A?0:A,k=document.createElement("canvas"),M=k.getContext("2d"),P=Fe({aspectRatio:m,width:x,height:O}),T=Fe({aspectRatio:m,width:E,height:L},"cover"),U=Math.min(P.width,Math.max(T.width,_)),F=Math.min(P.height,Math.max(T.height,h)),H=Fe({aspectRatio:i,width:x,height:O}),R=Fe({aspectRatio:i,width:E,height:L},"cover"),N=Math.min(H.width,Math.max(R.width,r)),B=Math.min(H.height,Math.max(R.height,s)),j=[-N/2,-B/2,N,B];return k.width=me(U),k.height=me(F),M.fillStyle=g,M.fillRect(0,0,U,F),M.save(),M.translate(U/2,F/2),M.rotate(d*Math.PI/180),M.scale(u,p),M.imageSmoothingEnabled=y,M.imageSmoothingQuality=D,M.drawImage.apply(M,[e].concat(o(j.map(function(e){return Math.floor(me(e))})))),M.restore(),k}var Re=String.fromCharCode,Ne=/^data:.*,/;var Be={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var e=this.element,t=this.options,n=this.container,a=this.cropper,i=Number(t.minContainerWidth),r=Number(t.minContainerHeight);be(a,w),ge(e,w);var o={width:Math.max(n.offsetWidth,i>=0?i:200),height:Math.max(n.offsetHeight,r>=0?r:100)};this.containerData=o,he(a,{width:o.width,height:o.height}),be(e,w),ge(a,w)},initCanvas:function(){var e=this.containerData,t=this.imageData,n=this.options.viewMode,a=Math.abs(t.rotate)%180==90,i=a?t.naturalHeight:t.naturalWidth,r=a?t.naturalWidth:t.naturalHeight,o=i/r,s=e.width,c=e.height;e.height*o>e.width?3===n?s=e.height*o:c=e.width/o:3===n?c=e.width/o:s=e.height*o;var d={aspectRatio:o,naturalWidth:i,naturalHeight:r,width:s,height:c};this.canvasData=d,this.limited=1===n||2===n,this.limitCanvas(!0,!0),d.width=Math.min(Math.max(d.width,d.minWidth),d.maxWidth),d.height=Math.min(Math.max(d.height,d.minHeight),d.maxHeight),d.left=(e.width-d.width)/2,d.top=(e.height-d.height)/2,d.oldLeft=d.left,d.oldTop=d.top,this.initialCanvasData=fe({},d)},limitCanvas:function(e,t){var n=this.options,a=this.containerData,i=this.canvasData,r=this.cropBoxData,o=n.viewMode,s=i.aspectRatio,c=this.cropped&&r;if(e){var d=Number(n.minCanvasWidth)||0,l=Number(n.minCanvasHeight)||0;o>1?(d=Math.max(d,a.width),l=Math.max(l,a.height),3===o&&(l*s>d?d=l*s:l=d/s)):o>0&&(d?d=Math.max(d,c?r.width:0):l?l=Math.max(l,c?r.height:0):c&&(d=r.width,(l=r.height)*s>d?d=l*s:l=d/s));var u=Fe({aspectRatio:s,width:d,height:l});d=u.width,l=u.height,i.minWidth=d,i.minHeight=l,i.maxWidth=1/0,i.maxHeight=1/0}if(t)if(o>(c?0:1)){var f=a.width-i.width,p=a.height-i.height;i.minLeft=Math.min(0,f),i.minTop=Math.min(0,p),i.maxLeft=Math.max(0,f),i.maxTop=Math.max(0,p),c&&this.limited&&(i.minLeft=Math.min(r.left,r.left+(r.width-i.width)),i.minTop=Math.min(r.top,r.top+(r.height-i.height)),i.maxLeft=r.left,i.maxTop=r.top,2===o&&(i.width>=a.width&&(i.minLeft=Math.min(0,f),i.maxLeft=Math.max(0,f)),i.height>=a.height&&(i.minTop=Math.min(0,p),i.maxTop=Math.max(0,p))))}else i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=a.width,i.maxTop=a.height},renderCanvas:function(e,t){var n=this.canvasData,a=this.imageData;if(t){var i=function(e){var t=e.width,n=e.height,a=e.degree;if(90==(a=Math.abs(a)%180))return{width:n,height:t};var i=a%90*Math.PI/180,r=Math.sin(i),o=Math.cos(i),s=t*o+n*r,c=t*r+n*o;return a>90?{width:c,height:s}:{width:s,height:c}}({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),r=i.width,o=i.height,s=n.width*(r/n.naturalWidth),c=n.height*(o/n.naturalHeight);n.left-=(s-n.width)/2,n.top-=(c-n.height)/2,n.width=s,n.height=c,n.aspectRatio=r/o,n.naturalWidth=r,n.naturalHeight=o,this.limitCanvas(!0,!1)}(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCanvas(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,he(this.canvas,fe({width:n.width,height:n.height},Te({translateX:n.left,translateY:n.top}))),this.renderImage(e),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(e){var t=this.canvasData,n=this.imageData,a=n.naturalWidth*(t.width/t.naturalWidth),i=n.naturalHeight*(t.height/t.naturalHeight);fe(n,{width:a,height:i,left:(t.width-a)/2,top:(t.height-i)/2}),he(this.image,fe({width:n.width,height:n.height},Te(fe({translateX:n.left,translateY:n.top},n)))),e&&this.output()},initCropBox:function(){var e=this.options,t=this.canvasData,n=e.aspectRatio||e.initialAspectRatio,a=Number(e.autoCropArea)||.8,i={width:t.width,height:t.height};n&&(t.height*n>t.width?i.height=i.width/n:i.width=i.height*n),this.cropBoxData=i,this.limitCropBox(!0,!0),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),i.width=Math.max(i.minWidth,i.width*a),i.height=Math.max(i.minHeight,i.height*a),i.left=t.left+(t.width-i.width)/2,i.top=t.top+(t.height-i.height)/2,i.oldLeft=i.left,i.oldTop=i.top,this.initialCropBoxData=fe({},i)},limitCropBox:function(e,t){var n=this.options,a=this.containerData,i=this.canvasData,r=this.cropBoxData,o=this.limited,s=n.aspectRatio;if(e){var c=Number(n.minCropBoxWidth)||0,d=Number(n.minCropBoxHeight)||0,l=o?Math.min(a.width,i.width,i.width+i.left,a.width-i.left):a.width,u=o?Math.min(a.height,i.height,i.height+i.top,a.height-i.top):a.height;c=Math.min(c,a.width),d=Math.min(d,a.height),s&&(c&&d?d*s>c?d=c/s:c=d*s:c?d=c/s:d&&(c=d*s),u*s>l?u=l/s:l=u*s),r.minWidth=Math.min(c,l),r.minHeight=Math.min(d,u),r.maxWidth=l,r.maxHeight=u}t&&(o?(r.minLeft=Math.max(0,i.left),r.minTop=Math.max(0,i.top),r.maxLeft=Math.min(a.width,i.left+i.width)-r.width,r.maxTop=Math.min(a.height,i.top+i.height)-r.height):(r.minLeft=0,r.minTop=0,r.maxLeft=a.width-r.width,r.maxTop=a.height-r.height))},renderCropBox:function(){var e=this.options,t=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft),(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),this.limitCropBox(!1,!0),n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft),n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop),n.oldLeft=n.left,n.oldTop=n.top,e.movable&&e.cropBoxMovable&&Ie(this.face,M,n.width>=t.width&&n.height>=t.height?_:p),he(this.cropBox,fe({width:n.width,height:n.height},Te({translateX:n.left,translateY:n.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),Ee(this.element,H,this.getData())}},je={initPreview:function(){var e=this.element,t=this.crossOrigin,n=this.options.preview,a=t?this.crossOriginUrl:this.url,i=e.alt||"The image to preview",r=document.createElement("img");if(t&&(r.crossOrigin=t),r.src=a,r.alt=i,this.viewBox.appendChild(r),this.viewBoxImage=r,n){var o=n;"string"==typeof n?o=e.ownerDocument.querySelectorAll(n):n.querySelector&&(o=[n]),this.previews=o,ue(o,function(e){var n=document.createElement("img");Ie(e,P,{width:e.offsetWidth,height:e.offsetHeight,html:e.innerHTML}),t&&(n.crossOrigin=t),n.src=a,n.alt=i,n.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',e.innerHTML="",e.appendChild(n)})}},resetPreview:function(){ue(this.previews,function(e){var t=De(e,P);he(e,{width:t.width,height:t.height}),e.innerHTML=t.html,function(e,t){if(re(e[t]))try{delete e[t]}catch(n){e[t]=void 0}else if(e.dataset)try{delete e.dataset[t]}catch(n){e.dataset[t]=void 0}else e.removeAttribute("data-".concat(Se(t)))}(e,P)})},preview:function(){var e=this.imageData,t=this.canvasData,n=this.cropBoxData,a=n.width,i=n.height,r=e.width,o=e.height,s=n.left-t.left-e.left,c=n.top-t.top-e.top;this.cropped&&!this.disabled&&(he(this.viewBoxImage,fe({width:r,height:o},Te(fe({translateX:-s,translateY:-c},e)))),ue(this.previews,function(t){var n=De(t,P),d=n.width,l=n.height,u=d,f=l,p=1;a&&(f=i*(p=d/a)),i&&f>l&&(u=a*(p=l/i),f=l),he(t,{width:u,height:f}),he(t.getElementsByTagName("img")[0],fe({width:r*p,height:o*p},Te(fe({translateX:-s*p,translateY:-c*p},e))))}))}},Ve={bind:function(){var e=this.element,t=this.options,n=this.cropper;ce(t.cropstart)&&we(e,B,t.cropstart),ce(t.cropmove)&&we(e,N,t.cropmove),ce(t.cropend)&&we(e,R,t.cropend),ce(t.crop)&&we(e,H,t.crop),ce(t.zoom)&&we(e,Q,t.zoom),we(n,V,this.onCropStart=this.cropStart.bind(this)),t.zoomable&&t.zoomOnWheel&&we(n,q,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&we(n,j,this.onDblclick=this.dblclick.bind(this)),we(e.ownerDocument,z,this.onCropMove=this.cropMove.bind(this)),we(e.ownerDocument,G,this.onCropEnd=this.cropEnd.bind(this)),t.responsive&&we(window,W,this.onResize=this.resize.bind(this))},unbind:function(){var e=this.element,t=this.options,n=this.cropper;ce(t.cropstart)&&Oe(e,B,t.cropstart),ce(t.cropmove)&&Oe(e,N,t.cropmove),ce(t.cropend)&&Oe(e,R,t.cropend),ce(t.crop)&&Oe(e,H,t.crop),ce(t.zoom)&&Oe(e,Q,t.zoom),Oe(n,V,this.onCropStart),t.zoomable&&t.zoomOnWheel&&Oe(n,q,this.onWheel,{passive:!1,capture:!0}),t.toggleDragModeOnDblclick&&Oe(n,j,this.onDblclick),Oe(e.ownerDocument,z,this.onCropMove),Oe(e.ownerDocument,G,this.onCropEnd),t.responsive&&Oe(window,W,this.onResize)}},ze={resize:function(){if(!this.disabled){var e,t,n=this.options,a=this.container,i=this.containerData,r=a.offsetWidth/i.width,o=a.offsetHeight/i.height,s=Math.abs(r-1)>Math.abs(o-1)?r:o;1!==s&&(n.restore&&(e=this.getCanvasData(),t=this.getCropBoxData()),this.render(),n.restore&&(this.setCanvasData(ue(e,function(t,n){e[n]=t*s})),this.setCropBoxData(ue(t,function(e,n){t[n]=e*s}))))}},dblclick:function(){var e,t;this.disabled||this.options.dragMode===F||this.setDragMode((e=this.dragBox,t=C,(e.classList?e.classList.contains(t):e.className.indexOf(t)>-1)?U:T))},wheel:function(e){var t=this,n=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(e.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout(function(){t.wheeling=!1},50),e.deltaY?a=e.deltaY>0?1:-1:e.wheelDelta?a=-e.wheelDelta/120:e.detail&&(a=e.detail>0?1:-1),this.zoom(-a*n,e)))},cropStart:function(e){var t=e.buttons,n=e.button;if(!(this.disabled||("mousedown"===e.type||"pointerdown"===e.type&&"mouse"===e.pointerType)&&(ne(t)&&1!==t||ne(n)&&0!==n||e.ctrlKey))){var a,i=this.options,r=this.pointers;e.changedTouches?ue(e.changedTouches,function(e){r[e.identifier]=Ue(e)}):r[e.pointerId||0]=Ue(e),a=Object.keys(r).length>1&&i.zoomable&&i.zoomOnTouch?h:De(e.target,M),J.test(a)&&!1!==Ee(this.element,B,{originalEvent:e,action:a})&&(e.preventDefault(),this.action=a,this.cropping=!1,a===m&&(this.cropping=!0,be(this.dragBox,L)))}},cropMove:function(e){var t=this.action;if(!this.disabled&&t){var n=this.pointers;e.preventDefault(),!1!==Ee(this.element,N,{originalEvent:e,action:t})&&(e.changedTouches?ue(e.changedTouches,function(e){fe(n[e.identifier]||{},Ue(e,!0))}):fe(n[e.pointerId||0]||{},Ue(e,!0)),this.change(e))}},cropEnd:function(e){if(!this.disabled){var t=this.action,n=this.pointers;e.changedTouches?ue(e.changedTouches,function(e){delete n[e.identifier]}):delete n[e.pointerId||0],t&&(e.preventDefault(),Object.keys(n).length||(this.action=""),this.cropping&&(this.cropping=!1,ve(this.dragBox,L,this.cropped&&this.options.modal)),Ee(this.element,R,{originalEvent:e,action:t}))}}},Ge={change:function(e){var n,a=this.options,i=this.canvasData,r=this.containerData,o=this.cropBoxData,s=this.pointers,c=this.action,d=a.aspectRatio,l=o.left,u=o.top,f=o.width,C=o.height,O=l+f,E=u+C,A=0,L=0,k=r.width,M=r.height,P=!0;!d&&e.shiftKey&&(d=f&&C?f/C:1),this.limited&&(A=o.minLeft,L=o.minTop,k=A+Math.min(r.width,i.width,i.left+i.width),M=L+Math.min(r.height,i.height,i.top+i.height));var T=s[Object.keys(s)[0]],U={x:T.endX-T.startX,y:T.endY-T.startY},F=function(e){switch(e){case b:O+U.x>k&&(U.x=k-O);break;case g:l+U.x<A&&(U.x=A-l);break;case y:u+U.y<L&&(U.y=L-u);break;case v:E+U.y>M&&(U.y=M-E)}};switch(c){case p:l+=U.x,u+=U.y;break;case b:if(U.x>=0&&(O>=k||d&&(u<=L||E>=M))){P=!1;break}F(b),(f+=U.x)<0&&(c=g,l-=f=-f),d&&(C=f/d,u+=(o.height-C)/2);break;case y:if(U.y<=0&&(u<=L||d&&(l<=A||O>=k))){P=!1;break}F(y),C-=U.y,u+=U.y,C<0&&(c=v,u-=C=-C),d&&(f=C*d,l+=(o.width-f)/2);break;case g:if(U.x<=0&&(l<=A||d&&(u<=L||E>=M))){P=!1;break}F(g),f-=U.x,l+=U.x,f<0&&(c=b,l-=f=-f),d&&(C=f/d,u+=(o.height-C)/2);break;case v:if(U.y>=0&&(E>=M||d&&(l<=A||O>=k))){P=!1;break}F(v),(C+=U.y)<0&&(c=y,u-=C=-C),d&&(f=C*d,l+=(o.width-f)/2);break;case S:if(d){if(U.y<=0&&(u<=L||O>=k)){P=!1;break}F(y),C-=U.y,u+=U.y,f=C*d}else F(y),F(b),U.x>=0?O<k?f+=U.x:U.y<=0&&u<=L&&(P=!1):f+=U.x,U.y<=0?u>L&&(C-=U.y,u+=U.y):(C-=U.y,u+=U.y);f<0&&C<0?(c=x,u-=C=-C,l-=f=-f):f<0?(c=D,l-=f=-f):C<0&&(c=I,u-=C=-C);break;case D:if(d){if(U.y<=0&&(u<=L||l<=A)){P=!1;break}F(y),C-=U.y,u+=U.y,f=C*d,l+=o.width-f}else F(y),F(g),U.x<=0?l>A?(f-=U.x,l+=U.x):U.y<=0&&u<=L&&(P=!1):(f-=U.x,l+=U.x),U.y<=0?u>L&&(C-=U.y,u+=U.y):(C-=U.y,u+=U.y);f<0&&C<0?(c=I,u-=C=-C,l-=f=-f):f<0?(c=S,l-=f=-f):C<0&&(c=x,u-=C=-C);break;case x:if(d){if(U.x<=0&&(l<=A||E>=M)){P=!1;break}F(g),f-=U.x,l+=U.x,C=f/d}else F(v),F(g),U.x<=0?l>A?(f-=U.x,l+=U.x):U.y>=0&&E>=M&&(P=!1):(f-=U.x,l+=U.x),U.y>=0?E<M&&(C+=U.y):C+=U.y;f<0&&C<0?(c=S,u-=C=-C,l-=f=-f):f<0?(c=I,l-=f=-f):C<0&&(c=D,u-=C=-C);break;case I:if(d){if(U.x>=0&&(O>=k||E>=M)){P=!1;break}F(b),C=(f+=U.x)/d}else F(v),F(b),U.x>=0?O<k?f+=U.x:U.y>=0&&E>=M&&(P=!1):f+=U.x,U.y>=0?E<M&&(C+=U.y):C+=U.y;f<0&&C<0?(c=D,u-=C=-C,l-=f=-f):f<0?(c=x,l-=f=-f):C<0&&(c=S,u-=C=-C);break;case _:this.move(U.x,U.y),P=!1;break;case h:this.zoom(function(e){var n=t({},e),a=0;return ue(e,function(e,t){delete n[t],ue(n,function(t){var n=Math.abs(e.startX-t.startX),i=Math.abs(e.startY-t.startY),r=Math.abs(e.endX-t.endX),o=Math.abs(e.endY-t.endY),s=Math.sqrt(n*n+i*i),c=(Math.sqrt(r*r+o*o)-s)/s;Math.abs(c)>Math.abs(a)&&(a=c)})}),a}(s),e),P=!1;break;case m:if(!U.x||!U.y){P=!1;break}n=Ae(this.cropper),l=T.startX-n.left,u=T.startY-n.top,f=o.minWidth,C=o.minHeight,U.x>0?c=U.y>0?I:S:U.x<0&&(l-=f,c=U.y>0?x:D),U.y<0&&(u-=C),this.cropped||(ge(this.cropBox,w),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}P&&(o.width=f,o.height=C,o.left=l,o.top=u,this.action=c,this.renderCropBox()),ue(s,function(e){e.startX=e.endX,e.startY=e.endY})}},Ke={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&be(this.dragBox,L),ge(this.cropBox,w),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=fe({},this.initialImageData),this.canvasData=fe({},this.initialCanvasData),this.cropBoxData=fe({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(fe(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),ge(this.dragBox,L),be(this.cropBox,w)),this},replace:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&e&&(this.isImg&&(this.element.src=e),t?(this.url=e,this.image.src=e,this.ready&&(this.viewBoxImage.src=e,ue(this.previews,function(t){t.getElementsByTagName("img")[0].src=e}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(e))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,ge(this.cropper,O)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,be(this.cropper,O)),this},destroy:function(){var e=this.element;return e.cropper?(e.cropper=void 0,this.isImg&&this.replaced&&(e.src=this.originalUrl),this.uncreate(),this):this},move:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this.canvasData,a=n.left,i=n.top;return this.moveTo(ie(e)?e:a+Number(e),ie(t)?t:i+Number(t))},moveTo:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this.canvasData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.movable&&(ne(e)&&(n.left=e,a=!0),ne(t)&&(n.top=t,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(e,t){var n=this.canvasData;return e=(e=Number(e))<0?1/(1-e):1+e,this.zoomTo(n.width*e/n.naturalWidth,null,t)},zoomTo:function(e,t,n){var a=this.options,i=this.canvasData,r=i.width,o=i.height,s=i.naturalWidth,c=i.naturalHeight;if((e=Number(e))>=0&&this.ready&&!this.disabled&&a.zoomable){var d=s*e,l=c*e;if(!1===Ee(this.element,Q,{ratio:e,oldRatio:r/s,originalEvent:n}))return this;if(n){var u=this.pointers,f=Ae(this.cropper),p=u&&Object.keys(u).length?function(e){var t=0,n=0,a=0;return ue(e,function(e){var i=e.startX,r=e.startY;t+=i,n+=r,a+=1}),{pageX:t/=a,pageY:n/=a}}(u):{pageX:n.pageX,pageY:n.pageY};i.left-=(d-r)*((p.pageX-f.left-i.left)/r),i.top-=(l-o)*((p.pageY-f.top-i.top)/o)}else se(t)&&ne(t.x)&&ne(t.y)?(i.left-=(d-r)*((t.x-i.left)/r),i.top-=(l-o)*((t.y-i.top)/o)):(i.left-=(d-r)/2,i.top-=(l-o)/2);i.width=d,i.height=l,this.renderCanvas(!0)}return this},rotate:function(e){return this.rotateTo((this.imageData.rotate||0)+Number(e))},rotateTo:function(e){return ne(e=Number(e))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=e%360,this.renderCanvas(!0,!0)),this},scaleX:function(e){var t=this.imageData.scaleY;return this.scale(e,ne(t)?t:1)},scaleY:function(e){var t=this.imageData.scaleX;return this.scale(ne(t)?t:1,e)},scale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=this.imageData,a=!1;return e=Number(e),t=Number(t),this.ready&&!this.disabled&&this.options.scalable&&(ne(e)&&(n.scaleX=e,a=!0),ne(t)&&(n.scaleY=t,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.options,a=this.imageData,i=this.canvasData,r=this.cropBoxData;if(this.ready&&this.cropped){e={x:r.left-i.left,y:r.top-i.top,width:r.width,height:r.height};var o=a.width/a.naturalWidth;if(ue(e,function(t,n){e[n]=t/o}),t){var s=Math.round(e.y+e.height),c=Math.round(e.x+e.width);e.x=Math.round(e.x),e.y=Math.round(e.y),e.width=c-e.x,e.height=s-e.y}}else e={x:0,y:0,width:0,height:0};return n.rotatable&&(e.rotate=a.rotate||0),n.scalable&&(e.scaleX=a.scaleX||1,e.scaleY=a.scaleY||1),e},setData:function(e){var t=this.options,n=this.imageData,a=this.canvasData,i={};if(this.ready&&!this.disabled&&se(e)){var r=!1;t.rotatable&&ne(e.rotate)&&e.rotate!==n.rotate&&(n.rotate=e.rotate,r=!0),t.scalable&&(ne(e.scaleX)&&e.scaleX!==n.scaleX&&(n.scaleX=e.scaleX,r=!0),ne(e.scaleY)&&e.scaleY!==n.scaleY&&(n.scaleY=e.scaleY,r=!0)),r&&this.renderCanvas(!0,!0);var o=n.width/n.naturalWidth;ne(e.x)&&(i.left=e.x*o+a.left),ne(e.y)&&(i.top=e.y*o+a.top),ne(e.width)&&(i.width=e.width*o),ne(e.height)&&(i.height=e.height*o),this.setCropBoxData(i)}return this},getContainerData:function(){return this.ready?fe({},this.containerData):{}},getImageData:function(){return this.sized?fe({},this.imageData):{}},getCanvasData:function(){var e=this.canvasData,t={};return this.ready&&ue(["left","top","width","height","naturalWidth","naturalHeight"],function(n){t[n]=e[n]}),t},setCanvasData:function(e){var t=this.canvasData,n=t.aspectRatio;return this.ready&&!this.disabled&&se(e)&&(ne(e.left)&&(t.left=e.left),ne(e.top)&&(t.top=e.top),ne(e.width)?(t.width=e.width,t.height=e.width/n):ne(e.height)&&(t.height=e.height,t.width=e.height*n),this.renderCanvas(!0)),this},getCropBoxData:function(){var e,t=this.cropBoxData;return this.ready&&this.cropped&&(e={left:t.left,top:t.top,width:t.width,height:t.height}),e||{}},setCropBoxData:function(e){var t,n,a=this.cropBoxData,i=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&se(e)&&(ne(e.left)&&(a.left=e.left),ne(e.top)&&(a.top=e.top),ne(e.width)&&e.width!==a.width&&(t=!0,a.width=e.width),ne(e.height)&&e.height!==a.height&&(n=!0,a.height=e.height),i&&(t?a.height=a.width/i:n&&(a.width=a.height*i)),this.renderCropBox()),this},getCroppedCanvas:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var t=this.canvasData,n=He(this.image,this.imageData,t,e);if(!this.cropped)return n;var a=this.getData(),i=a.x,r=a.y,s=a.width,c=a.height,d=n.width/Math.floor(t.naturalWidth);1!==d&&(i*=d,r*=d,s*=d,c*=d);var l=s/c,u=Fe({aspectRatio:l,width:e.maxWidth||1/0,height:e.maxHeight||1/0}),f=Fe({aspectRatio:l,width:e.minWidth||0,height:e.minHeight||0},"cover"),p=Fe({aspectRatio:l,width:e.width||(1!==d?n.width:s),height:e.height||(1!==d?n.height:c)}),m=p.width,_=p.height;m=Math.min(u.width,Math.max(f.width,m)),_=Math.min(u.height,Math.max(f.height,_));var h=document.createElement("canvas"),b=h.getContext("2d");h.width=me(m),h.height=me(_),b.fillStyle=e.fillColor||"transparent",b.fillRect(0,0,m,_);var g=e.imageSmoothingEnabled,v=void 0===g||g,y=e.imageSmoothingQuality;b.imageSmoothingEnabled=v,y&&(b.imageSmoothingQuality=y);var S,D,I,x,C,O,w=n.width,E=n.height,A=i,L=r;A<=-s||A>w?(A=0,S=0,I=0,C=0):A<=0?(I=-A,A=0,C=S=Math.min(w,s+A)):A<=w&&(I=0,C=S=Math.min(s,w-A)),S<=0||L<=-c||L>E?(L=0,D=0,x=0,O=0):L<=0?(x=-L,L=0,O=D=Math.min(E,c+L)):L<=E&&(x=0,O=D=Math.min(c,E-L));var k=[A,L,S,D];if(C>0&&O>0){var M=m/s;k.push(I*M,x*M,C*M,O*M)}return b.drawImage.apply(b,[n].concat(o(k.map(function(e){return Math.floor(me(e))})))),h},setAspectRatio:function(e){var t=this.options;return this.disabled||ie(e)||(t.aspectRatio=Math.max(0,e)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(e){var t=this.options,n=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var i=e===T,r=t.movable&&e===U;e=i||r?e:F,t.dragMode=e,Ie(n,M,e),ve(n,C,i),ve(n,k,r),t.cropBoxMovable||(Ie(a,M,e),ve(a,C,i),ve(a,k,r))}return this}},We=d.Cropper,qe=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(a(this,e),!t||!$.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t,this.options=fe({},ee,se(n)&&n),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}return t=e,r=[{key:"noConflict",value:function(){return window.Cropper=We,e}},{key:"setDefaults",value:function(e){fe(ee,se(e)&&e)}}],(n=[{key:"init",value:function(){var e,t=this.element,n=t.tagName.toLowerCase();if(!t.cropper){if(t.cropper=this,"img"===n){if(this.isImg=!0,e=t.getAttribute("src")||"",this.originalUrl=e,!e)return;e=t.src}else"canvas"===n&&window.HTMLCanvasElement&&(e=t.toDataURL());this.load(e)}}},{key:"load",value:function(e){var t,n,a,i,r=this;if(e){this.url=e,this.imageData={};var o=this.element,s=this.options;if(s.rotatable||s.scalable||(s.checkOrientation=!1),s.checkOrientation&&window.ArrayBuffer)if(X.test(e))Z.test(e)?this.read((t=e.replace(Ne,""),n=atob(t),a=new ArrayBuffer(n.length),ue(i=new Uint8Array(a),function(e,t){i[t]=n.charCodeAt(t)}),a)):this.clone();else{var c=new XMLHttpRequest,d=this.clone.bind(this);this.reloading=!0,this.xhr=c,c.onabort=d,c.onerror=d,c.ontimeout=d,c.onprogress=function(){c.getResponseHeader("content-type")!==Y&&c.abort()},c.onload=function(){r.read(c.response)},c.onloadend=function(){r.reloading=!1,r.xhr=null},s.checkCrossOrigin&&Me(e)&&o.crossOrigin&&(e=Pe(e)),c.open("GET",e,!0),c.responseType="arraybuffer",c.withCredentials="use-credentials"===o.crossOrigin,c.send()}else this.clone()}}},{key:"read",value:function(e){var t=this.options,n=this.imageData,a=function(e){var t,n=new DataView(e);try{var a,i,r;if(255===n.getUint8(0)&&216===n.getUint8(1))for(var o=n.byteLength,s=2;s+1<o;){if(255===n.getUint8(s)&&225===n.getUint8(s+1)){i=s;break}s+=1}if(i){var c=i+10;if("Exif"===function(e,t,n){var a="";n+=t;for(var i=t;i<n;i+=1)a+=Re(e.getUint8(i));return a}(n,i+4,4)){var d=n.getUint16(c);if(((a=18761===d)||19789===d)&&42===n.getUint16(c+2,a)){var l=n.getUint32(c+4,a);l>=8&&(r=c+l)}}}if(r){var u,f,p=n.getUint16(r,a);for(f=0;f<p;f+=1)if(u=r+12*f+2,274===n.getUint16(u,a)){u+=8,t=n.getUint16(u,a),n.setUint16(u,1,a);break}}}catch(e){t=1}return t}(e),i=0,r=1,o=1;if(a>1){this.url=function(e,t){for(var n=[],a=new Uint8Array(e);a.length>0;)n.push(Re.apply(null,le(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat("image/jpeg",";base64,").concat(btoa(n.join("")))}(e);var s=function(e){var t=0,n=1,a=1;switch(e){case 2:n=-1;break;case 3:t=-180;break;case 4:a=-1;break;case 5:t=90,a=-1;break;case 6:t=90;break;case 7:t=90,n=-1;break;case 8:t=-90}return{rotate:t,scaleX:n,scaleY:a}}(a);i=s.rotate,r=s.scaleX,o=s.scaleY}t.rotatable&&(n.rotate=i),t.scalable&&(n.scaleX=r,n.scaleY=o),this.clone()}},{key:"clone",value:function(){var e=this.element,t=this.url,n=e.crossOrigin,a=t;this.options.checkCrossOrigin&&Me(t)&&(n||(n="anonymous"),a=Pe(t)),this.crossOrigin=n,this.crossOriginUrl=a;var i=document.createElement("img");n&&(i.crossOrigin=n),i.src=a||t,i.alt=e.alt||"The image to crop",this.image=i,i.onload=this.start.bind(this),i.onerror=this.stop.bind(this),be(i,E),e.parentNode.insertBefore(i,e.nextSibling)}},{key:"start",value:function(){var e=this,t=this.image;t.onload=null,t.onerror=null,this.sizing=!0;var n=d.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(d.navigator.userAgent),a=function(t,n){fe(e.imageData,{naturalWidth:t,naturalHeight:n,aspectRatio:t/n}),e.initialImageData=fe({},e.imageData),e.sizing=!1,e.sized=!0,e.build()};if(!t.naturalWidth||n){var i=document.createElement("img"),r=document.body||document.documentElement;this.sizingImage=i,i.onload=function(){a(i.width,i.height),n||r.removeChild(i)},i.src=t.src,n||(i.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",r.appendChild(i))}else a(t.naturalWidth,t.naturalHeight)}},{key:"stop",value:function(){var e=this.image;e.onload=null,e.onerror=null,e.parentNode.removeChild(e),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var e=this.element,t=this.options,n=this.image,a=e.parentNode,i=document.createElement("div");i.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=i.querySelector(".".concat(f,"-container")),o=r.querySelector(".".concat(f,"-canvas")),s=r.querySelector(".".concat(f,"-drag-box")),c=r.querySelector(".".concat(f,"-crop-box")),d=c.querySelector(".".concat(f,"-face"));this.container=a,this.cropper=r,this.canvas=o,this.dragBox=s,this.cropBox=c,this.viewBox=r.querySelector(".".concat(f,"-view-box")),this.face=d,o.appendChild(n),be(e,w),a.insertBefore(r,e.nextSibling),ge(n,E),this.initPreview(),this.bind(),t.initialAspectRatio=Math.max(0,t.initialAspectRatio)||NaN,t.aspectRatio=Math.max(0,t.aspectRatio)||NaN,t.viewMode=Math.max(0,Math.min(3,Math.round(t.viewMode)))||0,be(c,w),t.guides||be(c.getElementsByClassName("".concat(f,"-dashed")),w),t.center||be(c.getElementsByClassName("".concat(f,"-center")),w),t.background&&be(r,"".concat(f,"-bg")),t.highlight||be(d,A),t.cropBoxMovable&&(be(d,k),Ie(d,M,p)),t.cropBoxResizable||(be(c.getElementsByClassName("".concat(f,"-line")),w),be(c.getElementsByClassName("".concat(f,"-point")),w)),this.render(),this.ready=!0,this.setDragMode(t.dragMode),t.autoCrop&&this.crop(),this.setData(t.data),ce(t.ready)&&we(e,K,t.ready,{once:!0}),Ee(e,K)}}},{key:"unbuild",value:function(){if(this.ready){this.ready=!1,this.unbind(),this.resetPreview();var e=this.cropper.parentNode;e&&e.removeChild(this.cropper),ge(this.element,w)}}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&i(t.prototype,n),r&&i(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e;var t,n,r}();return fe(qe.prototype,Be,je,Ve,ze,Ge,Ke),qe}()}
,7243:(e,t,n)=>{"use strict";var a=n(6396);function i(){}function r(){}r.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,r,o){if(o!==a){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:i};return n.PropTypes=n,n}}
,6359:(e,t,n)=>{e.exports=n(7243)()}
,6396:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}
,5811:(e,t,n)=>{"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"DraggableCore",{enumerable:!0,get:function(){return u.default}}),t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=_(void 0);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(5959)),r=m(n(6359)),o=m(n(8398)),s=m(n(5838)),c=n(2873),d=n(2550),l=n(7528),u=m(n(9936)),f=m(n(2128)),p=["axis","bounds","children","defaultPosition","defaultClassName","defaultClassNameDragging","defaultClassNameDragged","position","positionOffset","scale"];function m(e){return e&&e.__esModule?e:{default:e}}function _(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(_=function(e){return e?n:t})(e)}function h(){return h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},h.apply(this,arguments)}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach(function(t){C(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function y(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function S(e,t){return S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},S(e,t)}function D(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return I(e)}function I(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function x(e){return x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},x(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&S(e,t)}(_,e);var t,n,a,r,l,m=(r=_,l=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=x(r);if(l){var n=x(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return D(this,e)});function _(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,_),C(I(t=m.call(this,e)),"onDragStart",function(e,n){if((0,f.default)("Draggable: onDragStart: %j",n),!1===t.props.onStart(e,(0,d.createDraggableData)(I(t),n)))return!1;t.setState({dragging:!0,dragged:!0})}),C(I(t),"onDrag",function(e,n){if(!t.state.dragging)return!1;(0,f.default)("Draggable: onDrag: %j",n);var a,i=(0,d.createDraggableData)(I(t),n),r={x:i.x,y:i.y};if(t.props.bounds){var o=r.x,s=r.y;r.x+=t.state.slackX,r.y+=t.state.slackY;var c=(2,function(e){if(Array.isArray(e))return e}(a=(0,d.getBoundPosition)(I(t),r.x,r.y))||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),2!==r.length);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return r}}(a)||function(e,t){if(e){if("string"==typeof e)return v(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,2):void 0}}(a)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),l=c[0],u=c[1];r.x=l,r.y=u,r.slackX=t.state.slackX+(o-r.x),r.slackY=t.state.slackY+(s-r.y),i.x=r.x,i.y=r.y,i.deltaX=r.x-t.state.x,i.deltaY=r.y-t.state.y}if(!1===t.props.onDrag(e,i))return!1;t.setState(r)}),C(I(t),"onDragStop",function(e,n){if(!t.state.dragging)return!1;if(!1===t.props.onStop(e,(0,d.createDraggableData)(I(t),n)))return!1;(0,f.default)("Draggable: onDragStop: %j",n);var a={dragging:!1,slackX:0,slackY:0};if(Boolean(t.props.position)){var i=t.props.position,r=i.x,o=i.y;a.x=r,a.y=o}t.setState(a)}),t.state={dragging:!1,dragged:!1,x:e.position?e.position.x:e.defaultPosition.x,y:e.position?e.position.y:e.defaultPosition.y,prevPropsPosition:g({},e.position),slackX:0,slackY:0,isElementSVG:!1},!e.position||e.onDrag||e.onStop||console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element."),t}return t=_,a=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.position,a=t.prevPropsPosition;return!n||a&&n.x===a.x&&n.y===a.y?null:((0,f.default)("Draggable: getDerivedStateFromProps %j",{position:n,prevPropsPosition:a}),{x:n.x,y:n.y,prevPropsPosition:g({},n)})}}],(n=[{key:"componentDidMount",value:function(){void 0!==window.SVGElement&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}},{key:"componentWillUnmount",value:function(){this.setState({dragging:!1})}},{key:"findDOMNode",value:function(){var e,t,n;return null!==(e=null===(t=this.props)||void 0===t||null===(n=t.nodeRef)||void 0===n?void 0:n.current)&&void 0!==e?e:o.default.findDOMNode(this)}},{key:"render",value:function(){var e,t=this.props,n=(t.axis,t.bounds,t.children),a=t.defaultPosition,r=t.defaultClassName,o=t.defaultClassNameDragging,l=t.defaultClassNameDragged,f=t.position,m=t.positionOffset,_=(t.scale,function(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}(t,p)),b={},v=null,y=!Boolean(f)||this.state.dragging,S=f||a,D={x:(0,d.canDragX)(this)&&y?this.state.x:S.x,y:(0,d.canDragY)(this)&&y?this.state.y:S.y};this.state.isElementSVG?v=(0,c.createSVGTransform)(D,m):b=(0,c.createCSSTransform)(D,m);var I=(0,s.default)(n.props.className||"",r,(C(e={},o,this.state.dragging),C(e,l,this.state.dragged),e));return i.createElement(u.default,h({},_,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),i.cloneElement(i.Children.only(n),{className:I,style:g(g({},n.props.style),b),transform:v}))}}])&&y(t.prototype,n),a&&y(t,a),Object.defineProperty(t,"prototype",{writable:!1}),_}(i.Component);t.default=O,C(O,"displayName","Draggable"),C(O,"propTypes",g(g({},u.default.propTypes),{},{axis:r.default.oneOf(["both","x","y","none"]),bounds:r.default.oneOfType([r.default.shape({left:r.default.number,right:r.default.number,top:r.default.number,bottom:r.default.number}),r.default.string,r.default.oneOf([!1])]),defaultClassName:r.default.string,defaultClassNameDragging:r.default.string,defaultClassNameDragged:r.default.string,defaultPosition:r.default.shape({x:r.default.number,y:r.default.number}),positionOffset:r.default.shape({x:r.default.oneOfType([r.default.number,r.default.string]),y:r.default.oneOfType([r.default.number,r.default.string])}),position:r.default.shape({x:r.default.number,y:r.default.number}),className:l.dontSetMe,style:l.dontSetMe,transform:l.dontSetMe})),C(O,"defaultProps",g(g({},u.default.defaultProps),{},{axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1}))}
,9936:(e,t,n)=>{"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=f(void 0);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var s=r?Object.getOwnPropertyDescriptor(e,o):null;s&&(s.get||s.set)?Object.defineProperty(i,o,s):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(5959)),r=u(n(6359)),o=u(n(8398)),s=n(2873),c=n(2550),d=n(7528),l=u(n(2128));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,r=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(a=n.next()).done)&&(r.push(a.value),!t||r.length!==t);o=!0);}catch(e){s=!0,i=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw i}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?m(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){return h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},h(e,t)}function b(e,t){if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S={start:"touchstart",move:"touchmove",stop:"touchend"},D={start:"mousedown",move:"mousemove",stop:"mouseup"},I=D,x=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&h(e,t)}(u,e);var t,n,a,r,d=(a=u,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=v(a);if(r){var n=v(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return b(this,e)});function u(){var e;_(this,u);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return y(g(e=d.call.apply(d,[this].concat(n))),"state",{dragging:!1,lastX:NaN,lastY:NaN,touchIdentifier:null}),y(g(e),"mounted",!1),y(g(e),"handleDragStart",function(t){if(e.props.onMouseDown(t),!e.props.allowAnyClick&&"number"==typeof t.button&&0!==t.button)return!1;var n=e.findDOMNode();if(!n||!n.ownerDocument||!n.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");var a=n.ownerDocument;if(!(e.props.disabled||!(t.target instanceof a.defaultView.Node)||e.props.handle&&!(0,s.matchesSelectorAndParentsTo)(t.target,e.props.handle,n)||e.props.cancel&&(0,s.matchesSelectorAndParentsTo)(t.target,e.props.cancel,n))){"touchstart"===t.type&&t.preventDefault();var i=(0,s.getTouchIdentifier)(t);e.setState({touchIdentifier:i});var r=(0,c.getControlPosition)(t,i,g(e));if(null!=r){var o=r.x,d=r.y,u=(0,c.createCoreData)(g(e),o,d);(0,l.default)("DraggableCore: handleDragStart: %j",u),(0,l.default)("calling",e.props.onStart),!1!==e.props.onStart(t,u)&&!1!==e.mounted&&(e.props.enableUserSelectHack&&(0,s.addUserSelectStyles)(a),e.setState({dragging:!0,lastX:o,lastY:d}),(0,s.addEvent)(a,I.move,e.handleDrag),(0,s.addEvent)(a,I.stop,e.handleDragStop))}}}),y(g(e),"handleDrag",function(t){var n=(0,c.getControlPosition)(t,e.state.touchIdentifier,g(e));if(null!=n){var a=n.x,i=n.y;if(Array.isArray(e.props.grid)){var r=a-e.state.lastX,o=i-e.state.lastY,s=p((0,c.snapToGrid)(e.props.grid,r,o),2);if(r=s[0],o=s[1],!r&&!o)return;a=e.state.lastX+r,i=e.state.lastY+o}var d=(0,c.createCoreData)(g(e),a,i);if((0,l.default)("DraggableCore: handleDrag: %j",d),!1!==e.props.onDrag(t,d)&&!1!==e.mounted)e.setState({lastX:a,lastY:i});else try{e.handleDragStop(new MouseEvent("mouseup"))}catch(t){var u=document.createEvent("MouseEvents");u.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),e.handleDragStop(u)}}}),y(g(e),"handleDragStop",function(t){if(e.state.dragging){var n=(0,c.getControlPosition)(t,e.state.touchIdentifier,g(e));if(null!=n){var a=n.x,i=n.y;if(Array.isArray(e.props.grid)){var r=a-e.state.lastX||0,o=i-e.state.lastY||0,d=p((0,c.snapToGrid)(e.props.grid,r,o),2);r=d[0],o=d[1],a=e.state.lastX+r,i=e.state.lastY+o}var u=(0,c.createCoreData)(g(e),a,i);if(!1===e.props.onStop(t,u)||!1===e.mounted)return!1;var f=e.findDOMNode();f&&e.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(f.ownerDocument),(0,l.default)("DraggableCore: handleDragStop: %j",u),e.setState({dragging:!1,lastX:NaN,lastY:NaN}),f&&((0,l.default)("DraggableCore: Removing handlers"),(0,s.removeEvent)(f.ownerDocument,I.move,e.handleDrag),(0,s.removeEvent)(f.ownerDocument,I.stop,e.handleDragStop))}}}),y(g(e),"onMouseDown",function(t){return I=D,e.handleDragStart(t)}),y(g(e),"onMouseUp",function(t){return I=D,e.handleDragStop(t)}),y(g(e),"onTouchStart",function(t){return I=S,e.handleDragStart(t)}),y(g(e),"onTouchEnd",function(t){return I=S,e.handleDragStop(t)}),e}return t=u,(n=[{key:"componentDidMount",value:function(){this.mounted=!0;var e=this.findDOMNode();e&&(0,s.addEvent)(e,S.start,this.onTouchStart,{passive:!1})}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var e=this.findDOMNode();if(e){var t=e.ownerDocument;(0,s.removeEvent)(t,D.move,this.handleDrag),(0,s.removeEvent)(t,S.move,this.handleDrag),(0,s.removeEvent)(t,D.stop,this.handleDragStop),(0,s.removeEvent)(t,S.stop,this.handleDragStop),(0,s.removeEvent)(e,S.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,s.removeUserSelectStyles)(t)}}},{key:"findDOMNode",value:function(){var e,t,n;return null!==(e=this.props)&&void 0!==e&&e.nodeRef?null===(t=this.props)||void 0===t||null===(n=t.nodeRef)||void 0===n?void 0:n.current:o.default.findDOMNode(this)}},{key:"render",value:function(){return i.cloneElement(i.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}}])&&function(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(i.Component);t.default=x,y(x,"displayName","DraggableCore"),y(x,"propTypes",{allowAnyClick:r.default.bool,disabled:r.default.bool,enableUserSelectHack:r.default.bool,offsetParent:function(e,t){if(e[t]&&1!==e[t].nodeType)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:r.default.arrayOf(r.default.number),handle:r.default.string,cancel:r.default.string,nodeRef:r.default.object,onStart:r.default.func,onDrag:r.default.func,onStop:r.default.func,onMouseDown:r.default.func,scale:r.default.number,className:d.dontSetMe,style:d.dontSetMe,transform:d.dontSetMe}),y(x,"defaultProps",{allowAnyClick:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1})}
,6874:(e,t,n)=>{"use strict";var a=n(5811),i=a.default,r=a.DraggableCore;e.exports=i,e.exports.default=i,e.exports.DraggableCore=r}
,2873:(e,t,n)=>{"use strict";function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.addClassName=p,t.addEvent=function(e,t,n,a){if(e){var i=c({capture:!0},a);e.addEventListener?e.addEventListener(t,n,i):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}},t.addUserSelectStyles=function(e){if(e){var t=e.getElementById("react-draggable-style-el");t||((t=e.createElement("style")).type="text/css",t.id="react-draggable-style-el",t.innerHTML=".react-draggable-transparent-selection *::-moz-selection {all: inherit;}\n",t.innerHTML+=".react-draggable-transparent-selection *::selection {all: inherit;}\n",e.getElementsByTagName("head")[0].appendChild(t)),e.body&&p(e.body,"react-draggable-transparent-selection")}},t.createCSSTransform=function(e,t){var n=f(e,t,"px");return d({},(0,r.browserPrefixToKey)("transform",r.default),n)},t.createSVGTransform=function(e,t){return f(e,t,"")},t.getTouch=function(e,t){return e.targetTouches&&(0,i.findInArray)(e.targetTouches,function(e){return t===e.identifier})||e.changedTouches&&(0,i.findInArray)(e.changedTouches,function(e){return t===e.identifier})},t.getTouchIdentifier=function(e){return e.targetTouches&&e.targetTouches[0]?e.targetTouches[0].identifier:e.changedTouches&&e.changedTouches[0]?e.changedTouches[0].identifier:void 0},t.getTranslation=f,t.innerHeight=function(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=(0,i.int)(n.paddingTop))-(0,i.int)(n.paddingBottom)},t.innerWidth=function(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t-=(0,i.int)(n.paddingLeft))-(0,i.int)(n.paddingRight)},t.matchesSelector=u,t.matchesSelectorAndParentsTo=function(e,t,n){var a=e;do{if(u(a,t))return!0;if(a===n)return!1;a=a.parentNode}while(a);return!1},t.offsetXYFromParent=function(e,t,n){var a=t===t.ownerDocument.body?{left:0,top:0}:t.getBoundingClientRect();return{x:(e.clientX+t.scrollLeft-a.left)/n,y:(e.clientY+t.scrollTop-a.top)/n}},t.outerHeight=function(e){var t=e.clientHeight,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=(0,i.int)(n.borderTopWidth))+(0,i.int)(n.borderBottomWidth)},t.outerWidth=function(e){var t=e.clientWidth,n=e.ownerDocument.defaultView.getComputedStyle(e);return(t+=(0,i.int)(n.borderLeftWidth))+(0,i.int)(n.borderRightWidth)},t.removeClassName=m,t.removeEvent=function(e,t,n,a){if(e){var i=c({capture:!0},a);e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent?e.detachEvent("on"+t,n):e["on"+t]=null}},t.removeUserSelectStyles=function(e){if(e)try{if(e.body&&m(e.body,"react-draggable-transparent-selection"),e.selection)e.selection.empty();else{var t=(e.defaultView||window).getSelection();t&&"Caret"!==t.type&&t.removeAllRanges()}}catch(e){}};var i=n(7528),r=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=o(void 0);if(n&&n.has(e))return n.get(e);var i={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var c=r?Object.getOwnPropertyDescriptor(e,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=e[s]}return i.default=e,n&&n.set(e,i),i}(n(1922));function o(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(o=function(e){return e?n:t})(e)}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){d(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function d(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var l="";function u(e,t){return l||(l=(0,i.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(t){return(0,i.isFunction)(e[t])})),!!(0,i.isFunction)(e[l])&&e[l](t)}function f(e,t,n){var a=e.x,i=e.y,r="translate(".concat(a).concat(n,",").concat(i).concat(n,")");if(t){var o="".concat("string"==typeof t.x?t.x:t.x+n),s="".concat("string"==typeof t.y?t.y:t.y+n);r="translate(".concat(o,", ").concat(s,")")+r}return r}function p(e,t){e.classList?e.classList.add(t):e.className.match(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)")))||(e.className+=" ".concat(t))}function m(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(?:^|\\s)".concat(t,"(?!\\S)"),"g"),"")}}
,1922:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.browserPrefixToKey=i,t.browserPrefixToStyle=function(e,t){return t?"-".concat(t.toLowerCase(),"-").concat(e):e},t.default=void 0,t.getPrefix=a;var n=["Moz","Webkit","O","ms"];function a(){var e,t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"transform";if("undefined"==typeof window)return"";var r=null===(e=window.document)||void 0===e||null===(t=e.documentElement)||void 0===t?void 0:t.style;if(!r)return"";if(a in r)return"";for(var o=0;o<n.length;o++)if(i(a,n[o])in r)return n[o];return""}function i(e,t){return t?"".concat(t).concat(function(e){for(var t="",n=!0,a=0;a<e.length;a++)n?(t+=e[a].toUpperCase(),n=!1):"-"===e[a]?n=!0:t+=e[a];return t}(e)):e}var r=a();t.default=r}
,2128:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){}}
,2550:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canDragX=function(e){return"both"===e.props.axis||"x"===e.props.axis},t.canDragY=function(e){return"both"===e.props.axis||"y"===e.props.axis},t.createCoreData=function(e,t,n){var i=e.state,o=!(0,a.isNum)(i.lastX),s=r(e);return o?{node:s,deltaX:0,deltaY:0,lastX:t,lastY:n,x:t,y:n}:{node:s,deltaX:t-i.lastX,deltaY:n-i.lastY,lastX:i.lastX,lastY:i.lastY,x:t,y:n}},t.createDraggableData=function(e,t){var n=e.props.scale;return{node:t.node,x:e.state.x+t.deltaX/n,y:e.state.y+t.deltaY/n,deltaX:t.deltaX/n,deltaY:t.deltaY/n,lastX:e.state.x,lastY:e.state.y}},t.getBoundPosition=function(e,t,n){if(!e.props.bounds)return[t,n];var o=e.props.bounds;o="string"==typeof o?o:function(e){return{left:e.left,top:e.top,right:e.right,bottom:e.bottom}}(o);var s=r(e);if("string"==typeof o){var c,d=s.ownerDocument,l=d.defaultView;if(!((c="parent"===o?s.parentNode:d.querySelector(o))instanceof l.HTMLElement))throw new Error('Bounds selector "'+o+'" could not find an element.');var u=c,f=l.getComputedStyle(s),p=l.getComputedStyle(u);o={left:-s.offsetLeft+(0,a.int)(p.paddingLeft)+(0,a.int)(f.marginLeft),top:-s.offsetTop+(0,a.int)(p.paddingTop)+(0,a.int)(f.marginTop),right:(0,i.innerWidth)(u)-(0,i.outerWidth)(s)-s.offsetLeft+(0,a.int)(p.paddingRight)-(0,a.int)(f.marginRight),bottom:(0,i.innerHeight)(u)-(0,i.outerHeight)(s)-s.offsetTop+(0,a.int)(p.paddingBottom)-(0,a.int)(f.marginBottom)}}return(0,a.isNum)(o.right)&&(t=Math.min(t,o.right)),(0,a.isNum)(o.bottom)&&(n=Math.min(n,o.bottom)),(0,a.isNum)(o.left)&&(t=Math.max(t,o.left)),(0,a.isNum)(o.top)&&(n=Math.max(n,o.top)),[t,n]},t.getControlPosition=function(e,t,n){var a="number"==typeof t?(0,i.getTouch)(e,t):null;if("number"==typeof t&&!a)return null;var o=r(n),s=n.props.offsetParent||o.offsetParent||o.ownerDocument.body;return(0,i.offsetXYFromParent)(a||e,s,n.props.scale)},t.snapToGrid=function(e,t,n){return[Math.round(t/e[0])*e[0],Math.round(n/e[1])*e[1]]};var a=n(7528),i=n(2873);function r(e){var t=e.findDOMNode();if(!t)throw new Error("<DraggableCore>: Unmounted during event!");return t}}
,7528:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dontSetMe=function(e,t,n){if(e[t])return new Error("Invalid prop ".concat(t," passed to ").concat(n," - do not set this, set it on the child."))},t.findInArray=function(e,t){for(var n=0,a=e.length;n<a;n++)if(t.apply(t,[e[n],n,e]))return e[n]},t.int=function(e){return parseInt(e,10)},t.isFunction=function(e){return"function"==typeof e||"[object Function]"===Object.prototype.toString.call(e)},t.isNum=function(e){return"number"==typeof e&&!isNaN(e)}}
,7007:(e,t,n)=>{"use strict";n.d(t,{d5:()=>s,gl:()=>r,mS:()=>c,mU:()=>o});var a=n(2141),i=n(7865);const r={light:"light",dark:"dark",theme1:"theme1",theme2:"theme2"};function o(e){return c().get(e)?.color??"#ffffff"}function s(e,t=1){return`rgba(${parseInt(e.substring(1,3),16)}, ${parseInt(e.substring(3,5),16)}, ${parseInt(e.substring(5,7),16)}, ${t})`}function c(){const e=(0,a.getTheme)().semanticColors;return new Map([[r.light,{color:"#ffffff",label:i.ob}],[r.dark,{color:"#000000",label:i.Tl}],[r.theme1,{color:e.inputBackgroundChecked,label:i.qv}],[r.theme2,{color:e.accentButtonBackground,label:i.rj}]])}}
,3382:(e,t,n)=>{"use strict";n.d(t,{A:()=>a}),n(8424).loadStyles('.r_QGRPf_L250R,.r_Zeyey_L250R{background-color:"[theme:neutralLighterAlt, default: #faf9f8]";border-radius:4px;height:435px;width:290px}[dir=ltr] .r_QGRPf_L250R,[dir=ltr] .r_Zeyey_L250R{padding-left:16px}[dir=ltr] .r_QGRPf_L250R,[dir=ltr] .r_Zeyey_L250R,[dir=rtl] .r_QGRPf_L250R,[dir=rtl] .r_Zeyey_L250R{padding-right:16px}[dir=rtl] .r_QGRPf_L250R,[dir=rtl] .r_Zeyey_L250R{padding-left:16px}.r_QGRPf_L250R{height:105px}.m_aB0Ih_L250R{padding-top:20px}.m_-ZGmM_L250R{height:28px;padding-bottom:20px}.m_-ZGmM_L250R.c_ybmu6_L250R{align-items:center;display:flex}.c_IQMzx_L250R{color:"[theme:neutralPrimary, default: #323130]";margin-top:15px;position:absolute;top:0}[dir=ltr] .c_IQMzx_L250R{right:0}[dir=rtl] .c_IQMzx_L250R{left:0}.s_uqxet_L250R{color:"[theme:neutralPrimary, default: #323130]";font-size:14px;font-weight:600;padding-bottom:16px;padding-top:0}.b_xr-h2_L250R,.i_lZTgc_L250R{background-color:"[theme:neutralLighterAlt, default: #faf9f8]"}.t_aNRMg_L250R{color:"[theme:neutralPrimary, default: #323130]"}[dir=ltr] .t_aNRMg_L250R{margin-right:4px}[dir=rtl] .t_aNRMg_L250R{margin-left:4px}.f_2WuGv_L250R{width:50px}.s_pU-2v_L250R{height:395px;position:relative;width:100%}.s_si7Cd_L250R{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);const a={root:"r_Zeyey_L250R",rootWithSimplifiedControls:"r_QGRPf_L250R",main:"m_aB0Ih_L250R",menuOptions:"m_-ZGmM_L250R",colorPicker:"c_ybmu6_L250R",cancel:"c_IQMzx_L250R",sectionLabel:"s_uqxet_L250R",beak:"b_xr-h2_L250R",item:"i_lZTgc_L250R",toggleButton:"t_aNRMg_L250R",fontDropdownContainer:"f_2WuGv_L250R",spinnerRoot:"s_pU-2v_L250R",spinner:"s_si7Cd_L250R"}}
,8424:e=>{"use strict";e.exports=i},9676:e=>{"use strict";e.exports=s},2207:e=>{"use strict";e.exports=u},4949:e=>{"use strict";e.exports=h},8414:e=>{"use strict";e.exports=B},529:e=>{"use strict";e.exports=y},7408:e=>{"use strict";e.exports=c},2141:e=>{"use strict";e.exports=a},6277:e=>{"use strict";e.exports=o},8810:e=>{"use strict";e.exports=n},9392:e=>{"use strict";e.exports=D},1456:e=>{"use strict";e.exports=M},7824:e=>{"use strict";e.exports=l},9318:e=>{"use strict";e.exports=k},718:e=>{"use strict";e.exports=r},2250:e=>{"use strict";e.exports=H},3863:e=>{"use strict";e.exports=w},6575:e=>{"use strict";e.exports=m},4207:e=>{"use strict";e.exports=C},3966:e=>{"use strict";e.exports=R},95:e=>{"use strict";e.exports=f},9331:e=>{"use strict";e.exports=N},4907:e=>{"use strict";e.exports=g},9464:e=>{"use strict";e.exports=x},2944:e=>{"use strict";e.exports=O},6094:e=>{"use strict";e.exports=p},606:e=>{"use strict";e.exports=I},4864:e=>{"use strict";e.exports=A},3422:e=>{"use strict";e.exports=P},4957:e=>{"use strict";e.exports=E},7263:e=>{"use strict";e.exports=F},6036:e=>{"use strict";e.exports=L},4948:e=>{"use strict";e.exports=T},8122:e=>{"use strict";e.exports=d},5519:e=>{"use strict";e.exports=U},8919:e=>{"use strict";e.exports=S},1181:e=>{"use strict";e.exports=_},5592:e=>{"use strict";e.exports=v},5959:e=>{"use strict";e.exports=t},8398:e=>{"use strict";e.exports=b},7865:e=>{"use strict";e.exports=JSON.parse('{"wL":"Edit text overlay styles.","OL":"Text options","Yg":"Text box color","yU":"Text box opacity","hL":"Image overlay color","SN":"Image overlay transparency","NP":"{0} slider.","HU":"{0} color picker.","oU":"Bold","pR":"Italic","b9":"{0} {1}","ob":"Light","Tl":"Dark","qv":"Theme color","rj":"Accent color","HO":"{0} {1} selected Font size options","s5":"Text overlay edit menu. Use Escape button to close this menu.","bB":"Cancel","ar":"Text overlay drag handle. Use left, right, up and down arrow keys to change text overlay position.","$n":"Text overlay at position at {0} and {1}","lR":"Add your text here"}')}
},V={};function z(e){var t=V[e];if(void 0!==t)return t.exports;var n=V[e]={exports:{}};return j[e].call(n.exports,n,n.exports,z),n.exports}z.m=j;var G,K,W,q={"176":"BPTkUR6tnwmlHJf/4OSdLzjsaVfJ0rQOslJNEFR5B2s=","791":"bEMFw9DlKicYWNSlNz4b2gKSklEqNlYnQy6yIY/Dt5c="};z.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return z.d(t,{a:t}),t},z.d=(e,t)=>{for(var n in t)z.o(t,n)&&!z.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},z.f={},z.e=e=>Promise.all(Object.keys(z.f).reduce((t,n)=>(z.f[n](e,t),t),[])),z.u=e=>"chunk."+(791===e?"sp-image-webparts-overlay-edit-menu":e)+"_none_"+{176:"9561ad9bcdcef92e2fe5",791:"36490c0d510f0cab5047"}[e]+".js",z.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),G={},K="12e94922-76ea-4654-88ff-a149979a3d3e_1.0.0:",z.l=(e,t,n,a)=>{if(G[e])G[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==K+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,z.nc&&i.setAttribute("nonce",z.nc),i.setAttribute("data-webpack",K+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(q[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}G[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=G[e];if(delete G[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},z.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},W=e?e.src:"",z.p=W.slice(0,W.lastIndexOf("/")+1),z.f.compat=(e,t)=>{for(var n=function(e){return{176:[{i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},{i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.61",m:9825}],791:[{i:"72ec0651-8a26-441c-87f2-77ec66884ca3",v:"0.1.0",m:7526},{i:"33c5a798-8532-4741-888a-d0a7734036b5",v:"0.1.0",m:1589},{i:"ffe5c101-373a-4bd2-bebb-13082852bab0",v:"0.1.0",m:1485},{i:"215395c1-25f7-42ff-967c-8832aff2ab33",v:"0.1.0",m:9476}]}[e]||[]}(e),a=0;a<n.length;a++)z.m[n[a].m]||(e=>{t.push(Q.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{z.m[e.m]=e=>e.exports=t}))})(n[a])};var Q=z(8414);(()=>{var e={59:0};z.f.j=(t,n)=>{var a=z.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=z.p+z.u(t),o=new Error;z.l(r,n=>{if(z.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)z.o(o,a)&&(z.m[a]=o[a]);s&&s(z)}for(t&&t(n);c<r.length;c++)i=r[c],z.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_12e94922-76ea-4654-88ff-a149979a3d3e_1.0.0"]=self["webpackJsonp_12e94922-76ea-4654-88ff-a149979a3d3e_1.0.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var Y={};return(()=>{"use strict";z.r(Y),z.d(Y,{AspectRatioOptions:()=>Ve,AutoFitOverlayTextField:()=>Te,CropperJs:()=>C,FULL_IMAGE_WIDTH:()=>L,ImageCropperFactory:()=>O,ImageEdit:()=>zt,ImageEditContext:()=>ut,ImageEditDependencyContext:()=>xt,ImageEditMode:()=>je,ImageEditStylesContext:()=>Le,ImageTopAction:()=>dn,ImageWebPartOverlayTextField:()=>ft,LocalFileUpload:()=>Pt,PreloadImageHelper:()=>P,ResizeController:()=>Be,SPImageCropper:()=>oe,_getSvgForAlignment:()=>ln,_getSvgForAlignmentTitleButton:()=>un,_getSvgForAspectRatioDropdown:()=>mn,_getSvgForImageShapes:()=>pn,_getSvgForToolbar:()=>fn,addVersionToFileName:()=>Ze,altTextToolTip:()=>D,aspectRatioMap:()=>Ct,dropOverlay:()=>ze,getFileNameFromUrl:()=>$e,getHTMLOverlayFromPlainText:()=>lt,isHubbleStockImage:()=>nt,setEditModeCustomerPromiseHandlerInfo:()=>Ke,useClickOutside:()=>Ue});var e=z(5959),t=z(8810),n=z(2141),a=z(95),i=z(6094),r=z(6575),o=z(8424);(0,o.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);class s extends e.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);s._getDedicatedDomNode(t||1).appendChild(n)}}static _getDedicatedDomNode(e){s._alertNode&&document.body.removeChild(s._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),s._alertNode=t,s._alertNode}componentDidMount(){s.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||s.read(this.props.message,this.props.readingMode)}render(){return!1}}var c=z(718),d=z(6277),l=z(9676),u=z(7408),f=z(8122);const p=JSON.parse('{"zl":"Suggested alt text: {0}.","uY":"change","mm":"Change the suggested alt text","JX":"keep","r7":"Keep the suggested alt text","PI":"{0} {1}","X0":"Use left or right arrow keys to move between options. Press enter to hide suggested alt text.","Ln":"Press enter to show suggested alt text.","a":"or","vM":"","i1":"?","nf":"AI-generated alternative text may be incorrect"}');o.loadStyles('.a_JHwVn_L250R{display:inline;margin:8px;position:absolute;top:2px;z-index:1}.a_JHwVn_L250R .a_mcfu5_L250R{background-color:#ffdd65;box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108);position:absolute;top:0}[dir=ltr] .a_JHwVn_L250R .a_mcfu5_L250R{left:0}[dir=rtl] .a_JHwVn_L250R .a_mcfu5_L250R{right:0}.a_JHwVn_L250R .a_mcfu5_L250R.a_8tHId_L250R{background-color:"[theme:neutralLight, default: #edebe9]"}.a_JHwVn_L250R .a_mcfu5_L250R:focus{outline:none}.a_JHwVn_L250R .f_mUHzT_L250R{background-color:"[theme:warningBackground, default: #fff4ce]";color:"[theme:neutralPrimary, default: #323130]"}.a_JHwVn_L250R .f_mUHzT_L250R.a_8tHId_L250R{background-color:"[theme:neutralLighter, default: #f3f2f1]"}.a_JHwVn_L250R .a_WzHEP_L250R{background-color:"[theme:white, default: #ffffff]";box-shadow:0 3.2px 7.2px 0 rgba(0,0,0,.132),0 .6px 1.8px 0 rgba(0,0,0,.108);box-sizing:border-box;color:"[theme:neutralPrimary, default: #323130]";font-size:12px!important;overflow:hidden;padding:7px 8px 8px;position:relative;transition:scrollText 1s ease}[dir=ltr] .a_JHwVn_L250R .a_WzHEP_L250R{margin-left:32px}[dir=rtl] .a_JHwVn_L250R .a_WzHEP_L250R{margin-right:32px}@keyframes s_bUwp3_L250R{0%{height:32px;visibility:hidden;width:0}to{height:auto;visibility:visible;width:calc(100% - 32px)}}.a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R{font-size:12px!important;margin:0}[dir=ltr] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R{padding-left:4px}[dir=ltr] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R,[dir=rtl] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R{padding-right:4px}[dir=rtl] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R{padding-left:4px}.a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R:first-of-type{text-transform:capitalize}[dir=ltr] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R:first-of-type{padding-left:4px}[dir=rtl] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R:first-of-type{padding-right:4px}[dir=ltr] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R:last-of-type{padding-right:0}[dir=rtl] .a_JHwVn_L250R .a_WzHEP_L250R .a_mVaW-_L250R:last-of-type{padding-left:0}.a_tksOV_L250R .a_WzHEP_L250R{overflow:hidden;padding:8px 0;width:0}[data-clean-canvas] .a_ARpir_L250R{top:35px}',!0);const m="a_mVaW-_L250R";function _(){return l._SPKillSwitch.isActivated("e3427875-0a7d-41dc-b590-3b49c76897ab")}function h(){return l._SPKillSwitch.isActivated("dcc8a067-9d75-4254-8ffb-a5a91569416e")}function b(){return l._SPKillSwitch.isActivated("2bcef8a9-5cf3-46a5-af97-da8fdb5313e3")}function g(){return l._SPKillSwitch.isActivated("2c13258a-b9a6-4704-9781-6ccbc4a8d830")}function v(){return l._SPKillSwitch.isActivated("b9eed985-ae42-4b74-b887-fcfdc6effed5")}var y=z(7824),S=z(2207);class D extends n.BaseComponent{UNSAFE_componentWillReceiveProps(e){e.imageUrl!==this.props.imageUrl&&this._getMetadata(e.imageUrl)}render(){const{altText:t,isFullMessage:o}=this.state;if(!(0,y.isAltTextToolTipEnabled)(this.props.serviceScope)||!t)return e.createElement(e.Fragment,null);const s=o&&this._canDisplayFullAltText,c=e.createElement(a.Link,{className:m,onClick:this._handleAltTextKeep,"aria-label":p.r7,"data-automation-id":"altTextToolTipKeepButton"},p.JX),{pinToRight:d}=this.props;return e.createElement("div",{className:(0,n.css)("a_JHwVn_L250R","a_ARpir_L250R",{a_tksOV_L250R:!s}),style:{left:(0,n.getRTL)()||d?void 0:this.props.offset,right:(0,n.getRTL)()?this.props.offset:d?0:void 0},ref:this._resolveRef("_altTextContainer"),onFocus:this._handleContainerFocus,onBlur:this._handleContainerBlur,"data-automation-id":"altTextToolTip"},e.createElement(n.FocusZone,{isCircularNavigation:!0},e.createElement(i.TooltipHost,{content:p.nf,"aria-label":l._SPKillSwitch.isActivated("5552ae71-c70f-4e87-bd70-2111f5e3fd29")?void 0:p.nf},e.createElement(r.IconButton,{ariaDescription:this._getIconButtonAriaLabel(t),className:(0,n.css)("a_mcfu5_L250R","f_mUHzT_L250R"),iconProps:{iconName:"EaseOfAccess"},onMouseDown:this._handleIconClick,"data-automation-id":"altTextToolTipIconButton"})),this.props.imageSizeData&&this.props.containerWidth&&(0,f.isImageSizeLargeEnoughForTextOverlay)(this.props.imageSizeData,this.props.containerWidth,!0)&&e.createElement("div",{className:"a_WzHEP_L250R"},e.createElement("span",{"data-automation-id":"altTextToolTipSuggestion"},this._getAltTextString(t)),p.vM,e.createElement(a.Link,{className:m,onClick:this._handleAltTextChange,"aria-label":p.mm,"data-automation-id":"altTextToolTipChangeButton"},p.uY),p.a,c,p.i1)))}get _canDisplayFullAltText(){return!!(this.props.imageSizeData&&this.props.containerWidth&&(0,f.isImageSizeLargeEnoughForTextOverlay)(this.props.imageSizeData,this.props.containerWidth,!0))}_getAltTextString(e){return t.StringHelper.format(p.zl,e)}_getIconButtonAriaLabel(e){return t.StringHelper.format(p.PI,this._getAltTextString(e),p.X0)}_setAutoCollapse(e){e&&this._canDisplayFullAltText?this._messageTimer=this._async.setTimeout(()=>{this.setState({isFullMessage:!1})},5e3):void 0!==this._messageTimer&&this._async.clearTimeout(this._messageTimer)}_getMetadata(e){const n=new d.SPResourcePath(e).domain?e:t.Uri.concatenate(window.location.origin,e);this._aiReachWorkflowExecutor.then(async e=>{const t=this.props.serviceScope.consume(u.PageContext.serviceKey),a=await e.generateAltText({image:{src:n},pageContext:{context:"{sections: []}",title:t.web?.title||"Default Title"},actionType:y.ActionType.Generate,handleResponse:l._SPKillSwitch.isActivated("1edd56bc-8d90-42ec-930b-37555debbd6b")?()=>Promise.resolve():void 0,featureInstanceId:l.Guid.newGuid().toString()});a?.altText&&(this.setState({altText:a.altText}),this.props.onMetadataReceived({photo:{height:this.props.imageSizeData?.imageNaturalHeight||0,orientation:0,width:this.props.imageSizeData?.imageNaturalWidth||0},tags:[]}),this._setAutoCollapse(!0))}).catch(e=>{this.props.onMetadataError(e)})}constructor(e){super(e),this._isFocusIn=!1,this._aiReachWorkflowExecutor=(0,y.getWorkflowExecutorAsync)(this.props.serviceScope),this._handleAltTextVerify=(e,t)=>{e.stopPropagation(),e.preventDefault(),this.props.onAltTextVerify(this.state.altText||"",t)},this._handleAltTextChange=e=>{this._handleAltTextVerify(e,!0),S._EngagementLogger.logEvent("AIReach.AltTextTooltip.Change")},this._handleAltTextKeep=e=>{this._handleAltTextVerify(e,!1),S._EngagementLogger.logEvent("AIReach.AltTextTooltip.Keep")},this._handleContainerFocus=()=>{this._setAutoCollapse(!1),this._isFocusIn||(this._isFocusIn=!0,this.setState({isFullMessage:!0}))},this._handleContainerBlur=e=>{this._altTextContainer&&!this._altTextContainer.contains(e.nativeEvent.relatedTarget)&&(this._isFocusIn=!1,this._setAutoCollapse(!0))},this._handleIconClick=e=>{this._canDisplayFullAltText?this.setState(e=>{const t=!e.isFullMessage;return _()?c.ScreenReaderAlert.read(t?this._getIconButtonAriaLabel(e.altText):p.Ln):s.read(t?this._getIconButtonAriaLabel(e.altText):p.Ln),S._EngagementLogger.logEvent("AIReach.AltTextTooltip.IconClick"),{isFullMessage:t}}):this._handleAltTextChange(e)},this.state={altText:void 0,isFullMessage:!0,isMultiline:!1},this._getMetadata(this.props.imageUrl)}}var I=z(400),x=z.n(I);o.loadStyles('/*!\n * Cropper.js v1.5.13\n * https://fengyuanchen.github.io/cropperjs\n *\n * Copyright 2015-present Chen Fengyuan\n * Released under the MIT license\n *\n * Date: 2022-11-20T05:30:43.444Z\n */.cropper-container{direction:ltr;font-size:0;line-height:0;position:relative;touch-action:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.cropper-container img{backface-visibility:hidden;display:block;height:100%;image-orientation:0deg;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;width:100%}.cropper-canvas,.cropper-crop-box,.cropper-drag-box,.cropper-modal,.cropper-wrap-box{bottom:0;left:0;position:absolute;right:0;top:0}.cropper-canvas,.cropper-wrap-box{overflow:hidden}.cropper-drag-box{background-color:#fff;opacity:0}.cropper-modal{background-color:#000;opacity:.5}.cropper-view-box{display:block;height:100%;outline:1px solid #39f;outline-color:rgba(51,153,255,.75);overflow:hidden;width:100%}.cropper-dashed{border:0 dashed #eee;display:block;opacity:.5;position:absolute}.cropper-dashed.dashed-h{border-bottom-width:1px;border-top-width:1px;height:33.33333%;left:0;top:33.33333%;width:100%}.cropper-dashed.dashed-v{border-left-width:1px;border-right-width:1px;height:100%;left:33.33333%;top:0;width:33.33333%}.cropper-center{display:block;height:0;left:50%;opacity:.75;position:absolute;top:50%;width:0}.cropper-center:after,.cropper-center:before{background-color:#eee;content:" ";display:block;position:absolute}.cropper-center:before{height:1px;left:-3px;top:0;width:7px}.cropper-center:after{height:7px;left:0;top:-3px;width:1px}.cropper-face,.cropper-line,.cropper-point{display:block;height:100%;opacity:.1;position:absolute;width:100%}.cropper-face{background-color:#fff;left:0;top:0}.cropper-line{background-color:#39f}.cropper-line.line-e{cursor:ew-resize;right:-3px;top:0;width:5px}.cropper-line.line-n{cursor:ns-resize;height:5px;left:0;top:-3px}.cropper-line.line-w{cursor:ew-resize;left:-3px;top:0;width:5px}.cropper-line.line-s{bottom:-3px;cursor:ns-resize;height:5px;left:0}.cropper-point{background-color:#39f;height:5px;opacity:.75;width:5px}.cropper-point.point-e{cursor:ew-resize;margin-top:-3px;right:-3px;top:50%}.cropper-point.point-n{cursor:ns-resize;left:50%;margin-left:-3px;top:-3px}.cropper-point.point-w{cursor:ew-resize;left:-3px;margin-top:-3px;top:50%}.cropper-point.point-s{bottom:-3px;cursor:s-resize;left:50%;margin-left:-3px}.cropper-point.point-ne{cursor:nesw-resize;right:-3px;top:-3px}.cropper-point.point-nw{cursor:nwse-resize;left:-3px;top:-3px}.cropper-point.point-sw{bottom:-3px;cursor:nesw-resize;left:-3px}.cropper-point.point-se{bottom:-3px;cursor:nwse-resize;height:20px;opacity:1;right:-3px;width:20px}@media (min-width:768px){.cropper-point.point-se{height:15px;width:15px}}@media (min-width:992px){.cropper-point.point-se{height:10px;width:10px}}@media (min-width:1200px){.cropper-point.point-se{height:5px;opacity:.75;width:5px}}.cropper-point.point-se:before{background-color:#39f;bottom:-50%;content:" ";display:block;height:200%;opacity:0;position:absolute;right:-50%;width:200%}.cropper-invisible{opacity:0}.cropper-bg{background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC")}.cropper-hide{display:block;height:0;position:absolute;width:0}.cropper-hidden{display:none!important}.cropper-move{cursor:move}.cropper-crop{cursor:crosshair}.cropper-disabled .cropper-drag-box,.cropper-disabled .cropper-face,.cropper-disabled .cropper-line,.cropper-disabled .cropper-point{cursor:not-allowed}',!0);class C{get _rotate(){switch(this._exifOrientation){default:return 0;case 3:return 180;case 6:return 90;case 8:return-90}}getImageCropData(e=!0){const t=this._cropper.getData(e);return{x:t.x,y:t.y,width:t.width,height:t.height,fixAspectRatio:this._fixAspectRatio}}setImageCropData(e){const t=this._convertImageCropData(e);this._cropper.setData(t)}setAspectRatio(e){this._cropper.setAspectRatio(e),this._fixAspectRatio=e>0}zoom(e){this._cropper.zoom(e)}dispose(){this._cropper.destroy()}_convertImageCropData(e){return{x:e.x,y:e.y,width:e.width,height:e.height,rotate:this._rotate,scaleX:1,scaleY:1}}_convertImageCropOptions(e){return{aspectRatio:e.aspectRatio,data:this._convertImageCropData(e.data),cropend:e.onCropEnd,cropBoxResizable:e.cropBoxResizable}}constructor(e,t,n){this._exifOrientation=n,this._cropper=new(x())(e,{...C._defaultOptions,...this._convertImageCropOptions(t)})}}C._defaultOptions={autoCropArea:1,cropBoxMovable:!0,dragMode:"none",zoomable:!1,guides:!1,toggleDragModeOnDblclick:!1,viewMode:1};class O{static createCropper(e,t,n){return new C(e,t,n)}}var w=z(5592),E=z(1181),A=z(4949);const L=2560;var k=z(8398),M=z(4907);class P{static loadImage(e,t){return new Promise((n,a)=>{const i=new Image;i.onload=e=>{n(i)},i.onerror=e=>{a(e)},i.src=e,t&&(i.crossOrigin=t)})}static async readImageRatio(e){const t=await P.loadImage(e);return t.naturalWidth/t.naturalHeight}static loadThumbnailImage(t){return new Promise((n,a)=>{const i=document.createElement("div");t.disableBlobRevoke=!0,M.render(e.createElement(f.SPImg,{...t,onImageLoad:e=>{n(e?.target),k.unmountComponentAtNode(i)},onImageLoadFailure:(e,t)=>{"stockImage"===e&&(a(e),k.unmountComponentAtNode(i))},renderedInDetachedDOM:!0}),i)})}static async readThumbnailImageRatio(e){const t=await P.loadThumbnailImage(e);return t.naturalWidth/t.naturalHeight}}const T=JSON.parse('{"wA":"Browse images","lx":"Uploading","zh":"Loading","FB":"Drag or paste an image here or browse for images","QN":"Select or drag and drop a stock image from the Toolbox, or browse for more images","m7":"Image","cH":"Add a caption","cG":"Container for the Image Editor. Use control arrow keys to move the crop area and shift arrow key to resize","DZ":"Do more with your image","o_":"The selected area is at left {0} top {1} with the size of width {2} height {3}","Vq":"We\\u0027re having trouble getting this image for you. Try downloading the image from the source site and then upload it from your computer. ","mw":"Source site.","Cb":"Image added.","Lu":"Click your image to show a toolbar for options like cropping and resizing. Use the Edit button on the left of the image for more options like adding a link and adding text over the image.","DF":"Learn more","KI":"Add your text here. You can add a total of {0} characters.","V$":"Enter resize mode.","HM":"Use left or right arrow keys to change the size of the image.","xW":"The image width is {0} pixels, and uses {1}% of the column.","QS":"Image can\\u0027t be smaller. The minimum size is {0} pixels.","yl":"Image can\\u0027t be larger. The maximum size is {0} pixels.","pY":"Drag or paste here","ly":"Image has been reset to default settings.","x1":"Image changes have been saved.","wi":"Saved updated image.","zV":"We\\u0027re still uploading your image. It may get lost if you leave this page.","Hg":"This doesn\\u0027t seem like a supported image file. Please select a different image."}');o.loadStyles('.i_BXsN2_L250R{height:auto;position:relative;text-align:left}.i_BXsN2_L250R,.i_BXsN2_L250R.i_unfTk_L250R img{max-height:100%;max-width:100%}.i_BXsN2_L250R.i_unfTk_L250R.i_uJKe6_L250R{margin:0 auto}.i_BXsN2_L250R.i_unfTk_L250R.i_uJKe6_L250R img{box-sizing:border-box;width:100%}.i_BXsN2_L250R input{height:.1px;opacity:0;overflow:hidden;position:absolute;width:.1px;z-index:-1}.i_BXsN2_L250R .c_xau5q_L250R{position:absolute;top:-48px;transition:all .3s ease-out;z-index:1}[dir=ltr] .i_BXsN2_L250R .c_xau5q_L250R{left:-8px}[dir=rtl] .i_BXsN2_L250R .c_xau5q_L250R{right:-8px}.i_BXsN2_L250R .c_DEjVS_L250R svg{height:16px;width:16px}.i_BXsN2_L250R .c_DEjVS_L250R .themeableSvgPath{fill:"[theme:bodyBackground, default: #ffffff]"}.i_BXsN2_L250R .c_DEjVS_L250R .a_pVUzl_L250R{display:block;left:68px;position:absolute;transition:1s;width:34px;z-index:2}.l_bTgWt_L250R{height:100%;overflow:hidden;text-align:left;width:100%}[dir=ltr] .c_AKQ35_L250R{margin-right:8px}[dir=rtl] .c_AKQ35_L250R{margin-left:8px}.e_Hz3wc_L250R{height:100%;text-align:left;width:100%}.e_Hz3wc_L250R::-moz-focus-inner{border:0}.e_Hz3wc_L250R{outline:transparent;position:relative}.e_Hz3wc_L250R.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .e_Hz3wc_L250R:focus:after{background:initial;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;content:"";inset:0;opacity:1;pointer-events:none;position:absolute;z-index:auto}.e_Hz3wc_L250R .i_aakiD_L250R{-webkit-user-select:none;-ms-user-select:none;user-select:none}.e_Hz3wc_L250R.o_HkHrP_L250R .i_aakiD_L250R{transition:opacity .3s ease}.i_BXsN2_L250R.i_unfTk_L250R{margin:0 auto}.i_JifkD_L250R,.i_rzjs9_L250R{z-index:2}.i_JifkD_L250R::-moz-focus-inner,.i_rzjs9_L250R::-moz-focus-inner{border:0}.i_JifkD_L250R,.i_rzjs9_L250R{outline:transparent;position:relative}.i_JifkD_L250R.ms-Fabric.is-focusVisible:focus:after,.i_rzjs9_L250R.ms-Fabric.is-focusVisible:focus:after,.ms-Fabric.is-focusVisible .i_JifkD_L250R:focus:after,.ms-Fabric.is-focusVisible .i_rzjs9_L250R:focus:after{background:initial;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;content:"";inset:0;opacity:1;pointer-events:none;position:absolute;z-index:auto}.i_JifkD_L250R.i_aakiD_L250R,.i_rzjs9_L250R.i_aakiD_L250R{overflow:visible}.i_JifkD_L250R img,.i_rzjs9_L250R img{max-width:100%}.i_rzjs9_L250R .cropper-crop-box:focus{outline:none}.i_rzjs9_L250R .cropper-point{background-color:"[theme:bodyBackground, default: #ffffff]";height:12px;opacity:.75;width:12px}.i_rzjs9_L250R .point-se{height:12px!important;width:12px!important}.i_JifkD_L250R .cropper-line,.i_JifkD_L250R .cropper-point{display:none}.p_S995V_L250R{opacity:1!important}.i_aakiD_L250R{margin:0 auto;max-width:100%;overflow:hidden;width:100%}.i_aakiD_L250R .u_Cc1BJ_L250R{min-height:100px}.i_aakiD_L250R .u_Cc1BJ_L250R .u_p2djZ_L250R{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";padding:10px;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .i_aakiD_L250R .u_Cc1BJ_L250R .u_p2djZ_L250R{left:50%}[dir=rtl] .i_aakiD_L250R .u_Cc1BJ_L250R .u_p2djZ_L250R{right:50%}.i_aakiD_L250R .u_Cc1BJ_L250R .u_p2djZ_L250R .u_T72CY_L250R{animation:s_zvse__L250R 2s linear infinite;color:#fff;display:block;font-size:48px;margin:8px 0}@keyframes s_zvse__L250R{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.i_aakiD_L250R .i_OJZYi_L250R{opacity:.5}.i_aakiD_L250R .i_1UxA5_L250R{opacity:1}.i_aakiD_L250R .i_1UxA5_L250R.i_Y3MJc_L250R{display:none}.i_aakiD_L250R img{display:block;margin:0 auto;position:relative}.i_aakiD_L250R img:not([src]){display:none}.i_aakiD_L250R.l_jEIZj_L250R img{margin:0}.o_Zx7bk_L250R{height:100%;width:100%}.o_Zx7bk_L250R img.o_nL6zO_L250R{object-fit:fill}.o_Zx7bk_L250R img.o_lnvyq_L250R{object-fit:contain}.o_Zx7bk_L250R img.o_hKLou_L250R{object-fit:cover}.o_Zx7bk_L250R img.o_5JxyD_L250R{height:auto;left:50%;position:absolute;top:50%;transform:translate(-50%,-50%);width:100%}.o_Zx7bk_L250R img.o_kZaPF_L250R{object-fit:scale-down}.o_Zx7bk_L250R img.o_0uBn8_L250R{object-fit:none}.s_zkEyY_L250R{clip:rect(0,0,0,0);border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.r_zS5m7_L250R{margin-left:-15px;margin-right:-15px}.t_r90Gq_L250R{align-items:center;display:flex;flex-direction:column;max-width:300px;padding:10px}.a_YKA2f_L250R{margin-top:10px}[dir=ltr] .d_oMLzP_L250R{float:right}[dir=rtl] .d_oMLzP_L250R{float:left}.e_LGEqf_L250R{background:transparent!important}.e_RPwGL_L250R{text-decoration:underline!important}.e_RPwGL_L250R:hover{text-decoration:none!important}.d_jHPEu_L250R{background-color:"[theme:themeDarker, default: #004578]";height:100%;opacity:.8;pointer-events:none;position:absolute;text-align:center;width:100%;z-index:3}.d_vYjbq_L250R{color:"[theme:white, default: #ffffff]";position:absolute;transform:translate(-50%,-50%)}.d_vYjbq_L250R.d_p297i_L250R{font-size:68px;top:calc(50% - 20px)}.d_vYjbq_L250R.d_RamcO_L250R{display:inline-block;font-size:18px;top:calc(50% + 20px)}.e_-IIT1_L250R:hover{cursor:pointer}[data-clean-canvas] .a_bAuKU_L250R{top:0}[dir=ltr] [data-clean-canvas] .a_bAuKU_L250R{left:8px}[dir=rtl] [data-clean-canvas] .a_bAuKU_L250R{right:8px}.s_3NoVW_L250R{top:50%}.s_3vOeT_L250R{left:50%;position:absolute;top:50%;transform:translate(-50%,-50%)}.i_GzpND_L250R{display:block;margin-bottom:8px;overflow:hidden;text-overflow:ellipsis}',!0);const U="i_aakiD_L250R",F="d_vYjbq_L250R";function H(){return l._SPKillSwitch.isActivated("ede72370-e88a-4e62-a193-f15658e8210b")}function R(){return l._SPKillSwitch.isActivated("7809fac8-3b0c-4d87-a8f1-ab3ac7a8f470")}function N(){return l._SPKillSwitch.isActivated("b4236a4c-723d-42cd-b08f-764cb4f2c0f1")}function B(){return l._SPKillSwitch.isActivated("90fa68ec-0bd7-4188-b227-60715490383d")}function j(){return l._SPKillSwitch.isActivated("cfdec960-464b-4eb2-b355-d611210c8136")}function V(){return l._SPKillSwitch.isActivated("d51c52fc-9934-49c8-9a84-e04bb5950a9c")}function G(){return l._SPKillSwitch.isActivated("a73aa8d1-e35d-405f-8b10-1606e2a49e2d")}function K(){return l._SPKillSwitch.isActivated("79a66fe0-5e13-4f13-8ec1-a7f9119e6ea7")}function W(){return l._SPKillSwitch.isActivated("0afa60c8-fd2b-40e4-a6ab-14361c39421b")}function q(){return l._SPKillSwitch.isActivated("26280703-79af-41f3-a93a-4c1963545ca0")}function Q(){return l._SPKillSwitch.isActivated("c5942d06-5bdc-4472-8c6e-4316a26b811d")}function J(){return l._SPKillSwitch.isActivated("39bd55ac-41c3-43dd-9861-4bfbacbde8d1")}function X(){return l._SPKillSwitch.isActivated("b24e663e-99fe-44df-ac7c-c8ffc62b19f1")}function Z(){return l._SPKillSwitch.isActivated("59daafff-43c7-45ae-8e6b-ca6d59bf716c")}function $(){return l._SPKillSwitch.isActivated("8a2e183e-2981-4c5d-adb5-974e0bad011a")}function ee(){return!l._SPKillSwitch.isActivated("8b2c8d6b-3723-470d-a808-b1e6ca6be792")&&(0,E.isODBFilePickerEnabled)()}function te(){return!l._SPKillSwitch.isActivated("dcb17fab-cda1-4acd-9019-650b0a02e7e0")&&ne()}function ne(){return!l._SPKillSwitch.isActivated("d2ceafeb-2bfc-4ef9-91fa-6da02f8d497b")&&l._SPFlight.isEnabled(61540)}function ae(){return l._SPFlight.isEnabled(62320)}function ie(){return!l._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")&&l._SPFlight.isEnabled(62479)}function re(){return!l._SPKillSwitch.isActivated("7e601a75-79b6-4241-a3f1-1c00be6bace8")&&(l._SPFlight.isEnabled(62395)||1===l._SPExperiment.getVariantAndLogExposure(90359))}class oe extends n.BaseComponent{static getDerivedStateFromProps(e,t){return{...t,aspectRatio:e.aspectRatio,isFreeCrop:Boolean(void 0===e.aspectRatio||isNaN(e.aspectRatio))}}render(){const t=(0,n.css)(U,this.state.isFreeCrop?"i_rzjs9_L250R":"i_JifkD_L250R");return this.props.imageData.imageUrl?e.createElement("div",{className:t,role:"region",tabIndex:0,ref:this._resolveRef("_imageCropWrapper"),"aria-label":T.cG,onBlur:this._onImageAreaBlur,onKeyDown:this._handleKeyDown,onKeyUp:this._handleKeyUp,"data-automation-id":"imageCropWrapper"},e.createElement("img",{style:{opacity:0},className:(0,n.mergeStyles)({height:this._imageHeight,width:this._imageWidth}),src:this._properlyRotatedImageUrl,ref:this._resolveRef("_image"),"data-sp-originalimgsrc":this.props.imageData.imageUrl,alt:this.props.imageData.altText,onLoad:this._handleImageLoad,onError:this._handleImageError})):void 0}componentWillUnmount(){document.removeEventListener("click",this._handleClick)}componentDidUpdate(e,t){this.state.aspectRatio!==t.aspectRatio&&this._cropController.setAspectRatio(this.state.aspectRatio)}get _properlyRotatedImageUrl(){const{imageData:e,serviceScope:t}=this.props,n=c.ExtensionHelper.getExtension(new d.SPResourcePath(e.imageUrl))||"";let a=void 0!==e.imageNaturalWidth&&e.imageNaturalWidth>L;if(void 0===e.imageNaturalWidth&&(a=!0),a){const t=new A._SPResourcePath(e.imageUrl);return c.DefaultImageHelper.isStockImage(t)?c.DefaultImageHelper.getDefaultImage(t):e.imageUrl}const i=c.ThumbnailUrlGenerator.getThumbnailUrl({absoluteUrl:t.consume(u.PageContext.serviceKey).web.absoluteUrl,fileType:n,spResource:e.imageUrl,siteId:e.siteId,webId:e.webId,uniqueId:e.uniqueId,width:L,callerId:"ImageWebPartEditCrop"});return a?this.props.imageData.imageUrl:i}get _imageWidth(){if(!this.props.containerWidth||!this.props.imageData.imageNaturalWidth||!this.props.imageData.imageNaturalHeight)return;if(this.props.isFullWidth)return`${this.props.containerWidth}px`;const e=Math.min(this.props.containerWidth/this.props.imageData.imageNaturalWidth,1);return Math.round(e*this.props.imageData.imageNaturalWidth)+"px"}get _imageHeight(){if(!this.props.containerWidth||!this.props.imageData.imageNaturalWidth||!this.props.imageData.imageNaturalHeight)return;if(this.props.isFullWidth)return this.props.imageData.imageNaturalHeight*this.props.containerWidth/this.props.imageData.imageNaturalWidth+"px";const e=Math.min(this.props.containerWidth/this.props.imageData.imageNaturalWidth,1);return Math.round(e*this.props.imageData.imageNaturalHeight)+"px"}async _handleImageLoad(){const e=await(0,E.convertDataUriToArrayBuffer)(this._image.src);this._exifOrientation=await(0,E.calculateExifOrientation)(e),this.setState({isImageLoaded:!0});const t={data:this._imageToCropperData(this.props.imageData),aspectRatio:this.state.aspectRatio,cropBoxResizable:!0,onCropEnd:this._onCropEnd};this.props.onCropperImageLoad(),this._setCropperOptions(t),this._imageCropWrapper.focus(),this._imageCropWrapper.style.opacity="1",this._image.removeAttribute("width"),this._image.removeAttribute("height")}async _handleImageError(e){const t=this.props.imageData;this._image.src=(await P.loadThumbnailImage({imageData:{imageUrl:t.imageUrl,siteId:t.siteId,webId:t.webId,listId:t.listId,uniqueId:t.uniqueId},serviceScope:this.props.serviceScope,thumbnailWidth:L,callerId:"ImageWebPartEditCrop",getDefaultImage:c.DefaultImageHelper.getDefaultImage})).src}_setCropperOptions(e){this._cropController=O.createCropper(this._image,e,this._exifOrientation)}_convertCropDataToImageData(e){const t={...this.props.imageData};return t.imageNaturalWidth&&t.imageNaturalHeight||(t.imageNaturalWidth=this._image.naturalWidth,t.imageNaturalHeight=this._image.naturalHeight),t.cropData=e,t.cropData.fixAspectRatio=te()?void 0:!this.state.isFreeCrop,t}_imageToCropperData(e){return{...e.cropData}}constructor(e){super(e),this._onCropEnd=()=>{const e=this._cropController.getImageCropData(),t=this._convertCropDataToImageData(e);this.props.onCropComplete(t,!1),this._imageCropWrapper?.focus()},this._handleClick=e=>{const t=e.target||document.activeElement;(this.props.workingAreaRef&&this.props.workingAreaRef.current||this._imageCropWrapper).contains(t)||this._previewCrop()},this._previewCrop=()=>{const e=this._cropController.getImageCropData(),t=this._convertCropDataToImageData(e);this.props.onCropComplete(t,!0)},this._onImageAreaBlur=e=>{if(!this.state.isImageLoaded)return;const t=e.nativeEvent;this._imageCropWrapper.contains(t.relatedTarget||document.activeElement)||this._previewCrop()},this._handleKeyDown=e=>{if(!this.state.isImageLoaded)return;let t;if(9===e.keyCode&&(e.stopPropagation(),e.preventDefault(),e.currentTarget.isSameNode(e.target)||this._imageCropWrapper.focus()),e.shiftKey)switch(t=this._cropController.getImageCropData(!1),e.keyCode){case 37:t.x+=5,t.width-=10,this._cropKeyPressed=!0;break;case 38:t.y-=5,t.height+=10,this._cropKeyPressed=!0;break;case 39:t.x-=5,t.width+=10,this._cropKeyPressed=!0;break;case 40:t.y+=5,t.height-=10,this._cropKeyPressed=!0}else if(e.ctrlKey)switch(t=this._cropController.getImageCropData(!1),e.keyCode){case 37:t.x-=5,this._cropKeyPressed=!0;break;case 38:t.y-=5,this._cropKeyPressed=!0;break;case 39:t.x+=5,this._cropKeyPressed=!0;break;case 40:t.y+=5,this._cropKeyPressed=!0}this._cropKeyPressed&&(e.stopPropagation(),e.preventDefault(),this._cropController.setImageCropData(t))},this._handleKeyUp=e=>{if(this.state.isImageLoaded&&this._cropKeyPressed){const e=this._cropController.getImageCropData(),n=this._convertCropDataToImageData(e);this.props.onCropComplete(n,!1),this._cropKeyPressed=!1,_()?c.ScreenReaderAlert.read(t.StringHelper.format(T.o_,e.x,e.y,e.width,e.height),c.ReadingMode.ReadImmediately):s.read(t.StringHelper.format(T.o_,e.x,e.y,e.width,e.height),2)}};const n=e.imageData.cropData&&e.imageData.cropData.fixAspectRatio?e.imageData.cropData.width/e.imageData.cropData.height:NaN;this.state={showAspectRatioToolbar:!1,isAspectHorizontal:n>1,aspectRatio:e.aspectRatio||n,isFreeCrop:isNaN(n),cropperMessage:void 0,isImageLoaded:!1},document.addEventListener("click",this._handleClick)}}(0,w._ts_decorate)([n.autobind],oe.prototype,"_handleImageLoad",null),(0,w._ts_decorate)([n.autobind],oe.prototype,"_handleImageError",null);var se=z(3937);const ce=(0,se.U)("Options20Regular","20",["M14.95 5a2.5 2.5 0 0 0-4.9 0H2.5a.5.5 0 0 0 0 1h7.55a2.5 2.5 0 0 0 4.9 0h2.55a.5.5 0 0 0 0-1h-2.55ZM12.5 7a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Zm-2.55 7a2.5 2.5 0 0 0-4.9 0H2.5a.5.5 0 0 0 0 1h2.55a2.5 2.5 0 0 0 4.9 0h7.55a.5.5 0 0 0 0-1H9.95ZM7.5 16a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3Z"]);var de=z(2944),le=z(529),ue=z(8919),fe=z(6874),pe=z.n(fe);const me=(0,se.U)("ReOrderDotsVerticalFilled","1em",["M6.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm0 5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM8 14.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM13.5 6a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3ZM15 9.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0ZM13.5 16a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z"]);var _e=z(9392),he=z(7007);o.loadStyles('.e_qH5RY_L250R{background-color:"[theme:neutralLighterAlt, default: #faf9f8]";border-radius:50px;border-style:none;color:"[theme:neutralPrimary, default: #323130]";height:32px;position:absolute;top:-16px;width:32px;z-index:1}.e_qH5RY_L250R:hover{background-color:"[theme:neutralLighter, default: #f3f2f1]";color:"[theme:themePrimary, default: #0078d4]";cursor:pointer}.i_DmdXg_L250R{font-size:16px;font-weight:600;padding-top:3px}.d_n3oCh_L250R{background-color:transparent;border-style:none;cursor:move;padding-left:0;padding-right:0;position:absolute;width:auto;z-index:1}.d_I5pAn_L250R .d_n3oCh_L250R{opacity:0}.d_I5pAn_L250R:focus-within .d_n3oCh_L250R{opacity:1}.d_I5pAn_L250R.d_0uJm2_L250R:hover .d_n3oCh_L250R{opacity:1}',!0);const be="i_DmdXg_L250R",ge="d_I5pAn_L250R";var ve=z(7865);function ye({topBound:t,rightBound:a,overlayTextStyles:i,dragHandleOffset:r,initialFontSize:o,onChangeStyle:s,children:c,useRteMode:d}){const u=.75*o,[f,p]=e.useState({x:0,y:0}),m=e=>{p(e);let n=0,r=0;if(a&&(n=e.x/a),t&&(r=e.y/t),s){const e={...i,position:{offsetX:n,offsetY:r}};s(e)}};e.useLayoutEffect(()=>{const e=i.position?{x:i.position.offsetX*a,y:i.position.offsetY*t}:{x:0,y:0};q()?m(e):e.x===f.x&&e.y===f.y||m(e)},[a,t,q()?null:i.position]);const _={top:t,right:a,bottom:0,left:0};return e.createElement(pe(),{handle:"button",bounds:_,onStop:function(e,t){f.x===t.x&&f.y===t.y||(m({x:t.x,y:t.y}),S._EngagementLogger.logEvent("ImageWebPart.OverlayText.ChangePosition"))},onStart:1===l._SPExperiment.getVariantAndLogExposure(90309)||l._SPFlight.isEnabled(1185)?function(e,t){e.stopPropagation()}:void 0,position:f},e.createElement("div",{className:W()?ge:(0,n.mergeStyles)(ge,"d_0uJm2_L250R",d?{width:"fit-content"}:{})},e.createElement("button",{title:W()?void 0:ve.ar,"aria-label":W()?ve.ar:void 0,onKeyDown:function(e){if("ArrowLeft"!==e.code&&"ArrowRight"!==e.code&&"ArrowUp"!==e.code&&"ArrowDown"!==e.code)return;e.preventDefault();let n=0,i=0;switch(e.code){case"ArrowLeft":f.x>0&&(n=-5);break;case"ArrowRight":f.x<a&&(n=5);break;case"ArrowUp":f.y>t&&(i=-5);break;case"ArrowDown":f.y<0&&(i=5)}const{x:r,y:o}=f;m({x:r+n,y:o+i})},onKeyUp:function(e){"ArrowLeft"!==e.code&&"ArrowRight"!==e.code&&"ArrowUp"!==e.code&&"ArrowDown"!==e.code||(e.preventDefault(),_e.ScreenReader.alert("TextOverlayPosition",l.Text.format(ve.$n,f.x.toFixed(0),f.y.toFixed(0))))},style:{height:u,top:d?"50%":(r-u)/2,transform:d?"translateY(-50%)":void 0,color:(0,he.mU)(i.textColor)},className:"d_n3oCh_L250R"},e.createElement(me,{fontSize:u})),c))}var Se=z(4207),De=z(3382),Ie=z(9464);const xe=e.lazy(()=>Promise.all([z.e(176),z.e(791)]).then(z.bind(z,5057)).then(e=>({default:e.OverlayTextEditMenu})));function Ce(t){return e.createElement(e.Suspense,{fallback:e.createElement("div",{className:De.A.spinnerRoot},e.createElement(Ie.Spinner,{size:n.SpinnerSize.large,className:De.A.spinner}))},e.createElement(xe,t))}function Oe({target:t,overlayTextStyles:a,initialFontSize:i,enableAdvancedOverlayControls:r,onDismiss:o,onChangeStyle:s,useRTEMode:c}){return e.createElement("div",{"data-automation-id":"image-web-part-text-overlay-menu"},e.createElement(Se.FocusTrapCallout,{target:t,directionalHint:n.DirectionalHint.rightCenter,isBeakVisible:!0,onDismiss:o,focusTrapProps:{isClickableOutsideFocusTrap:!0},styles:we(!!r),ariaLabel:ve.s5},e.createElement(Ce,{initialFontSize:i,onDismiss:o,overlayTextStyles:a,enableAdvancedOverlayControls:r,onChangeStyle:s,useRTEMode:c})))}function we(e){return{root:e?De.A.root:De.A.rootWithSimplifiedControls,container:{},calloutMain:De.A.main,beakCurtain:{},beak:De.A.beak}}var Ee=z(606);const Ae={16:"fontSize16",20:"fontSize20",24:"fontSize24",28:"fontSize28",32:"fontSize32"},Le=e.createContext((0,Ee.makeStyles)({})),ke=(0,Ee.makeStyles)({root:{display:"contents"}});function Me(t){const{children:n,v8Styles:a,hostWidth:i,isEditMode:r}=t,o=e.useContext(Le)(),s=r?o.overlayTextEdit:o.overlayTextView;let c=a?.fontSize?Ae[a?.fontSize]:void 0;c||(c=i<=1024?"fontSizeSmall":"fontSizeLarge");const d=ke();return e.createElement("div",{className:(0,Ee.mergeClasses)(c,s,d.root,!!a?.isBold&&"boldText",!!a?.isItalic&&"italicText"),...l._SPKillSwitch.isActivated("30e39a60-ab3d-4b36-86fe-2236236280a5")?{}:{"data-is-visible":!0}},n)}function Pe(e){if(7!==e.length)return"#ffffff";const t=[parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16)].map(e=>{const t=e/255;return t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)});return.2126*t[0]+.7152*t[1]+.0722*t[2]>.5?"#000000":"#ffffff"}class Te extends e.Component{render(){const{hostWidth:t,hostHeight:a,alignment:i,fontSize:r,padding:o,enableAdvancedEditing:s,overlayTextStyles:c,onChangeStyle:d,enableDragging:l,text:u,supportColorCustomizations:f}=this.props,p=t-o.left-o.right,m=1.5*r,_=m+o.top+o.bottom;if(p<=0)return!1;const h=c?.textColor?(0,he.mU)(c.textColor):"#fff",b={fontSize:c?.fontSize?c.fontSize:r,padding:`${o.top}px ${o.right}px ${o.bottom}px ${o.left}px`,maxWidth:t,fontWeight:c?.isBold?"bold":"600",color:f?h:void 0,lineHeight:m,minHeight:_,fontStyle:c?.isItalic?"italic":void 0},g=(0,n.mergeStyleSets)({overlayTextContainer:{display:"flex",justifyContent:"Center"===i?"center":"Left"===i?"unset":"flex-end",width:this._useRTEMode?"fit-content":void 0}});let v=0,y=0;return a&&l&&(v=-1*(a-this.state.textFieldHeight),y=t-this.state.textFieldWidth),s&&c&&d&&l?e.createElement(ye,{rightBound:y,topBound:v,overlayTextStyles:c,dragHandleOffset:this.state.textFieldHeight,initialFontSize:r,onChangeStyle:d,useRteMode:this._useRTEMode},e.createElement("div",{className:g.overlayTextContainer},this._renderEditModeView(u,b))):e.createElement("div",{className:g.overlayTextContainer},this._renderEditModeView(u,b))}componentDidUpdate(e,t){(!(0,le.isEqual)(e,this.props)||!(0,le.isEqual)(t,this.state))&&this._updateTextFieldSizeBasedOnDisplayWidth()}componentDidMount(){this._updateTextFieldSizeBasedOnDisplayWidth()}get _isMultiline(){return"SquareHeight"===this.props.heightOption||"NoLimit"===this.props.heightOption}_updateTextFieldSizeBasedOnDisplayWidth(){requestAnimationFrame(()=>{const e=this._overlayTextWrapperMutableRef,t=e.current?e.current.scrollWidth:0,n=e.current?this._textFieldHeight(e.current):0;t===this.state.textFieldWidth&&n===this.state.textFieldHeight||(this.setState({textFieldWidth:t,textFieldHeight:n}),this.props.onChangeSize&&this.props.onChangeSize(t,n))})}_textFieldHeight(e){if(!e)return 0;if(this._useRTEMode)return e.parentElement?.scrollHeight||e.scrollHeight;const t=1.5*this.props.fontSize;return t*((e.scrollHeight-this.props.padding.top-this.props.padding.bottom)/t)+this.props.padding.top+this.props.padding.bottom}_renderEditModeView(t,a){const{hostWidth:i,placeholder:r,fontSize:o,padding:s,overlayTextStyles:c,supportColorCustomizations:d,positionTextOverlayAboveImage:u,overlayTextHTML:f,serviceScope:p,hostHeight:m}=this.props,{textFieldWidth:_,textFieldHeight:h}=this.state,b=c?.textBoxColor?(0,he.d5)((0,he.mU)(c.textBoxColor),c.textBoxOpacity):"rgba(0,0,0,0.54)",g=c?.textColor?(0,he.mU)(c.textColor):"#fff",v=(0,n.mergeStyleSets)({textField:{width:Te._isIE||Te._isSafari?_+2+s.right:_+2,maxWidth:i,height:h,selectors:{"& div":{backgroundColor:"transparent"},"& .fui-Textarea, .fui-Input":this._useRTEMode?void 0:{...l._SPKillSwitch.isActivated("6f724408-fc7f-41e4-b06f-2514c953e714")?{}:{backgroundColor:"transparent"}},"input[type=text], textarea":this._useRTEMode?void 0:{margin:"0 auto",backgroundColor:d?b:void 0,height:h,maxHeight:l._SPKillSwitch.isActivated("0fd63792-b93c-4699-98b0-13a9ba981e0a")?void 0:h,overflow:"hidden",borderRadius:"4px",...a,...a.lineHeight?{lineHeight:`${a.lineHeight}px !important`}:{}},"input[type=text]::placeholder, textarea::placeholder":this._useRTEMode?void 0:{fontSize:c?.fontSize?c.fontSize:o,fontWeight:c?.isBold?"bold":"600",color:d?g:void 0,fontStyle:c?.isItalic?"italic":void 0,...a.lineHeight?{lineHeight:`${a.lineHeight}px !important`}:{}}}}}),y=0!==_&&(this._useRTEMode?e.createElement(ue.WebPartTitle,{serviceScope:p,edit:!0,useRTETitle:!0,title:f||"",theme:(0,n.getTheme)(),disableStyleWrapper:!0,onTitleChange:this._handleRTEChange,defaultCommands:[],placeholder:ve.lR,enableDynamicToolbarObserver:!0,removeRteTitleCssClass:!0,dataAutomationId:"image-overlay-text",className:(0,n.css)("rteImagwpOverlayWrapper",(0,n.mergeStyles)({backgroundColor:d?b:void 0,maxWidth:i-s.left-s.right+"px",borderRadius:"4px",width:f?"fit-content":"300px","--rteFontColor":c?Pe((0,he.mU)(c.textBoxColor)):"#ffffff","--ck5wprte-maxheight":m?m-s.bottom-s.top+"px":void 0,"& .ck-content":{overflowY:"hidden !important",margin:"0 !important",maxWidth:i-s.left-s.right+"px",padding:`${s.top}px 0 ${s.bottom}px ${s.left}px !important`}}))}):e.createElement(de.TextField,{borderless:!0,multiline:this._isMultiline,resizable:!1,ariaLabel:r,className:v.textField,styles:u?{fieldGroup:{minHeight:"auto"}}:void 0,placeholder:r,value:t,onChange:this._handleTextChanged,onFocus:this._handleFocus,onBlur:this._handleBlur,onClick:this._handleClick,"data-automation-id":"image-overlay-text",id:"imageOverlayTextEdit"})),S=e.createElement(Me,{v8Styles:c,hostWidth:i,isEditMode:!0},y);return e.createElement(e.Fragment,null,this._renderViewModeView(t||r,a,!1),S,this.props.enableAdvancedEditing&&this._renderEditButton())}_renderViewModeView(t,a,i=!0){const{heightOption:r,padding:o,overlayTextStyles:s,hostWidth:c}=this.props,{textFieldWidth:d}=this.state,l=a.lineHeight;let u,f=1;if(0!==l&&"SquareHeight"===r){let e=a.minHeight;d>e&&(e=d),f=Math.floor((e-o.top-o.bottom)/l),u=(0,ue.truncateText)(f,l)}else"NoLimit"===r&&(f=-1);"\n"===t.slice(-1)&&(t+=" ");const p=(0,n.mergeStyleSets)({overlayTextWrapper:{backgroundColor:s?.textBoxColor?(0,he.d5)((0,he.mU)(s.textBoxColor),s.textBoxOpacity):"rgba(0,0,0,0.54)",whiteSpace:this._isMultiline?"pre-wrap":"pre",wordWrap:Te._isIE&&this._isMultiline?"break-word":void 0,overflow:Te._isIE&&this._isMultiline?"hidden":void 0,wordBreak:this._isMultiline?"break-word":"unset",zIndex:i?1:0,position:i?"unset":"absolute",opacity:i?1:0,boxSizing:"border-box",borderRadius:"4px",...a,width:this._useRTEMode?"fit-content":void 0},overlayText:u}),m={...K()?{}:{fontStyle:a.fontStyle},fontSize:a.fontSize,fontWeight:a.fontWeight,lineHeight:`${a.lineHeight}px`,color:a.color};let _=e.createElement(ue.LessText,{className:"",text:t,lines:f,style:m,autoShowTitle:!1,id:K()?void 0:"imageOverlayTextEdit"});return K()||(_=e.createElement(Me,{v8Styles:s,hostWidth:c,isEditMode:!1},_)),e.createElement("div",{className:p.overlayTextWrapper,ref:e=>{this._overlayTextWrapperMutableRef.current=e,this.props.elementRef&&(this.props.elementRef.current=e)},"data-automation-id":"overlay-text-wrapper"},_)}constructor(t){super(t),this._overlayTextWrapperMutableRef=e.createRef(),this._editButtonRef=e.createRef(),this._useRTEMode=!$()&&(0,ue.isNPSTextCoherencyEnabled)()&&!!this.props.serviceScope,this._handleClick=e=>{e.stopPropagation()},this._renderEditButton=()=>{const{fontSize:t,padding:a,overlayTextStyles:i,onChangeStyle:r,enableAdvancedOverlayControls:o}=this.props,{textFieldWidth:s}=this.state,c=(0,n.getRTL)(),d=Te._isSafari?s-16+a.right:s-16,u=c?{right:`${d}px`}:{left:`${d}px`};return e.createElement("div",null,e.createElement("button",{"aria-haspopup":!0,className:"e_qH5RY_L250R","aria-label":ve.wL,onClick:this._handleEditButtonOnClick,ref:this._editButtonRef,style:u},l._SPKillSwitch.isActivated("4712fe5a-9c49-4267-a228-876aef2e8ce2")||l._SPKillSwitch.isActivated("a3f45048-0db5-4b7c-9a9a-e3183d216c4d")?e.createElement(n.FontIcon,{className:be,iconName:"Edit"}):e.createElement(ce,{className:be})),this.state.isContextualMenuVisible&&i&&r&&e.createElement(Oe,{target:this._editButtonRef,initialFontSize:t,onDismiss:this._handleDismiss,useRTEMode:this._useRTEMode,overlayTextStyles:i,enableAdvancedOverlayControls:o,onChangeStyle:r}))},this._handleTextChanged=(e,t="")=>{const{maximumCharacters:n,onChangeText:a}=this.props;if(n){t.length>n&&(t=t.substr(0,n));const e=/\n/g;(t.match(e)||[]).length>=n&&(t=t.replace(e," "))}a&&a(t)},this._handleRTEChange=(e,t)=>{const{onChangeHTMLText:n}=this.props;n&&n(e)},this._handleFocus=()=>{this._initialValue=this.props.text},this._handleBlur=()=>{if(this._initialValue!==this.props.text&&this.props.qosPrefix){let e;e=0===this.props.text.length?"Clear":0===this._initialValue.length?"Add":"Edit",S._EngagementLogger.logEventWithLogEntry(new S._LogEntry(this.props.qosPrefix,"OverlayText",S._LogType.Event,{action:e,length:this.props.text.length.toString()}))}},this._handleEditButtonOnClick=()=>{this.setState({isContextualMenuVisible:!0})},this._handleDismiss=()=>{this.setState({isContextualMenuVisible:!1})},this.state={textFieldWidth:0,textFieldHeight:0,isContextualMenuVisible:!1}}}function Ue(t,n,a=!0){const i=e.useCallback(e=>{const a=e.target||document.activeElement;t.some(function(e){return!!e.current?.contains(a)})||n()},[n,t]);e.useEffect(()=>(a&&document.addEventListener("mousedown",i),()=>{document.removeEventListener("mousedown",i)}),[a,i])}var Fe;Te._browser=l._BrowserDetection.getBrowserInformation().browser,Te._isIE=Te._browser===l._Browser.IE,Te._isSafari=Te._browser===l._Browser.Safari,function(e){e.None="None",e.TopLeft="TopLeft",e.TopRight="TopRight",e.BottomLeft="BottomLeft",e.BottomRight="BottomRight"}(Fe||(Fe={}));const He=(0,n.memoizeFunction)((e,t)=>{const a=e?"nesw-resize":"nwse-resize",i=e?"nwse-resize":"nesw-resize",r=(0,n.getTheme)(),o={height:"12px",width:"12px",border:`1px solid ${r.palette.themePrimary}`,background:r.palette.white,position:"absolute",borderRadius:"20%"},s=t?"0":"-6px",c={...o,top:s,left:s,cursor:a},d={...o,top:s,right:s,cursor:i},l={...o,bottom:s,left:s,cursor:i},u={...o,bottom:s,right:s,cursor:a};return(0,n.mergeStyleSets)({resizeController:{position:"relative",width:0,height:0,margin:"auto",outline:"none",zIndex:t?"1":void 0},resizeButtonTopLeft:e?d:c,resizeButtonTopRight:e?c:d,resizeButtonBottomLeft:e?u:l,resizeButtonBottomRight:e?l:u})}),Re=(0,n.mergeStyles)({selectors:{"body *":{cursor:"nwse-resize !important"}}}),Ne=(0,n.mergeStyles)({selectors:{"body *":{cursor:"nesw-resize !important"}}});function Be(t){const{alignment:a,isFullWidth:i,maximumWidth:r,initialHeight:o,initialWidth:d,onResize:u,onResizeComplete:f,resizeBorderOffsets:p}=t,m=Math.min(r,d),[h,b]=e.useState(m),[g,v]=e.useState("None"),[y,S]=e.useState({x:0,y:0,resizeDesiredWidth:m});e.useEffect(()=>{_()?c.ScreenReaderAlert.read(T.HM,c.ReadingMode.ReadImmediately):s.read(T.HM,2)},[]);const D=e.useRef(null),I=e.useRef((0,le.debounce)((e,t)=>{_()?c.ScreenReaderAlert.read(l.Text.format(T.xW,e,Math.round(100*t)),c.ReadingMode.ReadImmediately):s.read(l.Text.format(T.xW,e,Math.round(100*t)),2)},500)),x=e=>{I.current(h,h/r),u({width:e,height:o/d*e})};Ue([D],()=>{f({width:h,height:o/d*h})});const C=h,O=o/d*h,w=e.useRef(),E=e.useRef();e.useEffect(()=>(w.current=(0,le.throttle)(e=>E.current&&E.current(e),16),()=>{w.current?.cancel(),w.current=void 0,document.body.classList.remove(Ne,Re)}),[]),e.useEffect(()=>{E.current=e=>{if("None"!==g){const t=C/O,n=e.pageX-y.x,i=e.pageY-y.y,o="Center"===a?2:1,s=!("TopRight"===g&&n<=0&&i>=0||"TopLeft"===g&&n>=0&&i>=0||"BottomLeft"===g&&n>=0&&i<=0||"BottomRight"===g&&n<=0&&i<=0),c=y.resizeDesiredWidth+(s?1:-1)*Math.abs(n)*o,d=c/t;let l;d>=1&&c>=1&&c<=r?l=c:d<1||c<1?l=t>1?1*t:1:c>r&&(l=r),b(l),x(l),e.stopPropagation()}};const e=e=>{v("None"),document.body.classList.remove(Ne,Re)};return w.current&&window.addEventListener("mousemove",w.current,!0),window.addEventListener("mouseup",e),()=>{w.current&&window.removeEventListener("mousemove",w.current),window.removeEventListener("mouseup",e),E.current=void 0}}),e.useEffect(()=>{const e=e=>{if("ArrowLeft"!==e.key&&"ArrowRight"!==e.key||e.shiftKey)return;let t=0;switch(e.keyCode){case n.KeyCodes.left:t=-1;break;case n.KeyCodes.right:t=1}const a=h+t,i=a*o/d;let u;if(i>=1&&a>=1&&a<=r)u=a;else if(i<1||a<1){_()?c.ScreenReaderAlert.read(l.Text.format(T.QS,1),c.ReadingMode.ReadImmediately):s.read(l.Text.format(T.QS,1),2);const e=C/O;u=e>1?1*e:1}else a>r&&(_()?c.ScreenReaderAlert.read(l.Text.format(T.yl,r),c.ReadingMode.ReadImmediately):s.read(l.Text.format(T.yl,r),2),u=r);b(u),x(u)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)});const A=-(p?.top?O+p?.top:O),L=(p?.bottom&&p?.bottom,-(p?.left?(C+p?.left)/2:C/2)),k=(p?.right&&p?.right,(0,n.mergeStyles)({height:O,width:C,border:`1px solid ${(0,n.getTheme)().palette.themePrimary}`,position:"absolute",top:`${A}px`,left:`${L}px`,boxSizing:"border-box"}));function M(e){return t=>{switch(S({x:t.pageX,y:t.pageY,resizeDesiredWidth:h}),v(e),e){case"BottomRight":case"TopLeft":document.body.classList.add(Re);break;case"BottomLeft":case"TopRight":document.body.classList.add(Ne)}}}const P=He((0,n.getRTL)(),i);return e.createElement("div",{className:P.resizeController,ref:D},e.createElement("div",{className:k},e.createElement("div",{className:P.resizeButtonTopLeft,"data-automation-id":"ResizeControllerTopLeftButton",role:"presentation",onMouseDown:M("TopLeft")}),e.createElement("div",{className:P.resizeButtonTopRight,"data-automation-id":"ResizeControllerTopRightButton",role:"presentation",onMouseDown:M("TopRight")}),e.createElement("div",{className:P.resizeButtonBottomLeft,"data-automation-id":"ResizeControllerBottomLeftButton",role:"presentation",onMouseDown:M("BottomLeft")}),e.createElement("div",{className:P.resizeButtonBottomRight,"data-automation-id":"ResizeControllerBottomRightButton",role:"presentation",onMouseDown:M("BottomRight")})))}const je={None:"None",Crop:"Crop",CropAspectRatio:"CropAspectRatio",Resize:"Resize",AdvancedEditor:"AdvancedEditor",Shape:"Shape"};var Ve;!function(e){e.Freeform="Freeform",e.Square="1:1",e.Aspect23="2:3",e.Aspect32="3:2",e.Aspect169="16:9",e.Aspect916="9:16",e.Aspect43="4:3",e.Aspect34="3:4"}(Ve||(Ve={}));const ze=e.createElement("div",{className:"d_jHPEu_L250R"},e.createElement(n.Icon,{className:(0,n.css)(F,"d_p297i_L250R"),iconName:"Photo2"}),e.createElement("p",{className:(0,n.css)(F,"d_RamcO_L250R")},T.pY));var Ge=z(3863);function Ke(e,t){return{errorModuleName:e,logFailure:t.consume(Ge._EditModeCustomerPromiseHandler.serviceKey).logFailure,veto:"Page Edit Asset Handling Failure"}}function We(e){return"CanvasWebPartHost.Amplify.EmailEndpoint"===e}function qe(e){return"CanvasWebPartHost.Amplify.TeamsEndpoint"===e}function Qe(e){return"CanvasWebPartHost.Amplify.EngageEndpoint"===e}function Ye(e){return qe(e)||Qe(e)}function Je(e){return We(e)||qe(e)||Qe(e)}function Xe(e){const t=Date.now().toString(),n=e.lastIndexOf("/"),a=e.substring(n+1);return t+E.SPFileHandler.replaceSpecialCharacters(a)}function Ze(e,t){const n=Date.now().toString(),a=c.ExtensionHelper.getExtension(e);return e.replace(RegExp(`.${a}`,"i"),`_${n}.${t&&t!==a?t:a}`)}function $e(e,t=!1,n,a){const i=new RegExp("^(?:[a-z]+:)?//","i"),r=e.replace(/\/$/,"");let o="";if(o=i.test(r)?new URL(r).pathname.split("/").pop():r.split("/").pop(),!o)throw new Error(`Could not parse file name from url: ${e}`);const s=c.ExtensionHelper.getExtension(o),d=n?`-${n}`:"";return`${E.SPFileHandler.replaceSpecialCharacters(t?Ze(o,a):a&&a!==s?o.replace(RegExp(`\\.${s}$`,"i"),`${d}.${a}`):o)}`}function et(e){return e?nt(e)?c.ImageSourceType.HubbleStockURI:c.ImageSourceType.sharepointURI:c.ImageSourceType.none}function tt(e,t,n,a){return!e||te()?{}:{croppedWidth:t,croppedHeight:n,croppedDisplayWidth:a?.croppedDisplaySize.width,croppedDisplayHeight:a?.croppedDisplaySize.height}}function nt(e){return A._ThumbnailUrlGenerator.getThumbnailProvider(e)===A._ThumbnailProviderType.HubbleStock}function at(e){return Je(e)}function it(e){return!Je(e)}function rt(e){return!Ye(e)}function ot(e){return!Ye(e)}function st(e){return qe(e)}function ct(e){return Ye(e)}async function dt(e){const t=l._BrowserDetection.getBrowserInformation();if(t.browser===l._Browser.Firefox||(t.browser===l._Browser.Chrome||t.browser===l._Browser.EdgeChromium)&&t.browserVersion&&t.browserVersion.greaterThan(l.Version.parse("81.0.0.0")))return Promise.resolve(!1);{const t=new S._QosMonitor("ImageWebpart.GetImageRotation");try{const n=await(0,E.convertDataUriToArrayBuffer)(e.src),a=await(0,E.calculateExifOrientation)(n);return t.writeSuccess(),Boolean(a&&-1!==E.rotatedExifOrientation.indexOf(a))}catch(e){return t.writeUnexpectedFailure("Unexpected",e),!1}}}function lt(e,t){if(!e||!e.trim())return"";const n=e.replace(/[&<>"']/g,e=>{switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#039;";default:return e}});if(!t)return`<p>${n}</p>`;const a=new Map([[16,"fontSizeMediumPlus"],[18,"fontSizeLarge"],[20,"fontSizeXLarge"],[24,"fontSizeXLargePlus"],[28,"fontSizeXxLarge"],[32,"fontSizeXxxLarge"]]);let i=n;if(t.textColor){const e=(0,he.mU)(t.textColor);i=`<span style="color:${encodeURIComponent(e)}">${i}</span>`}return t.isBold&&(i=`<strong>${i}</strong>`),t.isItalic&&(i=`<i>${i}</i>`),i=`<span class="${a.get(t.fontSize||18)||"fontSizeLarge"}">${i}</span>`,`<p>${i}</p>`}const ut=e.createContext({});function ft(t){const a=e.useRef();let i,r,o;const{hostType:s}=e.useContext(ut);t.hostWidth<=1024?(r=20,i=16,o={top:8,bottom:8,left:16,right:16}):(r=28,i=32,o={top:18,bottom:18,left:24,right:24}),rt(s)||(i=0,o={...o,left:0});const c=function(e){return We(e)||qe(e)}(t.webPartContext?.host?.hostType||s)?(0,n.mergeStyles)({margin:i,marginLeft:0,maxWidth:"100%",width:"100%",zIndex:1}):(0,n.mergeStyles)({margin:i,position:"absolute",bottom:0,maxWidth:"100%",width:"100%",left:t.offset,zIndex:1}),d=(0,n.mergeStyles)({margin:i,position:"absolute",bottom:0,maxWidth:"100%",width:"100%",left:t.offset,zIndex:1},t.styles);return e.createElement("div",{className:Q()?c:d,"data-automation-id":"image-webpart-text-overlay"},e.createElement(Te,{text:t.text||"",overlayTextHTML:t.overlayTextHTML,serviceScope:t.serviceScope,hostWidth:t.hostWidth-2*i,hostHeight:t.hostHeight?t.hostHeight-2*i:void 0,onChangeText:t.onChangeText,onChangeHTMLText:t.onChangeHTMLText,onChangeStyle:t.onChangeStyle,overlayTextStyles:t.overlayTextStyles,placeholder:l.Text.format(T.KI,48),heightOption:"NoLimit",alignment:"Left",fontSize:r,padding:o,maximumCharacters:48,qosPrefix:t.qosPrefix,key:t.hostWidth-2*i,enableAdvancedEditing:!0,enableAdvancedOverlayControls:rt(s),supportColorCustomizations:ot(s),positionTextOverlayAboveImage:at(s),enableDragging:t.enableDragging,elementRef:a}))}var pt=z(3966),mt=z(9331);const _t=e=>{const{variantTheme:t}=e;return t?{root:{color:t.semanticColors.bodyText+" !important",selectors:{textarea:{color:t.semanticColors.bodyText},"textarea::placeholder":{color:t.semanticColors.bodySubtext}}}}:{root:void 0}};var ht;!function(e){e[e.Documents=1]="Documents",e[e.Images=2]="Images",e[e.Pages=3]="Pages",e[e.Videos=4]="Videos",e[e.Audios=5]="Audios",e[e.Models=6]="Models",e[e.BasicDocuments=7]="BasicDocuments",e[e.Transcripts=8]="Transcripts",e[e.VideosWithWebm=9]="VideosWithWebm",e[e.BackgroundImages=10]="BackgroundImages"}(ht||(ht={}));var bt=z(4957),gt=z(4864),vt=z(6036),yt=z(9318),St=z(1456),Dt=z(3422);const It=(St.AdvancedCropper,{cropper:St.AdvancedCropper,resizer:Be,shapeEdit:Dt.ImageShapesEditRef,qosPrefix:"ImageWebPartEdit"}),xt=e.createContext(It),Ct=new Map([[16/9,"16:9"],[4/3,"4:3"],[2/3,"2:3"],[1.5,"3:2"],[1,"1:1"],[9/16,"9:16"],[0,"Freeform"],[void 0,"Freeform"]]),Ot="ImageWebPartEdit";function wt(e){return"RTEInlineImageCK5Edit"!==e}const Et=e.forwardRef(function({containerWidth:t,currentMode:a,imageData:i,isFullWidth:r,isFlexibleControl:o,onEditComplete:d,onRenderComplete:u,onEditModeChange:p,onImageLoad:m,onImageLoadFailed:h,serviceScope:b,callerId:g,isOverlayTextEnabled:v,updateTextOverlayDisplay:y,saveAdvancedImageEdit:D,saveShapeEdit:I,cacheBusterEntry:x},C){const[O,w]=e.useState(i),[E,L]=e.useState(void 0),[k,M]=e.useState(!1),{hostType:F}=e.useContext(ut),{displayHeight:H,displayWidth:R}=te()&&x?.imageSizeData?(0,f.getDisplaySizeFromAdvancedImageEditorSizeData)(x.imageSizeData,t,o):(0,f.getDisplaySizeFromImageData)(O,t,o),[N,B]=e.useState({height:H,width:R}),j=e.useRef(null),V=e.useRef(null),z=e.useRef(null),G=e.useRef(null),K=e.useRef(null),W=e.useRef(null),q=e.useRef(!1),Q=!r&&!function(e){return Ye(e)}(F),Y=e.useContext(xt),J=Y.resizer,X=Y.cropper,$=Y.shapeEdit,ee={height:H,width:R},ae=S._LogSource.create("ImageEditor"),ie={...i,webPartContext:void 0};e.useEffect(()=>{if(w(i),M(!0),te())if(x?.imageSizeData){const{displayHeight:e,displayWidth:n}=(0,f.getDisplaySizeFromAdvancedImageEditorSizeData)(x.imageSizeData,t,o);B({height:e,width:n})}else B({height:H,width:R});return()=>{M(!1)}},[JSON.stringify(ie),r,t,x]);const oe=(0,f.useFullImageSrc)(Ot,b,i,c.DefaultImageHelper.getDefaultImage,ne()&&x?x.cacheBuster:O.cacheBuster);e.useMemo(()=>{O.advancedImageEditorData?.isAdvancedEdited&&k&&oe&&P.loadImage(oe).catch(()=>{})},[k,oe,O.advancedImageEditorData?.isAdvancedEdited]);const se=e=>{p&&p(e)},ce=()=>{se(je.Crop),L(void 0)},de=()=>{se(je.AdvancedEditor)},le=()=>{d({...i,isAspectRatioLockedOnLoad:!1}),se(je.Resize),G.current&&G.current.focus(),V.current&&V.current.focus()},ue=()=>{a!==je.Crop&&a!==je.CropAspectRatio||!j.current?a!==je.Resize&&a!==je.Shape||d(i):j.current._onCropEnd(),se(je.None),_()?c.ScreenReaderAlert.read(T.x1,c.ReadingMode.ReadImmediately):s.read(T.x1,2)},fe=e=>{i.aspectRatioOnLoad&&S._EngagementLogger.logEventWithLogEntry(new S._LogEntry("ImageEditor","AspectRatioChange.Click",S._LogType.Event,{aspectRatioOnLoad:i.aspectRatioOnLoad.toString(),newAspectRatio:Ct.get(e)})),se(je.CropAspectRatio),L(e)},pe=()=>{a!==je.Crop&&a!==je.CropAspectRatio||!j.current||j.current._onCropEnd();const e=Boolean(i.aspectRatioOnLoad),{advancedImageEditorData:t}=i,n=!!t?.isAdvancedEdited,r=n&&t?.originalSourceUrl?t.originalSourceUrl:i.imageUrl,o=n&&t?.originalUniqueId?t.originalUniqueId:i.uniqueId,l=n&&t?.originalListId?t.originalListId:i.listId,u=n&&t?.originalWebId?t.originalWebId:i.webId,f=n&&t?.originalSiteId?t.originalSiteId:i.siteId,p=n&&t?.originalHeight?t.originalHeight:i.imageNaturalHeight,m=n&&t?.originalWidth?t.originalWidth:i.imageNaturalWidth,h={...i,cropData:e&&!Z()?i.cropData:void 0,resizeCoefficient:void 0,resizeDesiredWidth:void 0,isAspectRatioLockedOnLoad:!!Z()&&e,imageUrl:r,uniqueId:o,listId:l,webId:u,siteId:f,imageNaturalHeight:p,imageNaturalWidth:m,advancedImageEditorData:void 0,cacheBuster:void 0,imageShape:void 0,imageShapeData:void 0};d(h),se(je.None),_()?c.ScreenReaderAlert.read(T.ly,c.ReadingMode.ReadImmediately):s.read(T.ly,2)},me=e=>{d({...i,alignment:e})},_e=e=>{S._EngagementLogger.logEventWithLogEntry(new S._LogEntry("ImageShapes","ImageShapeChange.Click",S._LogType.Event,{callerId:g,newImageShape:e})),e===bt.ImageShape.Default?(se(je.None),d({...i,imageShape:e,imageShapeData:void 0})):(se(je.Shape),d({...i,imageShape:e}))};e.useImperativeHandle(C,()=>({handleCropClick:ce,handleResizeClick:le,handleSaveClick:ue,handleRatioChange:fe,handleAlignmentChange:me,handleReset:pe,handleImageShapesChange:_e,handleAdvancedEditorClick:de}));const[he,be]=te()&&x?.imageSizeData?(0,f.getImageSizeStylesFromAdvancedImageEditorSizeData)(x.imageSizeData,t,!1,o):(0,f.getImageSizeStyles)(O,t,!q.current,o),ge=Boolean(i.imageShape)&&i.imageShape!==bt.ImageShape.Default,ve=re()?{}:wt(g)?{opacity:0}:{};be&&parseInt(be,10)>R&&(ve.width=`${R}px`);const ye={top:ge?3.5:0};let Se,De;const Ie=function(e){return qe(e)?630:void 0}(F),xe=function(e){return qe(e)?250:Qe(e)?800:void 0}(F);if(Ie||xe){const{newWidth:e,newHeight:t}=function(e,t,n,a){let i=e,r=t;const o=e/t;return n&&e>n&&(i=n,r=i/o),a&&r>a&&(r=a,i=r*o),{newWidth:i,newHeight:r}}(R,H,Ie,xe);Se=e,De=t}const Ce=!st(F),Oe=l._SPKillSwitch.isActivated("1675210f-385b-4e20-9be6-e45cd577c771")?(0,c.disabledImageContextMenuInlineStyles)(O.contentProvider):void 0;return Oe&&S._TraceLogger.logVerbose(ae,c.DISABLE_IMAGE_CONTEXT_MENU_MESSAGE),e.createElement("div",{ref:z},a!==je.Crop&&a!==je.CropAspectRatio&&a!==je.Shape&&!ge&&e.createElement("div",{onClick:e=>{Q&&a===je.None&&!e.shiftKey&&se(je.Resize)},className:(0,n.mergeStyles)({outline:"none"}),tabIndex:0,onKeyDown:e=>{Q&&"Enter"===e.key&&se(je.Resize)},role:a===je.None&&Q?"button":"none","aria-label":a===je.None&&Q?T.V$:"",ref:G},e.createElement("div",{className:(0,n.css)(U,st(F)?"l_jEIZj_L250R":void 0),ref:K,style:ve},e.createElement(f.SPImg,{"data-sp-originalimgsrc":O.imageUrl,key:O.imageUrl,serviceScope:b,imageData:O,width:Ie||xe?`${Se}px`:te()?N.width:be,height:Ie||xe?`${De}px`:void 0,callerId:g||Ot,alt:i.isDecorative?"":i.altText,getDefaultImage:c.DefaultImageHelper.getDefaultImage,onImageLoad:(e,a)=>{K.current&&(K.current.style.opacity="1"),q.current=("cdn"===a||"vroom"===a||"vroomCrossGeo"===a||"optimalStaticImage"===a)&&(0,f.isCropDataValid)(O.cropData,O.imageNaturalHeight,O.imageNaturalWidth),m&&m(),l._SPKillSwitch.isActivated("25f65589-cff9-40bf-8ee4-a9cf73f799f8")&&W?.current&&b.consume(yt.CoachmarkUtility.serviceKey).attachCoachmark({positioningContainerProps:{directionalHint:n.DirectionalHint.topLeftEdge,directionalHintForRTL:n.DirectionalHint.topRightEdge,className:"p_S995V_L250R"},localStorageKey:"DismissedImageEditControlCoachmark",featureGroupKey:"imageFPSCoachmark",target:W?.current,content:T.Lu,teachingBubbleProps:{headline:T.DZ,hasCondensedHeadline:!0,primaryButtonProps:{target:"_blank",text:T.DF,href:"https://go.microsoft.com/fwlink/?linkid=2042231&clcid=0x409"}}}).catch(e=>S._TraceLogger.logError(ae,e,"AttachCoachmark")),(()=>{if(!W?.current||!K.current)return;const e=W.current,n=K.current;if(q.current||void 0===t||void 0===O.cropData)n.style.width="",n.style.height="",e.style.left="",e.style.top="",e.style.maxWidth="100%";else{n.style.width=R+"px",n.style.height=H+"px";const t=R/O.cropData.width;e.style.left=-Math.round(O.cropData.x*t)+"px",e.style.top=-Math.round(O.cropData.y*t)+"px",e.style.maxWidth=""}})()},onImageLoadFailure:h,thumbnailWidth:Math.max(A._CACHE_BREAKPOINT_S,t),imgRef:e=>W.current=e,cacheBuster:ne()&&x?x.cacheBuster:O.cacheBuster,encodedImage:O.encodedImage,displayMode:l.DisplayMode.Edit,style:Oe}),v&&!at(F)&&e.createElement(gt.ImageOverlay,{style:{backgroundColor:i.overlayTextStyles?.overlayColor,opacity:i.overlayTextStyles?.overlayTransparency,width:be,height:he}}))),(a===je.Shape||ge)&&$&&e.createElement("div",{onClick:e=>{Q&&!e.shiftKey&&se(je.Resize)},onKeyDown:e=>{!Q||"Enter"!==e.key&&" "!==e.key||se(je.Resize)},role:"button","aria-label":a===je.Shape?T.V$:"",ref:V},e.createElement("div",{className:(0,n.css)(U),ref:K},$&&e.createElement($,{imageData:O,previouslySavedShape:i.imageShapeData?.imageShape,callerId:g||Ot,thumbnailWidth:Math.max(A._CACHE_BREAKPOINT_S,R),imageTransformData:O.imageShapeData?.imageTransformData,serviceScope:b,getDefaultImage:c.DefaultImageHelper.getDefaultImage,imageShape:O.imageShape,isShapeCentered:Ce,width:Ie||xe?Se:te()?N.width:R,height:Ie||xe?De:te()?N.height:H,handleSave:async(e,t,n,a,i)=>{I(e,t,n,a,i)},onRenderComplete:u,onImageShapesComplete:()=>{se(je.None)},onImageLoad:m,onImageLoadFailure:h,cacheBuster:ne()&&x?x.cacheBuster:void 0}),v&&e.createElement(gt.ImageOverlay,{style:{backgroundColor:i.overlayTextStyles?.overlayColor,opacity:i.overlayTextStyles?.overlayTransparency,width:te()?N.width:be}}))),a===je.Resize&&J&&!o?e.createElement("div",{style:{position:"relative"}},e.createElement(J,{initialHeight:H,initialWidth:R,isFullWidth:r,alignment:O.alignment||"Center",maximumWidth:t,resizeBorderOffsets:ye,onResize:e=>{y&&y(!1),w({...O,resizeDesiredWidth:te()&&x?.imageSizeData?void 0:e.width,resizeCoefficient:te()&&x?.imageSizeData?void 0:e.width/t}),B({height:e.height,width:e.width})},onResizeComplete:e=>{let n;if(se(je.None),y&&y(!0),i.uniqueId&&x?.imageSizeData){const a={...x.imageSizeData,resizeDesiredWidth:e.width,croppedDisplayWidth:e.width,croppedDisplayHeight:e.height,resizeCoefficient:e.width/t},r="RefreshCacheBuster",o=new S._QosMonitor(`Resizer.${r}`,!1);try{n=(0,vt._refreshCacheBuster)(i.uniqueId,a),o.writeSuccess()}catch(e){throw o.writeUnexpectedFailure(`Resizer.${r}.UploadFailure`,e),e}}d({...O,resizeDesiredWidth:te()&&x?.imageSizeData?void 0:e.width,resizeCoefficient:te()&&x?.imageSizeData?void 0:e.width/t},n)}})):e.createElement(e.Fragment,null),a!==je.Crop&&a!==je.CropAspectRatio||!X?e.createElement(e.Fragment,null):e.createElement(e.Fragment,null,e.createElement(X,{callerId:g||Ot,serviceScope:b,workingAreaRef:z,imageData:O,onCropComplete:(e,t)=>{((e,t)=>{const n="CompleteAdvancedInlineCrop",a=Ke(`Image Webpart ${n} Failure`,b),i=new S._QosMonitorShareFailureWithCP(`ImageEditorNext.${n}`,!0,[a]);try{D(t,e.width,e.height,!1),i.writeSuccess()}catch(e){throw i.writeUnexpectedFailure(`ImageEditorNext.${n}.UploadFailure`,e),e}})(e,t),S._EngagementLogger.logEventWithLogEntry(new S._LogEntry("AdvancedCropper","AspectRatioSave.Click",S._LogType.Event,{newAspectRatio:Ct.get(E)})),se(je.None),d({...O,isAspectRatioLockedOnLoad:!(!te()||!x?.imageSizeData)&&void 0,cropData:void 0})},componentSize:te()?{height:H,width:R}:ee,aspectRatio:E,cacheBuster:ne()&&x?x.cacheBuster:void 0})))}),At=(e,t,n)=>({".ms-Fabric--isFocusVisible &:focus::after":{border:`1px solid ${e}`,borderRadius:t,inset:"0",outline:`2px solid ${n}`}});function Lt(e){const{theme:t,primary:a}=e;return(0,n.concatStyleSets)(function(e){const{effects:t}=e;return{root:{paddingLeft:"12px",paddingRight:"12px",borderRadius:t.roundedCorner4}}}(t),a?function(e){const{effects:t,palette:n,semanticColors:a}=e;return{root:{backgroundColor:a.primaryButtonBackground,borderColor:a.primaryButtonBorder,color:a.primaryButtonText,...At(n.white,t.roundedCorner4,a.focusBorder),".ms-Fabric--isFocusVisible &:focus":{"@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)":{outline:"2px solid buttontext"}}},rootHovered:{backgroundColor:a.primaryButtonBackgroundHovered,borderColor:a.primaryButtonBackgroundHovered,color:a.primaryButtonTextHovered},rootPressed:{backgroundColor:a.primaryButtonBackgroundPressed,borderColor:a.primaryButtonBackgroundPressed,color:a.primaryButtonTextPressed},rootDisabled:{backgroundColor:a.primaryButtonBackgroundDisabled,borderColor:a.primaryButtonBackgroundDisabled,color:a.primaryButtonTextDisabled}}}(t):function(e){const{effects:t,palette:n,semanticColors:a}=e;return{root:{borderColor:a.buttonBorder,color:a.buttonText,...At("transparent",t.roundedCorner4,a.focusBorder)},rootHovered:{backgroundColor:a.buttonBackgroundHovered,borderColor:n.neutralTertiaryAlt,color:a.buttonTextHovered},rootPressed:{backgroundColor:a.buttonBackgroundPressed,borderColor:n.neutralTertiary,color:a.buttonTextPressed},rootDisabled:{backgroundColor:a.buttonBackgroundDisabled,borderColor:a.buttonBorderDisabled,color:a.buttonTextDisabled}}}(t))}var kt=z(4948),Mt=z(5519);const Pt=e=>{const t=new E.SPFileHandler({serviceScope:e.serviceScope,qosPrefix:e.QosTag});let n,a=!1;const i=e=>{const t=T.zV;return e.returnValue=t,t},r=(t,r)=>{if(window.removeEventListener("beforeunload",i),n&&n.naturalHeight&&n.naturalWidth){const i=n;dt(i).then(e=>{a=e}).catch(e=>{a=!1}).then(()=>{const n=a?i.naturalHeight:i.naturalWidth,o=a?i.naturalWidth:i.naturalHeight;e.onUploadComplete(t,r,n,o)})}else e.onUploadComplete(t,r)},o=t=>{window.removeEventListener("beforeunload",i),e.onUploadError&&e.onUploadError(t,e.externalFile?e.externalFile.src:void 0)},s=()=>Math.floor(4294967296*Math.random()).toString(),d=n=>{const a=new Mt._QosMonitor(e.QosTag);try{let e="";const d=s(),u="src"in n;if(n instanceof File&&E.SPFileHandler.validateFileType(n,c.spConstants.imageExtensions))e=`${d}-${E.SPFileHandler.replaceSpecialCharacters(n.name)}`;else if(n instanceof Blob&&t.validateMimeType(n,c.spConstants.imageExtensions))e=`${d}.${n.type.split("/").pop()}`;else{if(!u||!E.SPFileHandler.validateFileType(n.src,c.spConstants.imageExtensions))return o(new Error(T.Hg)),void a.writeExpectedFailure("InvalidFileType");n=n,e=`${d}-${E.SPFileHandler.replaceSpecialCharacters(n.name)}`}window.addEventListener("beforeunload",i),(n instanceof File||n instanceof Blob?t.uploadLocalFile(n,e):t.uploadExternalFile(n.src,e)).then(t=>{l._SPKillSwitch.isActivated("215d1cd5-38da-4f1f-8da8-d3ff1cfe4cd0")?r(t,n instanceof File?n.name:void 0):r(t,n instanceof File?e||n.name:void 0),a.writeSuccess()}).catch(e=>{!l._SPKillSwitch.isActivated("b53378d6-f31e-4c45-a1da-80d2933dc8db")&&e.errorCode&&(0,c.isExpectedClientError)(e.errorCode)?a.writeExpectedFailure("UploadFailure",e):a.writeUnexpectedFailure("UploadFailure",e),o(e)}).catch(e=>{a.writeUnexpectedFailure("UploadFailure",e),o(e)})}catch(e){a.writeUnexpectedFailure("UploadFailure",e),o(e)}},u=()=>{const{externalFile:n,imageUrl:a,localFile:l,pageContext:u}=e;n?d(n):a&&c.UrlUtility.isValidURL(a)&&!c.UrlUtility.isVanityUrl(a,u)?(n=>{const a=new Mt._QosMonitor(e.QosTag);try{const e=n.lastIndexOf("/"),c=n.substring(e+1),d=s()+E.SPFileHandler.replaceSpecialCharacters(c);window.addEventListener("beforeunload",i),t.uploadExternalFile(n,d).then(e=>{r(e,d),a.writeSuccess()}).catch(e=>{a.writeUnexpectedFailure("UploadPromise",e),o(e)})}catch(e){a.writeUnexpectedFailure("CatchAll",e),o(e)}})(a):l&&d(l)};X()?e.localFile?t.readFile(e.localFile).then(e=>{P.loadImage(e).then(e=>{n=V()?void 0:e,u()}).catch(e=>{o(e)})}).catch(e=>{S._TraceLogger.logError(S._LogSource.create("LocalFileUpload"),e,"UploadLocalFile"),o(e)}):e.externalFile&&P.loadImage(e.externalFile.src).then(e=>{n=V()?void 0:e,u()}).catch(e=>{S._TraceLogger.logError(S._LogSource.create("LocalFileUpload"),e,"UploadExternalFile"),o(e)}):u()};var Tt=z(7263);const Ut=({pageContext:e,serviceScope:t,localFile:n,blobFile:a,externalFile:i,stateImageUrl:r,propsImageUrl:o,onUploadStart:s,onUploadComplete:c,onUploadError:d})=>()=>{const l=a||n,u=i&&nt(i.src)?void 0:i,f=j()?o:l||u?void 0:r;(l||u)&&(s(),Pt({serviceScope:t,pageContext:e,localFile:l,externalFile:u,imageUrl:f,QosTag:"ImageUpload",onUploadComplete:c,onUploadError:d}))};function Ft(e,t){const n=t.web.absoluteUrl,a=l.UrlUtilities.isAbsoluteUrl(n)?new d.Uri(n).getLeftPart(d.UriPartial.authority):window.location.origin;e.includes("-my")?e.replace("-my","")===a?S._EngagementLogger.logEvent("ImageWebPart.OneDriveUpload.SameGeo"):S._EngagementLogger.logEvent("ImageWebPart.OneDriveUpload.DifferentGeo"):e===a?S._EngagementLogger.logEvent("ImageWebPart.Upload.SameGeo"):S._EngagementLogger.logEvent("ImageWebPart.Upload.DifferentGeo")}var Ht=z(2250);const Rt=({selectedItem:e,serviceScope:n,getSPFileHandler:a,onUploadStart:i,onUploadComplete:r,onUploadError:o})=>{const s=(0,E.getSharePointImageUrl)(e);let c="";try{c=$e(s,!0)}catch{c=e.UniqueId}const d=ae();return async()=>{i();const{SiteId:f,ListId:p,UniqueId:m}=e,_=new S._QosMonitor("ImageWebPart.CopyImageV2");try{const i=async e=>{const t=new S._QosMonitor("ImageWebPart.LoadOriginalImage");try{const n=await P.loadImage(e);return t.writeSuccess(),n}catch(e){throw t.writeUnexpectedFailure("Failed to download original image"),e}},o=async e=>{const t=new S._QosMonitor("ImageWebPart.UploadCrossSiteImage");try{const n=await a().uploadExternalFile(e.replace(/&/g,encodeURIComponent("&")),c,!0);return t.writeSuccess(),n}catch(e){throw t.writeUnexpectedFailure("Failed to upload image"),e}},h=l.UrlUtilities.isAbsoluteUrl(s)?new t.Uri(s).getLeftPart(t.UriPartial.authority):window.location.origin;let g;if(d)g=await a().moveCopyExternalFileToSiteAssets(e);else{const e=(await(0,Ht.getItemWithAadHttpClient)(n,h,f,p,m))["@content.downloadUrl"];g=await o(e)}b()||Ft(h,n.consume(u.PageContext.serviceKey));const v=await i(g.serverRelativeUrl);_.writeSuccess();const y=await dt(v);r(g,c,y?v.naturalHeight:v.naturalWidth,y?v.naturalWidth:v.naturalHeight)}catch(e){_.writeUnexpectedFailure("Copy image V2 failed",e),o(e,s)}}};function Nt({successResponse:e,persistedState:t,stateImageUrl:n,propsImageUrl:a,pageContext:i,serviceScope:r,blobFile:o,getSPFileHandler:s,setImageData:u,onUploadStart:f,onUploadComplete:p,onUploadError:m}){let _=()=>{};const h=e.localFilesPickedToUpload?.[0],g=e.externalImagesPickedToUpload?.[0];if(h||g)_=g?.src&&nt(g.src)?(({stockImage:e,persistedState:t,setImageData:n,onUploadStart:a,onUploadError:i})=>()=>{N()||a(),n({...t,imageUrl:e.src,fileName:e.name,insertionISOTimestamp:(0,c.getTimestampForGettyContent)(e.contentProvider),stockMediaId:e.id,advancedImageEditorData:{isAdvancedEdited:!1},contentProvider:e.contentProvider,altText:l._SPKillSwitch.isActivated("a5093fc4-0f69-48c4-be44-64f55c174bd3")?void 0:e.description}).catch(e=>{H()||i(e,void 0)})})({stockImage:g,persistedState:t,setImageData:u,onUploadStart:f,onUploadError:m}):Ut({stateImageUrl:n,propsImageUrl:a,pageContext:i,serviceScope:r,blobFile:o,localFile:h?.file,externalFile:g,onUploadStart:f,onUploadComplete:p,onUploadError:m});else if(e.selectedItems?.[0]?.Link){const[n]=e.selectedItems;_=(ae()?n.ShouldCopySelectedFileToSiteAssetFolder:(0,E.isExternalSharePointAsset)(i,n))?Rt({selectedItem:n,serviceScope:r,getSPFileHandler:s,onUploadStart:f,onUploadComplete:p,onUploadError:m}):(({selectedItem:e,persistedState:t,setImageData:n,onUploadStart:a,onUploadError:i,pageContext:r})=>{const o=(0,E.getSharePointImageUrl)(e);return b()||Ft(l.UrlUtilities.isAbsoluteUrl(o)?new d.Uri(o).getLeftPart(d.UriPartial.authority):window.location.origin,r),()=>{a(),n({...t,imageUrl:o,listId:e.ListId,siteId:e.SiteId,webId:e.WebId,uniqueId:e.UniqueId,fileName:R()?void 0:$e(o),advancedImageEditorData:{isAdvancedEdited:!1}}).catch(e=>{H()||i(e,void 0)})}})({selectedItem:n,persistedState:t,setImageData:u,onUploadStart:f,onUploadError:m,pageContext:i})}_()}var Bt;!function(e){e[e.None=0]="None",e[e.Uploading=1]="Uploading",e[e.Downloading=2]="Downloading",e[e.Completed=3]="Completed"}(Bt||(Bt={}));const jt=(0,n.classNamesFunction)(),Vt="ImageEdit";class zt extends e.Component{static getDerivedStateFromProps(e,t){return{...t,imageData:{...t.imageData,...e.imageData},imageSourceType:et(e.imageData.imageUrl),loadingPhase:e.imageData.imageUrl||3!==t.loadingPhase?t.loadingPhase:0}}componentDidMount(){this._addDragAndDropListeners(),l._SPEventManager.instance.registerEvent("IMAGE_URL_CACHE_BUSTER_MAP_CHANGED_REMOTELY",this,this._handleCacheBusterChangedRemotely),this.props.imageBlob instanceof Blob?(this.setState({loadingPhase:1}),J()?this._localFilePreview():Ut({pageContext:this._pageContext,serviceScope:this.props.serviceScope,blobFile:this.props.imageBlob,stateImageUrl:this.state.imageData.imageUrl,propsImageUrl:this.props.imageData.imageUrl,onUploadStart:this._handleUploadStart,onUploadComplete:this._onUploadComplete,onUploadError:this._onUploadError})()):!l._SPKillSwitch.isActivated("bb630d2b-379b-41f9-8a91-2fbd898d2f04")&&this.props.externalLink?.link?function({externalLink:e,pageContext:t,serviceScope:n,getSPFileHandler:a,setImageData:i,onUploadStart:r,onUploadComplete:o,onUploadError:s}){const c=nt(e.link),d=R()?e.link:$e(e.link),u=(f={listId:e.listId,siteId:e.siteId,webId:e.webId,imageUrl:e.link,uniqueId:e.uniqueId,siteUrl:ae()?e.siteUrl||"":void 0,fileName:d}).uniqueId&&f.siteId&&f.webId&&f.listId?{UniqueId:f.uniqueId,SiteId:f.siteId,WebId:f.webId,ListId:f.listId,FileName:f.fileName,Link:f.imageUrl,SiteUrl:ae()?f.siteUrl:void 0}:void 0;var f;Nt({successResponse:{externalImagesPickedToUpload:c?[{src:e.link,name:d,id:e.stockMediaId??l.Guid.newGuid().toString(),contentProvider:e.contentProvider}]:[],selectedItems:c||!u?[]:[u]},persistedState:{alignment:void 0,overlayText:void 0,overlayTextStyles:void 0,imageShape:void 0},pageContext:t,serviceScope:n,stateImageUrl:e.link,propsImageUrl:e.link,getSPFileHandler:a,setImageData:i,onUploadStart:r,onUploadComplete:o,onUploadError:s})}({externalLink:this.props.externalLink,pageContext:this._pageContext,serviceScope:this.props.serviceScope,onUploadStart:this._handleUploadStart,setImageData:this._updateImageDimensionsFromFullImage,onUploadError:this._onUploadError,getSPFileHandler:this._ensureFileHandler,onUploadComplete:this._onUploadComplete}):this.props.renderedFromPersistedData||this.openFilePicker()}componentDidUpdate(){this.state.isDragging||this._eventListenersAdded||this._addDragAndDropListeners()}componentWillUnmount(){this._eventListenersAdded&&this._removeDragAndDropListeners(),this._unsubscribeDisposeEvent?.()}render(){const t=!(this.props.isCaptionHidden||this.props.isFullWidth||this.state.uploadError),a=(0,n.css)(this._classNames&&this._classNames.root),i=t&&e.createElement(ue.CaptionElement,{useFigCaptionTag:!0,type:ue.CaptionElementType.Caption,className:a,text:this.props.imageData.captionText,isEditMode:!0,onChange:this._handleCaptionTextChange,onHeightChange:this.props.onCaptionHeightChange,alignPosition:!Q()&&(r=this.context?.hostType,Ye(r))?ue.CaptionElementAlignPosition.PageDirection:void 0,placeholder:T.cH,moduleName:"ImageWebPart",allowResponsiveCaptionHeight:this.props.allowResponsiveCaptionHeight});var r;const o=(0,n.mergeStyles)({display:"flex",flexDirection:"Left"===this.props.imageData.alignment?"row":"row-reverse",justifyContent:"Center"===this.props.imageData.alignment?"center":"unset",height:"100%",width:"100%"}),s=e.createElement(e.Fragment,null,this._imageEditController,i,!!this.state.uploadError&&this._errorMessageBar),c=(0,n.mergeStyles)({height:"100%",width:"",flexGrow:!Q()&&ct(this.context?.hostType)?1:void 0,maxWidth:!Q()&&ct(this.context?.hostType)?"100%":void 0,margin:0}),d=(0,n.mergeStyles)(o,(0,n.css)("i_BXsN2_L250R"));return e.createElement("div",{className:d,"data-automation-id":"imageEdit",ref:this._ref,lang:!l._SPKillSwitch.isActivated("3bce2743-4b96-451e-989e-fecccd9609b7")&&l._SPFlight.isEnabled(62534)?this.props.language:void 0},this.state.isDragging&&ze,e.createElement("figure",{className:c},s))}get _classNames(){return Boolean(this.props.emphasisTheme)&&jt(_t,{variantTheme:this.props.emphasisTheme})}get _altTextToolTip(){const{altText:t,isDecorative:n}=this.props.imageData;if(t?.trim()||n||!(0,y.isAltTextToolTipEnabled)(this.props.serviceScope))return e.createElement(e.Fragment,null);let{imageUrl:a}=this.props.imageData;return v()||a||!this.props.externalLink?.link||(a=this.props.externalLink.link),v()||a?e.createElement(D,{imageUrl:a,imageSizeData:this.state.imageData,containerWidth:this.props.containerWidth,onAltTextVerify:this._handleAltTextVerify,onMetadataError:this._handleMetadataError,onMetadataReceived:this._handleMetadataReceived,serviceScope:this.props.serviceScope,offset:5}):e.createElement(e.Fragment,null)}get _imageEditController(){const{toolBarActionCallbacks:t,callerId:a,containerWidth:i,isFullWidth:r,serviceScope:o,isOverlayTextEnabled:s,skipDownloadingSpinner:d}=this.props,{imageSourceType:u,loadingPhase:f,mode:p,showTextOverlay:m}=this.state,_=this._isEditView,b=2===f&&Boolean(this.state.imageData.imageShape)&&this.state.imageData.imageShape!==bt.ImageShape.Default,g=(h()?3===f||b:3===f)&&Boolean(s)&&(je.None===p||je.Shape===p||je.Resize===p)&&m,v=Boolean(!Q()&&(S=this.context?.hostType,Ye(S))&&this.state.imageData.linkUrl&&3===f);var S;const D=!(0===f||3===f||d&&2===f||h()&&b),I=_&&1!==f&&e.createElement(Et,{ref:t,callerId:a,imageData:this.state.imageData,containerWidth:i,currentMode:p,isFullWidth:Boolean(r),isFlexibleControl:this.props.isFlexibleControl,serviceScope:o,onEditComplete:(e,t)=>{t?this.setState({imageData:e,cacheBusterEntry:t}):this.setState({imageData:e}),this.props.onEditComplete&&this.props.onEditComplete(e)},updateImageData:this._updateImageData,onRenderComplete:this.props.onLazyTimeout,onImageLoadFailed:this._handleImageLoadFailed,onImageLoad:this._handleImageLoaded,onEditModeChange:e=>this.setState({mode:e}),updateTextOverlayDisplay:p===je.Resize?this._updateTextOverlayDisplay:void 0,isOverlayTextEnabled:s,saveAdvancedImageEdit:this.saveAdvancedImageEdit,saveShapeEdit:this.saveShapeEdit,cacheBusterEntry:ne()&&this.state.imageData.advancedImageEditorData?.isAdvancedEdited?(0,vt._getCacheBusterEntry)(this.state.imageData.uniqueId):void 0});return e.createElement("div",{ref:this._imageEditControlRef,style:{height:D?`${this._getReservedHeight()}px`:void 0}},e.createElement("div",{"aria-label":_?T.DZ:void 0,className:(0,n.css)("e_Hz3wc_L250R",{o_HkHrP_L250R:wt(a),s_3NoVW_L250R:!re()&&!te()&&D}),"data-automation-id":_?"imageEditPreview":"imageEditFrame","data-sp-a11y-checker-user-fixable":!0,"data-placeholder-enabled":l._SPKillSwitch.isActivated("e713f69c-338c-4350-a308-ce79fd9446e7")?void 0:u===c.ImageSourceType.none&&0===f},u===c.ImageSourceType.none&&0===f&&this._placeHolder,(0,y.isAltTextToolTipEnabled)(this.props.serviceScope)&&this._altTextToolTip,D&&!re()&&e.createElement(Ie.Spinner,{size:n.SpinnerSize.large,label:1===f?T.lx:T.zh,className:te()?"s_3vOeT_L250R":void 0}),g&&this._overlayTextField,v&&this._renderLink,I),ee()&&this.state.showFilePicker&&e.createElement(E.SPFilePickerHostLoader,{serviceScope:o,show:this.state.showFilePicker,app:"SPPages",scenario:"SPImageEdit",siteUrl:this._pageContext.site.absoluteUrl,enableStockImagesTabs:["Stickers","Illustrations"],handleCancel:async()=>{this._onFileCanceled(),this.setState({showFilePicker:!1})},handlePick:async e=>{J()?this._onFileSelectedOld(e):this._onFileSelected(e),this.setState({showFilePicker:!1})}}),this.state.mode===je.AdvancedEditor&&e.createElement(St.AdvancedEditor,{callerId:a||"ImageEdit",serviceScope:o,imageData:this.state.imageData,isOpen:this.state.mode===je.AdvancedEditor,handleClose:this.closeAdvancedEditor,handleSave:this.saveAdvancedImageEdit,cacheBuster:ne()?this.state.cacheBusterEntry?.cacheBuster:this.state.imageData.cacheBuster}))}_getReservedHeight(){const{displayHeight:e}=(0,f.getDisplaySizeFromImageData)(this.state.imageData,this.props.containerWidth,this.props.isFlexibleControl);return e||326}_updateImageData(e){this.setState({imageData:e})}get _isEditView(){const{imageSourceType:e,loadingPhase:t}=this.state;return!(e===c.ImageSourceType.none&&1!==t)}get _placeHolder(){if(this.props.hidePlaceholder)return;const{roundedCorner:t}=this.props.imageData,a=!l._SPFlight.isEnabled(62215)&&1!==l._SPExperiment.getVariantAndLogExposure(90078)||l._SPKillSwitch.isActivated("58adf7cd-e618-403b-8fb1-08b67c8895c9")?T.FB:T.QN,i=T.wA;let r;this.props.isAspectRatioLockedOnLoad&&this.props.aspectRatioOnLoad&&(r=Math.round(this.props.containerWidth/this.props.aspectRatioOnLoad));let o=e.createElement(ue.Placeholder,{icon:"Photo2",iconText:T.m7,description:a,buttonLabel:i,onAdd:this.openFilePicker,webpartWidth:this.props.containerWidth,placeholderHeight:r,contentClassName:(0,n.mergeStyles)({width:this.props.containerWidth,borderRadius:t,overflow:t?"hidden":"unset"})});if(l._SPFlight.isEnabled(60803)||l._SPFlight.isEnabled(60804)){const t={DefaultButton:{styles:Lt}};o=e.createElement(e.Fragment,null,e.createElement(pt.Customizer,{scopedSettings:t},o))}return o}_localFilePreview(e){const t=this.props.imageBlob||e&&e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0&&e.localFilesPickedToUpload[0]&&e.localFilesPickedToUpload[0].file||void 0;let n=e&&e.externalImagesPickedToUpload&&e.externalImagesPickedToUpload.length>0&&e.externalImagesPickedToUpload[0]||void 0;n&&nt(n.src)&&(n=void 0);const a=j()?this.props.imageData.imageUrl:t||n?void 0:this.state.imageData.imageUrl;(t||n)&&Pt({serviceScope:this.props.serviceScope,pageContext:this._pageContext,localFile:t,externalFile:n,imageUrl:a,QosTag:"ImageUpload",onUploadComplete:this._onUploadComplete,onUploadError:this._onUploadError})}get _renderLink(){return e.createElement("div",{className:"i_GzpND_L250R"},e.createElement(a.Link,{href:this.state.imageData.linkUrl,target:"_blank",rel:"noopener noreferrer"},this.state.imageData.linkUrl))}get _overlayTextField(){const t=this.context?.hostType,{imageData:n}=this.state,{displayWidth:a,displayHeight:i}=(0,f.getDisplaySizeFromImageData)(n,this.props.containerWidth,this.props.isFlexibleControl);return e.createElement(ft,{text:n.overlayText,overlayTextHTML:n.overlayTextHTML,overlayTextStyles:n.overlayTextStyles,onChangeText:this._handleOverlayTextChange,onChangeHTMLText:this._handleOverlayTextHTMLChange,onChangeStyle:this._handleOverlayTextStyleChanged,offset:0,hostWidth:a,hostHeight:i,qosPrefix:"ImageWebPart",serviceScope:this.props.serviceScope,styles:!Q()&&at(t)?{marginLeft:0,position:"relative"}:void 0,enableDragging:!!Q()||it(t),webPartContext:Q()?this.props.webPartContext:void 0})}_buildExclusionList(){const e=new Set;return!l._SPKillSwitch.isActivated("34e19bc8-cf54-4e16-b149-89ecd4088194")&&kt._ScribeUtilities.isScribeHosted(Number(this._pageContext.legacyPageContext.webTemplate))&&(e.add(1),e.add(2),e.add(3),e.add(5)),e}get _errorMessageBar(){let t;return t=this.state.uploadErrorSrc?e.createElement("span",null,T.Vq,e.createElement("br",null),e.createElement(a.Link,{className:"e_RPwGL_L250R",href:this.state.uploadErrorSrc,onClick:this._handleClickSourceSite,target:"_blank"},T.mw)):this.state.uploadError?e.createElement("span",null,this.state.uploadError.message):void 0,e.createElement(mt.MessageBar,{className:"e_LGEqf_L250R",messageBarType:n.MessageBarType.error},t)}constructor(a){super(a),this.isDisposed=!1,this._ref=e.createRef(),this._eventListenersAdded=!1,this._imageEditControlRef=e.createRef(),this.openAdvancedEditor=()=>{S._EngagementLogger.logEvent("AdvancedEditor.OpenButton.Click"),this.setState({mode:je.AdvancedEditor})},this.closeAdvancedEditor=()=>{this.setState({mode:je.None})},this.saveAdvancedImageEdit=(e,t,n,a)=>{const i=a?"SaveAdvancedImageEditOriginal":"SaveAdvancedImageEditCopy",r=Ke(`Image Webpart ${i} Failure`,this.props.serviceScope),o=new S._QosMonitorShareFailureWithCP(`ImageEdit.${i}`,!1,[r]),{fileName:d,imageUrl:u,uniqueId:p,listId:m,webId:h,siteId:b,advancedImageEditorData:v,contentProvider:y,stockMediaId:D,insertionISOTimestamp:I}={...this.state.imageData},{imageNaturalWidth:x,imageNaturalHeight:C,resizeCoefficient:O,resizeDesiredWidth:w}=te()&&this.state.cacheBusterEntry?.imageSizeData?this.state.cacheBusterEntry?.imageSizeData:this.state.imageData,E=x!==t||C!==n,A=E?(0,f.calculateCroppedImageSizeForDisplayContainer)(te()&&this.state.cacheBusterEntry?.imageSizeData?this.state.cacheBusterEntry.imageSizeData:this.state.imageData,{width:t,height:n},this.props.containerWidth):void 0,L=d&&c.ExtensionHelper.getExtension(d)?d:$e(u),k=v&&v.isAdvancedEdited&&v.originalFileName?Ze(v.originalFileName):$e(u,!0);let M;const P=v?.isAdvancedEdited?{...v,...tt(E,t,n,A)}:{isAdvancedEdited:!0,originalSourceUrl:u,originalUniqueId:p,originalFileName:L,originalHeight:this.state.imageData.imageNaturalHeight,originalWidth:this.state.imageData.imageNaturalWidth,originalListId:m,originalWebId:h,originalSiteId:b,...tt(E,t,n,A)},U=a&&v?.isAdvancedEdited?L:k;this.setState({loadingPhase:1});const F=!g()&&(0,c.isGettyContent)(y)?D:void 0;this._ensureFileHandler().uploadLocalFile(e,U,void 0,void 0,void 0,void 0,F).then(e=>{if(ne()){if(e.uniqueId){const a=(0,vt._getCacheBusterEntry)(e.uniqueId),i=(0,f.calculateCroppedImageSizeForDisplayContainer)(a?.imageSizeData||this.state.imageData,{width:t,height:n},this.props.containerWidth),r={imageNaturalWidth:t,imageNaturalHeight:n,croppedDisplayWidth:E?A?.croppedDisplaySize.width:te()?i?.croppedDisplaySize.width:void 0,croppedDisplayHeight:E?A?.croppedDisplaySize.height:te()?i?.croppedDisplaySize.height:void 0,resizeCoefficient:E?A?.croppedResizeCoefficient:te()&&a?.imageSizeData?.resizeCoefficient?i?.croppedResizeCoefficient:void 0,resizeDesiredWidth:E?A?.croppedDisplaySize.width:w},o="RefreshCacheBuster",s=new S._QosMonitor(`SaveAdvancedImageEdit.${o}`,!1);try{const t=(0,vt._refreshCacheBuster)(e.uniqueId,r);s.writeSuccess(),this.setState({cacheBusterEntry:t})}catch(e){s.writeUnexpectedFailure(`ImageEdit.${o}.RefreshFailure`,e)}}}else M=l.Guid.newGuid().toString();this._onUploadComplete(!g()&&ie()?{...e,contentProvider:F?y:void 0,stockMediaId:F,insertionISOTimestamp:F?I:void 0}:e,U,te()?void 0:t,te()?void 0:n,te()?void 0:E?A?.croppedResizeCoefficient:O,te()?void 0:E?A?.croppedDisplaySize.width:w,P,ne()?void 0:M,!X()),o.writeSuccess(),_()?c.ScreenReaderAlert.read(T.wi,c.ReadingMode.ReadImmediately):s.read(T.wi,2)}).catch(e=>{throw this.setState({loadingPhase:3}),o.writeUnexpectedFailure(`ImageEdit.${i}.UploadFailure`,e),e})},this.saveShapeEdit=(e,t,n,a,i)=>{const{contentProvider:r,stockMediaId:o}={...this.state.imageData},s=Ke("Image Webpart SaveShapeEdit Failure",this.props.serviceScope),d=new S._QosMonitorShareFailureWithCP("ImageEdit.SaveShapeEdit",!1,[s]),{fileName:u,imageUrl:f}={...this.state.imageData},p=this.state.imageData.imageShapeData?.version||Date.now().toString(),m=u?c.ExtensionHelper.getExtension(u):void 0,_=`shape-${u&&m?!l._SPKillSwitch.isActivated("8f281f08-35a5-4ebc-8674-19c421e195dc")&&i&&i!==m?u.replace(RegExp(`\\.${m}$`,"i"),`-${p}.${i}`):u:$e(f,!1,p,i)}`,h=!g()&&(0,c.isGettyContent)(r)?o:void 0;this._ensureFileHandler().uploadLocalFile(e,_,void 0,void 0,void 0,void 0,h).then(e=>{const i={...this.state.imageData,imageShapeData:{imageShape:this.state.imageData.imageShape,version:p,savedImageShape:{...e,siteId:this._pageContext.site.id.toString(),webId:this._pageContext.web.id.toString()},width:t,height:n,imageTransformData:a}};this._onEditComplete(i),d.writeSuccess()}).catch(e=>{throw d.writeUnexpectedFailure("ImageEdit.SaveShapeEdit.UploadFailure",e),e})},this.openFilePicker=()=>{ee()?this.setState({showFilePicker:!0}):(this._ensurePickerMonitor(),this._ensureFilePicker().then(e=>{this.state.imageData.imageUrl?S._EngagementLogger.logEvent("ImageWebPart.ImageUrl","Change"):S._EngagementLogger.logEvent("ImageWebPart.ImageUrl","Add"),e.open()}).catch(e=>{throw this._imagePickerMonitor&&this._imagePickerMonitor.writeUnexpectedFailure("FilePickerFailure",e),e}))},this.handleDataPaste=(e,t)=>{if(!e.clipboardData?.items)return;e.stopPropagation();const n="ClipboardDataPasted",a=e.clipboardData.items,i="text/html";t||(t=e.clipboardData.getData(i));const r=(new DOMParser).parseFromString(t||"",i).querySelector("img")?.src||"";c.UrlUtility.isValidURL(r)&&!c.UrlUtility.isVanityUrl(r,this._pageContext)?this._handleNewDataTransferItems(a,n,r):this._handleNewDataTransferItems(a,n)},this.handleDataDrop=e=>{if(!e.dataTransfer?.items)return;e.preventDefault(),e.stopPropagation();const t=e.dataTransfer.items;this._handleNewDataTransferItems(t,"DataTransferDropped")},this._handleAltTextVerify=(e,t)=>{this.props.onVerifyAltText?.(e,t)},this._handleMetadataError=e=>{S._TraceLogger.logError(S._LogSource.create(Vt),e,"AltTextMetadataGeneration"),this.setState({metadataError:e})},this._handleMetadataReceived=e=>{this.setState({candidateAltText:e?.imageCaption?.caption||""})},this._updateTextOverlayDisplay=e=>{this.setState({showTextOverlay:e})},this._handleNewDataTransferItems=(e,t,n)=>{if(e instanceof DataTransferItemList)for(let a=0;a<e.length;a++)if("file"===e[a].kind&&e[a].type.match("^image/")){const i=e[a].getAsFile();if(i){this.setState({loadingPhase:1});const e=Date.now().toString(),a=Ke(`Image Webpart EditControl ${t} Failure`,this.props.serviceScope),r=new S._QosMonitorShareFailureWithCP(`ImageEdit.${t}`,!0,[a]);if(n){const e=R()?Xe(n):$e(n,!0);this._ensureFileHandler().uploadExternalFile(n,e).then(t=>{this._onUploadComplete(t,e),r.writeSuccess()}).catch(e=>{this.setState({loadingPhase:3}),r.writeUnexpectedFailure(`ImageEdit.${t}.UploadFailure`,e)})}else{const n=e+E.SPFileHandler.replaceSpecialCharacters(i.name);this._ensureFileHandler().uploadLocalFile(i,n).then(e=>{this._onUploadComplete(e,n),r.writeSuccess()}).catch(e=>{this.setState({loadingPhase:3}),r.writeUnexpectedFailure(`ImageEdit.${t}.UploadFailure`,e)})}return}}},this._handleOverlayTextChange=e=>{this.props.onOverlayTextChanged&&this.props.onOverlayTextChanged(e)},this._handleOverlayTextHTMLChange=e=>{if(this.props.onOverlayTextHTMLChanged){this.props.onOverlayTextHTMLChanged(e);const t=(0,ue.getPlainTextFromHTML)(e);this.props.onOverlayTextChanged?.(t)}},this._handleOverlayTextStyleChanged=e=>{if(this.props.onOverlayTextStyleChanged&&(this.props.onOverlayTextStyleChanged(e),!$()&&!(0,ue.isNPSTextCoherencyEnabled)())){const t=lt(this.props.imageData.overlayText||"",e);this.props.onOverlayTextHTMLChanged?.(t)}},this._handleImageLoaded=()=>{this.setState({loadingPhase:3}),this.props.onImageLoad&&this.props.onImageLoad()},this._handleImageLoadFailed=e=>{this.setState({loadingPhase:3}),this.props.onImageLoadFailure&&this.props.onImageLoadFailure(e)},this._ensureFilePicker=()=>{if(!this._filePickerPromise){const e={onSelect:J()?this._onFileSelectedOld:this._onFileSelected,onCancel:this._onFileCanceled,selectionMode:n.SelectionMode.single,itemTypes:new Set([ht.Images]),callerName:"ImageWebPart",disableStockAssets:this.props.disableStockAssets,exclusionList:this._buildExclusionList(),enableExternalAssetCopyToPageAssetFolder:ae(),enableGettyStockAssets:!l._SPKillSwitch.isActivated("4d893af7-e388-43d4-a7c4-c35ec085d048")&&l._SPFlight.isEnabled(1888)};this._filePickerPromise=E.FilePickerLoader.load(this.props.serviceScope,e)}return this._filePickerPromise},this._ensurePickerMonitor=()=>{this._imagePickerMonitor=void 0;const e=Ke("Image Webpart FilePicker Failure",this.props.serviceScope);this._imagePickerMonitor=new S._QosMonitorShareFailureWithCP("ImageWebPart.FilePicker",!1,[e])},this._handleUploadStart=()=>{this.setState({loadingPhase:1})},this._onFileSelected=e=>{this._clearError(),Nt({persistedState:{alignment:this.state.imageData.alignment,overlayText:this.props.imageData.overlayText,overlayTextStyles:this.props.imageData.overlayTextStyles,imageShape:l._SPKillSwitch.isActivated("703d935d-c0dc-4a5c-812e-1307d477bb68")?void 0:this.state.imageData.imageShape},successResponse:e,stateImageUrl:this.state.imageData.imageUrl,propsImageUrl:this.props.imageData.imageUrl,pageContext:this._pageContext,serviceScope:this.props.serviceScope,blobFile:this.props.imageBlob,getSPFileHandler:this._ensureFileHandler,setImageData:this._updateImageDimensionsFromFullImage,onUploadStart:this._handleUploadStart,onUploadComplete:this._onUploadComplete,onUploadError:this._onUploadError}),this._imagePickerMonitor&&this._imagePickerMonitor.writeSuccess({action:"Select"}),_()?c.ScreenReaderAlert.read(T.Cb,c.ReadingMode.ReadImmediately):s.read(T.Cb,2),S._EngagementLogger.logEvent("ImageWebPart.OpenFilePicker","Select"),G()||l._SPEventManager.instance.raiseEvent("recordSurveyEvent",{name:"ImageEditUsage"})},this._onFileSelectedOld=e=>{if(this._clearError(),e&&(e.localFilesPickedToUpload&&e.localFilesPickedToUpload.length>0&&e.localFilesPickedToUpload[0]||e.externalImagesPickedToUpload&&e.externalImagesPickedToUpload.length>0&&e.externalImagesPickedToUpload[0]))if(N()||this.setState({loadingPhase:1}),e.externalImagesPickedToUpload?.[0]?.src&&nt(e.externalImagesPickedToUpload[0].src)){const t={alignment:this.state.imageData.alignment,imageUrl:e.externalImagesPickedToUpload[0].src,fileName:e.externalImagesPickedToUpload[0].name,advancedImageEditorData:{isAdvancedEdited:!1},overlayText:this.props.imageData.overlayText,overlayTextStyles:this.props.imageData.overlayTextStyles};this._updateImageDimensionsFromFullImage(t).catch(e=>{H()||this._onUploadError(e,void 0)})}else this.setState({loadingPhase:1}),this._localFilePreview(e);else if(e&&e.selectedItems&&e.selectedItems.length>0&&e.selectedItems[0]&&e.selectedItems[0].Link){this.setState({loadingPhase:1});const n=e.selectedItems[0],a=n.ServerAbsoluteUrl||n.Link,i=new t.Uri(a),r=i.getAuthority()===window.location.host?i.getPath():a;if(l._SPFlight.isEnabled(61766)&&n.SiteId&&n.WebId&&n.ListId&&n.UniqueId&&(this._pageContext.site.id.toString()!==l.Guid.parse(n.SiteId).toString()||this._pageContext.web.id.toString()!==l.Guid.parse(n.WebId).toString()))Rt({selectedItem:n,serviceScope:this.props.serviceScope,getSPFileHandler:this._ensureFileHandler,onUploadStart:this._handleUploadStart,onUploadComplete:this._onUploadComplete,onUploadError:this._onUploadError});else{const e={alignment:this.state.imageData.alignment,imageUrl:r,listId:n.ListId,siteId:n.SiteId,webId:n.WebId,uniqueId:n.UniqueId,fileName:R()?void 0:$e(r),overlayText:this.props.imageData.overlayText,overlayTextStyles:this.props.imageData.overlayTextStyles,advancedImageEditorData:{isAdvancedEdited:!1}};this._updateImageDimensionsFromFullImage(e).catch(e=>{H()||this._onUploadError(e,void 0)})}}this._imagePickerMonitor&&this._imagePickerMonitor.writeSuccess({action:"Select"}),_()?c.ScreenReaderAlert.read(T.Cb,c.ReadingMode.ReadImmediately):s.read(T.Cb,2),S._EngagementLogger.logEvent("ImageWebPart.OpenFilePicker","Select"),G()||l._SPEventManager.instance.raiseEvent("recordSurveyEvent",{name:"ImageEditUsage"})},this._onFileCanceled=()=>{this._imagePickerMonitor&&this._imagePickerMonitor.writeSuccess({action:"Cancel"}),S._EngagementLogger.logEvent("ImageWebPart.OpenFilePicker","Cancel"),this.props.onFilePickerCancel&&this.props.onFilePickerCancel()},this._proactiveThumbnailCdnSeed=(e,n)=>{const a=this._pageContext,i=Tt.CdnService.createFromServiceScope(this.props.serviceScope,a?.web?.absoluteUrl);void 0!==i&&(i.getCdnURLForItem(e).then(e=>{if(e&&e.CdnUrl){const n={};n[e.ItemUrl]=e.CdnUrl,t.SPAlternativeUrls.updateMap(n)}}).catch(e=>{S._TraceLogger.logError(S._LogSource.create(Vt),e,"ProactiveThumbnailSeeding")}),i.seedImageBreakpointsIntoCdn(e,n??0))},this._onUploadComplete=(e,t,n,a,i,r,o,s,d)=>{const l=this._pageContext,u=this.state.imageData.alignment,f=this.state.imageData.imageShape,p=!g()&&(0,c.isGettyContent)(e.contentProvider)?e.stockMediaId:void 0,m={alignment:u,imageNaturalWidth:te()&&o?.isAdvancedEdited?this.props.imageData.imageNaturalWidth:n,imageNaturalHeight:te()&&o?.isAdvancedEdited?this.props.imageData.imageNaturalHeight:a,imageUrl:e.serverRelativeUrl,listId:e.listId,siteId:l.site&&l.site.id&&l.site.id.toString(),webId:l.web&&l.web.id&&l.web.id.toString(),uniqueId:e.uniqueId,fileName:t,advancedImageEditorData:o,overlayText:B()?void 0:this.props.imageData.overlayText,overlayTextStyles:B()?void 0:this.props.imageData.overlayTextStyles,resizeCoefficient:te()&&this.state.cacheBusterEntry?void 0:i??1,resizeDesiredWidth:te()&&this.state.cacheBusterEntry?void 0:r,cacheBuster:ne()?void 0:s,imageShape:f,contentProvider:p?e.contentProvider:void 0,stockMediaId:p,insertionISOTimestamp:p?e.insertionISOTimestamp:void 0};(X()||d)&&this._proactiveThumbnailCdnSeed(e.serverRelativeUrl,n??0),this._onEditComplete(m)},this._onUploadError=(e,t)=>{this.setState({imageSourceType:c.ImageSourceType.none,loadingPhase:0}),this._handleUploadError&&this._handleUploadError(e,t)},this._onEditComplete=e=>{const t=void 0!==e.imageNaturalWidth&&void 0!==e.imageNaturalHeight,n={...e,captionText:e.captionText||this.props.imageData.captionText};if(t){const e=Math.max(this.state.loadingPhase,2),{onEditComplete:t}=this.props;t&&t(n),this.setState({imageData:n,imageSourceType:c.ImageSourceType.sharepointURI,loadingPhase:e})}else this._updateImageDimensionsFromFullImage(n).catch(e=>{H()||this._onUploadError(e,void 0)})},this._updateImageDimensionsFromFullImage=async(e,t={})=>{try{(0,c.isGettyContent)(e.contentProvider)&&(e.stockMediaId||e.imageUrl)&&e.insertionISOTimestamp&&(0,c.reportGettyInsertions)([{stockMediaId:e.stockMediaId,link:e.imageUrl,insertionISOTimestamp:e.insertionISOTimestamp}],this.instanceId),!l._SPKillSwitch.isActivated("c98f0d8f-9ae3-4078-9cab-6df50f7d665b")&&ie()&&(0,c.logImageContentProviderUsage)("ImageEdit",e.contentProvider);const n=Math.max(this.state.loadingPhase,2);if(e.imageNaturalHeight&&e.imageNaturalWidth){const{caption:a}=t;return void this.setState(t=>({candidateAltText:a||t.candidateAltText,imageData:e,imageSourceType:c.ImageSourceType.sharepointURI,loadingPhase:n}))}const a=await P.loadImage(e.imageUrl),i=await dt(a),r={...e,imageNaturalHeight:i?a.naturalWidth:a.naturalHeight,imageNaturalWidth:i?a.naturalHeight:a.naturalWidth};X()||this._proactiveThumbnailCdnSeed(e.imageUrl,a.naturalWidth??0),this._onEditComplete(r)}catch(e){throw S._TraceLogger.logError(S._LogSource.create(Vt),e,"UpdateImageDimensionsFromFullImage"),new Error(T.Vq)}},this._ensureFileHandler=()=>(this._spFileHandler||(this._spFileHandler=new E.SPFileHandler({serviceScope:this.props.serviceScope,qosPrefix:Vt})),this._spFileHandler),this._clearError=()=>{(this.state.uploadError||this.state.uploadErrorSrc||this.state.metadataError)&&this.setState({uploadError:void 0,uploadErrorSrc:void 0,metadataError:void 0})},this._handleCaptionTextChange=e=>{this.props.onCaptionTextChange&&this.props.onCaptionTextChange(e)},this._handleUploadError=(e,t)=>{this.setState({uploadError:e,uploadErrorSrc:t})},this._handleClickSourceSite=()=>{const e=new S._LogEntry("Image","ErrorMessageSourceSiteLink.Click",S._LogType.Event);S._EngagementLogger.logEventWithLogEntry(e)},this._handleDrop=e=>{this.setState({isDragging:!1}),this._imageEditControlRef.current&&this.handleDataDrop(e)},this._handleDragOver=e=>{if(e.dataTransfer?.items instanceof DataTransferItemList){const t=e.dataTransfer.items;for(let n=0;n<t.length;n++)if("file"===t[n].kind&&t[n].type.match("^image/"))return e.preventDefault(),void(this.state.isDragging||this.setState({isDragging:!0}))}},this._handleDragLeave=e=>{e.preventDefault(),this.state.isDragging&&this.setState({isDragging:!1})},this._handleCacheBusterChangedRemotely=e=>{e.key===this.props.imageData.uniqueId&&this.setState({cacheBusterEntry:e.value})},this._addDragAndDropListeners=()=>{this._ref.current&&(this._eventListenersAdded=!0,this._ref.current.addEventListener("drop",this._handleDrop),this._ref.current.addEventListener("dragover",this._handleDragOver),this._ref.current.addEventListener("dragleave",this._handleDragLeave))},this._removeDragAndDropListeners=()=>{this._ref.current&&(this._eventListenersAdded=!1,this._ref.current.removeEventListener("drop",this._handleDrop),this._ref.current.removeEventListener("dragover",this._handleDragOver),this._ref.current.removeEventListener("dragleave",this._handleDragLeave))},this.isDisposed=!1,this.componentId="17462473-3045-4835-b14e-3b1547691e91",this.instanceId=ie()&&a.instanceId||l.Guid.newGuid().toString(),this.props.serviceScope.whenFinished(()=>{this._pageContext=this.props.serviceScope.consume(u.PageContext.serviceKey)}),this.props.forwardRef?.({openAdvancedEditor:this.openAdvancedEditor,openFilePicker:this.openFilePicker,handleDataPaste:this.handleDataPaste}),this.state={uploadError:void 0,metadataError:void 0,isDragging:!1,candidateAltText:"",imageData:this.props.imageData,imageSourceType:et(this.props.imageData.imageUrl||this.props.externalLink?.link||""),loadingPhase:this.props.imageData.imageUrl||this.props.externalLink?.link?2:0,mode:je.None,showFilePicker:!1,showTextOverlay:!0,cacheBusterEntry:ne()&&this.props.imageData.advancedImageEditorData?.isAdvancedEdited?(0,vt._getCacheBusterEntry)(this.props.imageData.uniqueId):void 0},this.dispose=()=>{this.isDisposed=!0,l._SPEventManager.instance.unregisterEvent("IMAGE_URL_CACHE_BUSTER_MAP_CHANGED_REMOTELY",this,this._handleCacheBusterChangedRemotely)},(0,c.isControlHostCommunicatorForCoAuthEnabled)()&&this.props.serviceScope.whenFinished(()=>{const e=a.serviceScope.consume(c.ControlHostCommunicatorEdit.serviceKey);this._unsubscribeDisposeEvent=e.on("disposed",()=>this.setState({showFilePicker:!1}))})}}zt.contextType=ut;const Gt=(0,se.U)("AlignCenterVertical20Regular","20",["M10.5 18a.5.5 0 0 1-.5-.5V16H8a2 2 0 0 1-2-2v-1c0-1.1.9-2 2-2h2V9H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h4V2.5a.5.5 0 0 1 1 0V4h4a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-4v2h2a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2h-2v1.5a.5.5 0 0 1-.5.5ZM6 5a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h9a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H6Zm2 7a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-1a1 1 0 0 0-1-1H8Z"]),Kt=(0,se.U)("AlignCenterVertical24Regular","24",["M11.25 21.25V20h-2.5c-1.24 0-2.25-1-2.25-2.25v-2.5c0-1.24 1-2.25 2.25-2.25h2.5v-2h-4.5C5.51 11 4.5 10 4.5 8.75v-2.5C4.5 5.01 5.5 4 6.75 4h4.5V2.75a.75.75 0 0 1 1.5 0V4h4.5c1.24 0 2.25 1 2.25 2.25v2.5c0 1.24-1 2.25-2.25 2.25h-4.5v2h2.5c1.24 0 2.25 1 2.25 2.25v2.5c0 1.24-1 2.25-2.25 2.25h-2.5v1.25a.75.75 0 0 1-1.5 0Zm4-2.75c.41 0 .75-.34.75-.75v-2.5a.75.75 0 0 0-.75-.75h-6.5a.75.75 0 0 0-.75.75v2.5c0 .41.34.75.75.75h6.5Zm2-9c.41 0 .75-.34.75-.75v-2.5a.75.75 0 0 0-.75-.75H6.75a.75.75 0 0 0-.75.75v2.5c0 .41.34.75.75.75h10.5Z"]),Wt=(0,se.U)("AlignLeft20Regular","20",["M3.5 2a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 1 0v-15a.5.5 0 0 0-.5-.5ZM7 11a2 2 0 0 0-2 2v1c0 1.1.9 2 2 2h5a2 2 0 0 0 2-2v-1a2 2 0 0 0-2-2H7Zm-1 2a1 1 0 0 1 1-1h5a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1v-1ZM5 6c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6Zm2-1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1H7Z"]),qt=(0,se.U)("AlignLeft24Regular","24",["M3 2.75a.75.75 0 0 1 1.5 0v18.5a.75.75 0 0 1-1.5 0V2.75ZM8.25 4C7.01 4 6 5 6 6.25v2.5C6 9.99 7 11 8.25 11h10.5C19.99 11 21 10 21 8.75v-2.5C21 5.01 20 4 18.75 4H8.25ZM7.5 6.25c0-.41.34-.75.75-.75h10.5c.41 0 .75.34.75.75v2.5c0 .41-.34.75-.75.75H8.25a.75.75 0 0 1-.75-.75v-2.5ZM8.25 13C7.01 13 6 14 6 15.25v2.5C6 18.99 7 20 8.25 20h7c1.24 0 2.25-1 2.25-2.25v-2.5c0-1.24-1-2.25-2.25-2.25h-7Zm-.75 2.25c0-.41.34-.75.75-.75h7c.41 0 .75.34.75.75v2.5c0 .41-.34.75-.75.75h-7a.75.75 0 0 1-.75-.75v-2.5Z"]),Qt=(0,se.U)("AlignRight20Regular","20",["M16.5 2c.28 0 .5.22.5.5v15a.5.5 0 0 1-1 0v-15c0-.28.22-.5.5-.5ZM13 11a2 2 0 0 1 2 2v1a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2v-1c0-1.1.9-2 2-2h5Zm1 2a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-1Zm1-7a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v1c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V6Zm-2-1a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V6a1 1 0 0 1 1-1h8Z"]),Yt=(0,se.U)("AlignRight24Regular","24",["M21 2.75a.75.75 0 0 0-1.5 0v18.5a.75.75 0 0 0 1.5 0V2.75ZM15.75 4C16.99 4 18 5 18 6.25v2.5C18 9.99 17 11 15.75 11H5.25C4.01 11 3 10 3 8.75v-2.5C3 5.01 4 4 5.25 4h10.5Zm.75 2.25a.75.75 0 0 0-.75-.75H5.25a.75.75 0 0 0-.75.75v2.5c0 .41.34.75.75.75h10.5c.41 0 .75-.34.75-.75v-2.5ZM15.75 13c1.24 0 2.25 1 2.25 2.25v2.5c0 1.24-1 2.25-2.25 2.25h-7c-1.24 0-2.25-1-2.25-2.25v-2.5c0-1.24 1-2.25 2.25-2.25h7Zm.75 2.25a.75.75 0 0 0-.75-.75h-7a.75.75 0 0 0-.75.75v2.5c0 .41.34.75.75.75h7c.41 0 .75-.34.75-.75v-2.5Z"]),Jt=(0,se.U)("ImageAltText24Regular","24",["M1 3c0-1.1.9-2 2-2h7a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V3Zm2.5 1a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6Zm0 3a.5.5 0 0 0 0 1h6a.5.5 0 0 0 0-1h-6Zm.5 5h1.5v6.75c0 .2.04.4.1.6l5.83-5.7a2.25 2.25 0 0 1 3.02-.12l.12.11 5.83 5.7c.06-.18.1-.38.1-.59V7.25c0-.97-.78-1.75-1.75-1.75H13V4h5.75C20.55 4 22 5.46 22 7.25v11.5c0 1.8-1.46 3.25-3.25 3.25H7.25A3.25 3.25 0 0 1 4 18.75V12Zm15.33 8.4-5.8-5.69a.75.75 0 0 0-.97-.07l-.08.07-5.81 5.7c.18.06.38.09.58.09h11.5c.2 0 .4-.03.58-.1ZM16.25 7.5a2.25 2.25 0 1 1 0 4.5 2.25 2.25 0 0 1 0-4.5Zm0 1.5a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Z"]),Xt=(0,se.U)("ImageEdit24Regular","24",["M21 6.25C21 4.45 19.54 3 17.75 3H6.25A3.25 3.25 0 0 0 3 6.25v11.5C3 19.55 4.45 21 6.25 21h4.91l.36-1.42.02-.08H6.25c-.2 0-.4-.04-.58-.1l5.8-5.69.09-.07c.29-.2.7-.19.96.07l2.08 2.04 1.06-1.06-2.09-2.05-.13-.11a2.25 2.25 0 0 0-3.01.11l-5.83 5.7c-.06-.18-.1-.38-.1-.6V6.26c0-.97.78-1.75 1.75-1.75h11.5c.97 0 1.75.78 1.75 1.75v4.98c.48-.19 1-.26 1.5-.22V6.25Zm-3.5 2.5a2.25 2.25 0 1 0-4.5 0 2.25 2.25 0 0 0 4.5 0Zm-3 0a.75.75 0 1 1 1.5 0 .75.75 0 0 1-1.5 0Zm4.6 3.92-5.9 5.9c-.35.34-.6.78-.71 1.25l-.46 1.83c-.2.8.52 1.52 1.32 1.32l1.83-.46c.47-.12.9-.36 1.25-.7l5.9-5.9a2.29 2.29 0 0 0-3.23-3.24Z"]),Zt=(0,se.U)("RectangleLandscape20Regular","20",["M2 7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V7Zm3-2a2 2 0 0 0-2 2v6c0 1.1.9 2 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H5Z"]),$t=(0,se.U)("ResizeImage24Regular","24",["M11 2.75a.75.75 0 0 0-.75-.75h-5A3.25 3.25 0 0 0 2 5.25v5a.75.75 0 0 0 1.5 0v-5c0-.97.78-1.75 1.75-1.75h5c.41 0 .75-.34.75-.75ZM13.75 2a.75.75 0 0 0 0 1.5h5c.97 0 1.75.78 1.75 1.75v5a.75.75 0 0 0 1.5 0v-5C22 3.45 20.54 2 18.75 2h-5Zm0 20a.75.75 0 0 1 0-1.5h5c.97 0 1.75-.78 1.75-1.75v-5a.75.75 0 0 1 1.5 0v5c0 1.8-1.46 3.25-3.25 3.25h-5ZM4 12a3 3 0 0 0-3 3v5c0 .56.15 1.08.42 1.52l3.49-3.49c.88-.88 2.3-.88 3.18 0l3.5 3.5c.26-.45.41-.97.41-1.53v-5a3 3 0 0 0-3-3H4Zm0 11c-.56 0-1.08-.15-1.52-.42l3.49-3.49c.3-.3.77-.3 1.06 0l3.5 3.5c-.45.26-.97.41-1.53.41H4Zm5-7a1 1 0 1 1 0-2 1 1 0 0 1 0 2Z"]),en=(0,se.U)("TriangleUp20Regular","20",["M8.68 2.79a1.5 1.5 0 0 1 2.64 0l6.5 12a1.5 1.5 0 0 1-1.32 2.2h-13a1.5 1.5 0 0 1-1.32-2.2l6.5-12Zm1.76.47a.5.5 0 0 0-.88 0l-6.5 12a.5.5 0 0 0 .44.74h13a.5.5 0 0 0 .44-.74l-6.5-12Z"]),tn=(0,se.U)("WindowEdit20Regular","20",["M6 3a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h3.22l.21-.84.04-.16H6a2 2 0 0 1-2-2V7h12v2.23c.32-.14.66-.21 1-.23V6a3 3 0 0 0-3-3H6ZM4 6c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2H4Zm6.98 9.38 4.83-4.83a1.87 1.87 0 1 1 2.64 2.64l-4.83 4.83a2.2 2.2 0 0 1-1.02.58l-1.5.37a.89.89 0 0 1-1.07-1.07l.37-1.5c.1-.39.3-.74.58-1.02Z"]),nn=(0,se.U)("ArrowReset24Regular","24",["M6.78 2.72c.3.3.3.77 0 1.06L4.56 6h8.69a7.75 7.75 0 1 1-7.75 7.75.75.75 0 0 1 1.5 0 6.25 6.25 0 1 0 6.25-6.25H4.56l2.22 2.22a.75.75 0 1 1-1.06 1.06l-3.5-3.5a.75.75 0 0 1 0-1.06l3.5-3.5c.3-.3.77-.3 1.06 0Z"],{flipInRtl:!0}),an=(0,se.U)("Circle20Regular","20",["M10 3a7 7 0 1 0 0 14 7 7 0 0 0 0-14Zm-8 7a8 8 0 1 1 16 0 8 8 0 0 1-16 0Z"]),rn=(0,se.U)("Square24Regular","24",["M3 6.25C3 4.45 4.46 3 6.25 3h11.5C19.55 3 21 4.46 21 6.25v11.5c0 1.8-1.46 3.25-3.25 3.25H6.25A3.25 3.25 0 0 1 3 17.75V6.25ZM6.25 4.5c-.97 0-1.75.78-1.75 1.75v11.5c0 .97.78 1.75 1.75 1.75h11.5c.97 0 1.75-.78 1.75-1.75V6.25c0-.97-.78-1.75-1.75-1.75H6.25Z"]),on=(0,se.U)("Hexagon20Regular","20",["M6.83 4a.5.5 0 0 0-.44.25l-3.17 5.5a.5.5 0 0 0 0 .5l3.17 5.5a.5.5 0 0 0 .44.25h6.35a.5.5 0 0 0 .43-.25l3.17-5.5a.5.5 0 0 0 0-.5l-3.17-5.5a.5.5 0 0 0-.43-.25H6.83Zm-1.3-.25A1.5 1.5 0 0 1 6.83 3h6.35c.53 0 1.03.29 1.3.75l3.17 5.5a1.5 1.5 0 0 1 0 1.5l-3.17 5.5a1.5 1.5 0 0 1-1.3.75H6.83a1.5 1.5 0 0 1-1.3-.75l-3.18-5.5a1.5 1.5 0 0 1 0-1.5l3.18-5.5Z"]);var sn=z(1967);const cn=(0,se.U)("Shapes20Regular","20",["M7.5 3a4.5 4.5 0 0 0-.5 8.97v1A5.5 5.5 0 1 1 12.98 7h-1A4.5 4.5 0 0 0 7.5 3Zm3 5A2.5 2.5 0 0 0 8 10.5v5a2.5 2.5 0 0 0 2.5 2.5h5a2.5 2.5 0 0 0 2.5-2.5v-5A2.5 2.5 0 0 0 15.5 8h-5ZM9 10.5c0-.83.67-1.5 1.5-1.5h5c.83 0 1.5.67 1.5 1.5v5c0 .83-.67 1.5-1.5 1.5h-5A1.5 1.5 0 0 1 9 15.5v-5Z"]);var dn;function ln(t){switch(t){case"AlignCenter":return e.createElement(Kt,null);case"AlignRight":return e.createElement(Yt,null);case"AlignLeft":return e.createElement(qt,null)}}function un(t){switch(t){case"Center":return e.createElement(Gt,null);case"Right":return e.createElement(Qt,null);case"Left":return e.createElement(Wt,null)}return e.createElement(Gt,null)}function fn(t){switch(t){case dn.TextOverlay:return e.createElement(Jt,null);case dn.Resize:return e.createElement($t,null);case dn.FilePicker:return e.createElement(Xt,null);case dn.AdvancedEditing:return e.createElement(tn,null);case dn.Reset:return e.createElement(nn,null)}}function pn(t){switch(t){case bt.ImageShape.Default:return e.createElement(Zt,null);case bt.ImageShape.Circle:return e.createElement(an,null);case bt.ImageShape.Triangle:return e.createElement(en,null);case bt.ImageShape.Square:return e.createElement(rn,null);case bt.ImageShape.Hexagon:return e.createElement(on,null);case bt.ImageShape.Pebble:return bt.pebble20Regular;case bt.ImageShape.Teardrop:return e.createElement(sn.vJR,null);default:return e.createElement(cn,null)}}function mn(t,n,a){switch(t){default:return e.createElement("svg",{width:n,height:a,viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},e.createElement("path",{className:"themeableSvgFill",d:"M16 12V13.0078H12.9922V16H12V13.0078H2.99219V4H0V3.00781H2.99219V0H4V3.00781H12.2891L15.1406 0.148438L15.8516 0.851562L12.9922 3.71094V12H16ZM4 4V11.2891L11.2891 4H4ZM12 12V4.71094L4.71094 12H12Z"}));case"1:1":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 14 14",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"},e.createElement("path",{className:"themeableSvgFill",d:"M14 0V14H0V0H14ZM13 1H1V13H13V1Z"}));case"2:3":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 10 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("rect",{className:"themeableSvgStroke",stroke:"currentColor",x:"0.5",y:"0.5",width:"9",height:"15"}));case"3:2":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 16 10",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("rect",{className:"themeableSvgStroke",stroke:"currentColor",x:"0.5",y:"0.5",width:"15",height:"9"}));case"3:4":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 12 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("rect",{className:"themeableSvgStroke",stroke:"currentColor",x:"0.5",y:"0.5",width:"11",height:"15"}));case"4:3":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 16 12",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("path",{className:"themeableSvgStroke",d:"M0.5 0.5H15.5V10C15.5 10.8284 14.8284 11.5 14 11.5H2C1.17157 11.5 0.5 10.8284 0.5 10V0.5Z",stroke:"currentColor"}));case"16:9":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 16 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("rect",{className:"themeableSvgStroke",stroke:"currentColor",x:"0.5",y:"0.5",width:"15",height:"8"}));case"9:16":return e.createElement("svg",{width:n,height:a,viewBox:"0 0 9 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e.createElement("rect",{className:"themeableSvgStroke",stroke:"currentColor",x:"0.5",y:"0.5",width:"8",height:"15"}))}}!function(e){e.TextOverlay="textOverlay",e.FilePicker="filePicker",e.Resize="resize",e.AspectRatio="aspectRatio",e.Alignment="alignment",e.Reset="reset",e.Save="save",e.AdvancedEditing="advancedEditing",e.Shapes="shapes"}(dn||(dn={}))})(),Y})())})();