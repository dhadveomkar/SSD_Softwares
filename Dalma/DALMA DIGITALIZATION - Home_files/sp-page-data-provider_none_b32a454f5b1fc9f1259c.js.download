define("321748d0-560e-436e-96f9-1cd223c0ca44_0.1.0",["@msinternal/odsp-core-bundle","@msinternal/odsp-utilities-bundle","@microsoft/sp-core-library","@microsoft/sp-http","@microsoft/sp-page-context","@microsoft/sp-http-base","@microsoft/sp-diagnostics"],(e,t,n,a,i,r,o)=>(()=>{"use strict";var s={676:e=>{e.exports=n},207:e=>{e.exports=o},909:e=>{e.exports=a},737:e=>{e.exports=r},408:e=>{e.exports=i},277:t=>{t.exports=e},810:e=>{e.exports=t}},c={};function d(e){var t=c[e];if(void 0!==t)return t.exports;var n=c[e]={exports:{}};return s[e](n,n.exports,d),n.exports}d.d=(e,t)=>{for(var n in t)d.o(t,n)&&!d.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},d.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),d.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var l={};return(()=>{d.r(l),d.d(l,{ArgumentError:()=>y,CopyPageDestinationType:()=>m,CopyToDataProvider:()=>O,CopyToErrorType:()=>b,CopyToJobProgress:()=>h,CurrentPageDataError:()=>D,DependencyPropertyType:()=>_,PageDataProvider:()=>c,RestError:()=>o,TimeoutError:()=>S});var e=d(277),t=d(810),n=d(676),a=d(909),i=d(408);const r="application/json;odata.metadata=none";class o extends Error{constructor(e,t,n){super(e),this.name="RestError",this.message=e,this.correlationId=t,this.statusCode=n,Object.setPrototypeOf(this,o.prototype)}}function s(){return n._SPKillSwitch.isActivated("54c256ed-8c11-4487-a6f0-939c28f4e1e9")}class c{get pageContext(){return this._pageContext}get(e,t){const n=this._spHttpClient.get(this.ensureAbsoluteUrl(e,t),a.SPHttpClient.configurations.v1,{headers:{accept:r}});return s()?this._handleResponse(n):this._handleResponseV2(n)}postRelativeRequestUrl(e,t="",n,a,i){return this.postAbsoluteRequestUrl(this.ensureAbsoluteUrl(e,n),t,a,i)}postAbsoluteRequestUrl(e,t="",i,o){let c=a.SPHttpClient.configurations.v1;n._SPKillSwitch.isActivated("3d764b78-4cf2-4a6c-a133-35b0da63360c")||!1!==o||new URL(e).origin!==window.location.origin&&(c=c.overrideWith({requestDigest:!1}));const d=this._spHttpClient.post(e,c,{body:t,headers:{accept:r,...i}});return s()?this._handleResponse(d):this._handleResponseV2(d)}ensureAbsoluteUrl(e,n){return t.Uri.concatenate(n??this._pageContext?.web?.absoluteUrl,"_api",e)}_handleResponse(e){let t,n;return e.then(e=>{if(t=e.correlationId?.toString(),n=e.status,!e.ok)throw new o(e.statusText,t,n);return e}).then(e=>e.json()).catch(e=>{const a=new o(e.message,t,n);throw a.stack=e.stack,a})}async _handleResponseV2(t){const n=await t,a=n.headers.get("SPRequestGuid")||void 0;if(!n.ok){const t=await n.text();throw new e.ApiError({correlationId:a,code:`${n.status}`,message:n.statusMessage,innerError:new Error(t)})}return{...await n.json(),...a&&{SPRequestGuid:a}}}constructor(e){e.whenFinished(()=>{this._spHttpClient=e.consume(a.SPHttpClient.serviceKey),this._pageContext=e.consume(i.PageContext.serviceKey)})}}c.serviceKey=n.ServiceKey.create("sp-page-data-provider:PageDataProvider",c);var u,f=d(737);!function(e){e.SourcePageId="{sourcePageId}",e.SourcePageUniqueId="{sourcePageUniqueId}",e.WorkItemId="{workItemId}"}(u||(u={}));const p={CopyTo:`sitepages/pages(${u.SourcePageId})/CopyTo`,CopyToWithUniqueId:`sitepages/pages/GetByUniqueId('${u.SourcePageUniqueId}')/CopyTo`,CopyToStatus:`sitepages/pages/CopyToStatus('(${u.WorkItemId}')`};var m,_,h,b;!function(e){e[e.CurrentWeb=0]="CurrentWeb",e[e.UserMySite=1]="UserMySite",e[e.DestinationUrl=2]="DestinationUrl"}(m||(m={})),function(e){e[e.Unknown=0]="Unknown",e[e.Image=1]="Image",e[e.Document=2]="Document",e[e.List=3]="List",e[e.Feature=4]="Feature",e[e.Link=5]="Link",e[e.SpfxSolution=6]="SpfxSolution",e[e.Web=7]="Web",e[e.M365Group=8]="M365Group",e[e.Page=9]="Page",e[e.Folder=10]="Folder"}(_||(_={})),function(e){e[e.Queued=0]="Queued",e[e.CreateAssetsFolderStart=1]="CreateAssetsFolderStart",e[e.CreateAssetsFolderEnd=2]="CreateAssetsFolderEnd",e[e.CopyAssetsStart=3]="CopyAssetsStart",e[e.CopyAssetsEnd=4]="CopyAssetsEnd",e[e.CreatePageStart=5]="CreatePageStart",e[e.CreatePageEnd=6]="CreatePageEnd",e[e.Succeeded=7]="Succeeded",e[e.Deleting=8]="Deleting",e[e.Failed=9]="Failed",e[e.JobNotFound=10]="JobNotFound"}(h||(h={})),function(e){e[e.None=0]="None",e[e.Generic=1]="Generic",e[e.ArgumentError=2]="ArgumentError",e[e.TargetCheckedOutByDifferentUser=3]="TargetCheckedOutByDifferentUser",e[e.TargetNotFound=4]="TargetNotFound",e[e.UnauthorizedOperation=5]="UnauthorizedOperation",e[e.InvalidDestinationWebUrl=6]="InvalidDestinationWebUrl",e[e.PreProcessorError=7]="PreProcessorError",e[e.PostProcessorError=8]="PostProcessorError",e[e.AssetNotFound=9]="AssetNotFound",e[e.AssetNotFile=10]="AssetNotFile",e[e.UserNotFound=11]="UserNotFound",e[e.OnErrorHandlerError=12]="OnErrorHandlerError",e[e.ErrorDeletingNewlyCreatedPage=13]="ErrorDeletingNewlyCreatedPage"}(b||(b={}));class g{static isJobComplete(e){return e.JobState===h.Failed||e.JobState===h.Succeeded}static isJobFound(e){return e.JobState!==h.JobNotFound}static isJobActive(e){return g.isJobFound(e)&&!g.isJobComplete(e)}}class v{static getOrCreateInstance(e){return v._instance||(v._instance=new v(e)),v._instance}getAuthToken(e){const t=new URL(e);return this.isTokenValid(e)&&this._token?Promise.resolve(this._token):this._tokenProvider.getToken(t.origin).then(e=>{this._token=e;const n=(a=e)?function(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}(decodeURIComponent(a).split(".")[1]):{};var a;return this._tokenExpiry=new Date(1e3*Number(n.exp?n.exp:-1)-15e3),this._siteUrl=t,Promise.resolve(this._token)}).catch(e=>{throw e})}isTokenValid(e){const t=new URL(e).origin;return void 0!==this._siteUrl&&void 0!==this._tokenExpiry&&this._siteUrl.origin===t&&this._tokenExpiry>new Date}constructor(e){this._tokenProvider=e}}class y extends Error{constructor(e,t){super(e),this.name="ArgumentError",this.message=e,this.argumentName=t}}class S extends Error{constructor(e,t){super(e),this.name="TimeoutError",this.message=e,this.timeLimit=t}}class D extends Error{constructor(e){super(e),this.name="CurrentPageDataError",this.message=e}}function I(t){try{return new e.SPResourcePath(t),!0}catch{return!1}}function x(e){return new URL(e).origin}var C=d(207);class O{async copyTo(e,t,a,i,r){const o=new C._QosMonitor("CopyToDataProvider.CopyTo"),s=this._pageDataProvider.pageContext.web.absoluteUrl;let c,d;if(t=t??s,!n._SPKillSwitch.isActivated("7b4e4565-ae05-4853-9a99-6de89b3ec77a")&&i)c=p.CopyToWithUniqueId.replace(u.SourcePageUniqueId,i);else{if(null==(a=a??this._pageDataProvider.pageContext.listItem?.id))throw new y("sourcePageId was not passed into copyTo and the current page ID could not be obtained.");c=p.CopyTo.replace(u.SourcePageId,a.toString())}try{d=await this._getBearerTokenIfNeeded(t,s)}catch(e){throw o.writeUnexpectedFailure("FailedToGetBearerToken",e),e}try{const n=await this._pageDataProvider.postRelativeRequestUrl(c,JSON.stringify(e),t,d,r);return o.writeSuccess(),n}catch(e){throw o.writeUnexpectedFailure("CopyToRESTFailure",e,{correlationId:e.correlationId}),e}}async copyToStatus(e){const t=new C._QosMonitor("CopyToDataProvider.CopyToStatus"),n=this._pageDataProvider.pageContext?.web.absoluteUrl;let a;try{a=await this._getBearerTokenIfNeeded(e,n)}catch(e){throw t.writeUnexpectedFailure("FailedToGetBearerToken",e),e}if(!e||!I(e))throw t.writeUnexpectedFailure("InvalidCopyToStatusURL"),new URIError("copyToStatsAPIOrWorkItemId was not a valid URL.");try{const n=await this._pageDataProvider.postAbsoluteRequestUrl(e,JSON.stringify({}),a);return t.writeSuccess(),n}catch(e){throw t.writeUnexpectedFailure("CopyToStatusRESTFailure",e,{correlationId:e.correlationId}),e}}async copyToStatusWorkItemId(e,t){const n=new C._QosMonitor("CopyToDataProvider.CopyToStatusWorkItemId"),a=this._pageDataProvider.pageContext?.web.absoluteUrl;if(!(t=t??a))throw n.writeUnexpectedFailure("SourceWebURLUndefined"),new y("sourceWebAbsoluteUrl was not passed into copyToStatusWorkItemId and the current web absolute URL could not be obtained.");const i=this._pageDataProvider.ensureAbsoluteUrl(p.CopyTo.replace(u.WorkItemId,e),t);try{const e=await this.copyToStatus(i);return n.writeSuccess(),e}catch(e){throw n.writeUnexpectedFailure("PropogatedCopyToStatusError",e,{correlationId:e.correlationId}),e}}pollCopyToStatus(e,t=6e4,n=432e6,a){const i=new C._QosMonitor("CopyToDataProvider.PollCopyToStatus");return new Promise((r,o)=>{t>n&&(i.writeUnexpectedFailure("PollingIntervalGreaterThanTimeout"),o(new y("Polling interval was greater than time out.")));const s=setInterval(()=>{this.copyToStatus(e).then(e=>{g.isJobActive(e)?a?.(e):(clearInterval(s),i.writeSuccess(),r(e))}).catch(e=>{clearInterval(s),i.writeUnexpectedFailure("PropogatedCopyToStatusError",e,{correlationId:e.correlationId}),o(e)})},t);setTimeout(()=>{clearInterval(s),i.writeUnexpectedFailure("PollingTimedOut"),o(new S(`Polling timed out in ${n} ms.`,n))},n)})}async copyToPollIfJobIsActive(e,t,n,a,i,r,o,s,c){const d=await this.copyTo(e,a,i,s,c);return g.isJobActive(d)?(r?.(d),await this.pollCopyToStatus(d.CopyToStatusAPI,t,n,o)):d}async _getBearerTokenIfNeeded(e,t){if(function(e,t){if(!I(e))throw new y("requestUrl was not a valid URL.");const n=x(e);let a=window?.origin;if(t&&(a=x(t)),!a)throw new D("The origin of the current page could not be obtained.");return n!==a}(e,t))return{Authorization:`Bearer ${await v.getOrCreateInstance(this._aadTokenProvider).getAuthToken(e)}`}}constructor(e){e.whenFinished(()=>{this._pageDataProvider=e.consume(c.serviceKey),this._aadTokenProvider=new a.AadTokenProvider(f._AadTokenProviders.preAuthorizedConfiguration)})}}O.serviceKey=n.ServiceKey.create("sp-copy-to-data-provider:CopyToDataProvider",O)})(),l})());