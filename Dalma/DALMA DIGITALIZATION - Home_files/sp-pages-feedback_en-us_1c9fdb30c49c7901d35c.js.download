(()=>{var e=document.currentScript;define("24b18d90-5b12-4227-8414-5ef7c776350b_0.1.0",["@microsoft/sp-core-library","@microsoft/sp-diagnostics","tslib","@msinternal/odsp-core-bundle","@microsoft/sp-page-context","@msinternal/sp-telemetry","@microsoft/sp-http","@microsoft/sp-http-base","@ms/office-ui-fabric-react-bundle","react"],(t,n,a,i,r,o,s,c,d,l)=>(()=>{var u={88:(e,t,n)=>{var a=n(277);e.exports=a.OdspErrorHelper}
,551:(e,t,n)=>{"use strict";var a=n(277);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,185:(e,t,n)=>{}
,361:(e,t,n)=>{"use strict";var a=n(277);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,478:(e,t,n)=>{"use strict";var a;!function(e){e.outOfBox="outOfBox",e.custom="custom",e.Unknown="Unknown"}(a||(a={}))}
,940:(e,t,n)=>{var a=n(277);e.exports=a.PairedEventBase}
,223:(e,t,n)=>{var a=n(277);e.exports=a.SingleEventBase}
,417:(e,t,n)=>{"use strict";var a=n(277);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,781:(e,t,n)=>{"use strict";var a=n(277);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,52:(e,t,n)=>{"use strict";var a=n(277);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}})}
,734:(e,t,n)=>{"use strict";var a=n(88);n.o(a,"Qos")&&n.d(t,{Qos:function(){return a.Qos}}),n.o(a,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return a.ResultTypeEnum}});var i=n(551);n.o(i,"Qos")&&n.d(t,{Qos:function(){return i.Qos}}),n.o(i,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return i.ResultTypeEnum}});var r=n(417);n.o(r,"Qos")&&n.d(t,{Qos:function(){return r.Qos}}),n.o(r,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return r.ResultTypeEnum}});var o=n(781);n.o(o,"Qos")&&n.d(t,{Qos:function(){return o.Qos}}),n.o(o,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return o.ResultTypeEnum}});var s=n(52);n.o(s,"Qos")&&n.d(t,{Qos:function(){return s.Qos}}),n.o(s,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return s.ResultTypeEnum}}),n(185);var c=n(361);n.o(c,"Qos")&&n.d(t,{Qos:function(){return c.Qos}}),n.o(c,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return c.ResultTypeEnum}}),n(478);var d=n(940);n.o(d,"Qos")&&n.d(t,{Qos:function(){return d.Qos}}),n.o(d,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return d.ResultTypeEnum}});var l=n(223);n.o(l,"Qos")&&n.d(t,{Qos:function(){return l.Qos}}),n.o(l,"ResultTypeEnum")&&n.d(t,{ResultTypeEnum:function(){return l.ResultTypeEnum}}),n(400),n(136),n(760),n(450),n(486)}
,450:(e,t,n)=>{"use strict";var a=n(277);n(486),a.KillSwitch.isActivated("265f44fc-1615-4d58-8ed1-ef6a21350404")}
,486:(e,t,n)=>{"use strict";new Set(["onedrive.cloud.microsoft","edog.onedrive.cloud.microsoft","onedrive.cloud.dev.microsoft"])}
,760:(e,t,n)=>{"use strict";n(280),n(781),n(400)}
,400:(e,t,n)=>{"use strict";n(280),n(781)}
,136:(e,t,n)=>{"use strict";n(280)}
,676:e=>{"use strict";e.exports=t},207:e=>{"use strict";e.exports=n},909:e=>{"use strict";e.exports=s},737:e=>{"use strict";e.exports=c},408:e=>{"use strict";e.exports=r},141:e=>{"use strict";e.exports=d},277:e=>{"use strict";e.exports=i},519:e=>{"use strict";e.exports=o},959:e=>{"use strict";e.exports=l},280:e=>{"use strict";e.exports=a},40:e=>{"use strict";e.exports=JSON.parse('{"name":"@ms/centro-hvc-loader","version":"3.2.2","description":"Project Centro high value component loader","license":"UNLICENSED","devDependencies":{"@types/webpack-env":"1.15.1","typescript":"4.2.3-gauri-patch-3"},"homepage":"https://office.visualstudio.com/OC/_git/M365AdminUX?path=%2Fmodules%2Fhvc-loader","bugs":{"url":"https://office.visualstudio.com/OC/_workitems/edit/2364251","email":"centroinfo@microsoft.com"},"author":"MAC Platform Team <macplat@microsoft.com>","main":"./dist/hvc-loader/index.js","module":"./dist/hvc-loader/index.js","typings":"./dist/hvc-loader/index.d.ts","scripts":{"build":"tsc -p ./tsconfig.json"},"dependencies":{"tslib":"^2.1.0"}}')}
},f={};function p(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={exports:{}};return u[e](n,n.exports,p),n.exports}p.m=u;var m,_,h,b={"355":"fzU+KDw5IcM9ZHS0Kt2ZkeDLgJuEehcocrNrBvUnhgU="};p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var n in t)p.o(t,n)&&!p.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},p.f={},p.e=e=>Promise.all(Object.keys(p.f).reduce((t,n)=>(p.f[n](e,t),t),[])),p.u=e=>"chunk.inapp-feedback-loader_none_068b7da7946f2b26b942.js",p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m={},_="24b18d90-5b12-4227-8414-5ef7c776350b_0.1.0:",p.l=(e,t,n,a)=>{if(m[e])m[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==_+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,p.nc&&i.setAttribute("nonce",p.nc),i.setAttribute("data-webpack",_+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(b[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}m[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=m[e];if(delete m[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h=e?e.src:"",p.p=h.slice(0,h.lastIndexOf("/")+1),(()=>{var e={963:0};p.f.j=(t,n)=>{var a=p.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=p.p+p.u(t),o=new Error;p.l(r,n=>{if(p.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)p.o(o,a)&&(p.m[a]=o[a]);s&&s(p)}for(t&&t(n);c<r.length;c++)i=r[c],p.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_24b18d90-5b12-4227-8414-5ef7c776350b_0.1.0"]=self["webpackJsonp_24b18d90-5b12-4227-8414-5ef7c776350b_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var g={};return(()=>{"use strict";p.r(g),p.d(g,{PagesCopilotFeedback:()=>We,launchUserInitiatedFeedback:()=>Be,useCanDisplayFeedback:()=>Qe});var e,t,n,a=p(676),i=p(207),r=p(280);function o(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}function s(e,t){return(0,r.__awaiter)(this,void 0,void 0,function(){return(0,r.__generator)(this,function(n){return[2,new Promise(function(n,a){var i=document.createElement("script");(null==t?void 0:t.createScriptURL)?i.src=t.createScriptURL(e.content):i.src=e.content,i.onload=function(){n()},i.onerror=function(){a(new Error("Dynamically loading script "+e.content+" failed"))},o(i,e.attributes),document.body.appendChild(i)})]})})}function c(e){return(0,r.__awaiter)(this,void 0,void 0,function(){return(0,r.__generator)(this,function(t){return[2,new Promise(function(t){var n=document.createElement("script"),a=document.createTextNode(e.content);n.appendChild(a),o(n,e.attributes),document.body.appendChild(n),t()})]})})}function d(e){return(0,r.__awaiter)(this,void 0,void 0,function(){return(0,r.__generator)(this,function(t){return[2,new Promise(function(t,n){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css",a.href=e.content,a.onload=function(){t()},a.onerror=function(){n(new Error("Dynamically loading style "+e.content+" failed"))},o(a,e.attributes),document.head.appendChild(a)})]})})}function l(e){return(0,r.__awaiter)(this,void 0,void 0,function(){return(0,r.__generator)(this,function(t){return[2,new Promise(function(t){var n=document.createElement("link");n.rel="stylesheet",n.type="text/css";var a=document.createTextNode(e.content);n.appendChild(a),o(n,e.attributes),document.head.appendChild(n),t()})]})})}function u(e,t){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,f,p,m;return(0,r.__generator)(this,function(_){switch(_.label){case 0:switch(e.type){case"parallel":return[3,1];case"sequential":return[3,5];case"scriptUrl":return[3,16];case"script":return[3,18];case"styleUrl":return[3,20];case"style":return[3,22]}return[3,24];case 1:return _.trys.push([1,3,,4]),[4,Promise.all(e.children.map(function(e){return u(e,t)}))];case 2:return _.sent(),[3,4];case 3:if(n=_.sent(),!e.optional)throw n;return console.log("Dynamic loading of optional script failed",n),[3,4];case 4:return[2];case 5:_.trys.push([5,14,,15]),_.label=6;case 6:_.trys.push([6,11,12,13]),a=(0,r.__values)(e.children),i=a.next(),_.label=7;case 7:return i.done?[3,10]:[4,u(i.value,t)];case 8:_.sent(),_.label=9;case 9:return i=a.next(),[3,7];case 10:return[3,13];case 11:return o=_.sent(),p={error:o},[3,13];case 12:try{i&&!i.done&&(m=a.return)&&m.call(a)}finally{if(p)throw p.error}return[7];case 13:return[3,15];case 14:if(f=_.sent(),!e.optional)throw f;return console.log("Dynamic loading of optional script failed",f),[3,15];case 15:return[2];case 16:return[4,s(e,t)];case 17:return _.sent(),[2];case 18:return[4,c(e)];case 19:return _.sent(),[2];case 20:return[4,d(e)];case 21:return _.sent(),[2];case 22:return[4,l(e)];case 23:return _.sent(),[2];case 24:throw new Error("Invalid script loader object "+JSON.stringify(e))}})})}!function(e){e.Info="Info",e.Error="Error",e.Analytics="Analytics",e.Performance="Performance",e.Interface="Interface",e.Availability="Availability",e.Reliability="Reliability"}(e||(e={})),function(e){e.ClientInfo="ClientInfo",e.ClientError="ClientError",e.ClientAnalytics="ClientAnalytics",e.ClientPerformance="ClientPerformance",e.ClientAvailability="ClientAvailability",e.ClientReliability="ClientReliability"}(t||(t={})),function(e){e.Microsoft365AdminCenter="@ms/mac"}(n||(n={}));var f=new Map;function m(e,t){if(f.has(e))throw new Error("Logger "+e+" already exists");f.set(e,t)}function _(n,a){a.forEach(function(i,r){try{i.logger(n)}catch(n){var o=new Map(a);o.delete(r),_({id:"500294",type:e.Error,logCategory:t.ClientError,message:"Failure in logger: "+r,error:n},o)}})}var h,b,v,y,S=function(e){_(e,f)};(v=h||(h={})).M365AdminPortal="M365AdminPortal",v.SPOAdminPortal="SPOAdminPortal",v.SPOPortal="SPOPortal",v.EXOAdminPortal="EXOAdminPortal",v.TeamsAdminPortal="TeamsAdminPortal",v.SecurityPortal="SecurityPortal",v.CompliancePortal="CompliancePortal",v.M365SCCPortal="M365SCCPortal",v.SupportCentral="SupportCentral",v.IbizaMTMPortal="IbizaMTMPortal",v.CloudCostManagementPortal="CloudCostManagementPortal",v.Rave="Rave",v.DynamicsPortal="DynamicsPortal",v.TeamsApp="TeamsApp",v.M365DefenderSMB="M365DefenderSMB",v.Windows365Portal="Windows365Portal",v.PPACAdminPortal="PPACAdminPortal",v.VivaGoals="VivaGoals",v.VivaPulse="VivaPulse",v.FireSurveysHost="FireSurveysHost",v.AEM="AEM",v.ExcelPythonAddon="ExcelPythonAddon",v.AdminAppMetaOSTeams="AdminAppMetaOSTeams",v.AdminAppMetaOSOffice="AdminAppMetaOSOffice",v.Project="Project",v.Planner="Planner",v.Visio="Visio",v.Clipchamp="Clipchamp",function(e){e.Static="centro.runtime.static",e.Error="centro.hvc.error"}(b||(b={})),function(e){e[e.Trace=0]="Trace",e[e.Info=1]="Info",e[e.Comment=2]="Comment",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical"}(y||(y={}));var D=!0,I=function(e){var t,n,a=window;if(null===(t=null==a?void 0:a.trustedTypes)||void 0===t?void 0:t.createPolicy)try{n=a.trustedTypes.createPolicy("@centro/hvc-loader",{createScriptURL:function(e){var t;try{t=new URL(e)}catch(t){throw new Error("Invalid script url "+e)}if("https:"!==(null==t?void 0:t.protocol))throw new Error("Only https protocol is allowed for script url "+e);return e},createScript:void 0,createHTML:void 0})}catch(e){console.error("Failed to create trusted type policy",e)}return n}();function x(t,n){if(!t){var a=new Error(n);throw S({type:e.Error,message:n,id:"508371",error:a}),a}}function C(t){return void 0===window?(S({type:e.Info,message:"window is undefined",id:"512105"}),!1):void 0===window.m365_admin_features?(S({type:e.Info,message:"window.m365_admin_features is undefined",id:"512108"}),!1):void 0!==window.m365_admin_features.initializers&&void 0!==window.m365_admin_features.initializers[t]}function O(e){var t,n;return!!(null===(n=null===(t=window.m365_admin_features)||void 0===t?void 0:t.locDbg)||void 0===n?void 0:n[e])}var w,E,A,L,k=void 0,M=void 0,P=!1,T=!1,U=void 0,F=!1,H=new Map,R=void 0,N=void 0;function B(t){return void 0===t&&(t=""),(0,r.__awaiter)(this,void 0,void 0,function(){var n,a;return(0,r.__generator)(this,function(i){switch(i.label){case 0:if(void 0===N)throw n=new Error("attempting to getUxVersionData before preConfig were provided"),S({type:e.Error,message:n.message,error:n,id:"508373"}),n;return a=k+"/admin/api/uxversion"+t,F&&(a=""===t?a+"?locale="+N.locale+"&hostingapp="+N.hostName:a+"&locale="+N.locale+"&hostingapp="+N.hostName),[4,new Promise(function(e,t){var n=new XMLHttpRequest;n.open("GET",a,!0),F||(n.setRequestHeader("x-ms-mac-locale",N.locale),n.setRequestHeader("x-ms-mac-hostingapp",N.hostName)),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){var i=n.getResponseHeader("x-ms-correlation-id");if(200!==n.status){var r="Request to "+a+" failed, server responseCode: "+n.status+" body: "+n.response+" correlationId: "+i,o=new Error(r);return void t(o)}e(function(e){if(void 0!==e&&e.hasOwnProperty("__hostApp_config"))for(var t in e)t.startsWith("__")||(e[t.toLowerCase()]=e[t],t.toLowerCase()!==t&&delete e[t]);return JSON.stringify(e)}(JSON.parse(n.response)))}},n.send()})];case 1:return[2,i.sent()]}})})}function j(){return(0,r.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,r.__generator)(this,function(n){switch(n.label){case 0:return U?[2]:(t=(e=JSON).parse,[4,B("?locdbg=true")]);case 1:return U=t.apply(e,[n.sent()]),[2]}})})}!function(e){e.GET="GET",e.PUT="PUT",e.POST="POST",e.DELETE="DELETE",e.PATCH="PATCH"}(w||(w={})),function(e){e.M365AdminCenter="MAC",e.Mover="Mover",e.ExchangeAdminCenter="EAC",e.SharepointAdminCenter="SPO",e.TeamsAdminCenter="TAC",e.ComplianceAdminCenter="CAC",e.SecurityAdminCenter="SAC",e.ProductivityAdminCenter="PAC",e.GraphApi="Graph",e.VRoomApi="VRoom",e.DeviceCareApi="DeviceCare",e.RecommendationApi="Reco",e.M365AoboApi="M365Aobo",e.Assist="Assist",e.BusinessApplicationPlatform="PPACBap",e.PowerPlatformAPITenantLevel="ppapi-tenant-level",e.GovernancePPACAPI="GovPPACAPI",e.LicensingAPI="LicAPI",e.PPApiTenantLevel="PPApiTenantLevel",e.Fusion="Fusion",e.VivaPulse="VivaPulse",e.CloudPolicyServiceApi="OCPS",e.ECS="ECS",e.O365ShellServices="O365Shell",e.ProfileService="ProfileService",e.VsbHub="VsbHub",e.Augloop="Augloop"}(E||(E={})),function(e){e.Centro="Centro",e.Hvc="Hvc",e.Consumer="Consumer"}(A||(A={})),function(e){e.Request="Request",e.History="History",e.DataSources="DataSources",e.SetTitleImpl="SetTitleImpl"}(L||(L={}));var V=p(277);function z(){return V.KillSwitch.isActivated("8CF2C3CF-66E6-4B4B-AD52-DB99C5BF9F57")}let G,K;const W=(()=>{const e={},t=[],n={},a={};return{register:a=>(a&&(z()?t.push(a):K?(n[K]||(n[K]=[]),n[K].push(a),K=void 0):t.push(a)),e),unregister:e=>{const a=t.indexOf(e);a>-1&&t.splice(a,1),z()||Object.keys(n).forEach(t=>{const a=n[t],i=a.indexOf(e);i>-1&&a.splice(i,1),0===a.length&&delete n[t]})},updateFeedbackObject:(i,r)=>{if(!z()&&r){const e=Object.assign(Object.assign({},a[r]),i);a[r]=e,(n[r]||[]).forEach(t=>t(e))}else{const n=Object.assign(Object.assign({},e),i);Object.assign(e,n),t.forEach(e=>e(n))}},clear:e=>{!z()&&e?(n[e]||[]).forEach(e=>e({})):t.forEach(e=>e({}))}}})();function q(n){return(0,r.__awaiter)(this,void 0,void 0,function*(){yield function(n){return(0,r.__awaiter)(this,void 0,void 0,function*(){const{hostName:a,language:i,appId:o,inAppFeedbackRef:s,useScopedListeners:c}=n,d="ocv-inapp-feedback",l={centroEnvironmentBaseUrl:"https://admin.microsoft.com",preConfig:{appId:o,hostName:a,locale:i,perfPrefix:`OcvFeedback${a}`},centroHvcData:"",forHostVersion:"v2",hvcVersion:""};yield function(n){return(0,r.__awaiter)(this,void 0,void 0,function(){var a,i,o,s,c,d,l,u,f,_,h,b;return(0,r.__generator)(this,function(g){switch(g.label){case 0:a=n.centroEnvironmentBaseUrl,i=n.preConfig,o=n.centroHvcData,s=n.enableUxVersionQueryParam,x(!!a,"centroEnvironmentBaseUrl is missing"),x(!!i,"preConfig is missing"),(N=i).appId||(N.appId="10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)})),c=N.appId,d=N.hostName,g.label=1;case 1:return g.trys.push([1,5,,6]),P?(S({type:e.Info,message:"initialize() is called but loader is already previously initialized",id:"508375"}),[2]):(k="/"===a.substring(a.length-1)?a.substring(0,a.length-1):a,l=p(40),R=l.version,u=k+"/api/instrument/logclient",T||(m("hvcLoaderKustoLogger",function(n,a,i,o){var s=[],c=Promise.resolve(),d=0,l=n,u=a,f=i,p=o,m=function(){setTimeout(function(){_().catch(function(){})},1e3)},_=function(){return 0===s.length||D?(m(),Promise.resolve()):(c=new Promise(function(e,t){var n=new XMLHttpRequest;n.open("POST",u,!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("x-ms-mac-hostingapp",f),n.setRequestHeader("x-ms-mac-appid",l),n.setRequestHeader("x-ms-mac-version",p),n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE){if(204!==n.status){var a=new Error("Request to /api/instrument/logclient failed, server responseCode: "+n.status+" body: "+n.response);return console.log(a),void t(a)}e()}};var a=s.splice(0,s.length);n.send(JSON.stringify(a))})).then(m)};m();var h=function(e){s.push(e)};return{logger:function(n){if(n.type!==e.Analytics&&n.type!==e.Performance){d+=1;var a=parseInt(n.id,10),i=n.message||"",r="",o="";try{if(null!==(r=function(){throw new Error("History object has not been set")}().location.pathname)&&-1!==r.indexOf(":")){var s=r.split(":");r=s[0],o=s[1]}}catch(e){r="",o=""}if(h({TagId:a,LogLevel:y.Info,LogCategory:n.logCategory||t.ClientInfo,Message:i,Adhoc0:l,Adhoc1:d.toString(),Adhoc2:JSON.stringify({data:n.data}),Adhoc5:o,PageName:r}),n.type===e.Error){var c=n.error.stack||"";h({TagId:500781,LogLevel:y.Error,LogCategory:n.logCategory||t.ClientError,Message:"UI Exception: "+(n.error.message||""),Adhoc0:l,Adhoc1:d.toString(),Adhoc2:JSON.stringify({version:p,stack:c}),Adhoc3:a.toString(),Adhoc5:o,PageName:r})}}},flush:function(){return(0,r.__awaiter)(this,void 0,void 0,function(){return(0,r.__generator)(this,function(e){return[2,Promise.all([c,_()]).then(function(){})]})})}}}(c,u,d,l.name+"_"+l.version)),D=!1,void 0!==N.additionalLoggers&&Object.keys(N.additionalLoggers).forEach(function(e){m(e,{logger:N.additionalLoggers[e]})}),T=!0),f=performance.now(),o?(S({type:e.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:o}),M=JSON.parse(o),[3,4]):[3,2]);case 2:if(n.forHostVersion&&n.hvcVersion)throw new Error("cannot specify both forHostVersion and hvcVersion");return F=!!s,_="",n.forHostVersion?_="?bldVer="+encodeURIComponent(n.forHostVersion):n.hvcVersion&&(_="?pkgver="+encodeURIComponent(n.hvcVersion)),[4,B(_)];case 3:h=g.sent(),S({type:e.Info,message:"uxVersion Data is provided thru parameter",id:"508372",data:h}),M=JSON.parse(h),g.label=4;case 4:return P=!0,S({type:e.Info,message:"hvcloader initialze() step has succeeded",id:"513574",data:{eventName:"hvcLoader_Initialize_step",fromStart:performance.now()-f,UA:navigator.userAgent,enableQueryParam:F}}),[3,6];case 5:throw b=g.sent(),S({type:e.Error,message:"hvcloader initialze() step has failed "+b.message,id:"508376",error:b}),b;case 6:return[2]}})})}(l),K=c?s:void 0;const f={dataSources:e=>{e("centro.hvc.feedback.initOptions",W)}};yield function(t){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c;return(0,r.__generator)(this,function(r){switch(r.label){case 0:n=M,r.label=1;case 1:if(r.trys.push([1,7,,8]),!P)throw new Error("initialize() needs to be invoked before calling preloadFeature()");return a=performance.now(),!t.localMode||{NODE_ENV:"production"}.CENTRO_HVC_DATA?[3,3]:[4,j()];case 2:r.sent(),n=U,r.label=3;case 3:if(!n)throw new Error("uxVersionData is not populated");return i=t.featureName.toLowerCase(),n[i]?C(i)&&O(i)===!!t.localMode?(S({type:e.Info,message:"preloadFeature() feature "+i+" already loaded previously",id:"508465",data:{hvc:i}}),[3,6]):[3,4]:(S({type:e.Info,message:"HVC "+i+" is not enabled for this host",id:"508419"}),[2,[!1,void 0]]);case 4:return[4,u(n[i].loaderSpec,I)];case 5:if(r.sent(),!C(i))throw new Error("preloadFeature(): global is not populated after loading for "+i);void 0===window.m365_admin_features.locDbg&&(window.m365_admin_features.locDbg={}),window.m365_admin_features.locDbg[i]=!!t.localMode,r.label=6;case 6:t.adapters&&H.set(i,t.adapters),o=void 0;try{o=window.m365_admin_features.staticAdditionalObjects[i]}catch(t){throw s=window.m365_admin_features.foreignEnvMainVersion,S({type:e.Error,message:s?"using v3 Hvc "+i+", error when trying to retrieve staticAdditionalObjects, error: "+t.message:"using v2 Hvc "+i+", staticAdditionalObjects is not supported, error: "+t.message,id:"521848",error:t}),t}return S({type:e.Info,message:"preloadFeatures() step has succeeded",id:"513585",data:{hvc:i,uxdata:JSON.stringify(n),eventName:"preloadFeature_step",fromStart:performance.now()-a,UA:navigator.userAgent}}),[2,[!0,o]];case 7:throw c=r.sent(),S({type:e.Error,message:"error in preloadFeatures() step "+c.message,id:"508417",data:{uxdata:JSON.stringify(n)},error:c}),c;case 8:return[2]}})})}({featureName:d,adapters:f});const _=yield function(t){return(0,r.__awaiter)(this,void 0,void 0,function(){var n,a,i,o,s,c,d,l;return(0,r.__generator)(this,function(r){switch(r.label){case 0:if(r.trys.push([0,7,,8]),!P)throw new Error("initialize() needs to be invoked before calling bootstrapFeature()");if(n=performance.now(),a=M,O(i=t.featureName.toLowerCase())&&!{NODE_ENV:"production"}.CENTRO_HVC_DATA&&(a=U),!a)throw new Error("uxVersionData is not populated");if(!C(i))return[3,5];o={centroBaseUrl:k,cdnUrl:a[i].cdnUrl,ariaLoggerId:a.__hostApp_config.ariaLoggerId,targetAppUrls:a.__hostApp_config.hostingAppUrls,versionInfo:R},s=void 0,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.m365_admin_features.initializers[i](H.get(i),o,N)];case 2:return s=r.sent(),S({type:e.Info,message:"bootstrapFeature() step has succeeded",id:"513586",data:{hvc:i,eventName:"bootstrapFeature_step",fromStart:performance.now()-n,UA:navigator.userAgent}}),[3,4];case 3:throw c=r.sent(),d=window.m365_admin_features.foreignEnvMainVersion,S({type:e.Error,message:d?"using v3 Hvc "+i+", error when running foreignFeatureInitializeRuntime, error: "+c.message:"using v2 Hvc "+i+" is not supported, error: "+c.message,id:"521851",error:c}),c;case 4:return[2,s];case 5:throw new Error("bootstrapFeature(): preloadFeature() was not called before bootstraping "+i);case 6:return[3,8];case 7:throw l=r.sent(),S({type:e.Error,message:"error in bootstrapFeature() step "+l.message,id:"508481",error:l}),l;case 8:return[2]}})})}({featureName:d});return G=yield _.main(function(e){let t=null;return e&&(t=document.getElementById(e)),t||(t=document.createElement("div"),t.id=null!=e?e:"inapp-feedback-ref",document.body.appendChild(t)),t}(s)),G})}(n)})}const Q=W.updateFeedbackObject,Y=W.clear;var J,X,Z,$,ee,te,ne,ae,ie,re,oe,se,ce,de,le,ue,fe,pe,me,_e;(me=J||(J={})).Smile="Smile",me.Frown="Frown",me.Idea="Idea",me.Unclassified="Unclassified",(pe=X||(X={})).Undefined="Undefined",pe.MinorWithoutParentalConsent="MinorWithoutParentalConsent",pe.MinorWithParentalConsent="MinorWithParentalConsent",pe.NotAdult="NotAdult",pe.Adult="Adult",pe.MinorNoParentalConsentRequired="MinorNoParentalConsentRequired",function(e){e.DropDown="DropDown",e.MultiSelect="MultiSelect",e.Rating="Rating",e.SingleSelect="SingleSelect"}(Z||(Z={})),(fe=$||($={})).FeatureArea="FeatureArea",fe.ResponsibleAI="ResponsibleAI",fe.ChildFeedback="ChildFeedback",fe.Experience="Experience",fe.ProductSatisfaction="ProductSatisfaction",fe.CrashImpact="CrashImpact",fe.Custom="Custom",fe.AIThumbsDown="AIThumbsDown",fe.AIThumbsUp="AIThumbsUp",function(e){e.QuestionNotRequired="QuestionNotRequired",e.CommentNotRequired="CommentNotRequired",e.CommentRequiredWithLastOption="CommentRequiredWithLastOption"}(ee||(ee={})),(ue=te||(te={})).MSA="MSA",ue.AAD="AAD",ue.Unauthenticated="Unauthenticated",(le=ne||(ne={})).Enabled="Enabled",le.Disabled="Disabled",le.NotConfigured="Not Configured",function(e){e.JPEG="jpeg",e.PNG="png"}(ae||(ae={})),(de=ie||(ie={})).AutoCapture="AutoCapture",de.AutoCaptureWithHtml2Canvas="AutoCaptureWithHtml2Canvas",de.ProvidedAtInitialization="ProvidedAtInitialization",de.DynamicallyProvided="DynamicallyProvided",(ce=re||(re={})).SidePane="SidePane",ce.Modal="Modal",ce.NoSurface="NoSurface",ce.CallOut="CallOut",ce.NoSurfaceWithoutTitle="NoSurfaceWithoutTitle",(se=oe||(oe={})).Windows="Windows",se.IOS="iOS",se.Android="Android",se.WacTaskPane="WacTaskPane",se.MacOS="MacOS",se.Web="Web",function(e){e.Worldwide="Worldwide",e.China="China",e.EUDB="EUDB",e.GccMod="GccMod",e.UsGov="UsGov",e.UsGovDod="UsGovDod",e.UsNat="UsNat",e.UsSec="UsSec"}(_e||(_e={}));const he=JSON.parse('{"Y":"SharePoint engineering"}');function be(e){return"Dogfood"===e?he.Y:void 0}!function(){function e(e,t){var n=this._pageContext=t.pageContext,a=t.tokenProvider,i=t.noRedirect,o=t.normalizeErrors,s=t.dataRequestorType,c=void 0===s?function(e){function t(t){return e.call(this,t,{pageContext:n,tokenProvider:a,noRedirect:i})||this}return(0,r.__extends)(t,e),t}(V.DataRequestor):s,d=e.dataSourceName,l=void 0===d?"DataSource":d;this.dataRequestor=new c({qosName:l,normalizeErrors:o})}e.prototype.getDataSourceName=function(){return this.dataSourceName},e.prototype.needsRequestDigest=function(e){return!0},e.prototype.getData=function(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h){void 0===i&&(i="POST");var b=e(),g=a&&a(),v=this.needsRequestDigest(b);return this.dataRequestor.getData({url:b,parseResponse:t,qosName:n,additionalPostData:g,method:i,additionalHeaders:r,contentType:o,maxRetries:s,noRedirect:c,crossSiteCollectionCall:d,telemetryHandler:l,qosExtraData:u,needsRequestDigest:v,authToken:f,webAbsoluteUrl:p,useExactAuthToken:m,skipSyncClient:_,customerPromise:h})}}(),p(734);var ge=p(408),ve=p(519),ye=p(141),Se=p(909),De=p(737);const Ie="https://clients.config.office.net";class xe{getPolicies(e){const t=new i._QosMonitor(e?`${e}.OCPSPolicyDataProvider.getPolicies`:"OCPSPolicyDataProvider.getPolicies");return this._tokenProvider._getTokenInternal(Ie,De._AadTokenProviders.preAuthorizedConfiguration).then(e=>this._serviceScope.consume(Se.HttpClient.serviceKey).get(this._policiesEndPoint,Se.AadHttpClient.configurations.v1,this._getRequestOptions(e)).then(e=>204===e.status?{}:e.json())).catch(e=>(t.writeUnexpectedFailure("FailedToOCPSPolicies",e),Promise.reject(e)))}getOCPSToken(e){return this._tokenProvider._getTokenInternal(e||Ie,De._AadTokenProviders.preAuthorizedConfiguration)}_getRequestOptions(e){const t={headers:{}};return t.headers["Content-Type"]="application/json",t.headers.Authorization=`Bearer ${e}`,t.headers["x-Cid"]="00000003-0000-0ff1-ce00-000000000000",t}get _policiesEndPoint(){return"https://clients.config.office.net/user/v1.0/web/policies"}constructor(e){this._serviceScope=e,this._tokenProvider=De._AadTokenProviders.configurable}}const Ce={connectedExperiences:ne.Enabled,policyAllowFeedback:ne.Enabled,policyAllowSurvey:ne.Enabled,policyAllowScreenshot:ne.Disabled,policyAllowContact:ne.Disabled,policyAllowContent:ne.Disabled,policyScreenshotDefault:ne.Disabled,policyEmailCollectionDefault:ne.Disabled,policyContentSamplesDefault:ne.Disabled};function Oe(e){return new xe(e).getPolicies().then(e=>{if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];if(t)return function(e=[]){const t={...Ce};return e.forEach(e=>{if("common\\feedback"===e.key&&"Web"===e.platform)switch(e.settingId){case"office16;L_SendFeedback":t.policyAllowFeedback=we(e);break;case"office16;L_SendSurvey":t.policyAllowSurvey=we(e);break;case"office16;L_Screenshot":t.policyAllowScreenshot=we(e);break;case"office16;L_EmailCollection":t.policyAllowContact=we(e);break;case"office16;L_LogCollection":t.policyAllowContent=we(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsScreenshot":t.policyScreenshotDefault=we(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsContentSamples":t.policyContentSamplesDefault=we(e);break;case"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsEmail":t.policyEmailCollectionDefault=we(e)}}),t}(t)}return Ce})}function we(e){return"1"===e.value?ne.Enabled:ne.Disabled}function Ee(e,t,n){const a=new Map,r=[],o=new i._AutoAlertableQosMonitor("PagesFeedback.collectCustomContextData",i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4,!1);try{if(n){a.set("SPBrowserPerformance.json",[ve._PerformanceLogger.capturePerfettoTraceData()]);let e=ke(i._TraceLogger._logManager);t&&(e=e.concat(ke(i._TraceLogger._verboseLogManager)));const n=window.ODSP_TELEMETRY_MANAGER||{_buffer:null},r=n._buffer?n._buffer.getAll():[];a.set("SystemTemeletryLogs.json",e.concat(r.map(Ae)))}const s=new CustomEvent(function(e){return`${e}_CustomContextData`}(e),{detail:{isSPDF:t,addLogs:(e,n)=>{if(!n)return;if(!t&&"Authoring Diagnostic.txt"===e)return;let i=a.get(e)||[];n&&(i=i.concat(n)),a.set(e,i)}}});document.dispatchEvent(s),a.forEach((e,t)=>{const n=new File([e.join("\n")],t,{type:"text/plain"});r.push(n)}),o.writeSuccess()}catch(e){return i._TraceLogger.logError(i._LogSource.create("PagesFeedbackCustomContext"),e),o.writeUnexpectedFailure("CatchAll",e),Promise.reject(e)}return Promise.resolve(r)}function Ae(e){const t=e=>{try{return new Date(e)}catch(e){return new Date}},{context:n,data:a,endTime:i,eventName:r,eventType:o,id:s,shortEventName:c,startTime:d}=e;return Le({context:n,data:a,endTime:t(i),eventName:r,eventType:o,id:s,shortEventName:c,startTime:t(d)})}function Le(e){try{return JSON.stringify(e,void 0,4)}catch(e){return""}}function ke(e){const t=[];return e.events.forEach(e=>{t.push(Le(e))}),t}const Me=2144,Pe="SharePoint";function Te(e){switch(e.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":return"Dogfood";default:return"Production"}}function Ue(){let e="Default";return a._BrowserUtilities.isTeamsWebViewHosted()||a._BrowserUtilities.isTeamsBrowserHosted()||a._BrowserUtilities.isEmbeddedInSite()?e="TeamsNonMobile":(a._BrowserUtilities.isTeamsAndroidHosted()||a._BrowserUtilities.isTeamsIOSHosted())&&(e="TeamsMobile"),e}function Fe(){const e=ve._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;let n;if(t.test(e)){const a=e.match(t);n=a?a[0].replace(/-/g,""):""}else n="0";return n}function He(e){Y(),(G?G().then(e=>Promise.resolve(e)).catch(e=>Promise.reject(e)):Promise.resolve(!0)).then(t=>{t||e.writeUnexpectedFailure("PagesFeedback Unmount Failed"),e.writeSuccess({OCVPanelIsUnmounted:t})}).catch(t=>{e.writeUnexpectedFailure(`PagesFeedback Unmount Failed with error: ${t}`)})}async function Re(e,t,n){const a=new i._AutoAlertableQosMonitor(`${n}.handleUnmountHVC`,i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4);try{t.unmountFeedback(),await t.preloadInAppFeedbackPackage(e)}catch(e){throw a.writeUnexpectedFailure(`${n}.handleUnmountHVC: ${e}`),e}}let Ne;async function Be(e,t,n){if(a._SPFlight.isEnabled(1086)){const r=function(e){return"Transpile-inAppFeedbackRef-id"===e?"TranspileFeedback":"Pages-inAppFeedbackRef-id"===e?"PagesFeedback":""}(n),o=new i._AutoAlertableQosMonitor(`${r}PagesFeedback.LazyLoadInAppFeedbackModule`,i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4);return new Promise((s,c)=>{var d,l;d=()=>{const e=document.querySelector("#fluent-default-layer-host");e instanceof HTMLElement&&(e.style.zIndex=e.style.zIndex+100),s()},l=e=>{c(new Error(e))},(async()=>p.e(355).then(p.bind(p,39)).then(e=>e).catch(e=>{throw e}))().then(s=>{const u=function(e,t){const n=e.consume(ge.PageContext.serviceKey),a=document.getElementById(t);return{hostName:Pe,locale:n.cultureInfo.currentUICultureName,inAppFeedbackRef:a}}(e,n??"inapp-feedback-ref");(async function(e,t,n,r,o,s,c){const d=new i._AutoAlertableQosMonitor(`${c}.getOCVUserFeedbackInitOptions`,i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4),{featureArea:l,enableCustomContextData:u,disableFileUpload:f,disablePerfettoEntry:p}=t,m=e.consume(ge.PageContext.serviceKey),{legacyPageContext:_}=m,h=_.aadTenantId?.toString(),b=`a:${_.aadUserId?.toString()}`,g=await Oe(e),v=m.legacyPageContext&&m.legacyPageContext.cloudType||"",y=Te(v);let S;if(u){const e="spdf"===v;S={isShareContextDataEnabled:g?.policyContentSamplesDefault===ne.Enabled,isDiagnosticsIncluded:!0,diagnosticsUploadId:"",diagnosticsEndPoint:"",getContextData:()=>Ee(l,e,!p),waitForDiagnosticsUpload:!0}}return{ageGroup:X.Adult,appId:Me,clientName:Pe,feedbackConfig:{isDisplayed:!0,appData:JSON.stringify({UiHost:Ue(),build:Fe(),entryPoint:t.entryPoint||"Pages CoAuth Feedback Button",...t.appData}),feedbackUiType:re.SidePane,isThankYouPageDisabled:!1,isEmailCollectionEnabled:g&&g.policyAllowContact===ne.Enabled,isScreenshotEnabled:g&&g.policyAllowScreenshot===ne.Enabled,isFileUploadEnabled:!f,isScreenRecordingEnabled:g&&g.policyAllowScreenshot===ne.Enabled,complianceChecks:g,diagnosticsConfig:S,screenshotInfo:{providedScreenshotType:ie.AutoCapture},msInternalTitleTarget:be(y),email:m.user.email},telemetry:{audienceGroup:y,deviceType:navigator.userAgent,officeUILang:_.currentLanguage,platform:navigator.platform,featureArea:l,sourcePageURI:window.location.href},callbackFunctions:{onError:e=>{d.writeUnexpectedFailure(e||"UnknownError"),r(e)},initializationComplete:n,onDismiss:async e=>{ve._EngagementLogger.logEvent("PagesFeedback."+(e?"Submitted":"Dismissed")),t.unmountOnClose&&await Re(o,s,c),d.hasEnded||d.writeSuccess({isFeedbackSent:e})},onSuccess:async e=>{d.writeSuccess({isFeedbackSent:!0,clientFeedbackId:e}),t.unmountOnClose&&await Re(o,s,c)}},authenticationType:te.AAD,isProduction:a.Environment.type===a.EnvironmentType.SharePoint,tenantId:h,themeOptions:{baseTheme:(0,ye.getTheme)()},userId:b}})(e,t,d,l,u,s,r).then(async e=>{try{await s.launchFeedback(u,e)}catch(e){throw o.writeUnexpectedFailure(`${r}.LaunchFeedbackModule: ${e}`),e}}).catch(e=>c(e))}).catch(e=>{o.writeUnexpectedFailure(`${r}.LazyLoadInAppFeedbackModule: ${e}`),c(e)})})}return await function(e,t){if(a._SPFlight.isEnabled(1086)){if(!Ne){const t=e.consume(ge.PageContext.serviceKey),{legacyPageContext:n}=t;Ne=q({appId:String(Me),hostName:Pe,language:n.currentUICultureName,inAppFeedbackRef:void 0})}return Ne}if(!Ne){const t=e.consume(ge.PageContext.serviceKey),{legacyPageContext:n}=t;Ne=q({appId:String(Me),hostName:Pe,language:n.currentUICultureName})}return Ne}(e),new Promise((n,r)=>{(async function(e,t,n,o){const s=new i._AutoAlertableQosMonitor("PagesFeedback.getOCVUserFeedbackInitOptionsDeprecated",i._AutoAlertableMonitorType.StaticReliabilityQos95Sev4),{featureArea:c,enableCustomContextData:d,disableFileUpload:l,disablePerfettoEntry:u}=t,f=e.consume(ge.PageContext.serviceKey),{legacyPageContext:p}=f,m=p.aadTenantId?.toString(),_=`a:${p.aadUserId?.toString()}`,h=await Oe(e),b=f.legacyPageContext&&f.legacyPageContext.cloudType||"",g=Te(b);let v;if(d){const e="spdf"===b;v={isShareContextDataEnabled:h?.policyContentSamplesDefault===ne.Enabled,isDiagnosticsIncluded:!0,diagnosticsUploadId:"",diagnosticsEndPoint:"",getContextData:()=>Ee(c,e,!u),waitForDiagnosticsUpload:!0}}return{ageGroup:X.Adult,appId:Me,clientName:Pe,feedbackConfig:{isDisplayed:!0,appData:JSON.stringify({UiHost:Ue(),build:Fe(),entryPoint:t.entryPoint||"Pages CoAuth Feedback Button",...t.appData}),feedbackUiType:re.SidePane,isThankYouPageDisabled:!1,isEmailCollectionEnabled:h&&h.policyAllowContact===ne.Enabled,isScreenshotEnabled:h&&h.policyAllowScreenshot===ne.Enabled,isFileUploadEnabled:!l,isScreenRecordingEnabled:h&&h.policyAllowScreenshot===ne.Enabled,complianceChecks:h,diagnosticsConfig:v,screenshotInfo:{providedScreenshotType:ie.AutoCapture},hostPlatform:oe.Web,msInternalTitleTarget:be(g),email:f.user.email},telemetry:{audienceGroup:g,deviceType:navigator.userAgent,officeUILang:p.currentLanguage,platform:navigator.platform,featureArea:c,sourcePageURI:window.location.href},callbackFunctions:{onError:e=>{s.writeUnexpectedFailure(e||"UnknownError"),(e=>{r(new Error(e))})(e)},initializationComplete:n,onDismiss:e=>{ve._EngagementLogger.logEvent("PagesFeedback."+(e?"Submitted":"Dismissed")),t.unmountOnClose&&He(s),s.hasEnded||s.writeSuccess({isFeedbackSent:e})},onSuccess:e=>{s.writeSuccess({isFeedbackSent:!0,clientFeedbackId:e}),t.unmountOnClose&&He(s)}},authenticationType:te.AAD,isProduction:a.Environment.type===a.EnvironmentType.SharePoint,tenantId:m,themeOptions:{baseTheme:(0,ye.getTheme)()},userId:_}})(e,t,n).then(Q).catch(e=>r(e))})}class je{static getInstance(){return je._instance||(je._instance=new je),je._instance}async getModule(){return this._cachedModule?this._cachedModule:(this._modulePromise||(this._modulePromise=p.e(355).then(p.bind(p,39)).then(e=>(this._cachedModule=e,e))),this._modulePromise)}preloadModule(){return this.getModule()}constructor(){}}function Ve(){return a._SPKillSwitch.isActivated("c92a6904-e57b-4c29-9be0-7aa630563490")}function ze(){return a._SPKillSwitch.isActivated("de7bd57f-7dd2-441b-9dc2-1d3c1caf65fa")}class Ge{static getFeedbackOptions(e){return{appId:e.appId||2144,tenantId:e.tenantId,userId:e.userId,ageGroup:e.ageGroup||X.Adult,authenticationType:te.AAD,clientName:e.clientName||"SharePoint",isProduction:this._isEnvironmentProduction(),feedbackConfig:{email:e.email,featureAreas:e.featureArea?[e.featureArea]:[],feedbackUiType:re.Modal,diagnosticsConfig:{isShareContextDataEnabled:!1},isScreenshotEnabled:!0,isFileUploadEnabled:!0,isEmailCollectionEnabled:!0,complianceChecks:e.complianceChecks,appData:JSON.stringify({...JSON.parse(e.appData||"{}"),build:this._getBuildNumber()}),scenarioConfig:{isScenarioEnabled:!0},hostPlatform:oe.Web},telemetry:{...e.telemetry,featureArea:e.telemetry?.featureArea||"CopilotFeedback"},themeOptions:{baseTheme:(0,ye.getTheme)()}}}static _isEnvironmentProduction(){return a.Environment.type===a.EnvironmentType.SharePoint}static _getBuildNumber(){const e=ve._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;let n;if(t.test(e)){const a=e.match(t);n=a?a[0].replace(/-/g,""):""}else n="0";return n}}const Ke="in-app-feedback-host";class We{static getInstance(e,t,n){return We._instance?(We._instance._setOverrideOptions(n),t&&We._instance._diagnosticAppData.set("sessionId",t)):We._instance=new We(e,t,n),We._instance._moduleManager.preloadModule(),We._instance}async canDisplayFeedback(){const{canDisplayFeedback:e,updateFeedbackOptions:t}=await this._moduleManager.getModule();await this._setupCompliancePolicies();const n=Ge.getFeedbackOptions(this._feedbackParams),a=await this._getOCPSToken(),i=await e(n,a);return i.canDisplay&&(this._feedbackInitOptions=i.init),this._launched&&t(i.init),i.canDisplay}async updateFeedbackOptions(e){this._setOverrideOptions(e),this._launched&&(this._ensureScenarioNameMatch(),(await this._moduleManager.getModule()).updateFeedbackOptions(Ge.getFeedbackOptions(this._feedbackParams)))}dispose(){this._overrideOptions=void 0,this._feedbackInitOptions=void 0}get _appId(){return 2144}get _clientName(){return"SharePoint"}get _appName(){return"SharePointPages"}get _featureArea(){return this._overrideOptions?.featureArea||"Copilot ODSP Apps"}get _language(){return this._pageContext.cultureInfo.currentUICultureName||"en-us"}get _appData(){return JSON.stringify(Object.entries(this._diagnosticAppData))}get _environment(){const{legacyPageContext:e}=this._pageContext;return Te(e&&e.cloudType||"")}get _audienceGroup(){if(this._overrideOptions?.audienceGroup)return this._overrideOptions.audienceGroup;const{legacyPageContext:e}=this._pageContext;switch((e&&e.cloudType||"").toLowerCase()){case"devbox":case"edog":case"spdf":return"Dogfood";case"prodbubble":return"Microsoft";default:return"Production"}}get _feedbackParams(){const{legacyPageContext:e}=this._pageContext;return{appId:this._appId,clientName:this._clientName,complianceChecks:this._complianceChecks,appData:this._appData,authenticationType:te.AAD,featureArea:Ve()?this._featureArea:void 0,isProduction:a.Environment.type===a.EnvironmentType.SharePoint,userId:`a:${e?.aadUserId?.toString()}`,tenantId:e?.aadTenantId?.toString(),officeUILang:e.currentLanguage,environment:this._environment,telemetry:Ve()?void 0:{featureArea:this._featureArea,audienceGroup:this._audienceGroup,featureName:`${this._overrideOptions?.appName||"Default"}.${this._overrideOptions?.feature||""}`,subFeatureName:this._overrideOptions?.scenario||""},email:Ve()?void 0:this._pageContext.user.email,UiHost:a._SPKillSwitch.isActivated("6949cd02-74b0-4782-b359-dadbc9c7997a")||"SmartSections"!==this._overrideOptions?.feature&&"RTECopilot"!==this._overrideOptions?.feature?void 0:this._overrideOptions?.uiHost}}_getContextData(e){const t={};this._diagnosticAppData.forEach((e,n)=>{t[n]=e});const n=JSON.stringify({promptId:e.id,prompt:e.prompt,responseMessage:e.plainText,...t}),a=new File([n],"contextData.txt",{type:"text/plain"});return new Promise(e=>{e([a])})}async _getOCPSToken(){const{getCloudPolicyServiceTokenAudience:e}=await this._moduleManager.getModule(),t=e(Ge.getFeedbackOptions(this._feedbackParams)),n=new xe(this._serviceScope),a=await n.getOCPSToken(t.audience);return t.supported?{token:a,tokenAudienceResult:t}:{tokenAudienceResult:t}}_setOverrideOptions(e){this._overrideOptions=e}_ensureScenarioNameMatch(){a._SPKillSwitch.isActivated("abd386ed-6fee-4667-bb8f-e67ae78e4164")||this._feedbackInitOptions?.telemetry&&this._overrideOptions?.scenario&&(this._feedbackInitOptions.telemetry.subFeatureName=this._overrideOptions.scenario)}constructor(e,t,n){this.componentId="9cce2710-26ff-4b84-a0b3-9a24a2d453f1",this.instanceId=a.Guid.newGuid().toString(),this._moduleManager=je.getInstance(),this._hostElement=document.createElement("div"),this._launched=!1,this.logCopilotUserFeedback=async(e,t)=>{const{positive:n,message:i,conversationId:r,userQueryIds:o,siteId:s}=e,{updateFeedbackOptions:c,InAppFeedbackScenarioType:d,launchFeedback:l}=await this._moduleManager.getModule();this._ensureScenarioNameMatch();const u=this._feedbackInitOptions??Ge.getFeedbackOptions(this._feedbackParams);this._launched||await this._setupCompliancePolicies(),u.themeOptions={baseTheme:(0,ye.getTheme)()},t&&(u.callbackFunctions=t),a._SPKillSwitch.isActivated("50b5e327-d762-430a-bb46-52881380df52")||(u.telemetry={...this._feedbackInitOptions?.telemetry,...this._feedbackParams.telemetry});const f=!ze()&&this._complianceChecks.policyAllowContact===ne.Enabled&&"Production"!==this._environment;if(u.feedbackConfig={...u.feedbackConfig,msInternalTitleTarget:ze()||"Dogfood"!==this._environment?void 0:"SharePoint engineering",isEmailCollectionEnabled:f,email:f?this._pageContext.user.email:void 0,isDisplayed:!0,diagnosticsConfig:{isShareContextDataEnabled:!a._SPKillSwitch.isActivated("2e293b5f-bc7f-40e5-a5f2-989876fa8bb7")&&!e.positive,getContextData:()=>this._getContextData(i)}},a._SPKillSwitch.isActivated("27c13622-b22a-4b53-af18-34164bfffe02")||"SharePointAuthoringCopilot.SmartSections"!==u.telemetry?.featureName||(u.feedbackConfig.diagnosticsConfig={...u.feedbackConfig.diagnosticsConfig,isShareContextDataEnabled:!0}),n?(u.feedbackConfig.initialFeedbackType=J.Smile,u.feedbackConfig.scenarioConfig={isScenarioEnabled:!0,scenarioType:d.AIThumbsUp}):(u.feedbackConfig.initialFeedbackType=J.Frown,u.feedbackConfig.scenarioConfig={isScenarioEnabled:!0,scenarioType:d.AIThumbsDown}),this._overrideOptions){const e=JSON.parse(u.feedbackConfig.appData||"{}");u.feedbackConfig.appData=JSON.stringify({...e,feature:this._overrideOptions.feature,appName:this._overrideOptions.appName,scenario:this._overrideOptions.scenario,sessionId:this._diagnosticAppData.get("sessionId"),conversationId:r,userQueryIds:o,siteId:s,hostApp:this._appName,env:this._environment,copilotType:this._diagnosticAppData.get("copilotType")})}this._feedbackInitOptions=u,this._launched?c(u):this._launched=!0,await l({hostName:this._clientName,locale:this._language,inAppFeedbackRef:this._hostElement},u)},this._setupCompliancePolicies=async()=>{const e=await new xe(this._serviceScope).getPolicies();if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];t&&(t.forEach(e=>{"common\\feedback"===e.key&&"Web"===e.platform&&("office16;L_SendFeedback"===e.settingId?this._complianceChecks.policyAllowFeedback="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_SendCopilotFeedback"===e.settingId?this._complianceChecks.policyAllowCopilotFeedback="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_SendSurvey"===e.settingId?this._complianceChecks.policyAllowSurvey="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_Screenshot"===e.settingId?this._complianceChecks.policyAllowScreenshot="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_EmailCollection"===e.settingId?this._complianceChecks.policyAllowContact="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_LogCollection"===e.settingId?this._complianceChecks.policyAllowContent="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_ConnectedOfficeExperience"===e.settingId?this._complianceChecks.connectedExperiences="1"===e.value?ne.Enabled:ne.Disabled:"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsContentSamples"===e.settingId?ze()||(this._complianceChecks.policyContentSamplesDefault="1"===e.value?ne.Enabled:ne.Disabled):"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsScreenshot"===e.settingId?ze()||(this._complianceChecks.policyScreenshotDefault="1"===e.value?ne.Enabled:ne.Disabled):"office16;L_FeedbackOptionsDefaults;L_FeedbackOptionsDefaultsEmail"===e.settingId&&(ze()||(this._complianceChecks.policyEmailCollectionDefault="1"===e.value?ne.Enabled:ne.Disabled)))}),(this._complianceChecks.policyAllowCopilotFeedback===ne.Enabled||this._complianceChecks.policyAllowCopilotFeedback===ne.NotConfigured&&this._complianceChecks.policyAllowFeedback!==ne.Disabled)&&(this._complianceChecks.policyAllowFeedback=ne.Enabled))}const{getTenantCloudType:t}=await this._moduleManager.getModule();this._complianceChecks.tenantCloudType=await t(this._feedbackParams)||void 0},this._serviceScope=e,this._diagnosticAppData=new Map([["sessionId",t],["copilotType","outOfBox"]]),this._complianceChecks={connectedExperiences:ne.NotConfigured,policyAllowCopilotFeedback:ne.NotConfigured,policyAllowFeedback:ne.NotConfigured,policyAllowSurvey:ne.NotConfigured,policyAllowScreenshot:ne.NotConfigured,policyAllowContact:ne.NotConfigured,policyAllowContent:ne.NotConfigured,policyEmailCollectionDefault:ne.NotConfigured,policyContentSamplesDefault:ne.NotConfigured,policyScreenshotDefault:ne.NotConfigured},this._overrideOptions=n,e.whenFinished(()=>{this._pageContext=e.consume(ge.PageContext.serviceKey)});let r=document.getElementById(Ke);r||(r=document.createElement("div"),r.id=Ke,document.body.appendChild(r)),i._TraceLogger.logVerbose(We._logSource,`${this._overrideOptions?.scenario||"RTE copilot"} feedback initialized AugLoop SessionId: ${t}`)}}We._logSource=i._LogSource.create("PagesCopilotFeedback");var qe=p(959);function Qe(e){const{serviceScope:t,overrideOptions:n}=e,[a,i]=(0,qe.useState)(!1),[r,o]=(0,qe.useState)(!0),[s,c]=(0,qe.useState)(void 0);return(0,qe.useEffect)(()=>((async()=>{try{o(!0),c(void 0);const e=We.getInstance(t,void 0,n),a=await e.canDisplayFeedback();i(a)}catch(e){const t=e instanceof Error?e:new Error("Failed to check feedback support");c(t),i(!1)}finally{o(!1)}})(),()=>{a&&We.getInstance(t,void 0,n).dispose()}),[t]),{canDisplay:a,isLoading:r,error:s}}})(),g})())})();