(()=>{var e=document.currentScript;define("c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-loader","react","react-dom","@microsoft/sp-core-library","@msinternal/sp-component-utilities","@microsoft/sp-http","@microsoft/sp-page-context","@msinternal/odsp-utilities-bundle","@microsoft/sp-http-base","@msinternal/odsp-core-bundle","@ms/office-ui-fabric-react-bundle","@msinternal/sp-telemetry","@microsoft/load-themed-styles","@microsoft/sp-webpart-base","@microsoft/sp-property-pane","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/swc-helpers-bundle","@msinternal/sp-fluentui-migration-spinner-bundle","@msinternal/sp-fluentui-migration-label-bundle","@msinternal/sp-fluentui-migration-tooltip-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sp-fluentui-migration-textfield-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I)=>(()=>{"use strict";var x={424:e=>{e.exports=m},676:e=>{e.exports=r},207:e=>{e.exports=t},909:e=>{e.exports=s},737:e=>{e.exports=l},414:e=>{e.exports=n},408:e=>{e.exports=c},877:e=>{e.exports=h},642:e=>{e.exports=_},141:e=>{e.exports=f},277:e=>{e.exports=u},810:e=>{e.exports=d},718:e=>{e.exports=o},575:e=>{e.exports=D},485:e=>{e.exports=y},907:e=>{e.exports=b},464:e=>{e.exports=v},944:e=>{e.exports=I},94:e=>{e.exports=S},519:e=>{e.exports=p},592:e=>{e.exports=g},959:e=>{e.exports=a},398:e=>{e.exports=i}},C={};function O(e){var t=C[e];if(void 0!==t)return t.exports;var n=C[e]={exports:{}};return x[e](n,n.exports,O),n.exports}O.m=x;var w,E,A,L={"112":"ys9lD1qDw/8+XMBMkbA9vx0IJPSxi9QrWXVoM9FwsXw=","220":"b7ct/anLDrtmSyetWYo1Yuk5hps8PWG46xT50CjYdRg=","716":"wXKmY6goY7Fzs7h16R/KEDtxMmmp7MMAC1OwLdsSGkU=","769":"4UETU69gR4ZyaweM9/VNnwPvjFbA5wsjiD+szGv6zvE=","777":"558pkyOIrW4Bs+W0PjQlpbHbEGNcfmVhtvsAJq+Zs24=","875":"V1ofuQxbK7tfmnCF4a089DzYvSlqgOz65uHJa891/oE="};O.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return O.d(t,{a:t}),t},O.d=(e,t)=>{for(var n in t)O.o(t,n)&&!O.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},O.f={},O.e=e=>Promise.all(Object.keys(O.f).reduce((t,n)=>(O.f[n](e,t),t),[])),O.u=e=>"chunk."+({112:"adaptive-card-extension-supported-icon-map",220:"MoveCopyDataSource",716:"dialog-utility",769:"webpack-shared-editmode-fabric-dialog",875:"ms/sp-filepicker-host"}[e]||e)+"_"+({716:1,875:1}[e]?"en-us":"none")+"_"+{112:"6279ebc8f0f1469d505f",220:"a2e4a31450cbf2c1e0cf",716:"cb897477ab52987bc8ac",769:"01f5130d8c98ff6a5293",777:"ffa8f151e47d1e48aaf1",875:"20a14f30916f4565043a"}[e]+".js",O.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),w={},E="c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0:",O.l=(e,t,n,a)=>{if(w[e])w[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==E+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,O.nc&&i.setAttribute("nonce",O.nc),i.setAttribute("data-webpack",E+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(L[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}w[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=w[e];if(delete w[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},O.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},A=e?e.src:"",O.p=A.slice(0,A.lastIndexOf("/")+1),O.f.compat=(e,t)=>{for(var n=function(e){var t={i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},n={i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.61",m:825};return{777:[t],875:[t,{i:"a9f7aaec-2fc2-4fd9-9f54-45a0e79d6b14",v:"0.1.0",m:568},n],220:[t],716:[{i:"b9fc293f-811a-4b1c-a851-a1fbcb7851bf",v:"0.1.0",m:966},{i:"05ed6956-59ad-4aa6-9e4e-b832c96ae87b",v:"0.9.21",m:392},{i:"a7e40b4f-0b7b-4c35-a1b7-94d7b4548907",v:"0.1.0",m:671},{i:"c6e9b8a2-5f7d-4e0b-8b9b-1e3c7a9d3f4f",v:"0.1.0",m:930},{i:"0ec74f52-38bc-4a51-ab82-7c91a2b399a2",v:"0.1.0",m:606}],769:[t,n]}[e]||[]}(e),a=0;a<n.length;a++)O.m[n[a].m]||(e=>{t.push(k.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{O.m[e.m]=e=>e.exports=t}))})(n[a])};var k=O(414);(()=>{var e={530:0};O.f.j=(t,n)=>{var a=O.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=O.p+O.u(t),o=new Error;O.l(r,n=>{if(O.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)O.o(o,a)&&(O.m[a]=o[a]);s&&s(O)}for(t&&t(n);c<r.length;c++)i=r[c],O.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]=self["webpackJsonp_c79b9f88-6338-40fb-b463-3aad22a88b15_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var M={};return(()=>{O.r(M),O.d(M,{CardMotionWebPartId:()=>Ie,DeferredDialog:()=>Z,DeferredDialogContent:()=>ne,DeferredDialogFooter:()=>ee,DocLibraryContext:()=>J,FilePickerLoader:()=>n,LazyDialog:()=>X,LazyDialogContent:()=>te,LazyDialogFooter:()=>$,LinkTextBox:()=>Oe,LocalFilePreview:()=>Y,OpenSPFilePickerHost:()=>c,PropertyPaneAudienceToggle:()=>De,SPFileHandler:()=>G,SPFileHandlerError:()=>y,SPFilePickerHostLoader:()=>s,ThumbnailSourceType:()=>oe,ThumbnailType:()=>re.ThumbnailType,calculateExifOrientation:()=>f,convertDataUriToArrayBuffer:()=>p,encodeQuerySegment:()=>L,ensureOrientation:()=>u,ensureURLEncoded:()=>R,getDefaultHeaders:()=>B,getFallbackSharingLinkRequestBody:()=>j,getIconUrl:()=>be,getPropertyPaneThumbnail:()=>_e,getSharePointImageUrl:()=>F,handleFileUploadError:()=>A,isExternalSharePointAsset:()=>U,isODBFilePickerEnabled:()=>V,isUrlEncoded:()=>H,isValidGuid:()=>N,mapServerResponseToUploadResult:()=>k,replaceSpecialCharacters:()=>P,rotatedExifOrientation:()=>l,supportedIcons:()=>he});var e=O(207),t=O(414);class n{static load(n,a){return t.SPComponentLoader.loadComponentById("a81a5cf6-c9ad-4a0a-85aa-68c03d2d22a2").then(t=>{const i=new t.FilePicker(n);return i.initialize(a),i.fetchData().catch(t=>e._TraceLogger.logError(e._LogSource.create("FilePickerLoader"),t,"fetchData")),i})}}var a=O(959),i=O(398),r=O.n(i);const o=a.lazy(()=>Promise.all([O.e(777),O.e(875)]).then(O.bind(O,440)).then(e=>({default:e.SPFilePickerHost})));function s(e){return a.createElement(a.Suspense,{fallback:!1},a.createElement(o,e))}function c(e,t){r().render(a.createElement(s,e),t)}var d=O(676);const l=[5,6,7,8];function u(t,n){if(!t||!t.src)return;const a=d._BrowserDetection.getBrowserInformation();a.browser===d._Browser.Firefox||(a.browser===d._Browser.Chrome||a.browser===d._Browser.EdgeChromium)&&a.browserVersion&&a.browserVersion.greaterThan(d.Version.parse("81.0.0.0"))?t.style.visibility="visible":p(t.src).then(e=>f(e)).then(e=>{if(void 0===e||isNaN(e)||1===e)return t.style.transform=void 0,void(t.style.visibility="visible");let a;switch(-1!==[5,6,7,8].indexOf(e)&&n&&n(),e){case 2:a="-1, 0, 0, 1, 0, 0";break;case 3:a="-1, 0, 0, -1, 0, 0";break;case 4:a="1, 0, 0, -1, 0, 0";break;case 5:a="0, 1, 1, 0, 0, 0";break;case 6:a="0, 1, -1, 0, 0, 0";break;case 7:a="0, -1, -1, 0, 0, 0";break;case 8:a="0, -1, 1, 0, 0, 0"}t.style.transform=`matrix(${a})`,t.style.visibility="visible"}).catch(t=>e._TraceLogger.logError(e._LogSource.create("ensureOrientation"),t,"convertDataUriToArrayBuffer"))}function f(e){if(!e)return Promise.resolve(void 0);const t=new DataView(e);if(65496!==t.getUint16(0,!1))return Promise.resolve(void 0);const n=t.byteLength;let a=2;for(;a<n;){const e=t.getUint16(a,!1);if(a+=2,65505===e){if(1165519206!==t.getUint32(a+=2,!1))return Promise.resolve(void 0);const e=18761===t.getUint16(a+=6,!1);a+=t.getUint32(a+4,e);const n=t.getUint16(a,e);a+=2;for(let i=0;i<n;i++)if(274===t.getUint16(a+12*i,e)){const n=t.getUint16(a+12*i+8,e);return Promise.resolve(n)}}else{if(65280!=(65280&e))break;a+=t.getUint16(a,!1)}}return Promise.resolve(void 0)}function p(e){return fetch(e).then(e=>e.arrayBuffer()).catch(e=>{})}var m=O(718),_=O(909),h=O(408),b=O(810),g=O(277),v=O(737);class y extends Error{constructor(e,t){super(e),this.__proto__=y.prototype,this.errorCode=t}}const S=JSON.parse('{"Y$":"The security validation for this page has timed out. Refresh the page or use the back button in your browser to try again.","JL":"The file or folder {0} contains invalid characters such as # % * : < > ? / | and cannot be selected.","ze":"Access denied. You do not have permission to perform this action or access this resource.","wk":"Can\\u0027t upload this item. Please refresh the page.","Ah":"Can\\u0027t upload this item due to error on client.","EM":"The sharing link couldn\\u0027t be created","HN":"The video was added to the page, but people might not be able to view it if they don\\u0027t already have access.","BY":"Close"}');var D,I;function x(){return d._SPKillSwitch.isActivated("42f427de-65a5-49c9-9e71-1c1c6a677c11")}function C(){return d._SPKillSwitch.isActivated("3f9bf326-f86b-4992-b5fe-87eae7ab8390")}function w(){return d._SPKillSwitch.isActivated("215d1cd5-38da-4f1f-8da8-d3ff1cfe4cd0")}function E(){return d._SPKillSwitch.isActivated("b53378d6-f31e-4c45-a1da-80d2933dc8db")}function A(e,t,n,a,i){const r={odataErrorCode:e.code,odataErrorMessage:e.message&&e.message.value,correlationId:n?n.toString():void 0,statusCode:i};throw T(e,"-2130575252")?(t.writeExpectedFailure("SecurityValidationTimeOut",void 0,r),new y(S.Y$,e.code)):T(e,"-2130575245")?(t.writeExpectedFailure("InvalidCharacters",void 0,r),new y(d.Text.format(S.JL,a),e.code)):T(e,"-2147024891")?(t.writeExpectedFailure("NoPermission",void 0,r),new y(S.ze,e.code)):T(e,"-2130575257")||T(e,"-2130575342")?(t.writeExpectedFailure("FileFolderAlreadyExists",void 0,r),new y(S.ze,e.code)):(!E()&&i&&(0,m.isExpectedClientError)(i)?t.writeExpectedFailure("FileUploadError",new Error(e?.message?.value),r):t.writeUnexpectedFailure("UncategorizedError",void 0,r),new y(S.wk,e.code))}function L(e,t,n){return`${e}=%27${b.UriEncoding.encodeRestUriStringToken(t,n)}%27`}function k(e){return{listId:e.ListId,uniqueId:e.UniqueId,serverRelativeUrl:e.ServerRelativeUrl,title:e.Title}}function P(e){const t=w()?new RegExp("[&/\\# ,+()$~'\":*?<>{}|]|%2.","g"):new RegExp("[&/\\\\# ,+()$~'\":*?<>{}|\\s\\u00A0\\u1680\\u180E\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\u200B]|%2.","g");return e?e.replace(t,"-"):""}function T(e,t){return!!e.code&&String(e.code).indexOf(t)>-1}function U(e,t){return Boolean(d._SPFlight.isEnabled(61766)&&t?.SiteId&&t?.WebId&&t?.ListId&&t?.UniqueId&&(e.site.id.toString()!==d.Guid.parse(t.SiteId).toString()||e.web.id.toString()!==d.Guid.parse(t.WebId).toString()))}function F(e){const t=e.ServerAbsoluteUrl||e.Link,n=new b.Uri(t),a=n.getAuthority()===window.location.host?n.getPath():t;return w()?a:R(a)||a}function H(e){const t=decodeURI(e);return e===encodeURI(t)}function R(e){if(e)return!d._SPKillSwitch.isActivated("495ffbd0-0ab2-4a5d-aa93-9d2f2f9a3458")&&H(e)?e:b.UriEncoding.encodeURIComponent(e,!0)}function N(e){return"{"===e[0]&&(e=e.substring(1,e.length-1)),d.Guid.isValid(e)&&"00000000-0000-0000-0000-000000000000"!==e}function B(){const e=new Headers;return e.append("accept","application/json; odata=nometadata"),e.append("OData-version","3.0"),e}function j(){return JSON.stringify({request:{createLink:!0,settings:{allowAnonymousAccess:!1,linkKind:D.organizationView,nav:"",password:"",restrictShareMembership:!1,role:I.view,scope:1,updatePassword:!1}}})}function V(){return!d._SPKillSwitch.isActivated("fd54e993-3a17-4eb5-b54f-1a91af0401d0")&&d._SPFlight.isEnabled(1342)}function z(){return d._SPFlight.isEnabled(62406)}!function(e){e[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess"}(D||(D={})),function(e){e[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.limitedView=4]="limitedView",e[e.limitedEdit=5]="limitedEdit",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}(I||(I={}));class G{static get pagePathName(){return-1!==window.location.pathname.toUpperCase().indexOf("/NEWPAGE.ASPX")&&e._TraceLogger.logError(G._logSource,new Error("Page media upload before page titled.")),window.location.pathname}static getFileNameFromUrl(e){const t=new RegExp("^(?:[a-z]+:)?//","i"),n=e.replace(/\/$/,"");let a="";if(a=t.test(n)?new URL(n).pathname.split("/").pop():n.split("/").pop(),!a)throw new Error(`Could not parse file name from url: ${e}`);return a}static replaceSpecialCharacters(e){return P(e)}static validateFileType(e,t){const n=e?.name||e,a=n.lastIndexOf(".");let i;return-1!==a&&(i=n.substring(a+1,n.length),t.indexOf(i.toLowerCase())>-1)}static _isPageAssetFolderBindingEnabled(){return!d._SPKillSwitch.isActivated("5b8b049b-2476-4c92-8599-2e0a94837a43")&&d._SPFlight.isEnabled(60296)&&!this._isDisableSitePagesStrongBinding}readFile(t){return this._reader||(this._reader=new FileReader),new Promise((n,a)=>{t||(e._TraceLogger.logVerbose(G._logSource,"File is undefined"),a(new RangeError("FileUndefined"))),this._reader.onloadend=()=>n(this._reader.result),this._reader.onerror=()=>{e._TraceLogger.logVerbose(G._logSource,"Error occurred when reading the file"),a(this._reader.error)},this._reader.readAsDataURL(t)})}uploadLocalFile(e,t,n,a=!1,i,r=!1,o){return G._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(s=>s.executeActionAsync(()=>this._uploadLocalFile(e,t,n,a,i,r,o))):this._uploadLocalFile(e,t,n,a,i,r,o)}async moveCopyExternalFileToSiteAssets(t,n=!1,a=!1){const i=decodeURI(t.ServerAbsoluteUrl||t.Link),r=this._getUniqueCopyFileName(i,t.UniqueId,t.FileName,a),o=new e._QosMonitor(`${this._qosPrefix}.moveCopyExternalFileToSiteAssets`),s=await this._ensureMoveCopyDataSource(),c={isFolder:!1,itemFullUrl:decodeURI(i),sharepointId:t.SiteId,listItemUniqueId:t.UniqueId,displayName:r},d={webAbsoluteUrl:await this.getSitePagesAssetFolderUrl(),folderPath:""};try{let e={};const a=t=>{const n=t.get(c.itemFullUrl)||t.get(c.sharepointId);if(n&&n.jobFinishedResult){const t=n.jobFinishedResult;e={listId:t.listId,serverRelativeUrl:`${"/"!==this._pageContext.web.serverRelativeUrl?this._pageContext.web.serverRelativeUrl:""}/${t.siteRelativeUrl}`,title:r,uniqueId:t.uniqueId}}if(n&&n.error){const e=n.error;throw o.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new y(S.wk)}};return await s.moveCopyItems({items:[c],destinationItem:d,isMove:n,customizedFileName:[r],sourceWebAbsoluteUrl:t.SiteUrl||this._pageContext.web.absoluteUrl,onMoveCopyProgress:a}),o.writeSuccess(),e}catch(e){throw o.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new y(S.wk)}}uploadExternalFile(e,t,n){return w()&&!V()||(t=G.replaceSpecialCharacters(t)),G._isPageAssetFolderBindingEnabled()?this._pageService.getItemUpdateQueue().then(a=>a.executeActionAsync(()=>this._uploadExternalFile(e,t,n))):this._uploadExternalFile(e,t)}validateMimeType(e,t){if(e.type){const n=e.type.slice(e.type.lastIndexOf("/")+1);if(n)return t.indexOf(n.toLowerCase())>-1}return!1}getSitePagesAssetFolderUrl(){const t=new e._QosMonitor(`${this._qosPrefix}.getOrCreateAssetFolderApi`),n=this._getOrCreateAssetFolderApiPostUrl(),a=B();return this._httpClient.post(n,_.SPHttpClient.configurations.v1,{headers:a,body:void 0}).then(e=>e.json()).then(e=>{if(""===e.value)throw t.writeUnexpectedFailure("EmptyResponse",void 0),new y(S.wk);return t.writeSuccess(),b.Uri.concatenate(new b.Uri(this._pageContext.web.absoluteUrl).getLeftPart(b.UriPartial.authority),e.value)}).catch(e=>{throw t.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new y(S.wk)})}getPageName(t=""){t=t.trim();const n=this.removeExtension(t);let a=G.replaceSpecialCharacters(n);const i=new e._QosMonitor("FilePicker.UploadItem.GetPageName");if(a)i.writeSuccess();else{const e=this._pageContext.listItem&&this._pageContext.listItem.id||"fastPageCreation";i.writeUnexpectedFailure("EmptyPageName",void 0,{pathNameTrimmedLen:t.length,isPathNameEndWithSlash:("/"===t[t.length-1]).toString(),isPageTitleEmpty:(!n.trim()).toString(),pageId:e.toString()}),a=e.toString()}return a}removeExtension(e){const t=e.lastIndexOf("/"),n=-1===t?e:e.substring(t+1),a=n.lastIndexOf(".");return-1===a?n:n.substring(0,a)}getFallbackSharingLink(t,n){const a=new e._QosMonitor(`${this._qosPrefix}.GetFallbackSharingLink`),i=this._pageContext?.web?.absoluteUrl;if(void 0===i)return Promise.resolve(void 0);const r=i+`/_api/web/Lists(@a1)/GetItemByUniqueId(@a2)/ShareLink?@a1='${t}'&@a2='${n}'`,o=B();o.append("Prefer","DirectUrlWithShareToken"),t&&N(t.slice(1,-1))&&o.append("X-SP-REQUESTRESOURCES",`WEBPROPERTIES, list=${t.slice(1,-1)}`);const s=j();return this._httpClient.post(r,_.SPHttpClient.configurations.v1,{headers:o,body:s}).then(e=>e.json()).then(e=>{if(e&&e.sharingLinkInfo)return a.writeSuccess(),e.sharingLinkInfo.Url??void 0;{const t=e["odata.error"];if(t){const e={odataErrorCode:t.code,odataErrorMessage:t.message?.value||""};d._SPKillSwitch.isActivated("2cffa4af-4d43-4d94-9e3e-560d399b9528")?a.writeUnexpectedFailure("ErrorResponse",void 0,e):!0===String(t.code).startsWith("-4,")?a.writeUnexpectedFailure("InvalidOperation",void 0,e):!0===String(t.code).startsWith("-2147024891,")?a.writeExpectedFailure("UnauthorizedAccess",void 0,e):a.writeUnexpectedFailure("ErrorResponse",void 0,e)}else a.writeUnexpectedFailure("EmptyResponse");return}}).catch(e=>{a.writeUnexpectedFailure("RuntimeError")})}_uploadCore(e,t){const n=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"",a=B(),i=b.Uri.concatenate(n,e);return this._uploadCoreWithRetry(i,a,t,0)}_uploadCoreWithRetry(t,n,a,i){return this._httpClient.post(t,_.SPHttpClient.configurations.v1,{headers:n,body:a}).catch(r=>{if(d._SPKillSwitch.isActivated("556c57d4-5db7-434e-ba21-1c984f1af04a"))throw r;if(i<2){const o=i+1;return e._TraceLogger.logVerbose(G._logSource,`Upload failed on attempt ${o}, retrying in 100ms. Error: ${r?.message||r}`),new Promise((e,i)=>{setTimeout(()=>{this._uploadCoreWithRetry(t,n,a,o).then(e).catch(i)},100)})}throw e._TraceLogger.logError(G._logSource,r,"Upload failed after 3 attempts"),r})}_uploadLocalFile(t,n,a,i=!1,r,o=!1,s){const c=t instanceof File?w()?t.name:G.replaceSpecialCharacters(t.name):void 0,l=w()?n||c:G.replaceSpecialCharacters(n||c),u=!d._SPKillSwitch.isActivated("24ae812f-4669-4754-920f-322c88338efb")&&t instanceof File?t.size:void 0,f=new e._QosMonitor(`${this._qosPrefix}.UploadLocalFile`);let p;G._isPageAssetFolderBindingEnabled()&&!i&&(p=r||this._pageContext.listItem?.id);const m=this._getEndPoint(l,p,void 0,a,u,void 0,s);let _,h,b;return this._uploadCore(m,t).then(e=>(_=e.correlationId,h=E()?void 0:e.status,e.json())).then(t=>{if(b=t["odata.error"],!b){const n=k(t);return z()&&o?this.getFallbackSharingLink(n.listId,n.uniqueId).then(t=>(d._SPKillSwitch.isActivated("e297bb41-04b5-4bc8-b0f1-a3bd2928eecd")||t||O.e(716).then(O.bind(O,495)).then(({DialogUtility:e})=>e).then(e=>{e.showCommonError({title:S.EM,subText:S.HN,actionType:"CLOSE_ACTION",confirmActionLabel:S.BY})}).catch(t=>{e._TraceLogger.logError(G._logSource,t,"GetFallbackSharingLinkErrorDialog")}),n.fallbackShareLink=t,f.writeSuccess(),n)):(f.writeSuccess(),n)}A(b,f,_,l,h)}).catch(e=>{throw!E()&&b||f.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)}),new y(S.wk)})}_uploadExternalFile(t,n,a){const i=this._getEndPoint(n,G._isPageAssetFolderBindingEnabled()?this._pageContext.listItem?.id:void 0,t,void 0,void 0,a),r=new e._QosMonitor(`${this._qosPrefix}.UploadExternalFile`);let o,s,c;return this._uploadCore(i,void 0).then(e=>(o=e.correlationId,s=E()?void 0:e.status,e.json())).then(e=>{const t=e["odata.error"];if(t)throw c={odataErrorCode:t.code,odataErrorMessage:t.message&&t.message.value,correlationId:o?o.toString():void 0,statusCode:s},E()&&r.writeUnexpectedFailure("UncategorizedError",void 0,c),new y(S.wk,t.code);return r.writeSuccess(),k(e)}).catch(e=>{if(E())r.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e),statusCode:s});else if(c){if(s&&(0,m.isExpectedClientError)(s))throw r.writeExpectedFailure("UploadExternalFileError",e,c),new y(S.Ah,s);r.writeUnexpectedFailure("UncategorizedError",void 0,c)}else r.writeUnexpectedFailure("RuntimeError",e,{errorDetails:JSON.stringify(e)});throw new y(S.wk)})}_getEndPoint(e,t,n,a,i,r,o){e=encodeURIComponent(e);const s="$select=ListId,ServerRelativeUrl,Title,UniqueId",c=G._isPageAssetFolderBindingEnabled()&&void 0!==t?`&pageId=${t}`:"",l=i?`&fileSize=${i}`:"",u=!d._SPKillSwitch.isActivated("2c13258a-b9a6-4704-9781-6ccbc4a8d830")&&!d._SPKillSwitch.isActivated("6b3c97ae-c33a-4c1e-9b88-5dc1e87ab20f")&&d._SPFlight.isEnabled(62479)&&o?`&${L("gettyId",encodeURIComponent(o))}`:"";if(this._containerUrl){const t=encodeURIComponent(this._containerUrl);return"/_api/web/GetFolderByServerRelativeUrl("+d.UrlUtilities.convertToODataStringLiteral(t)+")/Files/Add(url="+d.UrlUtilities.convertToODataStringLiteral(e)+`, overwrite=false)?${s}`}return n?"/_api/sitepages/AddImageFromExternalUrl?"+this._createSitePageEndpoint(e,a,r)+"&"+L("externalUrl",n,r)+`${c}&${s}`:"/_api/sitepages/AddImage?"+this._createSitePageEndpoint(e,a)+`${c}${l}${u}&${s}`}_getOrCreateAssetFolderApiPostUrl(){const e=this.getPageName(G.pagePathName),t=G._isPageAssetFolderBindingEnabled()?this._pageContext.listItem?.id:void 0,n=G._isPageAssetFolderBindingEnabled()&&void 0!==t?`&pageId=${t}`:"",a="/_api/sitepages/GetOrCreateAssetFolder?"+L("pageName",e)+n+"&createFolderIfNeeded=true",i=this._pageContext&&this._pageContext.web&&this._pageContext.web.absoluteUrl||"";return b.Uri.concatenate(i,a)}_createSitePageEndpoint(e,t,n){const a=t||this.getPageName(G.pagePathName);return L("imageFileName",e)+"&"+L("pageName",a,n)}_getUniqueCopyFileName(e,t,n,a){let i;try{i=n&&n.length>0?n:G.getFileNameFromUrl(e)}catch(e){i=t}z()&&a&&G.validateFileType(e,m.spConstants.videoExtensions)||(i=`copy-(1)-${i}`);const r=Math.floor(1e5+9e5*Math.random()),o=m.ExtensionHelper.getExtension(i);return i=i.replace(RegExp(`.${o}`,"i"),`-${r}.${o}`),i}constructor(e){this._ensureMoveCopyDataSource=()=>(this._moveCopyDataSource||(this._moveCopyDataSource=Promise.all([Promise.all([O.e(777),O.e(220)]).then(O.bind(O,543))]).then(([e])=>new e.MoveCopyAsyncDataSource({},{dataRequestor:new g.DataRequestor({qosName:"SPFileMoveCopyAsync"},{pageContext:this._pageContext.legacyPageContext,tokenProvider:this._getMoveDataSourceTokenProvider()})}))),this._moveCopyDataSource),this._getMoveDataSourceTokenProvider=()=>({getAuthToken:e=>v._AadTokenProviders.configurable._getTokenInternal(new b.Uri(e.url).getLeftPart(b.UriPartial.authority),v._AadTokenProviders.preAuthorizedConfiguration).then(e=>({authToken:e}))}),e.serviceScope.whenFinished(()=>{this._httpClient=e.serviceScope.consume(_.SPHttpClient.serviceKey),this._pageContext=e.serviceScope.consume(h.PageContext.serviceKey),this._pageService=e.serviceScope.consume((0,m.getPageServiceServiceKey)())}),this._qosPrefix=e.qosPrefix,this._containerUrl=e.containerUrl,G._isDisableSitePagesStrongBinding=e.isDisableSitePagesStrongBinding}}G._logSource=e._LogSource.create("PublishingWebPartSPFileHandler");var K=O(141),W=O(519),q=O(424);q.loadStyles('.l_avLp1_0Bfl_{background-position:50%;background-repeat:no-repeat;background-size:cover;height:100%;margin:0 auto;width:100%;z-index:0}.l_avLp1_0Bfl_:before{background-color:"[theme:blackTranslucent40, default: rgba(0,0,0,.4)]";bottom:0;content:"";display:block;height:100%;left:0;position:absolute;right:0;top:0;width:100%}.l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{color:#fff;padding:10px;position:absolute;text-align:center;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{left:50%}[dir=rtl] .l_avLp1_0Bfl_ .u_6uRlC_0Bfl_{right:50%}.l_avLp1_0Bfl_ .u_6uRlC_0Bfl_ .u_yCpwh_0Bfl_{animation:s_oDC_X_0Bfl_ 2s linear infinite;display:block;font-size:48px;margin:8px 0}@keyframes s_oDC_X_0Bfl_{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.l_avLp1_0Bfl_ .i_Zb_gN_0Bfl_{max-height:100%;max-width:100%;opacity:.5;position:relative;visibility:hidden}.l_avLp1_0Bfl_ .u_bqLjO_0Bfl_{color:"[theme:white, default: #ffffff]";font-size:21px;font-weight:100;font-weight:300}.l_avLp1_0Bfl_ img{display:block;margin:0 auto;max-width:100%}.l_avLp1_0Bfl_ img:not([src]){display:none}',!0);const Q=JSON.parse('{"zV":"We\\u0027re still uploading your image. It may get lost if you leave this page.","l":"Preview image that shows while an image is uploading.","Hg":"This doesn\\u0027t seem like a supported image file. Please select a different image."}');class Y extends K.BaseComponent{UNSAFE_componentWillMount(){const{externalFile:e,imageUrl:t,localFile:n,pageContext:a}=this.props;e?this._startUpload(e):t&&m.UrlUtility.isValidURL(t)&&!m.UrlUtility.isVanityUrl(t,a)?this._startUploadFromExternalUrl(t):n&&this._startUpload(n)}componentDidMount(){this._setStateForLocalFile()}componentWillUnmount(){this._rejectPromise&&(this._rejectPromise(),this._rejectPromise=void 0)}render(){const e=a.createElement("img",{className:"i_Zb_gN_0Bfl_",alt:Q.l,src:this.state.imageDataString,ref:this._resolveRef("_imagePreview"),onLoad:this._handleImageLoad});return a.createElement("div",{className:"l_avLp1_0Bfl_",ref:this._resolveRef("_root"),"data-automation-id":"localFilePreview"},this.state.imageDataString&&e,a.createElement("div",{className:"u_6uRlC_0Bfl_"},a.createElement(K.Icon,{iconName:"Sync",className:"u_yCpwh_0Bfl_"}),a.createElement("span",{className:"u_bqLjO_0Bfl_","aria-live":"assertive","aria-atomic":!0},this.props.uploadingMessage)))}_setStateForLocalFile(){this.props.localFile?new Promise((e,t)=>{this._rejectPromise=t,e(this._spFileHandler.readFile(this.props.localFile))}).then(e=>{this.setState({imageDataString:e})}).catch(t=>{e._TraceLogger.logError(e._LogSource.create("LocalFilePreview"),t,"ReadLocalFile")}):this.props.externalFile&&this.setState({imageDataString:this.props.externalFile.src})}_promptUploadingWarning(e){const t=Q.zV;return e.returnValue=t,t}constructor(e){super(e),this._isImageFlipped=!1,this._handleImageLoad=e=>{u(e.target,()=>{this._isImageFlipped=!0})},this._startUpload=e=>{const t=new W._QosMonitor(this.props.QosTag);try{let n="";const a=this._getPrefix(),i="src"in e;if(e instanceof File&&G.validateFileType(e,m.spConstants.imageExtensions))n=`${a}-${G.replaceSpecialCharacters(e.name)}`;else if(e instanceof Blob&&this._spFileHandler.validateMimeType(e,m.spConstants.imageExtensions))n=`${a}.${e.type.split("/").pop()}`;else{if(!i||!G.validateFileType(e.src,m.spConstants.imageExtensions))return this._onUploadError(new Error(Q.Hg)),void t.writeExpectedFailure("InvalidFileType");e=e,n=`${a}-${G.replaceSpecialCharacters(e.name)}`}window.addEventListener("beforeunload",this._promptUploadingWarning),(e instanceof File||e instanceof Blob?this._spFileHandler.uploadLocalFile(e,n):this._spFileHandler.uploadExternalFile(e.src,n)).then(n=>{this._onUploadComplete(n,e instanceof File?e.name:void 0),t.writeSuccess()}).catch(e=>{t.writeUnexpectedFailure("UploadPromise",e),this._onUploadError(e)})}catch(e){t.writeUnexpectedFailure("CatchAll",e),this._onUploadError(e)}},this._startUploadFromExternalUrl=e=>{const t=new W._QosMonitor(this.props.QosTag);try{const n=e.lastIndexOf("/"),a=e.substring(n+1),i=this._getPrefix()+G.replaceSpecialCharacters(a);window.addEventListener("beforeunload",this._promptUploadingWarning),this._spFileHandler.uploadExternalFile(e,i).then(e=>{this._onUploadComplete(e,i),t.writeSuccess()}).catch(e=>{this.props.localFile?this._startUpload(this.props.localFile):(t.writeUnexpectedFailure("UploadPromise",e),this._onUploadError(e))})}catch(e){t.writeUnexpectedFailure("CatchAll",e),this._onUploadError(e)}},this._onUploadComplete=(e,t)=>{if(window.removeEventListener("beforeunload",this._promptUploadingWarning),this._imagePreview&&this._imagePreview.naturalHeight&&this._imagePreview.naturalWidth){const n=this._isImageFlipped?this._imagePreview.naturalHeight:this._imagePreview.naturalWidth,a=this._isImageFlipped?this._imagePreview.naturalWidth:this._imagePreview.naturalHeight;this.props.onUploadComplete(e,t,n,a)}else this.props.onUploadComplete(e,t)},this._onUploadError=e=>{window.removeEventListener("beforeunload",this._promptUploadingWarning),this.props.onUploadError&&this.props.onUploadError(e,this.props.externalFile?this.props.externalFile.src:void 0)},this._getPrefix=()=>Math.floor(4294967296*Math.random()).toString(),this._spFileHandler=new G({serviceScope:e.serviceScope,qosPrefix:e.QosTag}),this.state={imageDataString:void 0}}}class J{get defaultDocumentLibrary(){const e=b.Uri.concatenate(this._webAbsoluteUrl,"_api/web/DefaultDocumentLibrary?$expand=RootFolder");return this._spHttpClient.get(e,_.SPHttpClient.configurations.v1).then(e=>e.json())}get siteContext(){return this._siteContext?Promise.resolve(this._siteContext):this._getContainingFolderSiteContext().then(e=>(this._siteContext=e,e))}_getContainingFolderSiteContext(){const e={webAbsoluteUrl:this._webAbsoluteUrl,libraryName:"",defaultLibraryId:"",pickerDomain:window.location.protocol+"//"+window.location.hostname,siteId:this._siteId,webId:this._webId},t=new W._QosMonitor("GetWebDefaultLibrary");return this.defaultDocumentLibrary.then(n=>{if(n.error)throw new Error(n.error.code);return e.libraryName=n.RootFolder.Name,e.defaultLibraryId=n.Id,t.writeSuccess(),e}).catch(n=>{if(n.message.indexOf("-2146232832")>=0?t.writeExpectedFailure("ListDeleted"):t.writeUnexpectedFailure(void 0,n),this._errorCallback)return this._errorCallback(e),e;throw n})}constructor(e,t,n){let a;e.whenFinished(()=>{this._spHttpClient=e.consume(_.SPHttpClient.serviceKey),a=e.consume(h.PageContext.serviceKey)}),!d._SPKillSwitch.isActivated("2097ba85-7386-407a-b0e8-a92e4f1f4053")&&n?(this._webAbsoluteUrl=n.webAbsoluteUrl||"",this._webId=n.webId,this._siteId=n.siteId):(a?.web?(this._webAbsoluteUrl=a.web.absoluteUrl,this._webId=a.web.id&&a.web.id.toString()||""):this._webAbsoluteUrl=this._webId="",this._siteId=a?.site?.id?.toString()||""),this._errorCallback=t}}const X=a.lazy(()=>O.e(769).then(O.bind(O,159)).then(({Dialog:e})=>({default:e})));function Z({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement(X,t))}const $=a.lazy(()=>O.e(769).then(O.bind(O,159)).then(({DialogFooter:e})=>({default:e})));function ee({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement($,t))}const te=a.lazy(()=>O.e(769).then(O.bind(O,159)).then(({DialogContent:e})=>({default:e})));function ne({fallback:e=a.createElement(a.Fragment,null),...t}){return a.createElement(a.Suspense,{fallback:e},a.createElement(te,t))}var ae=O(907),ie=O(642),re=O(877);const oe={Image:1,FabricReactIcon:2,AutoSelect:3},se=JSON.parse('{"eu":"Alternate text field for thumbnail image","rZ":"Thumbnail","Wi":"Auto-selected","dt":"Custom image","uH":"Library","N6":"Uploading...","X4":"0||1||2-","O_":"{0} characters||{0} character||{0} characters","Mg":"{0} limit - exceeded by {1}","Wk":"{0} limit - {1} left","TS":"{0} character"}');class ce extends a.PureComponent{static getTextFieldGroup(e,t){return(0,ie.PropertyPaneCustomField)({key:e,onRender:(n,i,r)=>{const o=a.createElement(ce,{key:e,onChange:r,...t});ae.render(o,n)},onDispose:e=>{i.unmountComponentAtNode(e)}})}static _getLocalizedCount(e){return b.StringHelper.formatWithLocalizedCountValue(se.O_,se.X4,e)}render(){return a.createElement(m.LimitedLengthTextField,{label:this.props.label,multiline:this.props.multiline,value:this.state.value,defaultValue:this.state.value,onChanged:this._onValidChange,maxLength:this.props.maxCharacters,getLimitedLengthMessage:this._getLimitedLengthMessage})}constructor(e){super(e),this._onValidChange=e=>{this._handleGetErrorMessage(e||"")||(d._SPKillSwitch.isActivated("3ffa6b5d-b309-4f16-a93d-86d9e47d73cb")?this.props.onChange?.(e):this.props.onChange?.(this.props.label,e),this.props.onValidChange&&this.props.onValidChange(e||""))},this._handleGetErrorMessage=e=>{if(!e||e.length<=this.props.maxCharacters)return"";{const t=ce._getLocalizedCount(this.props.maxCharacters),n=ce._getLocalizedCount(e.length-this.props.maxCharacters);return b.StringHelper.format(se.Mg,t,n)}},this._getLimitedLengthMessage=e=>e>=0?b.StringHelper.format(se.Wk,b.StringHelper.format(se.TS,this.props.maxCharacters),ce._getLocalizedCount(e)):"",this.state={value:e.initialValue||""}}}var de=O(464),le=O(592);class ue extends a.PureComponent{render(){const e=this._content;let t;return!d._SPKillSwitch.isActivated("d3e7d14b-3886-4b5c-9b1b-d1ba5675074d")&&this.props.thumbnail?.type===re.ThumbnailType.FabricReactIcon&&this.props.thumbnail?.iconColor&&(t=this.props.thumbnail?.iconColor),!!e&&a.createElement("div",{role:"img",className:this.props.className,"aria-label":this.props.thumbnail?.altText,style:t?{fill:t}:void 0},e)}get _content(){if(this.props.onRenderThumbnail)return this.props.onRenderThumbnail();const t=this.props.thumbnail;if(t)switch(t.type){case re.ThumbnailType.FabricReactIcon:return a.createElement(K.Icon,{iconName:t.iconName,style:t.iconColor?{color:t.iconColor}:void 0,role:"presentation",className:this.props.iconClassName});case re.ThumbnailType.IconSizeImage:const n={className:this.props.iconClassName,imageFit:K.ImageFit.cover,src:t.iconUrl,role:"presentation",alt:t.altText};return a.createElement(K.Icon,{iconType:K.IconType.image,style:t.iconColor?{color:t.iconColor}:void 0,imageProps:n,className:this.props.iconClassName});case re.ThumbnailType.Image:const i={imageFit:void 0!==t.imageFit?t.imageFit:K.ImageFit.cover,src:this.state.isRenderBackup&&t.backupImageUrl?t.backupImageUrl:t.imageUrl,alt:t.altText,title:t.altText?t.altText:void 0,role:t.altText?void 0:"presentation",className:this.props.iconClassName,onLoadingStateChange:this._handleImageLoadingStateChange};return i.styles={image:{width:"100%",height:"100%",...!d._SPKillSwitch.isActivated("4b38f545-e45d-4349-b675-a4857fea13d6")&&(0,m.shouldDisableImageContextMenu)(t.contentProvider)?{pointerEvents:"none"}:{}}},x()||(this._imageMonitor=new e._QosMonitor(`${this.props.qosPrefix}.ImageLoad`)),a.createElement(K.Icon,{iconType:K.IconType.image,imageProps:i,className:this.props.iconClassName});default:return}}_handleImageLoadingStateChange(e){!x()&&this._imageMonitor&&(e===K.ImageLoadState.loaded?this._imageMonitor.writeSuccess():e===K.ImageLoadState.error&&this._imageMonitor.writeUnexpectedFailure("ImageLoadError",void 0,{isRenderBackup:this.state.isRenderBackup})),this.setState(t=>{if(e===K.ImageLoadState.error&&!t.isRenderBackup)return{isRenderBackup:!0}})}constructor(e){super(e),this.state={isRenderBackup:!1}}}(0,le._ts_decorate)([K.autobind],ue.prototype,"_handleImageLoadingStateChange",null),q.loadStyles('.t_0SXmv_0Bfl_{position:relative}.t_0SXmv_0Bfl_.s_GoqL-_0Bfl_{background-color:"[theme:neutralLight, default: #edebe9]"}.f_dX8no_0Bfl_{padding-bottom:56.25%;width:100%}.s_8cg_5_0Bfl_{height:100px;width:100px}.t_BoMJ__0Bfl_{align-items:center;bottom:0;display:flex;justify-content:center;left:0;overflow:hidden;position:absolute;right:0;top:0}.t_BoMJ__0Bfl_.t_KSbPj_0Bfl_{font-size:64px;line-height:100%;text-align:center}.t_BoMJ__0Bfl_.t_YJ-r0_0Bfl_ .i_gsLLm_0Bfl_{height:100%;width:100%}.t_BoMJ__0Bfl_.t_PM1V4_0Bfl_ .i_gsLLm_0Bfl_{height:64px;width:64px}.s_vqc3q_0Bfl_{left:50%;margin:0;position:absolute;top:50%;transform:translate(-50%,-50%)}',!0);class fe extends a.PureComponent{render(){const e=(0,K.css)(this.props.wrapperClassName,"t_0SXmv_0Bfl_",this.props.previewFullWidth?"f_dX8no_0Bfl_":"s_8cg_5_0Bfl_",{"s_GoqL-_0Bfl_":this.props.previewGrayBackground}),t=(0,K.css)("t_BoMJ__0Bfl_",{t_KSbPj_0Bfl_:this.props.thumbnail?.type===re.ThumbnailType.FabricReactIcon,t_PM1V4_0Bfl_:this.props.thumbnail?.type===re.ThumbnailType.IconSizeImage,"t_YJ-r0_0Bfl_":this.props.thumbnail?.type===re.ThumbnailType.Image});return this.props.showLoading?a.createElement("div",{className:e},a.createElement(de.Spinner,{className:"s_vqc3q_0Bfl_",type:K.SpinnerType.large,label:se.N6})):a.createElement("div",{className:e},a.createElement(ue,{thumbnail:this.props.thumbnail,className:t,iconClassName:(0,K.css)(this.props.iconClassName,"i_gsLLm_0Bfl_"),qosPrefix:this.props.qosPrefix,onRenderThumbnail:this.props.onRenderThumbnail}))}}class pe extends a.PureComponent{render(){return d._SPKillSwitch.isActivated("31582809-6161-4521-87df-a8eb72575445")||!this.props.thumbnail||this.props.thumbnail.altText||(this.props.thumbnail.altText=this.props.customSelectedIconName?this.props.customSelectedIconName.split("_").join(" "):"Custom Selected Thumbnail"),this._shouldShowThumbnailRenderer()?a.createElement(fe,{thumbnail:this.props.thumbnail,previewFullWidth:this.props.previewFullWidth,previewGrayBackground:this.props.previewGrayBackground,wrapperClassName:this.props.thumbnailRendererWrapperClassName,iconClassName:this.props.thumbnailRendererIconClassName,qosPrefix:this.props.qosPrefix,onRenderThumbnail:this._isCustomIconPresent?this._renderCustomIcon:void 0}):null}get _isCustomIconPresent(){return Boolean(this.props.customIconSet&&this.props.customSelectedIconName)}constructor(...e){super(...e),this._shouldShowThumbnailRenderer=()=>d._SPKillSwitch.isActivated("e8f99b98-01b3-40b3-93ba-3e3cf9070b88")?Boolean(this.props.thumbnail&&(this.props.thumbnail.iconName||this.props.thumbnail.imageUrl||this.props.thumbnail.backupImageUrl)):Boolean(this.props.thumbnail&&(this.props.thumbnail.iconName||this.props.thumbnail.imageUrl||this.props.thumbnail.backupImageUrl))||this._isCustomIconPresent,this._renderCustomIcon=()=>this.props.customIconSet.get(this.props.customSelectedIconName)}}function me(e,t,n){return ce.getTextFieldGroup(n,{label:se.eu,initialValue:t,multiline:!1,maxCharacters:255,onValidChange:e})}function _e(e,t,n,i,r,o,s,c){const l=[],u=[];switch(r.autoSelectOptions.enabled&&u.push({key:oe.AutoSelect,disabled:r.disabled&&!C(),text:r.autoSelectOptions.optionLabel||se.Wi,checked:i===oe.AutoSelect}),r.imageOptions.enabled&&u.push({key:oe.Image,disabled:r.disabled&&!C(),text:r.imageOptions.optionLabel||se.dt,checked:i===oe.Image}),r.iconOptions.enabled&&u.push({key:oe.FabricReactIcon,disabled:r.disabled&&!C(),text:r.iconOptions.optionLabel||se.uH,checked:i===oe.FabricReactIcon}),l.push(d._SPKillSwitch.isActivated("b10afe46-4928-4f93-827c-bde0a05c5a03")||!d._SPFlight.isEnabled(61281)||d._SPKillSwitch.isActivated("644abf6e-1c40-467b-ab0c-e79f003b039d")||u.length>1?(0,ie.PropertyPaneChoiceGroup)(t,{options:u,label:s?.pickerLabelOverride||se.rZ}):(0,re.PropertyPaneLabel)(t,{text:s?.pickerLabelOverride||se.rZ})),i){case oe.Image:l.push(function(e,t,n,a,i,r,o,s){return(0,re.PropertyPaneThumbnailPicker)("imagePicker",{serviceScope:t,onItemChanged:a,thumbnail:n.thumbnailInfo,callerName:e,previewFullWidth:i?.previewFullWidth,previewGrayBackground:i?.previewGrayBackground,thumbnailRendererWrapperClassName:i?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:i?.thumbnailRendererIconClassName,onItemDeleted:n.itemDeleteCallback,forceFullUrl:r,disabled:o,enableGettyStockAssets:s})}(e,n,r.imageOptions,r.imageChangeCallback,s,r.ensureImageFullUrl,r.disabled,r.enableGettyStockAssets)),o&&l.push(me(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case oe.AutoSelect:l.push(function(e,t,n,i,r){const o={thumbnail:e,previewFullWidth:t?.previewFullWidth,previewGrayBackground:t?.previewGrayBackground,thumbnailRendererWrapperClassName:t?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:t?.thumbnailRendererIconClassName,qosPrefix:n,customIconSet:i,customSelectedIconName:r},s=a.createElement(pe,o);return(0,ie.PropertyPaneCustomField)({key:"imagePicker",onRender:e=>{ae.render(s,e)}})}(r.autoSelectOptions.thumbnailInfo,s,e,r.customIconSet,r.customSelectedIconName)),o&&l.push(me(o.altTextChangeCallback,o.currentAltText,o.altTextFieldKey));break;case oe.FabricReactIcon:l.push(function(e,t,n,a,i,r,o,s){return(0,re.PropertyPaneIconPicker)("iconPicker",{thumbnail:t.thumbnailInfo,onItemChanged:e,previewFullWidth:n?.previewFullWidth,previewGrayBackground:n?.previewGrayBackground,thumbnailRendererWrapperClassName:n?.thumbnailRendererWrapperClassName,thumbnailRendererIconClassName:n?.thumbnailRendererIconClassName,callerName:a,customIconSet:i,customSelectedIconName:r,onItemDeleted:t.itemDeleteCallback,_extendedIcons:o,disabled:s})}(r.iconChangeCallback,r.iconOptions,s,e,r.customIconSet,r.customSelectedIconName,r.extendedIcons,r.disabled))}return l}const he=["airplane_take_off","alert","alert_urgent","approvals_app","apps","apps_add_in","archive","attach","backpack","balloon","beach","bed","block","board","bookmark","bug","building","building_bank","building_shop","building_skyscraper","calendar_checkmark","calendar_clock","calendar_edit","calendar_question_mark","calendar_reply","calendar_sync","calendar_work_week","call","camera","cart","channel","channel_add","channel_alert","channel_share","chat","city","clipboard","clipboard_paste","clock","cloud_download","comment_mention","comment_multiple","communication","compass_northwest","compose","conference_room","contact_card_group","copy","cube","currency_dollar_euro","dentist","desktop","desktop_mac","doctor","document","document_add","document_catch_up","document_question_mark","drafts","drink_beer","drink_coffee","dumbbell","emoji","emoji_add","error_circle","filter","flag","flag_off","flash","flash_checkmark","glasses","globe","grid","guest","hat_graduation","headset","heart","highlight","home","home_checkmark","image","image_edit","important","info","inking_tool","inprivate_account","key","laptop","leaf_two","library","lightbulb","link","location","location_off","lock_closed","mail","mail_inbox","map_drive","math_formula","meet_now","megaphone","mic_off","mic_on","mic_prohibited","money","movies_and_tv","music_note_2","my_location","options","page_fit","paint_brush","paint_bucket","payment","people","people_add","people_call","people_community","people_search","people_team","person","person_add","person_available","person_call","person_clock","person_mail","person_prohibited","person_question_mark","person_support","premium","reading_list","record","remote","reward","ribbon","rocket","ruler","run","savings","search","send","settings","shield","shifts","slide_text","snooze","speaker_0","speaker_1","sport","star","stop","store_microsoft","sync_off","table","table_simple","tab","tag","target","tasks","tent","tetris_app","thumb_like","timer","trophy","tv","vault","vehicle_bicycle","vehicle_bus","vehicle_cab","vehicle_car","vehicle_subway","video","video_person","voicemail","warning","weather_moon","weather_moon_off"];function be(e){return O.e(112).then(O.bind(O,26)).then(t=>t.supportedIconMap.get(e))}var ge=O(485),ve=O(94),ye=O(575);q.loadStyles(".c_5mgSV_0Bfl_{display:inline-flex}",!0);const Se=JSON.parse('{"Gy":"Enable audience targeting","kl":"Enable audience targeting to promote content to specific audiences across the site.","Hi":"Enable audience targeting to show or hide content within this webpart. To show or hide the entire web part, go to the audience targeting section.","_A":"Press enter to learn more.","$$":"{0} {1}","s1":"On","KX":"Off","dX":"Enabled audience targeting.","IF":"Disabled audience targeting."}');function De(e,t){const n=class{static isWebPartAudienceTargetingEnabled(){return d._SPFlight.isEnabled(60668)}}.isWebPartAudienceTargetingEnabled()?Se.Hi:Se.kl,i=b.StringHelper.format(Se.$$,n,Se._A),r=t.labelText||Se.Gy,o=a.createElement("div",{className:"c_5mgSV_0Bfl_"},a.createElement(ge.Label,{"aria-label":r},r),a.createElement(ve.TooltipHost,{content:n},a.createElement(ye.IconButton,{"aria-label":i,iconProps:{iconName:"info"},href:t.infoLink,target:"_blank"}))),s=d._SPKillSwitch.isActivated("f8859d52-a5fb-46d1-94be-0babc89a0c19");return(0,re.PropertyPaneToggle)(e,{key:e,_label:o,onText:Se.s1,offText:Se.KX,ariaLabel:s?void 0:r,onAriaLabel:s?Se.dX:void 0,offAriaLabel:s?Se.IF:void 0,dataAutomationId:t.dataAutomationId})}var Ie;!function(e){e.PeopleWebpart="PeopleWebpart",e.EditorialCardWebpart="EditorialCardWebpart",e.QuickLinksWebpart="QuickLinksWebpart",e.EventsWebpart="EventsWebpart",e.ContentRollupWebpart="ContentRollupWebpart"}(Ie||(Ie={}));var xe=O(944);const Ce=JSON.parse('{"k":"Link"}');class Oe extends a.PureComponent{render(){return a.createElement(xe.TextField,{value:this.state.textValue,placeholder:this.props.prefix?"":"https://",onChange:this._onChange,label:this.props.label||Ce.k,prefix:this.props.prefix,disabled:this.props.disabled})}constructor(e){super(e),this._onChange=(e,t)=>{if(this.props.enforceHttps){const e=this._ensureProtocol(t)??"https://";this.setState({textValue:e}),this.props.onUrlUpdated(e)}else this.props.disableProtocolCheck?(this.props.onUrlUpdated(t),this.setState({textValue:t})):(this._ensureProtocolDebounced(t),this.setState({textValue:t}))},this._ensureProtocol=e=>{if(e){if(this.props.enforceHttps)return m.UrlUtility.ensureSchema(e,["https"]);{const t=new b.Uri(e).getScheme()?e:this.props.prefix?`${e}`:`https://${e}`;this.props.onUrlUpdated(t),this.setState({textValue:t})}}},this._ensureProtocolDebounced=(new K.Async).debounce(this._ensureProtocol,1e3),this.state={textValue:e.initialUrl}}}})(),M})())})();