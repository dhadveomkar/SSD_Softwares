define("e9ca96c8-1783-446d-aff0-ba323343576d_0.1.0",["@microsoft/sp-diagnostics","@msinternal/sp-image-shared","@microsoft/sp-image-helper","@msinternal/sp-component-utilities","@microsoft/sp-core-library","@ms/office-ui-fabric-react-bundle"],(e,t,n,a,i,r)=>(()=>{"use strict";var o={676:e=>{e.exports=i},207:t=>{t.exports=e},949:e=>{e.exports=n},141:e=>{e.exports=r},718:e=>{e.exports=a},285:e=>{e.exports=t}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{var e;c.r(d),c.d(d,{CheckName:()=>e,applyOverlayColorToImage:()=>S,checkA11yForRte:()=>Q,checkAltText:()=>a,getAltTextCheckResult:()=>i,getColor:()=>q,getHeadingLevel:()=>r,getImageElementFromURL:()=>R,hexToRgba:()=>y,hexToUint8ClampedArray:()=>b,imageBackgroundColorContrastCheck:()=>h,imageOverlayTextColorContrastCheck:()=>v,imageOverlayTextColorContrastCheckV2:()=>H,isEnabledWebpart:()=>J,isHighContrastMode:()=>I,isInstanceDismissed:()=>s,loadImageToCanvas:()=>g,runSafeCheck:()=>o}),function(e){e[e.HeadingOrder=0]="HeadingOrder",e[e.EmptyLink=1]="EmptyLink",e[e.MissingTableHeader=2]="MissingTableHeader",e[e.AltText=3]="AltText",e[e.ColorContrast=4]="ColorContrast"}(e||(e={}));var t=c(207);const n=t._LogSource.create("AccessibilityCheckerUtil");function a(e,t){return!!(e||t&&""!==t?.trim())}function i(t,n,i,r,o){let s;return t.forEach((t,c)=>{o&&!o(t)||(void 0===s&&(s={checkName:e.AltText,displayText:n,isSuccess:!0,extraData:[]}),a(r(t),i(t))||(s.isSuccess=!1,s.extraData||(s.extraData=[]),s.extraData.push(c)))}),s}function r(e){switch(e.toUpperCase()){case"H1":return 1;case"H2":return 2;case"H3":return 3;case"H4":return 4;default:return 0}}async function o(e){const a=new t._QosMonitor("AccessibilityAssistant.Scanner.PerCheck"),i={};try{const t=await e();return function(e){if(void 0!==e&&(null===e||"object"!=typeof e||"boolean"!=typeof e.isSuccess||"number"!=typeof e.checkName||"string"!=typeof e.displayText))throw new Error("Invalid check result")}(t),a.writeSuccess(),t}catch(e){return t._TraceLogger.logError(n,e),i.errorStack=e.stack,void a.writeUnexpectedFailure("FailedToScanA11yResultsForOneCheck",e,i)}}function s(e){return JSON.parse(window.sessionStorage.getItem("DismissedInstances")||"[]").includes(e)}var l=c(285),u=c(949),f=c(718),p=c(676);const m=[.2126,.7152,.0722],_=["p","a","h1","h2","h3","h4","h5","h6","span","pre","strong","u","s","sub","sup"];function h(e,t,n){const a=function(e){const t=[];for(let n=0;n<e.length;n+=4)t.push(new x(e.slice(n,n+3)));return t}(e);return function(e,t,n){const a=C(t),i=Math.ceil(.5*e.length),r=function(e,t){let n;return!t&&e<=.18333?n=4.5*(e+.05)-.05:t&&e<=.3&&(n=3*(e+.05)-.05),n}(a,n),o=function(e,t){let n;return!t&&e>=.175?n=(e+.05)/4.5-.05:t&&e>=.1&&(n=(e+.05)/3-.05),n}(a,n),s=r?e.filter(e=>e.lum>=r).length:0,c=o?e.filter(e=>e.lum<=o).length:0;return e.length-s-c<=i}(a,t,n)}function b(e){if(!/^#?([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/.test(e))throw new Error("Invalid hex color string");3===(e=e.replace(/^#/,"")).length&&(e=e.split("").map(e=>e+e).join(""));const t=parseInt(e,16);return new Uint8ClampedArray([t>>16&255,t>>8&255,255&t])}async function g(e){const t=p._SPKillSwitch.isActivated("7b82a18e-a3b8-47b6-b10f-c9c4e66ecf2a")?e:function(e){return f.DefaultImageHelper.isStockImage(e)?f.DefaultImageHelper.getDefaultImage(new u._SPResourcePath(e)):e}(e),n=await(0,l.loadImage)(t,"anonymous"),a=document.createElement("canvas");a.width=600,a.height=n.naturalHeight/n.naturalWidth*600;const i=a.getContext("2d");if(!i)throw new Error("canvas.getContext return null");return i.drawImage(n,0,0,a.width,a.height),i.globalCompositeOperation="source-over",Promise.resolve({canvas:a,ctx:i})}async function v(e,t,n,a,i,r,o,s){const{canvas:c,ctx:d}=await g(e);o&&s&&0!==s&&S(d,c,o,s),i&&r&&0!==r&&S(d,c,i,r);const l=h(d.getImageData(0,0,c.width,c.height).data,b(t),D(a,n));return Promise.resolve(l)}function y(e,t=1){return`rgba(${parseInt(e.substring(1,3),16)}, ${parseInt(e.substring(3,5),16)}, ${parseInt(e.substring(5,7),16)}, ${t})`}function S(e,t,n,a){e.globalCompositeOperation="source-over";const i=y(n,a);e.fillStyle=i,e.fillRect(0,0,t.width,t.height)}function D(e,t){return e>=24||t&&e>=18.5}function I(){return matchMedia("(forced-colors: active) or (-ms-high-contrast: active)").matches}class x{constructor(e){this.color=e,this.lum=C(this.color)}}function C(e){let t=0;for(let n=0;n<3;n++){let a=e[n]/255;a=a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4),t+=a*m[n]}return t}var O=c(141);const w=/#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})/,E=/^rgba?\(\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*(-?\d+)(?:\s*,\s*(-?\d+(\.\d+)?))?\s*\)$/;function A(e){const t=function(e){return e.replace(/^#([a-f\d])([a-f\d])([a-f\d])$/i,(e,t,n,a)=>`#${t}${t}${n}${n}${a}${a}`)}(e).match(w);if(t){const[,e,n,a]=t;return new Uint8ClampedArray([parseInt(e,16),parseInt(n,16),parseInt(a,16),255])}throw new Error("Invalid hex color: "+e)}function L(e){const t=e.match(E);if(t){const[,e,n,a,i="1"]=t;return new Uint8ClampedArray([U(parseInt(e,10),255,0),U(parseInt(n,10),255,0),U(parseInt(a,10),255,0),U(Math.round(255*parseFloat(i)),255,0)])}throw new Error(`Invalid rgba color: ${e}`)}function k(e){return"transparent"===e||!!e.match(/^rgba?\(\d+\s*,\s*\d+\s*,\s*\d+\s*,\s*(0(\.0+)?)\)$/)}const M=[.2126,.7152,.0722];function P(e){let t=0;for(let n=0;n<3;n++){let a=e[n]/255;a=a<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4),t+=a*M[n]}return t}function T(e,t){return e>t?(e+.05)/(t+.05):(t+.05)/(e+.05)}function U(e,t,n){return e<n?n:e>t?t:e}class F{getContext2D(){return this._context}drawColor(e,t){const n=this._context.globalAlpha;void 0!==t&&(this._context.globalAlpha=t),this._context.fillStyle=e,this._context.fillRect(0,0,this._canvas.width,this._canvas.height),this._context.globalAlpha=n}drawImage(e){this._context.drawImage(e,0,0,this._canvas.width,this._canvas.height)}getData(){return this._context.getImageData(0,0,this._canvas.width,this._canvas.height).data}getLumData(){return function(e){const t=[];for(let n=0;n<e.length;n+=4)t.push(P(e.slice(n,n+3)));return t}(this.getData())}constructor(e=300,t=300){this._canvas=document.createElement("canvas"),this._canvas.width=e,this._canvas.height=t;const n=this._canvas.getContext("2d");if(!n)throw new Error("Failed to get 2d context");this._context=n}}async function H(e,t,n,a,i,r,o,s,c){const d=await R(e),l=d.naturalHeight/d.naturalWidth*300,u=new F(300,l),f=(0,O.getTheme)().semanticColors.bodyBackground;if(u.drawColor(f),c){const e=N(c);k(e)||u.drawColor(e)}u.drawImage(d),o&&s&&0!==s&&u.drawColor(y(o,s)),i&&r&&0!==r&&u.drawColor(y(i,r));const p=u.getLumData(),m=A(t),_=D(a,n)?3:4.5;return await B(p,m,_)}async function R(e){var t;return await(0,l.loadImage)((t=e,f.DefaultImageHelper.isStockImage(t)?f.DefaultImageHelper.getDefaultImage(new u._SPResourcePath(t)):t),"anonymous")}function N(e){let t=e,n="rgba(0,0,0,0)";for(;t&&k(n);)n=window.getComputedStyle(t).backgroundColor,t="CanvasZone"===t.getAttribute("data-automation-id")?null:t.parentElement;return n}async function B(e,t,n){return(await async function(e,t){return Promise.resolve(function(e,t){return t.map(t=>{const n=U(t.minPassRate,1,0),a=Math.ceil(e.length*n);if(a<=0)return!0;const i=P(t.textColor),r=U(t.minContrast,21,1),o=(i+.05)/r-.05,s=(i+.05)*r-.05;return e.filter(e=>e<=o||e>=s).length>=a})}(e,t))}(e,[{textColor:t,minContrast:n,minPassRate:.5}]))[0]}const j=JSON.parse('{"kt":"Inconsistent heading order","GN":"Missing link description","jU":"Missing table header","G5":"Missing alt text","z9":"Hard-to-read text contrast"}');function V(t){const n=Array.from(t.querySelectorAll("h1, h2, h3, h4"));if(0===n.length)return;const a={checkName:e.HeadingOrder,displayText:j.kt,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1},i=r(n[0].tagName);return n.forEach((e,t)=>{const o=0===t?i:r(n[t-1].tagName),s=r(e.tagName);(s<i||Math.abs(s-o)>1)&&(a.isSuccess=!1,a.violatedNodes?.push(e))}),a}function z(t){const n=Array.from(t.querySelectorAll("a"));if(0===n.length)return;const a={checkName:e.EmptyLink,displayText:j.GN,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{""===e.text.trim()&&(a.isSuccess=!1,a.violatedNodes?.push(e))}),a}function G(t){const n=Array.from(t.querySelectorAll("table"));if(0===n.length)return;const a={checkName:e.MissingTableHeader,displayText:j.jU,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{null===e.querySelector("th")&&(a.isSuccess=!1,a.violatedNodes?.push(e))}),a}function K(t){const n=Array.from(t.querySelectorAll(".imagePlugin"));if(0===n.length)return;const i={checkName:e.AltText,displayText:j.G5,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return n.forEach(e=>{a("true"===e.getAttribute("data-isdecorative"),e.getAttribute("data-alttext")||"")||(i.isSuccess=!1,i.violatedNodes?.push(e))}),i}async function W(t,n,a){if(I())return;const i=await async function(t,n){if(!t)return;const a=function(e,t){const n=[];if(!e)return n;const a=e.getAttribute("data-sp-feature-instance-id"),i=e.querySelector('[data-automation-id="textBox"]');if(!i)return n;const r=a?function(e){const t=[],n=window.sessionStorage.getItem("DismissedRTENode");return n&&JSON.parse(n).forEach(n=>{const[a,i]=n.split("::");a===e&&t.push(i)}),t}(a):[];return t.forEach(e=>{i.querySelectorAll(e).forEach(e=>{(function(e){return!(!e.firstChild||e.firstChild.nodeType!==Node.TEXT_NODE||""===e.firstChild.textContent?.trim())})(e)&&!r.includes(e.outerHTML)&&n.push(e)})}),n}(t,_);if(0===a.length)return;const i={checkName:e.ColorContrast,displayText:j.z9,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return await async function(e,t,n){await Promise.all(e.map(async e=>{const a=window.getComputedStyle(e),i=a.fontSize,r=parseInt(i.replace(/[^0-9]/g,""),10),o=N(e),s=L(o),c=L(a.color),d=D(r,"STRONG"===e.nodeName)?3:4.5;let l;l=k(o)?n?await B(n,c,d):T(P(A((0,O.getTheme)().semanticColors.bodyBackground)),P(c))>=d:T(P(s),P(c))>=d,l||(t.isSuccess=!1,t.violatedNodes?.push(e))}))}(a,i,n),i}(n,a),r=await async function(t){const n=Array.from(t.querySelectorAll(".imagePlugin"));if(0===n.length)return Promise.resolve(void 0);const a={checkName:e.ColorContrast,displayText:j.z9,isSuccess:!0,violatedNodes:[],shouldOpenPropertyPane:!1};return await Promise.all(n.map(async e=>{const t="true"===e.getAttribute("data-isoverlaytextenabled"),n=!!e.getAttribute("data-overlaytext")&&""!==e.getAttribute("data-overlaytext")?.trim(),i=e.getAttribute("data-imageurl");if(t&&n&&i){const t=q(e.getAttribute("data-overlaystylestextcolor")||"light"),n=q(e.getAttribute("data-overlaystylestextboxcolor")||"dark"),r=Number(e.getAttribute("data-overlaystylestextboxopacity")||.54),o=q(e.getAttribute("data-overlaystylesoverlaycolor")||"light"),s=Number(e.getAttribute("data-overlaystylesoverlaytransparency")||0),c="true"===e.getAttribute("data-overlaystylesisbold"),d=Number(e.getAttribute("data-overlaystylesfontsize")||16);t&&(await H(i,t,c,d,n,r,o,s,e)||(a.isSuccess=!1,a.violatedNodes?.push(e)))}})),Promise.resolve(a)}(t);return i?r?i.isSuccess?r:(r.isSuccess||r.violatedNodes&&r.violatedNodes.length>0&&i.violatedNodes?.push(...r.violatedNodes),i):i:r}function q(e){const t=(0,O.getTheme)(),n=t.semanticColors.inputBackgroundChecked,a=t.semanticColors.accentButtonBackground;return new Map([["light","#ffffff"],["dark","#000000"],["theme1",n],["theme2",a]]).get(e)}async function Q(e,t,n){if(p._SPKillSwitch.isActivated("5d484391-1267-4674-afee-62f401455f02")){const a=[V(e),z(e),G(e),K(e),await W(e,t,n)];return Promise.resolve(a)}{const a=[()=>V(e),()=>z(e),()=>G(e),()=>K(e),()=>W(e,t,n)];return(await Promise.all(a.map(e=>o(e)))).filter(e=>void 0!==e)}}const Y={"d1d91016-032f-456d-98a4-721247c305e8":!0,"8404d628-4817-4b3a-883e-1c5a4d07892e":!0,"c4bd7b2f-7b6e-4599-8485-16504575f590":!0,"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788":!0};function J(e){const t=Y[e];return void 0!==t&&!1!==t&&(!0===t||p._SPFlight.isEnabled(t))}})(),d})());