define("3b7cbc22-e9f9-41d9-87ca-8fd127f8d3d1_0.1.0",["@microsoft/sp-http","@msinternal/odsp-utilities-bundle","@msinternal/odsp-core-bundle","@microsoft/sp-core-library","@msinternal/sp-augloop-providers"],(e,t,n,a,i)=>(()=>{"use strict";var r={676:e=>{e.exports=a},909:t=>{t.exports=e},277:e=>{e.exports=n},810:e=>{e.exports=t},790:e=>{e.exports=i}},o={};function s(e){var t=o[e];if(void 0!==t)return t.exports;var n=o[e]={exports:{}};return r[e](n,n.exports,s),n.exports}s.d=(e,t)=>{for(var n in t)s.o(t,n)&&!s.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{s.r(c),s.d(c,{convertHubbleStockImagesToImageInfo:()=>S,fetchStockImagesWithEnvFallback:()=>D,getStockImages:()=>v,getStockMediaBaseUrl:()=>b,getStockMediaCDNBaseUrl:()=>g});var e,t,n,a,i=s(909),r=s(810),o=s(277);function d(){return!o.KillSwitch.isActivated("92cd451c-a1b1-4c3e-8003-e98a9a54744e","1/30/2025","joyoshioka - Dynamically retrieves Hubble endpoint by environment.")&&o.FeatureOverrides.isFeatureEnabled({ODB:61703})}!function(e){e.MediaDogfood="hubble.df.officeapps.live.com",e.Dogfood="hubblecontent.df.osi.office.net",e.DogfoodCDN="res-sdf.cdn.office.net",e.MediaMSIT="hubble.msit.officeapps.live.com",e.MSIT="hubblecontent.msit.osi.office.net",e.MSITCDN="cdn.hubblecontent.msit.osi.office.net",e.Public="hubblecontent.osi.office.net",e.PublicCDN="cdn.hubblecontent.osi.office.net",e.MediaProd="hubble.officeapps.live.com",e.USNat="hubblecontent.osi.eaglex.ic.gov",e.USNatCDN="hubblecontent.azureedge.eaglex.ic.gov",e.USSec="hubblecontent.osi.microsoft.scloud",e.USSecCDN="hubblecontent.azureedge.microsoft.scloud"}(e||(e={})),function(e){e.Prod="prod",e.USNat="usnat",e.USSec="ussec"}(t||(t={})),function(e){e.StockMedia="StockMedia",e.StockMediaCDN="StockMediaCDN",e.BingMedia="BingMedia"}(n||(n={})),function(e){e.Dogfood="spdf",e.MSIT="prodbubble",e.Prod="prod",e.USNat="ag08",e.USSec="ag09"}(a||(a={}));var l=new Map([[m(a.Dogfood,n.BingMedia),e.MediaDogfood],[m(a.MSIT,n.BingMedia),e.MediaMSIT],[m(a.Prod,n.BingMedia),e.MediaProd],[m(a.USNat,n.BingMedia),e.USNat],[m(a.USSec,n.BingMedia),e.USSec],[m(a.Dogfood,n.StockMedia),e.Dogfood],[m(a.MSIT,n.StockMedia),e.MSIT],[m(a.Prod,n.StockMedia),e.Public],[m(a.USNat,n.StockMedia),e.USNat],[m(a.USSec,n.StockMedia),e.USSec],[m(a.Dogfood,n.StockMediaCDN),e.DogfoodCDN],[m(a.MSIT,n.StockMediaCDN),e.MSITCDN],[m(a.Prod,n.StockMediaCDN),e.PublicCDN],[m(a.USNat,n.StockMediaCDN),e.USNatCDN],[m(a.USSec,n.StockMediaCDN),e.USSecCDN]]),u=void 0,f=function(t,n){var i=function(e){if(e)return Object.values(a).find(function(t){return t===e})}(t.env2)||a.Prod;return l.get(m(i,n))||e.Public},p=function(t,a){var i=t.env2;if(u||(u=new o.Qos({name:"HubbleEndpointHelper.GetHubbleHost"})).end({resultType:o.ResultTypeEnum.Success,extraData:{env:i,isCDN:a}}),!o.KillSwitch.isActivated("5965ff97-8dca-4e28-b11c-4ed5e84fdfcd","7/28/2025","gfernander - Deprecates GetHubbleHost for getHubbleDomain")){var r=f(t,a?n.StockMediaCDN:n.StockMedia);return Object.values(e).includes(r)?r:e.Public}return function(e){return"ag08"===e}(i)?a?e.USNatCDN:e.USNat:function(e){return"ag09"===e}(i)?a?e.USSecCDN:e.USSec:a?e.PublicCDN:e.Public};function m(e,t){return"".concat(e,"-").concat(t)}var _=s(676);function h(){return!_._SPKillSwitch.isActivated("3ab5b8b1-b76e-4730-877d-7fd478500c45")&&_._SPFlight.isEnabled(61542)}function b(e){return`https://${f(e,n.StockMedia)}`}function g(e){return`https://${f(e,n.StockMediaCDN)}`}function v(e){const{searchTerm:t,count:n=10,httpClient:a,spPageContext:s,skip:c=0}=e,l=new i.HttpClientConfiguration({}),u=`${d()?h()?b(s):`https://${p(s)}`:"https://hubblecontent.osi.office.net"}/contentsvc/api/pivots/f8218404-63dd-4670-b0f5-f8b50674f963`,f=new r.Uri(u);f.setQueryParameter("filter","pivotNames/any(p: p eq 'Stock Images')"),f.setQueryParameter("search",`${t}`),f.setQueryParameter("top",`${n}`),f.setQueryParameter("skip",`${c}`),f.setQueryParameter("app","1001"),f.setQueryParameter("aud","prod"),f.setQueryParameter("gie","false"),f.setQueryParameter("gae","false"),f.setQueryParameter("semsearch","false"),f.setQueryParameter("phr","false"),f.setQueryParameter("pref1p","false"),f.setQueryParameter("sigcoll","false"),f.setQueryParameter("qual",""),f.setQueryParameter("semsearch1p","false");const m=_._SPKillSwitch.isActivated("bbf71ec6-5b37-4240-9f3e-7ba94ffbd1ee")?void 0:new Headers({Accept:"application/json","Accept-Language":e.locale??s.currentUICultureName}),g=[];let v=0;return(a?a.get(f.toString(),l,m?{headers:m}:void 0):fetch(f.toString(),{method:"GET",headers:m,credentials:"include",mode:"cors"})).then(e=>(v=e.status,e.json())).then(e=>{if(e)return e.MicrosoftContents?e.MicrosoftContents:g;throw new o.CustomError({message:(0,o.markPrivacyData)("No response from Hubble","safe")})}).catch(e=>{throw new o.CustomError({message:(0,o.markPrivacyData)(_._SPKillSwitch.isActivated("61fb878c-4a02-4706-b6fe-4a31f21a8ac2")?`Error fetching stock images from Hubble: ${e}`:`Error fetching stock images from Hubble: ${e}, statusCode: ${v}`,"safe")})})}var y=s(790);function S(e,t){const n=d()?h()?g(t):`https://${p(t,!0)}`:"https://cdn.hubblecontent.osi.office.net";return e.map(e=>({id:_.Guid.newGuid().toString(),url:`${n}/${e.Path}`,width:e.Width,height:e.Height,description:e.Description,previewThumbnails:e.ThumbnailInfo?{small:e.ThumbnailInfo.Small?{url:e.ThumbnailInfo.Small.Path,width:e.ThumbnailInfo.Small.Width,height:e.ThumbnailInfo.Small.Height}:void 0,medium:e.ThumbnailInfo.Medium?{url:e.ThumbnailInfo.Medium.Path,width:e.ThumbnailInfo.Medium.Width,height:e.ThumbnailInfo.Medium.Height}:void 0,large:e.ThumbnailInfo.Large?{url:e.ThumbnailInfo.Large.Path,width:e.ThumbnailInfo.Large.Width,height:e.ThumbnailInfo.Large.Height}:void 0,xLarge:e.ThumbnailInfo.XLarge?{url:e.ThumbnailInfo.XLarge.Path,width:e.ThumbnailInfo.XLarge.Width,height:e.ThumbnailInfo.XLarge.Height}:void 0}:void 0}))}async function D(e){const{spPageContext:t,httpClient:n,prompt:a,pageSize:i,pageOffset:r}=e;return function(e,t){var n;if(!e.cloudType)return!1;var a=function(e){switch(e){case"gcc":return"prod";case"dod":return"pathfinder";case"gcch":return"trailblazer";case"chn":return"gallatin";default:return e}}(e.cloudType);return function(e){return e?"gallatin"===e:location.origin.indexOf(".cn")===location.origin.length-3}(a)||function(e){return e?"blackforest"===e:location.origin.indexOf(".de")===location.origin.length-3}(a)||function(e){return"pathfinder"===e||"trailblazer"===e}(a)||function(e){return function(e){return"ag08"===e}(e)||function(e){return"ag09"===e}(e)}(a)||"0"===(null===(n=e.farmSettings)||void 0===n?void 0:n.ExternalService_videousecdnenabled)}(t)?S(await v({searchTerm:a,count:i,spPageContext:t,skip:r,httpClient:n}),t):async function(e){const{getAlProxy:t,...n}=e,a=await t();return(0,y.fetchHubble)({...n,alProxy:a})}(e)}})(),c})());