define("69ea40d8-80e5-4ed2-8e45-f5c904e94161_0.1.0",["@microsoft/sp-page-context","@msinternal/sp-component-utilities","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-http","@microsoft/sp-lodash-subset","@msinternal/sp-telemetry","@msinternal/sp-topic-sdk","@microsoft/sp-http-base"],(e,t,n,a,i,r,o,s,c)=>(()=>{"use strict";var d={676:e=>{e.exports=n},207:e=>{e.exports=a},909:e=>{e.exports=i},737:e=>{e.exports=c},529:e=>{e.exports=r},408:t=>{t.exports=e},718:e=>{e.exports=t},519:e=>{e.exports=o},506:e=>{e.exports=s}},l={};function u(e){var t=l[e];if(void 0!==t)return t.exports;var n=l[e]={exports:{}};return d[e](n,n.exports,u),n.exports}u.d=(e,t)=>{for(var n in t)u.o(t,n)&&!u.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},u.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),u.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var f={};return(()=>{var e;u.r(f),u.d(f,{OCPSPolicyDataProvider:()=>D,TopicMultilingualDataProvider:()=>I,TopicPageDataProvider:()=>v}),function(e){e[e.NotPromoted=0]="NotPromoted",e[e.PromoteOnPublish=1]="PromoteOnPublish",e[e.Promoted=2]="Promoted"}(e||(e={}));var t,n=u(408),a=u(718),i=u(676),r=u(207),o=u(909),s=u(529),c=u(519),d=u(506);!function(e){e[e.BadRequest=400]="BadRequest",e[e.Conflict=409]="Conflict",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.ServerError=500]="ServerError",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.NotImplemented=501]="NotImplemented"}(t||(t={}));const l=t;class p extends Error{constructor(e="unknown",t=200,n,a=!1){super(e),"unknown"===e&&(this.isUnknown=!0),this.__proto__=p.prototype,this.status=t,this.code=n,this.isExpected=a}}function m(e){const t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return`[HTTP]:${e.status} - ${e.statusText} [CorrelationId]:${t} [Version]:${n}`}function _(){return i._SPKillSwitch.isActivated("9c8c4dbb-309c-473c-8e35-e420d68f34f7")}class h{static _getOdataRestApiError(e,t=l.ServerError){const n=e["odata.error"];return n?.message?new p(`Message: ${n.message.value}`,t,n.code):void 0}fetchJson(e,t,n,a){const i=new c._QosMonitor(`${this.qosPrefixName}.fetchDataFailed`),s={body:a,headers:t};return r._TraceLogger.logVerbose(r._LogSource.create(this.qosPrefixName),n),this._spHttpClient.post(e,o.SPHttpClient.configurations.v1,s).then(e=>{if(_()&&!e.ok)throw new p(m(e),e.status);return e.json().then(t=>{const n=h._getOdataRestApiError(t,e?.status);if(n)throw n;return t}).catch(t=>{throw _()||t instanceof p?t:new p(m(e),e.status)})}).catch(e=>{throw e.status===l.Forbidden?i.writeExpectedFailure("FailedResponseForbidden",e):i.writeUnexpectedFailure("FailedResponseStatus",e),e})}getRestTopicsEndPointUrl(){return this.getRestSitePagesEndPointUrl().then(e=>`${e}/topics`)}getRestSitePagesEndPointUrl(){return this.getKnowledgeCenterRelativeUrl().then(e=>`${e}/_api/sitepages/pages`)}getKnowledgeCenterRelativeUrl(){if(this._knowledgeCenterUrl)return Promise.resolve(this._knowledgeCenterUrl);const e=this.serviceScope.consume(n.PageContext.serviceKey);return(0,a.isSiteKnowledgeCenter)(e.legacyPageContext)?(this._knowledgeCenterUrl=i.UrlUtilities.removeEndSlash(e.legacyPageContext.webServerRelativeUrl),Promise.resolve(this._knowledgeCenterUrl)):(0,d.getTopicsSdk)(this.serviceScope).then(e=>{if(!e.getKnowledgeCenterInfo())throw new Error("Can not get valid knowledge center info");const{url:t}=e.getKnowledgeCenterInfo();return this._knowledgeCenterUrl=t,t})}constructor(e){this.serviceScope=e,this._spHttpClient=e.consume(o.SPHttpClient.serviceKey)}}class b{constructor(e){this["OData-Version"]="3.0",this["If-Match"]="*",this["X-HTTP-Method"]=e}}class g{toString(){return JSON.stringify(this)}constructor(e){this.__metadata={type:"SP.Publishing.TopicSitePage"},e&&(0,s.assign)(this,e)}}class v extends h{createTopicPage({topic:e,canvasContent1:t,layoutWebpartsContent:n,language:r}){return this.getRestTopicsEndPointUrl().then(o=>{const s=new g({Title:e.Name,EntityId:e.Id!==a.NULL_TOPIC_ENTITY.Id?e.Id:"",EntityType:"",EntityRelations:a.EntityRelationsService.getRelationsAsString(this.serviceScope),...i._SPFlight.isEnabled(1601)?{VerifiedTopicAllowedEditors:a.VerifiedTopicAllowedEditorsService.getEditorsAsString(this.serviceScope)}:void 0,...i._SPFlight.isEnabled(60475)&&r&&{Language:r},LayoutWebpartsContent:n,CanvasContent1:JSON.stringify(t),TopicHeader:"Topic",BannerImageUrl:"/_layouts/15/images/sitepagethumbnail.png",PageLayoutType:"Topic"});return this.fetchJson(o,new b("POST"),"createTopicPage",JSON.stringify(s))}).catch(e=>{var t;throw e.name=-1!==(t=e).code?.indexOf("-2146233086")&&-1!==t.code?.indexOf("LanguageCodes")?"UnsupportedLanguage":-1!==t.code?.indexOf("-2146232832")&&-1!==t.code?.indexOf("Microsoft.SharePoint.SPException")?"SourcePageCheckedOutByOtherUser":-1!==t.code?.indexOf("-2146232832")&&-1===t.code?.indexOf("SPDuplicateValuesFoundException")?"DuplicatePage":"UnknownError",e})}checkoutTopicPage(e,t=this.serviceScope.consume(n.PageContext.serviceKey).web.languageName){return this.getRestTopicsEndPointUrl().then(n=>this.fetchJson(`${n}/GetByEntityIdAndCulture(id='${e.join(";")}',culture='${t}')/checkoutpage`,new b("POST"),"CheckoutTopicPageByTopicId"))}checkoutPage(e){return this.getRestSitePagesEndPointUrl().then(t=>this.fetchJson(`${t}/GetByUrl('${new URL(e).pathname}')/checkoutpage`,new b("POST"),"CheckoutPageByUrl"))}publishTopicPage(e){return this.getRestSitePagesEndPointUrl().then(t=>{const n=`${t}(${e})/publish`;return this.fetchJson(n,new b("POST"),"publishTopicPage")})}getTopicPageByEntityId(e,t){return t?this.getRestTopicsEndPointUrl().then(n=>this.fetchJson(`${n}/GetByEntityIdAndCulture(id='${e.join(";")}',culture='${t}')`,new b("GET"),"getTopicPageByEntityId")):this.getDefaultTopicPageByEntityId(e)}getDefaultTopicPageByEntityId(e){return this.getRestTopicsEndPointUrl().then(t=>{const a=this.serviceScope.consume(n.PageContext.serviceKey).web.languageName;return this.fetchJson(`${t}/GetByEntityIdAndCulture(id='${e.join(";")}',culture='${a}')`,new b("GET"),"getDefaultTopicPageByEntityId")})}getSourcePageByEntityId(e,t){if(0===e.length)throw new Error("Empty entityIds provided");return this.getRestTopicsEndPointUrl().then(n=>{let a="";t?.length&&t.length>0&&(a=`?$select=${t.join(",")}`);const i=`${n}/GetByEntityId('${e.join(";")}')${a}`;return this.fetchJson(i,new b("GET"),"getSourcePageByEntityId")})}getTopicPagesByEntityId(e,t){return 0===e.length?Promise.reject("Empty entityIds provided"):this.getRestTopicsEndPointUrl().then(n=>{let a="";t?.length&&t.length>0&&(a=`?$select=${t.join(",")}`);const i=`${n}/GetPagesByEntityId('${e.join(";")}')${a}`;return this.fetchJson(i,new b("GET"),"getTopicPagesByEntityId").then(e=>e.value||[])})}get qosPrefixName(){return"CSIKM.TopicPageDataProvider"}}var y=u(737);const S="https://clients.config.office.net";class D{getPolicies(){const e=new r._QosMonitor("CSIKM.OCSPPolicy.DP.getPolicies");return this._tokenProvider._getTokenInternal(S,y._AadTokenProviders.preAuthorizedConfiguration).then(e=>this._serviceScope.consume(o.HttpClient.serviceKey).get(this._policiesEndPoint,o.AadHttpClient.configurations.v1,this._getRequestOptions(e)).then(e=>204===e.status?{}:e.json())).catch(t=>(e.writeUnexpectedFailure("FailedToOCPSPolicies",t),Promise.reject(t)))}_getRequestOptions(e){const t={headers:{}};return t.headers["Content-Type"]="application/json",t.headers.Authorization=`Bearer ${e}`,t.headers["x-Cid"]="00000003-0000-0ff1-ce00-000000000000",t}get _policiesEndPoint(){return`${S}/user/v1.0/web/policies`}constructor(e){this._serviceScope=e,this._tokenProvider=y._AadTokenProviders.configurable}}class I extends h{getDefaultPageUrlBySourceId(e){const t=new r._QosMonitor(`${this.qosPrefixName}.getDefaultPageUrlBySourceId`);let n=!1;return this.getRestSitePagesEndPointUrl().then(a=>{const i=`${a}/GetByUniqueId('${e}')?$select=AbsoluteUrl`;return this.fetchJson(i,new b("GET"),"getDefaultPageUrlBySourceId").then(e=>(n=!0,e.AbsoluteUrl?(t.writeSuccess(),e.AbsoluteUrl):Promise.reject(new Error("Response have no AbsoluteUrl returned for the default language page."))))}).catch(e=>{t.writeUnexpectedFailure(n?"SuccessResponseButWrongData":"FailedToGetDefaultUrl",e)})}getSourcePageByUniqueId(e,t){const n=new r._QosMonitor(`${this.qosPrefixName}.getDefaultPageBySourceId`);return this.getRestSitePagesEndPointUrl().then(a=>{const i=`${a}/GetByUniqueId('${e}')${function(e){let t="";return e?.length&&e.length>0&&(t=`?$select=${e.join(",")}`),t}(t)}`;return this.fetchJson(i,new b("GET"),"getDefaultPageBySourceId").then(e=>(n.writeSuccess(),e))}).catch(e=>{n.writeUnexpectedFailure("FailedToGetSourcePage",e)})}get qosPrefixName(){return"CSIKM.TopicMultilingualDataProvider"}}})(),f})());