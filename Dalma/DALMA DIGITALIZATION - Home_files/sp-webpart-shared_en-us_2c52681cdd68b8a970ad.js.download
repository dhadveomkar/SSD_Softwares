(()=>{var e=document.currentScript;define("914330ee-2df2-4f6e-a858-30c23a812408_2.2.20",["react","react-dom","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@msinternal/sp-component-utilities","@msinternal/sp-telemetry","@msinternal/sp-heading-level","@microsoft/sp-lodash-subset","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/odsp-utilities-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sharepoint-ui-tokens-bundle","@msinternal/sp-deferred-component","@msinternal/sp-fluentui-migration-customizer-bundle","@msinternal/sp-fluentui-migration-tooltip-bundle","@msinternal/sp-fluentui-migration-link-bundle","@microsoft/sp-loader","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/sp-fluentui-migration-messagebar-bundle","@microsoft/sp-component-base","@microsoft/sp-page-context","@microsoft/sp-http","@microsoft/sp-webpart-base","@msinternal/odsp-core-bundle","@msinternal/sp-rich-image","@msinternal/i18n-utilities","@microsoft/sp-image-helper","@msinternal/swc-helpers-bundle","@msinternal/sp-fluentui-v9-react-switch-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k)=>(()=>{"use strict";var M={134:(e,t,n)=>{n.d(t,{Up:()=>i,XA:()=>r,Yg:()=>s,jF:()=>o});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("f3b11671-f43f-4e6d-8d17-b66bc86f4838")}function r(){return a._SPKillSwitch.isActivated("b0861b96-5b5e-484d-9bca-5f32b00504ac")}function o(){return a._SPKillSwitch.isActivated("f6d97b40-3ab5-40c6-8152-aaeff09f013c")}function s(){return a._SPKillSwitch.isActivated("62be4d8d-22b6-4f17-a78c-7dc8c6c234b4")}}
,7728:(e,t,n)=>{n.d(t,{$9:()=>f,JU:()=>l,WE:()=>c,Ye:()=>o,_m:()=>u,ox:()=>r,pD:()=>d,yA:()=>s});var a=n(9676),i=n(7547);function r(){return a._SPFlight.isEnabled(1671)}function o(){return a._SPFlight.isEnabled(60803)}function s(){return!(0,i.zE)()&&a._SPFlight.isEnabled(62620)}function c(){return a._SPFlight.isEnabled(1506)}function d(){return a._SPFlight.isEnabled(61874)}function l(){return!(0,i.OM)()&&a._SPFlight.isEnabled(61245)}function u(){return!(0,i.bh)()&&a._SPFlight.isEnabled(61245)}function f(){return!(0,i.Iw)()&&a._SPFlight.isEnabled(1342)}}
,7547:(e,t,n)=>{n.d(t,{B2:()=>C,B7:()=>x,F8:()=>o,FL:()=>i,IY:()=>f,Iw:()=>E,JB:()=>D,K6:()=>s,M6:()=>O,OM:()=>d,Ph:()=>y,Q8:()=>m,Rq:()=>S,TJ:()=>h,TQ:()=>r,XA:()=>g,Ym:()=>w,_k:()=>I,bh:()=>l,cc:()=>v,ey:()=>p,gG:()=>b,hf:()=>c,u4:()=>_,zE:()=>u});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("49c3a31f-5de7-4e23-9215-e5f14730f38a")}function r(){return a._SPKillSwitch.isActivated("86ec9359-938c-4ead-a4c1-9ad50be739a1")}function o(){return a._SPKillSwitch.isActivated("cc25329a-3fd2-4808-bcfb-116baf415aeb")}function s(){return a._SPKillSwitch.isActivated("2ab1d078-d1cc-4b4d-a6e0-70f675b13461")}function c(){return a._SPKillSwitch.isActivated("777654ff-fcb6-4abb-beae-ba2708f37591")}function d(){return a._SPKillSwitch.isActivated("f640fd76-4a11-48b9-ab80-b635844d734d")}function l(){return a._SPKillSwitch.isActivated("f517f548-0f32-4526-948d-f9422dd06fee")}function u(){return a._SPKillSwitch.isActivated("abc5ca03-f7c8-4d79-b7eb-6ba83b43a929")}function f(){return a._SPKillSwitch.isActivated("0a54ddef-a1e1-4cef-921f-62d8059de6a5")}function p(){return a._SPKillSwitch.isActivated("babe9e56-b163-4cd7-8422-b083e93533a0")}function m(){return a._SPKillSwitch.isActivated("a888be6b-db89-4068-83a7-02f00d4fc551")}function _(){return a._SPKillSwitch.isActivated("9c47a7c7-046d-42ec-9c8f-9701e96a16bd")}function h(){return a._SPKillSwitch.isActivated("638bab7f-dbb0-4a6f-986b-21e21e82c8a6")}function b(){return a._SPKillSwitch.isActivated("269bba16-835f-41df-8dbe-8c4c753bf066")}function g(){return a._SPKillSwitch.isActivated("7d7f5920-0181-4820-9225-dfa39e1c9334")}function v(){return a._SPKillSwitch.isActivated("a109de97-a7eb-48a5-b52a-f7087ec35112")}function y(){return a._SPKillSwitch.isActivated("18c1e87f-cc5b-487f-8fe4-358b6ae1cbc7")}function S(){return a._SPKillSwitch.isActivated("2810f693-c857-4d21-b148-f9dec6fd72e2")}function D(){return a._SPKillSwitch.isActivated("04993e2d-df69-4f85-a615-5436dfc3623e")}function I(){return a._SPKillSwitch.isActivated("a921d69a-d514-4ea6-98b4-2d1fa1d601aa")}function x(){return a._SPKillSwitch.isActivated("72025b5d-ce4b-402d-8f5f-0c6ed1fa3cc8")}function C(){return a._SPKillSwitch.isActivated("6b12878b-d44c-44a8-b898-d2996e72baf7")}function O(){return a._SPKillSwitch.isActivated("862030fb-7228-4c26-b8a2-d9522577225d")}function w(){return a._SPKillSwitch.isActivated("4c979778-d9d2-48d2-b40d-f41772ffa147")}function E(){return a._SPKillSwitch.isActivated("fd54e993-3a17-4eb5-b54f-1a91af0401d0")}}
,5977:(e,t,n)=>{n.d(t,{bI:()=>v,Yk:()=>g,Oy:()=>S});var a=n(5959),i=n(2141),r=n(2207),o=n(529);const s=a.lazy(()=>n.e(541).then(n.bind(n,2223)).then(e=>({default:e.default})));function c(e){return a.createElement(a.Suspense,{fallback:!1},a.createElement(s,e))}var d=n(7547),l=n(2550),u=n(606),f=n(7147),p=n(7728);const m=(0,u.makeStyles)({});function _(e){const t=(a.useContext(f.m)||m)(),{useFigCaptionTag:n,content:i,styles:r,isEditMode:o,useWebpartTitleStyles:s}=e,c=(s||m)(),l=(0,u.mergeClasses)(r,"captionElement",o&&t.captionTextEdit,!o&&t.captionTextView,!(0,d.K6)()&&((0,p._m)()?(0,d.cc)()?c.multipleHeader:c.multipleHeaderUpdated:c.header)),_=!!(0,d.Q8)()||""!==i.props?.text||o;return n?_&&a.createElement("figcaption",{className:l,"data-automation-id":"captionElement"},i):_&&a.createElement("div",{className:l,"data-automation-id":"captionElement"},i)}var h=n(7405);class b extends i.BaseComponent{render(){let e=(0,p._m)()?(this.props.headingLevel||this.props.type===g.Title)&&"heading":this.props.headingLevel&&"heading";return(0,d.Rq)()||e||(e=void 0),a.createElement("span",{ref:this._spanRef,role:e,onClick:this.props.handleClick,"aria-level":(0,p._m)()?this.props.headingLevel||h._DEFAULT_HEADING_LEVEL:this.props.headingLevel,id:"CaptionElementView","data-automation-id":this.props.type===g.Title?"webPartTitleReadMode":void 0,className:!(0,p._m)()||(0,d.M6)()&&!this.props.headingLevel?void 0:"headingLevel"+(this.props.headingLevel?`-${this.props.headingLevel}`:""),style:{cursor:"text"}},this.props.text,this.props.placeholder&&!this.props.text&&a.createElement("span",null,this.props.placeholder))}constructor(e){super(e),this._spanRef=a.createRef()}}const g={Caption:1,Title:2},v={PageDirection:1,Center:2};var y;!function(e){e.Read="READ",e.ActiveResponsiveEdit="ACTIVE_RESPONSIVE_EDIT",e.InactiveResponsiveEdit="INACTIVE_RESPONSIVE_EDIT",e.UnresponsiveEdit="UNRESPONSIVE_EDIT"}(y||(y={}));class S extends i.BaseComponent{UNSAFE_componentWillReceiveProps(e){this.setState({text:e.text})}componentDidUpdate(e,t){this._handleActiveEditingUpdate(t),this._handleCaptionEditingHeightUpdate(t),this._handleHeightUpdate(t)}componentDidMount(){this.props.allowResponsiveCaptionHeight&&this._initializeResizeObserver()}componentWillUnmount(){this.props.allowResponsiveCaptionHeight&&this._cleanUpResizeObserver()}render(){const e=(0,i.css)({[l.A.captionElement__NoMargin]:!this.props.marginBottomSize||"None"===this.props.marginBottomSize},{[l.A.captionElement__MiddleMargin]:"Middle"===this.props.marginBottomSize},{[l.A.captionElement__LargeMargin]:"Large"===this.props.marginBottomSize}),t=(0,i.mergeStyles)(this.props.type===g.Caption&&l.A.captionElement__caption,this.props.type===g.Title&&l.A.captionElement__title,!(0,d._k)()&&this.props.type===g.Title&&l.A.captionElement__title__sectionColor,this.props.type===g.Title&&(n={theme:(0,i.getTheme)()},{title:{...n.theme.fonts.xLarge}}).title,l.A.thick);var n;const r=(0,i.css)({[l.A.captionElement__leftAlign]:this.props.alignPosition===v.PageDirection},{[l.A.captionElement__centerAlign]:this.props.alignPosition===v.Center}),o=l.A.titleBreakInLines,s=(0,i.css)(e,t,r,o,this.props.className),c=this._getCaptionEditMode(),u=!1===this.props.isTitleEditable||"UNRESPONSIVE_EDIT"!==c&&"ACTIVE_RESPONSIVE_EDIT"!==c?this._renderViewMode:this._renderEditMode;return(0,d.F8)()?this.props.useFigCaptionTag?a.createElement("figcaption",{className:s,"data-automation-id":"captionElement"},u):a.createElement("div",{className:s,"data-automation-id":"captionElement"},u):a.createElement(_,{useFigCaptionTag:this.props.useFigCaptionTag,content:u,styles:s,isEditMode:this.props.isEditMode,useWebpartTitleStyles:this.props.useWebpartTitleStyles})}value(){return this.state.text}_getCaptionEditMode(){return this.props.isEditMode?!0===this.props.allowResponsiveCaptionHeight?this.state.isActiveEditing?"ACTIVE_RESPONSIVE_EDIT":"INACTIVE_RESPONSIVE_EDIT":"UNRESPONSIVE_EDIT":"READ"}get _renderEditMode(){return a.createElement(c,{handleChange:this._handleChange,placeholder:this.props.placeholder,text:this.state.text,handleFocus:this._handleFocus,handleBlur:this._handleBlur,handleClick:this._handleClick,receiveElement:this._handleReceiveRef,type:this.props.type||g.Title,ariaLabel:this.props.ariaLabel,headingLevel:this.props.headingLevel,maxLength:(0,d.JB)()?void 0:this.props.maxLength})}get _renderViewMode(){const{headingLevel:e}=this.props;return a.createElement(b,{headingLevel:e,pageContext:this.props.pageContext,text:this.state.text,type:this.props.type,handleClick:this.props.allowResponsiveCaptionHeight?this._handleReadModeElementClick:void 0,placeholder:this.props.placeholder})}constructor(e){super(e),this.focusOnCaptionElement=()=>{this._textarea?.focus()},this._handleActiveEditingUpdate=e=>{this.props.allowResponsiveCaptionHeight&&this.state.isActiveEditing!==e.isActiveEditing&&(this.state.isActiveEditing?this.setState({height:this.state.captionEditingHeight}):this.setState({height:30}))},this._handleCaptionEditingHeightUpdate=e=>{"ACTIVE_RESPONSIVE_EDIT"===this._getCaptionEditMode()&&this.state.isActiveEditing&&this.state.captionEditingHeight!==e.captionEditingHeight&&this.setState({height:this.state.captionEditingHeight+8})},this._handleHeightUpdate=e=>{this.props.allowResponsiveCaptionHeight&&this.props.onHeightChange&&this.props.onHeightChange(this.state.height)},this._initializeResizeObserver=()=>{this._resizeObserver||(this._resizeObserver=new ResizeObserver(e=>{const t=e[0].contentRect.height;this.setState({captionEditingHeight:t})}))},this._cleanUpResizeObserver=()=>{this._resizeObserver&&this._resizeObserver.disconnect()},this._handleReceiveRef=e=>{this._textarea=e,"ACTIVE_RESPONSIVE_EDIT"===this._getCaptionEditMode()&&(this._initializeResizeObserver(),this._resizeObserver.observe(this._textarea),this.focusOnCaptionElement())},this._handleClick=e=>{e.stopPropagation(),this.focusOnCaptionElement()},this._handleChange=e=>{const t=e.target.value;this.setState({text:t},()=>{this.props.onChange&&this.props.onChange(t,e)})},this._handleReadModeElementClick=e=>{e.stopPropagation(),this.setState({isActiveEditing:!0})},this._handleFocus=()=>{this.props.moduleName&&this.props.isEditMode&&(this._initialValue=this.state.text)},this._handleBlur=()=>{if(this.setState({isActiveEditing:!1}),this.props.moduleName&&this.props.isEditMode){let e;const t=this.state.text;this._initialValue!==t&&(e=0===t.length?"Clear":this._initialValue&&0!==this._initialValue.length?"Edit":"Add",r._EngagementLogger.logEventWithLogEntry(new r._LogEntry(this.props.moduleName,"CaptionElement",r._LogType.Event,{action:e,length:t.length.toString()})))}},this.state={text:e.text,height:38,captionEditingHeight:38,isActiveEditing:!1}}}S.defaultProps={isEditMode:!1,text:void 0,onChange:o.noop,placeholder:void 0,type:g.Caption,alignPosition:v.Center,allowResponsiveCaptionHeight:!1}}
,7147:(e,t,n)=>{n.d(t,{m:()=>r});var a=n(5959),i=n(606);const r=a.createContext((0,i.makeStyles)({}))}
,2550:(e,t,n)=>{n.d(t,{A:()=>a}),n(8424).loadStyles('.c_udhgU_-aI_E{font-size:14px;font-weight:400;font-weight:300;line-height:1.6em;overflow-x:hidden;text-overflow:ellipsis}.c_udhgU_-aI_E.t_NioKQ_-aI_E{font-weight:400}.c_Xx3gD_-aI_E{font-size:28px!important}.c_X37vu_-aI_E{font-size:24px!important}.c_OxQxF_-aI_E{font-size:20px!important}.c_gdmi6_-aI_E{font-size:18px!important}.c_ffmYc_-aI_E{font-size:14px}.c_yWbNM_-aI_E{color:"[theme:neutralPrimary, default: #323130]";overflow:hidden;text-overflow:ellipsis}.c_Sr5G3_-aI_E,.c_Sr5G3_-aI_E textarea{color:var(--colorNeutralForeground1)}[dir=ltr] .c_m0eaY_-aI_E{text-align:left}[dir=rtl] .c_m0eaY_-aI_E{text-align:right}.c_B4S9K_-aI_E{text-align:center}[dir=ltr] .c_mWuWl_-aI_E{text-align:right}[dir=rtl] .c_mWuWl_-aI_E{text-align:left}.c_NeIcr_-aI_E{margin-bottom:18px}.c_z1YDo_-aI_E{margin-bottom:11px}.c_Ddfi__-aI_E{margin-bottom:0}.t_6hNh3_-aI_E{white-space:pre-wrap}.t_inTf7_-aI_E{background-color:transparent;border:none;box-sizing:border-box;display:block;font-family:inherit;font-size:inherit;font-weight:inherit;line-height:inherit;margin:0;outline:0;overflow:hidden;resize:none;text-align:inherit;width:100%}.t_inTf7_-aI_E.t_NioKQ_-aI_E{font-weight:400}.t_inTf7_-aI_E:-ms-input-placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}.t_inTf7_-aI_E::placeholder{color:"[theme:neutralTertiary, default: #a19f9d]"}',!0);const a={captionElement__caption:"c_udhgU_-aI_E",thick:"t_NioKQ_-aI_E",captionElement__heading2:"c_Xx3gD_-aI_E",captionElement__heading3:"c_X37vu_-aI_E",captionElement__heading4:"c_OxQxF_-aI_E",captionElement__heading4Legacy:"c_gdmi6_-aI_E",captionElement__nonHeading:"c_ffmYc_-aI_E",captionElement__title:"c_yWbNM_-aI_E",captionElement__title__sectionColor:"c_Sr5G3_-aI_E",captionElement__leftAlign:"c_m0eaY_-aI_E",captionElement__centerAlign:"c_B4S9K_-aI_E",captionElement__rightAlign:"c_mWuWl_-aI_E",captionElement__LargeMargin:"c_NeIcr_-aI_E",captionElement__MiddleMargin:"c_z1YDo_-aI_E",captionElement__NoMargin:"c_Ddfi__-aI_E",titleBreakInLines:"t_6hNh3_-aI_E",textarea:"t_inTf7_-aI_E"}}
,8424:e=>{e.exports=o},1962:e=>{e.exports=D},9676:e=>{e.exports=a},2207:e=>{e.exports=i},1909:e=>{e.exports=x},4949:e=>{e.exports=A},8414:e=>{e.exports=v},529:e=>{e.exports=l},7408:e=>{e.exports=I},6642:e=>{e.exports=C},2141:e=>{e.exports=r},1787:e=>{e.exports=E},6277:e=>{e.exports=O},8810:e=>{e.exports=f},9930:e=>{e.exports=m},718:e=>{e.exports=s},1013:e=>{e.exports=_},6575:e=>{e.exports=p},3966:e=>{e.exports=h},95:e=>{e.exports=g},9331:e=>{e.exports=S},4907:e=>{e.exports=y},6094:e=>{e.exports=b},5494:e=>{e.exports=k},606:e=>{e.exports=u},7405:e=>{e.exports=d},8122:e=>{e.exports=w},5519:e=>{e.exports=c},5592:e=>{e.exports=L},5959:e=>{e.exports=t},8398:e=>{e.exports=n}},P={};function T(e){var t=P[e];if(void 0!==t)return t.exports;var n=P[e]={exports:{}};return M[e](n,n.exports,T),n.exports}T.m=M;var U,F,H,R={"59":"FuR3odWHMYTC/r26Ok3z0kzgTm2rgb9o0cScX99FkB4=","460":"rHIEd+wcZpCLx/8dImGcmkKMMoWsmnYv4fqqar8XSkU=","468":"RBODnzPwQwa9EUrH7gw6+afNXKPD9ZM0B5MBsB8YIz8=","541":"haawzyUQ2RaSUmWD7SqVROC67UVK2LxLQHcq4Nk0V88=","623":"9yOhDt2L6q9gWp7YLKYa2w4ig45NLE9iW3dA1Czi9cw=","654":"N5RH7yiyXD9XBV43VfkPSpeeuf1N1s9EuHue4j/qCeQ=","863":"oCeBz+ATwkJs1rEpY9FKlLrYVSZcscDlaBZ4YGIghHs="};T.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return T.d(t,{a:t}),t},T.d=(e,t)=>{for(var n in t)T.o(t,n)&&!T.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},T.f={},T.e=e=>Promise.all(Object.keys(T.f).reduce((t,n)=>(T.f[n](e,t),t),[])),T.u=e=>"chunk."+({59:"sp-fabric-teaching-bubble",460:"sp-edit-utilities",541:"sp-caption-element-edit",623:"sp-editorial-card-editor-toolbar",863:"live-persona-card-loader"}[e]||e)+"_"+({541:1,623:1}[e]?"en-us":"none")+"_"+{59:"838f68e79540ce56a922",460:"aae883f64f79b0613ac9",468:"6b3274729901e7c5ed62",541:"a25058fd262e205114df",623:"48f4d59b4b4bf233848f",654:"f56428f79db9fd482970",863:"89cc972f938d50587c4c"}[e]+".js",T.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),T.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),U={},F="914330ee-2df2-4f6e-a858-30c23a812408_2.2.20:",T.l=(e,t,n,a)=>{if(U[e])U[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==F+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,T.nc&&i.setAttribute("nonce",T.nc),i.setAttribute("data-webpack",F+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(R[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}U[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=U[e];if(delete U[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},T.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},H=e?e.src:"",T.p=H.slice(0,H.lastIndexOf("/")+1),T.f.compat=(e,t)=>{for(var n=function(e){var t={i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},n={i:"17ce0976-e69a-4355-be84-89b69a74717d",v:"0.3.61",m:9825};return{59:[t,n],468:[t,n],623:[{i:"72ec0651-8a26-441c-87f2-77ec66884ca3",v:"0.1.0",m:7526},{i:"f652a763-4d5f-4a08-aed3-d3377ef835ff",v:"0.1.0",m:6879},{i:"33c5a798-8532-4741-888a-d0a7734036b5",v:"0.1.0",m:1589},{i:"c4016abc-9cc8-4869-ac2f-278195db557b",v:"0.1.0",m:7806},{i:"7398d964-5053-4878-ad3d-d901ae7d1243",v:"0.1.0",m:6679},{i:"ab76bc68-beb3-415c-8197-a23414c5acb6",v:"0.1.0",m:8145},{i:"8450fe90-4905-4cf6-a0a8-f3808aa58002",v:"0.1.0",m:8951},{i:"2f2bb9cc-38de-4ae3-8916-2a2cc048d1ff",v:"0.1.0",m:83}],654:[t],863:[{i:"a68dd513-949e-48c1-b210-23ad37dbbe13",v:"0.1.0",m:1506},t],460:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:1181}]}[e]||[]}(e),a=0;a<n.length;a++)T.m[n[a].m]||(e=>{t.push(N.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{T.m[e.m]=e=>e.exports=t}))})(n[a])};var N=T(8414);(()=>{var e={726:0};T.f.j=(t,n)=>{var a=T.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=T.p+T.u(t),o=new Error;T.l(r,n=>{if(T.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)T.o(o,a)&&(T.m[a]=o[a]);s&&s(T)}for(t&&t(n);c<r.length;c++)i=r[c],T.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_914330ee-2df2-4f6e-a858-30c23a812408_2.2.20"]=self["webpackJsonp_914330ee-2df2-4f6e-a858-30c23a812408_2.2.20"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var B={};return(()=>{T.r(B),T.d(B,{BaseCollection:()=>$,BaseCollectionWebPart:()=>De,BaseDataWebPart:()=>Oe,BaseEmphasisComponentStyles:()=>Ge,BaseFirstPartyWebPart:()=>ve,BasicWebPartRTE:()=>W,CalculatedField:()=>je,CaptionElement:()=>b.Oy,CaptionElementAlignPosition:()=>b.bI,CaptionElementStylesContext:()=>xe.m,CaptionElementType:()=>b.Yk,CustomerPromiseUtilities:()=>Ie,DEFAULT_VIDEO_THUMBNAIL:()=>Wt,DateBox:()=>Ue,DateBoxSize:()=>Pe,DisplayFieldMap:()=>ze,DoughboyDetector:()=>at,EXTERNAL_FORCE_HIDE_TOOLBAR:()=>X,EditModeUtilitiesLoader:()=>Tt,FreshDataRenderFailure:()=>fe,LINK_FIELDNAME_SUFFIX:()=>Ve,LessText:()=>it,LivePersonaCard:()=>Mt,MappedField:()=>Be,MySiteWebPartCacheHelper:()=>ie,MySiteWebPartCacheManager:()=>le,OAuthErrorRenderer:()=>mt,OPEN_IN_NEW_TAB_LABEL:()=>Xt,OpenInNewTabToggle:()=>Zt,PageType:()=>g,Pagination:()=>D,Parallax:()=>vt,Placeholder:()=>ft,RefreshType:()=>Se,TextClamp:()=>ut,TopicCardHoverTarget:()=>Pt,WebPartChrome:()=>F,WebPartDataProvider:()=>Ce,WebPartTitle:()=>Z,WebViewUtility:()=>xt,_topActionsFieldConverter:()=>yt,_topActionsFieldsConverter:()=>St,boundHeadingLevel:()=>Y,clampElement:()=>lt,clampText:()=>dt,getCKHeadingLevelFromPlainHeadingLevel:()=>J,getDefaultTranspileThumbnail:()=>qt,getEmbedOverlay:()=>Ut,getHTMLTitleFromPlainText:()=>Q,getLinkTarget:()=>Qe,getPlainTextFromHTML:()=>q,getRelativeDateTimeStringForLists:()=>Ne,getUrlDataInterception:()=>qe,getUrlTarget:()=>We,handleItemNavigation:()=>Ke,isAmplifyHostType:()=>Gt,isCompanySharableVideoLink:()=>Qt,isEmailHostType:()=>Ft,isEmailOrTeamsHostType:()=>jt,isEmailOrTeamsOrVivaEngageHostType:()=>Vt,isExternalUrl:()=>Ye,isFluentVNextAllSpEnabled:()=>k.Ye,isMainCanvasHostType:()=>zt,isModifyFontSizeTitleHeadingsEnabled:()=>k._m,isNPSTextCoherencyEnabled:()=>k.yA,isODBFilePickerEnabled:()=>k.$9,isOpenInNewTabKSActive:()=>x.Ym,isPersonalCacheFlightEnabled:()=>k.ox,isRedeemableShareLink:()=>Dt,isSameDay:()=>Ee,isSharePointHostType:()=>Nt,isTeamsHostType:()=>Ht,isTeamsOrVivaEngageHostType:()=>Bt,isUpdateHTMLMigratedPropertiesKSctivated:()=>x.IY,isUseNewRequestWebPartCacheDataEnabled:()=>k.pD,isVivaEngageHostType:()=>Rt,isWebPartGroupEnabledCachingEnabled:()=>k.WE,isWebPartTitleHeadingsEnabled:()=>k.JU,redeemShareLink:()=>It,truncateText:()=>rt,useWebpartTitleStyles:()=>P,webPartPreviewThumbnail:()=>Xe});var e=T(5959),t=T(8398),n=T(4907),a=T(9676),i=T(2207),r=T(2141),o=T(3966),s=T(9331),c=T(8424);(0,c.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);class d extends e.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);d._getDedicatedDomNode(t||1).appendChild(n)}}static _getDedicatedDomNode(e){d._alertNode&&document.body.removeChild(d._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),d._alertNode=t,d._alertNode}componentDidMount(){d.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||d.read(this.props.message,this.props.readingMode)}render(){return!1}}var l=T(718),u=T(5519),f=T(6094),p=T(6575),m=T(95),_=T(7405),h=T(529),b=T(5977);const g={Default:0,Prev:1,Next:2};var v=T(8810);const y=JSON.parse('{"JW":"Page {0}","h6":"Previous","QA":"Next","T4":"Go to the {0} page, you are currently on page {1}.","WA":"Go to the {0} page."}');c.loadStyles('.P_X0Snn_-aI_E{border:1px solid transparent;margin:0;min-width:240px;padding:2px 0;position:relative;text-align:center;width:100%}.P_X0Snn_-aI_E .ms-Icon{line-height:inherit}[dir=ltr] .P_X0Snn_-aI_E [data-icon-name=ChevronLeft]{margin-left:0}[dir=ltr] .P_X0Snn_-aI_E [data-icon-name=ChevronRight],[dir=rtl] .P_X0Snn_-aI_E [data-icon-name=ChevronLeft]{margin-right:0}[dir=rtl] .P_X0Snn_-aI_E [data-icon-name=ChevronRight]{margin-left:0}.P_X0Snn_-aI_E button{cursor:pointer;cursor:hand;display:none;font-size:14px;font-weight:400;height:32px!important;margin:0 8px;outline:none;padding:8px 4px;position:relative}.P_X0Snn_-aI_E:not(.t_QJY9d_-aI_E) button:active{background:"[theme:white, default: #ffffff]"}.P_X0Snn_-aI_E .n_gNIkQ_-aI_E,.P_X0Snn_-aI_E .p_Av98X_-aI_E{border:none;display:inline-block;margin:0}.P_X0Snn_-aI_E .n_gNIkQ_-aI_E i,.P_X0Snn_-aI_E .p_Av98X_-aI_E i{margin:0 10px;position:relative;top:2px}.P_X0Snn_-aI_E .s_lNl9z_-aI_E{border-bottom:2px solid!important;color:"[theme:black, default: #000000]";cursor:default;height:20px;position:relative;top:-2px}.P_X0Snn_-aI_E .s_lNl9z_-aI_E.f_OE9Nl_-aI_E{border:1px dotted!important;border-bottom:3px solid!important}[dir=ltr] .n_GVeG-_-aI_E{text-align:left}[dir=rtl] .n_GVeG-_-aI_E{text-align:right}[dir=ltr] .n_GVeG-_-aI_E .n_gNIkQ_-aI_E{float:right}[dir=rtl] .n_GVeG-_-aI_E .n_gNIkQ_-aI_E{float:left}@media only screen and (min-width:640px){.P_X0Snn_-aI_E button{display:inline-block}}',!0);class S extends e.PureComponent{render(){const t=this.props.pageType===g.Prev,n=this.props.pageType===g.Next,a=(0,r.css)({"s_lNl9z_-aI_E":this.props.selected,"p_Av98X_-aI_E":t,"n_gNIkQ_-aI_E":n},this.props.className);return e.createElement(p.ActionButton,{className:a,ariaLabel:this._pageAriaLabel,disabled:this.props.disabled,onClick:this._handleClick,...this.props.onKeyDown?{onKeyDown:this._handleKeyDown}:{}},t&&e.createElement(r.Icon,{iconName:v.Locale.isRightToLeft?"ChevronRight":"ChevronLeft","aria-hidden":"true"}),this.props.text,n&&e.createElement(r.Icon,{iconName:v.Locale.isRightToLeft?"ChevronLeft":"ChevronRight","aria-hidden":"true"}))}get _pageAriaLabel(){let e;return e=this.props.pageNumber?this.props.pageType===g.Default?v.StringHelper.format(y.JW,this.props.pageNumber):v.StringHelper.format(y.T4,this.props.text,this.props.pageNumber):v.StringHelper.format(y.WA,this.props.text),e}constructor(...e){super(...e),this._handleClick=()=>{this.props.onClick(this.props.pageNumber,this.props.pageType)},this._handleKeyDown=e=>{this.props.onKeyDown(e,this.props.pageNumber,this.props.pageType)}}}class D extends e.PureComponent{render(){const t=(0,r.css)("P_X0Snn_-aI_E",{"n_GVeG-_-aI_E":!this.props.showPageNum,"t_QJY9d_-aI_E":!0},this.props.className);return 0===this.props.itemsCount?void 0:e.createElement("div",{className:t},this._pages)}get _pages(){const t=[],n=Math.ceil(this.props.itemsCount/this.props.itemsPerPage),a=this.props.pageLength;let i=this.props.currentPage;i<1&&(i=1),i>n&&(i=n);let r=Math.max(1,i-Math.floor(a/2)),o=Math.min(n,i+Math.floor(a/2));o-r+1<a&&(i<n/2?o=Math.min(n,a+r):r=Math.max(1,o-a)),o-r+1>a&&(i>n/2?r++:o--);const s=i-1>0?i-1:i,c=i===o?o:i+1;if(t.push(e.createElement(S,{className:this.props.pageClassName,key:y.h6+s,text:y.h6,pageType:g.Prev,pageNumber:this.props.showPageNum?s:void 0,selected:!1,disabled:this.props.showPageNum?1===i:!this.props.hasPrevPage,onClick:this._handleClick,...this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}})),this.props.showPageNum)for(let n=r;n<=o;n++){const a=`${n}`;t.push(e.createElement(S,{key:a+n,text:a,pageType:g.Default,pageNumber:n,selected:i===n,disabled:!1,onClick:this._handleClick,...this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}}))}return t.push(e.createElement(S,{key:y.QA+c,text:y.QA,pageType:g.Next,pageNumber:this.props.showPageNum?c:void 0,selected:!1,disabled:this.props.showPageNum?i===o:!this.props.hasNextPage,onClick:this._handleClick,...this.props.onPageChangeWithKeyDown?{onKeyDown:this._handleKeyDown}:{}})),t}constructor(...e){super(...e),this._handleClick=(e,t)=>{this.props.onPageChange(e,t)},this._handleKeyDown=(e,t,n)=>{this.props.onPageChangeWithKeyDown(e,t,n)}}}var I=T(9930),x=T(7547);class C{static getStyles(e){const{theme:t}=e,{semanticColors:n}=t;return{title:[{selectors:{"& span":{color:n.bodyText},"& textarea":{color:t.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:t.semanticColors.bodySubtext+" !important"}}}],add:[{color:n.bodyText,selectors:{"& .ms-Button-icon":{color:n.link},"&:hover .ms-Button-icon, &:active .ms-Button-icon, &:focus .ms-Button-icon":{color:n.linkHovered+" !important"},"& .ms-Button-label":{color:n.actionLink},"&:hover .ms-Button-label, &:active .ms-Button-label, &:focus .ms-Button-label":{color:n.actionLinkHovered+" !important"},"& .ms-Button-menuIcon":{color:n.bodySubtext},"&:hover .ms-Button-menuIcon, &:active .ms-Button-menuIcon, &:focus .ms-Button-menuIcon":{color:n.bodySubtext+" !important"},...(0,x.gG)()?{}:{"& .ms-Button-label":{...I.typographyStyles.body1Strong}}}}],addDisabled:[{color:n.disabledBodyText,...(0,x.TJ)()?{}:{"&.fui-Button":{selectors:{"&:hover":{color:n.disabledBodyText,backgroundColor:"unset"},"&:hover:active":{color:n.disabledBodyText,backgroundColor:"unset"}}}},"& .ms-Button-icon":{color:n.disabledBodyText},"& .ms-Button-menuIcon":{color:n.disabledBodyText},...(0,x.u4)()?{}:{"&, .ms-Button-icon, .ms-Button-menuIcon":{"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{color:"GrayText"}}},...(0,x.gG)()?{}:{"& .ms-Button-label":{...I.typographyStyles.body1Strong}}}],seeAll:[{color:n.link,selectors:{"&:hover, &:active":{color:n.linkHovered},"&:focus":{color:n.link}},...I.typographyStyles.body1Strong}],seeAllDisabled:[{color:n.disabledBodyText,...I.typographyStyles.body1Strong,selectors:{"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{color:"GrayText"}},"&:hover":{color:n.disabledBodyText}}]}}}C.getClassNames=(0,r.classNamesFunction)();var O=T(1013);class w extends O._DeferredComponent{_internalLoad(){return T.e(59).then(T.bind(T,5112)).then(e=>e.TeachingBubble)}}const E=JSON.parse('{"k5":"See all","VU":"See all {0} in the {1} webpart","Ox":"See all disabled","LQ":"Add","se":"Add an item","pG":"Close teaching bubble","ld":"The See All page for the {0} web part is opening.","zC":"Navigate back to the source page"}');c.loadStyles('.w_k_FZA_-aI_E{align-items:stretch;display:flex;flex-direction:column}.w_ciTNc_-aI_E{align-items:baseline;display:flex}.c_cRGMD_-aI_E{order:2;width:100%}.t_llPWu_-aI_E{flex-grow:1}[dir=ltr] .t_llPWu_-aI_E{margin-right:32px}[dir=rtl] .t_llPWu_-aI_E{margin-left:32px}.ms-Button.a_xMyye_-aI_E,.ms-Button.fui-Button.a_xMyye_-aI_E{border:0;height:auto;margin-bottom:23px}[dir=ltr] .ms-Button.a_xMyye_-aI_E,[dir=ltr] .ms-Button.fui-Button.a_xMyye_-aI_E{padding-left:0}[dir=rtl] .ms-Button.a_xMyye_-aI_E,[dir=rtl] .ms-Button.fui-Button.a_xMyye_-aI_E{padding-right:0}[dir=ltr] .ms-Button.a_xMyye_-aI_E .ms-Icon,[dir=ltr] .ms-Button.fui-Button.a_xMyye_-aI_E .ms-Icon{margin-left:0}[dir=rtl] .ms-Button.a_xMyye_-aI_E .ms-Icon,[dir=rtl] .ms-Button.fui-Button.a_xMyye_-aI_E .ms-Icon{margin-right:0}.ms-Button.a_FNKln_-aI_E,.ms-Button.fui-Button.ms-menuButtonShim.a_xMyye_-aI_E{background-color:transparent;height:35px}.ms-Button.a_FNKln_-aI_E{margin-bottom:5px;margin-top:-9px}.ms-Button.a_sGrhA_-aI_E .ms-Button-icon,.ms-Button.a_sGrhA_-aI_E:hover .ms-Button-label{color:"[theme:themePrimary, default: #0078d4]"}.s_j63Kf_-aI_E{white-space:nowrap}[dir=ltr] .s_j63Kf_-aI_E{margin-left:auto}[dir=rtl] .s_j63Kf_-aI_E{margin-right:auto}.s_j63Kf_-aI_E:focus{text-decoration-line:underline}.CanvasSection--edit .t_llPWu_-aI_E{flex-shrink:0}.s_ppzz8_-aI_E{margin-bottom:18px}.s_RRKRu_-aI_E{margin-bottom:11px}.s_uc2GX_-aI_E{margin-bottom:0}.f_betK3_-aI_E{background-color:#fff}.s_B0VJY_-aI_E{padding-right:2px}',!0);const A="t_llPWu_-aI_E",L="a_xMyye_-aI_E";var k=T(7728),M=T(606);const P=(0,M.makeStyles)({header:{"&.captionElement":{"& #CaptionElementView":{...I.typographyStyles.custom.webPartHeader,fontFamily:`var(--fontFamilyCustomFont1300, ${M.typographyStyles.subtitle1.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1300, ${M.typographyStyles.subtitle1.fontWeight})`},"& #CaptionElementEdit":{...I.typographyStyles.custom.webPartHeader,fontFamily:`var(--fontFamilyCustomFont1300, ${M.typographyStyles.subtitle1.fontFamily})`,fontWeight:`var(--fontWeightCustomFont1300, ${M.typographyStyles.subtitle1.fontWeight})`}}},multipleHeader:{"&.captionElement":{"& .headingLevel-2":{...I.typographyStyles.custom.title2},"& .headingLevel-3":{...I.typographyStyles.custom.title3},"& .headingLevel-4":{...I.typographyStyles.custom.subtitle1}}},multipleHeaderUpdated:{"&.captionElement":{"& .headingLevel-2":{...I.typographyStyles.custom.heading2},"& .headingLevel-3":{...I.typographyStyles.custom.heading3},"& .headingLevel-4":{...I.typographyStyles.custom.heading4},"& .headingLevel":{fontFamily:`var(--fontFamilyCustomFont1300, ${M.typographyStyles.subtitle1.fontFamily})`}}}}),U={iconName:"ChevronLeft"};class F extends r.BaseComponent{get _classNames(){const{theme:e}=this.props;return Boolean(e)&&C.getClassNames(C.getStyles,{root:"webPartChrome",theme:e})}componentDidMount(){this._isMounted=!0}componentWillUnmount(){this._isMounted=!1}render(){const{dataAutomationId:t,forceContrastBackground:n,seeAllLink:a,showTitle:i}=this.props,s=a&&a.show||i,c=e.createElement("div",{"data-automation-id":t,className:(0,r.css)("w_k_FZA_-aI_E",{"f_betK3_-aI_E":n})},e.createElement("div",{className:s?"w_ciTNc_-aI_E":"","data-automation-id":s?"webPartHeader":"",style:{minHeight:!(0,x.Ph)()&&s?"36px":"0"}},this._renderTitle(),this._renderSeeAllLink()),this._renderContent(),this._renderTeachingBubble());return this.props.theme?e.createElement(o.Customizer,{settings:this.state.settings},c):c}focusOnTitle(){this._captionElement&&this._captionElement.focusOnCaptionElement()}_renderTitle(){const{customTitle:t,isEditMode:n,onTitleChange:a,placeholder:i,showTitle:o,title:s,titleAlignment:c,isTitleEditable:d,isSeeAllPage:l,headingLevel:u}=this.props;let m;if(l){const t=new URL(window.location.href).searchParams.get("Page");t&&this._isSafeUrl(t)&&(m=e.createElement(f.TooltipHost,{content:E.zC},e.createElement(p.IconButton,{iconProps:U,href:t,ariaLabel:E.zC})))}return o?e.createElement(e.Fragment,null,m,t||e.createElement(b.Oy,{className:(0,r.css)(this._classNames&&this._classNames.title,A),ref:this._resolveRef("_captionElement"),type:b.Yk.Title,isEditMode:n,text:s,onChange:a||h.noop,placeholder:i,alignPosition:c||b.bI.PageDirection,headingLevel:(0,k.JU)()?u:_._DEFAULT_HEADING_LEVEL,marginBottomSize:this._titleMarginBottomSize,isTitleEditable:d,useWebpartTitleStyles:P})):e.createElement("div",{className:A})}_isSafeUrl(e){try{return 0===new URL(e).protocol.indexOf("http")}catch(e){return!1}}_renderContent(){const{contentElement:t,pagination:n,panelElement:a}=this.props;return e.createElement("div",{className:"c_cRGMD_-aI_E"},this._renderAddButton(),t,a,n&&e.createElement(D,n))}get _titleMarginBottomSize(){const{addButton:e,seeAllLink:t,showTitle:n,titleMarginBottomSize:a}=this.props;return void 0!==a?a:t&&t.show||n?e.show?"Middle":"Large":"None"}_renderSeeAllLink(){const t=this.props.seeAllLink;let n;switch(this._titleMarginBottomSize){case"Large":n="s_ppzz8_-aI_E";break;case"Middle":n="s_RRKRu_-aI_E";break;case"None":n="s_uc2GX_-aI_E"}const i=a.Text.format(E.VU,this.props.title||"",this.props.webPartAlias||"");return t&&t.show&&t.href&&e.createElement("span",{className:n,ref:this._resolveRef("_teachingBubbleTargetElement")},e.createElement(m.Link,{"aria-label":t.ariaLabel||(t.disabled?E.Ox:i),className:(0,r.css)(this._classNames&&(t.disabled?this._classNames.seeAllDisabled:this._classNames.seeAll),"s_j63Kf_-aI_E",!(0,x.B7)()&&"s_B0VJY_-aI_E"),disabled:t.disabled,onClick:this._handleClick,onKeyDown:this._handleSeeAllLinkKeyDown,"data-interception":"propagate","data-automation-id":t.automationId,id:t.id,"data-sp-action":t.action,href:t.href},t.label||E.k5))}_renderTeachingBubble(){const t=this.props.seeAllLink.teachingBubble;return this._showTeachingBubble&&!this.state.isTeachingBubbleDismissed?e.createElement(w,{deferredProps:{headline:t.headline,targetElement:this._teachingBubbleTargetElement,onDismiss:this._onDismissTeachingBubble,hasCloseIcon:!0,calloutProps:{doNotLayer:!1,gapSpace:2,isBeakVisible:!0,directionalHint:r.DirectionalHint.topAutoEdge},primaryButtonProps:t.primaryButtonProps,closeButtonAriaLabel:E.pG}},t.text):void 0}get _showTeachingBubble(){const{seeAllLink:e}=this.props;return Boolean(e&&e.teachingBubble&&e.teachingBubble.show)}_renderAddButton(){const t=this.props.addButton;if(!t||!t.show)return;const n={ariaLabel:t.ariaLabel||E.se,ariaDescription:t.ariaDescription,disabled:t.disabled,iconProps:{iconName:"CalculatorAddition"},label:t.label||E.LQ,"data-automation-id":t.automationId,"data-interception":"propagate"};return t.menuProps?e.createElement(p.DefaultButton,{...n,className:(0,r.css)(this._classNames?t.disabled?this._classNames.addDisabled:this._classNames.add:"a_sGrhA_-aI_E",L,"a_FNKln_-aI_E"),menuProps:t.menuProps,styles:{label:{fontWeight:400}}},n.label):e.createElement(p.ActionButton,{...n,className:(0,r.css)(this._classNames&&(t.disabled?this._classNames.addDisabled:this._classNames.add),L),href:t.href,onClick:t.onClick},n.label)}constructor(e){super(e),this._handleClick=e=>{const{seeAllLink:t,webPartAlias:n}=this.props;t.teachingBubble&&!this.state.isTeachingBubbleDismissed&&this._onDismissTeachingBubble(),(0,x.XA)()?l.ScreenReaderAlert.read(a.Text.format(E.ld,n||""),l.ReadingMode.ReadImmediately):d.read(a.Text.format(E.ld,n||""),2),t.onClick(e)},this._onDismissTeachingBubble=()=>{const{seeAllLink:e}=this.props;this._isMounted&&this.setState({isTeachingBubbleDismissed:!0}),e&&e.teachingBubble.onDismiss()},this._handleSeeAllLinkKeyDown=e=>{e.keyCode===r.KeyCodes.enter&&((0,x.XA)()?l.ScreenReaderAlert.read(a.Text.format(E.ld,this.props.webPartAlias||""),l.ReadingMode.ReadImmediately):d.read(a.Text.format(E.ld,this.props.webPartAlias||""),2))},this.state={isTeachingBubbleDismissed:!1,settings:{theme:e.theme}}}}F.defaultProps={isEditMode:!1,seeAllLink:{show:!1},addButton:{show:!1},contentElement:e.createElement("div",null)},F.getDerivedStateFromProps=(e,t)=>{let n=t;return(0,h.isEqual)(e.theme,t.settings.theme)||(n={...t,settings:{theme:e.theme}}),n};const H=JSON.parse('{"q7":"The page context is not provided by the host environment.","af":"The page context does not provide a web instance.","mg":"The page context does not provide a web identifier.","Qu":"The page context does not provide a site instance.","Kl":"The page context does not provide a site identifier.","Nt":"A data source is required.","xF":"Title","eq":"We didn\\u0027t find anything to show here.","E_":"A layout is required.","YJ":"Highlighted Content"}');c.loadStyles('.e_4934u_-aI_E{color:"[theme:neutralPrimary, default: #323130]"}.m_GvX20_-aI_E{margin-bottom:5px}.t_f9HwJ_-aI_E a::-moz-focus-inner,.t_f9HwJ_-aI_E button::-moz-focus-inner{border:0}.t_f9HwJ_-aI_E a,.t_f9HwJ_-aI_E button{outline:transparent;position:relative}.ms-Fabric.is-focusVisible .t_f9HwJ_-aI_E a:focus:after,.ms-Fabric.is-focusVisible .t_f9HwJ_-aI_E button:focus:after,.t_f9HwJ_-aI_E.ms-Fabric.is-focusVisible a:focus:after,.t_f9HwJ_-aI_E.ms-Fabric.is-focusVisible button:focus:after{background:initial;border:1px solid "[theme:neutralsecondary, default: #605e5c]";border-radius:inherit;content:"";inset:0;opacity:1;pointer-events:none;position:absolute;z-index:auto}.r_s2Jh2_-aI_E{width:100%}',!0);const R=(0,r.classNamesFunction)(),N=e=>{const t=e=>{switch(e){case"Large":return 18;case"Middle":return 11;default:return 0}};return e.variantTheme?{captionElement:[{selectors:{"& span":{color:e.variantTheme.semanticColors.bodyText},"& textarea":{color:e.variantTheme.semanticColors.bodyText+" !important"},"& textarea::placeholder":{color:e.variantTheme.semanticColors.bodySubtext+" !important"}}}],BasicWebPartRTE:{marginBottom:t(e.marginBottomSize)}}:{captionElement:void 0,BasicWebPartRTE:{marginBottom:t(e.marginBottomSize)}}},j=(0,e.lazy)(()=>Promise.all([T.e(468),T.e(623)]).then(T.bind(T,8124)).then(e=>({default:e.EditorialCardEditorToolbar}))),V=(0,e.forwardRef)((t,n)=>e.createElement(e.Suspense,{fallback:!1},e.createElement(j,{...t,ref:n})));V.displayName="DeferredEditorialCardEditorToolbar";var z=T(8414);class G extends O._DeferredComponent{_internalLoad(){return z.SPComponentLoader.loadComponentById("8404d628-4817-4b3a-883e-1c5a4d07892e").then(e=>e.WebPartRteCK5Only)}}const K=["PlainTableOutput","Table","TableEditing","sprteTableEditing","TableCaption","TableCellPropertiesEditing","TableColumnResize","TableColumnResizeEditing","TableClipboard","TableDropTargetPlugin","TableUtils","TableSelection","TableMouse","TableMovePlugin","TableKeyboard","TableSelectionPlugin","SprteTableBorderEditing","SprteTableCellEditing"];function W(t){const{content:n,isEditMode:i}=t,[o,s]=e.useState(!1),c=e.useRef(void 0),d=e.useRef(null),l=e.useRef(null),u=e.useRef(null);e.useEffect(()=>{i&&c.current&&n&&!(0,h.isEqual)(c.current.getHTML()||c.current.getText(),n)&&d.current?.tryUpdate(n,void 0)},[o,n,i]);const f=e.useCallback(e=>{t.enableDynamicToolbarObserver&&l.current&&(u.current&&u.current.disconnect(),u.current=new ResizeObserver(t=>{const n=t[0],{width:a}=n.contentRect;e(a)}),u.current.observe(l.current))},[t.enableDynamicToolbarObserver]),p=e.useCallback(e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation())},[]);return e.createElement("div",{className:(0,r.css)("R_PbHLj_-aI_E",t.className,t.removeRteTitleCssClass?void 0:"R_nADJx_-aI_E","rte-textcoherency-container"),ref:l,"data-automation-id":t.dataAutomationId||"BasicWebPartRTE",style:t.disableStyleWrapper?void 0:{"--rteFontColor":t.theme?.palette?.neutralPrimary}},e.createElement("div",{style:{width:n?void 0:"100%"},onKeyDown:t.preventNewLineOnEnter?p:void 0,"data-automation-id":t.isEditMode?"webPartTitleEditMode":"webPartTitleReadMode"},e.createElement(G,{deferredProps:{additionalPlugins:["ParagraphSpacing","LineHeight","PasteLinkAsPlainText"],ariaLabel:t.ariaLabel,consistentFontStylesForEditMode:!0,defaultCommands:t.defaultCommands,displayMode:i?a.DisplayMode.Edit:a.DisplayMode.Read,enableCustomFonts:!0,focusEditorOnMount:!1,hideToolbarOnFocusOut:!0,innerHTML:n||"",isSpellCheckEnabled:!0,isToolbarHotkeyPriorityEnabled:!0,onChanged:e=>{o&&t.onChanged?.(e)},onFormattingBarVisibilityChanged:t.onFormattingBarVisibilityChanged,onReadyCallback:e=>{c.current=e,s(!0),e&&t.onReadyCallback&&t.onReadyCallback(e)},onComponentDidMount:t.onComponentDidMount,placeholder:t.placeholder,ref:d,removeCorePlugins:["CopyPastePlugin","ImageEditing","TextPartLanguageEditing","PagePickerPlugin","LinkEditing","AutoLink",...K],serviceScope:t.serviceScope,shouldSignalEveryChange:!0,skipTextChangeCallbackWhenUpdateExternal:!0,styleOptions:{flexibleHeight:!0},toolbarConfiguration:{componentType:V,additionalProps:{className:(0,r.css)("rte-toolbar","w_wy54h_-aI_E"),...t.theme&&{themeProps:{themeVariant:t.theme}},onGetWidthSetter:t.enableDynamicToolbarObserver?f:void 0}},toolbarHostType:a._SPFlight.isEnabled(62189)?"EditorialCard":void 0,variantTheme:t.theme,webPartRteId:"textCoherencyWPRTE"}})))}function q(e){return e&&(new DOMParser).parseFromString(e,"text/html").body.textContent||""}function Q(e,t){if(!e||!e.trim())return"";const n=Y(t);return`<h${n} class="headingSpacingAbove headingSpacingBelow lineHeight1_4">${(0,k.JU)()&&t?e:`<span class="fontSizeXLarge">${e}</span>`}</h${n}>`}function Y(e){return Math.min(Math.max(e||_._DEFAULT_HEADING_LEVEL,2),4)}function J(e){return Y(e)-1}c.loadStyles(".R_nADJx_-aI_E .rte--ck5 .ck-content{padding:0!important}.R_PbHLj_-aI_E .rte--ck5{min-height:unset;padding-bottom:0!important}.R_PbHLj_-aI_E .rte--ck5 .ck-content{background-color:transparent!important;color:var(--rteFontColor);margin:0}.R_PbHLj_-aI_E .rte--ck5 .ck-content:not(:focus),.R_PbHLj_-aI_E .rte--ck5 .ck-content:not(:focus-visible){border-color:transparent!important}.R_PbHLj_-aI_E .rte--ck5 .rte-toolbar.w_wy54h_-aI_E{top:calc(var(--ck5wprte-toolbarTop) - 8px)!important;z-index:2}",!0);const X="forceHideToolbar";class Z extends e.Component{render(){const{alignPosition:t,className:n,edit:a,marginBottomSize:i,onTitleChange:o,placeholder:s,title:c,theme:d,ariaLabel:l,headingLevel:u,pageContext:f,maxLength:p,serviceScope:m,useRTETitle:h,disableStyleWrapper:g,defaultCommands:v,enableDynamicToolbarObserver:y,removeRteTitleCssClass:S}=this.props,D=h&&!!m,I=R(N,{variantTheme:d,marginBottomSize:D?i:void 0}),x=(0,r.css)(n,D?I.BasicWebPartRTE:I.captionElement),C={type:b.Yk.Title,isEditMode:a,isTitleEditable:this.props.isTitleEditable,text:c,onChange:o,placeholder:s,alignPosition:t,className:x,headingLevel:(0,k.JU)()?u:_._DEFAULT_HEADING_LEVEL,marginBottomSize:i,ariaLabel:l,pageContext:f,maxLength:p,useWebpartTitleStyles:P};return!(!a&&!c)&&(D?e.createElement(W,{ariaLabel:l,placeholder:s,isEditMode:a&&!1!==this.props.isTitleEditable,content:c,onComponentDidMount:this.props.onComponentDidMount,defaultCommands:v||[{commandName:"heading",options:{value:`heading${J(_._DEFAULT_HEADING_LEVEL)}`}},{commandName:"lineHeight",options:{value:1.4}}],onChanged:this._handleRteChange,serviceScope:m,theme:d,className:x,disableStyleWrapper:g,enableDynamicToolbarObserver:y,removeRteTitleCssClass:S,onFormattingBarVisibilityChanged:this._handleRteFormattingBarVisibilityChange,dataAutomationId:this.props.dataAutomationId||"captionElement",preventNewLineOnEnter:this.props.preventNewLineOnEnter}):e.createElement(b.Oy,{ref:this._captionElementRef,...C}))}value(){return this._captionElementRef.current.value()}focusOnWebPartTitle(){this._captionElementRef.current.focusOnCaptionElement()}constructor(t){super(t),this._handleRteChange=e=>{this.props.onTitleChange(e,void 0)},this._handleRteFormattingBarVisibilityChange=e=>{a._SPEventManager.instance.raiseEvent(X,{forceHide:e})},this._captionElementRef=e.createRef()}}Z.defaultProps={edit:!1,title:void 0,onTitleChange:h.noop,placeholder:void 0,className:void 0,alignPosition:b.bI.PageDirection,marginBottomSize:"None"};class $ extends r.BaseComponent{componentDidMount(){this._isMounted=!0;const{onComponentMounted:e}=this.props;!this._isDynamicLayout&&e&&e()}componentWillUnmount(){this._isMounted=!1,this._layoutContainerRef?.current&&(t.unmountComponentAtNode(this._layoutContainerRef.current),this._layoutContainerRef=void 0)}render(){const{addButton:t,defaultTitle:n,displayMode:o,emphasisTheme:s,errorCallback:c,hideWebPartWhenEmpty:d,isRenderedFromCacheData:l,paginationProps:u,panelElement:f,qosPrefix:p,seeAllLink:m,isTitleEditable:_,changeVisibility:h,isSeeAllPage:b,htmlTitleAdditionalCssClass:g}=this.props,v=new i._QosMonitor(`${p}ComponentRender`),y=this._renderEmptyResult(v),S=l?"BaseCollection-Cache":"BaseCollection-FreshData";let D;y||this._renderLayout();try{!d||!y||m&&m.show||o!==a.DisplayMode.Read?(D=e.createElement(r.Fabric,null,e.createElement(F,{addButton:t,contentElement:this._renderWebPartDisplay(y),dataAutomationId:S,forceContrastBackground:!1,isEditMode:o===a.DisplayMode.Edit,onTitleChange:this._handleTitleChange,pagination:u,panelElement:f,placeholder:n,ref:this._webPartChromeRef,seeAllLink:m,showTitle:this._shouldShowTitle,theme:s,title:this._title,isTitleEditable:_,isSeeAllPage:b,webPartAlias:this._webPartAlias,headingLevel:this._getHeadingLevel,customTitle:(0,k.yA)()&&this.props.useHtmlTitle&&this.props.serviceScope?e.createElement(Z,{className:(0,r.css)("r_s2Jh2_-aI_E",g),edit:o===a.DisplayMode.Edit,title:this.props.titleHTML?this.props.titleHTML:this.props.displayPlaceholderTitleInReadMode?n:"",placeholder:n,onTitleChange:this._handleTitleChange,marginBottomSize:"Large",theme:s,useRTETitle:(0,k.yA)(),serviceScope:this.props.serviceScope,headingLevel:this.props.headingLevel}):void 0}),this._dialogRef?e.createElement("div",{ref:this._dialogRef}):void 0),h?.(!0)):(D=!1,h?.(!1))}catch(e){c(e),v.writeUnexpectedFailure("FailedToRender",e)}return v.writeSuccess(),D}focusOnTitle(){const e=this._webPartChromeRef.current;e&&e.focusOnTitle()}get _hasEmptyResponse(){const{items:e}=this.props;return!!e&&e.length<1}get _emptyResponseText(){const{displayMode:e,hasInitialLoadingState:t,hideWebPartWhenEmpty:n,emptyResponseText:i}=this.props;if(this._hasEmptyResponse&&!t){if(n&&e===a.DisplayMode.Read)return;return i||H.eq}}_renderEmptyResult(t){const{errorCallback:n,hasInitialLoadingState:a,layoutInfo:i}=this.props;if(this._hasEmptyResponse&&!a)try{const t=i&&i.id||"",n=this.props.emphasisTheme?"":"e_4934u_-aI_E",a={color:this.props.emphasisTheme.palette.neutralPrimary};return e.createElement("span",{className:n,"data-automation-id":`${t}-no-results`,style:a},this._emptyResponseText)}catch(e){n(e),t.writeUnexpectedFailure("FailedToRenderEmptyResult")}}_renderLayout(){const{emphasisTheme:t,errorCallback:a,layoutInfo:r,onComponentMounted:s,qosPrefix:c}=this.props;u._PerformanceLogger.saveTempData(`${this.props.webPartTag}.loadLayoutStart`,u._PerformanceLogger.now());const d=new i._QosMonitor(`${c}ComponentRenderLayout`);this._isDynamicLayout=!0,r.loadLayout().then(a=>{if(!this._isMounted)return;u._PerformanceLogger.saveTempData(`${this.props.webPartTag}.loadLayoutEnd`,u._PerformanceLogger.now());let i=e.createElement(a,this.props);if(t){const n={settings:{theme:t}};i=e.createElement(o.Customizer,n,i)}const r=()=>{d.writeSuccess(),s&&s()};this._layoutContainerRef?.current?n.render(i,this._layoutContainerRef.current,r):r(),u._PerformanceLogger.saveTempData(`${this.props.webPartTag}.syncLayoutRenderComplete`,u._PerformanceLogger.now())}).catch(e=>{a(e),d.writeUnexpectedFailure("FailedToRenderLayout",e)})}get _webPartAlias(){const{webPartTag:e}=this.props,t=e.split(".")[1];return"ContentRollupWebPart"===t?H.YJ:t}get _title(){const{defaultTitle:e,displayMode:t,displayPlaceholderTitleInReadMode:n,title:i}=this.props;return t===a.DisplayMode.Read&&n&&!i?e:i||""}get _shouldShowTitle(){const{displayMode:e,hasInitialLoadingState:t,showTitle:n}=this.props,i=t||!this._hasEmptyResponse||Boolean(this._emptyResponseText);return n&&e===a.DisplayMode.Edit||i&&n&&!!this._title}get _getHeadingLevel(){const{headingLevel:e}=this.props;return(0,k.JU)()?e:void 0}_renderWebPartDisplay(t){const{addToPageScreenReaderLabel:n,displayMode:i,messageView:r,renderedOnce:o}=this.props;return e.createElement("div",null,i===a.DisplayMode.Edit&&!o&&n&&((0,x.XA)()?e.createElement(l.ScreenReaderAlert,{readingMode:l.ReadingMode.ReadImmediately,message:n}):e.createElement(d,{readingMode:2,message:n})),r&&e.createElement(s.MessageBar,{className:"m_GvX20_-aI_E",ariaLabel:r.ariaLabel,messageBarType:r.messageBarType},r.message),t||e.createElement("div",{ref:this._layoutContainerRef}))}constructor(t){super(t),this._webPartChromeRef=e.createRef(),this._isMounted=!1,this._handleTitleChange=e=>{this.props.onTitleChange(e)},this._layoutContainerRef=e.createRef()}}var ee=T(1962),te=T(7408),ne=T(1909);const ae="/_api/SP.UserProfiles.PersonalCache";class ie{static getRemoteSubfolderCreateUrl(e,t,n,i){a.Validate.isNonemptyString(e,"currentWebAbsoluteUrl"),a.Validate.isNonemptyString(t,"remoteWebAbsoluteUrl"),a.Validate.isNonemptyString(n,"remoteParentFolderRelativeUrl"),a.Validate.isNonemptyString(i,"remoteFolderName");const r=v.UriEncoding.encodeRestUriStringToken(t),o=v.UriEncoding.encodeRestUriStringToken(n),s=v.UriEncoding.encodeRestUriStringToken(i);return v.Uri.concatenate(v.Uri.concatenate(v.Uri.concatenate(e,"/_api/SP.RemoteWeb(@remoteWeb)"),"/Web/GetFolderByServerRelativePath(DecodedUrl=@parentFolderRelativeUrl)"),"/AddSubFolder(@subfolderTitle)")+`?@remoteWeb='${r}'`+`&@parentFolderRelativeUrl='${o}'`+`&@subfolderTitle='${s}'`}static getUrlLastSegment(e){return a.Validate.isNonemptyString(e,"url"),new v.Uri(e).getLastPathSegment()}static getUrlWithoutLastSegment(e){a.Validate.isNonemptyString(e,"url");const t=e.lastIndexOf("/");return t>-1?e.substring(0,t):e}static getPersonalCacheItemCreateUrl(e){a.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");const t=(0,k.ox)()?"/ReadCacheOrCreate2":"/ReadCacheOrCreate";return v.Uri.concatenate(v.Uri.concatenate(e,ae),t)}static getPersonalCacheItemUpdateUrl(e){a.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");const t=(0,k.ox)()?"/WriteCache2":"/WriteCache";return v.Uri.concatenate(v.Uri.concatenate(e,ae),t)}static getPersonalCacheItemDeleteUrl(e){a.Validate.isNonemptyString(e,"currentWebAbsoluteUrl");const t=(0,k.ox)()?"/DeleteCacheItemsAsync2":"/DeleteCacheItemsAsync";return v.Uri.concatenate(v.Uri.concatenate(e,ae),t)}static dateTimeStringToJsDate(e){a.Validate.isNonemptyString(e,"dateTime");const t=e.split(/[^0-9]/);return t.length<6?void 0:new Date(Date.UTC(Number(t[0]),Number(t[1])-1,Number(t[2]),Number(t[3]),Number(t[4]),Number(t[5])))}static checkStatus(e){return a.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))}static checkFolderStatus(e){return a.Validate.isNotNullOrUndefined(e,"response"),e.status>=200&&e.status<300||500===e.status?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))}static getCreatePersonalCacheItemBody(e,t,n){a.Validate.isNonemptyString(e,"listRelativeFolderPath"),a.Validate.isNotNullOrUndefined(t,"items");let i="";t.forEach(e=>{""!==i&&(i+=", "),i+=e.CacheKey});const r={folderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:`${e}`},requiredCacheKeys:[`${i}`],createIfMissing:!0};return n&&(0,k.ox)()&&(r.mySiteUrl=n),r}static getReadPersonalCacheItemBody(e,t,n){a.Validate.isNonemptyString(e,"listRelativeFolderPath"),a.Validate.isNotNullOrUndefined(t,"instanceIds");const i={folderPath:{__metadata:{type:"SP.ResourcePath"},DecodedUrl:`${e}`},requiredCacheKeys:t,createIfMissing:!1};return n&&(0,k.ox)()&&(i.mySiteUrl=n),i}static getUpdatePersonalCacheItemsBody(e,t,n){a.Validate.isNotNullOrUndefined(e,"items");const i=[];e.forEach(e=>{n&&(e.CacheValue=""),i.push(e)});const r={cacheItems:i};return t&&(0,k.ox)()&&(r.mySiteUrl=t),r}static post(e,t,n,i){return a.Validate.isNotNullOrUndefined(e,"spHttpClient"),a.Validate.isNonemptyString(t,"url"),a.Validate.isNotNullOrUndefined(n,"body"),e.post(t,ne.SPHttpClient.configurations.v1,{body:JSON.stringify(n),headers:{"OData-Version":"3.0"}}).then(i)}static generateHash(e){return(0,l.Md5Hash)(e)}static getDateNowAsUTC(){const e=new Date;return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds()))}static addSecondsToDate(e,t){a.Validate.isNotNullOrUndefined(e,"date"),a.Validate.isNotNullOrUndefined(t,"seconds");const n=new Date(e.toString());return n.setTime(n.getTime()+1e3*t),n}static isExpired(e,t,n){return e&&t&&n&&n>0&&e>ie.addSecondsToDate(t,n)}}const re="2.0",oe="1.5",se="MySiteWebPartCacheDataProvider.",ce="MySiteWebPartCacheDataProvider";class de{static _increaseLateFlushKS(){return a._SPKillSwitch.isActivated("ab30cf50-82cc-4361-9270-edce465b67d7")}get currentListRelativeFolderPath(){return this._currentListRelativeFolderPath}get currentWebAbsoluteUrl(){return this._currentWebAbsoluteUrl}get mySiteAbsoluteUrl(){return this._mySiteAbsoluteUrl}get hasFlushCompleted(){return this._hasFlushCompleted}get initializeFromLateFlush(){return this._initializeFromLateFlush}set currentPageCacheFolderKey(e){this._currentPageCacheFolderKey=e,this._currentListRelativeFolderPath=this._getListRelativeFolderPath()}getCacheItemVersion(e){return this._cacheItemVersionMap.get(e)}getWebPartIdLogObject(e,t,n,a){return{alias:e,instanceId:t,isSmartRaceEnabled:this._isMySiteCacheSmartRaceRefactorEnabled(),cacheStatus:n,serverStatus:a}}_internalAdvancedGetCachedData(e,t){const n=this._getCachedItem(e);if(n&&n.hash===t)return JSON.parse(n.result)}_internalAdvancedSetCacheData(e,t,n){this._tryUpdateCache(e.instanceId,e.manifest.alias,n,t)}getWebPartData(e,t,n,r,o,s=!0,c=-1,d){a.Validate.isNotNullOrUndefined(e,"requestData"),a.Validate.isNotNullOrUndefined(t,"dataUpdated"),a.Validate.isNotNullOrUndefined(n,"config"),a.Validate.isNonemptyString(r,"webPartInstanceId"),a.Validate.isNonemptyString(o,"webPartAlias");const l=new i._QosMonitor(se+"getWebPartData");let u,f="";const p=this._getCachedItem(r),m=ie.generateHash(JSON.stringify(n));d=d||`WebPart.${o}.internal.${r}`,this._logCacheStart(r,d,"MySiteWebPartCacheDataProvider.GetWebPartData"),this._captureCacheKeyUsageTelemetry(o,m);const _=!!p&&m!==p.hash;if(!p||_){this._logCacheMiss(d),this._logConfigMismatch(d,p,!_);const a=e(),h=a.then(e=>{i._TraceLogger.logVerbose(de._logSource,`CacheMiss: Requested cached item for ${d} doesn't exist. Creating.`),u=e,f=JSON.stringify(u),this._tryUpdateCache(r,o,f,m,p?p.id:void 0),l.writeSuccess(this.getWebPartIdLogObject(o,r))}).catch(e=>{i._TraceLogger.logError(de._logSource,e,`getWebPartData: error while processing non-cached item for ${d}.`),l.writeUnexpectedFailure("NewItemRequestSaveRenderError",e,this.getWebPartIdLogObject(o,r))}).then(()=>u);if(this._hasFlushCompleted)return h;this._logLateFlush(d);const b=this._initializeFromLateFlush.then(()=>this._getCachedItem(r)).then(e=>this._canUseCachedData_deprecated(e,n,c)?this._returnCachedDataWithRefresh(e,()=>a,t,n,r,o,l,m,s,c):(i._TraceLogger.logVerbose(de._logSource,`Late flush resulted in a miss ${o}.${r}`),h));return Promise.race([b,h])}if(ie.isExpired(this._utcTimeStamp,p.modified,c))return this._logCacheExpired(d),e().then(e=>{u=e,f=JSON.stringify(u),this._tryUpdateCache(r,o,f,m,p.id),l.writeSuccess(this.getWebPartIdLogObject(o,r))}).catch(e=>{i._TraceLogger.logError(de._logSource,e,`getWebPartData: error while processing cached WebPart item ${r}.`),l.writeUnexpectedFailure("ExpiredCacheUpdateError",e,this.getWebPartIdLogObject(o,r))}).then(()=>u);try{if(m===p.hash)return this._returnCachedDataWithRefresh(p,e,t,n,r,o,l,m,s,c)}catch(e){i._TraceLogger.logError(de._logSource,e,`getWebPartData: error while processing cache item request for ${d}.`),l.writeUnexpectedFailure("CachedItemUpdateError",e,this.getWebPartIdLogObject(o,r))}finally{return this._logCacheHit(d),Promise.resolve(JSON.parse(p.result))}}getCacheData(e){const{dataUpdated:t,serializedConfiguration:n,webPartAlias:i,webPartInstanceId:r,secondsToInvalidate:o}=e,{requestData:s}=e;a.Validate.isNotNullOrUndefined(s,"requestData"),a.Validate.isNotNullOrUndefined(t,"dataUpdated"),a.Validate.isNotNullOrUndefined(n,"serializedConfiguration"),a.Validate.isNonemptyString(i,"webPartAlias"),a.Validate.isNonemptyString(r,"webPartInstanceId");const c=this._getCachedItem(r),d=ie.generateHash(n),u=`WebPart.${i}.internal.${r}`;this._logCacheStart(r,u,"MySiteWebPartCacheDataProvider.GetCacheData");const f={cacheResponseType:l.CacheResponseType.ServerData,serverResponseAsync:Promise.reject().catch(e=>e)};if(f.serverResponseAsync=this._tryUpdateCacheAsync(s,t,i,r,d),this._canUseCachedData(c,d,o,u))return f.cacheResponseType=l.CacheResponseType.CachedData,f.cacheResponseAsync=Promise.resolve(JSON.parse(c.result)),Promise.resolve(f);if(this._logCacheMiss(u),!this._hasFlushCompleted){this._logLateFlush(u);const e=this._initializeFromLateFlush.then(()=>this._getCachedItem(r)).then(e=>(this._canUseCachedData(e,d,o,u)&&(f.cacheResponseType=l.CacheResponseType.CachedData,f.cacheResponseAsync=Promise.resolve(JSON.parse(e.result))),Promise.resolve(f))),t=a.Guid.parse("f45cfbcb-6bff-4e57-93d9-5427a620ab01"),n=a.Guid.parse("4bba5b4c-4f1a-4639-9512-3abc0226331a"),i=[{raceablePromise:e.then(e=>e.cacheResponseAsync||e.serverResponseAsync),raceId:t},{raceablePromise:f.serverResponseAsync,raceId:n}];return l.SmartRace.race(i).then(e=>({cacheResponseType:e.raceId===t?l.CacheResponseType.CachedData:l.CacheResponseType.ServerData,cacheResponseAsync:e.raceId===t?e.raceablePromise:void 0,serverResponseAsync:f.serverResponseAsync})).catch(e=>{throw this._logSmartRaceError(e),e})}return f.cacheResponseType=l.CacheResponseType.ServerData,Promise.resolve(f)}_tryUpdateCacheAsync(e,t,n,a,i){return e().then(e=>{t&&t(e);const r=JSON.stringify(e);return this._tryUpdateCache(a,n,r,i),e})}_canUseCachedData(e,t,n,a){const i=!!e&&(e.hash===t||e.cacheVersion===re);if(this._logConfigMismatch(a,e,i),e&&(e.result||(0,x.B2)())){const t=ie.isExpired(this._utcTimeStamp,e.modified,n);if(t&&this._logCacheExpired(a),i&&!t)return this._logCacheHit(a),!0}return!1}_canUseCachedData_deprecated(e,t,n=-1){return!(!e||e.hash!==ie.generateHash(JSON.stringify(t))&&e.cacheVersion!==re||ie.isExpired(this._utcTimeStamp,e.modified,n))}_returnCachedDataWithRefresh(e,t,n,r,o,s,c,d,l=!0,u=-1){let f,p="";if(i._TraceLogger.logVerbose(de._logSource,`Found cached item ${o} with matching config.`),t().then(t=>{f=t,p=JSON.stringify(f),e.result!==p?(i._TraceLogger.logVerbose(de._logSource,`Requested item ${o} has newer results; updating.`),this._saveRenderAndUpdateItem(n,l,f,o,s,p,d,e.id),c.writeSuccess(this.getWebPartIdLogObject(s,o)),this._logCacheMatchApiResult(s,!1)):(i._TraceLogger.logVerbose(de._logSource,`Requested cached item ${o} has matching result; No write back.`),c.writeSuccess(this.getWebPartIdLogObject(s,o)),this._logCacheMatchApiResult(s,!0))}).catch(e=>{i._TraceLogger.logError(de._logSource,e,`getWebPartData: error while processing cached WebPart item ${o}.`),c.writeUnexpectedFailure("CachedItemUpdatedResultError",e,this.getWebPartIdLogObject(s,o))}),a._SPKillSwitch.isActivated("0fe47b1a-30bf-4b3f-996e-2fe421296166"))return Promise.resolve(JSON.parse(e.result));{const t={...JSON.parse(e.result),isFromCustomCache:!0};return Promise.resolve(t)}}_logCacheMatchApiResult(e,t){i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("MySiteWebPartValidCache_deprecated",e,i._LogType.Event,{CacheMatchApiResult:t?"Match":"Not match"}))}_saveRenderAndUpdateItem(e,t,n,i,r,o,s,c){a.Validate.isNotNullOrUndefined(e,"dataUpdated"),a.Validate.isNotNullOrUndefined(t,"rerender"),a.Validate.isNotNullOrUndefined(n,"response"),a.Validate.isNonemptyString(i,"webPartInstanceId"),a.Validate.isNonemptyString(r,"webPartAlias"),a.Validate.isNonemptyString(o,"rawResponseString"),a.Validate.isNonemptyString(s,"webPartHash"),a.Validate.isNotNullOrUndefined(c,"cacheItemId"),t&&e(n),this._updateCache(i,r,o,s,c)}_tryInitializeSynchronously(){const e=new i._QosMonitor(se+"_initialize"),t=`Page ${this._currentPageCacheFolderKey} is missing _spPageContextInfo.`,n=`Page ${this._currentPageCacheFolderKey} has not yet gotten the LKG flush.`;this._pageContext?(this._getPrefetchedPageContextProperties(this._pageContext.legacyPageContext),this._tryInitializeFromPage()?(this._hasInitializedSynchronously=!0,u._PerformanceLogger.markComponent(ce,"SyncFlushCompleted"),e.writeSuccess()):(u._PerformanceLogger.markComponent(ce,"DelayedFlush"),i._TraceLogger.logError(de._logSource,new Error,n),e.writeExpectedFailure("DelayedFlush",new Error))):(u._PerformanceLogger.markComponent(ce,"SyncMissingContextInfo"),i._TraceLogger.logError(de._logSource,new Error,t),e.writeUnexpectedFailure("SPPageContextInfoError",new Error))}_tryInitializeFromPage(){return!!this._hasFlushCompleted||(window._spWebPartData&&(this._getPrefetchedWebPartDataProperties(window._spWebPartData.Properties),this._getPrefetchedWebPartDataItems(window._spWebPartData.Items),this._hasFlushCompleted=!0),this._hasFlushCompleted)}_getCachedItem(e){return this._cacheItemsMap.get(e)}_getPrefetchedWebPartDataProperties(e){a.Validate.isNotNullOrUndefined(e,"data"),this._mySiteAbsoluteUrl=e.MySiteUrl,this._currentPageCacheFolderKey=e.PageCacheFolderKey,this._webPartCachePath=e.WebPartCachePath,e.UtcTimeStamp&&(this._utcTimeStamp=ie.dateTimeStringToJsDate(e.UtcTimeStamp)),this._currentListRelativeFolderPath=this._getListRelativeFolderPath()}_getPrefetchedPageContextProperties(e){a.Validate.isNotNullOrUndefined(e,"data"),a.Validate.isNonemptyString(e.webAbsoluteUrl,"data.webAbsoluteUrl"),this._currentWebAbsoluteUrl=e.webAbsoluteUrl}_getPrefetchedWebPartDataItems(e){a.Validate.isNotNullOrUndefined(e,"data"),Object.keys(e).forEach(t=>{const n={webPartInstanceId:t,result:e[t].Value,hash:e[t].HashCode,id:Number(e[t].ID),uniqueId:a.Guid.parse(e[t].UniqueId),modified:ie.dateTimeStringToJsDate(e[t].Modified),cacheVersion:e[t].CacheVersion};if(n.cacheVersion===oe||n.cacheVersion===re){let a,i="";try{a=JSON.parse(e[t].AltTitle),i=a.id}catch(n){i=e[t].AltTitle}n.webPartInstanceId=i,this._cacheItemVersionMap.set(i,n.cacheVersion),this._cacheItemsMap.set(i,n)}else this._cacheItemVersionMap.set(t,n.cacheVersion),this._cacheItemsMap.set(t,n)}),this._logCacheItemSize()}_ensureFlush(){return this._hasFlushCompleted?Promise.resolve():this._initializeFromLateFlush}_createRemoteCacheItem(e,t,n){a.Validate.isNonemptyString(e,"title"),a.Validate.isNonemptyString(t,"value"),a.Validate.isNonemptyString(n,"hash");const i=[],r={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:void 0,ListItemUniqueId:void 0,CacheVersion:void 0,CacheKey:e,ModifiedTimeUtc:void 0,ContainerUrl:void 0,CacheName:void 0};return i.push(r),this._ensureFlush().then(()=>this._createPersonalCacheItemsAPI(this._currentListRelativeFolderPath,i)).then(e=>{if(e)return this._createLocalCacheItemFromServerResponse(e)})}_createPersonalCacheItemsAPI(e,t){a.Validate.isNonemptyString(e,"listRelativeFolderPath"),a.Validate.isNotNullOrUndefined(t,"items");const n=ie.getPersonalCacheItemCreateUrl(this._currentWebAbsoluteUrl),i=ie.getCreatePersonalCacheItemBody(e,t,this._mySiteAbsoluteUrl);return ie.post(this._spHttpClient,n,i,ie.checkStatus).then(e=>e.json()).then(e=>{a.Validate.isNotNullOrUndefined(e,"data");const n=t[0],i=[],r={AltTitle:void 0,CacheValue:n.CacheValue,CacheValueHash:n.CacheValueHash,ListItemId:e.value[0].ListItemId,ListItemUniqueId:e.value[0].ListItemUniqueId,CacheVersion:"1.0",CacheKey:n.CacheKey,ModifiedTimeUtc:e.value[0].ModifiedTimeUtc,ContainerUrl:void 0,CacheName:void 0};(0,x.ey)()||(r.ContainerUrl=e.value[0].ContainerUrl,r.CacheName=e.value[0].CacheName),i.push(r),this._createLocalItems(i),this._addItemToBeUpdated(this._currentWebAbsoluteUrl,r)})}_updateRemoteCacheItem(e,t,n,i){a.Validate.isNonemptyString(e,"cacheKey"),a.Validate.isNonemptyString(n,"hash"),a.Validate.isNotNullOrUndefined(i,"itemID"),t||(t="");const r={AltTitle:void 0,CacheValue:t,CacheValueHash:n,ListItemId:i,ListItemUniqueId:void 0,CacheVersion:"1.0",CacheKey:e,ModifiedTimeUtc:void 0,ContainerUrl:void 0,CacheName:void 0};return(0,x.ey)()||(r.ContainerUrl=this._currentListRelativeFolderPath),this._cacheItemVersionMap.get(e)===re&&(r.AltTitle=JSON.stringify({id:e}),r.CacheVersion=oe),[].push(r),this._addItemToBeUpdated(this._currentWebAbsoluteUrl,r),Promise.resolve()}_addItemToBeUpdated(e,t){if(de._itemsToDeferUpdate.has(e)){const n=de._itemsToDeferUpdate.get(e),a=(0,h.findIndex)(n,e=>t.CacheKey===e.CacheKey);a>=0?n[a]=t:n.push(t)}else de._itemsToDeferUpdate.set(e,[t])}_updateCache(e,t,n,r,o){a.Validate.isNonemptyString(e,"webPartInstanceId");const s=e,c=new i._QosMonitor(se+"_updateCache");let d="UnknownError";const l=this._getCachedItem(s);if(l&&l.hash===r&&l.result===n)return d="NoOp",void c.writeExpectedFailure(d,void 0,this.getWebPartIdLogObject(t,e));try{let a;this._cacheItemsMap.has(s)?(i._TraceLogger.logVerbose(de._logSource,`Updating Cache Item ${s}.`),d="UpdateCacheItemError",void 0===o&&(o=this._getCachedItem(s).id),a=this._updateRemoteCacheItem(s,n,r,o)):(i._TraceLogger.logVerbose(de._logSource,`Creating Cache Item ${s}.`),d="CreateCacheItemError",a=this._createRemoteCacheItem(s,n,r)),a.then(()=>{c.writeSuccess(this.getWebPartIdLogObject(t,e))}).catch(n=>{i._TraceLogger.logError(de._logSource,n,`_updateCache: ${d} WebPart: ${e} Page: ${this._currentPageCacheFolderKey}`),c.writeUnexpectedFailure(d,n,this.getWebPartIdLogObject(t,e))})}catch(n){c.writeUnexpectedFailure(d,n,this.getWebPartIdLogObject(t,e))}}_tryUpdateCache(e,t,n,a,r){try{this._updateCache(e,t,n,a,r)}catch(t){i._TraceLogger.logError(de._logSource,t,`getWebPartData: error while processing item ${e}.`)}}_createLocalCacheItemFromServerResponse(e){a.Validate.isNotNullOrUndefined(e,"response");const t=new i._QosMonitor(se+"_createCacheItemInMap");let n,r="UnknownError";return e.json().then(i=>{let o,s,c,d,l,u,f;a.Validate.isNotNullOrUndefined(i,"data"),a.Validate.isNotNullOrUndefined(i.value,"data.value");const p=ie.getDateNowAsUTC();if(r="ResponseParseError",Object.keys(i.value).forEach(e=>{switch(u=i.value[e].FieldName,f=i.value[e].FieldValue,u){case"Id":s=+f;break;case"Title":n=f;break;case"AltTitle":o=f;break;case"HashCode":c=f;break;case"CacheVersion":d=f;break;case"Value":l=f}}),r="CreateCacheItemMapError",!this._cacheItemsMap.has(n)){const e={webPartInstanceId:n,result:l,hash:c,id:s,modified:p,cacheVersion:d};e.cacheVersion===oe||e.cacheVersion===re?(e.webPartInstanceId=o,this._cacheItemVersionMap.set(o,e.cacheVersion),this._cacheItemsMap.set(o,e)):(this._cacheItemVersionMap.set(n,e.cacheVersion),this._cacheItemsMap.set(n,e))}return this._logCacheItemSize(),t.writeSuccess(),e}).catch(e=>(i._TraceLogger.logError(de._logSource,e,`_createCacheItemInMap: error client caching response for WebPart: ${n}`),t.writeUnexpectedFailure(r,e),Promise.resolve(void 0)))}_getListRelativeFolderPath(){a.Validate.isNonemptyString(this._webPartCachePath,"this._webPartCachePath"),a.Validate.isNonemptyString(this._currentPageCacheFolderKey,"this._currentPageCacheFolderKey");const e=ie.getUrlLastSegment(this._webPartCachePath);return v.Uri.concatenate(e,this._currentPageCacheFolderKey)}_createLocalItems(e){e.forEach(e=>{if(!this._cacheItemsMap.has(e.CacheKey)){const t={webPartInstanceId:e.CacheKey,result:e.CacheValue,hash:e.CacheValueHash,id:e.ListItemId,modified:e.ModifiedTimeUtc,cacheVersion:e.CacheVersion};this._cacheItemsMap.set(e.CacheKey,t)}}),this._logCacheItemSize()}_updateLocalItems(e){e.forEach(e=>{if(this._cacheItemsMap.has(e.CacheKey)){const t=this._getCachedItem(e.CacheKey);t.result=e.CacheValue,t.hash=e.CacheValueHash,t.cacheVersion=e.CacheVersion}}),this._logCacheItemSize()}_logCacheItemSize(){i._TraceLogger.logVerbose(de._logSource,`_cacheItemsMap Size: ${this._cacheItemsMap.size}.`)}_captureCacheKeyUsageTelemetry(e,t){new i._QosMonitor("MySiteWebPartCacheConfigHash").writeSuccess({alias:e,id:this._currentPageCacheFolderKey,instanceId:t})}_logCacheStart(e,t,n){i._TraceLogger.logVerbose(de._logSource,`WebPart: ${e}, Page: ${this._currentPageCacheFolderKey}, Environment: ${a.Environment.type}.`),i._EngagementLogger.logEvent(n),u._PerformanceLogger.markComponent(t,"CacheStart")}_logConfigMismatch(e,t,n){t?n||(i._TraceLogger.logVerbose(de._logSource,`Cache config mismatch for ${e}`),u._PerformanceLogger.markComponent(e,"CacheMissConfigMismatch")):(i._TraceLogger.logVerbose(de._logSource,`Cached data not found for ${e}`),u._PerformanceLogger.markComponent(e,"CachedWebPartNotFound"))}_logCacheHit(e){this._setLKGOnTimeState(!0,"true"),i._TraceLogger.logVerbose(de._logSource,`CacheHit: Returning cached item for ${e}.`),u._PerformanceLogger.markComponent(e,"CacheHit")}_logCacheExpired(e){this._setLKGOnTimeState(!0,"stale"),i._TraceLogger.logVerbose(de._logSource,`Requested cached item for ${e} exists but is expired.`),u._PerformanceLogger.markComponent(e,"CacheExpired"),this._logCacheMiss(e)}_logCacheMiss(e){this._setLKGOnTimeState(!1,"false"),i._TraceLogger.logVerbose(de._logSource,`Cache Miss for ${e}`),i._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.CacheMiss"),u._PerformanceLogger.markComponent(e,"CacheMiss")}_logLateFlush(e){this._setLKGOnTimeState(!1,"false"),i._TraceLogger.logVerbose(de._logSource,`Racing between late flush and data fetch for ${e}`),u._PerformanceLogger.markComponent(e,"LateFlush")}_setLKGOnTimeState(e,t){void 0===this._cacheOnTime&&(this._cacheOnTime=e,u._PerformanceLogger.setPerformanceProperty("lkgOnTime",t))}_logSmartRaceError(e){i._TraceLogger.logError(de._logSource,e)}_isMySiteCacheSmartRaceRefactorEnabled(){return a._SPFlight.isEnabled(1549)}constructor(e){this._cacheItemsMap=new Map,this._cacheItemVersionMap=new Map,this._hasFlushCompleted=!1,this._hasInitializedSynchronously=!1,this._updateRemoteCacheItemsAPI=(e,t)=>{a.Validate.isNotNullOrUndefined(e,"absoluteUrl"),a.Validate.isNotNullOrUndefined(t,"items");const n="_writeCache",r=new i._QosMonitor(se+n);u._PerformanceLogger.startMarkForComponent(n),this._updateLocalItems(t);const o=ie.getPersonalCacheItemUpdateUrl(e),s=ie.getUpdatePersonalCacheItemsBody(t,this._mySiteAbsoluteUrl);let c={};return c={count:t.length,dataSizeInKB:JSON.stringify(t).length/1024},ie.post(this._spHttpClient,o,s,ie.checkStatus).then(e=>(r.writeSuccess(c),u._PerformanceLogger.endMarkForComponent(n),e)).catch(e=>(r.writeUnexpectedFailure("WriteCacheError",e,c),u._PerformanceLogger.endMarkForComponent(n),Promise.reject(e)))},this._updateRemotePersonalCacheItems=()=>{de._itemsToDeferUpdate.size>0&&(de._itemsToDeferUpdate.forEach((e,t)=>{this._updateRemoteCacheItemsAPI(t,e).catch(e=>i._TraceLogger.logError(de._logSource,e,"UpdateRemoteCacheItems"))}),de._itemsToDeferUpdate.clear())},this._remoteUpdater=e=>{this._updateRemotePersonalCacheItems(),e||(this._writeCacheTimer=this._async.setTimeout(this._remoteUpdater,1e4))},this._hookUnloadEvent=()=>{window.addEventListener("beforeunload",this._emergencyUpload)},this._unhookUnloadEvent=()=>{window.removeEventListener("beforeunload",this._emergencyUpload)},this._emergencyUpload=()=>{this._remoteUpdater(!0),this._unhookUnloadEvent(),this._writeCacheTimer&&this._async.clearTimeout(this._writeCacheTimer)},u._PerformanceLogger.startMarkForComponent(ce),this._async=new r.Async(this);const t=()=>{const e=new i._QosMonitor(se+"_tryInitializeFromLateFlush");try{this._tryInitializeFromPage(),this._hasFlushCompleted?e.writeSuccess():e.writeUnexpectedFailure("NoCacheMetadata")}catch(t){e.writeUnexpectedFailure("CatchAll",t)}},n=de._increaseLateFlushKS()?12e4:24e4;let o=0;this._initializeFromLateFlush=new Promise((e,a)=>{const s=new i._QosMonitor(se+"_initializeFromLateFlush");window._spWebPartDataLoaded||(window._spWebPartDataLoaded=t);const c=new r.Async;c.setInterval(()=>(!this._hasFlushCompleted&&window._spWebPartData&&t(),this._hasFlushCompleted&&window._spWebPartData?(u._PerformanceLogger.markComponent(ce,this._hasInitializedSynchronously?"SyncFlushCompleted":"LateFlushCompleted"),s.writeSuccess({initializedAsync:!this._hasInitializedSynchronously}),c.dispose(),e()):o>=n?(u._PerformanceLogger.endMarkForComponent(ce),s.writeUnexpectedFailure("TimedOut"),c.dispose(),a(new Error)):void(o+=50)),50)}),e.whenFinished(()=>{this._pageContext=e.consume(te.PageContext.serviceKey),this._spHttpClient=e.consume(ne.SPHttpClient.serviceKey),this._tryInitializeSynchronously(),this._remoteUpdater(),this._hookUnloadEvent(),i._EngagementLogger.logEvent("MySiteWebPartCacheDataProvider.Constructor")})}}de._itemsToDeferUpdate=new Map,de._logSource=i._LogSource.create("MySiteWebPartCacheDataProvider");class le{static _calculateHash(e){return ie.generateHash(JSON.stringify(e))}get instanceId(){return this._instanceId}get componentId(){return"96f08fe4-4e36-4fc2-8d13-f19ac082aedd"}get isDisposed(){return this._isDisposed}dispose(){this._isDisposed||(this._isDisposed=!0)}getCacheItemVersion(e){return this._mySiteWebPartCacheDataProvider.getCacheItemVersion(e)}initializeCacheProvider(e){e!==window._spWebPartData?.Properties?.PageCacheFolderKey&&(window._spWebPartData=void 0,window._spWebPartDataLoaded=void 0),this._mySiteWebPartCacheDataProvider=new de(this._serviceScope),i._EngagementLogger.logEvent("MySiteWebPartCacheDataManager.InPageNavTriggered")}requestWebPartCacheData_deprecated(e){return this._mySiteWebPartCacheDataProvider.getWebPartData(e.requestData,e.dataUpdated,e.config,e.webPartInstanceId,e.webPartAlias,e.rerender,e.secondsToInvalidate,e.webPartTag)}requestWebPartCacheData(e){const t=new i._QosMonitor("MySiteWebPartCacheDataManager.requestWebPartCacheData");return this._mySiteWebPartCacheDataProvider.getCacheData(e).then(n=>{const a=n.cacheResponseType===l.CacheResponseType.CachedData?"Completed":"Miss",i=n.cacheResponseType===l.CacheResponseType.CachedData?"Waiting":"Completed";return t.writeSuccess(this._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,a,i)),n}).catch(n=>(n.serverResponseAsync.catch(n=>{t.writeUnexpectedFailure("FailedToRetrieveCacheAndServerData",n,this._mySiteWebPartCacheDataProvider.getWebPartIdLogObject(e.webPartAlias,e.webPartInstanceId,"Failed","Failed"))}),n))}getCachedData(e,t){return a.Validate.isNotNullOrUndefined(e,"context"),a.Validate.isNotNullOrUndefined(t,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedGetCachedData(e.instanceId,le._calculateHash(t))}setCachedData(e,t,n){a.Validate.isNotNullOrUndefined(e,"context"),a.Validate.isNotNullOrUndefined(t,"configuration"),this._mySiteWebPartCacheDataProvider._internalAdvancedSetCacheData(e,le._calculateHash(t),n&&JSON.stringify(n))}constructor(e){this._isDisposed=!1,this._mySiteWebPartCacheDataProvider=new de(e),this._serviceScope=e,a._SPEventManager.instance.registerEvent("resetLegacyCacheManager",this,this.initializeCacheProvider)}}le.serviceKey=a.ServiceKey.create("sp-component-utilities:MySiteWebPartCacheManager",le);class ue{static isMySiteCacheSmartRaceRefactorEnabled(){return a._SPFlight.isEnabled(1549)}static isIDBTieredModelEnabled(){return 1===u._SPPerfExperiment.getVariantAndTrackExperiment(u._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp)||a._SPFlight.isEnabled(1693)}}var fe,pe=T(6642),me=T(6277),_e=T(8122);function he(){return a._SPKillSwitch.isActivated("7223355e-397c-4278-a53c-3fb20b4f5ea2")}class be{static getCustomerPromiseBaseEndSchema(e){const t=!!e.customerPromisePrefetchStatus&&!e.customerPromisePrefetchStatus.hit,n=!!e.customerPromiseCacheDataRenderStatus&&!e.customerPromiseCacheDataRenderStatus.hit,i=!!e.customerPromiseCacheDataRenderStatus&&Boolean(e.customerPromiseCacheDataRenderStatus.noFreshRender),r=!!e.customerPromiseFreshDataStatus&&!e.customerPromiseFreshDataStatus.apiSuccess,o=a._SPKillSwitch.isActivated("eaf81a34-af08-4aae-9e86-745474780f9d")?r:r&&(!e.customerPromisePrefetchStatus?.hit||e.customerPromisePrefetchStatus?.emptyData)&&(!e.customerPromiseCacheDataRenderStatus?.hit||e.customerPromiseCacheDataRenderStatus?.emptyData),s=a._SPKillSwitch.isActivated("42a36acf-2680-4acd-9349-c6f50d88b52f")&&!!e.customerPromiseImagesRenderStatus&&e.customerPromiseImagesRenderStatus.images.length>e.customerPromiseImagesRenderStatus.successCount+e.customerPromiseImagesRenderStatus.delayedImages.length,c=!!e.customerPromiseImagesRenderStatus&&Boolean(e.customerPromiseImagesRenderStatus.error||s)&&(a._SPKillSwitch.isActivated("6bcf6585-a40f-44f6-bc3b-80fba467e4c0")||(0,_e.isUnexpectedFailure)(e.customerPromiseImagesRenderStatus.error?.statusCode)),d=!!e.customerPromiseCustomDependency&&!e.customerPromiseCustomDependency.success,l=t&&r||(i?n:n&&r)||o,u={resultType:l||c||d?v.ResultTypeEnum.Failure:v.ResultTypeEnum.Success};if(e.customerPromiseFreshDataStatus&&(u.extraData={...u.extraData,dataSource:e.customerPromiseFreshDataStatus.dataSource}),c){const t=this._getSingleError(u.resultType,e.customerPromiseImagesRenderStatus.error?.errorCode||"Images Render Incomplete");u.errorCode=t?.errorCode,u.extraData={...u.extraData,imageRenderErrorMessage:e.customerPromiseImagesRenderStatus.error?.message,imageRenderStatus:be._generateImageRenderStatus(e.customerPromiseImagesRenderStatus),...this._getSingleVeto(u.resultType,"imageRenderError")}}if(t){const t=e.customerPromisePrefetchStatus?.failedReason,n=this._getSingleError(u.resultType,t);u.errorCode=n?.errorCode,u.extraData={...u.extraData,flushedError:t,...this._getSingleVeto(u.resultType,"flushError")}}else e.customerPromisePrefetchStatus&&(u.extraData={...u.extraData,flushOnTime:e.customerPromisePrefetchStatus?.flushOnTime});if(r&&e.customerPromiseCacheDataRenderStatus?.emptyData){const e="CacheEmpty";u.extraData={...u.extraData,cacheError:e}}if(n){const t=e.customerPromiseCacheDataRenderStatus?.failedReason,n=this._getSingleError(u.resultType,t);u.errorCode=n?.errorCode,u.extraData={...u.extraData,cacheError:t,...this._getSingleVeto(u.resultType,"cacheError")}}if(r){const t=e.customerPromiseFreshDataStatus?.failedReason,n=this._getSingleError(u.resultType,t);u.errorCode=n?.errorCode,u.extraData={...u.extraData,freshError:t,...this._getSingleVeto(u.resultType,"freshError")}}if(d){const t=e.customerPromiseCustomDependency?.failedReason,n=e.customerPromiseCustomDependency?.veto||"CustomDependency",a=this._getSingleError(u.resultType,t);u.errorCode=a?.errorCode,u.extraData={...u.extraData,customDependencyError:d,customDependencyErrorDetails:t,...this._getSingleVeto(u.resultType,n)}}return he()||u.resultType===v.ResultTypeEnum.Success||(d?(u.errorCode=e.customerPromiseCustomDependency?.failedReason?.toString()||"UnknownCustomDependencyError",u.extraData={...u.extraData,Veto:e.customerPromiseCustomDependency?.veto||"CustomDependency"}):l?(u.errorCode=e.customerPromiseFreshDataStatus?.failedReason?.toString()||e.customerPromiseCacheDataRenderStatus?.failedReason?.toString()||e.customerPromisePrefetchStatus?.failedReason?.toString()||"UnknownDataFetchError",u.extraData={...u.extraData,Veto:"DataFetchFailure"}):c?(u.errorCode=e.customerPromiseImagesRenderStatus.error?.errorCode?.toString()||"UnknownImageRenderError",u.extraData={...u.extraData,Veto:"ImageRenderError"}):(u.errorCode="Uncategorized",u.extraData={...u.extraData,Veto:"Uncategorized"})),u}static checkRequirementComplete(e,t,n,a,i,r,o){const{hasCacheDataRender:s,hasFlushedDataRender:c,hasFreshDataRender:d,hasImages:l,hasCustomDependency:u}=e,f=!s&&!c&&!d,p=!!s&&Boolean(t)&&Boolean(t?.noFreshRender),m=!!c&&Boolean(n?.hit),_=!!d&&Boolean(a),h=be._hasContentFetchFailed(o,t,n,a),b=be._hasData(o,t,n,a);let g=!0;const v=!!i&&i.renderType===o,y=!!i&&i.images.length===i.count+i.delayedImages.length;g=!(l&&b&&!h)||!!v&&(!!i.error||y);const S=!u||Boolean(r);return!!((f||m||p||_)&&g&&S)}static updateCustomerPromiseCachedDataRenderStatus(e,t){const{isCacheDataEmpty:n,error:a}=t;return void 0===a?(e.hit=!0,e.emptyData=Boolean(n)):(e.hit=!1,e.failedReason=a),e}static updateCustomerPromiseFlushedDataRenderStatus(e,t){const{isFlushedDataEmpty:n,isFlushOnTime:a,error:i}=t;return void 0===i?(e.hit=!0,e.emptyData=Boolean(n),e.flushOnTime=a):(e.hit=!1,e.failedReason=i),e}static updateCustomerPromiseFreshDataRenderStatus(e,t){const{dataProvider:n,isServerResultEmpty:a,error:i}=t;return e.dataSource=n,void 0===i?(e.apiSuccess=!0,e.emptyData=Boolean(a)):(e.apiSuccess=!1,e.failedReason=i),e}static updateCustomerPromiseCustomDependencyStatus(e,t){const{success:n,failedReason:i,veto:r}=t;return e.success=n,n||(e.failedReason=i,a._SPKillSwitch.isActivated("6f174085-080f-401b-8cad-7dacbfed1e4a")||(e.veto=r)),e}static updateCustomerPromiseImagesRenderStatus(e,t,n,a,i){if(be._isImageFromLatestRender(e.renderType,n)&&be._isImageInitialized(e.images,t)){if("Delayed"===a)return e.delayedImages.push(t),e;e.delayedImages.indexOf(t)>=0&&(e.delayedImages=e.delayedImages.filter(e=>e!==t)),"Success"===a&&(e.successCount=e.successCount+1),e.count=e.count+1,"Failure"===a&&(e.error=i,i||(e.error={errorCode:"Unknown Failure"}))}return e}static logNoFreshRenderAfterCacheRender(e){return e.noFreshRender=!0,e}static logCustomerPromise(e,t){e.end(t)}static _getSingleError(e,t){if(he()&&e!==v.ResultTypeEnum.Success)return{errorCode:t.toString()}}static _getSingleVeto(e,t){if(he()&&e!==v.ResultTypeEnum.Success)return{Veto:t}}static _generateImageRenderStatus(e){return`Render Type ${e.renderType}. Total : ${e.images.length}. Successful : ${e.successCount}. Delayed : ${e.delayedImages.length}`}static _isImageFromLatestRender(e,t){return e===t}static _isImageInitialized(e,t){return e.indexOf(t)>=0}static _hasContentFetchFailed(e,t,n,a){switch(e){case"CACHE":return!t?.hit;case"FLUSH":return!n?.hit;case"FRESH":return!a?.apiSuccess;case"STATIC":return!1}}static _hasData(e,t,n,a){switch(e){case"CACHE":return Boolean(t)&&!t?.emptyData;case"FLUSH":return Boolean(n)&&!n?.emptyData;case"FRESH":return Boolean(a)&&!a?.emptyData;case"STATIC":return!0}}}class ge{initializeCustomerPromise(e,t,n,a){const i={scenario:e,extraData:{pageType:n.pageType||"L1",Pillar:a?.pillar,Endpoint:a?.endpoint,Product:a?.product}};this._customerPromise=new me.CustomerPromise(i),this._customerPromiseTimeout=t,this._customerPromiseRules=n}initializeCustomerPromiseImages(e,t){this._imagesRenderStatus={images:t,delayedImages:[],renderType:e,count:0,successCount:0},0===t.length&&this.validateAndLogCustomerPromise()}updateCustomerPromiseCachedDataRenderStatus(e){this._cachedDataRenderStatus={},be.updateCustomerPromiseCachedDataRenderStatus(this._cachedDataRenderStatus,e),this._latestRender="CACHE",this.validateAndLogCustomerPromise()}logNoFreshRenderAfterCacheRender(){this._cachedDataRenderStatus&&(be.logNoFreshRenderAfterCacheRender(this._cachedDataRenderStatus),this.validateAndLogCustomerPromise())}updateCustomerPromiseFlushedDataRenderStatus(e){this._flushedDataRenderStatus={},be.updateCustomerPromiseFlushedDataRenderStatus(this._flushedDataRenderStatus,e),this._latestRender="FLUSH",this.validateAndLogCustomerPromise()}updateCustomerPromiseFreshDataRenderStatus(e){this._freshDataRenderStatus={},be.updateCustomerPromiseFreshDataRenderStatus(this._freshDataRenderStatus,e),this._latestRender="FRESH",this.validateAndLogCustomerPromise()}updateCustomerPromiseImageRenderStatus(e){const{image:t,renderType:n,status:a,error:i}=e;this._imagesRenderStatus&&(this._imagesRenderStatus=be.updateCustomerPromiseImagesRenderStatus(this._imagesRenderStatus,t,n,a,i)),this.validateAndLogCustomerPromise()}updateCustomerPromiseCustomDependencyStatus(e){this._customDependencyStatus={},be.updateCustomerPromiseCustomDependencyStatus(this._customDependencyStatus,e),this.validateAndLogCustomerPromise()}validateAndLogCustomerPromise(e){if(!this._isCustomerPromiseLogged&&(e||be.checkRequirementComplete(this._customerPromiseRules,this._cachedDataRenderStatus,this._flushedDataRenderStatus,this._freshDataRenderStatus,this._imagesRenderStatus,this._customDependencyStatus,this._latestRender))){const t=this._getEndSchema();e&&(t.extraData={...t.extraData,timeout:!0},a._SPKillSwitch.isActivated("7d425bad-7b1e-4c07-bdbd-4546752a47f6")||(t.errorCode=void 0,t.resultType=me.ResultTypeEnum.Success,t.extraData={...t.extraData,Veto:void 0})),this._logCustomerPromise(t),this._isCustomerPromiseLogged=!0}}logCustomerPromiseOnUnload(){if(!a._SPKillSwitch.isActivated("3aa19c44-3639-45d0-acb3-62e47009f5a2")&&!this._isCustomerPromiseLogged){const e=this._getEndSchema();e.errorCode=void 0,e.resultType=me.ResultTypeEnum.Success,e.extraData={...e.extraData,Veto:void 0,incomplete:!0},this._logCustomerPromise(e),this._isCustomerPromiseLogged=!0}}_getEndSchema(){return be.getCustomerPromiseBaseEndSchema({customerPromiseFreshDataStatus:this._freshDataRenderStatus,customerPromiseCacheDataRenderStatus:this._cachedDataRenderStatus,customerPromisePrefetchStatus:this._flushedDataRenderStatus,customerPromiseImagesRenderStatus:this._imagesRenderStatus,customerPromiseCustomDependency:this._customDependencyStatus})}_logCustomerPromise(e){this._customerPromise&&be.logCustomerPromise(this._customerPromise,e)}constructor(){this._customerPromiseRules={},this._customerPromiseTimeout=4e3,this._isCustomerPromiseLogged=!1,this._latestRender="STATIC"}}class ve extends pe.BaseClientSideWebPart{initializeCustomerPromise(e,t,n,a){this._baseCustomerPromise.initializeCustomerPromise(e,t,n,a)}initializeCustomerPromiseImages(e,t){this._baseCustomerPromise.initializeCustomerPromiseImages(e,t)}updateCustomerPromiseCachedDataRenderStatus(e){this._baseCustomerPromise.updateCustomerPromiseCachedDataRenderStatus(e)}updateCustomerPromiseFlushedDataRenderStatus(e){this._baseCustomerPromise.updateCustomerPromiseFlushedDataRenderStatus(e)}updateCustomerPromiseFreshDataRenderStatus(e){this._baseCustomerPromise.updateCustomerPromiseFreshDataRenderStatus(e)}updateCustomerPromiseImageRenderStatus(e){this._baseCustomerPromise.updateCustomerPromiseImageRenderStatus(e)}updateCustomerPromiseCustomDependencyStatus(e){this._baseCustomerPromise.updateCustomerPromiseCustomDependencyStatus(e)}logNoFreshRenderAfterCacheRender(){this._baseCustomerPromise.logNoFreshRenderAfterCacheRender()}logPostRenderCustomerPromise(){window.onbeforeunload=()=>{this._baseCustomerPromise.logCustomerPromiseOnUnload()},clearTimeout(this._baseCustomerPromiseTimer),this._baseCustomerPromiseTimer=window.setTimeout(()=>{this._baseCustomerPromise.validateAndLogCustomerPromise(!0)},this._baseCustomerPromise._customerPromiseTimeout)}onDispose(){this._baseCustomerPromise.logCustomerPromiseOnUnload()}constructor(){super(),this._baseCustomerPromiseTimer=void 0,this._baseCustomerPromise=new ge}}!function(e){e[e.BadRequest=400]="BadRequest",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.TooManyRequest=429]="TooManyRequest",e[e.ServerError=500]="ServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.Timeout=504]="Timeout",e.MiscellaneousError="MiscellaneousError"}(fe||(fe={}));const ye={title:{isSearchablePlainText:!0},baseUrl:{isLink:!0},layoutComponentId:{isComponentDependency:!0}},Se={Append:0,Replace:1,Compare:2};class De extends ve{static _isOAuthUtilityError(e){const t=Object.getPrototypeOf(e);return t.constructor&&"OAuthUtilityError"===t.constructor.name}static _getContextLogSource(e){const t=e&&e.webPartTag;return i._LogSource.create(t||"BaseCollectionWebPart")}get headingLevel(){}get useHtmlTitle(){return!1}get htmlTitleAdditionalCssClass(){}get component(){return this._component}get response(){return this._response}get activeLayoutInfo(){return this._activeLayoutInfo}get activeDataProviderInfo(){return this._activeDataProviderInfo}get isContributor(){const e=this.context.pageContext.web.permissions;return!!e&&e.hasPermission(te.SPPermission.addListItems)}get isRenderAsync(){return!0}get sectionBackgroundTheme(){return this._emphasisTheme}updateActiveLayoutProp(e,t){this._activeLayoutInfo.properties[e]=t}onInit(){this._response=[],this._options=this.options;const e=new u._QosMonitor(`${this._options.qosPrefix}Mount`);if(this._shouldUseLegacyMySiteWebPartCache()||a._SPKillSwitch.isActivated("f186df9f-68c1-472c-94fe-d68b47deaa27")||(u._PerformanceLogger.trackWebpartFlight(this.context.webPartTag,u._PerformanceFlight.WEXUseIndexedDBTieredCaching),u._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,u._PerformanceExperiment.WEXUseIndexedDBTieredCachingExp),u._PerformanceLogger.trackWebpartExperiment(this.context.webPartTag,u._PerformanceExperiment.WEXTieredCachingLateFlushExp)),this._onComponentMounted=this._onComponentMounted.bind(this),this.setDefaultProperties(this.properties),this._layoutInfos=this.layouts,this._setSelectedLayout(),this._setSelectedDataProvider(),this._getDisplayFieldMaps(),this._activeLayoutInfo.hasInitialLoadingState)this.render();else if(!this._activeLayoutInfo){const t=new Error(H.E_);if(this._handleRenderLayoutError(t),!this._isCommonCustomerPromiseEnabled()){const n={alias:this._options.qosPrefix};e.writeUnexpectedFailure("FailedNoLayout",t,n)}this.options.isRenderAsync||this.renderCompleted()}return new Promise((t,n)=>{const a=this.context.serviceScope;a.whenFinished(()=>{this._computeTitleHtmlWhenEmpty(),this.pageContext=a.consume(te.PageContext.serviceKey),this._shouldUseLegacyMySiteWebPartCache()&&(this._mySiteCacheWebPartManager=a.consume(le.serviceKey)),this._setPageContextVariables(),this._async=new r.Async(this);const n=void 0===this._options.delayBeforeNoResultsMessage?500:this._options.delayBeforeNoResultsMessage;let o;this.delayedGetDataAndRender=this._async.debounce(this.refreshData,n);const s=this.getPrefetchedData(this._activeDataProviderInfo.id,this._activeLayoutInfo.id);let c;const{instanceId:d,manifest:f,webPartTag:p}=this.context;if(void 0!==s)c="bcwpPrefetchedData",u._PerformanceLogger.markComponent(p,"prefetchedData"),u._PerformanceLogger.markComponent(p,"CacheHit"),o=Promise.resolve(s);else if(this._shouldUseLegacyMySiteWebPartCache()){c="bcwpCachedDataRequest";const e=this.dataCacheConfiguration,t={requestData:this.requestData.bind(this),dataUpdated:this.setResponseAndRender.bind(this),webPartInstanceId:d,webPartAlias:f.alias,secondsToInvalidate:void 0};if(ue.isMySiteCacheSmartRaceRefactorEnabled()){const n=`BaseCollection_${p}`;u._PerformanceLogger.markComponent(n,"LKGRequest");const a=t;a.serializedConfiguration=JSON.stringify(e),o=this._mySiteCacheWebPartManager.requestWebPartCacheData(a).then(e=>(this._isResponseFromCache=e.cacheResponseType===l.CacheResponseType.CachedData,(e.cacheResponseAsync||e.serverResponseAsync).then(e=>{const t=new i._LogEntry("MySiteCacheDataMetrics","CacheDataSize",i._LogType.Event,{dataSizeInKB:e?""+JSON.stringify(e).length/1024:"0",dataProvider:this._activeDataProviderInfo.id,isCacheHit:`${this._isResponseFromCache}`,numberOfItems:e?`${e.length}`:"0"});return i._EngagementLogger.logEventWithLogEntry(t),e}))).then(e=>(u._PerformanceLogger.markComponent(n,"DataReturned"),e))}else{const n=t;n.config=e,n.webPartTag=p,o=this._mySiteCacheWebPartManager.requestWebPartCacheData_deprecated(n)}}else c="bcwpRacePrefetchedDataAsync",this._shouldUseLegacyMySiteWebPartCache()&&(u._PerformanceLogger.markComponent(p,"CacheMiss"),u._PerformanceLogger.markComponent(p,"LateFlush")),o=Promise.race([this._getPrefetchedDataAsync(this._activeDataProviderInfo.id,this._activeLayoutInfo.id),this.requestData()]);const m=De._getContextLogSource(this.context);c&&i._TraceLogger.logVerbose(m,`${c}.start`),o.then(n=>{this._shouldUseLegacyMySiteWebPartCache()&&"2.0"===this._mySiteCacheWebPartManager.getCacheItemVersion(this.context.instanceId)&&(n=this.postProcessTieredCachedData(n)),this._response=n,c&&i._TraceLogger.logVerbose(m,`${c}.end`),this.renderedOnce||e.writeSuccess(),t()}).catch(n=>{this._handleRequestDataError(n),c&&i._TraceLogger.logError(m,n,`${c}.end`),e.writeUnexpectedFailure("FailedInitialDataRequest",n),t()})})}).then(()=>this._getEmphasisTheme())}postProcessTieredCachedData(e){return e}setLayoutById(e){this.properties.layoutId=e,this._setSelectedLayout()}setLayoutByKey(e){for(const t of this._layoutInfos)if(t.option&&t.option.key===e){this.setLayoutById(t.id);break}}getPrefetchedData(e,t){}getPrefetchedDataAsync(e,t){return new Promise((e,t)=>{})}get dataProvider(){this._dataProviderPromises||(this._dataProviderPromises=new Map);let e=this._dataProviderPromises.get(this._activeDataProviderInfo.id);return e||(e=this._activeDataProviderInfo.loadDataProvider(this._activeDataProviderInfo.options||{serviceScope:this.context.serviceScope,qosPrefix:this._options.qosPrefix}),this._dataProviderPromises.set(this.activeDataProviderInfo.id,e)),e}get usingEmptyStateRows(){return this._usingEmptyStateRows}onAfterPropertiesUpdatedExternally(e){const{title:t,layoutId:n,hideWebPartWhenEmpty:a,addToPageScreenReaderLabel:i,...r}=e,{title:o,layoutId:s,hideWebPartWhenEmpty:c,addToPageScreenReaderLabel:d,...l}=this.properties,f=h.isEqual(r,l)&&(t!==o||n!==s||a!==c||i!==d);if(n!==s&&this._setSelectedLayout(),f)this.render();else if(e.dataProviderId!==this.properties.dataProviderId&&this.setDataProviderById(this.properties.dataProviderId),!h.isEqual(r,l)){const e=new u._QosMonitor("BaseCollectionWebPart.onAfterPropertiesUpdatedExternally");this.refreshData().then(t=>{const n={alias:`${this.context.manifest.alias}`};t?e.writeSuccess(n):e.writeUnexpectedFailure("Failed to refreshData",void 0,n)})}}setDataProviderById(e){this.properties.dataProviderId=e,this._setSelectedDataProvider()}setDataProviderByKey(e){for(const t of this.dataProviders)if(t.option&&t.option.key===e){this.setDataProviderById(t.id);break}}getDisplayFieldMap(e,t){}get propertyPaneLayoutOptions(){return this._layoutInfos.map(e=>{const t=e.option;return{ariaLabel:t.ariaLabel,imageSize:{width:32,height:32},imageSrc:t.imageSrc,key:t.key,text:t.title,themableSvg:t.themableSvg,iconProps:t.iconProps,disabled:a._SPKillSwitch.isActivated("9a71a52c-3423-4671-8391-77286dc0cf18")?void 0:t.disabled}})}get dataCacheConfiguration(){return{}}refreshData(e,t=Se.Replace,n=!0){return this.requestData(e).then(e=>{let a;switch(t){case Se.Append:a=this._response=this._response.concat(e);break;case Se.Compare:a=e;break;case Se.Replace:default:a=this._response=e}return n&&this.render(),a}).catch(e=>{this._handleRequestDataError(e)})}transposeRow(e,t,n,a){return n}transposeItems(e,t,n){return n}overlayRender(){return null}render(){const t=new u._QosMonitor(`${this._options.qosPrefix}Render`),i={alias:this._options.qosPrefix};if(!this._activeLayoutInfo){const e=new Error(H.E_);return this._handleRenderLayoutError(e),this._isCommonCustomerPromiseEnabled()||t.writeUnexpectedFailure("FailedNoLayout",e,i),void this.renderCompleted()}i.layout=this._activeLayoutInfo.id,this.rendersRequested++,this.onPreRender(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,this._response).then(o=>{o&&(this._options={...this._options,...o});const{webPartTag:s}=this.context;u._PerformanceLogger.markComponent(s,`${u._PerformanceDataDimensions.Layout}${this.activeLayoutInfo.id}`);const c={...this._options,...this.properties,...this._activeLayoutInfo?.properties||{}};if((0,k.JU)()&&(void 0===this.properties.isTitleEnabled||!(0,x.hf)()&&void 0!==this._options.showTitle||(c.showTitle=this.properties.isTitleEnabled),c.headingLevel=this._options.headingLevel),c.webPartTag=s,c.emphasisTheme=this._emphasisTheme,c.emphasisTheme||(c.emphasisTheme=(0,r.getTheme)()),ue.isMySiteCacheSmartRaceRefactorEnabled()&&(c.isRenderedFromCacheData=this._isResponseFromCache),c.isInTeamsContext=!!this.context.sdks.microsoftTeams,c.hasInitialLoadingState=this._activeLayoutInfo?.hasInitialLoadingState,c.displayMode=this.displayMode,c.errorCallback=this._handleRenderLayoutError.bind(this),c.renderedOnce=this.renderedOnce,c.defaultTitle=this.defaultTitle,c.layoutInfo=this._activeLayoutInfo,c.width=this.width,c.registerEvent=(e,t)=>a._SPEventManager.instance.registerEvent(e,this,t),c.unregisterEvent=(e,t)=>a._SPEventManager.instance.unregisterEvent(e,this,t),this._activeLayoutInfo.displayFieldMaps&&(c.displayFieldMap=this._activeLayoutInfo.displayFieldMaps[this._activeDataProviderInfo.id]),c.items=void 0,c.onComponentMounted=this._onComponentMounted,c.onTitleChange=e=>{(0,k.yA)()?(this.properties.titleHTML=e,this.properties.title=q(e)):(this.properties.title=e,(0,x.IY)()||(this.properties.titleHTML=Q(e,this.headingLevel)))},c.changeVisibility=e=>this.isVisible=e,c.titleHTML=this.properties.titleHTML,c.serviceScope=this.context.serviceScope,c.useHtmlTitle=this.useHtmlTitle,c.headingLevel=this.headingLevel,c.htmlTitleAdditionalCssClass=this.htmlTitleAdditionalCssClass,this._activeLayoutInfo.displayFieldMaps&&this._activeDataProviderInfo){const e=this._activeLayoutInfo.displayFieldMaps[this._activeDataProviderInfo.id];e&&(c.displayFieldMap=e,((0,x.FL)()?this._response:this._response?.length)?c.items=e.transpose(this._response,e=>this.transposeRow(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,e,this._activeDataProviderInfo.options)):c.items=[])}c.items||(((0,x.FL)()?this._response:this._response?.length)?c.items=this._response.map(e=>this.transposeRow(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,e,this._activeDataProviderInfo.options)):c.items=[]),c.items=this.transposeItems(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,c.items);try{const r=e.createElement(e.Fragment,null,e.createElement($,c),!a._SPKillSwitch.isActivated("1389b1d0-5020-46c3-82bb-2b8d17445a30")&&this.overlayRender());this._component=n.render(r,this.domElement),this.renderedOnce||!this._component||this.renderedFromPersistedData||this._component.focusOnTitle(),this.onPostRender(this._activeLayoutInfo.id,this._activeDataProviderInfo.id,this._response).then(()=>{this._isCommonCustomerPromiseEnabled()||t.writeSuccess(i)}).catch(e=>{this._isCommonCustomerPromiseEnabled()||t.writeUnexpectedFailure("FailedPostRender",e,i)})}catch(e){i.stack=e.stack,this._isCommonCustomerPromiseEnabled()||t.writeUnexpectedFailure("FailedRender",e,i),this.failedRendersCompleted++}this.rendersCompleted++,u._PerformanceLogger.saveTempData(`${s}.postRenderComplete`,u._PerformanceLogger.now())}).catch(e=>{this._handleRenderLayoutError(e),this._isCommonCustomerPromiseEnabled()||t.writeUnexpectedFailure("FailedPreRender",e,i),this.renderCompleted()})}onPropertyPaneFieldChanged(e,t,n){"headingLevel"===e&&((0,x.IY)()||(this.properties.titleHTML=Q(this.properties.title,n))),super.onPropertyPaneFieldChanged(e,t,n)}onPreRender(e,t,n){return Promise.resolve(void 0)}onPostRender(e,t,n){return Promise.resolve(void 0)}onBeforeSerialize(){this.properties.title&&(this.properties.title=this.properties.title.trim())}onDispose(){t.unmountComponentAtNode(this.domElement),this.context.serviceScope.consume(ee.ThemeProvider.serviceKey).themeChangedEvent.remove(this,this._handleThemeChangedEvent),super.onDispose()}get propertiesMetadata(){return ye}onDiscard(){this.refreshData().catch(e=>i._TraceLogger.logError(De._getContextLogSource(this.context),e,"RefreshData"))}setDefaultProperties(e){}get defaultTitle(){return H.xF}getEmptyStateRows(e,t){}setResponse(e){this._response=e}setResponseAndRender(e){ue.isMySiteCacheSmartRaceRefactorEnabled()&&(this._isResponseFromCache=!1),this._response=e,this.render()}requestData(e){const{webPartTag:t}=this.context,n=De._getContextLogSource(this.context);return this._disableDataRequest||i._TraceLogger.logVerbose(n,"bcwpRequestData.start"),new Promise((a,r)=>{if(this._disableDataRequest)return i._TraceLogger.logVerbose(n,"bcwpRequestData.end"),void a([]);if(this._activeDataProviderInfo){const o=new u._QosMonitor(`${this._options.qosPrefix}RequestData`);i._TraceLogger.logVerbose(n,"bcwpDataProvider.start"),this.dataProvider.then(s=>{u._PerformanceLogger.markComponent(t,`${u._PerformanceDataDimensions.DataProvider}${s.id}`),i._TraceLogger.logVerbose(n,"bcwpDataProvider.end"),e=e||this.getRequest(this._activeDataProviderInfo.id,this._activeLayoutInfo.id),s.requestData(e).then(e=>{if(this._usingEmptyStateRows=!1,!e||0===e.length){this._usingEmptyStateRows=!0;const t=this.getEmptyStateRows(this._activeLayoutInfo.id,s.id);t&&(e=t)}a(e),i._TraceLogger.logVerbose(n,"bcwpRequestData.end"),this._isCommonCustomerPromiseEnabled()||o.writeSuccess()},e=>{this.context.statusRenderer.clearLoadingIndicator(this.domElement),i._TraceLogger.logVerbose(n,"bcwpRequestData.end"),this._isCommonCustomerPromiseEnabled()||o.writeUnexpectedFailure("FailedDataRequest",e),De._isOAuthUtilityError(e)&&this.canHandleOAuthError(e)?(this.render(),a(void 0)):r(e)})},e=>{u._PerformanceLogger.markComponent(t,"bcwpDataProvider.end"),this._isCommonCustomerPromiseEnabled()||o.writeUnexpectedFailure("FailedToLoadDataProvider",e),r(e)})}else i._TraceLogger.logVerbose(n,"bcwpRequestData.end"),r(new Error(H.Nt))})}disableDataRequest(){this._disableDataRequest=!0}enableDataRequest(){this._disableDataRequest=!1}canHandleOAuthError(e){return!1}canHandleWebpartError(e){return!1}onPropertyPaneConfigurationComplete(){super.onPropertyPaneConfigurationComplete(),this.properties.layoutId&&this._addBCWPSelectedLayoutEngagementLog(this.properties.layoutId)}_handleRenderLayoutError(e){this.canHandleWebpartError(e)||super.renderError(e)}_handleRequestDataError(e){De._isOAuthUtilityError(e)&&this.canHandleOAuthError(e)?this.render():this.renderError(e)}_setPageContextVariables(){if(this._options.requirePageContextVariables){if(!this.pageContext)throw new Error(H.q7);if(!this.pageContext.web)throw new Error(H.af);if(this.pageContext.web.absoluteUrl){if(!this.pageContext.web.id)throw new Error(H.mg);if(this.properties.webId=this.pageContext.web.id.toString(),!this.pageContext.site)throw new Error(H.Qu);if(!this.pageContext.site.id)throw new Error(H.Kl);this.properties.siteId=this.pageContext.site.id.toString(),this.properties.baseUrl=this.pageContext.web.absoluteUrl}else this.properties.webId="a50ff2b3-f789-4251-aad1-5909f23aed4f",this.properties.baseUrl="https://msft.spoppe.com/sites/wex"}}_setSelectedLayout(){!this.properties.layoutId&&this._layoutInfos.length>0&&(this.properties.layoutId=this._layoutInfos[0].id,this.properties.layoutComponentId=this._layoutInfos[0].componentId);const{layoutId:e}=this.properties;if(e)for(const t of this._layoutInfos)if(t.id===e){this._activeLayoutInfo=t,this.properties.layoutComponentId=this._activeLayoutInfo.componentId;break}}_addBCWPSelectedLayoutEngagementLog(e){if(!this._isSelectedLayoutLogged){const t={component:"BaseWPSelectedLayout",extraData:{layoutId:e},feature:"WebPart",name:`${this.context.manifest.alias}.BCWPSelectedLayout`};i._EngagementLogger.log(t),this._isSelectedLayoutLogged=!0}}_setSelectedDataProvider(){if(!this.properties.dataProviderId&&this.dataProviders.length>0&&(this.properties.dataProviderId=this.dataProviders[0].id,this.properties.dataProviderComponentId=this.dataProviders[0].componentId),this.properties.dataProviderId)for(const e of this.dataProviders)if(e?.id===this.properties.dataProviderId){this._activeDataProviderInfo=e;break}}_getDisplayFieldMaps(){this._layoutInfos.map(e=>{e.displayFieldMaps||(e.displayFieldMaps={}),this.dataProviders.map(t=>{t&&(e.displayFieldMaps[t.id]=this.getDisplayFieldMap(e.id,t.id))})})}_onComponentMounted(){this.options.isRenderAsync||this.renderCompleted()}_shouldUseLegacyMySiteWebPartCache(){return this._options.deprecated_canCacheResults&&!this._options.temporary_isTieredCacheImplementedInDataProvider}_isCommonCustomerPromiseEnabled(){return this._options.isCustomerPromiseInitialized}_computeTitleHtmlWhenEmpty(){k.yA&&!this.properties.titleHTML&&this.properties.title&&(this.properties.titleHTML=Q(this.properties.title,this.headingLevel))}constructor(){super(),this.rendersRequested=0,this.rendersCompleted=0,this.failedRendersCompleted=0,this._getEmphasisTheme=()=>{const e=this.context.serviceScope.consume(ee.ThemeProvider.serviceKey);this._emphasisTheme=e.tryGetTheme(),e.themeChangedEvent.add(this,this._handleThemeChangedEvent)},this._handleThemeChangedEvent=e=>{this._emphasisTheme=e.theme,this.render()},this._getPrefetchedDataAsync=(e,t)=>{const n="bcwpGetPrefetchedDataAsync",a=De._getContextLogSource(this.context);return i._TraceLogger.logVerbose(a,`${n}.start`),this.getPrefetchedDataAsync(e,t).then(e=>(i._TraceLogger.logVerbose(a,`${n}.end`),u._PerformanceLogger.markComponent(this.context.webPartTag,"prefetchedData"),Promise.resolve(e))).catch(e=>(i._TraceLogger.logVerbose(a,`${n}.end`),Promise.reject(e)))},this._disableDataRequest=!1,this._isSelectedLayoutLogged=!1}}class Ie{static getCustomerPromiseBaseEndSchema(e,t,n){const a=!!n&&!n.hit,i=!!t&&!t.hit,r=!!e&&!e.apiSuccess,o={resultType:(i||a)&&r?v.ResultTypeEnum.Failure:v.ResultTypeEnum.Success,extraData:{}};return(a||i||r)&&(o.errorCode=""),a&&(o.errorCode+="PREFETCH_FAILED--",o.extraData={...o.extraData,prefetchError:`Prefetch Error: ${n.failedReason}`}),i&&(o.errorCode+="LKG_FAILED--",o.extraData={...o.extraData,lkgError:`LKG Error: ${t.failedReason}`}),r&&(o.errorCode+="API-FAILED",o.extraData={...o.extraData,apiError:`API Error: ${e.apiFailedReason}`}),o}static updateCustomerPromiseStatus(e,t,n){return t&&(e.didRenderFromServer=t),n&&(e.didRenderFromCache=n),e}static updateCustomerPromiseLKGStatus(e,t,n){return n?(e.hit=!1,e.failedReason=n&&n.message):(e.hit=!0,e.emptyData=t),e}static updateCustomerDataProviderStatus(e,t,n,a){return e.dataSource=t,a?(e.apiSuccess=!1,e.apiFailedReason=a&&a.message):(e.apiSuccess=!0,e.emptyData=n),e}}var xe=T(7147);class Ce extends class extends class{constructor(e){a.Validate.isNotNullOrUndefined(e,"configuration"),a.Validate.isNotNullOrUndefined(e.serviceScope,"configuration.serviceScope"),this.configuration=e}}{requestData(e){return a.Validate.isNotNullOrUndefined(e,"request"),a.Validate.isNotNullOrUndefined(e.fetchData,"request.fetchData"),a.Validate.isNotNullOrUndefined(e.dataReceived,"request.dataReceived"),a.Validate.isNonemptyString(e.cacheKey,"request.cacheKey"),a.Validate.isNonemptyString(e.alias,"request.alias"),(0,k.pD)()&&"ImageGalleryWebPart"===e.alias?this._cacheManager.requestWebPartCacheData({requestData:e.fetchData,dataUpdated:e.dataReceived,serializedConfiguration:JSON.stringify(e.cacheParameters),webPartInstanceId:e.cacheKey,webPartAlias:e.alias}).then(e=>e.cacheResponseAsync||e.serverResponseAsync).then(e=>e):this._cacheManager.requestWebPartCacheData_deprecated({requestData:e.fetchData,dataUpdated:e.dataReceived,config:e.cacheParameters,webPartInstanceId:e.cacheKey,webPartAlias:e.alias,webPartTag:e.alias})}constructor(e){super(e),this._cacheManager=e.serviceScope.consume(le.serviceKey)}}{}class Oe extends pe.BaseClientSideWebPart{get dataProviderConfiguration(){return{serviceScope:this.context.serviceScope}}get dataProvider(){return this._dataProvider||(this._dataProvider=new Ce(this.dataProviderConfiguration)),this._dataProvider}get cacheKey(){return this.context.instanceId}get alias(){return this.context.manifest.alias}get cacheParameters(){return this.properties}_internalGetData(){const e={fetchData:this.fetchData,dataReceived:this._internalDataReceived,cacheKey:this.cacheKey,alias:this.alias,cacheParameters:this.cacheParameters,webPartTag:this.context&&this.context.webPartTag};return this.dataProvider.requestData(e).then(t=>{e.dataReceived({data:t,metadata:{}})})}constructor(...e){super(...e),this._internalDataReceived=e=>{this.dataReceived({data:e,metadata:{}})}}}var we=T(1787);function Ee(e,t){return!(!e||!t)&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}c.loadStyles('.b_6d3Fy_-aI_E{align-items:center;border:1px solid;color:"[theme:neutralPrimary, default: #323130]";display:flex;flex-direction:column;font-weight:400;text-align:center}.b_6d3Fy_-aI_E.b_kvUSp_-aI_E{height:62px;width:62px}.b_6d3Fy_-aI_E.b_Wexmt_-aI_E{height:80px;width:80px}.b_6d3Fy_-aI_E.b_nhzga_-aI_E{height:104px;width:104px}.b_6d3Fy_-aI_E.b_JqpDh_-aI_E{justify-content:center}.b_6d3Fy_-aI_E.b_F1Eyo_-aI_E{justify-content:space-between}.b_kvUSp_-aI_E .m_m515J_-aI_E:not(.f_-XnVR_-aI_E){font-size:12px;font-weight:400}.b_Wexmt_-aI_E .m_m515J_-aI_E:not(.f_-XnVR_-aI_E){font-size:15px;font-weight:400}.b_nhzga_-aI_E .m_m515J_-aI_E:not(.f_-XnVR_-aI_E){font-size:21px;font-weight:100}.b_kvUSp_-aI_E .m_m515J_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.b_Wexmt_-aI_E .m_m515J_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:mediumFontSize, default: 14px]";font-weight:"[theme:mediumFontWeight, default: 400]";font-weight:600}.b_nhzga_-aI_E .m_m515J_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]";font-weight:600}.d_dVx7I_-aI_E{font-weight:600}.b_kvUSp_-aI_E .d_dVx7I_-aI_E:not(.f_-XnVR_-aI_E){font-size:21px}.b_Wexmt_-aI_E .d_dVx7I_-aI_E:not(.f_-XnVR_-aI_E),.b_nhzga_-aI_E .d_dVx7I_-aI_E:not(.f_-XnVR_-aI_E){font-size:28px}.b_kvUSp_-aI_E .d_dVx7I_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.b_Wexmt_-aI_E .d_dVx7I_-aI_E.f_-XnVR_-aI_E,.b_nhzga_-aI_E .d_dVx7I_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:xxLargeFontSize, default: 28px]";font-weight:"[theme:xxLargeFontWeight, default: 600]"}.d_F-x9d_-aI_E{display:flex;flex-direction:column;flex-grow:1;justify-content:center}.b_kvUSp_-aI_E .d_F-x9d_-aI_E:not(.f_-XnVR_-aI_E){font-size:10px;font-weight:600}.b_Wexmt_-aI_E .d_F-x9d_-aI_E:not(.f_-XnVR_-aI_E){font-size:12px;font-weight:400}.b_nhzga_-aI_E .d_F-x9d_-aI_E:not(.f_-XnVR_-aI_E){font-size:15px;font-weight:400}.b_kvUSp_-aI_E .d_F-x9d_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:xSmallFontSize, default: 10px]";font-weight:"[theme:xSmallFontWeight, default: 400]";font-weight:600}.b_Wexmt_-aI_E .d_F-x9d_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:smallFontSize, default: 12px]";font-weight:"[theme:smallFontWeight, default: 400]";font-weight:600}.b_nhzga_-aI_E .d_F-x9d_-aI_E.f_-XnVR_-aI_E{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.s_oSFmK_-aI_E{border:0;border-bottom:1px solid;margin:0}.b_kvUSp_-aI_E .s_oSFmK_-aI_E{width:31px}.b_Wexmt_-aI_E .s_oSFmK_-aI_E{width:40px}.b_nhzga_-aI_E .s_oSFmK_-aI_E{width:52px}',!0);const Ae="b_6d3Fy_-aI_E",Le="f_-XnVR_-aI_E",ke="d_F-x9d_-aI_E",Me=JSON.parse('{"f":"Month"}'),Pe={Small:0,Medium:1,Large:2},Te={0:"b_kvUSp_-aI_E",1:"b_Wexmt_-aI_E",2:"b_nhzga_-aI_E"};class Ue extends e.PureComponent{render(){const{startDate:e,endDate:t}=this.props;return this._sizeClassName=h.get(Te,this.props.size),e&&t&&!Ee(e,t)?this._multipleDaysDateBoxElement:this._singleDayDateBoxElement}get _singleDayDateBoxElement(){const{startDate:t,endDate:n,formatMonth:a,formatDay:i}=this.props,o=t||n,s=o?a(o):Me.f,c=o?i(o):"01";return e.createElement("div",{className:(0,r.css)(Ae,"b_JqpDh_-aI_E",this._sizeClassName,this.props.className),"data-automation-id":"singleDayBox"},e.createElement("div",{className:(0,r.css)("m_m515J_-aI_E",Le),"data-automation-id":"singleDayMonthContainer"},s),e.createElement("div",{className:(0,r.css)("d_dVx7I_-aI_E",Le),"data-automation-id":"singleDayDayContainer"},c))}get _multipleDaysDateBoxElement(){const{startDate:t,endDate:n,formatDate:a}=this.props;return e.createElement("div",{className:(0,r.css)(Ae,"b_F1Eyo_-aI_E",this._sizeClassName,this.props.className),"data-automation-id":"multipleDayBox"},e.createElement("div",{className:(0,r.css)(ke,Le),"data-automation-id":"multipleDayStartDateContainer"},a(t)),e.createElement("hr",{className:"s_oSFmK_-aI_E"}),e.createElement("div",{className:(0,r.css)(ke,Le),"data-automation-id":"multipleDayEndDateContainer"},a(n)))}}Ue.defaultProps={formatDate:e=>we.LocaleFormat.formatDate(e,{skeleton:"MMMd"}).toUpperCase(),formatMonth:e=>we.LocaleFormat.formatDate(e,{skeleton:"MMM"}).toUpperCase(),formatDay:e=>we.LocaleFormat.formatDate(e,{skeleton:"d"})};const Fe=JSON.parse('{"V":"{0} at {1}"}'),He=36e5;function Re(e,t){return t||(e=-e),new Date(Date.now()+e)}function Ne(e){const t=e.split("|");if("0"===t[0])return t[1];const n="1"===t[1],i=t[2],r=t.length>=4?t[3]:void 0,o=Number(r),s=t.length>=5?t[4]:void 0;switch(i){case"1":return we.LocaleFormat.formatRelativeTimeApproximate(Re(1e3,n));case"2":return we.LocaleFormat.formatRelativeTimeApproximate(Re(6e4,n));case"3":return we.LocaleFormat.formatRelativeTime(n?o:-o,"minute");case"4":return we.LocaleFormat.formatRelativeTimeApproximate(Re(He,n));case"5":const e=we.LocaleFormat.formatRelativeTime(n?1:-1,"day");return r?a.Text.format(Fe.V,e,r):e;case"6":return we.LocaleFormat.formatRelativeTimeApproximate(Re(o*He,n));case"7":return s?a.Text.format(Fe.V,r,s):r;case"8":return we.LocaleFormat.formatRelativeTime(n?o:-o,"day");case"9":return we.LocaleFormat.formatRelativeTime(0,"day")}}class Be{get target(){return this._target}get sources(){return this._displayField.sources||[]}get linkUrls(){return this._displayField.linkUrls||[]}get heading(){return this._displayField.heading||""}get width(){return void 0===this._displayField.width||null===this._displayField.width?100:this._displayField.width}get onRenderCell(){return this._onRenderCell}constructor(e,t,n){this._target=e,this._displayField=t,this._onRenderCell=n}}class je extends Be{get formatter(){return this._formatter}constructor(e,t,n,a){super(e,t,a),this._formatter=n}}const Ve="_linkUrl";class ze{fieldValue(e,t){return e instanceof je?e.formatter(t):this._firstIdentifiedValue(t,e.sources)}fieldLinkUrl(e,t){return this._firstIdentifiedValue(t,e.linkUrls)}transposeRow(e,t){if(!e)return e;const n=t?t(e):e,a={};if(this._map)for(let e=0;e<this._map.length;e++){const t=this._map[e];a[t.target]=this.fieldValue(t,n),t.linkUrls&&(a[t.target+Ve]=this.fieldLinkUrl(t,n))}return a}transpose(e,t){const n=[];for(let a=0;a<e.length;a++)n[a]=this.transposeRow(e[a],t);return n}get map(){return this._map}_firstIdentifiedValue(e,t){for(let n=0;n<t.length;n++){const a=t[n],i=e[a];if(null!=i&&""!==i)return e[a]}}constructor(e){this._map=e}}class Ge{getClassNames(e,t=!0){return!t&&this._cachedClassNames||(this._cachedClassNames=(0,r.classNamesFunction)()(this.getStyles,e)),this._cachedClassNames}}function Ke(e){"aspx"===(l.ExtensionHelper.getExtension(new v.Uri(e))||"")||a._BrowserUtilities.isTeamsHosted()?postMessage(`router://${e}`,location.origin):window.open(e,We(e))}function We(e){return Ye(e)?"_blank":"_self"}function qe(e){return(0,x.Ym)()||"_blank"!==e?void 0:"off"}function Qe(e){return e?"_blank":"_self"}function Ye(e){if(!e)return!1;const t=new v.Uri(e).getHost();return Boolean(t)&&t.toLocaleLowerCase()!==window.location.host.toLowerCase()}var Je=T(4949);function Xe({pageContext:e,url:t,siteId:n,webId:a,uniqueId:i,callerId:r,originalWidth:o,originalHeight:s}){if(!t)return;if(0===t.indexOf("/_LAYOUTS/IMAGES/"))return;const c=new Je._SPResourcePath(t),d=Je._PreviewUtility.getFileExtension(c)||"";if(!l.PreviewHelper.hasThumbnailOrFileTypeSupportsPreview(d,void 0)&&"gif"!==d)return;let u;const f=Je._ThumbnailUrlGenerator.getThumbnailProvider(t);switch(f){case Je._ThumbnailProviderType.SPOLayoutsImage:u=t;break;case Je._ThumbnailProviderType.PrivateCDN:case Je._ThumbnailProviderType.AFDPrivateCDN:case Je._ThumbnailProviderType.MeTA:case Je._ThumbnailProviderType.Stock:case Je._ThumbnailProviderType.VROOMMeTACache:return;case Je._ThumbnailProviderType.HubbleStockThumbnail:case Je._ThumbnailProviderType.HubbleStock:u=t;break;case Je._ThumbnailProviderType.PublicCDN:case Je._ThumbnailProviderType.AFDPublicCDN:case Je._ThumbnailProviderType.MediaCDNHubble:u=Je._ThumbnailUrlGenerator.updateThumbnailWidth(t,400)}if(u?.length<=255)return u;const p=e&&e.web.absoluteUrl||window.location.href;let m,_=new v.Uri(p).getLeftPart(1),h=!!(n&&a&&i);const b=!(e&&e.web&&e.web.serverRelativeUrl&&t)||-1===t.toUpperCase().indexOf(e.web.serverRelativeUrl.toUpperCase());return t&&(f===Je._ThumbnailProviderType.SharePointHost||f===Je._ThumbnailProviderType.MySite||c.isInternalResource(e))&&(h=!0,c.format===Je._SPResourcePathFormat.absolute?(_=c.authority,m=c.path):m=t),h&&(u=l.PreviewHelper.getPreviewImageUrl(d,void 0,_,m,n,a,i,void 0,!0,r,o,s),u&&u.length<=255)?u:(u=function(e,t,n,a){const i=a&&a.web.absoluteUrl,r=""!==new v.Uri(e).getHost(),o=n?t:i,s=n?e:e.substr(a.web.serverRelativeUrl.length);return r?e:v.Uri.concatenate(o,s)}(t,_,b,e),u.length<=255?u:void 0)}var Ze=T(5592);const $e=new Set(["03590920bdfd864322cf7e8cca891bb4","0381c1bcfc0b809623b805e322dd9fa1","03d374b16722d252588fa2d58a3e828d","0540187fe91e3b78e3b5d06999eebf80","083313c7a8083e625c0def330dbd7cdd","0974242efa7f7b9bb52240ee615b931b","0bbb13911b2ce26da17bbdf2ea3404b6","0d827eba349aa0591be57331540fc4f4","0e47add0cdf9530b9e30ddef0c489a40","0f78c3aa1a3da070d8f62bb9a2ee76ae","0fe8fe2f5220263be4cbd5f61d9cf23c","178a70df6ddfa637e3d4f0ea9a80fbdd","1a960363e8daa165d3b82144b0d68c03","1e033e719ef573ec796c38bf8ac41dfc","1f420b466365299439abf6fe2f8bff6a","20f0b5fb7de21fa889b002714ec58f20","2149d6090d915f849f5c33c07545fb03","23d161d98611bae938697c4d0af3bfd4","241b2579d59d10255b2e405fbcbb9117","26736ef07954f237039d261c357f06e5","279ec9ccb88c02985b4e1f645b755faf","2d523e15f73a2b345887c8b8299c8d3c","2fce211aefcaec7742455aa616edfa32","2f73a4291c58a29acc783b73fa88c282","3178a5744ef0cd2b61757583d7b7ccf1","319f83a0e835d32ce2660a4de654a7c0","3a9c8d1a8fae79004ed36c0147bdd71b","3fa3e0b2e84cb77f00799dca10f1a03e","4a48f26592f4e1498d7a478a4c48609c","41ebba55d20ff0a87734a09d88dc8f27","4312d1e9ec65cb2412e83a64f50fcdd1","44f2e736a8f04d1b47a1151eb37e0a64","48e8c755618be2d66c67976910bac81f","49fe29d48bd08304cb7a9be0a4256b8a","5b60516651aebbbc796eafdee967ef2c","613c9c11d6bfdec3dd2a568412b79762","62fe9bb236110e4553483b02e1989986","68df1aaa4d4d20f6749dcf0cbcbfd182","6c06b3944a82b194dd56b848d5c1e53f","6fe016add870f202c0a30c70ee943c73","7024c1dc5ed913c848ac81adadfedee4","7ad602295f8386b7615b582d87bcc294","7f25de15c2e701c901252f81c1911af2","8193ab3946149e9175a3c3d44219e9e1","8a2bceaca7e84b8f4da535d772625c6f","8a430e2d85dc31b60c0c6f68d7cc4c20","8b02cb6c9f9d7a7e895970d94317e20a","8ddba906d9614422695d3c9756afee7f","8f296bb8aac7be4f08409d8dbbbc8714","9029ea4d3ee7796fe043710dfff1d218","90ac8c284c2ac3a6f6b7e6518dbb6227","965331b9e159f7e263f86866902241e8","98f88501895b89e844d24793dadc8a9f","9a85f4ab720503d37748e2d854a238dc","9aae9266066558e0e42223ed4d82b1f8","a284f85a5a3096a5e90f670316993365","a3f3c88a874da09d43c8f88deb9246b6","ab08afa407a9c009513a07525fadf367","ba3cc3f8be4b187472e2f5f7d5376bb9","b3b9212834745aa4457f459f12e56653","b8a930a9d063513ea9bba50a34aaaba5","b8f6d5994ef9e9a96180ea43dbb00ed6","baa367f8c4aef7abdcb912c61f53ed10","bc4fab3f78291f699922e57650be557f","c065f1d4e77c3678be1ff6aa835dda69","c4ae58fb4e94e08cfff98beddeb615ac","c63681d72227d0813a5cdfccb62be638","c903233a37600953361096a5c28d0d46","c9dc379c327bef6f8db124f5f013fe22","cbcecad0b1eb14fe8186c566f22b0fa1","cd26d43c2fabf764bfc054d06462f64f","cd849e71a1785cc1f046b181e68bbec3","d283507fbbeb97715a321ddbd2442164","d6c8114c17555266c90ad015c2acd8b9","dacd2fb8ace0a4176a74a228539b3d33","e6ede0691f3312bd6fd9f1066153a868","e72abfe847c8792f99bc8b2cbeb65886","ea754dbc9eba7d06ae4b444f722c24df","f0d90ca687e974534dfc12798166c7e6","ffb18190d6e56748b5d6d743ff7421ad","07685baa515ccd7f52defd1043fca4cc"]),et="DoughboyDetector",tt="CDNUserPhoto",nt="AFDCDNUserPhoto";class at extends e.Component{componentDidMount(){this.state.imageData?requestAnimationFrame(this._completeDetection):this.props.disableDelayDetect?this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection):setTimeout(()=>{this._resolveImage(this.props.imageUrl).then(this._completeDetection,this._completeDetection)},7e3)}UNSAFE_componentWillReceiveProps(e){if(this.props.imageUrl!==e.imageUrl){const t=at._imageDataCache.get(e.imageUrl);t?this.setState({imageData:t}):this._resolveImage(e.imageUrl).catch(e=>i._TraceLogger.logError(this._logSource,e,"ResolveImage"))}}componentWillUnmount(){this._unmounted=!0,this._revokeBlobUrl()}render(){return this.props.renderImage(this.state.imageData||"",this.props.imageProps,this._extraProps)}_resolveImage(e){return new Promise((t,n)=>{const a=document.createElement("img");a.onload=()=>{const r=this._getImageBase64(a),o=(0,l.Md5Hash)(r);if($e.has(o))i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("DoughboyDetector","IsDoughboyImage",i._LogType.Event,{fingerprint:o})),n(new l.ExpectedFailure("DoughboyImageDetected"));else if(this._unmounted)n(new l.ExpectedFailure("ElementUnmounted"));else{const n=`data:image/png;base64,${r}`;this.setState({imageData:n}),at._imageDataCache.set(e,n),t()}},a.onerror=e=>{n(new l.ExpectedFailure("DownloadImageFailed",e.error))},this._downloadImageBlob(e).then(e=>{this._revokeBlobUrl(),this._blobUrl=URL.createObjectURL(e),a.src=this._blobUrl}).catch(()=>a.src=e),a.crossOrigin="anonymous"})}_downloadImageBlob(e){return new Promise((t,n)=>{const r=a._SPKillSwitch.isActivated("debde2df-6396-4e00-a52b-9f0e28593f6f");let o;const s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob";let c="";if(!r){const t=e.toLowerCase();c=t.indexOf("/_layouts/15/userphoto.aspx")>-1?"UserPhoto":t.indexOf("_vti_bin/afdcache.ashx/_userprofile/userphoto.jpg")>-1?nt:t.indexOf("https://privatecdn")>-1&&t.indexOf("/_userprofile/userphoto.jpg")>-1?tt:"Unknown",o=new i._QosMonitor(`UserPhotoRenderService.${c}`)}s.onload=()=>{if(s.status>=200&&s.status<300&&s.response){if(!r){const e=c===tt||c===nt?s.getResponseHeader("x-cache"):"",t=c===nt?s.getResponseHeader("x-ccc"):"",n=s.getResponseHeader("x-cache-origin");o.writeSuccess({service:c,alias:et,statusCode:s.status,CDNCache:e?.split(" ")[0],OriginCache:n,cacheCountryCode:t,size:s.response.size,source:s.response.type})}return t(s.response)}{const a=s.getResponseHeader("location");if(a&&s.status>=300&&s.status<400)return this._downloadImageBlob(a).then(t).catch(n);if(!r){const t=new Error(`<url>${(0,_e.scrubUrl)(void 0,e)}</url> <errorCode>${s.status}</errorCode>`);404===s.status?o.writeExpectedFailure(`${c} failed`,t,{alias:et,statusCode:s.status}):o.writeUnexpectedFailure(`${c} failed`,t,{alias:et,statusCode:s.status})}n("")}},s.onerror=()=>{if(!r){const t=new Error(`<url>${(0,_e.scrubUrl)(void 0,e)}</url> <errorCode>${s.status}</errorCode>`);o.writeUnexpectedFailure(`${c} failed`,t,{alias:et,headers:s.getAllResponseHeaders()})}n("")},s.send()})}_getImageBase64(e){const t=document.createElement("canvas");let n;t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0);try{n=t.toDataURL("image/png"),this._revokeBlobUrl()}catch(e){return""}return n.replace(/^data:image\/png;base64,/,"")}get _extraProps(){const{imageUrl:e,imageProps:t,renderImage:n,onDetectCompleted:a,...i}=this.props;return i}constructor(e){super(e),this._unmounted=!1,this._completeDetection=()=>{this.props.onDetectCompleted&&this.props.onDetectCompleted()},this._revokeBlobUrl=()=>{this._blobUrl&&(URL.revokeObjectURL(this._blobUrl),this._blobUrl=void 0)},this._logSource=i._LogSource.create("DoughboyDetector");const t=at._imageDataCache.get(e.imageUrl);this.state={imageData:t}}}at._imageDataCache=new Map,(0,Ze._ts_decorate)([(0,l.monitor)("DoughboyDetector.ResolveImage")],at.prototype,"_resolveImage",null),c.loadStyles(".l_yq-Is_-aI_E{word-wrap:break-word!important}",!0);class it extends e.PureComponent{componentDidMount(){this._async.setTimeout(this.update,0),this._eventGroup.on(window,"resize",this._handleWindowResize)}componentDidUpdate(){this.update()}componentWillUnmount(){this._eventGroup.off(window,"resize",this._handleWindowResize),this._eventGroup.dispose(),this._async.dispose()}render(){return e.createElement("div",{...(0,r.getNativeProps)(this.props,r.divProperties),"data-automation-id":"less-text",ref:this._textContainerElementRef,className:(0,r.css)("l_yq-Is_-aI_E",this.props.className)},this.props.text)}get _omission(){return this.props.omission||""}_handleWindowResizeCore(){this.update()}get _contentHeight(){if(this._textContainerElementRef.current){const e=window.getComputedStyle(this._textContainerElementRef.current);let t=0;return e&&e.paddingTop&&e.paddingBottom&&(t=parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)),this._textContainerElementRef.current.offsetHeight-t}return 0}_trimAndCalculateLength(e,t){const n=this._textArray.length;if(!this._textContainerElementRef.current)return n;let a=1,i=n;do{const e=Math.floor((a+i+1)/2);this._applyTextNumber(e),this._contentHeight>t?i=e-1:a=e}while(a<i);return a}_applyTextNumber(e){const t=this._textArray.slice(0,e).join("");this._textContainerElementRef.current&&(this._textContainerElementRef.current.textContent=this._textContainerElementRef.current.textContent===t?t:t+this._omission)}constructor(t){super(t),this.update=()=>{this._textContainerElementRef.current&&this._async.requestAnimationFrame(this._truncateLines)},this._truncateLines=()=>{if(!this._textContainerElementRef.current)return;const e=this.props.text||"";this._textContainerElementRef.current.textContent=e;const t=Math.round(this.props.lines),n=window.getComputedStyle(this._textContainerElementRef.current,void 0).getPropertyValue("line-height"),a=t*parseFloat(n),i=this._contentHeight;this._textArray=e.split("");const r=i>a&&t>0;if(r){const e=this._trimAndCalculateLength(i,a);this._applyTextNumber(e)}r&&this.props.autoShowTitle?this._textContainerElementRef.current.title=e:this._textContainerElementRef.current.removeAttribute("title"),this.props.onAfterTruncate&&this.props.onAfterTruncate(r)},this._async=new r.Async(this),this._eventGroup=new r.EventGroup(this),this._handleWindowResize=this._async.debounce(this._handleWindowResizeCore,1010),this._textContainerElementRef=e.createRef()}}function rt(e,t=1.35){let n;if("number"==typeof t)n=e*t+"em";else try{const a=e*Number(t.substr(0,t.length-2));if(isNaN(a))throw new Error("Invalid line height input");n=`${a}px`}catch(e){throw new e("Invalid line-height input format")}return{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":e.toString(),boxSizing:"content-box",maxHeight:n,textOverflow:1===e?"ellipsis":void 0}}const ot=(e,t,n)=>({".ms-Fabric--isFocusVisible &:focus::after":{border:`1px solid ${e}`,borderRadius:t,inset:"0",outline:`2px solid ${n}`}});function st(e){const{theme:t,primary:n}=e;return(0,r.concatStyleSets)(function(e){const{effects:t}=e;return{root:{paddingLeft:"12px",paddingRight:"12px",borderRadius:t.roundedCorner4}}}(t),n?function(e){const{effects:t,palette:n,semanticColors:a}=e;return{root:{backgroundColor:a.primaryButtonBackground,borderColor:a.primaryButtonBorder,color:a.primaryButtonText,...ot(n.white,t.roundedCorner4,a.focusBorder),".ms-Fabric--isFocusVisible &:focus":{"@media screen and (-ms-high-contrast: active), screen and (forced-colors: active)":{outline:"2px solid buttontext"}}},rootHovered:{backgroundColor:a.primaryButtonBackgroundHovered,borderColor:a.primaryButtonBackgroundHovered,color:a.primaryButtonTextHovered},rootPressed:{backgroundColor:a.primaryButtonBackgroundPressed,borderColor:a.primaryButtonBackgroundPressed,color:a.primaryButtonTextPressed},rootDisabled:{backgroundColor:a.primaryButtonBackgroundDisabled,borderColor:a.primaryButtonBackgroundDisabled,color:a.primaryButtonTextDisabled}}}(t):function(e){const{effects:t,palette:n,semanticColors:a}=e;return{root:{borderColor:a.buttonBorder,color:a.buttonText,...ot("transparent",t.roundedCorner4,a.focusBorder)},rootHovered:{backgroundColor:a.buttonBackgroundHovered,borderColor:n.neutralTertiaryAlt,color:a.buttonTextHovered},rootPressed:{backgroundColor:a.buttonBackgroundPressed,borderColor:n.neutralTertiary,color:a.buttonTextPressed},rootDisabled:{backgroundColor:a.buttonBackgroundDisabled,borderColor:a.buttonBorderDisabled,color:a.buttonTextDisabled}}}(t))}class ct{static get instance(){return ct._instance||(ct._instance=new ct)}clampText(e){return this._resetCursor(),this._clampText(e)}clampElement(e,t,n,a){if(!e)return{text:"",lines:0};const i=e.getBoundingClientRect();let r=Math.round(i.width),o=Math.round(i.height);const s=this._getComputedStyle(e);"border-box"===s.boxSizing&&(r-=this._parseInt(s.borderRightWidth)+this._parseInt(s.borderLeftWidth)+this._parseInt(s.paddingRight)+this._parseInt(s.paddingLeft),o-=this._parseInt(s.borderTopWidth)+this._parseInt(s.borderBottomWidth)+this._parseInt(s.paddingTop)+this._parseInt(s.paddingBottom)),window.MSInputMethodContext&&document.documentMode&&--r;const c=parseFloat(s.fontSize),d=1.1*c,l=Math.floor("normal"===s.lineHeight?d:parseFloat(s.lineHeight));if(this._resetCursor(),e.childElementCount&&!n)return this._clampComplexElement(e,r,o,l,t,a);const u=this._clampText({text:n||e.textContent,maxLines:t,ellipsis:a,width:r,height:o,lineHeight:l,style:s.fontStyle||"",variant:s.fontVariant||"",weight:s.fontWeight||"",size:c,family:s.fontFamily||""});return e.textContent=u.text,u}_getComputedStyle(e){const t="__computedStyle";return e[t]||(e[t]=getComputedStyle(e))}_parseInt(e){const t=parseInt(e,10);return isNaN(t)?0:t}_createCanvas(){const e=document.createElement("canvas");return e.width=1,e.height=1,e.getContext("2d")}_resetCursor(){this._x=0,this._y=0,this._line=1}_getFontStyle(e,t){return`${e.style||"normal"} ${e.variant||"normal"} ${t||e.weight||"normal"} ${e.size}px ${e.family||"sans-serif"}`}_setFont(e){this._context||(this._context=this._createCanvas()),this._font=this._getFontStyle(e),this._numericWeight=parseInt(e.weight,10),(this._isExtendedWeight=!isNaN(this._numericWeight)&&400!==this._numericWeight&&700!==this._numericWeight)?(this._context2||(this._context2=this._createCanvas()),this._context.font=this._getFontStyle(e,"normal"),this._context2.font=this._getFontStyle(e,"bold")):this._context.font=this._font}_measureChar(e){const t=this._metrics[this._font]||(this._metrics[this._font]={});let n=t[e];if(n)return n;if(n=this._context.measureText(e).width,this._isExtendedWeight){const t=(this._context2.measureText(e).width-n)/3;n-=(400-this._numericWeight)/100*t}return t[e]=n,n}_clampText(e){const{text:t,width:n,height:i,lineHeight:r,maxLines:o,ellipsis:s=""}=e;if(!t||!t.length||!n||!i||i<r||!o)return{text:"",lines:0};let c,d;this._setFont(e);let l=o===this._line;l&&(this._x+=this._measureChar(s));const u=t.length;for(let e=0;e<u;){const u=t[e],p=this._whitespace.test(u);if(d&&p){++e;continue}const m=this._measureChar(u);if(this._x+m>n){if(l){if(a._SPKillSwitch.isActivated("6b688d74-d791-415e-bc64-83ad5ca6c511"))return{text:t.substring(0,d?e-1:e)+s,didClamp:!0,lines:this._line};{let n=t.substring(0,d?e-1:e);return(f=n.charCodeAt(n.length-1))>=55296&&f<=56319&&(n=n.substring(0,n.length-1)),{text:n+s,didClamp:!0,lines:this._line}}}c&&!p?e=c:p&&++e,this._y+=r,l=++this._line===o||this._y+2*r>i,this._x=l?this._measureChar(s):0,c=0}else(p||this._hyphen.test(u))&&(c=e),this._x+=m,++e;d=p}var f;return{text:t,lines:this._line}}_clampComplexElement(e,t,n,a,i,r){const o=document.createTreeWalker(e,NodeFilter.SHOW_TEXT,null);let s;for(;s=o.nextNode();){const e=this._getComputedStyle(s.parentElement||s.parentNode),c=this._clampText({text:s.nodeValue,maxLines:i,ellipsis:r,width:t,height:n,lineHeight:a,style:e.fontStyle||"",variant:e.fontVariant||"",weight:e.fontWeight||"",size:parseFloat(e.fontSize),family:e.fontFamily||""});if(c.didClamp){for(s.nodeValue=c.text;s=o.nextNode();)s.parentNode.removeChild(s);return c}}}constructor(){this._x=0,this._y=0,this._line=1,this._whitespace=/(?!\xA0)\s/,this._hyphen=/\u2010|\u002d|\u00ad/,this._metrics={}}}function dt(e){return ct.instance.clampText(e)}function lt(e,t,n,a){return ct.instance.clampElement(e,t,n,a)}const ut=e=>dt(e).text;c.loadStyles('.Placeholder{display:flex}.Placeholder.Placeholder--autoHeight .Placeholder-container{height:auto;padding:80px 0}.Placeholder .Placeholder-container{zoom:1;align-items:center;background-color:"[theme:neutralLighter, default: #f3f2f1]";box-sizing:border-box;color:"[theme:neutralSecondary, default: #605e5c]";height:326px;padding:80px 0 0;width:100%}.Placeholder .Placeholder-container:after,.Placeholder .Placeholder-container:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head{zoom:1;box-sizing:border-box;color:"[theme:neutralPrimary, default: #323130]";margin:0 -8px}.Placeholder .Placeholder-container .Placeholder-head:after,.Placeholder .Placeholder-container .Placeholder-head:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container .Placeholder-head:after{clear:both}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-headContainer{height:100%;text-align:center;white-space:nowrap}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-icon{display:inline-block;font-size:42px;font-weight:100;vertical-align:middle;white-space:normal}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{display:inline-block;line-height:normal;vertical-align:middle;white-space:normal}[dir=ltr] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-left:16px}[dir=rtl] .Placeholder .Placeholder-container .Placeholder-head .Placeholder-text{padding-right:16px}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.Placeholder-text-fluent){font-size:28px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text.Placeholder-text-fluent{font-size:"[theme:xLargeFontSize, default: 20px]";font-weight:"[theme:xLargeFontWeight, default: 600]"}.Placeholder .Placeholder-container .Placeholder-head .Placeholder-text:not(.ellipsisKillSwitch){max-width:70%;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.Placeholder .Placeholder-container .Placeholder-description{zoom:1;box-sizing:border-box;margin:0 auto;text-align:center;vertical-align:middle;width:65%}.Placeholder .Placeholder-container .Placeholder-description:after,.Placeholder .Placeholder-container .Placeholder-description:before{content:"";display:table;line-height:0}.Placeholder .Placeholder-container .Placeholder-description:after{clear:both}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText{color:"[theme:neutralSecondary, default: #605e5c]";line-height:23px;margin:20px 0 28px}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-fluent){font-size:17px;font-weight:100}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-fluent{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]"}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText:not(.Placeholder-text-truncate){display:inline-block}.Placeholder .Placeholder-container .Placeholder-description .Placeholder-descriptionText.Placeholder-text-truncate{-webkit-box-orient:vertical;-webkit-line-clamp:3;box-sizing:content-box;display:-webkit-box;max-height:69px;overflow:hidden}.Placeholder .Placeholder-container button{margin:2px 4px}.Placeholder-overlay{height:100%;position:relative;z-index:1}.Placeholder-overlay .Placeholder-spinnerContainer{margin:164px 0;position:relative;width:100%}',!0);class ft extends r.BaseComponent{static get _shouldUseCssClamp(){return void 0===this.__shouldUseCssClamp&&(this.__shouldUseCssClamp=a._BrowserDetection.getBrowserInformation().browser!==a._Browser.IE),this.__shouldUseCssClamp}static _isEllipsisOverflowKillSwitchActivated(){return a._SPKillSwitch.isActivated(a.Guid.parse("e984b51f-12c9-45ea-abba-2dc3869cdc79"),"2018/3/27","ReplaceOverflowingTitleTextWithEllipsis")}UNSAFE_componentWillMount(){this._processLines=this._async.throttle(this._processLines,500)}componentDidMount(){this._processLines(),window.addEventListener("resize",this._handleWindowResize)}componentDidUpdate(e){this.props.description&&this.props.webpartWidth!==e.webpartWidth&&this._processLines()}componentWillUnmount(){window.removeEventListener("resize",this._handleWindowResize)}render(){const{children:t,contentClassName:n,description:a,icon:i,iconText:o}=this.props;this._descriptionId=`description-${Math.random().toString()}`;const s=(0,r.css)("Placeholder-descriptionText",{"Placeholder-text-fluent":!0,"Placeholder-text-truncate":ft._shouldUseCssClamp});let c;return this.props.placeholderHeight&&(c={height:`${this.props.placeholderHeight}px`,paddingTop:(this.props.placeholderHeight-150)/2+"px"}),e.createElement("div",{className:(0,r.css)("Placeholder",n,{"Placeholder--autoHeight":!!t})},e.createElement("div",{className:"Placeholder-container",style:c},e.createElement("div",{className:"Placeholder-head"},e.createElement("div",{className:"Placeholder-headContainer"},i&&e.createElement(r.Icon,{className:"Placeholder-icon",iconName:i}),e.createElement("span",{className:(0,r.css)("Placeholder-text",{ellipsisKillSwitch:ft._isEllipsisOverflowKillSwitchActivated()},{"Placeholder-text-fluent":!0})},o))),e.createElement("div",{className:"Placeholder-description"},e.createElement("span",{className:s,id:this._descriptionId,ref:this._resolveRef("_placeholderDescription")},a)),t,e.createElement("div",{className:"Placeholder-description"},this.buttonElement,this._extraButtonElements)))}get buttonElement(){return this.props.buttonLabel&&this._renderButtonElement({description:this.props.description,label:this.props.buttonLabel,onClick:this.props.onAdd},!0,this.props.buttonDisabled)}focusOnPlaceHolderButton(){this._placeholderButton&&this._placeholderButton.focus()}get _extraButtonElements(){return this.props.extraButtons&&this.props.extraButtons.map((e,t)=>this._renderButtonElement(e,!1))}_processLines(){this._placeholderDescription&&!a._BrowserUtilities.isWebViewHosted()&&lt(this._placeholderDescription,3,this.props.description)}_renderButtonElement(t,n,a){const i=e.createElement(p.PrimaryButton,{componentRef:n&&this._resolveRef("_placeholderButton"),"data-automation-id":"placeholderButton",onClick:t.onClick,ariaDescription:t.description,disabled:a},t.label);return(0,k.Ye)()?function(t){const n={DefaultButton:{styles:st}};return e.createElement(o.Customizer,{scopedSettings:n},t)}(i):i}constructor(...e){super(...e),this._handleWindowResize=()=>{ft._shouldUseCssClamp||this._processLines()}}}const pt=JSON.parse('{"M":"We need you to sign in again. Once you do, we\\u0027ll bring you back here.","S":"Continue"}');class mt extends e.Component{render(){const t=!!this.props.error.redirectUrl,n=t?pt.M:this.props.customErrorMessage||this.props.error.message;return e.createElement("div",{className:this.props.contentClassName},e.createElement(ft,{icon:this.props.webpartIcon||"Permissions",iconText:this.props.webpartName,buttonLabel:t&&pt.S,description:n,onAdd:t&&this._onLogin}))}componentDidMount(){this.props.error.redirectUrl&&this._logAction("Render")}constructor(...e){super(...e),this._onLogin=()=>{this._logAction("Click"),window.location.href=this.props.error.redirectUrl},this._logAction=e=>{const t=new i._LogEntry("OAuthErrorRenderer",`MultiFactorAuthentication.${e}`,i._LogType.Event,{webpartAlias:this.props.webpartAlias});i._EngagementLogger.logEventWithLogEntry(t)}}}const _t="data-sp-scroll-event-listener",ht="scroll",bt="resize";class gt{static get instance(){return void 0===gt._instance&&(gt._instance=new gt),gt._instance}unregister(e,t){a.Validate.isNotNullOrUndefined(t,"unregister callback function"),this._eventListeners.has(t)&&(this._eventListeners.delete(t),(this._scrollableParents&&this._scrollableParents.length?this._scrollableParents:this._findScrollableParents(e)).forEach((e,t,n)=>{this._updateRegisteredChildren(e,-1)<=0&&this._unlistenEvents(e)}),0===this._eventListeners.size&&this._unlistenEvents(window))}_scrollEventHandler(e){this._cachedClientRect&&!this._cacheExpired||(this._cachedClientRect=this._scrollableParents[this._scrollableParents.length-1].getBoundingClientRect(),this._cachedClientRectAge=Date.now()),this._eventListeners.forEach(t=>{t(e,this._cachedClientRect)})}_listenEvents(e){if(!e)return;const t=e===window;(!t||t&&!this._isListeningWindow)&&(this._addEventListener(e),t&&(this._isListeningWindow=!0))}_addEventListener(e){e.addEventListener(ht,this._lazyHandler,!1),e.addEventListener(bt,this._lazyHandler,!1)}_removeEventListener(e){e.removeEventListener(ht,this._lazyHandler),e.removeEventListener(bt,this._lazyHandler)}get _cacheExpired(){return Date.now()-this._cachedClientRectAge>=100}constructor(){this.register=(e,t,n)=>{this._scrollableParents&&this._scrollableParents.length||(this._scrollableParents=n?[n]:this._findScrollableParents(e)),this._scrollableParents.forEach((e,t,n)=>{1===this._updateRegisteredChildren(e,1)&&this._listenEvents(e)}),this._listenEvents(window),this._eventListeners.add(t)},this._findScrollableParents=e=>{const t=[];let n=e;for(;n;)n=gt._findScrollableParent(n),n&&(t.push(n),n=n.parentElement);return t.length?t:[document.body]},this._unlistenEvents=e=>{if(!e)return;const t=e===window;(!t||t&&this._isListeningWindow)&&(this._removeEventListener(e),t&&(this._isListeningWindow=!1))},this._updateRegisteredChildren=(e,t)=>{const n=t+Number(e.getAttribute(_t));return n>0?e.setAttribute(_t,n.toString()):e.removeAttribute(_t),n},this._eventListeners=new Set,this._isListeningWindow=!1,this._lazyHandler=h.throttle(this._scrollEventHandler,10).bind(this)}}gt._findScrollableParent=e=>{let t=e;const n=document.body;for(;t&&t!==n;){if("true"===t.getAttribute("data-is-scrollable"))return t;t=t.parentElement}for(t=e;t&&t!==n;){const e=getComputedStyle(t);if(e){const n=e.getPropertyValue("overflow-y");if(n&&(n===ht||"auto"===n))return t}t=t.parentElement}return t&&t!==n||(t=void 0),t};class vt{static get instance(){return void 0===vt._instance&&(vt._instance=new vt),vt._instance}get isParallaxEnabled(){const e=a._BrowserDetection.getBrowserInformation();return e.browser!==a._Browser.Edge&&e.browser!==a._Browser.IE&&!a._BrowserUtilities.isWebViewHosted()}tryAddParallax(e){const t=this.isParallaxEnabled;if(t){a.Validate.isNotNullOrUndefined(e,"targetElement");const t=(0,r.findScrollableParent)(e),n=t===window?document.body:t;gt.instance.register(e,this._onScroll,n),this._parallaxElements.add(e),e.style.setProperty("will-change","transform")}return t}removeParallax(e){a.Validate.isNotNullOrUndefined(e,"targetElement"),this._parallaxElements.has(e)&&(this._parallaxElements.delete(e),gt.instance.unregister(e,this._onScroll),this._setTranslate(e,0),e.style.removeProperty("will-change"))}_setTranslate(e,t){const n="translate3d(0px,"+t+"px, 0px)";e.style.transform=n}constructor(){this._parallaxElements=new Set,this._parallaxFactor=1.81,this._onScroll=(e,t)=>{window.requestAnimationFrame(this._updateParallax.bind(this,t))},this._updateParallax=e=>{const t=e.top;this._parallaxElements.forEach(e=>{if(e.parentElement){const{top:n,bottom:a}=e.parentElement.getBoundingClientRect();if(n<t&&a>t){const a=Math.round((t-n)/this._parallaxFactor);this._setTranslate(e,a)}else n>=t&&this._setTranslate(e,0)}})}}}function yt(e){return{type:e.type,targetProperty:e.targetProperty,shouldFocus:e.shouldFocus?e.shouldFocus:void 0,properties:e.properties}}function St(e){return e.map(e=>yt(e))}function Dt(e){const t=new v.Uri(e),n=t.getAuthority(),a=t.getPathSegments(),i=t.getQueryParameter("share");return!(0,h.isEmpty)(n)&&a.length>=4&&(/:[A-z]:/.test(a[0])&&/[A-z]/.test(a[1])||!(0,h.isEmpty)(i))}function It(e,t){const n=new i._QosMonitor("redeemShareLinkMonitor"),a="u!"+window.btoa(e).trim().replace(/=+$/,"").replace("/","_").replace("+","-");return t.api(`shares/${a}`).header("Prefer","redeemSharingLink").get().catch(e=>(n.writeUnexpectedFailure("failedToRedeem",e),Promise.reject("Failed to redeem share link."))).then(()=>(n.writeSuccess(),Promise.resolve()))}class xt{static getOpenDocumentAction(e){if(e&&a._BrowserUtilities.isWebViewHosted())return JSON.stringify({key:xt.documentKey,args:{command:xt.documentCommand,url:e,version:"1.0"}})}static get webViewActionRole(){return a._BrowserUtilities.isWebViewHosted()&&!(a._BrowserUtilities.isTeamsWebViewHosted()||a._BrowserUtilities.isTeamsAndroidHosted()||a._BrowserUtilities.isTeamsIOSHosted())?"button":void 0}static get documentKey(){return"openDocument"}static get documentCommand(){return"sitePageUserAction"}}function Ct(){if(MouseEvent instanceof Function)return new MouseEvent("mousemove",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("mousemove",!0,!0),e}c.loadStyles(".l_oIYYJ_-aI_E{cursor:pointer}.l_oIYYJ_-aI_E:hover{outline:none}",!0);const Ot=JSON.parse('{"hT":"Opens Profile Card for {0}","dR":"Opens Profile Card","_Q":"Getting details","Pq":"Topic {0}"}');class wt{static isTenantAdminLightDarkThemeFlightEnabled(){return a._SPFlight.isEnabled(1723)}}var Et=T(134);class At{getLPCLoader(){return Promise.all([T.e(654),T.e(863)]).then(T.bind(T,5807)).then(e=>e.default)}}(0,Ze._ts_decorate)([(0,l.monitor)("LivePersonaCard.Load")],At.prototype,"getLPCLoader",null);const Lt=new At,kt="Mouse";class Mt extends e.PureComponent{static _isLivePersonaCardFlightEnabled(){return a._SPFlight.isEnabled(809)}static get livePersonaCardHoverTarget(){return window.LivePersonaCardHoverTargetV2}componentWillUnmount(){this._isUnMounted=!0}render(){if(this.props.disabled)return e.Children.only(this.props.children);if(wt.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme&&window.LPC?.loadTheme(this._theme),a._BrowserUtilities.isMobileWebView())return e.cloneElement(e.Children.only(this.props.children),{role:"button","data-sp-action":JSON.stringify({key:"viewUserProfileDetails",args:{upn:this.props.legacyUpn,...a._BrowserUtilities.isTeamsVivaMobile()&&{displayName:this.props.displayName}}}),onClick:()=>{}});const t=this.props.useSpan?"span":"div",n=this.props.disableClick?void 0:e=>this._triggerBootstrap(e,kt),i=this.props.disableHover?void 0:e=>this._triggerBootstrap(e,kt),o=this.props.disableHover?void 0:()=>{this.setState({shouldOpenLpcAfterBundleLoaded:!1})};return e.createElement(t,{className:(0,r.css)(this.props.className,"l_oIYYJ_-aI_E"),onClickCapture:n,onKeyDownCapture:this._triggerBootstrapByKeyboard,onMouseOver:i,onMouseLeave:o,ref:this._ref},this._renderContent())}_renderContent(){const t={cardParameters:{personaInfo:{identifiers:{PersonaType:this._personaType,Smtp:this.props.legacyUpn||this.props.email,Upn:this.props.legacyUpn||this.props.upn,TopicId:this.props.topicCardProps?.topicId,...this.props.hostAppPersonaInfo&&{LocationId:this.props.hostAppPersonaInfo.LocationId,OlsPersonaId:this.props.hostAppPersonaInfo.OlsPersonaId,AadObjectId:this.props.hostAppPersonaInfo.PersonaAadObjectId,DisplayName:this.props.hostAppPersonaInfo.PersonaDisplayName}},topicMetadata:this.props.topicCardProps?.topicCardMetadata,displayName:this.props.displayName,personaCoinColor:(0,r.getPersonaInitialsColor)({text:this.props.displayName})},externalAppSessionCorrelationId:this.props.externalAppSessionCorrelationId,behavior:{onCardOpen:this._handleCardOpen,onCardClose:this.props.onCardClose,disableHover:this.props.disableHover,disableClick:this.props.disableClick,cardPlacementMode:this.props.cardPlacementMode,...this.props.locationToOpen&&{locationToOpen:this.props.locationToOpen}},ariaLabel:this.props.ariaLabel,...!(0,Et.jF)()&&{disableAccessibilityDefaults:this.props.disableAccessibilityDefaults}},tabIndex:this.props.tabIndex},n=Boolean(this.props.legacyUpn||this.props.topicCardProps?.topicId||this.props.upn||this.props.email);return n&&this._isLPCBundleLoaded()?e.createElement(Mt.livePersonaCardHoverTarget,{...t,onCardOpen:this._handleCardOpen},e.Children.only(this.props.children)):!n||this._isLPCBundleLoaded()||!(0,Et.jF)()&&this.props.disableAccessibilityDefaults?e.Children.only(this.props.children):e.cloneElement(e.Children.only(this.props.children),{tabIndex:0,"data-is-focusable":!0,role:"button","aria-label":this.props.ariaLabel||(this.props.displayName?a.Text.format(Ot.hT,this.props.displayName):Ot.dR),"aria-haspopup":"dialog"})}_isLPCBundleLoaded(){return this.state.isBundleLoaded&&!!Mt.livePersonaCardHoverTarget}get _logScenario(){return this.props.clientScenario||"unset"}_updateBundleMountedState(e){this.setState({isBundleLoaded:!0},()=>this._manuallyDispatchEventToTriggerCallout(e))}get _clientType(){return this.props.clientType||"SPPeopleWebPart"}get _theme(){return this.props.m365Theme}get _personaType(){return this.props.hostAppPersonaInfo&&this.props.hostAppPersonaInfo.PersonaType||"User"}constructor(t){super(t),this._isUnMounted=!1,this.openCard=e=>{this._triggerBootstrap(e,kt),this._isLPCBundleLoaded()&&this._manuallyDispatchEventToTriggerCallout(Ct())},this._bootstrapLivePersonaCard=e=>!Mt._isLivePersonaCardFlightEnabled()||a._BrowserUtilities.isMobileWebView()?Promise.resolve():Mt.livePersonaCardHoverTarget?(this._updateBundleMountedState(e?.nativeEvent),Promise.resolve()):(this._loadPromise||(this._loadPromise=this._bootstrapCore(e?.nativeEvent)),this._loadPromise),this._bootstrapCore=e=>(i._TraceLogger.logVerbose(this._logSource,"LivePersonaCard._bootstrapCore"),Lt.getLPCLoader().then(e=>e.bootstrap(this.props.serviceScope,this._clientType,this._personaType,this.props.clientScenario,this.props.topicCardProps,...wt.isTenantAdminLightDarkThemeFlightEnabled()&&this._theme?[this._theme]:[],...!(0,Et.Yg)()&&this.props.getLokiAuthToken?[this.props.getLokiAuthToken]:[])).then(()=>{this._isUnMounted||this._updateBundleMountedState(e)}).catch(e=>{i._TraceLogger.logError(this._logSource,e,"BootstrapLivePersonaCard")})),this._manuallyDispatchEventToTriggerCallout=e=>{if(!(0,Et.Up)()&&this.props.openCardBySpaceKeyOnly&&this._ref.current)return(0,r.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),void this._ref.current.firstElementChild?.dispatchEvent(Ct());"keydown"===e?.type&&this._ref.current&&((0,r.getFirstTabbable)(this._ref.current,this._ref.current,!0)?.focus(),this._ref.current.firstElementChild?.dispatchEvent(function(){if(KeyboardEvent instanceof Function)return new KeyboardEvent("keydown",{bubbles:!0,cancelable:!0,key:"Enter",code:"Enter",keyCode:13,which:13});const e=document.createEvent("KeyboardEvent");return e.initKeyboardEvent("keydown",!0,!0,window,"Enter","Enter",0,"",!1),e}())),"mouseover"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableHover&&this._ref.current.firstElementChild?.dispatchEvent(Ct()),"click"===e?.type&&this._ref.current&&this.state.shouldOpenLpcAfterBundleLoaded&&!this.props.disableClick&&this._ref.current.firstElementChild?.dispatchEvent(function(){if(MouseEvent instanceof Function)return new MouseEvent("click",{bubbles:!0,cancelable:!0});const e=document.createEvent("MouseEvent");return e.initEvent("click",!0,!0),e}())},this._triggerBootstrap=(e,t)=>{i._EngagementLogger.logEventWithLogEntry(new i._LogEntry("LivePersonaCard",`${this._logScenario}.Trigger`,i._LogType.Event,{hasUPN:Boolean(this.props.legacyUpn||this.props.upn).toString(),source:t,isBundleLoaded:this.state.isBundleLoaded.toString()})),this._isLPCBundleLoaded()||(this.setState({shouldOpenLpcAfterBundleLoaded:!0}),this._bootstrapLivePersonaCard(e).catch(this._traceBootstrapFailure))},this._triggerBootstrapByKeyboard=e=>{"Enter"===e.key&&(this._triggerBootstrap(e,"Keyboard"),this._isLPCBundleLoaded()||((0,Et.XA)()?l.ScreenReaderAlert.read(Ot._Q):d.read(Ot._Q)))},this._handleCardOpen=()=>{i._EngagementLogger.logEvent(`LivePersonaCard.${this._logScenario}`,"Open");const{onCardOpen:e}=this.props;e&&e()},this._traceBootstrapFailure=e=>{i._TraceLogger.logError(this._logSource,e,"LivePersonaCard.bootstrap")},this._logSource=i._LogSource.create("LivePersonaCard"),this._ref=e.createRef(),this.state={isBundleLoaded:!1,shouldOpenLpcAfterBundleLoaded:!1}}}function Pt(t){const n=a.Text.format(Ot.Pq,t.displayName||""),i=new URL(window.location.href).pathname.toLowerCase();return e.createElement(Mt,{ref:t.lpcRef,...t,ariaLabel:t.ariaLabel||n,...-1!==i.toLowerCase().indexOf("_layouts/15/")&&{topicCardProps:{...t.topicCardProps,topicCardMetadata:{...t.topicCardProps?.topicCardMetadata,hideFeedbackQuestions:!0,hideEntityAndContextQuestion:!0}}}})}class Tt{static GetUtilities(){return Tt._promise||(Tt._promise=T.e(460).then(T.bind(T,3212))),Tt._promise}}function Ut(t){return e.createElement("div",{className:"e_50f1K_-aI_E"},e.createElement(r.Icon,{className:"e_Ni40v_-aI_E",iconName:t}))}function Ft(e){return"CanvasWebPartHost.Amplify.EmailEndpoint"===e}function Ht(e){return"CanvasWebPartHost.Amplify.TeamsEndpoint"===e}function Rt(e){return"CanvasWebPartHost.Amplify.EngageEndpoint"===e}function Nt(e){return"CanvasWebPartHost.Amplify.SharePointEndpoint"===e}function Bt(e){return Ht(e)||Rt(e)}function jt(e){return Ft(e)||Ht(e)}function Vt(e){return Ft(e)||Ht(e)||Rt(e)}function zt(e){return"CanvasWebPartHost.Amplify.Main"===e}function Gt(e){return e?.includes("CanvasWebPartHost.Amplify.")}c.loadStyles('.e_50f1K_-aI_E{background-color:"[theme:black, default: #000000]";cursor:pointer;height:100%;opacity:.5;position:absolute;text-align:center;top:0;width:100%;z-index:2}.e_Ni40v_-aI_E{color:"[theme:white, default: #ffffff]";font-size:68px;position:absolute;top:50%;transform:translate(-50%,-50%)}[dir=ltr] .e_Ni40v_-aI_E{left:50%}[dir=rtl] .e_Ni40v_-aI_E{right:50%}',!0);const Kt=new RegExp(/^https:\/\/[a-zA-Z0-9-]+\.sharepoint(-df)?\.com\/:v:\/[a-z]+\/([%\w-._]+\/)*(.+?\.(3g2|3gp|3gpp|asf|avi|m2ts|m4v|mkv|mov|mp4|mp4v|mts|ts|webm|wmv|3G2|3GP|3GPP|ASF|AVI|M2TS|M4V|MKV|MOV|MP4|MP4V|MTS|TS|WEBM|WMV)|[A-Za-z0-9_-]{1,})(\?.+)?$/),Wt="/_layouts/15/images/sitepagethumbnail.png";function qt(){return l.UrlUtility.absolutizeUrl(Wt)}function Qt(e){return Kt.test(e)}var Yt=T(5494);const Jt=JSON.parse('{"N":"Open link in a new tab"}'),Xt=Jt.N;function Zt(t){const{onChange:n,value:a,featureId:r}=t,o=e.useCallback((e,t)=>{n(t.checked),i._EngagementLogger.log({name:`SPPages.${r}OpenInNewTab.Select`,extraData:{instanceId:r,openInnewTab:t.checked}})},[r,n]);return e.createElement(Yt.Switch,{label:{children:Jt.N,style:{paddingLeft:0}},labelPosition:"after",role:"checkbox",onChange:o,checked:!!a,"data-automation-id":"openInNewTabCpanetoggle"})}})(),B})())})();