define("2c950d8f-3a0f-45af-9963-41b17249c30b_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-core-library"],(e,t)=>(()=>{"use strict";var n={676:e=>{e.exports=t},207:t=>{t.exports=e}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return n[e](r,r.exports,i),r.exports}i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};return(()=>{var e,t,n,a,o,s;i.r(r),i.d(r,{HubbleStockImageProvider:()=>p,KeyPhrasesProvider:()=>m,RankInfo:()=>b,RankRewardSuggestionsProvider:()=>h,TranslateContentProvider:()=>_,fetchHubble:()=>v,translateAndFetchHubble:()=>g}),function(e){e.Attribution="Attribution",e.ContentProvider="ContentProvider",e.ContentSource="ContentSource",e.ContentTier="ContentTier",e.ContentType="ContentType",e.Description="Description",e.PivotNames="PivotNames",e.ForeignID="ForeignID",e.Id="Id",e.IsNew="IsNew",e.LicenseLink="LicenseLink",e.OriginId="OriginId",e.PivotId="PivotId",e.SearchScore="SearchScore",e.Thumbnail="Thumbnail",e.Keywords="Keywords",e.Composer="Composer"}(e||(e={})),function(e){e.Image="Image",e.SVG="SVG",e.SmallThumbnail="SmallThumbnail",e.MediumThumbnail="MediumThumbnail",e.LargeThumbnail="LargeThumbnail",e.XLargeThumbnail="XLargeThumbnail",e.XXLargeThumbnail="XXLargeThumbnail",e.XSmallThumbnail="XSmallThumbnail"}(t||(t={})),function(e){e.LoopingVideos="32318599-a475-448c-a583-7aadf5e41c8c",e.Icons="f9a6197b-243d-4381-ad7d-43250cb11014",e.Illustrations="5c594da3-1700-4c4e-824b-dbefe528f53b",e.CartoonPeople="71309e27-d6ab-4fa5-865c-60d4e6d863b3",e.Images="f8218404-63dd-4670-b0f5-f8b50674f963",e.AiGeneratedImages="60f8b9be-536b-4a0f-9552-f3321c243f86",e.CutoutPeople="42fea961-805e-4900-a0f5-7288c55d7780",e.Stickers="0678df82-d05e-475d-9c04-5daa1f5c6d55",e.Annotations="0b60f44c-a895-4414-ab8f-6f62b5de973c",e.Shapes="9409ec95-a250-402e-8609-319208802c02",e.Emojis="84e04d41-3574-4764-a2d3-c24ae80c75eb",e.Audios="72b42841-c22c-44fd-9ac3-964371503269",e.SFX="dbddd5cf-9502-42f3-bee8-9ad41a2b6ff8",e.Overlays="c4d5cd5-eaf3-47da-8b3c-0a6bced0fe71",e.Filters="9e3db81f-2412-4606-88a7-18902fae34a6",e.Transitions="0629c8e7-8f4c-4138-bf04-816285391431",e.ClipchampIcons="01234567-89ab-cdef-0123-456789abcdef",e.Backgrounds="12345678-90ab-cdef-1234-567890abcdef",e.ClipchampStickers="f3e2d1c0-b9a8-7654-3210-fedcba987654",e.ClipchampAnnotations="456789ab-cdef-0123-4567-89abcdef0123",e.ClipchampShapes="98765432-10fe-dcba-9876-543210fedcba",e.Frames="0fedcba9-8765-4321-0abc-def123456789"}(n||(n={})),function(e){e.Icon="Icon",e.Image="Image",e.Video="Video",e.Audio="Audio",e.Collection="Collection",e.PowerpointTemplate="PowerpointTemplate",e.WordTemplate="WordTemplate",e.ClipchampTemplate="ClipchampTemplate",e.PromptTemplate="PromptTemplate",e.Folder="Folder"}(a||(a={})),function(e){e.My="My",e.Stock="Stock",e.Enterprise="Enterprise",e.External="External",e.Clipchamp="Clipchamp",e.Brand="Brand",e.Cit="Cit"}(o||(o={})),function(e){e.Bing="Bing",e.Getty="Getty",e.GettyVideo="GettyVideo",e.Giphy="Giphy",e.GooglePhotos="GooglePhotos",e.Hubble="Hubble",e.OneDrivePhotos="OneDrivePhotos",e.Shutterstock="Shutterstock",e.StockImages="StockImagesSearch",e.Storyblocks="Storyblocks",e.TAS="TAS",e.TasFirstPartyImageSearch="TasFirstPartyImageSearch",e.Tenor="Tenor",e.Cit="Cit",e.Unknown="Unknown",e.BrandKit="BrandKit",e.OAL="OAL",e.Templafy="Templafy",e.AdobeExpManager="AdobeExpManager"}(s||(s={}));var c=i(207),d=i(676);function l(){return d._SPKillSwitch.isActivated("0e9f5a95-9c99-4a3b-a9d1-4f689cf06d1b")}function u(){return d._SPKillSwitch.isActivated("b9dd7407-391f-4520-a294-e9f0a094cfb0")}const f={[t.XSmallThumbnail]:"xSmall",[t.SmallThumbnail]:"small",[t.MediumThumbnail]:"medium",[t.LargeThumbnail]:"large",[t.XLargeThumbnail]:"xLarge",[t.XXLargeThumbnail]:"xxLarge"};class p{async getHubbleStockImages(e,t,n,a=!1,i,r){if(this._alProxy)try{return d._SPKillSwitch.isActivated("0ea66954-02fd-42fe-9cc9-d3a1d7848f82")?this._getHubbleStockImagesWithoutTimeout(e,t,n,a):this._getHubbleStockImagesWithTimeout(e,t,n,a,i,r)}catch(e){return void this._qosMonitor.writeUnexpectedFailure("HubbleStockImageFailed",e)}else c._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getHubbleStockImages")}_getHubbleStockImagesWithoutTimeout(e,t,n,a){return this._alProxy?.findProviderContentAnnotationImages(e,void 0,t,n).then(e=>{if(this._qosMonitor.writeSuccess(),e){const t=e.data.Result.PartGroups;return this._parseImages(t,a)}})}_getHubbleStockImagesWithTimeout(e,t,n,a,i,r){let s;const c=u()?3e4:1e4,l=new Promise(e=>{s=setTimeout(()=>{this._qosMonitor.writeExpectedFailure("Timeout",void 0),e(void 0)},c)});return Promise.race([l,this._alProxy?.findProviderContentAnnotationImages(e,void 0,t,n,i?o.External:o.Stock,r)]).then(e=>{if(e){if(d._SPKillSwitch.isActivated("5f34b48a-b271-4a63-aa40-3db5cf11dc9f")||clearTimeout(s),"Success"===e?.data.Status){this._qosMonitor.writeSuccess();const t=e.data.Result.PartGroups;return this._parseImages(t,a)}throw new Error(e?.data.Error)}})}_parseImages(n,a){const i=[];return n.forEach(n=>{let r;a&&(r={},l()?r={small:{height:n.ImageParts[1].Height,width:n.ImageParts[1].Width,url:n.ImageParts[1].SourceUrl},medium:{height:n.ImageParts[2].Height,width:n.ImageParts[2].Width,url:n.ImageParts[2].SourceUrl},large:{height:n.ImageParts[3].Height,width:n.ImageParts[3].Width,url:n.ImageParts[3].SourceUrl},xLarge:{height:n.ImageParts[4].Height,width:n.ImageParts[4].Width,url:n.ImageParts[4].SourceUrl}}:n.ImageParts.forEach(e=>{e.ImageCategory!==t.Image&&e.ImageCategory!==t.SVG&&r&&(r[f[e.ImageCategory]]={url:e.SourceUrl,width:e.Width,height:e.Height})})),(l()||n.ImageParts.length)&&i.push({url:n.ImageParts[0].SourceUrl,width:n.ImageParts[0].Width,height:n.ImageParts[0].Height,description:n.TextParts?.find(t=>t.TextCategory===e.Description)?.Text,previewThumbnails:r,id:n.TextParts?.find(t=>t.TextCategory===e.Id)?.Text,contentProvider:n.TextParts?.find(e=>"ContentProvider"===e.TextCategory)?.Text})}),i}constructor(e){this._logSource=c._LogSource.create("HubbleStockImageProvider"),this._qosMonitor=new c._QosMonitor("HubbleStockImageProvider"),this._alProxy=e}}class m{async getKeyPhrases(e,t){if(this._alProxy)try{return d._SPKillSwitch.isActivated("16c2e9a6-7224-4ee0-8cd1-5a118aa5a3a5")?this._getKeyPhrasesWithoutTimeout(e,t):this._getKeyPhrasesWithTimeout(e,t)}catch(e){return void this._qosMonitor.writeUnexpectedFailure("KeyPhrasesProviderFailed",e)}else c._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getKeyPhrases")}_getKeyPhrasesWithTimeout(e,t){const n=u()?3e4:1e4,a=new Promise(e=>{setTimeout(()=>{this._qosMonitor.writeExpectedFailure("Timeout",void 0),e(void 0)},n)});return Promise.race([a,this._alProxy?.getKeyPhrases(e,t)]).then(e=>{if(e){if(e)return this._qosMonitor.writeSuccess(),e.keyPhrases;throw new Error("Response undefined")}})}_getKeyPhrasesWithoutTimeout(e,t){return this._alProxy?.getKeyPhrases(e,t).then(e=>(this._qosMonitor.writeSuccess(),e?e.keyPhrases:void 0))}constructor(e){this._logSource=c._LogSource.create("KeyPhrasesProvider"),this._qosMonitor=new c._QosMonitor("KeyPhrasesProvider"),this._alProxy=e}}class _{async getTranslatedContent(e,t,n,a,i){if(this._alProxy)try{return this._alProxy.translateContent(e,t,n,a,i).then(e=>(this._qosMonitor.writeSuccess(),e?e.translatedContent?.TranslatedText:void 0))}catch(e){return void this._qosMonitor.writeUnexpectedFailure("TranslateContentProviderFailed",e)}else c._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getTranslatedContent")}constructor(e){this._logSource=c._LogSource.create("TranslateContentProvider"),this._qosMonitor=new c._QosMonitor("TranslateContentProvider"),this._alProxy=e}}class h{async rank(e){if(!this._alProxy)return void c._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getRankSuggestions");const t=new c._QosMonitor("RankSuggestions");try{return this._alProxy.rankSuggestions(e).then(e=>e.error?void t.writeExpectedFailure("RankSuggestionsWorkflowFailed",{name:"RankSuggestionsWorkFlowError",message:e.error}):(t.writeSuccess(),{eventId:e.eventId,recommendationId:e.probableAction})).catch(e=>{t.writeUnexpectedFailure("RankSuggestionsWorkflowFailed",e)})}catch(e){t.writeUnexpectedFailure("RankSuggestionsAlProxyFailed",e)}}async reward(e){if(!this._alProxy)return void c._TraceLogger.logVerbose(this._logSource,"AL proxy is not available","getRewardSuggestions");const t=new c._QosMonitor("RewardSuggestion");try{return this._alProxy.rewardSuggestion(e).then(e=>{e.error?t.writeExpectedFailure("RewardSuggestionWorkflowFailed",{name:"RewardSuggestionWorkFlowError",message:e.error}):t.writeSuccess()}).catch(e=>{t.writeUnexpectedFailure("RewardSuggestionWorkflowFailed",e)})}catch(e){t.writeUnexpectedFailure("RewardSuggestionAlProxyFailed",e)}}constructor(e){this._logSource=c._LogSource.create("RankRewardSuggestionsProvider"),this._alProxy=e}}class b{constructor(e,t){this.recommendationId=e,this.eventId=t}}async function g({alProxy:e,prompt:t,sourceLanguage:n,useTas:a=!0,pageSize:i,includePreviewThumbnails:r=!0,includeGettyImages:o=!0,pageOffset:s=0}){const c=new p(e),d=new _(e),l=n?await d.getTranslatedContent(t,n,"en-us",void 0,!0)??t:t;return c.getHubbleStockImages(l,a,i,r,o,s.toString())}async function v({alProxy:e,prompt:t,useTas:n=!0,pageSize:a,includePreviewThumbnails:i=!0,includeGettyImages:r=!0,pageOffset:o=0}){return new p(e).getHubbleStockImages(t,n,a,i,r,o.toString())}})(),r})());