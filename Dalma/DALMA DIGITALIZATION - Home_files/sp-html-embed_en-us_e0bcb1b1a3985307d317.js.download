define("3fbad3f4-a628-41b0-8694-2054c09edccd_1.0.3",["react","@msinternal/sp-component-utilities","@msinternal/odsp-utilities-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-diagnostics","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@msinternal/sharepoint-ui-react-stable-bundle","@microsoft/sp-core-library","@microsoft/sp-loader","@msinternal/sp-telemetry","@msinternal/sharepoint-ui-tokens-bundle","@msinternal/sp-fluentui-migration-link-bundle","@msinternal/sp-fluentui-migration-image-bundle","@msinternal/swc-helpers-bundle","@microsoft/sp-http","@microsoft/sp-page-context"],(e,t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h)=>(()=>{"use strict";var b={424:e=>{e.exports=o},676:e=>{e.exports=c},207:e=>{e.exports=i},909:e=>{e.exports=_},414:e=>{e.exports=d},529:e=>{e.exports=a},408:e=>{e.exports=h},141:e=>{e.exports=r},810:e=>{e.exports=n},899:e=>{e.exports=s},930:e=>{e.exports=u},718:e=>{e.exports=t},580:e=>{e.exports=p},95:e=>{e.exports=f},519:e=>{e.exports=l},592:e=>{e.exports=m},959:t=>{t.exports=e}},g={};function v(e){var t=g[e];if(void 0!==t)return t.exports;var n=g[e]={exports:{}};return b[e](n,n.exports,v),n.exports}v.d=(e,t)=>{for(var n in t)v.o(t,n)&&!v.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},v.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var y={};return(()=>{var e,t,n;v.r(y),v.d(y,{EmbedCodeShownType:()=>t,EmbedCodeType:()=>e,EmbedDataSourceType:()=>n,EmbedServiceResponseCode:()=>c,EmbeddableServiceFactory:()=>q,HTMLEmbed:()=>N,HtmlValidator:()=>p,O365VideoEmbeddableService:()=>Q,O365VideoIframeUtilities:()=>Y,SPEmbeddableService:()=>W,getEmbedServiceClassName:()=>d}),function(e){e[e.Url=0]="Url",e[e.VanillaHtml=1]="VanillaHtml"}(e||(e={})),function(e){e[e.BingPreviewStyle=0]="BingPreviewStyle",e[e.ContentStyle=1]="ContentStyle"}(t||(t={})),function(e){e[e.RawDataSource=1]="RawDataSource",e[e.DataProvider=2]="DataProvider"}(n||(n={}));var a=v(959),i=v(718),r=v(810),o=v(529),s=v(207);const c={OK:0,EmbedServiceInternalError:1,NoSupportedEmbedService:2,GetEmbedCodeError:3,SharePointPageNoPermission:4,NotAllowEmbed:5};function d(e){return e?e.constructor.toString().match(/\w+/g)[1]:""}const l="video",u="unknown";var f=v(141);const p=class{validate(e){return this._internalValidate(e).then(t=>!t.isValid&&this._successorValidator?this._successorValidator._internalValidate(e):t).catch(e=>e)}setSuccessorValidator(e){this._successorValidator=e}},m=class extends p{getMaxWidthStyle(){return{maxWidth:this.getWidth()}}getPaddingBottomStyle(){const e=this.getWidth(),t=this.getHeight();return{paddingBottom:100*(e?t/e:0)+"%"}}setMobileMode(e){this._htmlGeneratorProps.isNarrowContainer=e}setVariantTheme(e){this._htmlGeneratorProps.variantTheme=e}setAltText(e){this._htmlGeneratorProps.altText=e}setContainerRect(e){this._htmlGeneratorProps.htmlEmbedRect=e}constructor(e){super(),this._htmlGeneratorProps=e}};class _{static createHTMLElement(e,t,n){const a=_._createSafeHTMLElement(e.vanillaHtml,t,n);if(a){a.setAttribute("tabindex","-1"),_.moveRectFromStyle2Attribute(a);const t=_.getScaledDomRect(a,e.htmlEmbedRect,e.shouldScale);t&&t.width&&a.setAttribute("width",t.width.toString()),t&&t.height&&a.setAttribute("height",t.height.toString())}return a}static createElementByTagName(e,t){const n=document.createElement("div");return n.innerHTML=e,n.getElementsByTagName(t)[0]}static getScaledDomRect(e,t,n){if(!e)return;const a={width:parseInt(e.getAttribute("width"),10),height:parseInt(e.getAttribute("height"),10)};if(a.width<=0||a.height<=0||isNaN(a.width)||isNaN(a.height))return;(!t||t.width<=0||t.height<=0)&&(t=a);const i=-1===e.getAttribute("width").indexOf("%")?a.width:t.width*(a.width/100),r=-1===e.getAttribute("height").indexOf("%")?a.height:t.height*(a.height/100);return{width:Math.ceil(n?t.width:i),height:Math.ceil(n?t.width*(r/i):r)}}static moveRectFromStyle2Attribute(e){_._moveStylePropertyToAttribute(e,"width"),_._moveStylePropertyToAttribute(e,"height")}static scaleZeroRectByRatio(e,t){const n=e;return!e||e.width<=0&&e.height<=0||(e.width<=0&&(n.width=e.height*t),e.height<=0&&(n.height=e.width/t)),n}static getHostnameFromUrl(e){let t="";if(e){const n=/^\s*(http:\/\/|\/\/|https:\/\/)[^\/]+/i.exec(e);n&&n.length&&(t=n[0].replace(/^\s*(http:\/\/|\/\/|https:\/\/)/i,""))}return t}static _createSafeHTMLElement(e,t,n){const a=_.createElementByTagName(e,t);if(!a)return a;const i=[];for(let e=0;e<a.attributes.length;e++){const t=a.attributes[e];let r=!1;n.forEach(e=>{t.name===e.toLowerCase()&&(r=!0)}),r||i.push(t.name)}return i.map(e=>{a.removeAttribute(e)}),a.innerHTML="",a}static _moveStylePropertyToAttribute(e,t){if(e.style&&e.style[t]){const n=e.style[t];e.setAttribute(t,/em$/i.test(n)?_._convertEmToPx(n):n),e.style.removeProperty(t)}}static _getEmPxScaleRate(){return parseInt(window.getComputedStyle(document.body,void 0).getPropertyValue("font-size"),10)||16}static _convertEmToPx(e){return(parseInt(e,10)*_._getEmPxScaleRate()).toString()}}const h=JSON.parse('{"ContentEmbedTitle":"Embed","VideoEmbedTitle":"Office 365 Video","ContentEmbedCode":"WebSite address or embed code","ContentEmbedLabel":"You can display content from some websites simply by pasting the address below. If that doesn\\u0027t work, you\\u0027ll need to paste the embed code instead.","VideoEmbedVideoLabel":"Display an Office 365 video on your page. Find the video you want on the Office 365 video portal, and then paste its web address below.","VideoEmbedURL":"Video address","VideoEmbedShowInfo":"Show title and video info","InvalidVideoURL":"This address doesn\\u0027t seem to be an Office 365 video. Check the address and try again.","UseIframeTag":"This embed code doesn\\u0027t seem to work. We only support iframe based embeds.","IllegalRenderErrorMessage":"We can\\u0027t show this embedded content because the code seems to be incomplete. Make sure that the embed code includes width, height and a valid address for the src attribute.","SrcCheckWaitingTips":"Verifying the Office 365 video...","HTMLEmbedWebPartAriaLabel":"Press enter or the Down arrow key to enter the embedded content.","IllegalSrc":"Embedding content from this website isn\\u0027t allowed. This is a setting your admin can change.","BasicGroupName":"Basic","DisplayGroupName":"Display","SourceCheckFormatError":"We can\\u0027t verify this Office 365 video file.","EmptyPlaceholderContentEmbedWebPartIconLabel":"Embed","EmptyPlaceholderContentEmbedWebPartDescription":"Enrich your page by displaying content from other websites. For example, you can embed a YouTube video, or show Bing Maps for people to get directions. ","EmptyPlaceholderEmbededVideoWebPartIconLabel":"Office 365 Video","EmptyPlaceholderEmbededVideoWebPartDescription":"Display a video from your organization\\u0027s Office 365 Video channels, so people can watch it directly on your page.","OpenPropertyPaneButtonLabel":"Add embed code","AddVideoButtonLabel":"Add video","AddEmbedCodeButtonLabel":"Add embed code","CaptionPlaceholder":"Add a caption","UseHTTPS":"We only support embedding content from secure websites (their addresses start with https.) If it\\u0027s important to embed content from unsecured websites, please send us feedback.","DisableEmbed":"The owner of this content doesn\\u0027t allow embedding.","LearnMore":"Learn More","HintTextForEmbedScreenReader":"Paste either website address or embed code here","HintTextForEmbed":"https://www.youtube.com/watch?v=...\\r\\nor\\r\\n<iframe width=\\u0022853\\u0022 height=\\u0022480\\u0022...","HintTextForVideoScreenReader":"Paste Office 365 video address here","AccessibleHintTextTemplate":"{0} {1}.","HintTextForVideo":"https://contoso.sharepoint.com/portals/hub/...","EmbedSuccessPrompt":"Embedded the content successfully","VideoEmbedSuccessPrompt":"Embedded the video successfully","UnsupportedEmbedUrl":"This website doesn\\u0027t support embedding using just the address. Try pasting the embed code instead. If it\\u0027s important to embed from this site using just the address, please send us feedback.","TextAreaHint":"This is a multiline text box.","VideoChannelUrlName":"Go to your organization\\u0027s video portal","OnlyChannelUrlError":"This seems like the web address for a video channel, which can contain several videos. Click on the video you want to display from that channel and paste that address instead.","FitToWidth":"Resize to fit the page","NotSettingEmbedableService":"Have not set embedableService","HTMLEmbedBoundingRectZero":"Bounding Zone of HTMLEmbed is 0","ThumbnailLoadError":"Fail to access image source from thumbnail URL","ThumbnailAriaLabel":"{0} home"}');var b=v(424);b.loadStyles('.H_opqjf_G4YWn{margin:0 auto}.H_opqjf_G4YWn .e_LxIE9_G4YWn iframe{height:100%;left:0;position:absolute;right:0;top:0;width:100%}.H_opqjf_G4YWn .e_LxIE9_G4YWn iframe,.H_opqjf_G4YWn .i_KsLmk_G4YWn{border:none;display:block;margin:0 auto}.H_opqjf_G4YWn [contentEditable=true]:empty:before{color:"[theme:neutralSecondaryAlt, default: #8a8886]";content:attr(placeholder);display:block}.e_LxIE9_G4YWn{border:none;display:block;height:0;overflow:hidden;position:relative}.b_5h0Tx_G4YWn{background-color:"[theme:black, default: #000000]"}',!0);class g extends m{createHtmlElement(){const e=(0,f.css)("H_opqjf_G4YWn",this._htmlGeneratorProps.className);return a.createElement("div",{className:e,style:this.getMaxWidthStyle()},a.createElement("div",{role:"row",className:"e_LxIE9_G4YWn","data-automation-id":"embedCode",tabIndex:0,style:this.getPaddingBottomStyle(),onKeyDown:this._handleKeyDown,"aria-label":h.HTMLEmbedWebPartAriaLabel,ref:this._createBorderRef},a.createElement("div",{dangerouslySetInnerHTML:{__html:this.getFilteredVanillaHtml()}})))}getFilteredVanillaHtml(){return this._htmlElement?this._htmlElement.outerHTML:""}focus(){this._borderDiv&&this._borderDiv.focus()}_internalValidate(e){const t=_.createElementByTagName(e,g._tagName);if(!t)return Promise.reject({isValid:!1,errorMessage:h.UseIframeTag});const n=g._srcProtocolRegExp.test(t.getAttribute("src")),a=parseInt(t.getAttribute("width"),10)&&g._widthAndHeightRegExp.test(t.getAttribute("width")),i=parseInt(t.getAttribute("height"),10)&&g._widthAndHeightRegExp.test(t.getAttribute("height"));return n&&a&&i?Promise.resolve({isValid:!0,errorMessage:""}):Promise.reject({isValid:!1,errorMessage:h.IllegalRenderErrorMessage})}getWidth(){return parseInt(this._htmlElement.getAttribute("width"),10)}getHeight(){return parseInt(this._htmlElement.getAttribute("height"),10)}_handleKeyDown(e){if(e.keyCode===f.KeyCodes.enter||e.keyCode===f.KeyCodes.down){e.preventDefault();const t=e.target.firstChild.firstChild;t instanceof HTMLElement&&t.focus()}}constructor(e){super(e),this._createBorderRef=e=>{this._borderDiv=e},this._handleKeyDown=this._handleKeyDown.bind(this),e.vanillaHtml&&(this._htmlGeneratorProps.htmlEmbedRect=_.scaleZeroRectByRatio(this._htmlGeneratorProps.htmlEmbedRect,g._defaultWidthHeightScale),this._htmlElement=_.createHTMLElement(e,g._tagName,g._safeAttributes),this._htmlElement&&!this._htmlElement.getAttribute("allowfullscreen")&&this._htmlElement.setAttribute("allowfullscreen",""))}}g._defaultWidthHeightScale=1.5,g._tagName="iframe",g._srcProtocolRegExp=/^http:\/\/|^\/\/|^https:\/\//i,g._widthAndHeightRegExp=/^[0-9]+/i,g._safeAttributes=["align","frameborder","height","longdesc","marginheight","marginwidth","name","scrolling","src","srcdoc","width","allowfullscreen","class","style"];class S extends m{createHtmlElement(){const e=this.getWidth(),t=i.ThumbnailUrlGenerator.updateThumbnailWidth(this._htmlGeneratorProps.metadata.Thumbnail,e);return a.createElement("a",{href:t,target:"_blank",ref:this._createThumbnailRef,rel:"noreferrer"},a.createElement("img",{src:t,width:e,height:this.getHeight(),alt:"",role:"presentation"}))}getFilteredVanillaHtml(){return""}focus(){this._thumbnailLink&&this._thumbnailLink.focus()}_internalValidate(e){return this._htmlGeneratorProps.metadata&&this._htmlGeneratorProps.metadata.Thumbnail?Promise.resolve({isValid:!0,errorMessage:""}):Promise.resolve({isValid:!1,errorMessage:h.IllegalRenderErrorMessage})}getWidth(){return this._htmlGeneratorProps.shouldScale&&this._htmlGeneratorProps.htmlEmbedRect.width?this._htmlGeneratorProps.htmlEmbedRect.width:500}getHeight(){return this._htmlGeneratorProps.shouldScale&&this._htmlGeneratorProps.htmlEmbedRect.height?this._htmlGeneratorProps.htmlEmbedRect.height:500}constructor(e){super(e),this._createThumbnailRef=e=>{this._thumbnailLink=e},this._htmlGeneratorProps.htmlEmbedRect=_.scaleZeroRectByRatio(this._htmlGeneratorProps.htmlEmbedRect,S._defaultWidthHeightScale)}}S._defaultWidthHeightScale=1.5;var D=v(592),I=v(95),x=v(899),C=v(580),O=v(676),w=v(414),E=v(519);function A(){return O._SPKillSwitch.isActivated("4c979778-d9d2-48d2-b40d-f41772ffa147")}function L(){return O._SPKillSwitch.isActivated("d552b8fa-89eb-41d7-9cb3-483395b72ed6")}var k=v(930);const M=(0,f.classNamesFunction)(),P=e=>{const t=e.variantTheme;return{title:{color:t&&t.semanticColors.actionLink,selectors:{"&:focus":{color:t&&t.semanticColors.actionLinkHovered},"&:hover":{color:t&&t.semanticColors.actionLinkHovered}},...k.typographyStyles.custom.subtitle2},subTitle:{color:t&&t.semanticColors.bodySubtext,...k.typographyStyles.custom.caption1},description:{color:t&&t.semanticColors.bodySubtext,...k.typographyStyles.custom.body1},dividerBorder:{borderTop:t&&`1px solid ${t.semanticColors.bodyDivider}`,borderBottom:t&&`1px solid ${t.semanticColors.bodyDivider}`}}};b.loadStyles('.b_jHVVF_G4YWn{display:flex;margin:8px 0;padding:20px 0;width:100%}.w_JBdiS_G4YWn{flex-wrap:wrap;padding:0 0 20px}.w_JBdiS_G4YWn.f_nY397_G4YWn{flex-wrap:nowrap}.w_JBdiS_G4YWn .m_1d6Hc_G4YWn,.w_JBdiS_G4YWn .t_46VGX_G4YWn{margin-top:20px}.t_46VGX_G4YWn{display:block}[dir=ltr] .t_46VGX_G4YWn{margin-right:20px}[dir=rtl] .t_46VGX_G4YWn{margin-left:20px}.t_O6LAD_G4YWn{outline:0;position:relative}.m_1d6Hc_G4YWn{min-width:1px}[dir=ltr] .m_1d6Hc_G4YWn{padding-right:30px}[dir=rtl] .m_1d6Hc_G4YWn{padding-left:30px}.t_Hw2qO_G4YWn{word-wrap:break-word;display:inline-block;width:100%}[dir=ltr] .t_Hw2qO_G4YWn{margin-right:20px}[dir=rtl] .t_Hw2qO_G4YWn{margin-left:20px}.m_CX11T_G4YWn.t_fMVwI_G4YWn{-webkit-box-orient:vertical;-webket-line-clamp:2;box-sizing:content-box;display:-webkit-box;max-height:2.7em;overflow:hidden}.m_LHgPy_G4YWn{line-height:17px}.m_LHgPy_G4YWn:not(.f_hkfft_G4YWn){font-size:17px;font-weight:300}.m_LHgPy_G4YWn.f_hkfft_G4YWn{font-size:"[theme:mediumPlusFontSize, default: 16px]";font-weight:"[theme:mediumPlusFontWeight, default: 400]";font-weight:600}.m_LHgPy_G4YWn.t_fMVwI_G4YWn{-webkit-box-orient:vertical;-webkit-line-clamp:2;box-sizing:content-box;display:-webkit-box;max-height:34px;overflow:hidden}.m_s_ZIh_G4YWn{margin:5px 0 10px}.m_jwAo4_G4YWn{word-wrap:break-word}.m_jwAo4_G4YWn.b_K7NsF_G4YWn{white-space:break-spaces}.i_UhM9j_G4YWn.b_jHVVF_G4YWn{display:block}.i_UhM9j_G4YWn .m_1d6Hc_G4YWn{padding:10px 0 0}[dir=ltr] .i_UhM9j_G4YWn .t_46VGX_G4YWn,[dir=ltr] .i_UhM9j_G4YWn .t_Hw2qO_G4YWn{margin-right:0}[dir=rtl] .i_UhM9j_G4YWn .t_46VGX_G4YWn,[dir=rtl] .i_UhM9j_G4YWn .t_Hw2qO_G4YWn{margin-left:0}.t_GuxWZ_G4YWn{background:rgba(0,0,0,.45);border-radius:2px;bottom:0;color:#fff;font-size:12px;margin-bottom:8px;padding-bottom:4px;padding-top:4px;position:absolute;z-index:1}[dir=ltr] .t_GuxWZ_G4YWn{right:0}[dir=rtl] .t_GuxWZ_G4YWn{left:0}[dir=ltr] .t_GuxWZ_G4YWn{margin-right:8px}[dir=rtl] .t_GuxWZ_G4YWn{margin-left:8px}[dir=ltr] .t_GuxWZ_G4YWn{padding-left:3px}[dir=ltr] .t_GuxWZ_G4YWn,[dir=rtl] .t_GuxWZ_G4YWn{padding-right:3px}[dir=rtl] .t_GuxWZ_G4YWn{padding-left:3px}',!0);const T="t_O6LAD_G4YWn",U="t_Hw2qO_G4YWn";class F extends a.Component{render(){const e=M(P,{variantTheme:this.props.variantTheme}),t=(0,f.css)(this.props.className,"b_jHVVF_G4YWn",e.dividerBorder,{i_UhM9j_G4YWn:this.props.isNarrowContainer},"w_JBdiS_G4YWn",{f_nY397_G4YWn:this.props.isFlexNoWrap}),n=this.props.titleMetaDataOverride?this.props.titleMetaDataOverride:this.props.metadata.Title,i=!A()&&this.props.openInNewTab?`${n} - ${this.props.openInNewTabLabel}`:n,r=(0,f.css)("m_CX11T_G4YWn",e.title,F._shouldUseCssClamp&&"t_fMVwI_G4YWn"),o=F._shouldUseCssClamp?a.createElement("div",{title:i,className:r,"data-automation-id":"metadataTitle","aria-label":i},n):!!this._lessText&&a.createElement(this._lessText,{text:n,className:(0,f.css)("m_LHgPy_G4YWn",e.title,"f_hkfft_G4YWn"),autoShowTitle:!0,lines:2,omission:""}),s=A()||this.props.openInNewTab?"_blank":"_self";return a.createElement(f.Fabric,{className:t},this._renderThumbnail(s),a.createElement("div",{className:"m_1d6Hc_G4YWn"},O._SPFlight.isEnabled(60514)&&!O._SPKillSwitch.isActivated("9a038a23-6465-4392-aa21-c2082d85135b")?a.createElement(x.Link,{className:U,href:this.props.originalUrl,target:s,ref:this._createTitleLinkRef,appearance:"subtle",inline:!0,bold:!0},o):a.createElement(I.Link,{className:U,href:this.props.originalUrl,target:s,componentRef:this._createTitleLinkRef},o),!0!==this.props.isHostNameHidden&&a.createElement("div",{className:(0,f.css)("m_s_ZIh_G4YWn",e.subTitle)},this._getHostname()),a.createElement("div",{className:(0,f.css)("m_jwAo4_G4YWn",{b_K7NsF_G4YWn:this.props.isWhiteSpaceBreakSpaces},e.description),title:this.props.metadata.Description},this.props.metadata.Description)))}focus(){this._thumbnailLink?this._thumbnailLink.focus():this._titleLink&&this._titleLink.focus()}_getHostname(){let e="";if(this.props.originalUrl){const t=/^\s*(http:\/\/|\/\/|https:\/\/)[^\/]+/i.exec(this.props.originalUrl);t&&t.length&&(e=t[0].replace(/^\s*(http:\/\/|\/\/|https:\/\/)/i,""))}return e}_renderThumbnail(e){if(this.props.metadata.Thumbnail&&this.state.isValidUrl&&!0!==this.props.isThumbnailHidden){const t=new E._QosMonitor("BingPreviewStyleThumbnailLoad"),n=this.props.isNarrowContainer?this.props.htmlEmbedRect.width:F._defaultThumbnailWidth,o=this.props.isNarrowContainer?this.props.htmlEmbedRect.width*F._defaultThumbnailHeightWidthRatio:F._defaultThumbnailHeight,s=i.ThumbnailUrlGenerator.updateThumbnailWidth(this.props.metadata.Thumbnail,n),c=O._SPFlight.isEnabled(60179)&&!!this.props.thumbnailOverlapText,d=!A()&&this.props.openInNewTab?`${r.StringHelper.format(h.ThumbnailAriaLabel,this.props.metadata.Title)} - ${this.props.openInNewTabLabel}`:r.StringHelper.format(h.ThumbnailAriaLabel,this.props.metadata.Title),l=!O._SPKillSwitch.isActivated("f30fb522-ba6b-4f04-9def-3e95eb692ef4")&&this.props.altText?this.props.altText:this.props.metadata.Title,u=!A()&&this.props.openInNewTab?`${l} - ${this.props.openInNewTabLabel}`:l,p=a.createElement(C.Image,{className:c?void 0:T,alt:this.props.altText||"",width:n,height:o,src:s,imageFit:f.ImageFit.cover,title:u,onLoad:this._handleThumbnailLoadSuccess(t),onError:this._handleThumbnailLoadError(t),role:this.props.altText?"img":"presentation"});return a.createElement("a",{className:"t_46VGX_G4YWn",href:this.props.originalUrl,target:e,ref:this._createThumbnailRef,"aria-label":d,rel:"noreferrer"},c?a.createElement("div",{className:T},p,a.createElement("div",{className:"t_GuxWZ_G4YWn"},this.props.thumbnailOverlapText)):p)}}_handleThumbnailLoadSuccess(e){return()=>{this.setState({isValidUrl:!0}),e.writeSuccess()}}_handleThumbnailLoadError(e){return()=>{this.setState({isValidUrl:!1});const t=h?h.ThumbnailLoadError:"ThumbnailLoadError";e.writeUnexpectedFailure("ThumbnailLoadError",new Error(t))}}_loadLessText(){this.state.isLessTextLoaded||w.SPComponentLoader.loadComponentById(F._spWebpartSharedComponentId).then(e=>{this._lessText=e.LessText,this.setState({isLessTextLoaded:!0})}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("HtmlEmbed"),e,"LoadWebpartSharedComponent")})}constructor(e){super(e),this._createTitleLinkRef=e=>{this._titleLink=e},this._createThumbnailRef=e=>{this._thumbnailLink=e},this._lessText=null,this.state={isValidUrl:!0,isLessTextLoaded:!1},this._loadLessText()}}F._defaultThumbnailHeightWidthRatio=.5625,F._defaultThumbnailHeight=135,F._defaultThumbnailWidth=240,F._spWebpartSharedComponentId="914330ee-2df2-4f6e-a858-30c23a812408",F._shouldUseCssClamp=O._BrowserDetection.getBrowserInformation().browser!==O._Browser.IE,(0,D._ts_decorate)([f.autobind],F.prototype,"focus",null),(0,D._ts_decorate)([f.autobind],F.prototype,"_handleThumbnailLoadSuccess",null),(0,D._ts_decorate)([f.autobind],F.prototype,"_handleThumbnailLoadError",null),(0,D._ts_decorate)([f.autobind],F.prototype,"_loadLessText",null);class H extends m{createHtmlElement(){return a.createElement(F,{...this._htmlGeneratorProps,ref:this._createBingPreviewLayoutRef})}getFilteredVanillaHtml(){return""}focus(){this._bingPreviewStyleComponent?this._bingPreviewStyleComponent.focus():this._shouldFocus=!0}_internalValidate(e){const t=Boolean(this._htmlGeneratorProps.metadata),n=Boolean(t&&this._htmlGeneratorProps.metadata.Title),a=Boolean(t&&this._htmlGeneratorProps.metadata.Description),i=Boolean(t&&this._htmlGeneratorProps.metadata.Thumbnail),r=Boolean(n||a||i),o={hasTitle:n,hasDescription:a,hasThumbnail:i,userInputHostname:_.getHostnameFromUrl(this._htmlGeneratorProps.originalUrl),currentHostname:window.location.host},s=this._htmlGeneratorProps.qosPrefixName||"HTMLEmbed",c=new E._QosMonitor(s+".BingPreviewStyle.ValidationResult");r?!n&&a&&i?c.writeExpectedFailure("MissTitle",void 0,o):n&&!a&&i?c.writeExpectedFailure("MissDescription",void 0,o):n&&a&&!i?c.writeExpectedFailure("MissThumbnail",void 0,o):!n||a||i?n||!a||i?n||a||!i?c.writeSuccess():c.writeExpectedFailure("OnlyHasThumbnail",void 0,o):c.writeExpectedFailure("OnlyHasDescription",void 0,o):c.writeExpectedFailure("OnlyHasTitle",void 0,o):c.writeExpectedFailure("EmptyMetadata",void 0,o);const d=h?h.UnsupportedEmbedUrl:"UnsupportedEmbedUrl";return Promise.resolve({isValid:r,errorMessage:r?"":d})}getWidth(){return this._htmlGeneratorProps.htmlEmbedRect.width}getHeight(){return this._htmlGeneratorProps.htmlEmbedRect.height}constructor(e){super(e),this._createBingPreviewLayoutRef=e=>{this._bingPreviewStyleComponent=e,this._shouldFocus&&e&&(e.focus(),this._shouldFocus=!1)},this._htmlGeneratorProps.htmlEmbedRect=_.scaleZeroRectByRatio(this._htmlGeneratorProps.htmlEmbedRect,H._defaultWidthHeightScale),this._shouldFocus=!1}}H._defaultWidthHeightScale=2.8;class R{static createHtmlGenerator(e){return e.embedCodeShownType===t.BingPreviewStyle?new H(e):e.type?"photo"===e.type?new S(e):new g(e):R._createHtmlGeneratorWithoutType(e)}static _createHtmlGeneratorWithoutType(e){return new g(e)}}class N extends a.Component{static _isSameEmbedDataSource(e,t){return e.type===n.DataProvider&&t.type===n.DataProvider?d(e.embedDataProvider.embeddableService)===d(t.embedDataProvider.embeddableService):e.type===t.type&&o.isEqual(e.embedServiceResult,t.embedServiceResult)}getErrorMessage(){return this.state.errorMessage}getMetadata(){return this._urlMetadata}UNSAFE_componentWillMount(){this._boundingRect&&this._startValidation(this.props)}componentDidMount(){if(this._boundingRect)return;const e=this._getCurrentBoundingRect();if(e){if(e.width<=0&&e.height<=0)return this._setErrorMessageAndNotify(h.HTMLEmbedBoundingRectZero);this._boundingRect=e,this._startValidation(this.props)}}UNSAFE_componentWillReceiveProps(e){if(this._boundingRect&&(!N._isSameEmbedDataSource(this.props.embedDataSource,e.embedDataSource)||this.props.embedCode.embedCode!==e.embedCode.embedCode))if(this._shouldSkipValidation(e)){const t=this._getHTMLGeneratorProps(e);this._updateComponents(t,e)}else this._startValidation(e);this.props.isNarrowContainer!==e.isNarrowContainer&&this._htmlGenerator&&this._htmlGenerator.setMobileMode(e.isNarrowContainer),this.props.variantTheme!==e.variantTheme&&this._htmlGenerator&&this._htmlGenerator.setVariantTheme(e.variantTheme),this.props.altText!==e.altText&&this._htmlGenerator&&this._htmlGenerator.setAltText(e.altText),this._htmlGenerator&&this.props.boundingRect&&e.boundingRect&&(this.props.boundingRect.height!==e.boundingRect.height||this.props.boundingRect.width!==e.boundingRect.width)&&(this._htmlGenerator.setContainerRect(e.boundingRect),this._setBoundingRectFromProps(e))}componentDidUpdate(){if(this._boundingRect)return;const e=this._getCurrentBoundingRect();!e||e.width<=0&&e.height<=0||e.width!==this._boundingRect.width&&(this._boundingRect=e,this._startValidation(this.props))}render(){return a.createElement("div",{ref:this._createHtmlEmbedDivRef,"data-automation-id":O._SPKillSwitch.isActivated("46181dda-8b4c-4cb0-934f-413a73dc44c2")?void 0:"html-embed"},this.state.isValidating?this._renderLoadingIndicator():this.state.errorMessage||!this._htmlGenerator?this._renderError():this._htmlGenerator.createHtmlElement())}focus(){this._htmlGenerator&&(this.state.isValidating?this._shouldFocus=!0:this._htmlGenerator.focus())}_shouldSkipValidation(t){return t.isSkipValidationOn&&(t.embedCode.embedCodeType===e.VanillaHtml||t.embedDataSource.type===n.RawDataSource)}_updateComponents(e,t){this._htmlGenerator=R.createHtmlGenerator(e),this._htmlGenerator.setSuccessorValidator(t.htmlValidator);const a=++this._operationId;this._htmlGenerator.validate(this._htmlGenerator.getFilteredVanillaHtml()).then(i=>{if(a===this._operationId)return t.embedDataSource.type===n.DataProvider&&o.get(t.embedDataSource,"embedDataProvider.onEmbedResultChanged")&&t.embedDataSource.embedDataProvider.onEmbedResultChanged({Type:e.type,Html:e.vanillaHtml,ResponseCode:c.OK,ErrorMessage:"",EmbedMetadata:e.metadata}),this._setErrorMessageAndNotify(i.isValid?"":i.errorMessage)},e=>{if(a===this._operationId)return this._setErrorMessageAndNotify(e.errorMessage||e.toString())})}_validate(e,t){if(e.metadata){const t=this._getWebUrlFromPreviewUrl(e.metadata.Thumbnail);if(t&&e.metadata.ListId&&e.metadata.SiteId&&e.metadata.UniqueId&&e.metadata.WebId){const n=this._getCurrentBoundingRect(),a={absoluteUrl:t,siteId:e.metadata.SiteId,webId:e.metadata.WebId,listId:e.metadata.ListId,uniqueId:e.metadata.UniqueId,width:n?n.width:void 0,fileType:e.metadata.Thumbnail&&i.ExtensionHelper.getExtension(e.metadata.Thumbnail)||"jpg",callerId:"htmlEmbed"};e.metadata.Thumbnail=i.ThumbnailUrlGenerator.getThumbnailUrl(a)}}try{if(e.metadata.Thumbnail&&e.metadata.Thumbnail.toLowerCase().indexOf("/getpreview.ashx")>-1){const t=new URL(e.metadata.Thumbnail);t.searchParams.has(i.PreviewHelper.GUID_FILE)&&t.searchParams.has(i.PreviewHelper.GUID_WEB)&&t.searchParams.has(i.PreviewHelper.GUID_SITE)&&(t.searchParams.set("v",String(Date.now())),e.metadata.Thumbnail=t.href)}}catch(e){s._TraceLogger.logError(this._logSource,e)}this._updateComponents(e,t)}_getHTMLGeneratorProps(t){return t.embedCode.embedCodeType===e.VanillaHtml?{vanillaHtml:t.embedCode.embedCode,htmlEmbedRect:this._boundingRect,type:u,shouldScale:t.shouldScale,embedCodeShownType:t.embedCode.embedCodeShownType,className:t.className,isNarrowContainer:t.isNarrowContainer,qosPrefixName:t.qosPrefixName,variantTheme:this.props.variantTheme,isThumbnailHidden:t.isThumbnailHidden,isHostNameHidden:t.isHostNameHidden,altText:this.props.altText,isFlexNoWrap:this.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:this.props.isWhiteSpaceBreakSpaces,openInNewTab:this.props.openInNewTab,openInNewTabLabel:this.props.openInNewTabLabel}:t.embedDataSource.type===n.RawDataSource?{vanillaHtml:t.embedDataSource.embedServiceResult.Html,originalUrl:t.embedCode.embedCode,htmlEmbedRect:this._boundingRect,type:t.embedDataSource.embedServiceResult.Type,metadata:t.embedDataSource.embedServiceResult.EmbedMetadata,shouldScale:t.shouldScale,embedCodeShownType:t.embedCode.embedCodeShownType,className:t.className,isNarrowContainer:t.isNarrowContainer,variantTheme:this.props.variantTheme,altText:this.props.altText,isThumbnailHidden:t.isThumbnailHidden,isHostNameHidden:t.isHostNameHidden,thumbnailOverlapText:t.thumbnailOverlapText,isFlexNoWrap:this.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:this.props.isWhiteSpaceBreakSpaces,openInNewTab:this.props.openInNewTab,openInNewTabLabel:this.props.openInNewTabLabel}:{isThumbnailHidden:t.isThumbnailHidden,isHostNameHidden:t.isHostNameHidden,isEmbeddableServiceRequired:!0,openInNewTab:this.props.openInNewTab,openInNewTabLabel:this.props.openInNewTabLabel}}_startValidation(e){this.setState({isValidating:!0,errorMessage:""});const t=this._getHTMLGeneratorProps(e);if(t.isEmbeddableServiceRequired){const t=e.embedDataSource.embedDataProvider.embeddableService;if(!t)return this._setErrorMessageAndNotify(h.NotSettingEmbedableService);const n=++this._operationId;t.getEmbeddableHtmlCode().then(t=>{this._operationId===n&&(this._modifyServerResult(t),this._urlMetadata=t.EmbedMetadata,this._validate({vanillaHtml:t.Html,originalUrl:e.embedCode.embedCode,htmlEmbedRect:this._boundingRect,type:t.Type,metadata:t.EmbedMetadata,shouldScale:e.shouldScale,embedCodeShownType:e.embedCode.embedCodeShownType,className:e.className,isNarrowContainer:e.isNarrowContainer,qosPrefixName:e.qosPrefixName,titleMetaDataOverride:e.titleMetaDataOverride,variantTheme:this.props.variantTheme,altText:this.props.altText,isFlexNoWrap:this.props.isFlexNoWrap,isWhiteSpaceBreakSpaces:this.props.isWhiteSpaceBreakSpaces,isThumbnailHidden:e.isThumbnailHidden,isHostNameHidden:e.isHostNameHidden,openInNewTab:this.props.openInNewTab,openInNewTabLabel:this.props.openInNewTabLabel},e))}).catch(e=>{s._TraceLogger.logError(s._LogSource.create("HtmlEmbed"),e,"GetEmbeddableHtmlCode")})}else this._validate(t,e)}_renderLoadingIndicator(){if(this.props.renderLoadingIndicator)return this.props.renderLoadingIndicator()}_renderError(){if(this.props.renderError)return this.props.renderError(this.state.errorMessage)}_setErrorMessageAndNotify(e){this.setState({isValidating:!1,errorMessage:e}),this.props.onNotifyRenderResult&&this.props.onNotifyRenderResult(e)}_getCurrentBoundingRect(){if(this._boundingRect)return this._boundingRect;if(!this._htmlEmbedDivDom)return;const e=this._htmlEmbedDivDom.getBoundingClientRect();return{width:Math.ceil(e.width),height:Math.ceil(e.height)}}_setBoundingRectFromProps(e){const t=e||this.props;t.boundingRect&&(t.boundingRect.width>0||t.boundingRect.height>0)&&(this._boundingRect=t.boundingRect)}_getWebUrlFromPreviewUrl(e){if(!e)return;const t=/\/_layouts\/15\/getpreview.ashx\?.*/i;return t.test(e)?e.substr(0,t.exec(e).index):void 0}constructor(e){super(e),this._modifyServerResult=e=>{const t=e.EmbedMetadata?.Url;if(t&&new r.Uri(t).getPath()===new r.Uri(window.location.href).getPath()&&e.EmbedMetadata?.Thumbnail){const t=new r.Uri(e.EmbedMetadata?.Thumbnail);t.setQueryParameter("randomNumber",Math.random().toFixed(5)),e.EmbedMetadata.Thumbnail=t.toString()}return e},this._createHtmlEmbedDivRef=e=>{this._htmlEmbedDivDom=e,this._shouldFocus&&!this.state.isValidating&&(this.focus(),this._shouldFocus=!1)},this.state={isValidating:!0,errorMessage:""},this._setBoundingRectFromProps(),this._operationId=0,this.props.embeddableService&&(this.props.embedDataSource.embedDataProvider.embeddableService=this.props.embeddableService),this._shouldFocus=!1,this._logSource=s._LogSource.create("HTMLEmbed")}}N.defaultProps={embedCode:void 0,embedDataSource:{type:n.DataProvider,embedDataProvider:{embeddableService:void 0,onEmbedResultChanged:void 0}}},N.validateDone="validateDone";var B=v(909),j=v(408);class V extends Error{constructor(e,t){super(e),this.response=t,Object.setPrototypeOf(this,V.prototype)}}async function z(e){return new Promise(t=>setTimeout(t,e))}function G(e){return!(e instanceof V&&403===e.response?.status)}function K(e,t){if(t instanceof V){const n=t.response?.correlationId?.toString()??"",a=t.response?.status??0,i=new Error(`Request failed with status code ${a}`);i.stack="",403===a?e.writeExpectedFailure("AuthError",i,{correlationId:n}):429===a?e.writeExpectedFailure("ThrottlingError",i,{correlationId:n}):e.writeUnexpectedFailure("OtherRequestError",i,{correlationId:n})}else{const t=new Error("Request not received or other error");t.stack="",e.writeUnexpectedFailure("OtherError",t)}}class W{setQosPrefixStr(e){this._qosPrefix=e}async getEmbeddableHtmlCode(e){const t=new E._QosMonitor(this._qosPrefix+".GetOEmbedIframeHtml"),n=1e3*(1+4*Math.random());if(L())return this._getEmbeddableHtmlCodeImpl(3,n,t,e);{let a;for(let i=0;i<3;i++){await z(n*i);try{const n=await this._requestEmbedData(e);return t.writeSuccess(),n}catch(e){if(a=e,!G(e))break}}return K(t,a),this._buildErrorResult(a)}}_buildRequestUrl(e){const t=new r.Uri(r.Uri.concatenate(this._pageContext.web.absoluteUrl,"_api/SP.Publishing.EmbedService/EmbedData"));return t.setQueryParameter("url",`%27${r.UriEncoding.encodeRestUriStringToken(this._url)}%27`),t.setQueryParameter("version","1"),e?.isBannerImageUrl&&t.setQueryParameter("bannerImageUrl","true"),t.toString()}_buildResult(e){return{Type:e.Type,Html:e.Html,ResponseCode:e.ResponseCode,EmbedServiceResponseCode:e.EmbedServiceResponseCode,ErrorMessage:e.ErrorMessage,EmbedMetadata:{CreatorName:e.CreatorName,DatePublishedAt:e.DatePublishedAt,Description:e.Description,PublisherName:e.PublisherName,Thumbnail:e.ThumbnailUrl,Title:e.Title,VideoId:e.VideoId,SiteId:e.SiteId,WebId:e.WebId,ListId:e.ListId,UniqueId:e.UniqueId,Url:e.Url,DecodedUrl:e.DecodedUrl,Type:e.Type,DurationInSeconds:e.DurationInSeconds}}}_buildErrorResult(e){return{Type:u,Html:"",ResponseCode:c.GetEmbedCodeError,ErrorMessage:e.message}}_requestEmbedData(e){const t=new E._QosMonitor("SPEmbeddableService._requestEmbedData"),n=this._buildRequestUrl(e),a=new Headers({"client-type":this._qosPrefix});let i;return this._httpClient.get(n,B.SPHttpClient.configurations.v1,{headers:a}).then(e=>{if(i=e,e.ok)return e.json();throw new Error(`details: ${JSON.stringify(e)} | responseCode: ${e.status}`)}).then(e=>{const n=this._buildResult(e);return t.writeSuccess(),n}).catch(e=>{throw K(t,e),new V(e.message,i)})}_getEmbeddableHtmlCodeImpl(e,t,n,a){const i=this._pageContext.web.absoluteUrl,o=new r.Uri(r.Uri.concatenate(i,"_api/SP.Publishing.EmbedService/EmbedData"));let s;o.setQueryParameter("url",r.StringHelper.format("%27{0}%27",r.UriEncoding.encodeRestUriStringToken(this._url))),o.setQueryParameter("version","1"),a?.isBannerImageUrl&&o.setQueryParameter("bannerImageUrl","true");const d=new Headers;return d.append("client-type",this._qosPrefix),this._httpClient.get(o.toString(),B.SPHttpClient.configurations.v1,{headers:d}).then(e=>(s=e,this._checkStatus(e))).then(e=>e.json()).then(e=>(n.writeSuccess(),{Type:e.Type,Html:e.Html,ResponseCode:e.ResponseCode,EmbedServiceResponseCode:e.EmbedServiceResponseCode,ErrorMessage:e.ErrorMessage,EmbedMetadata:{CreatorName:e.CreatorName,DatePublishedAt:e.DatePublishedAt,Description:e.Description,PublisherName:e.PublisherName,Thumbnail:e.ThumbnailUrl,Title:e.Title,VideoId:e.VideoId,SiteId:e.SiteId,WebId:e.WebId,ListId:e.ListId,UniqueId:e.UniqueId,Url:e.Url,DecodedUrl:e.DecodedUrl,Type:e.Type,DurationInSeconds:e.DurationInSeconds}})).catch(a=>{let i;return L()||(a.stack=""),s&&(i=s.correlationId?s.correlationId.toString():""),--e<=0?(s&&403===s.status?n.writeExpectedFailure("AuthError",a,{correlationId:i}):n.writeUnexpectedFailure("GetOEmbedIframeHtmlFail",a,{correlationId:i}),Promise.resolve({Type:u,Html:"",ResponseCode:c.GetEmbedCodeError,ErrorMessage:a.message})):new Promise(e=>setTimeout(e,t)).then(()=>this._getEmbeddableHtmlCodeImpl(e,2*t,n))})}_checkStatus(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(r.StringHelper.format("details: {0} | responseCode: {1}",JSON.stringify(e),e.status)))}constructor(e,t,n){this._url=e,t.whenFinished(()=>{this._httpClient=t.consume(B.SPHttpClient.serviceKey),this._pageContext=t.consume(j.PageContext.serviceKey),this._qosPrefix=n||"SPEmbeddableService"})}}class q{static createEmbeddableService(e,t,n){return new W(e,n,t)}}class Q{setQosPrefixStr(e){this._qosPrefix=e}getEmbeddableHtmlCode(){const e=new E._QosMonitor(this._qosPrefix+".GetVideoEmbedCode"),t=r.Uri.concatenate(location.origin,"/portals/hub/_api/VideoService/GetVideoByURL?$Select=DefaultEmbedCode,ID,ChannelID,ThumbnailUrl");return this._httpClient.post(t,B.SPHttpClient.configurations.v1,{credentials:"include",body:JSON.stringify({videoFileRelativeUrl:this._url})}).then(this._checkStatus).then(e=>e.json()).then(t=>(e.writeSuccess(),Promise.resolve({Html:t.DefaultEmbedCode,Type:l,ErrorMessage:"",EmbedMetadata:{Thumbnail:t.ThumbnailUrl},ResponseCode:c.OK}))).catch(t=>(e.writeUnexpectedFailure("GetEmbedCode"),Promise.resolve({Html:"",Type:l,ErrorMessage:h.InvalidVideoURL,ResponseCode:c.GetEmbedCodeError})))}_checkStatus(e){return e.status>=200&&e.status<300?Promise.resolve(e):Promise.reject(new Error(JSON.stringify(e)))}constructor(e,t){this._url=e,t.whenFinished(()=>{this._httpClient=t.consume(B.SPHttpClient.serviceKey)}),this._qosPrefix="O365VideoEmbeddableService"}}class Y{static getChidVidFromVideoUrl(e){const t={};if(""!==e){const n=Y.getIDStartIndexFromVideoUrl(Y.chidKey,e)+Y.chidKey.length+1,a=Y.getIDStartIndexFromVideoUrl(Y.vidKey,e)+Y.vidKey.length+1;t[Y.chidKey]=e.substring(n,n+Y._sizeOfGuid),t[Y.vidKey]=e.substring(a,a+Y._sizeOfGuid)}return t}static generateVideoUrlForIframeCodeRest(e){const t=new r.Uri(e).getHost();if(t&&t!==location.hostname)return e;const n=Y.getChidVidFromVideoUrl(e);return"PointPublishing.aspx?chid="+n[Y.chidKey]+"&vid="+n[Y.vidKey]}static getIDStartIndexFromVideoUrl(e,t){const n=new RegExp(e+"=","i").exec(t);return n?n.index:-1}constructor(){}}Y.chidKey="chid",Y.vidKey="vid",Y._sizeOfGuid=36})(),y})());