(()=>{var e=document.currentScript;define("49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0",["@microsoft/sp-diagnostics","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-http","@msinternal/sp-topic-sdk","@msinternal/odsp-utilities-bundle","@microsoft/sp-lodash-subset","@msinternal/sp-component-utilities","@msinternal/swc-helpers-bundle","@microsoft/sp-loader","@msinternal/odsp-core-bundle","react","react-dom","@msinternal/sp-telemetry","@microsoft/sp-webpart-base","@microsoft/sp-component-base","@ms/office-ui-fabric-react-bundle","@microsoft/load-themed-styles","@msinternal/sp-fluentui-migration-reactdom-render-bundle","@msinternal/sp-fluentui-migration-button-bundle","@msinternal/sp-fluentui-migration-stack-bundle","@msinternal/sp-fluentui-migration-link-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D)=>(()=>{"use strict";var I={7599:(e,t,n)=>{n.d(t,{p:()=>a});class a{}a.titleRegion="1.4",a.definition="1.3.0",a.people="1.1.0",a.resource="1.5.0",a.sites="1.1",a.graph="1.3",a.disambiguation="1.0",a.faqs="1.0",a.impactMetrics="1.0"}
,6429:(e,t,n)=>{n.d(t,{OC:()=>l,OP:()=>d,cw:()=>o,dy:()=>s,nX:()=>c});var a=n(9676),i=n(718),r=n(5423);function o(e,t,n,o){a.Validate.isNotNullOrUndefined(e,"serviceScope"),a.Validate.isNotNullOrUndefined(o,"newRelation");const s=e.consume(i.EntityRelationsService.serviceKey)[i.RelationsContainerKey].relations;s[t]||(s[t]={}),o.forEach(e=>{(0,r.s)(e.curationDetails)||delete e.curationDetails}),s[t][n]=o}function s(e,t){a.Validate.isNotNullOrUndefined(e,"serviceScope"),a.Validate.isNotNullOrUndefined(t,"badge"),e.consume(i.EntityRelationsService.serviceKey).relationsContainer.badges=[t]}function c(e){a.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(i.EntityRelationsService.serviceKey).relationsContainer.badges=[]}function d(e){a.Validate.isNotNullOrUndefined(e,"serviceScope");const t=e.consume(i.EntityRelationsService.serviceKey);t.relationsContainer.relations={},t.relationsContainer.badges=[]}function l(e,t,n){return{author:{email:e,name:t,upn:n},time:(new Date).toISOString()}}}
,1750:(e,t,n)=>{n.d(t,{U:()=>p});var a=n(9676),i=n(718),r=n(6429),o=n(92),s=n(7599),c=n(1634);const d=JSON.parse('{"tX":"Title area","e3":"Title region description","hN":"Summary","jC":"People","VZ":"Files and pages","Gb":"Related sites","WM":"Graph","IT":"Conversations","nx":"Questions and answers","u3":"Questions from communities","f8":"Topic","Ux":"People related to the current topic.","Z2":"Documents related to the current topic.","xV":"Topics related to the current topic.","G7":"Sites related to the current topic.","_h":"Viva Engage conversations related to the current topic."}');var l,u=n(2534),f=n(2517);!function(e){e[e.YammerTopic=745]="YammerTopic",e[e.SupportExternalResources=60695]="SupportExternalResources",e[e.AllowUnlicensedUsers=61280]="AllowUnlicensedUsers"}(l||(l={}));class p{static getLayoutWebPartIds(e,t){return[{webPartId:p.TITLE_REGION_WP_ID},{webPartId:p.DEFINITION_WP_ID},{webPartId:p.IMPACT_METRIC_WP_ID,disabled:!(0,u.$C)(e)},{webPartId:p.RELATED_PEOPLE_WP_ID},{webPartId:p.FAQS_WP_ID,disabled:!(0,u.ez)(e)},{webPartId:p.RELATED_DOCS_WP_ID},{webPartId:p.RELATED_SITES_WP_ID},{webPartId:p.GRAPH_WP_ID,disabled:!(0,f.X$)()&&p._isFlightEnabled(61280)&&!t},{webPartId:p.YAMMER_WP_ID,disabled:!p._isFlightEnabled(745)}].filter(e=>!e.disabled).map(({webPartId:e})=>e)}static getLayoutTemplate(e,t){a.Validate.isNotNullOrUndefined(e,"topic"),a.Validate.isNotNullOrUndefined(e.Id,"topicId"),a.Validate.isNotNullOrUndefined(e.Name,"topicName");const n=[];return p.getLayoutWebPartIds(t.legacyPageContext,(0,i.isCortexEnabled)(t)).forEach(a=>{switch(a){case p.TITLE_REGION_WP_ID:n.push({id:p.TITLE_REGION_WP_ID,title:d.tX,dataVersion:s.p.titleRegion,instanceId:p.TITLE_REGION_WP_ID,description:d.e3,serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},properties:{imageSourceType:i.ImageSourceType.none,title:e.Name,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!0,authorByline:void 0,layoutType:"TopicPage",topicId:e.Id,topicName:e.Name,topicHeader:d.f8,preventTitleOverwrite:!0,hasTitleBeenCommitted:(0,c.cI)()}});break;case p.DEFINITION_WP_ID:const a=[];n.push({id:p.DEFINITION_WP_ID,instanceId:p.OVERVIEW_RTE_INSTANCE_ID,title:d.hN,description:d.hN,dataVersion:s.p.definition,properties:{content:e.Definition,title:d.hN,topicName:e.Name,curated:a,removed:a,confirmedTopicTypes:p._getTopicTypesInfo(e.Types,t)}});break;case p.RELATED_PEOPLE_WP_ID:n.push({id:p.RELATED_PEOPLE_WP_ID,instanceId:p.RELATED_PEOPLE_WP_ID,title:d.jC,description:d.Ux,dataVersion:s.p.people,properties:{title:d.jC,topicName:e.Name,curated:p._defaultCurated(e,t),removed:[]}});break;case p.FAQS_WP_ID:n.push({id:p.FAQS_WP_ID,instanceId:p.FAQS_WP_ID,title:"",description:"",dataVersion:s.p.faqs,properties:{}});break;case p.IMPACT_METRIC_WP_ID:n.push({id:p.IMPACT_METRIC_WP_ID,instanceId:p.IMPACT_METRIC_WP_ID,title:"",description:"",dataVersion:s.p.impactMetrics,properties:{}});break;case p.RELATED_DOCS_WP_ID:n.push({id:p.RELATED_DOCS_WP_ID,instanceId:p.RELATED_DOCS_WP_ID,title:d.VZ,description:d.Z2,dataVersion:p._isFlightEnabled(60695)?s.p.resource:"1.4.0",properties:{title:d.VZ,topicName:e.Name,curated:[]}});break;case p.RELATED_SITES_WP_ID:n.push({id:p.RELATED_SITES_WP_ID,instanceId:p.RELATED_SITES_WP_ID,title:d.Gb,description:d.G7,dataVersion:s.p.sites,properties:{curated:[],removed:[]}});break;case p.GRAPH_WP_ID:n.push({id:p.GRAPH_WP_ID,instanceId:p.GRAPH_WP_ID,title:d.WM,description:d.xV,dataVersion:s.p.graph,properties:{isOnTopicPage:!0,title:d.WM,topicName:e.Name,titleFontWeightBold:!0,curated:[]}});break;case p.YAMMER_WP_ID:n.push({id:p.YAMMER_WP_ID,instanceId:p._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID,title:d.IT,description:d._h,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:(0,u.ez)(t.legacyPageContext)||(0,u.Jr)()?d.u3:d.nx,type:"Topic",legacyId:e.Id,feedSubtype:"QUESTIONS",threadCount:3,showHighlights:!0,templateType:"Cortex"}},{id:p.YAMMER_WP_ID,instanceId:p._YAMMER_CONVERSATIONS_WP_INSTANCE_ID,title:d.IT,description:d._h,dataVersion:"1.0",properties:{isOnTopicPage:!0,title:d.IT,type:"Topic",legacyId:e.Id,feedSubtype:"ALL",threadCount:3,showHighlights:!0,templateType:"Cortex"}})}}),n}static getAnchorIdForWebPart(e){return{[this.RELATED_DOCS_WP_ID]:o.yF,[this.RELATED_PEOPLE_WP_ID]:o.iL,[this.GRAPH_WP_ID]:o.um,[this.RELATED_SITES_WP_ID]:o.r6,[this.IMPACT_METRIC_WP_ID]:o.HX}[e]}static getTitleRegionData(e,t){return p.getLayoutTemplate(e,t).filter(e=>e.id===p.TITLE_REGION_WP_ID)[0]}static _defaultCurated(e,t){if(e.Id===i.NULL_TOPIC_ENTITY.Id){const{displayName:e,email:n,loginName:a}=t.user;return[{id:n,name:e,email:n,upn:a,curationDetails:(0,r.OC)(n,e,a)}]}return[]}static _getTopicTypesInfo(e,t){const{displayName:n,email:a,loginName:i}=t.user;return e?e.map(e=>({Id:e.Id,DisplayName:e.DisplayName,Type:"TopicType",curationDetails:(0,r.OC)(a,n,i)})):[]}static _isFlightEnabled(e){return a._SPFlight.isEnabled(e)}}p.TITLE_REGION_WP_ID="cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",p.RELATED_DOCS_WP_ID="9346e298-66c6-4122-853c-a1eef08b5827",p.RELATED_PEOPLE_WP_ID="29991a50-6f14-42e0-9536-aef85d91b05c",p.DEFINITION_WP_ID="e9ee7242-273c-473f-bfa5-149b32873501",p.GRAPH_WP_ID="81ce1eba-74ad-4f0d-a692-2133b98bc308",p.YAMMER_WP_ID="cb3bfe97-a47f-47ca-bffb-bb9a5ff83d75",p.RELATED_SITES_WP_ID="8670c27e-8fb2-46a9-a4fe-ea4515d2d9e1",p.FAQS_WP_ID="c12e69f3-404a-4ae7-b11a-bfd1175a7b00",p.IMPACT_METRIC_WP_ID="e3b2b12f-4fae-4c51-b593-dce186c7b7b5",p.OVERVIEW_RTE_INSTANCE_ID="7aca70c6-02bc-4b46-a27e-093e34a7a4dc",p._YAMMER_CONVERSATIONS_WP_INSTANCE_ID="6f5b4c2a-5f50-4e2b-a7be-3e78496c0bd2",p._YAMMER_QUESTIONSANDANSWERS_WP_INSTANCE_ID="46747584-1075-4555-92d9-dc0dd04af129"}
,1634:(e,t,n)=>{n.d(t,{m6:()=>O,bI:()=>g,cb:()=>C,d6:()=>L,hp:()=>A,H2:()=>E,V2:()=>k,uH:()=>w,Er:()=>D,eD:()=>x,Bv:()=>I,cI:()=>S,Eo:()=>M,q3:()=>v});var a=n(9676),i=n(7408),r=n(2207),o=n(8810),s=n(718),c=n(5592);class d extends Error{get code(){return this._code}constructor(e,t,n){super(`Page Service error with code: ${e}. ${t?t.message:""}${n||""}`),this.__proto__=d.prototype,this._code=e,this.stack=t&&t.stack}}class l{static _filterHiddenFields(e){return e.fields=e.fields.filter(e=>!e.schema||!e.schema.Hidden||!0!==e.schema.Hidden),e}get isInitialized(){return!!this._serviceProvider}initialize(e){this._serviceProvider=e}getCurrentItem(){return this._serviceProvider.getCurrentItem().then(e=>l._filterHiddenFields(e))}updateCurrentItem(e=!1){return this._serviceProvider.updateCurrentItem(e).then(e=>l._filterHiddenFields(e))}openPageSettingsPanel(){return this._serviceProvider.openPageSettingsPanel()}getChromeOptions(){return this._serviceProvider.getChromeOptions()}getPagePublishInfo(){return this._serviceProvider.getPagePublishInfo()}getPageBasicInfo(){return this._serviceProvider.getPageBasicInfo()}getPageMultilingualInfo(){return this._serviceProvider.getPageMultilingualInfo()}getWebPartsPageSettings(){return this._serviceProvider?.getWebPartsPageSettings()||{isTitleHeadingLevelsEnabled:!1,isLowQualityImagePlaceholderEnabled:!1}}getPageHTMLContentInfo(){return this._serviceProvider.getPageHTMLContentInfo()}subscribe(e,t,n){return this._serviceProvider.subscribe(e,t,n),Promise.resolve()}unsubscribe(e,t,n){return this._serviceProvider.unsubscribe(e,t,n),Promise.resolve()}getAutoSaver(){return this._serviceProvider.getAutoSaver()}getClientFormProvider(){return this._serviceProvider.getClientFormProvider()}getItemUpdateQueue(){return Promise.resolve(this._serviceProvider.getItemUpdateQueue())}invalidatePageNavigationCache(){return Promise.resolve(this._serviceProvider.invalidatePageNavigationCache())}generateTranspileContent(e,t,n){return Promise.resolve(this._serviceProvider.generateTranspileContent(e,t,n))}saveStreams(e,t,n){return Promise.resolve(this._serviceProvider.saveStreams(e,t,n))}setPageRetired(e){return this._serviceProvider.setPageRetired(e)}switchToEditMode(){return this._serviceProvider.switchToEditMode()}constructor(){this.enqueueClientFormSavePromise=(e,t)=>this._serviceProvider.enqueueClientFormSavePromise(e,t)}}function u(e,t,n){return{value:function(...e){return this._serviceProvider?n.value.apply(this,e):(t=t||new d(1),r._TraceLogger.logError(l.logSource,t),Promise.reject(t));var t}}}l.logSource=r._LogSource.create("PageService"),(0,c._ts_decorate)([u],l.prototype,"getCurrentItem",null),(0,c._ts_decorate)([u],l.prototype,"updateCurrentItem",null),(0,c._ts_decorate)([u],l.prototype,"openPageSettingsPanel",null),(0,c._ts_decorate)([u],l.prototype,"getChromeOptions",null),(0,c._ts_decorate)([u],l.prototype,"getPagePublishInfo",null),(0,c._ts_decorate)([u],l.prototype,"subscribe",null),(0,c._ts_decorate)([u],l.prototype,"unsubscribe",null),(0,c._ts_decorate)([u],l.prototype,"getAutoSaver",null),(0,c._ts_decorate)([u],l.prototype,"getClientFormProvider",null),(0,c._ts_decorate)([u],l.prototype,"getItemUpdateQueue",null),(0,c._ts_decorate)([u],l.prototype,"invalidatePageNavigationCache",null),(0,c._ts_decorate)([u],l.prototype,"generateTranspileContent",null),(0,c._ts_decorate)([u],l.prototype,"saveStreams",null),(0,c._ts_decorate)([u],l.prototype,"setPageRetired",null),(0,c._ts_decorate)([u],l.prototype,"switchToEditMode",null);const f=a.RootServiceKey.create("sp-component-utilities:PageService",l);var p=n(92),m=n(7699),_=n(7833),h=n(4485),b=n(2480);function g(e,t,n,i,r){a.Validate.isNotNullOrUndefined(e,"name"),a.Validate.isNotNullOrUndefined(t,"id"),a.Validate.isNotNullOrUndefined(n,"pageContext"),a.Validate.isNotNullOrUndefined(i,"linkSource");let o=`${(0,_.A)(n)}/_layouts/15/TopicPagePreview.aspx?topicId=${t}&topicName=${encodeURIComponent(e)}`;return r&&(o+=`&${p.rd.Language}=${r}`),(0,m.A)(o,i)}function v(e){a.Validate.isNotNullOrUndefined(e,"url"),window.open(e,"_blank")}function y(e){const t=new URL(e||window.location.href).pathname.toLowerCase();return t.substring(t.lastIndexOf("/")+1)}function S(e){return(0,s.isLayoutsPage)(e)&&y(e).toLowerCase()===p.Oy.topicPagePreviewStubFileName.toLowerCase()}function D(){return(0,s.isLayoutsPage)()&&y().toLowerCase()===p.Oy.createTopicPageStubFileName.toLowerCase()}function I(){return y().toLowerCase()===p.Oy.newPageStubFileName.toLowerCase()||D()}function x(){return-1!==new URL(window.location.href).pathname.toLowerCase().indexOf(p.Oy.disambiguationPageStubFileName)}function C(e){return`${(0,_.A)(e)}/${s.LAYOUTS_PAGE_PREFIX}${p.Oy.createTopicPageStubFileName}?Mode=Edit&isNewTopicPage=true`}const O=new Set(["doc","docx","one","ppt","pptx","xls","xlsx"]);function w(e){const t=(e?.split(".").pop()||"").toLowerCase();if(e&&"msg"===t){const t=E(e),n=t.substring(0,t.lastIndexOf("/"));return`${e.substring(0,e.lastIndexOf("/"))}?id=${t}&parent=${n}`}return e}function E(e){return new URL(e).pathname}function A(e,t){const n=new r._QosMonitor(t),a=e.consume(f);return e.consume(i.PageContext.serviceKey)?.list?a.getCurrentItem().then(e=>{const t=e?.item?.properties?.uniqueId;return t?n.writeSuccess():n.writeUnexpectedFailure("getUndefinedPageUniqueId"),t}).catch(e=>{n.writeUnexpectedFailure("getPageUniqueIdFailed",e)}):Promise.resolve(void 0)}function L({topicName:e,topicId:t,source:n,buildNumber:a,feedbackEmail:i,pageContext:r,mailSubject:s,mailBody:c,extraDebugStrings:d}){const l=encodeURIComponent(o.StringHelper.format(h.k$,e)),u=`${h.ur}${n}`,f=`${h.Vo}${t}`,p=`${h.iE}${e}`,m=[u,f,...s?[p]:[],`${h.jx}buildNumber=${a}`,`${h.n}${window.navigator.userAgent}`,`${h.U$}${r.legacyPageContext.currentLanguage}`,...d||[]].join("\n");return`mailto:${i}?subject=${s??l}&body=${encodeURIComponent(`${c??h.q6}\n\n\n${h.Ts}\n${m}`)}`}const k=async(e,t)=>{const n=[];for(const a of e)n.push(await t(a));return n},M=(e,t,n)=>new b.M(e).log(t,{numberOfTopics:n.length,lifecycleStates:Array.from(new Set(n.map(e=>e.LifeCycleState||e.LifeCycle?.State||""))).sort().join(",")})}
,2218:(e,t,n)=>{n.d(t,{M:()=>a});class a extends Error{get isExpected(){return this._isExpected||!1}set isExpected(e){this._isExpected=e}constructor(e){super(e),this._isExpected=!1,this.__proto__=a.prototype,this.errorType="AadTokenError"}}}
,92:(e,t,n)=>{n.d(t,{E3:()=>m,HX:()=>c,Kc:()=>y,Nq:()=>D,Oy:()=>a,P2:()=>v,Pr:()=>p,U_:()=>h,b7:()=>u,bq:()=>b,fb:()=>g,ge:()=>_,h7:()=>l,hf:()=>x,hy:()=>d,iL:()=>i,lO:()=>S,qc:()=>I,r6:()=>s,rd:()=>f,um:()=>o,yF:()=>r});class a{}a.topicViewerConfirmedTopicsLogPrefix="CSKIM.TopicViewer.ConfirmedTopics.DP",a.topicViewerUnconfirmedTopicsLogPrefix="CSKIM.TopicViewer.UnconfirmedTopics.DP",a.topicViewerExcludedTopicsLogPrefix="CSKIM.TopicViewer.ExcludedTopics.DP",a.topicPagePreviewStubFileName="TopicPagePreview.aspx",a.createTopicPageStubFileName="CreateTopicPage.aspx",a.newPageStubFileName="newpage.aspx",a.disambiguationPageStubFileName="TopicDisambiguation.aspx",a.topicCacheDuration=864e5,a.kmTopicIdAttribute="data-sp-topic-id",a.kmHashtaggedTopicIdAttribute="data-sp-hashtagged-topic-id",a.kmTopicCardAttribute="data-sp-topic-card",a.kmAnnotateLogPrefix="CSIKM.Annotate",a.kmTopicPickerLogPrefix="CSIKM.TopicPicker",a.kmTopicCenterLogPrefix="CSIKM.TopicCenter",a.kmFeedbackLogPrefix="CSIKM.Feedback",a.kmTopicCardLogPrefix="CSIKM.TopicCard",a.kmTopicPageLogPrefix="CSIKM.TopicPage",a.kmTopicCacheLogPrefix="CSIKM.TopicCache",a.timeZoneStartIndexInDatetime=19,a.pageVersionParam="version",a.pageVersionCompareFromParam="versionCompareFrom",a.pageVersionCompareToParam="versionCompareTo",a.currentTopicLoadedEvent="CurrentTopicLoadedEvent",a.topicMergeStatusUpdateEvent="TopicMergeStatusUpdateEvent",a.gptVersion="gptVersion",a.ascending=1,a.descending=2,a.onAnnotateTitleEventName="onAnnotateTitle_Cortex",a.topicNameChangeEventName="TopicNameChangedEvent_Cortex",a.showTopicPublishTeachingBubbleEventName="ShowTopicPublishTeachingBubble_Cortex";const i="topic_related_people",r="topic_related_resources",o="topic_related_topics",s="topic_related_sites",c="topic_impact_metrics",d="_",l={Curated:"Curated",NotCurated:"NotCurated"},u={MinedDefinition:"MinedDefinition",Definition:"Definition",NoDefinition:"NoDefinition"},f={TopicId:"topicId",TopicName:"topicName",LinkSource:"ls",TopicsCount:"top",SkipCount:"skip",Language:"lang",QnAOptOut:"QnAOptOut",DisableMergeRedirect:"disableMergeRedirect"},p={HashtaggedAnnotation:"HASHTAGGEDANNOTATION",Annotation:"ANNOTATION",TopicCard:"CARD",TopicManagement:"MGMT",GraphWebPart:"GRAPH",MyTopics:"MYTOPICS",DisambiguationContext:"DISAMBIGUATION",AmbiguousTopic:"AMBIGUOUS_TOPIC",DisambiguationLanguage:"DISAMBIGUATION_LANGUAGE",VivaConnections:"VC",UserCentricTopicGraph:"UCTG",TopicsPaneAutoHighlights:"TOPICS_PANE_AUTO_HIGHLIGHTS",TopicsPaneHashtaggedHighlights:"TOPICS_PANE_HASHTAGGED_HIGHLIGHTS"},m=window.innerWidth<640,_=2,h=2,b="Empty response from substrate getTopicById api",g={author:{email:"",name:"",upn:""},time:"",isAddedFromSearch:!1},v="topic-page-privacy-banner-close-button",y=10,S=50,D="unspecified",I="MIXED",x="*"}
,2534:(e,t,n)=>{n.d(t,{$C:()=>g,Az:()=>b,Bd:()=>h,FM:()=>S,Fv:()=>s,Jr:()=>I,Ky:()=>o,Ys:()=>_,ZP:()=>c,_N:()=>p,ez:()=>v,fk:()=>y,hp:()=>x,iY:()=>r,oK:()=>m,sO:()=>l,tL:()=>f,vZ:()=>D,w1:()=>d,yn:()=>u});var a=n(9676),i=n(1506);const r={TopicExperienceFeedback:1057,TopicPageGPT:1986,SwitchAPIRequestMethod:60866,ManagedDashboardV2:1335,SourceColumn:60906,SupportProviderTypeOverride:1753,TopicActivities:1926,CopilotCuration:60217};function o(){return a._SPFlight.isEnabled(1442)}function s(){return a._SPFlight.isEnabled(r.SwitchAPIRequestMethod)}function c(){return a._SPFlight.isEnabled(60589)}function d(){return a._SPFlight.isEnabled(r.SupportProviderTypeOverride)}function l(){return a._SPFlight.isEnabled(60621)}function u(){return a._SPFlight.isEnabled(60475)}function f(){return a._SPFlight.isEnabled(60672)}function p(){return a._SPFlight.isEnabled(r.ManagedDashboardV2)}function m(){return a._SPFlight.isEnabled(r.SourceColumn)}function _(){return a._SPFlight.isEnabled(r.CopilotCuration)}function h(){return a._SPFlight.isEnabled(r.TopicActivities)}function b(){return a._SPFlight.isEnabled(1505)}function g(e){return a._SPFlight.isEnabled(61039)||(0,i.isCortexEapUser)(e)&&a._SPFlight.isEnabled(61047)}function v(e){return a._SPFlight.isEnabled(60966)}function y(){return a._SPFlight.isEnabled(1058)}function S(){return a._SPFlight.isEnabled(60819)}function D(){return a._SPFlight.isEnabled(60854)}function I(){return a._SPFlight.isEnabled(60217)}function x(){return a._SPFlight.isEnabled(61278)}}
,2517:(e,t,n)=>{n.d(t,{A3:()=>c,Br:()=>g,EI:()=>f,Hy:()=>r,Kq:()=>i,M2:()=>m,Oe:()=>d,S1:()=>_,U5:()=>o,X$:()=>b,X2:()=>p,dw:()=>u,fx:()=>l,jF:()=>h,kR:()=>s});var a=n(9676);function i(){return a._SPKillSwitch.isActivated("5d59e193-3eba-43ce-bb04-4614661bd72a")}function r(){return a._SPKillSwitch.isActivated("22e79ebf-0921-4f6d-aeda-66e9fa4b81bb")}function o(){return a._SPKillSwitch.isActivated("a445b26c-fc09-42b2-bed9-03f8a9a6e95f")}function s(){return a._SPKillSwitch.isActivated("c023ae48-1012-48c1-ae45-3b971c686502")}function c(){return a._SPKillSwitch.isActivated("5aac75ed-6e15-4ab2-be51-058c09a81215")}function d(){return a._SPKillSwitch.isActivated("9534e3ff-04aa-4200-b1c0-5fe423ea194e")}function l(){return a._SPKillSwitch.isActivated("eab97c5d-c013-41ed-92ff-666d681b1722")}function u(){return a._SPKillSwitch.isActivated("3055acfe-e542-48bd-b875-d979ccb9b3b8")}function f(){return a._SPKillSwitch.isActivated("7c7f5275-ef87-4273-8638-2ba2ac14a477")}function p(){return a._SPKillSwitch.isActivated("d78120c0-739d-4a5e-9fe2-f5911563c426")}function m(){return a._SPKillSwitch.isActivated("7a337ca1-a011-4e5c-9235-1c5583946423")}function _(){return a._SPKillSwitch.isActivated("a7ab661f-bc29-4026-b91d-0df30e80f571")}function h(){return a._SPKillSwitch.isActivated("64de3692-fa20-4cac-bccc-837b767f06d7")}function b(){return a._SPKillSwitch.isActivated("4c26b865-0068-466a-aaa6-275d1de029d4")}function g(){return a._SPKillSwitch.isActivated("971bb732-e242-4228-92a1-41a0ea44f941")}}
,7699:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(92);function i(e,t){if(!e)return e;const n=new URL(e);return n.searchParams.append(a.rd.LinkSource,t),n.href}}
,6300:(e,t,n)=>{n.d(t,{N:()=>i,p:()=>r});var a=n(1750);function i(e){const t=JSON.parse(e);for(const e of t)if(e.id===a.U.DEFINITION_WP_ID)return e.serverProcessedContent?.searchablePlainTexts?.content||e.properties?.content||"";return""}function r(e,t,n,a,i,r,o,s){return{Id:n,CurrentLanguage:s,DisplayName:e,State:"Mined, Curated",Url:a,LifeCycle:{State:"Published"},RelatedResourcesMap:[{Key:"People",Value:[{Id:i,Type:"People",State:"Curated",LifeCycle:{State:"Published"},MyFeedbackStatus:"Undetermined",EmailAddress:i,UserPrincipalName:o,DisplayName:r,Curator:{DisplayName:r,EmailAddress:i,UserPrincipalName:o},LastCurator:{DisplayName:r,EmailAddress:i,UserPrincipalName:o}}]}],RelatedEntitiesMap:[],AlternateNames:[],Definition:t,Definitions:[{Value:t,State:"Curated",LifeCycle:{State:"Published"}}]}}}
,3762:(e,t,n)=>{n.d(t,{A:()=>_});var a=n(2207),i=n(9676),r=n(7408),o=n(1909),s=n(2534),c=n(2517),d=n(5827),l=n(2710),u=n(1506),f=n(1019),p=n(8810);function m(e){const{retries:t=1,retryDelay:n=500,shouldRetryOnError:a=(()=>!0)}=e;return{retries:t,retryDelay:n,shouldRetryOnError:a}}class _{get _authTokenEndpoint(){return u.SUBSTRATE_REQUEST_DOMAIN}get _substrateEndpoint(){return`${u.SUBSTRATE_REQUEST_DOMAIN}/KnowledgeGraph/api/v1.0/${this.apiName}${this.apiParams}`}static getRoutingKMAPIKey(e){const t=new a._QosMonitor(`${d.OY}.getRoutingKMAPIKey`);if(!(0,c.Kq)()){if(e.aadInfo&&e.aadInfo.userId&&e.aadInfo.tenantId)return t.writeSuccess(),`OID:${e.aadInfo.userId}@${e.aadInfo.tenantId}`;t.writeUnexpectedFailure("PageContext AadInfo is missing")}return`SMTP:${e.user.email}`}get pageContext(){return this._pageContext}get fetchRetryOptions(){}get isPost(){return!0}get apiName(){return"Topics"}getCustomRequestOptions(e){}get xScenario(){return this._scenario}get qosTag(){throw new Error("Needs to be overridden by the derived class")}getRequest(e="",t,n=!1){const i=`${d.OY}.AuthTokenFetch${this._qosSuffix}`,r=`${d.OY}.${this.qosTag}.${n?"Init":"API"}.${d.TI}${this._qosSuffix}`,o=`${d.OY}.${this.qosTag}.${d.TI}${this._qosSuffix}`;return this._qosMonitorAuthTokenFetch=new a._QosMonitor(i),this._qosMonitorAuthTokenFetchWithTokenType=new a._QosMonitor(`${i}`),this._qosMonitorTotal=new a._QosMonitor(o),this._qosMonitorTotalWithTokenType=new a._QosMonitor(`${o}`),this._aadTokenFetchSucceeded=!1,a._EngagementLogger.logEvent(o),(0,s.w1)()&&(this._providerType=(0,l.at)(d.k0)),this._makeRequest(this._substrateEndpoint,this._authTokenEndpoint,e,()=>{this._aadTokenFetchSucceeded=!0,this._qosMonitorAuthTokenFetch.writeSuccess(),this._qosMonitorAuthTokenFetchWithTokenType.writeSuccess(),this._qosMonitorAPI=new a._QosMonitor(r),this._qosMonitorAPIWithTokenType=new a._QosMonitor(`${r}`)}).then(e=>f.l.processSubstrateHttpResponse(e,this._requestId,this._qosMonitorAPI,this._qosMonitorAPIWithTokenType,this._qosMonitorTotal,this._qosMonitorTotalWithTokenType,this._useSetCortexDisabledFlag,this._extraData)).catch(e=>f.l.handleSubstrateAPIException(e,this._aadTokenFetchSucceeded,this._qosMonitorAuthTokenFetch,this._qosMonitorAuthTokenFetchWithTokenType,this._qosMonitorAPI,this._qosMonitorAPIWithTokenType,this._qosMonitorTotal,this._qosMonitorTotalWithTokenType,this._extraData))}get correlationId(){return this._requestId.value}get apiParams(){const e=new URLSearchParams("");if(this._isDebugUrl){const t=new URL(window.location.href).searchParams.get("pipeline");t&&e.append("pipeline",t)}(0,s.Fv)()&&this.isPost||e.append("provider","Yggdrasil");const t=e.toString();return t?`?${t}`:""}_getAPI(e,t,n,a,i){const r=()=>this.isPost?t.post(e+n,o.AadHttpClient.configurations.v1,this._getRequestOptions(a)):t.get(e+n,o.AadHttpClient.configurations.v1,this._getRequestOptions(a));return i?function(e,t){const n=(0,p.Retry)({callback:e,retries:t.retries,delay:t.retryDelay,canRetry:e=>(t.logError(e),t.shouldRetryOnError(e))});return n.then(e=>{t.logResponse(e),t.logFinal("RESOLVED")},e=>{t.logError(e),t.logFinal("CAUGHT")}),n}(r,i):r()}get _shouldRetryAPIFailures(){return!!this.fetchRetryOptions}get _qosSuffix(){return(0,u.isHeartbeatTenant)(this.pageContext)?".Heartbeat":""}_getAPIRetryOptions(){const e=[];let t,n=0,i=0;this._apiRetryQosMonitor=new a._QosMonitor(`${d.OY}.${this.qosTag}.Retry${this._qosSuffix}`),n=performance.now();const r=()=>{const e=performance.now(),t=(e-n).toFixed(1);return n=e,+t},o=()=>({sr:e.length+1,clientReqId:this._extraData.clientRequestId,duration:r()});return{...m(this.fetchRetryOptions),logResponse:t=>{const n=o();n.httpStatus=t.status,e.push(n),i=t.status},logError:n=>{const a=o();a.error=n.toString(),a.onLine=navigator.onLine,e.push(a),t=n},logFinal:n=>{this._extraData.FinalStatus=n,this._extraData.AttemptsInfo=JSON.stringify(e),this._extraData.TotalRetryAttempts=e.length-1,e.length>1&&("RESOLVED"===n?this._apiRetryQosMonitor.writeExpectedFailure(`HTTP ${i.toString()} ${e.length-1}`,void 0,this._extraData):this._apiRetryQosMonitor.writeUnexpectedFailure(`${t.message} ${e.length-1}`,t,this._extraData))}}}_getRequestOptions(e){let t=0;t=(new Date).getTime();const n={},a=i.Guid.newGuid().toString(),r=_.getRoutingKMAPIKey(this.pageContext);n.headers={},n.headers["Content-Type"]="application/json",n.headers["X-AnchorMailbox"]=r,n.headers["X-RoutingParameter-SessionKey"]=r,n.headers["Client-Request-Id"]=a,n.headers["request-id"]=a,(0,l.zk)()&&(n.headers[d.aR]="true"),e&&(n.headers.Authorization=`Bearer ${e}`),this.xScenario&&(n.headers["X-Scenario"]=this.xScenario),this._language&&(n.headers["X-Accept-Language"]=this._language);const o=new URL(window.location.href).searchParams;return(0,s.hp)()&&o.has(d.rk)&&(n.headers["X-Debug-KnowledgebasePipelineOverride"]=o.get(d.rk)),this.getCustomRequestOptions(n),this._clientRequestId=a,this._extraData.clientRequestId=a,this._extraData.getRequestOptionsTime=(new Date).getTime()-t+" ms",this._extraData.culture=this._language,this._extraData.scenario=this.xScenario,n}_makeRequest(e,t,n,a){return this._tokenDataProvider.getOAuthToken(t).then(t=>{a();const i=this._serviceScope.consume(o.HttpClient.serviceKey),r="string"==typeof t?t:t.token;return this._getAPI(e,i,n,r,this._shouldRetryAPIFailures?this._getAPIRetryOptions():void 0)})}get _isDebugUrl(){const e=new URL(window.location.href).searchParams;return i._SPFlight.isDebugFlightEnabled&&"true"===e.get("debug")}constructor(e,t=!0,n){this._requestId={value:""},this._language=void 0,this._serviceScope=e,this._useSetCortexDisabledFlag=t,this._extraData={},e.whenFinished(()=>{this._pageContext=e.consume(r.PageContext.serviceKey),this._tokenDataProvider=new u.TokenDataProvider(this._serviceScope,this._pageContext)}),this._scenario=n}}}
,5827:(e,t,n)=>{n.d(t,{$t:()=>o,OY:()=>a,RQ:()=>f,TI:()=>i,Z0:()=>d,ZT:()=>s,aR:()=>r,k0:()=>u,rk:()=>l,wK:()=>c});const a="CSIKM.Substrate",i="DP",r="X-SPDF-TestFeedback",o="https://microsoft.sharepoint-df.com/teams/knowledgehub",s="https://microsoft.sharepoint-df.com",c="https://microsoft.sharepoint.com/sites/knowledgecenter",d="feedbackDebugMode",l="kbPipelineIdOverride",u="provider",f=["Turing","YggdrasilAndTuring"]}
,5813:(e,t,n)=>{var a;n.d(t,{A:()=>i,E:()=>a}),function(e){e[e.BadRequest=400]="BadRequest",e[e.Conflict=409]="Conflict",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.NotAcceptable=406]="NotAcceptable",e[e.ServerError=500]="ServerError",e[e.RequestEntityTooLarge=413]="RequestEntityTooLarge",e[e.NotImplemented=501]="NotImplemented",e[e.TooManyRequests=429]="TooManyRequests",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.Unauthorized=401]="Unauthorized"}(a||(a={}));const i=a}
,628:(e,t,n)=>{n.d(t,{A:()=>a});class a extends Error{constructor(e="unknown",t=200,n,i=!1){super(e),"unknown"===e&&(this.isUnknown=!0),this.__proto__=a.prototype,this.status=t,this.code=n,this.isExpected=i,this.errorType="RestApiError"}}}
,1019:(e,t,n)=>{n.d(t,{R:()=>f,l:()=>p});var a=n(2207),i=n(9676),r=n(8831);function o(){return i._SPKillSwitch.isActivated("03fe1e3a-35a4-4d30-9d7d-eba1b4537dbb")}const s="lastCortexDisableFlagLogged";var c,d=n(628),l=n(2218),u=n(2517);!function(e){e.Deserialization="DeserializationError",e.Offline="Offline",e.TokenFetch="TokenFetchError",e.CortexDisabled="CortexDisabled",e.GroupMembershipNotAvailable="GroupMembershipNotAvailable",e.GuestUserNotSupported="GuestUserNotSupported"}(c||(c={}));const f={Cancelled:["cancelled","geannuleerd","キャンセルしました","cancelado","отменено","已取消","annullato","annulé"]};class p{static processSubstrateHttpResponse(e,t,n,c,d,l,u,f,p){if(i.Validate.isNotNullOrUndefined(e,"response"),i.Validate.isNotNullOrUndefined(t,"requestId"),i.Validate.isNotNullOrUndefined(n,"qosMonitorAPI"),i.Validate.isNotNullOrUndefined(d,"qosMonitorTotal"),i.Validate.isNotNullOrUndefined(c,"qosMonitorAPI"),i.Validate.isNotNullOrUndefined(l,"qosMonitorTotal"),i.Validate.isNotNullOrUndefined(u,"useSetCortexDisabledFlag"),u&&function(e){if(!(0,r.X)()&&403===e?.status){const e=36e5,t=new Date((new Date).getTime()+e);if(sessionStorage?.setItem){sessionStorage.setItem("cortexDisableFlag",t.toISOString());const e="CSIKM.CortexEnabledFlag.Set.True";o()?a._EngagementLogger.logEvent(e):function(e,t=!0){sessionStorage?.getItem&&(sessionStorage.getItem(s)??"")!==e&&sessionStorage?.setItem&&(t&&a._EngagementLogger.logEvent(e),sessionStorage.setItem(s,e))}(e),!o()&&sessionStorage?.removeItem&&sessionStorage.removeItem(s)}}}(e),e.headers&&(t.value=e.headers.get("request-id"),f.requestId=t.value),f.status=e.status,!e.ok){let t=`Substrate Cortex API server failure: $tag::${e.status}::${e.statusText}`;return 403===e.status?this._processSubstrateHttpResponseFailure(t,e,!0,n,c,d,l,"CortexDisabled",f,p):this._getInnerErrorFromResponse(e).then(a=>{const i=a?.error.message,r=a?.error.code;return 400===e.status&&/Guest user is not supported/i.test(i)?this._processSubstrateHttpResponseFailure(t,e,!0,n,c,d,l,"GuestUserNotSupported",f,p):(t+=a?`, ErrorCode:${r}, ErrorMessage:${i}`:", ErrorMessage: Failed to retrieve",this._processSubstrateHttpResponseFailure(t,e,!1,n,c,d,l,this._getFormattedHttpStatus(e.status),f,p))})}try{return n.writeSuccess(f),d.writeSuccess(f),c.writeSuccess(f),l.writeSuccess(f),e.json()}catch(a){const i=a;return this._processSubstrateHttpResponseFailure(`Substrate Cortex API deserialization failure: $tag::[RequestId: ${t.value}, Name:${i.name}, message:${i.message}, stack:${i.stack}`,e,!1,n,c,d,l,"DeserializationError",f,p)}}static handleSubstrateAPIException(e,t,n,a,r,o,s,c,f){if(i.Validate.isNotNullOrUndefined(e,"error"),e instanceof d.A)throw e;{let i;if(t)window.navigator.onLine?(i=void 0===e.status?new Error(`Substrate Cortex API failure: $tag::[Name:${e.name}, message:${e.name}, stack:${e.stack}`):e,r?.writeUnexpectedFailure(e.message,i,f),s?.writeUnexpectedFailure(e.message,i,f),o?.writeUnexpectedFailure(e.message,i,f),c?.writeUnexpectedFailure(e.message,i,f)):(i=new Error(`Substrate Cortex API failure Offline: $tag::[Name:${e.name}, message:${e.message}, stack:${e.stack}`),r?.writeExpectedFailure("Offline",i,f),s?.writeExpectedFailure("Offline",i,f),o?.writeExpectedFailure("Offline",i,f),c?.writeExpectedFailure("Offline",i,f));else{const d=`Substrate Cortex token failure: $tag::[Name:${e.name}, message:${e.message}, stack:${e.stack}, aadTokenFetchSucceeded:${t}`;i=new l.M(d),window.navigator.onLine?(n?.writeUnexpectedFailure(e.message,i),a?.writeUnexpectedFailure(e.message,i)):(n?.writeExpectedFailure("Offline",i),a?.writeExpectedFailure("Offline",i),(0,u.A3)()&&(i.isExpected=!0)),(0,u.A3)()||(i.isExpected=!0),r?.writeExpectedFailure("TokenFetchError",i,f),s?.writeExpectedFailure("TokenFetchError",i,f),o?.writeExpectedFailure("TokenFetchError",i,f),c?.writeExpectedFailure("TokenFetchError",i,f)}throw i}}static _processSubstrateHttpResponseFailure(e,t,n,a,i,r,o,s,c,l){const u=new d.A(e,t.status,s,n);return l&&(l.restApiError=u),n?(a.writeExpectedFailure(s,u,c),r.writeExpectedFailure(s,u,c),i.writeExpectedFailure(s,u,c),o.writeExpectedFailure(s,u,c)):(a.writeUnexpectedFailure(s,u,c),r.writeUnexpectedFailure(s,u,c),i.writeUnexpectedFailure(s,u,c),o.writeUnexpectedFailure(s,u,c)),Promise.reject(u)}static _getFormattedHttpStatus(e){return`HTTP ${e.toString()}`}static _getInnerErrorFromResponse(e){return e.json().then(e=>e).catch(()=>Promise.resolve(void 0))}}}
,7849:(e,t,n)=>{n.d(t,{Qi:()=>d,V3:()=>o,fv:()=>r,hK:()=>f,hN:()=>l,hx:()=>c,sS:()=>s,vR:()=>g,vt:()=>v,zb:()=>u});var a=n(718),i=n(4620);const r=11;function o(e){return{Id:e.Id,DisplayName:e.DisplayName,isSuggested:"Mined"===e.State}}function s(e){return{LastModifiedTime:e.LastModifiedTime,Title:e.Title,Url:e.Url,Modifier:e.LastModifier?{Email:e.LastModifier.EmailAddress,Name:e.LastModifier.DisplayName,Upn:e.LastModifier.UserPrincipalName}:void 0,ViewCount:e.ViewCount,AIReason:{ReasonType:e.AIReason&&e.AIReason.ReasonType?e.AIReason.ReasonType:"",TopicMentionsCount:e.AIReason?.TopicMentionsCount},Languages:e.Languages?.map(a.tryMapLanguageToCulture),Id:e.Id,Type:e.Type,State:e.State,FilePath:e.FilePath,Extension:e.Extension,DownloadUrl:e.DownloadUrl,SiteId:(0,i.A)(e.SiteId||""),WebId:(0,i.A)(e.WebId||""),UniqueId:(0,i.A)(e.UniqueId||""),LogoUrl:e.LogoUrl}}function c(e){const t=e.RelatedResourcesMap;let n=[];return t?.forEach(e=>{"People"===e.Key&&(n=e.Value)}),n?.map(e=>d(e))??[]}function d(e){return{Email:e.EmailAddress,Name:e.DisplayName,Upn:e.UserPrincipalName,OId:e.ObjectId,Description:e.Description,LifecycleState:e.LifeCycle,AIReason:e.AIReason?{Count:e.AIReason.FileContributions?e.AIReason.FileContributions.length:0,DocumentContributedTo:e.AIReason.FileContributions?.length>0?{Title:e.AIReason.FileContributions[0].Title+(e.AIReason.FileContributions[0].Extension?"."+e.AIReason.FileContributions[0].Extension:""),Url:e.AIReason.FileContributions[0].Url}:{}}:void 0,LastCurator:e.LastCurator,LastFeedbackModifier:e.LastFeedbackModifier}}function l(e){return{...e,SiteId:(0,i.A)(e.SiteId),WebId:(0,i.A)(e.WebId),LifecycleState:e.LifeCycle}}function u(e){return{Acronym:e.Acronym,Title:e.Title,BannerColor:e.Color,BannerImageUrl:e.LogoUrl,Url:e.Url,Type:"Site",ItemReference:{SiteId:(0,i.A)(e.SiteId),WebId:(0,i.A)(e.WebId),Type:"SiteReference"},EntityState:e.State}}function f(e){const t=e.RelatedResourcesMap,n=e.RemovedRelatedResourcesMap;let i=[],s=[],c=[],u=[],f=[],b=[],g=[],v=!1,y=!1,S=!1;t&&t.length>0&&t.forEach(e=>{"People"===e.Key?(i=e.Value,v=e.MoreResultsAvailable):"File"===e.Key?(s=e.Value,y=e.MoreResultsAvailable):"Site"===e.Key?(c=e.Value,S=e.MoreResultsAvailable):"TopicType"===e.Key&&(g=e.Value||[])}),n?.forEach(e=>{"People"===e.Key?u=e.Value:"File"===e.Key?f=e.Value:"Site"===e.Key&&(b=e.Value)});const D=[];return e.Definitions?.length&&e.Definitions.forEach(e=>{D.push(function(e){const t=e.AIReason?.SourceFiles?.[0];return{Definition:e.Value,SourceType:"Wikipedia"===t?.Source?"Wikipedia":"Private",State:e.State,LifecycleState:e.LifeCycle,Url:t?.Url,WacUrl:t?.Url,SourceDocumentTitle:t?.Title,SourceDocumentExtension:t?.Extension,Languages:e.Languages?.map(a.tryMapLanguageToCulture),SourceFile:t}}(e))}),{CurrentLanguage:(0,a.tryMapLanguageToCulture)(e.CurrentLanguage),Definitions:D,Definition:e.Definition,DisambiguationContext:e.DisambiguationContext?.Value,Id:e.Id,Name:e.DisplayName,State:e.State,Score:e.RelevanceScore,Type:e.TopicType,Types:g.map(o),Badges:e.Badges,TopicTypes:g,MergeStatus:e.MergeStatus,PrimaryName:m(e.PrimaryName),RelatedDocuments:p(s),RelatedPeople:i.map(d),RelatedSites:c.map(l),RemovedRelatedDocuments:p(f),RemovedRelatedPeople:u.map(d),RemovedRelatedSites:b.map(l),Url:e.Url,AlternateNames:e.AlternateNames?.map(h)||[],AtTheMinimumRelatedPeopleCount:v?r:i.length,AtTheMinimumRelatedResourcesCount:y?r:s.length,AtTheMinimumRelatedTopicsCount:S?r:c.length,HasPrimaryType:e.HasPrimaryType,HiddenMinedDocuments:[],HiddenMinedPeople:[],Languages:e.Languages?.map(_),LifecycleState:e.LifeCycle,OriginalIds:e.AncestorIds,Source:e.Source,OriginalTopicEntity:e,ImpactMetrics:e.ImpactMetrics}}function p(e){return e.filter(e=>"File"===e.Type||"Connector"===e.Type).map(s)}function m(e){if(e)return{Name:e.Name,State:e.State,Languages:e.Languages?.map(a.tryMapLanguageToCulture)}}function _(e){return{culture:(0,a.tryMapLanguageToCulture)(e.Value),url:e.Url}}function h(e){return{Name:e.Name,State:e.State,Languages:e.Languages?.map(a.tryMapLanguageToCulture),AIReason:{ReasonType:e.AIReason?.ReasonType,SourceFiles:e.AIReason?.SourceFiles.map(b)}}}function b(e){return{Extension:e.Extension||"",Source:e.Source,Title:e.Title,Url:e.Url}}function g(e){const t={EntityDetails:[],PageMatches:[]};if(e.EntityAnnotation){const n=e.EntityAnnotation.SectionMatches;if(n.length){const a=n.map(e=>({ComponentId:e.SectionId,Matches:e.EntityMatches.map(e=>({Start:e.StartPos,Length:e.Length,HighlightedName:e.HighlightedName,Entities:[{EntityId:e.Entities[0].Id,Score:0}]}))}));t.PageMatches=a;const i=e.EntityAnnotation.EntityDetails;t.EntityDetails=i}}return t}function v(e){const t={value:[]};if(e&&e.length>0){const n=e.map(e=>({EntityId:e.Id,Name:e.DisplayName,Type:e.Type,Definition:e.Definition,AlternateNames:e.AlternateNames?.map(h)??[],RelatedPeople:c(e),DisambiguationContext:e.DisambiguationContext}));t.value=n}return t}}
,2710:(e,t,n)=>{n.d(t,{at:()=>r,xW:()=>i,zk:()=>o});var a=n(5827);function i(e){const t=e.headers.get("sprequestguid")||"",n=e.headers.get("microsoftsharepointteamservices")||"";return`[HTTP]:${e.status} - ${e.statusText} [CorrelationId]:${t} [Version]:${n}`}function r(e){return new URL(window.location.href).searchParams.get(e)}function o(){const e=new URL(window.location.href).searchParams;return-1!==window.location.href.toLowerCase().indexOf(a.$t)||0===window.location.href.toLowerCase().indexOf(a.ZT)&&"true"===e.get(a.Z0)?.toLocaleLowerCase().trim()}}
,6500:(e,t,n)=>{n.d(t,{XN:()=>l,fv:()=>i.fv,wK:()=>r.wK,Sr:()=>o.A,aR:()=>r.aR,$w:()=>p,Fu:()=>u,zk:()=>a.zk,at:()=>a.at,xW:()=>a.xW,vR:()=>i.vR,sS:()=>i.sS,hx:()=>i.hx,Qi:()=>i.Qi,hN:()=>i.hN,zb:()=>i.zb,vt:()=>i.vt,hK:()=>i.hK,V3:()=>i.V3});var a=n(2710),i=n(7849),r=n(5827),o=n(628),s=n(529),c=n(8831),d=n(3762);class l extends d.A{get qosTag(){return"GetTopicByNames"}get apiName(){return"Topics/Names"}fetchTopics(e,t){return(0,c.X)()?Promise.resolve([]):(this._language=t,this._topicNames=(0,s.uniq)(e?.filter(e=>e).map(e=>e.trim())),(0,s.isEmpty)(this._topicNames)?Promise.resolve([]):this.getRequest().then(({value:e})=>e))}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify({TopicNames:this._topicNames})}constructor(e,t,n=!1){super(e,n,t)}}class u extends d.A{getTypes(e=[],t){return this._typeIds=e,this._language=t,this.getRequest().then(({value:e})=>e)}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify({Ids:this._typeIds})}get qosTag(){return"GetTopicTypes"}get apiName(){return"Types"}constructor(e,t){super(e,!1,t),this._typeIds=[]}}var f=n(9676);class p extends d.A{get apiName(){return"Settings/QnANotifications/Ids"}get qosTag(){return"QnANotificationsByTopicIds"}optOutByTopicId(e){return f.Validate.isNotNullOrUndefined(e,"topicId"),this._payload=[{TopicId:e,Enabled:!1}],this.getRequest()}getCustomRequestOptions(e){e.body=JSON.stringify(this._payload)}constructor(e,t="SPPages.TopicPage.QnASetting"){f.Validate.isNotNullOrUndefined(e,"serviceScope"),super(e,void 0,t),this._payload=[]}}}
,2480:(e,t,n)=>{n.d(t,{M:()=>i});var a=n(1506);class i{log(e,t={},n){const i=(0,a.tryGetTopicsSdk)(),r=a=>{a.logEvent(e,{...this.customData,...t},n)};i?r(i):(0,a.getTopicsSdk)(this._serviceScope).then(r)}constructor(e){this.customData={},this._serviceScope=e}}}
,4967:(e,t,n)=>{function a(e,t){return e.RelatedResourcesMap?.filter(e=>e.Key===t)[0]?.Value||[]}n.d(t,{P:()=>a})}
,4620:(e,t,n)=>{function a(e){return e.toLowerCase().replace(/[{}]/g,"")}n.d(t,{A:()=>a})}
,7833:(e,t,n)=>{n.d(t,{A:()=>c});var a=n(9676),i=n(2207);const r="https://microsoft.sharepoint-df.com/teams/knowledgehub",o="https://microsoft.sharepoint.com/sites/knowledgecenter",s=["odspcsitest","olfilato-test-site","EdensTestSPDF","knowledgehub"];function c(e){a.Validate.isNotNullOrUndefined(e,"pageContext");const t=i._LogSource.create("TopicUtilities");if(function(e){a.Validate.isNotNullOrUndefined(e,"pageContext");const t=e.site.absoluteUrl.toLowerCase();return-1!==t.indexOf("microsoft.sharepoint-df.com")&&s.some(e=>-1!==t.indexOf(e))}(e))return r;if(e.legacyPageContext?.knowledgeHubSiteDetails?.Url){const t=e.legacyPageContext.knowledgeHubSiteDetails.Url;return t===r?o:t}return-1!==location.origin.toLowerCase().indexOf("microsoft")?o:void i._TraceLogger.logError(t,new Error("Error: Configure the KnowledgeCenter URL for Knowledge Mining scenarios to work correctly."))}}
,5727:(e,t,n)=>{n.d(t,{T8:()=>o.A,g0:()=>M,zS:()=>y,eZ:()=>P,u8:()=>x.u8,QC:()=>B,Pn:()=>s,ZP:()=>c.A,wN:()=>x.wN,Ov:()=>u,IW:()=>k,vE:()=>D,rd:()=>S,wI:()=>L,uR:()=>R,Bp:()=>d,Uk:()=>l,NL:()=>f,YQ:()=>C,gP:()=>_.s,Tc:()=>I,MW:()=>A,dn:()=>m,M_:()=>x.M_,K6:()=>U,ig:()=>T,zx:()=>N,Fl:()=>i,Vy:()=>r.A});var a=n(92);function i(e){return e?.length>0?a.h7.Curated:a.h7.NotCurated}var r=n(921),o=n(4620);function s(e){return e.knowledgeHubSiteDetails?.Url}var c=n(7833);function d(e,t){return u([e.Id].concat(e.AncestorIds??[]),[t.Id].concat(t.AncestorIds??[]))}function l(e,t){const n=new Set([e.Id].concat(e.OriginalIds??[]));return[t.Id].concat(t.OriginalIds??[]).some(e=>n.has(e))}function u(e,t){const n=new Set(e);return t.some(e=>n.has(e))}function f(e){return"Suggested"===e||"UserSuggested"===e}var p=n(4485);function m(e,t){const n=`${(0,c.A)(t)}/${t.legacyPageContext.layoutsUrl||"_layouts/15"}/error.aspx?Title=${p.iS}&ErrorText=${e}`;window.postMessage(`router://${n}`,window.location.origin)}var _=n(5423),h=n(7408),b=n(718),g=n(1506),v=n(2534);function y(e){return(0,g.getPageContext)(e).then(t=>{if((0,b.isEnvSPDF)()){const{legacyPageContext:e}=t;if(e){const n=new h.SPPermission(e.webPermMasks);return Promise.resolve((0,b.isCortexEnabled)(t)&&n.hasAnyPermissions(h.SPPermission.manageLists,h.SPPermission.manageWeb)&&(0,v.sO)())}}return(0,g.getTopicsSdk)(e).then(e=>e.canUserEditTopics()&&(!(0,b.isEnvMSIT)(t)||e.canUserManageTopics()))})}function S(e,t){return Boolean(t.RelatedPeople?.some(t=>D(e,t.Email,t.Upn)))}function D(e,t,n){return!(!t&&!n)&&(Boolean(t&&(t===e.email||t===e.loginName))||Boolean(n&&(n===e.email||n===e.loginName)))}function I(e){return(0,g.getTopicsSdk)(e).then(e=>Boolean(e.isPreviewUser())).catch(()=>!1)}var x=n(8506);function C(e){return"Suggested"===e||"Confirmed"===e||"UserSuggested"===e}var O=n(6500),w=n(2218),E=n(5813);function A(e,t,n,a,i){const{error:r,errorName:o,prefix:s}=n;let c;o?c=o:function(e){return e&&("AadTokenError"===e.errorType||e instanceof w.M)}(r)?c="TokenError":function(e){return e&&("RestApiError"===e.errorType||e instanceof O.Sr)}(r)&&(c=E.E[r.status]),a||(a={errorMessage:r instanceof O.Sr?r.code:r.message}),c&&e.log(t,a,{error:`${s??""}${c}`,...i})}function L(e){return!!(e&&"isExpected"in e&&e.isExpected)}function k(e){return 0===e.indexOf("CRKB_")}function M(e,t){const{relationsContainer:n}=e.consume(b.EntityRelationsService.serviceKey),{recentActivities:a}=n;if(a){let e=!1;for(let n=0;n<a.length;n++)if(a[n].type===t.type){"ResourcesAddedActivity"===t.type?a[n]={...t,resourceCount:{...a[n].resourceCount,...t.resourceCount}}:a[n]={...t},e=!0;break}e||a.push(t)}else n.recentActivities=[t]}function P(e,t){return{type:e,author:{email:t.email,name:t.displayName,upn:t.loginName},time:(new Date).toISOString()}}function T(e,t){const{currentTopic:n}=e.consume(b.TopicDataService.serviceKey);return U(n).then(n=>!(!(0,v.Ys)()||t||n)&&"en-us"===(0,x.wN)(e))}function U(e){return n.e(738).then(n.bind(n,1959)).then(({SKIP_TOPICS:t})=>t.has(e.Id)||e.AncestorIds?.some(e=>t.has(e)))}var F=n(4967),H=n(2517);function R(e,t,n){const a=new Set([t.Id].concat(t.AncestorIds??[]));if([n.Id].concat(n.AncestorIds??[]).some(e=>a.has(e))||t.Url===n.Url)return!1;if(!(0,H.Br)())return!0;const i=new Set([...e,...(0,F.P)(t,"TopicType").filter(t=>-1===e.indexOf(t.Id)).map(e=>e.Id)].slice(0,3)),r=(0,F.P)(n,"TopicType").map(e=>e.Id).slice(0,3),o=r.filter(e=>!i.has(e));return(0,H.fx)()&&0===i.size?0===r.length:r.length===i.size&&0===o.length}function N(e){const t=document.querySelector('[data-automation-id="CommandBarUnlockEditButton"]');t?t.click():(B()?.click(),e&&(window.location.hash=e))}function B(){return document.querySelector('[data-automation-id="pageCommandBarEditButton"]')}}
,5423:(e,t,n)=>{function a(e){return Boolean(e&&(e.author?.name||e.author?.email||e.author?.upn)&&e.time)}n.d(t,{s:()=>a})}
,8506:(e,t,n)=>{n.d(t,{M_:()=>l,u8:()=>c,wN:()=>d});var a=n(7408),i=n(718),r=n(92),o=n(2534),s=n(1634);function c(e){if(!e)return;const t=new URL(e);return t.searchParams.append(r.rd.LinkSource,r.rd.Language),t.searchParams.append("stay","true"),t.toString()}function d(e){if(!e._isFinished)return;const t=e.consume(a.PageContext.serviceKey),n=e.consume(i.TopicDataService.serviceKey);return(0,o.yn)()?n.currentPageLanguage?.toLowerCase():(0,s.cI)()?n.topicPageMultilingualInfo.previewLanguage:n.topicPageMultilingualInfo?.isTranslation?n.topicPageMultilingualInfo.translationLanguage:t.web.languageName.toLowerCase()}function l(e,t,n){if(!t._isFinished)return;const r=t.consume(a.PageContext.serviceKey),s=t.consume(i.TopicDataService.serviceKey),c=(0,o.yn)()?s.multilingualSourcePageInfo?.language.toLowerCase():r.web.languageName.toLowerCase();if(e)return c;if(!n||0===n.length)return;const l=r.cultureInfo.currentUICultureName.toLowerCase(),u=(0,o.yn)()?d(t):s.currentPageLanguage?.toLowerCase(),f=n.map(i.tryMapLanguageToCulture);return u&&-1!==f.indexOf(u)?u:l&&-1!==f.indexOf(l)?l:c&&-1!==f.indexOf(c)?c:f[0]}}
,921:(e,t,n)=>{n.d(t,{A:()=>i});var a=n(92);function i(e){return e?.split(a.hy)[0]||""}}
,8831:(e,t,n)=>{n.d(t,{X:()=>a});var a=function(){try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(e){return console.log("No session storage accessible: "+e),!1}}}
,8424:e=>{e.exports=g},1962:e=>{e.exports=h},9676:e=>{e.exports=n},2207:e=>{e.exports=t},1909:e=>{e.exports=i},8414:e=>{e.exports=l},529:e=>{e.exports=s},7408:e=>{e.exports=a},6642:e=>{e.exports=_},2141:e=>{e.exports=b},6277:e=>{e.exports=u},8810:e=>{e.exports=o},718:e=>{e.exports=c},6575:e=>{e.exports=y},95:e=>{e.exports=D},4907:e=>{e.exports=v},2183:e=>{e.exports=S},5519:e=>{e.exports=m},1506:e=>{e.exports=r},5592:e=>{e.exports=d},5959:e=>{e.exports=f},8398:e=>{e.exports=p},4485:e=>{e.exports=JSON.parse('{"k$":"Topic feedback: {0}","q6":"Tell us about your experience with this topic. Was the information accurate or helpful?","Ts":"Engineering notes: ","ur":"Source: ","Vo":"Topic id: ","iE":"Topic name: ","jx":"Toolkit versions: ","n":"Browser agent: ","U$":"User language: ","iS":"Topic details aren\\u0027t available now"}')}
},x={};function C(e){var t=x[e];if(void 0!==t)return t.exports;var n=x[e]={exports:{}};return I[e](n,n.exports,C),n.exports}C.m=I;var O,w,E,A={"738":"exfOskAvrI23C3Xc8sx8yj7kC/mAwT0Y4m0zO3oK85Q=","830":"83bwAGU3gTFZFMlTiANFL7AL+UeUaMvgWm3d/EjxboI="};C.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return C.d(t,{a:t}),t},C.d=(e,t)=>{for(var n in t)C.o(t,n)&&!C.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},C.f={},C.e=e=>Promise.all(Object.keys(C.f).reduce((t,n)=>(C.f[n](e,t),t),[])),C.u=e=>"chunk."+{738:"topic-hide-copilot-topicIds",830:"topic-shared-topic-creation"}[e]+"_"+({830:1}[e]?"en-us":"none")+"_"+{738:"1b96df121520b7dd6cc9",830:"74e4d984ba7a5a980f9f"}[e]+".js",C.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),O={},w="49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0:",C.l=(e,t,n,a)=>{if(O[e])O[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==w+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,C.nc&&i.setAttribute("nonce",C.nc),i.setAttribute("data-webpack",w+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(A[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}O[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=O[e];if(delete O[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},C.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},E=e?e.src:"",C.p=E.slice(0,E.lastIndexOf("/")+1),C.f.compat=(e,t)=>{for(var n=function(e){return{830:[{i:"c79b9f88-6338-40fb-b463-3aad22a88b15",v:"0.1.0",m:1181},{i:"4c7a0268-816b-4ba5-ab33-df85b4bbf18c",v:"0.1.0",m:2944},{i:"93dfc7f4-039c-4dc5-b10f-bf09ab171eba",v:"0.1.0",m:9460},{i:"ffe5c101-373a-4bd2-bebb-13082852bab0",v:"0.1.0",m:1485},{i:"91976643-f860-4be9-ba8f-32b82339a0ca",v:"0.1.0",m:2095},{i:"a86b8f98-2f15-4506-b455-c1e9fe8da1bd",v:"0.1.0",m:4207},{i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},{i:"fab65e60-a04f-4772-874c-10691e4afa4b",v:"0.1.0",m:6094}]}[e]||[]}(e),a=0;a<n.length;a++)C.m[n[a].m]||(e=>{t.push(L.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{C.m[e.m]=e=>e.exports=t}))})(n[a])};var L=C(8414);(()=>{var e={706:0};C.f.j=(t,n)=>{var a=C.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=C.p+C.u(t),o=new Error;C.l(r,n=>{if(C.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)C.o(o,a)&&(C.m[a]=o[a]);s&&s(C)}for(t&&t(n);c<r.length;c++)i=r[c],C.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0"]=self["webpackJsonp_49d290fb-a38e-4001-97d3-a2db486db2fa_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var k={};return(()=>{C.r(k),C.d(k,{AadTokenError:()=>me.M,AnyLanguageKey:()=>a.hf,CuratedTypes:()=>a.h7,DEFAULT_RELATION_COUNT:()=>a.Kc,DUMMY_CURATION_DETAILS:()=>a.fb,DataVersion:()=>Ie.p,DeferredPeopleDataProvider:()=>x,DeferredTopicCreation:()=>ce,DefinitionTypes:()=>a.b7,EmptyResponseError:()=>E,EngagementLogger:()=>z.M,ExperienceFeedback:()=>oe,FEEDBACK_EMAIL:()=>re,FeedbackDataProvider:()=>S,GetTopicsByNamesDataProvider:()=>fe.XN,KnowledgeCenterPerfComponents:()=>Te,LIFECYCLE_TO_LOC_STRING:()=>Me,LIFECYCLE_TO_MANAGED_LIFECYCLE:()=>ke,LinkSourceTypes:()=>a.Pr,MAX_RELATION_COUNT:()=>a.lO,MORE_RESULTS_SIGNAL:()=>fe.fv,MSIT_KNOWLEDGE_HUB_URL:()=>fe.wK,MixedLanguageKey:()=>a.qc,MultilingualSourceMessage:()=>De,MyTopicsDataProvider:()=>he,MyTopicsFeedbackDataProvider:()=>te,PagesFlightId:()=>i.iY,RELATED_DOCUMENTS_LIMIT:()=>a.U_,RELATED_PEOPLE_LIMIT:()=>a.ge,RestApiError:()=>Ee.A,SPDF_TEST_HEADER:()=>fe.aR,STATUS_DESCRIPTION:()=>Pe,SUBSTRATE_GETTOPICBYID_EMPTY_RESPONSE_ERROR:()=>a.bq,SubstrateFeedbackDataProvider:()=>_,SubstrateGetSubscirptionsDataProvider:()=>p,SubstrateGetTopicSuggestionProvider:()=>h,SubstrateManageTopicsDataProvider:()=>c,SubstrateManageTopicsFilterOptionsDataProvider:()=>l,SubstrateManagedDashboardDataProvider:()=>_e,SubstrateMergeTopicsDataProvider:()=>u,SubstrateQnANotificationsDataProvider:()=>fe.$w,SubstrateTopicStatusDataProvider:()=>f,SubstrateTopicsAnalyticsDataProvider:()=>Re,SubstrateUpdateSubscriptionsDataProvider:()=>m,SuggestedDefinitionSourceElement:()=>ye,TOPIC_ID_ORIGIN_BREAKER:()=>a.hy,TOPIC_IMPACT_METRICS_ANCHOR_ID:()=>a.HX,TOPIC_PRIVACY_CLOSE_BUTTON_ID:()=>a.P2,TOPIC_RELATED_PEOPLE_ANCHOR_ID:()=>a.iL,TOPIC_RELATED_RESOURCES_ANCHOR_ID:()=>a.yF,TOPIC_RELATED_SITES_ANCHOR_ID:()=>a.r6,TOPIC_RELATED_TOPICS_ANCHOR_ID:()=>a.um,TopicConstants:()=>a.Oy,TopicDataProviderHelper:()=>b.l,TopicPageEngagementLogger:()=>G,TopicPageEngagementLoggerDeprecated:()=>W,TopicPageLayoutDefaultTemplate:()=>g.U,TopicPageParams:()=>a.rd,TopicTypesDataProvider:()=>fe.Fu,UnspecifiedLanguageKey:()=>a.Nq,WEB_VIEW_EXTENSIONS:()=>y.m6,WikiSourceElement:()=>Se,_BaseKMWebPart:()=>ee,_BaseSubstrateTopicDataProvider:()=>e.A,_SubstrateAnnotationDataProvider:()=>P,_SubstrateGetTopicByIdDataProvider:()=>A,_SubstrateGetTopicsByIdsDataProvider:()=>L,_SubstrateRelatedTopicsDataProvider:()=>T,_cleanGuid:()=>xe.T8,_translateDoc:()=>O.sS,_translatePeople:()=>O.hx,_translatePerson:()=>O.Qi,_translateSubstrateSuggestionSearchAPIResponse:()=>O.vt,addAllowedEditors:()=>Ne,addBadgesToEntityRelations:()=>v.dy,addEntityRelations:()=>v.cw,addLinkSource:()=>pe.A,addRecentActivity:()=>xe.g0,buildTopicEntity:()=>ne.p,canUserCreateTopic:()=>xe.zS,chooseIcon:()=>de,enableTestFeedback:()=>fe.zk,generatePreviewUrl:()=>y.bI,getActivity:()=>xe.eZ,getCreateTopicPageUrl:()=>y.cb,getCurationDetails:()=>v.OC,getDefaultPageUrlWithSource:()=>xe.u8,getEditCommand:()=>xe.QC,getFeedbackMailLink:()=>y.d6,getFileNameWithExtension:()=>He,getKnowledgeHubUrl:()=>xe.Pn,getKnowledgeHubUrlWithOverrides:()=>xe.ZP,getLatestCurationAuthorProfile:()=>Y,getPageUniqueId:()=>y.hp,getParameterValue:()=>fe.at,getPathName:()=>y.H2,getRelatedResources:()=>Fe.P,getStatusMessage:()=>fe.xW,getTopicPageEngagementLogger:()=>K,getTopicPageLanguage:()=>xe.wN,getTopicsBySerial:()=>y.V2,getTopicsWebpartDidMountEventEventName:()=>$,getWebviewUrl:()=>y.uH,hasSameId:()=>xe.Ov,homeAndTopicPageGradientBackground:()=>Ue,isAddProviderTypeParamEnabled:()=>i.w1,isAddSourceColumnFlightEnabled:()=>i.oK,isAnnotatePageTitleFlightEnabled:()=>i.Ky,isCSIEnableCreateTopicCrossSitesEnabled:()=>i.sO,isCSITopicImpactMetricsFlightEnabled:()=>i.$C,isCopilotCurationFlightEnabled:()=>i.Ys,isCreateTopicPage:()=>y.Er,isCuratedTopicId:()=>xe.IW,isCurrentUser:()=>xe.vE,isCurrentUserInSuggested:()=>xe.rd,isDisambiguationPage:()=>y.eD,isExpectedError:()=>xe.wI,isFixPendingLogicOfDisposedKMWebPartKSActivated:()=>r.S1,isLanguageFilterFlightEnabled:()=>i.FM,isManagedDashboardV2Enabled:()=>i._N,isMergeTopicsV1FlightEnabled:()=>i.Az,isMobileView:()=>a.E3,isNewPage:()=>y.Bv,isPreviewPage:()=>y.cI,isSameAuthor:()=>J,isSameNameTopic:()=>xe.uR,isSameTopic:()=>xe.Bp,isSameTranslatedTopicDeprecated:()=>xe.Uk,isSitesSegmentationFlightEnabled:()=>i.fk,isSuggestedEntity:()=>xe.NL,isSwitchAPIRequestMethodEnabled:()=>i.Fv,isTopicActivitiesEnabled:()=>i.Bd,isTopicCopilotChatNewExpEnabled:()=>i.Jr,isTopicFaqWPFlightEnabled:()=>i.ez,isTopicPipelineIdOverrideFlightEnabled:()=>i.hp,isTopicSuggested:()=>xe.YQ,isTopicsMultilingualV3FlightEnabled:()=>i.yn,isTypesFilterFlightEnabled:()=>i.vZ,isUseObjectstoreForTopicManagementEnabled:()=>i.ZP,isValidCurationDetails:()=>xe.gP,isZeroTermSuggestionsFlightEnabled:()=>i.tL,loadIsEAPUser:()=>xe.Tc,logASHAError:()=>xe.MW,logEngagement:()=>ue,logEventWithTopicsSDK:()=>Ae,logMergeTopicsEngagement:()=>y.Eo,openInNewTab:()=>y.q3,openTopicErrorPage:()=>xe.dn,pickContentCultureFromLanguages:()=>xe.M_,resetAllowedEditors:()=>Be,resetBadges:()=>v.nX,resetEntityRelations:()=>v.OP,resetHiddenHighlights:()=>Ve,resetHideListEditor:()=>Ge,saveHiddenHighlightstoService:()=>je,saveHideListEditortoService:()=>ze,shouldHideGptExperience:()=>xe.K6,shouldShowGptExperience:()=>xe.ig,switchToEditMode:()=>xe.zx,topicCurated:()=>xe.Fl,topicOrigin:()=>xe.Vy,translateAnnotationResponse:()=>fe.vR,translateDoc:()=>fe.sS,translatePeople:()=>fe.hx,translatePerson:()=>fe.Qi,translateSite:()=>fe.hN,translateSiteMetadata:()=>fe.zb,translateSubstrateSuggestionSearchAPIResponse:()=>fe.vt,translateSubstrateTopicEntity:()=>fe.hK,translateTopicType:()=>fe.V3,useTypeName:()=>we,useUpdateRequiredFields:()=>Ce});var e=C(3762),t=C(9676),n=C(529),a=C(92),i=C(2534),r=C(2517),o=C(5827),s=C(2710);class c extends e.A{getTopics(e){const{Size:o}=e;if(t.Validate.isNotNullOrUndefined(o,"count"),(0,i.fk)()&&!(0,n.isEmpty)(e.Filters.Sites)){const t=(0,n.cloneDeep)(e);t.Filters.Sites=t.Filters.Sites.map(e=>e.ItemReference.SiteId),this._queryOptions=t}else this._queryOptions=e;return(0,r.X2)()||(this._language=a.qc),(0,i.FM)()&&(this._language=e.Filters.Languages?.[0]!==a.Nq?e.Filters.Languages?.[0]||a.qc:a.hf),this.getRequest()}get apiName(){return"Topics/Managed"}get apiParams(){return""}get qosTag(){return"ManageTopics"}get xScenario(){const{Filters:{LifeCycleStates:e}}=this._queryOptions;return e.length>0&&"Removed"===e[0]?"SPPages.TopicManagementV3.RemovedTopics":"SPPages.TopicManagementV3.ActiveTopics"}getCustomRequestOptions(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",(0,i.oK)()&&(e.headers["X-Debug-EnableSourcesForTopicCenter"]="true",e.headers["X-Debug-EnableSourcesV2ForTopicCenter"]="true"),(0,i.fk)()&&(e.headers["X-Debug-EnableSitesForTopicCenter"]="true"),(0,i.FM)()&&(e.headers["X-Debug-EnableLanguagesForTopicCenter"]="true"),(0,i.vZ)()&&(e.headers["X-Debug-EnableTypesForTopicCenter"]="true"),(0,r.EI)()||(e.headers["X-Debug-EnableTopicScoreNormalizationV2"]="true"),e.headers["X-Debug-ServerSidePaginationEnabledHeader"]="true";const t=new URL(window.location.href).searchParams;(0,i.hp)()&&(0,s.zk)()&&t.has(o.rk)?e.body=JSON.stringify({...this._queryOptions,kbPipelineIdOverride:t.get(o.rk)}):e.body=JSON.stringify(this._queryOptions)}constructor(e){super(e,!1)}}var d=C(7408);class l extends e.A{getFilterOptions(e){const t=this._serviceScope.consume(d.PageContext.serviceKey);return this._language=t.cultureInfo.currentUICultureName,this._filters=e,this.getRequest()}get apiName(){return"Topics/Managed/Filters"}get apiParams(){return""}get qosTag(){return"ManageTopicsFilters"}get xScenario(){return"SPPages.TopicManagement.GetFilterOptions"}getCustomRequestOptions(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",(0,i.oK)()&&(e.headers["X-Debug-EnableSourcesForTopicCenter"]="true",e.headers["X-Debug-EnableSourcesV2ForTopicCenter"]="true"),e.headers["X-Debug-ServerSidePaginationEnabledHeader"]="true",e.body=JSON.stringify(this._filters)}constructor(e){super(e,!1)}}class u extends e.A{queueTopicsToMerge(e){return t.Validate.isNotNullOrUndefined(e,"topicIds"),this._topicIds=e.filter(e=>!(0,n.isEmpty)(e.trim())),this.getRequest()}get qosTag(){return"MergeTopics"}get apiName(){return"Topics/Merge"}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify({TopicIds:this._topicIds})}constructor(e,t){super(e,void 0,t)}}class f extends e.A{getTopicStatus(e,t){return this._topicIds=[e.trim()],this._properties=t.filter(e=>!(0,n.isEmpty)(e.trim())),this.getRequest().then(e=>e.value?.[0])}get qosTag(){return"TopicStatus"}get apiName(){return"Topics/Status"}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify({TopicIds:this._topicIds,Properties:this._properties})}constructor(e,t){super(e,void 0,t)}}class p extends e.A{getSubscriptions(){return this.getRequest().then(e=>e?.value)}get apiName(){return"Notification/Subscriptions"}get apiParams(){return""}get qosTag(){return"GetNotificationSubscriptions"}getCustomRequestOptions(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json"}constructor(e){super(e,!1)}}class m extends e.A{updateSubscriptions(e){return this._subscriptions=e,this.getRequest()}get apiName(){return"Notification/Subscriptions/Update"}get apiParams(){return""}get qosTag(){return"UpdateNotificationSubscriptions"}getCustomRequestOptions(e){e.headers["X-ODataQuery"]="true",e.headers.accept="application/json",e.body=JSON.stringify({Subscriptions:this._subscriptions})}constructor(e){super(e,!1),this._subscriptions=[]}}class _ extends e.A{get apiName(){return`Topics/${this._feedbackType}`}get qosTag(){return`ManageTopics.${this._feedbackType}`}get xScenario(){return"Confirm"===this._feedbackType?"SPPages.TopicManagement.Confirmed":"Exclude"===this._feedbackType?"SPPages.TopicManagement.Removed":void 0}provideFeedback(e,n){return t.Validate.isNotNullOrUndefined(e,"topics"),t.Validate.isNotNullOrUndefined(n,"feedbackType"),this._feedbackType=n,this._topics=e.map(e=>({Id:e.Id,Name:e.Name})),this.getRequest()}getCustomRequestOptions(e){e.body=JSON.stringify({Topics:this._topics})}constructor(e){t.Validate.isNotNullOrUndefined(e,"serviceScope"),super(e,!1),this._topics=[]}}class h extends e.A{get qosTag(){return"GetTopicSuggestion"}get isPost(){return!1}getTopicSuggestion(e,t){if(0===e.length&&this._lastQuerySuggestionsResult?.length>0)return(0,i.tL)()?Promise.resolve(this._zeroTermSuggestionsResult):Promise.resolve(this._lastQuerySuggestionsResult);0===e.length&&(e=(0,i.tL)()?"":"a");const n=`&prefix=${encodeURIComponent(e)}&topicCount=${t}`;return this.getRequest(n,void 0,this._warmUpQueryRun).then(e=>(this._lastQuerySuggestionsResult=e.value,Promise.resolve(this._lastQuerySuggestionsResult)))}_warmUpSuggestionsApi(){if(this._isPageInEditMode&&!this._warmUpQueryRun){this._warmUpQueryRun=!0;const e=(0,i.tL)()?"":"a",n=t._SPFlight.isEnabled(663)?10:5;this.getTopicSuggestion(e,n).then(e=>{(0,i.tL)()&&(this._zeroTermSuggestionsResult=e)}),this._warmUpQueryRun=!1}}_shouldWarmUpSuggestionsApi(){const e=(new Date).getTime()-h._lastInitQueryTime;return!h._lastInitQueryTime||e>3e5}get _isPageInEditMode(){return-1!==new URLSearchParams(window.location.search).toString().indexOf("Mode=Edit")}constructor(e,t){super(e,void 0,t),this._warmUpQueryRun=!1,this._zeroTermSuggestionsResult=[],this._language=this.pageContext.cultureInfo.currentUICultureName,this._shouldWarmUpSuggestionsApi()&&(h._lastInitQueryTime=(new Date).getTime(),this._warmUpSuggestionsApi())}}var b=C(1019),g=C(1750),v=C(6429),y=C(1634);class S extends e.A{processFeedback(e,n){return t.Validate.isNotNullOrUndefined(e,"topicEntity"),t.Validate.isNotNullOrUndefined(n,"feedbackQuestion"),t.Validate.isNotNullOrUndefined(n.ResponseType,"feedbackQuestion.ResponseType"),this._requestBody=this._buildProcessFeedbackAPIRequestBody(e,n),this.getRequest()}get apiName(){return"TopicCardFeedback"}get qosTag(){return"TopicCardFeedback"}getCustomRequestOptions(e){e.body=this._requestBody}_buildProcessFeedbackAPIRequestBody(e,t){const n={EntityId:e.Id,Name:e.Name,CurrentPageId:this._currentPageId,QuestionType:t.QuestionType,ResponseType:t.ResponseType};return"Person"===t.RelatedEntity?.Type&&(n.RelatedPerson=t.RelatedEntity.EntityIdentity),JSON.stringify({Request:n})}constructor(e,n,a="SPPages.TopicCard.Feedback"){t.Validate.isNotNullOrUndefined(e,"serviceScope"),super(e,void 0,a),this._spoId=n,this._currentPageId={SiteId:this._spoId.siteId?.toString()??t.Guid.empty.toString(),WebId:this._spoId.webId?.toString()??t.Guid.empty.toString(),UniqueId:this._spoId.uniqueId?.toString()??t.Guid.empty.toString()}}}var D=C(8414),I=C(2207);class x{static load(e){if(!x._peopleDataProviderPromise){const t=new I._QosMonitor(`${e}.PeopleDataProvider.DeferredLoad`);x._peopleDataProviderPromise=D.SPComponentLoader.loadComponentById(x._peopleDataProviderComponentId).then(e=>(t.writeSuccess(),e.PeopleDataProvider)).catch(e=>{throw t.writeUnexpectedFailure("LoadModuleFailure",e),e})}return x._peopleDataProviderPromise}}x._peopleDataProviderComponentId="8b7ae98f-492d-4304-93df-8f8a9fbedf11";var O=C(7849),w=C(8831);class E extends Error{constructor(e){super(e),this.__proto__=E.prototype}}class A extends e.A{get qosTag(){return"GetTopicById"}get apiName(){return(0,i.Fv)()?"Topics/Ids":this._useMined?"Topics/Mined":"Topics"}get xScenario(){return(0,r.dw)()?"SPPages.TopicPage.Read":this._scenario||"SPPages.TopicPage.Read"}get isPost(){return(0,i.Fv)()}getTopic(e,a=this._useMined,o,s,c){if(t.Validate.isNonemptyString(e,"topicId"),(0,w.X)()){const t=this._getTABMockMinedData();let n={value:[]};return t&&(n=JSON.parse(t),n.value.length>0&&(n.value[0].Id=e)),Promise.resolve(n).then(this._handleResponse)}if(this._useMined=a,this._language=s,(0,r.Oe)()||(this._customOptions=c),(0,i.Fv)())return this._resourceOptions=o,this._topicId=e,this.getRequest().then(this._handleResponse);let d="";return(0,n.isEmpty)(o)||(0,n.each)(o,(e,t)=>d+=`&${t.toLowerCase()}=${e}`),this.getRequest(`&id=${e}${d}`).then(this._handleResponse)}getCustomRequestOptions(e){super.getCustomRequestOptions(e),(0,i.Fv)()&&(e.body=JSON.stringify({TopicIds:[this._topicId],IsMinedOnly:this._useMined,ResourceOptions:this._resourceOptions,...(0,i.w1)()&&-1!==o.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType}})),(0,r.Oe)()||(e.headers={...e.headers,...this._customOptions?.headers}),(0,i.Az)()&&"true"===new URL(window.location.href).searchParams.get(a.rd.DisableMergeRedirect)&&(e.headers["X-DisableMergeRedirect"]="true")}_getTABMockMinedData(){return window.sessionStorage.getItem("MOCK_TOPIC_MINED_RESPONSE")}constructor(e,t,n){super(e,!0,n),this._handleResponse=e=>{if(0===e.value.length)throw new E(a.bq);return e.value[0]},this._useMined=t}}class L extends e.A{fetchTopics(e,a){return t.Validate.isNotNullOrUndefined(e,"topicIds"),this._topicIds=e.filter(e=>!(0,n.isEmpty)(e.trim())),this._language=a?.language,this._topicsGraphDepth=a?.topicsGraphDepth,0===this._topicIds.length?Promise.resolve([]):this.getRequest().then(e=>e.value)}get qosTag(){return"GetTopicsByIds"}get apiName(){return"Topics/Ids"}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify({TopicIds:this._topicIds,...Boolean(this._topicsGraphDepth)&&{RelatedTopics:{TopicsGraphDepth:this._topicsGraphDepth}},...(0,i.w1)()&&-1!==o.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType}})}constructor(e,t="SPPages.TopicCard.Embedded"){super(e,void 0,t)}}var M=C(6277);class P extends e.A{getAnnotations(e,n){return t.Validate.isNotNullOrUndefined(e,"contentArr"),t.Validate.isNotNullOrUndefined(n,"spoId"),this._contentArr=e,this._spoId=n,this._language=this.pageContext.cultureInfo.currentUICultureName,this.getRequest().then(e=>e)}get fetchRetryOptions(){return{shouldRetryOnError:e=>-1===b.R.Cancelled.indexOf(e.message?.toLowerCase()),retries:1}}get apiName(){return"Annotation"}get qosTag(){const e="Annotation";return this._doNotRetrieveTopicDetails?`${e}.DoNotRetrieveDetails`:e}get xScenario(){return"SPPages.TopicAnnotation.SPPage"}get clientRequestId(){return this._clientRequestId}getCustomRequestOptions(e){const t={Provider:"Yggdrasil"};t.TextSections=this._contentArr.map(e=>({SectionId:e.id,Text:e.text,RetrieveTopicDetails:!this._doNotRetrieveTopicDetails})),t.CurrentPageId={SiteId:this._spoId.siteId?.toString()??P._allTopicsPageGuid,WebId:this._spoId.webId?.toString()??P._allTopicsPageGuid,UniqueId:this._spoId.uniqueId?.toString()??P._allTopicsPageGuid},e.body=JSON.stringify({AnnotationRequest:t});const n=new URL(window.location.href).searchParams;e&&e.headers&&("0"===n.get("threshold")&&(e.headers["X-Debug-SkipAnnotationFiltering"]="true"),"true"===n.get("yukonFlight")&&(e.headers["X-Debug-IsYukonHighlightFlightEnabled"]="true"),(0,r.Hy)()||(1===(0,M.getVariantAndLogExposure)(90146,this.pageContext.legacyPageContext)?e.headers["X-Debug-ExperimentalWTQ"]="true":e.headers["X-Debug-ExperimentalWTQ"]="false"))}constructor(e,t){super(e),this._doNotRetrieveTopicDetails=t}}P._allTopicsPageGuid="9833225a-d24b-4b9e-b16d-bba52bae6e23";class T extends e.A{getTopicEntity(e,n={},a){return t.Validate.isNotNullOrUndefined(e,"topicId"),this._language=a,(0,i.Fv)()?(this._topicId=e,this.getRequest().then(({value:e})=>e?.[0])):this.getRequest(`&wholeTopicQualityModelVersion=V9&TopicsGraphDepth=1&id=${e}&${this._generateQueryString(n)}`).then(({value:e})=>e?.[0])}setGraphDepth(e){this._graphDepth=e}get qosTag(){return"GetRelatedTopics"}get apiName(){return(0,i.Fv)()?"Topics/Ids":"Topics"}get apiParams(){return(0,i.Fv)()?"":"?provider=Yggdrasil"}get isPost(){return(0,i.Fv)()}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.headers["X-Debug-EnableRelatedTopics"]="true",e.headers["X-Debug-EnableMultiHopRelatedTopics"]="true",(0,i.Fv)()&&(e.body=JSON.stringify({TopicIds:[this._topicId],RelatedTopics:{TopicsGraphDepth:this._graphDepth,FocalTopicAdjacentTopics:6,...(0,i.w1)()&&-1!==o.RQ.indexOf(this._providerType)&&{ProviderType:this._providerType}}}))}_generateQueryString(e){return new URLSearchParams(e).toString()}constructor(e,t="SPPages.TopicPage.RelatedTopics"){super(e,void 0,t),this._graphDepth=1}}var U=C(5959),F=C.n(U),H=(C(8398),C(4907)),R=C(5519),N=C(6642),B=C(1962),j=C(718),V=C(2141),z=C(2480);class G extends z.M{constructor(e,t){super(e);const n=e.consume(j.TopicDataService.serviceKey),a=e.consume(d.PageContext.serviceKey);t&&(this.customData={topicId:t.Id,topicStatus:t.State,hasTopicDescription:Boolean(t.Definitions?.[0]?.Value),topicLifeCycleState:t.LifeCycle?.State,topicSource:t.Source||"",topicRelevanceScore:t.RelevanceScore,pageLayout:"TopicPage",pageCulture:n?.topicPageMultilingualInfo?.translationLanguage||n?.topicPageMultilingualInfo?.previewLanguage||"",userCulture:a.cultureInfo.currentUICultureName,topicsCulture:a.web.languageName})}}function K(e,t){return t||(t=e.consume(j.TopicDataService.serviceKey).currentTopic),new G(e,t)}class W extends z.M{constructor(e,t){super(e);const n=e.consume(j.TopicDataService.serviceKey),a=e.consume(d.PageContext.serviceKey);t&&(this.customData={topicId:t.Id,topicStatus:t.State,hasTopicDescription:Boolean(t.Definitions?.[0]?.Definition),topicLifeCycleState:t.LifecycleState?.State,topicSource:t.Source||"",topicRelevanceScore:t.Score,pageLayout:"TopicPage",pageCulture:n?.topicPageMultilingualInfo?.translationLanguage||n?.topicPageMultilingualInfo?.previewLanguage||"",userCulture:a.cultureInfo.currentUICultureName,topicsCulture:a.web.languageName})}}var q=C(8506);class Q extends U.Component{componentDidMount(){!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess(),this.props.onDidMount?.()}componentDidUpdate(e){!this.state.error&&this.props.isReadyToCompleteRender&&this.props.onRenderSuccess()}componentDidCatch(e,t){this.setState({error:e}),this.props.onRenderFailure(e)}render(){if(this.state.error)throw this.state.error;return this.props.children}constructor(e){super(e),this.state={error:void 0}}}function Y(e,t,n){const a=new I._QosMonitor(`${n}.getLatestCurationAuthorProfile`);return t.then(t=>t.getPeopleInfo(e.upn||e.email).then(t=>(a.writeSuccess(),{...e,name:t.name||"",email:t.email||""}))).catch(t=>(a.writeUnexpectedFailure("GetProfileFailedUnexpected",t),e))}function J(e,t){return!(!e||!t)&&(e.upn&&e.upn===t.upn||e.email&&e.email===t.email)}function X(e,t){(0,n.isEmpty)(e)||(0,n.isEmpty)(t)||e.forEach((a,i)=>{if(!a.curationDetails?.author)return;const r=(0,n.find)(t,e=>J(e,a.curationDetails.author));r&&(e[i].curationDetails.author=r)})}var Z=C(8424);function $(e){return`TopicsWebpartDidMountEvent_${e}`}Z.loadStyles('.c_rVSWG_Xodrq{background-color:"[theme:bodyBackground, default: #ffffff]";border-radius:8px;margin-bottom:0;margin-top:20px;padding:20px}',!0);class ee extends N.BaseClientSideWebPart{render(){((0,r.U5)()||this&&this.domElement)&&(this.onUpdateAccessibleTitle(),this.webPartContext?H.render(U.createElement(this.webPartContext.Provider,{value:this.webPartContextData},this._renderContent()),this.domElement):H.render(this._renderContent(),this.domElement))}get inheritedProperties(){if(this.context&&this.topicDataService?.topicPageMultilingualInfo?.isTranslation){const e=this.topicDataService?.inheritedWebPartsDataMap?.get(this.context.instanceId);return e?.properties&&B._PropertyMetadataProcessor.reInstateServerProcessedData(this.propertiesMetadata,e.properties,e.serverProcessedContent,this.context.manifest),e?.properties}}get isOnTranslationPage(){return this.topicDataService.topicPageMultilingualInfo?.isTranslation}get showEditOnDefaultAction(){return Boolean(this.displayMode===t.DisplayMode.Edit&&this.useInheritedPropertiesForTranslationPage&&this.isOnTranslationPage)}onUpdateRecentActivities(){}get isWebPartEmpty(){return!1}get viewModeContainerClass(){}get webPartContext(){}get relationCountQueryParamKey(){return""}get webPartContextData(){}get useInheritedPropertiesForTranslationPage(){return!1}get disableEntityRelationsForTranslationPage(){return!1}getRemovedItemsFromTopicEntity(e){}isReadyToCompleteRender(){return!this.isRenderAsync||this.isSuggestedDataLoaded}onInit(){return this._renderQosMonitor=new I._QosMonitor(`${this.qosPrefix}.ComponentRender`),this.onInitInheritedProperties(),(0,r.kR)()&&this._registerTopicLoadedEventListener(),super.onInit().then(()=>{!(0,r.jF)()&&this.isDisposed||(this.onAsyncUpdateAndRender(),(0,r.kR)()||this._registerTopicLoadedEventListener())})}onBeforeSerialize(){this.isOnTranslationPage&&((0,i.yn)()?this.disableEntityRelationsForTranslationPage:this.useInheritedPropertiesForTranslationPage)||(this.onUpdateEntityRelations(),(0,i.Bd)()&&this.onUpdateRecentActivities()),this._checkAddedCuratedAndDisplayFRE(),super.onBeforeSerialize()}onAfterDeserialize(e,n){return this.displayMode!==t.DisplayMode.Edit||this._hasUpdatedCurationAuthorPropertiesInEditMode||X(e.curated,this._updatedCurationAuthorProfiles),this._setUpdatedFlagInEditMode(),e}onDispose(){super.onDispose(),ee._currentTopicEntity=void 0,ee._afterLoadSuggestedListeners.clear(),this._unregisterTopicLoadedSPEventListeners()}getCurrentTopicEntity(){return ee._currentTopicEntity?Promise.resolve(ee._currentTopicEntity):Promise.resolve(void 0)}onUpdateAccessibleTitle(){if(this.displayMode===t.DisplayMode.Edit){const e=this.accessibleTitle||this._getDefaultAccessibleTitle();if(e){const t=`cswpAccessibleLabelContextual_${this.context.instanceId}`,n=this.domElement.querySelector(`#${t}`);n&&n.textContent!==e&&(n.textContent=e)}}}onAsyncUpdateAndRender(){!(0,r.S1)()&&this.isDisposed||this._refreshCurationDetailsPeopleProfile()}renderCompleted(e,t,n){this._firstRenderCompleteTime||(this._firstRenderCompleteTime=Date.now()),e?this._logRenderError(e,n):this._logRenderSuccess(),this._endPerfMarkWhenAllWebPartsAreReady(),super.renderCompleted(e,!!t)}get isRenderAsync(){return!0}isTopicPreviewPage(){return(0,y.cI)()}get topicDataService(){return this._topicDataService||(this._topicDataService=this.context.serviceScope.consume(j.TopicDataService.serviceKey)),this._topicDataService}get initialRelationCount(){return a.E3?a.lO:a.Kc}get topicId(){return this.topicDataService.currentTopicEntity?.Id}getPeopleDataProvider(){return this._peopleDataProvider||(this._peopleDataProvider=x.load(this.qosPrefix).then(e=>new e(this.context.serviceScope,this.qosPrefix))),this._peopleDataProvider}onInitInheritedProperties(){this.isOnTranslationPage&&this.useInheritedPropertiesForTranslationPage&&(this.properties.curated=this.inheritedProperties?.curated||[],this.properties.removed=this.inheritedProperties?.removed||[])}_dispatchTopicPublishTeachingBubbleEvent(){document.dispatchEvent(new CustomEvent(a.Oy.showTopicPublishTeachingBubbleEventName))}_checkAddedCuratedAndDisplayFRE(){if(this._firstRenderCompleteTime){const e=Date.now(),t=this.properties.curated?.some(t=>{if(!t.curationDetails?.time)return!1;const n=new Date(t.curationDetails.time).getTime();return e-n<5e3&&this._firstRenderCompleteTime<n});t&&this._dispatchTopicPublishTeachingBubbleEvent()}}_renderContent(){return this.onInitInheritedProperties(),U.createElement(Q,{isReadyToCompleteRender:this.isReadyToCompleteRender(),onRenderSuccess:this.renderCompleted,onRenderFailure:this.renderCompleted,onDidMount:()=>{t._SPEventManager.instance.raiseEvent($(this.manifest.id),{})}},this.displayMode!==t.DisplayMode.Edit?!this.isWebPartEmpty&&U.createElement("div",{className:(0,V.css)("c_rVSWG_Xodrq",this.viewModeContainerClass)},this.contentElement):this.contentElement)}_feedSuggestedAndFeedbackDataToWebPart(e){const t=e?this.getSuggestedItemsFromTopicEntity(e):void 0,n=e?this.getRemovedItemsFromTopicEntity(e):void 0;this.onAfterLoadSuggestedAndFeedback(t,n),this.render()}get _topicEntityDataProvider(){return this._substrateDataProvider||(this._substrateDataProvider=new A(this.context.serviceScope)),this._substrateDataProvider}_extraQosData(e){return{isSuggestedDataLoaded:this.isSuggestedDataLoaded,...e&&{errorCode:e.name,errorMessage:e.message,errorStack:e.stack}}}_unregisterTopicLoadedSPEventListeners(){t._SPEventManager.instance.unregisterEvent(a.Oy.currentTopicLoadedEvent,this,this._handleTopicLoaded)}_registerTopicLoadedEventListener(){t._SPEventManager.instance.registerEvent(a.Oy.currentTopicLoadedEvent,this,this._handleTopicLoaded)}_initializeEngagementLogger(e){e&&(this.engagementLogger=new W(this.context.serviceScope,e))}_isEveryTopicWebPartReadyInPerfLog(){const e=[];return R._PerformanceLogger.getExpectedControls().forEach(t=>e.push(t)),[g.U.TITLE_REGION_WP_ID,g.U.OVERVIEW_RTE_INSTANCE_ID,g.U.RELATED_PEOPLE_WP_ID,g.U.GRAPH_WP_ID,g.U.RELATED_DOCS_WP_ID,g.U.RELATED_SITES_WP_ID].filter(e=>!!e).every(t=>e.some(e=>e.indexOf(t)>-1))}_setUpdatedFlagInEditMode(){this.displayMode===t.DisplayMode.Edit&&(this._hasUpdatedCurationAuthorPropertiesInEditMode=!0)}constructor(){super(),this.isSuggestedDataLoaded=!1,this.hasGotMaximumRelations=!1,this._hasUpdatedCurationAuthorPropertiesInEditMode=!1,this._updatedCurationAuthorProfiles=[],this.requestMaximumRelations=()=>{if(!this.hasGotMaximumRelations&&this.relationCountQueryParamKey){if(this.topicId&&this.topicId!==j.NULL_TOPIC_ENTITY.Id){const e=new I._QosMonitor(`${this.qosPrefix}.requestMaximumRelations`);return this._topicEntityDataProvider.getTopic(this.topicId,!0,{[this.relationCountQueryParamKey]:a.lO},(0,q.wN)(this.context.serviceScope)).then(O.hK).then(e=>{this.hasGotMaximumRelations=!0,this.topicDataService.currentTopicEntity=e,this._feedSuggestedAndFeedbackDataToWebPart(e)}).then(()=>(e.writeSuccess({relationType:this.relationCountQueryParamKey}),a.lO)).catch(t=>{throw e.writeUnexpectedFailure("RequestMaximumRelationsFail",t,{stack:t.stack,relationType:this.relationCountQueryParamKey}),t})}return Promise.resolve(void 0)}return Promise.resolve(a.lO)},this._logRenderError=(e,t)=>{this._renderQosMonitor?.writeUnexpectedFailure(t||"FailedToRender",e,this._extraQosData(e))},this._logRenderSuccess=()=>{this._renderQosMonitor?.writeSuccess(this._extraQosData())},this._handleTopicLoaded=({topic:e})=>{if(!e||e.Id===this.topicId)try{this.isSuggestedDataLoaded=!0,ee._currentTopicEntity=e,this._initializeEngagementLogger(e),this._feedSuggestedAndFeedbackDataToWebPart(e)}catch(e){this.renderCompleted(e)}},this._endPerfMarkWhenAllWebPartsAreReady=()=>{this._isEveryTopicWebPartReadyInPerfLog()&&R._PerformanceLogger.endMarkForComponent("TopicPageLayoutComponent")},this._refreshCurationDetailsPeopleProfile=()=>{var e,t,a;(0,n.isEmpty)(this.properties.curated)||(this._setUpdatedFlagInEditMode(),(e=function(e){const t=e?.map(e=>e.curationDetails?.author)?.filter(e=>!(0,n.isEmpty)(e))??[];return(0,n.uniqBy)(t,e=>e.upn||e.email)}(this.properties.curated),t=this.getPeopleDataProvider(),a=this.qosPrefix,Promise.all(e.map(e=>Y(e,t,a)))).then(e=>{!(0,r.S1)()&&this.isDisposed||e.length>0&&(this._updatedCurationAuthorProfiles=e,X(this.properties.curated,e),this.render())}).catch(e=>{I._TraceLogger.logError(I._LogSource.create(`${this.qosPrefix}.UpdateCurationAuthorProfile`),e)}))},this._dispatchTopicPublishTeachingBubbleEvent=(0,n.debounce)(this._dispatchTopicPublishTeachingBubbleEvent,3e3)}}ee._afterLoadSuggestedListeners=new Map;class te extends S{static initialize(e,t,n){return(0,y.hp)(e,"MyTopicsFeedback.DP").then(a=>new te(e,t,a||"",n))}sendFeedback(e,t){return super.processFeedback(e,{QuestionType:"IsPersonRelated",ResponseType:"ConfirmConnection"===t?"Yes":"No",RelatedEntity:{Type:"Person",Name:this.pageContext.user.displayName,EntityIdentity:{ObjectId:this.pageContext.aadInfo?.userId.toString(),UserPrincipalName:this.pageContext.user.loginName}}})}get qosTag(){return"MyTopicsFeedback"}constructor(e,n,a,i){super(e,{siteId:n.site.id,webId:n.web.id,listId:n.list?.id,uniqueId:t.Guid.tryParse(a)||t.Guid.empty},i)}}var ne=C(6300),ae=C(6575);Z.loadStyles('.f_RxtQ7_Xodrq{border:0;padding:0}.f_RxtQ7_Xodrq:hover{background-color:"[theme:neutralLighter, default: #f3f2f1]"}.f_RxtQ7_Xodrq .i_siAvr_Xodrq{color:"[theme:themePrimary, default: #0078d4]"}',!0);const ie=JSON.parse('{"D":"Give feedback","Q":"Send an email message to the Project Cortex topic experiences team"}'),re="projecthedleyfeedback@service.microsoft.com";function oe({topicId:e,topicName:t,pageContext:n,source:a,className:i,buttonStyles:r,mailSubject:o,mailBody:s,extraDebugStrings:c,onClickFeedback:d}){const l=U.useCallback(()=>{I._EngagementLogger.logEventWithLogEntry(new I._LogEntry("TopicCard","CSIKM.TopicCard.GiveFeedbackEmail",I._LogType.Event,{topicId:e},!0))},[e]);return U.createElement(ae.DefaultButton,{iconProps:{iconName:"Emoji2",className:"i_siAvr_Xodrq"},onClick:d??l,href:(0,y.d6)({feedbackEmail:re,topicId:e,topicName:t,buildNumber:R._Telemetry.buildNumber,source:a,pageContext:n,mailSubject:o,mailBody:s,extraDebugStrings:c}),className:(0,V.css)("f_RxtQ7_Xodrq",i),title:ie.Q,styles:{...r,label:{fontWeight:"normal"}}},ie.D)}const se=U.lazy(()=>C.e(830).then(C.bind(C,4366))),ce=U.forwardRef(function(e,t){return U.createElement(U.Suspense,{fallback:U.createElement(U.Fragment,null)},U.createElement(se,{...e,ref:t}))});function de(e){return j.Icons.getIconUrl(e.split(".").pop()||"")}var le=C(921);function ue(e,t,n,a,i){const r={};a&&(r.topicId=a,r.topicOrigin=(0,le.A)(a)),i&&(r.topicCurated=i),I._EngagementLogger.logEventWithLogEntry(new I._LogEntry(t,e,I._LogType.Event,{...n,...r},!0))}var fe=C(6500),pe=C(7699),me=C(2218);class _e extends e.A{getDashboardDataByLifecycleState(e){return this._managedTopicState=e,this.getRequest()}getDashboardData(e){return this._pastDays=e??30,this.getRequest()}get apiName(){return(0,i._N)()?"Topics/ManagedDashboardV2":"Topics/ManagedDashboard"}get qosTag(){return(0,i._N)()?"ManagedDashboard":"GetManagedDashboardByLifecycleState"}get xScenario(){return"SPPages.TopicManagementV3.Dashboard"}getCustomRequestOptions(e){let t;(0,i._N)()?t={PastDays:this._pastDays}:(e.headers["X-ODataQuery"]="true",t={ManagedTopicState:this._managedTopicState,PastDays:this._pastDays}),e.body=JSON.stringify(t)}constructor(e){super(e,!1),this._pastDays=30}}class he extends e.A{requestMyTopics(e,t){if(e&&(this._sortOption=e),t&&(this._sortDirection=t),(0,w.X)()){const e=this._getTABMockData();return Promise.resolve(e?JSON.parse(e):{CanEdit:!0,Suggested:[],Confirmed:[]})}return super.getRequest()}get isPost(){return!0}get apiName(){return"Topics/My"}get qosTag(){return"GetMyTopics"}get apiParams(){return""}getCustomRequestOptions(e){const t=new URL(window.location.href).searchParams;if((0,r.M2)()||"true"===(t.get("allowUnlicensedUsersInMyTopics")??"false").toLowerCase()&&(e.headers["X-Debug-EnableMyTopicsForUnlicensedUsers"]="true"),this._sortOption&&this._sortDirection){const t={};t.Confirmed={Sort:{Field:this._sortOption,Direction:this._sortDirection}},e.body=JSON.stringify(t)}else super.getCustomRequestOptions(e)}_getTABMockData(){return window.sessionStorage.getItem("MOCK_MY_TOPICS_RESPONSE")}constructor(e,t=!0,n){super(e,t,n),this._language=this.pageContext.cultureInfo.currentUICultureName}}var be=C(2183),ge=C(95);const ve=JSON.parse('{"lL":"Source {0}","$1":"Wikipedia","l9":"Text under CC-BY-SA license"}');function ye(e){return U.createElement(be.Stack,{className:e.className},U.createElement(be.Stack,null,e.source.title&&(e.source.url?U.createElement(j.RichTextFormatter,{template:ve.lL,values:[U.createElement(ge.Link,{key:e.source.url,href:e.source.url,target:"_blank","data-interception":"off",title:e.source.title,onClick:e.onSourceClick},e.source.title)],className:"s_z_yIO_Xodrq"}):U.createElement("span",null,e.source.title))))}function Se(e){const{stacked:t}=e;return U.createElement(j.RichTextFormatter,{template:ve.lL,className:(0,V.css)("c_Tm4hY_Xodrq",e.className,t&&"s_zRAUc_Xodrq"),values:[U.createElement(ge.Link,{key:e.source.url,href:e.source.url,target:"_blank",title:e.source.url,className:"m_S4_Ns_Xodrq"},ve.$1),U.createElement(ge.Link,{key:"1",href:"https://creativecommons.org/licenses/by-sa/3.0/",target:"_blank",className:(0,V.css)(t?"l_kWyDT_Xodrq":"g_IBY95_Xodrq","l_8bfyo_Xodrq")},ve.l9)]})}function De(e){return U.createElement(be.Stack,null,U.createElement("span",null,e.languageSourceMessage))}Z.loadStyles(".c_Tm4hY_Xodrq{display:flex}.c_Tm4hY_Xodrq.s_zRAUc_Xodrq{display:block}[dir=ltr] .c_Tm4hY_Xodrq .g_IBY95_Xodrq{margin-left:12px}[dir=rtl] .c_Tm4hY_Xodrq .g_IBY95_Xodrq{margin-right:12px}[dir=ltr] .c_Tm4hY_Xodrq .m_KRXxu_Xodrq{margin-right:4px}[dir=ltr] .c_Tm4hY_Xodrq .m_S4_Ns_Xodrq,[dir=rtl] .c_Tm4hY_Xodrq .m_KRXxu_Xodrq{margin-left:4px}[dir=rtl] .c_Tm4hY_Xodrq .m_S4_Ns_Xodrq{margin-right:4px}.c_Tm4hY_Xodrq .l_8bfyo_Xodrq{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.c_Tm4hY_Xodrq .l_kWyDT_Xodrq{display:block}.s_z_yIO_Xodrq{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}",!0);var Ie=C(7599),xe=C(5727);function Ce({serviceScope:e,shouldShowError:t,requiredField:n}){U.useEffect(()=>{e.whenFinished(()=>{e.consume(j.TopicDataService.serviceKey).missingRequiredFields[n]=t})},[e,t,n])}var Oe=C(1506);function we(e,t){const[a,r]=F().useState("");return F().useEffect(()=>{e.curatedTypeId?function(e,t){const n=new URL(window.location.href).searchParams;return(0,Oe.getTopicsSdk)(t,(0,q.wN)(t)).then(t=>t.searchTopicsTypes(void 0,[e],void 0,void 0,{headers:{...(0,i.hp)()&&n.has(o.rk)?{"X-Debug-KnowledgebasePipelineOverride":n.get(o.rk)}:{}}}).then(e=>e?.length?e[0].DisplayName:""))}(e.curatedTypeId,t).then(e=>{r(e)}).catch(n.noop):(0,y.cI)()&&e.currentTopicEntity.HasPrimaryType&&r((0,n.find)(e.currentTopicEntity.TopicTypes,"IsPrimary")?.DisplayName||"")},[e.curatedTypeId,t,e.currentTopicEntity,e.topicPageMultilingualInfo]),a}var Ee=C(628);function Ae(e,t,n,a=!0){const i=(0,Oe.tryGetTopicsSdk)();function r(e){e.logEvent(t,n,{isIntentional:a})}i?r(i):(0,Oe.getTopicsSdk)(e).then(r)}const Le=JSON.parse('{"x6":"Suggested","ib":"Confirmed","Sz":"Published","vT":"Removed","wO":"Merged","j9":"Topic identified by AI","Xx":"Approved topic identified by AI","VJ":"Topic manually created or curated","Eb":"Topic rejected, not visible to viewers","c_":"Merged topic, only visible to knowledge managers."}'),ke={UserSuggested:"Suggested",Suggested:"Suggested",Confirmed:"Confirmed",Published:"Published",Removed:"Removed"},Me={UserSuggested:Le.x6,Suggested:Le.x6,Confirmed:Le.ib,Published:Le.Sz,Removed:Le.vT,Merged:Le.wO},Pe={Suggested:Le.j9,Confirmed:Le.Xx,Published:Le.VJ,Removed:Le.Eb,Merged:Le.c_},Te={homePage:{layout:"KnowledgeCenterHomePageLayout",myTopics:"KnowledgeCenterMyTopics"},topicsManagement:{layout:"KnowledgeCenterTopicsManagementLayout",webPart:"KnowledgeCenterTopicsManagementWebPart"},topicsIntro:{layout:"KnowledgeCenterTopicsIntroLayout",canvas:"KnowledgeCenterTopicsIntroCanvas"}};function Ue(e,t){return`linear-gradient(180deg, transparent 0%, ${e} 40%), radial-gradient(56.32% 644.53% at -62.32% 50.43%, ${e} 0%, ${t} 1000%)`}var Fe=C(4967);function He(e){return e.Title+(e.Extension?"."+e.Extension:"")}class Re extends e.A{getEventMetrics(e){return this._metricsRequest=e,this.getRequest()}get qosTag(){return"GetEventMetrics"}get apiName(){return"Metrics"}getCustomRequestOptions(e){super.getCustomRequestOptions(e),e.body=JSON.stringify(this._metricsRequest)}constructor(e,t){super(e,void 0,t)}}function Ne(e,n){t.Validate.isNotNullOrUndefined(e,"serviceScope"),t.Validate.isNotNullOrUndefined(n,"newEditors"),e.consume(j.VerifiedTopicAllowedEditorsService.serviceKey).editorsContainer=n}function Be(e){t.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(j.VerifiedTopicAllowedEditorsService.serviceKey).editorsContainer=[]}function je(e,n){t.Validate.isNotNullOrUndefined(e,"serviceScope"),t.Validate.isNotNullOrUndefined(n,"newHiddenHighlights"),e.consume(j.HiddenHighlightsInfoService.serviceKey).spHiddenHighlightsMetadata=n}function Ve(e){t.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(j.HiddenHighlightsInfoService.serviceKey).spHiddenHighlightsMetadata=[]}function ze(e,n){t.Validate.isNotNullOrUndefined(e,"serviceScope"),t.Validate.isNotNullOrUndefined(n,"newHideListEditor"),e.consume(j.HiddenHighlightsInfoService.serviceKey).spHideListEditorMetadata=n}function Ge(e){t.Validate.isNotNullOrUndefined(e,"serviceScope"),e.consume(j.HiddenHighlightsInfoService.serviceKey).spHideListEditorMetadata="null"}})(),k})())})();