(()=>{var e=document.currentScript;define("16dc6880-3e5b-4b96-b33f-13ed051a642b_0.1.0",["react","@microsoft/sp-http","@microsoft/microsoft-graph-client","@msinternal/odsp-utilities-bundle","@microsoft/sp-http-base","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-diagnostics","@microsoft/sp-lodash-subset","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/sp-fluent-theme-bundle","@msinternal/sp-fluentui-v9-react-image-bundle","@msinternal/sp-fluentui-v9-react-text-bundle","@msinternal/sp-fluentui-v9-react-tag-picker-bundle","@msinternal/sp-fluentui-v9-react-button-bundle","@msinternal/sp-fluentui-v9-react-spinner-bundle","tslib","@msinternal/odsp-core-bundle","@msinternal/sp-fluentui-v9-react-positioning-bundle","@msinternal/sp-fluentui-v9-react-popover-bundle","@msinternal/sp-fluentui-v9-react-tags-bundle","@msinternal/sp-fluentui-v9-react-tooltip-bundle","@msinternal/sp-fluentui-v9-react-combobox-bundle","@msinternal/sp-fluentui-v9-react-tabs-bundle","@msinternal/sp-fluentui-v9-react-divider-bundle","@msinternal/sp-fluentui-v9-react-search-bundle","@msinternal/sp-component-utilities","@msinternal/swc-helpers-bundle","react-dom","@msinternal/sp-fluentui-v9-react-message-bar-bundle","@msinternal/sp-fluentui-v9-react-progress-bundle","@msinternal/sp-fluentui-v9-react-menu-bundle","@msinternal/sp-fluentui-v9-react-overflow-bundle"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P)=>(()=>{var T,U={6789:(e,t,n)=>{"use strict";const a=n(7674);e.exports=a}
,7674:(e,t,n)=>{"use strict";var a=n(7380),i=n(821),r=n(8182),o=n(2475);function s(e){let t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}let c="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;function d(e){let t=o.$getSelection();if(null==t)throw Error("Expected valid LexicalSelection");return o.$isRangeSelection(t)&&t.isCollapsed()||0===t.getNodes().length?"":a.$generateHtmlFromNodes(e,t)}function l(e){let t=o.$getSelection();if(null==t)throw Error("Expected valid LexicalSelection");return o.$isRangeSelection(t)&&t.isCollapsed()||0===t.getNodes().length?null:JSON.stringify(p(e,t))}function u(e,t,n){e.dispatchCommand(o.SELECTION_INSERT_CLIPBOARD_NODES_COMMAND,{nodes:t,selection:n})||n.insertNodes(t)}function f(e,t,n,a=[]){let r=null==t||n.isSelected(t),c=o.$isElementNode(n)&&n.excludeFromCopy("html");var d=n;if(null!==t){var l=i.$cloneWithProperties(n);d=l=o.$isTextNode(l)&&null!=t?i.$sliceSelectedTextNodeContent(t,l):l}let u=o.$isElementNode(d)?d.getChildren():[];var p=d;l=p.exportJSON();var m=p.constructor;for(l.type!==m.getType()&&s(58,m.name),o.$isElementNode(p)&&(Array.isArray(l.children)||s(59,m.name)),o.$isTextNode(d)&&(0<(d=d.__text).length?l.text=d:r=!1),d=0;d<u.length;d++)m=f(e,t,p=u[d],l.children),!r&&o.$isElementNode(n)&&m&&n.extractWithChild(p,t,"clone")&&(r=!0);if(r&&!c)a.push(l);else if(Array.isArray(l.children))for(e=0;e<l.children.length;e++)a.push(l.children[e]);return r}function p(e,t){let n=[],a=o.$getRoot().getChildren();for(let i=0;i<a.length;i++)f(e,t,a[i],n);return{namespace:e._config.namespace,nodes:n}}function m(e){let t=[];for(let n=0;n<e.length;n++){let a=o.$parseSerializedNode(e[n]);o.$isTextNode(a)&&i.$addNodeStyle(a),t.push(a)}return t}let _=null;function h(e,t){var n=c?(e._window||window).getSelection():null;if(!n)return!1;var a=n.anchorNode;if(n=n.focusNode,null!==a&&null!==n&&!o.isSelectionWithinEditor(e,a,n))return!1;if(t.preventDefault(),t=t.clipboardData,a=o.$getSelection(),null===t||null===a)return!1;n=d(e),e=l(e);let i="";return null!==a&&(i=a.getTextContent()),null!==n&&t.setData("text/html",n),null!==e&&t.setData("application/x-lexical-editor",e),t.setData("text/plain",i),!0}t.$generateJSONFromSelectedNodes=p,t.$generateNodesFromSerializedNodes=m,t.$getHtmlContent=d,t.$getLexicalContent=l,t.$insertDataTransferForPlainText=function(e,t){null!=(e=e.getData("text/plain")||e.getData("text/uri-list"))&&t.insertRawText(e)},t.$insertDataTransferForRichText=function(e,t,n){var i=e.getData("application/x-lexical-editor");if(i)try{let e=JSON.parse(i);if(e.namespace===n._config.namespace&&Array.isArray(e.nodes))return u(n,m(e.nodes),t)}catch(e){}if(i=e.getData("text/html"))try{var r=(new DOMParser).parseFromString(i,"text/html");return u(n,a.$generateNodesFromDOM(n,r),t)}catch(e){}if(null!=(e=e.getData("text/plain")||e.getData("text/uri-list")))if(o.$isRangeSelection(t))for(""===(e=e.split(/(\r?\n|\t)/))[e.length-1]&&e.pop(),n=0;n<e.length;n++)"\n"===(r=e[n])||"\r\n"===r?t.insertParagraph():"\t"===r?t.insertNodes([o.$createTabNode()]):t.insertText(r);else t.insertRawText(e)},t.$insertGeneratedNodes=u,t.copyToClipboard=async function(e,t){if(null!==_)return!1;if(null!==t)return new Promise(n=>{e.update(()=>{n(h(e,t))})});var n=e.getRootElement();let a=null==e._window?window.document:e._window.document,i=c?(e._window||window).getSelection():null;if(null===n||null===i)return!1;let s=a.createElement("span");return s.style.cssText="position: fixed; top: -1000px;",s.append(a.createTextNode("#")),n.append(s),(n=new Range).setStart(s,0),n.setEnd(s,1),i.removeAllRanges(),i.addRange(n),new Promise(t=>{let n=e.registerCommand(o.COPY_COMMAND,a=>(r.objectKlassEquals(a,ClipboardEvent)&&(n(),null!==_&&(window.clearTimeout(_),_=null),t(h(e,a))),!0),o.COMMAND_PRIORITY_CRITICAL);_=window.setTimeout(()=>{n(),_=null,t(!1)},50),a.execCommand("copy"),s.remove()})}}
,7690:(e,t,n)=>{"use strict";const a=n(8195);e.exports=a}
,8195:(e,t,n)=>{"use strict";var a=n(2475);t.registerDragonSupport=function(e){let t=window.location.origin,n=n=>{if(n.origin===t){var i=e.getRootElement();if(document.activeElement===i&&"string"==typeof(i=n.data)){try{var r=JSON.parse(i)}catch(e){return}if(r&&"nuanria_messaging"===r.protocol&&"request"===r.type&&(r=r.payload)&&"makeChanges"===r.functionId&&(r=r.args)){const[t,i,o,s,c]=r;e.update(()=>{const e=a.$getSelection();if(a.$isRangeSelection(e)){var r=e.anchor;let d=r.getNode(),l=0,u=0;a.$isTextNode(d)&&0<=t&&0<=i&&(l=t,u=t+i,e.setTextNodeRange(d,l,d,u)),l===u&&""===o||(e.insertRawText(o),d=r.getNode()),a.$isTextNode(d)&&(l=s,u=s+c,l=l>(r=d.getTextContentSize())?r:l,u=u>r?r:u,e.setTextNodeRange(d,l,d,u)),n.stopImmediatePropagation()}})}}}};return window.addEventListener("message",n,!0),()=>{window.removeEventListener("message",n,!0)}}}
,467:(e,t,n)=>{"use strict";const a=n(4848);e.exports=a}
,4848:(e,t,n)=>{"use strict";var a=n(8182),i=n(2475);t.createEmptyHistoryState=function(){return{current:null,redoStack:[],undoStack:[]}},t.registerHistory=function(e,t,n){let r=function(e,t){let n=Date.now(),a=0;return(r,o,s,c,d,l)=>{let u=Date.now();if(l.has("historic"))return a=0,n=u,2;let f=function(e,t,n,a,r){if(null===e||0===n.size&&0===a.size&&!r)return 0;var o=t._selection,s=e._selection;if(r)return 1;if(!(i.$isRangeSelection(o)&&i.$isRangeSelection(s)&&s.isCollapsed()&&o.isCollapsed()))return 0;r=t._nodeMap;let c=[];for(let e of n)void 0!==(n=r.get(e))&&c.push(n);for(let[e,t]of a)t&&(void 0===(a=r.get(e))||i.$isRootNode(a)||c.push(a));return 0===c.length?0:1<c.length?(t=(a=t._nodeMap).get(o.anchor.key),s=a.get(s.anchor.key),t&&s&&!e._nodeMap.has(t.__key)&&i.$isTextNode(t)&&1===t.__text.length&&1===o.anchor.offset?2:0):(t=c[0],e=e._nodeMap.get(t.__key),i.$isTextNode(e)&&i.$isTextNode(t)&&e.__mode===t.__mode?(e=e.__text)===(t=t.__text)?0:(o=o.anchor,s=s.anchor,o.key!==s.key||"text"!==o.type?0:(o=o.offset,s=s.offset,1==(e=t.length-e.length)&&s===o-1?2:-1===e&&s===o+1?3:-1===e&&s===o?4:0)):0)}(r,o,c,d,e.isComposing()),p=(()=>{var p=null===s||s.editor===e,m=l.has("history-push");if(!m&&p&&l.has("history-merge"))return 0;if(null===r)return 1;var _=o._selection;if(!(0<c.size||0<d.size))return null!==_?0:2;if(!1===m&&0!==f&&f===a&&u<n+t&&p)return 0;if(1===c.size){{m=Array.from(c)[0],p=r._nodeMap.get(m),m=o._nodeMap.get(m),_=r._selection;let e=o._selection,t=!1;i.$isRangeSelection(_)&&i.$isRangeSelection(e)&&(t="element"===_.anchor.type&&"element"===_.focus.type&&"text"===e.anchor.type&&"text"===e.focus.type),p=!(t||!i.$isTextNode(p)||!i.$isTextNode(m))&&p.__type===m.__type&&p.__text===m.__text&&p.__mode===m.__mode&&p.__detail===m.__detail&&p.__style===m.__style&&p.__format===m.__format&&p.__parent===m.__parent}if(p)return 0}return 1})();return n=u,a=f,p}}(e,n);n=({editorState:n,prevEditorState:a,dirtyLeaves:o,dirtyElements:s,tags:c})=>{const d=t.current,l=t.redoStack,u=t.undoStack,f=null===d?null:d.editorState;if(null===d||n!==f){if(1===(a=r(a,n,d,o,s,c)))0!==l.length&&(t.redoStack=[],e.dispatchCommand(i.CAN_REDO_COMMAND,!1)),null!==d&&(u.push({...d}),e.dispatchCommand(i.CAN_UNDO_COMMAND,!0));else if(2===a)return;t.current={editor:e,editorState:n}}};let o=a.mergeRegister(e.registerCommand(i.UNDO_COMMAND,()=>{let n=t.redoStack,a=t.undoStack;if(0!==a.length){let r=t.current,o=a.pop();null!==r&&(n.push(r),e.dispatchCommand(i.CAN_REDO_COMMAND,!0)),0===a.length&&e.dispatchCommand(i.CAN_UNDO_COMMAND,!1),t.current=o||null,o&&o.editor.setEditorState(o.editorState,{tag:"historic"})}return!0},i.COMMAND_PRIORITY_EDITOR),e.registerCommand(i.REDO_COMMAND,()=>{let n=t.redoStack;var a=t.undoStack;if(0!==n.length){let r=t.current;null!==r&&(a.push(r),e.dispatchCommand(i.CAN_UNDO_COMMAND,!0)),a=n.pop(),0===n.length&&e.dispatchCommand(i.CAN_REDO_COMMAND,!1),t.current=a||null,a&&a.editor.setEditorState(a.editorState,{tag:"historic"})}return!0},i.COMMAND_PRIORITY_EDITOR),e.registerCommand(i.CLEAR_EDITOR_COMMAND,()=>(t.undoStack=[],t.redoStack=[],t.current=null,!1),i.COMMAND_PRIORITY_EDITOR),e.registerCommand(i.CLEAR_HISTORY_COMMAND,()=>(t.undoStack=[],t.redoStack=[],t.current=null,e.dispatchCommand(i.CAN_REDO_COMMAND,!1),e.dispatchCommand(i.CAN_UNDO_COMMAND,!1),!0),i.COMMAND_PRIORITY_EDITOR),e.registerUpdateListener(n)),s=e.registerUpdateListener(n);return()=>{o(),s()}}}
,7380:(e,t,n)=>{"use strict";const a=n(8085);e.exports=a}
,8085:(e,t,n)=>{"use strict";var a=n(821),i=n(8182),r=n(2475);function o(e,t,n,s=null){let c=null==s||t.isSelected(s),d=r.$isElementNode(t)&&t.excludeFromCopy("html");var l=t;null!==s&&(l=a.$cloneWithProperties(t),l=r.$isTextNode(l)&&null!=s?a.$sliceSelectedTextNodeContent(s,l):l);let u=r.$isElementNode(l)?l.getChildren():[];var f=e._nodes.get(l.getType());f=f&&void 0!==f.exportDOM?f.exportDOM(e,l):l.exportDOM(e);let{element:p,after:m}=f;if(!p)return!1;f=document.createDocumentFragment();for(let n=0;n<u.length;n++){let a=u[n],i=o(e,a,f,s);!c&&r.$isElementNode(t)&&i&&t.extractWithChild(a,s,"html")&&(c=!0)}return c&&!d?(i.isHTMLElement(p)&&p.append(f),n.append(p),m&&(e=m.call(l,p))&&p.replaceWith(e)):n.append(f),c}let s=new Set(["STYLE","SCRIPT"]);function c(e,t,n=new Map,a){let i=[];if(s.has(e.nodeName))return i;let o=null;var d,{nodeName:l}=e,u=t._htmlConversions.get(l.toLowerCase());if(l=null,void 0!==u)for(d of u)null!==(u=d(e))&&(null===l||(l.priority||0)<(u.priority||0))&&(l=u);if(l=(d=null!==l?l.conversion:null)?d(e):null,d=null,null!==l){if(d=l.after,u=l.node,o=Array.isArray(u)?u[u.length-1]:u,null!==o){for(var[,f]of n)if(o=f(o,a),!o)break;o&&i.push(...Array.isArray(u)?u:[o])}null!=l.forChild&&n.set(e.nodeName,l.forChild)}for(e=e.childNodes,a=[],f=0;f<e.length;f++)a.push(...c(e[f],t,new Map(n),o));return null!=d&&(a=d(a)),null==o?i=i.concat(a):r.$isElementNode(o)&&o.append(...a),i}t.$generateHtmlFromNodes=function(e,t){if("undefined"==typeof document||"undefined"==typeof window)throw Error("To use $generateHtmlFromNodes in headless mode please initialize a headless browser implementation such as JSDom before calling this function.");let n=document.createElement("div"),a=r.$getRoot().getChildren();for(let i=0;i<a.length;i++)o(e,a[i],n,t);return n.innerHTML},t.$generateNodesFromDOM=function(e,t){t=t.body?t.body.childNodes:[];let n=[];for(let i=0;i<t.length;i++){var a=t[i];s.has(a.nodeName)||null!==(a=c(a,e))&&(n=n.concat(a))}return n}}
,2400:(e,t,n)=>{"use strict";const a=n(7569);e.exports=a}
,7569:(e,t,n)=>{"use strict";var a=n(6789),i=n(821),r=n(8182),o=n(2475);let s="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,c=s&&"documentMode"in document?document.documentMode:null;s&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),s&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent);let d=!(!s||!("InputEvent"in window)||c)&&"getTargetRanges"in new window.InputEvent("input"),l=s&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),u=s&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream;s&&/Android/.test(navigator.userAgent);let f=s&&/^(?=.*Chrome).*/i.test(navigator.userAgent),p=s&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!f;function m(e,t){t.update(()=>{if(null!==e){let n=e instanceof KeyboardEvent?null:e.clipboardData,i=o.$getSelection();if(null!==i&&null!=n){e.preventDefault();let r=a.$getHtmlContent(t);null!==r&&n.setData("text/html",r),n.setData("text/plain",i.getTextContent())}}})}t.registerPlainText=function(e){return r.mergeRegister(e.registerCommand(o.DELETE_CHARACTER_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(t.deleteCharacter(e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.DELETE_WORD_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(t.deleteWord(e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.DELETE_LINE_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(t.deleteLine(e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.CONTROLLED_TEXT_INSERTION_COMMAND,e=>{const t=o.$getSelection();if(!o.$isRangeSelection(t))return!1;if("string"==typeof e)t.insertText(e);else{const n=e.dataTransfer;null!=n?a.$insertDataTransferForPlainText(n,t):(e=e.data)&&t.insertText(e)}return!0},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.REMOVE_TEXT_COMMAND,()=>{const e=o.$getSelection();return!!o.$isRangeSelection(e)&&(e.removeText(),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.INSERT_LINE_BREAK_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(t.insertLineBreak(e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.INSERT_PARAGRAPH_COMMAND,()=>{const e=o.$getSelection();return!!o.$isRangeSelection(e)&&(e.insertLineBreak(),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.KEY_ARROW_LEFT_COMMAND,e=>{const t=o.$getSelection();if(!o.$isRangeSelection(t))return!1;const n=e.shiftKey;return!!i.$shouldOverrideDefaultCharacterSelection(t,!0)&&(e.preventDefault(),i.$moveCharacter(t,n,!0),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.KEY_ARROW_RIGHT_COMMAND,e=>{const t=o.$getSelection();if(!o.$isRangeSelection(t))return!1;const n=e.shiftKey;return!!i.$shouldOverrideDefaultCharacterSelection(t,!1)&&(e.preventDefault(),i.$moveCharacter(t,n,!1),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.KEY_BACKSPACE_COMMAND,t=>{const n=o.$getSelection();return!!o.$isRangeSelection(n)&&(t.preventDefault(),e.dispatchCommand(o.DELETE_CHARACTER_COMMAND,!0))},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.KEY_DELETE_COMMAND,t=>{const n=o.$getSelection();return!!o.$isRangeSelection(n)&&(t.preventDefault(),e.dispatchCommand(o.DELETE_CHARACTER_COMMAND,!1))},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.KEY_ENTER_COMMAND,t=>{const n=o.$getSelection();if(!o.$isRangeSelection(n))return!1;if(null!==t){if((u||l||p)&&d)return!1;t.preventDefault()}return e.dispatchCommand(o.INSERT_LINE_BREAK_COMMAND,!1)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.SELECT_ALL_COMMAND,()=>(o.$selectAll(),!0),o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.COPY_COMMAND,t=>{const n=o.$getSelection();return!!o.$isRangeSelection(n)&&(m(t,e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.CUT_COMMAND,t=>{const n=o.$getSelection();return!!o.$isRangeSelection(n)&&(function(e,t){m(e,t),t.update(()=>{let e=o.$getSelection();o.$isRangeSelection(e)&&e.removeText()})}(t,e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.PASTE_COMMAND,t=>{const n=o.$getSelection();return!!o.$isRangeSelection(n)&&(function(e,t){e.preventDefault(),t.update(()=>{let t=o.$getSelection(),{clipboardData:n}=e;null!=n&&o.$isRangeSelection(t)&&a.$insertDataTransferForPlainText(n,t)},{tag:"paste"})}(t,e),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.DROP_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(e.preventDefault(),!0)},o.COMMAND_PRIORITY_EDITOR),e.registerCommand(o.DRAGSTART_COMMAND,e=>{const t=o.$getSelection();return!!o.$isRangeSelection(t)&&(e.preventDefault(),!0)},o.COMMAND_PRIORITY_EDITOR))}}
,7746:(e,t,n)=>{"use strict";const a=n(923);e.exports=a}
,923:(e,t,n)=>{"use strict";var a=n(3679),i=n(2475),r=n(5959);let o="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement;var s=o?r.useLayoutEffect:r.useEffect;let c={tag:"history-merge"};t.LexicalComposer=function({initialConfig:e,children:t}){let n=r.useMemo(()=>{const{theme:t,namespace:n,editor__DEPRECATED:r,nodes:s,onError:d,editorState:l,html:u}=e,f=a.createLexicalComposerContext(null,t);let p=r||null;if(null===p){const a=i.createEditor({editable:e.editable,html:u,namespace:n,nodes:s,onError:e=>d(e,a),theme:t});!function(e,t){if(null!==t)if(void 0===t)e.update(()=>{var t=i.$getRoot();if(t.isEmpty()){let n=i.$createParagraphNode();t.append(n),t=o?document.activeElement:null,(null!==i.$getSelection()||null!==t&&t===e.getRootElement())&&n.select()}},c);else if(null!==t)switch(typeof t){case"string":let n=e.parseEditorState(t);e.setEditorState(n,c);break;case"object":e.setEditorState(t,c);break;case"function":e.update(()=>{i.$getRoot().isEmpty()&&t(e)},c)}}(a,l),p=a}return[p,f]},[]);return s(()=>{let t=e.editable,[a]=n;a.setEditable(void 0===t||t)},[]),r.createElement(a.LexicalComposerContext.Provider,{value:n},t)}}
,3679:(e,t,n)=>{"use strict";const a=n(28);e.exports=a}
,28:(e,t,n)=>{"use strict";var a=n(5959);let i=a.createContext(null);t.LexicalComposerContext=i,t.createLexicalComposerContext=function(e,t){let n=null;return null!=e&&(n=e[1]),{getTheme:function(){return null!=t?t:null!=n?n.getTheme():null}}},t.useLexicalComposerContext=function(){let e=a.useContext(i);return null==e&&function(e){let t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(8),e}}
,8407:(e,t,n)=>{"use strict";const a=n(4052);e.exports=a}
,4052:(e,t,n)=>{"use strict";var a=n(3679);t.EditorRefPlugin=function({editorRef:e}){let[t]=a.useLexicalComposerContext();return"function"==typeof e?e(t):"object"==typeof e&&(e.current=t),null}}
,226:(e,t,n)=>{"use strict";const a=n(1867);e.exports=a}
,1867:(e,t,n)=>{"use strict";var a=n(5959);function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}var r={error:null},o=function(e){function t(){for(var t,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))||this).state=r,t.resetErrorBoundary=function(){for(var e,n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];null==t.props.onReset||(e=t.props).onReset.apply(e,a),t.reset()},t}!function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,i(e,t)}(t,e),t.getDerivedStateFromError=function(e){return{error:e}};var n=t.prototype;return n.reset=function(){this.setState(r)},n.componentDidCatch=function(e,t){var n,a;null==(n=(a=this.props).onError)||n.call(a,e,t)},n.componentDidUpdate=function(e,t){var n,a,i=this.props.resetKeys;null!==this.state.error&&null!==t.error&&function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=[]),e.length!==t.length||e.some(function(e,n){return!Object.is(e,t[n])})}(e.resetKeys,i)&&(null==(n=(a=this.props).onResetKeysChange)||n.call(a,e.resetKeys,i),this.reset())},n.render=function(){var e=this.state.error,t=this.props,n=t.fallbackRender,i=t.FallbackComponent;if(t=t.fallback,null!==e){if(e={error:e,resetErrorBoundary:this.resetErrorBoundary},a.isValidElement(t))return t;if("function"==typeof n)return n(e);if(i)return a.createElement(i,e);throw Error("react-error-boundary requires either a fallback, fallbackRender, or FallbackComponent prop")}return this.props.children},t}(a.Component);e.exports=function({children:e,onError:t}){return a.createElement(o,{fallback:a.createElement("div",{style:{border:"1px solid #f00",color:"#f00",padding:"8px"}},"An error was thrown."),onError:t},e)}}
,9161:(e,t,n)=>{"use strict";const a=n(9102);e.exports=a}
,9102:(e,t,n)=>{"use strict";var a=n(3679),i=n(467),r=n(5959);t.createEmptyHistoryState=i.createEmptyHistoryState,t.HistoryPlugin=function({externalHistoryState:e}){let[t]=a.useLexicalComposerContext();return function(e,t,n=1e3){let a=r.useMemo(()=>t||i.createEmptyHistoryState(),[t]);r.useEffect(()=>i.registerHistory(e,a,n),[n,e,a])}(t,e),null}}
,8262:(e,t,n)=>{"use strict";const a=n(2879);e.exports=a}
,2879:(e,t,n)=>{"use strict";var a=n(3679),i=n(4035),r=n(5959),o=n(82),s=n(8182),c=n(8398),d=n(7690),l=n(2400),u="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?r.useLayoutEffect:r.useEffect;function f(e){return e.getEditorState().read(o.$canShowPlaceholderCurry(e.isComposing()))}function p({content:e}){var[t]=a.useLexicalComposerContext();t=function(e){let[t,n]=r.useState(()=>f(e));return u(()=>{function t(){let t=f(e);n(t)}return t(),s.mergeRegister(e.registerUpdateListener(()=>{t()}),e.registerEditableListener(()=>{t()}))},[e]),t}(t);let n=i();return t?"function"==typeof e?e(n):e:null}t.PlainTextPlugin=function({contentEditable:e,placeholder:t,ErrorBoundary:n}){let[i]=a.useLexicalComposerContext();return n=function(e,t){let[n,a]=r.useState(()=>e.getDecorators());return u(()=>e.registerDecoratorListener(e=>{c.flushSync(()=>{a(e)})}),[e]),r.useEffect(()=>{a(e.getDecorators())},[e]),r.useMemo(()=>{let a=[],i=Object.keys(n);for(let o=0;o<i.length;o++){let s=i[o],d=r.createElement(t,{onError:t=>e._onError(t)},r.createElement(r.Suspense,{fallback:null},n[s])),l=e.getElementByKey(s);null!==l&&a.push(c.createPortal(d,l,s))}return a},[t,n,e])}(i,n),function(e){u(()=>s.mergeRegister(l.registerPlainText(e),d.registerDragonSupport(e)),[e])}(i),r.createElement(r.Fragment,null,e,r.createElement(p,{content:t}),n)}}
,4035:(e,t,n)=>{"use strict";const a=n(9312);e.exports=a}
,9312:(e,t,n)=>{"use strict";var a=n(3679),i=n(5959),r="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?i.useLayoutEffect:i.useEffect;function o(e){return{initialValueFn:()=>e.isEditable(),subscribe:t=>e.registerEditableListener(t)}}e.exports=function(){return function(e){let[t]=a.useLexicalComposerContext(),n=i.useMemo(()=>e(t),[t,e]),o=i.useRef(n.initialValueFn()),[s,c]=i.useState(o.current);return r(()=>{let{initialValueFn:e,subscribe:t}=n,a=e();return o.current!==a&&(o.current=a,c(a)),t(e=>{o.current=e,c(e)})},[n,e]),s}(o)}}
,821:(e,t,n)=>{"use strict";const a=n(9754);e.exports=a}
,9754:(e,t,n)=>{"use strict";var a=n(2475);let i=new Map;function r(e){for(;null!=e;){if(e.nodeType===Node.TEXT_NODE)return e;e=e.firstChild}return null}function o(e){let t=e.parentNode;if(null==t)throw Error("Should never happen");return[t,Array.from(t.childNodes).indexOf(e)]}function s(e){let t={};e=e.split(";");for(let n of e)if(""!==n){let[e,a]=n.split(/:([^]+)/);e&&a&&(t[e.trim()]=a.trim())}return t}function c(e){let t=i.get(e);return void 0===t&&(t=s(e),i.set(e,t)),t}function d(e,t){var n=c("getStyle"in e?e.getStyle():e.style);n=function(e){let t="";for(let n in e)n&&(t+=`${n}: ${e[n]};`);return t}(t=Object.entries(t).reduce((e,[t,n])=>(null===n?delete e[t]:e[t]=n,e),{...n})),e.setStyle(n),i.set(n,t)}function l(e){for(;null!==e&&!a.$isRootOrShadowRoot(e);){let t=e.getLatest(),n=e.getParent();0===t.getChildrenSize()&&e.remove(!0),e=n}}function u(e,t,n,i,r=null){if(0!==t.length){var o=t[0],s=new Map,c=[];(o=a.$isElementNode(o)?o:o.getParentOrThrow()).isInline()&&(o=o.getParentOrThrow());for(var d=!1;null!==o;){var u=o.getPreviousSibling();if(null!==u){o=u,d=!0;break}if(o=o.getParentOrThrow(),a.$isRootOrShadowRoot(o))break}u=new Set;for(var f=0;f<n;f++){var p=t[f];a.$isElementNode(p)&&0===p.getChildrenSize()&&u.add(p.getKey())}var m=new Set;for(f=0;f<n;f++){var _=(p=t[f]).getParent();if(null!==_&&_.isInline()&&(_=_.getParent()),null!==_&&a.$isLeafNode(p)&&!m.has(p.getKey())){if(p=_.getKey(),void 0===s.get(p)){let e=i();e.setFormat(_.getFormatType()),e.setIndent(_.getIndent()),c.push(e),s.set(p,e),_.getChildren().forEach(t=>{e.append(t),m.add(t.getKey()),a.$isElementNode(t)&&t.getChildrenKeys().forEach(e=>m.add(e))}),l(_)}}else if(u.has(p.getKey())){if(!a.$isElementNode(p))throw Error("Expected node in emptyElements to be an ElementNode");(_=i()).setFormat(p.getFormatType()),_.setIndent(p.getIndent()),c.push(_),p.remove(!0)}}if(null!==r)for(t=0;t<c.length;t++)r.append(c[t]);if(t=null,a.$isRootOrShadowRoot(o))if(d)if(null!==r)o.insertAfter(r);else for(r=c.length-1;0<=r;r--)o.insertAfter(c[r]);else if(d=o.getFirstChild(),a.$isElementNode(d)&&(o=d),null===d)if(r)o.append(r);else for(r=0;r<c.length;r++)d=c[r],o.append(d),t=d;else if(null!==r)d.insertBefore(r);else for(o=0;o<c.length;o++)r=c[o],d.insertBefore(r),t=r;else if(r)o.insertAfter(r);else for(r=c.length-1;0<=r;r--)d=c[r],o.insertAfter(d),t=d;c=a.$getPreviousSelection(),a.$isRangeSelection(c)&&c.anchor.getNode().isAttached()&&c.focus.getNode().isAttached()?a.$setSelection(c.clone()):null!==t?t.selectEnd():e.dirty=!0}}function f(e,t,n,a){e.modify(t?"extend":"move",n,a)}function p(e){return e=e.anchor.getNode(),"rtl"===(a.$isRootNode(e)?e:e.getParentOrThrow()).getDirection()}function m(e){if(a.$isDecoratorNode(e)&&!e.isInline())return!0;if(!a.$isElementNode(e)||a.$isRootOrShadowRoot(e))return!1;var t=e.getFirstChild();return t=null===t||a.$isLineBreakNode(t)||a.$isTextNode(t)||t.isInline(),!e.isInline()&&!1!==e.canBeEmpty()&&t}t.$addNodeStyle=function(e){let t=s(e=e.getStyle());i.set(e,t)},t.$cloneWithProperties=function(e){let t=e.constructor.clone(e);return t.__parent=e.__parent,t.__next=e.__next,t.__prev=e.__prev,a.$isElementNode(e)&&a.$isElementNode(t)?(t.__first=e.__first,t.__last=e.__last,t.__size=e.__size,t.__format=e.__format,t.__indent=e.__indent,t.__dir=e.__dir,t):(a.$isTextNode(e)&&a.$isTextNode(t)&&(t.__format=e.__format,t.__style=e.__style,t.__mode=e.__mode,t.__detail=e.__detail),t)},t.$getSelectionStyleValueForProperty=function(e,t,n=""){let i=null,r=e.getNodes();var o=e.anchor,s=e.focus,d=e.isBackward();let l=d?s.offset:o.offset;if(o=d?s.getNode():o.getNode(),e.isCollapsed()&&""!==e.style&&null!==(e=c(e.style))&&t in e)return e[t];for(e=0;e<r.length;e++){var u=r[e];if((0===e||0!==l||!u.is(o))&&a.$isTextNode(u))if(s=t,d=n,s=null!==(u=c(u=u.getStyle()))&&u[s]||d,null===i)i=s;else if(i!==s){i="";break}}return null===i?n:i},t.$isAtNodeEnd=function(e){if("text"===e.type)return e.offset===e.getNode().getTextContentSize();let t=e.getNode();if(!a.$isElementNode(t))throw Error("isAtNodeEnd: node must be a TextNode or ElementNode");return e.offset===t.getChildrenSize()},t.$isParentElementRTL=p,t.$moveCaretSelection=f,t.$moveCharacter=function(e,t,n){let a=p(e);f(e,t,n?!a:a,"character")},t.$patchStyleText=function e(t,n){var i=t.getNodes(),r=i.length;if(a.$isRangeSelection(t)){--r;var o=i[0],s=i[r];if(t.isCollapsed()&&a.$isRangeSelection(t))d(t,n);else{var c=t.anchor,l=t.focus,u=o.getTextContent().length,f=l.offset,p=c.offset,m=c.isBefore(l),_=m?p:f;t=m?f:p;var h=m?c.type:l.type,b=m?l.type:c.type;if(l=m?l.key:c.key,a.$isTextNode(o)&&_===u&&(m=o.getNextSibling(),a.$isTextNode(m)&&(_=p=0,o=m)),1===i.length)a.$isTextNode(o)&&(_="element"===h?0:p>f?f:p)!==(t="element"===b?u:p>f?p:f)&&(0===_&&t===u?(d(o,n),o.select(_,t)):(i=o.splitText(_,t),d(i=0===_?i[0]:i[1],n),i.select(0,t-_)));else for(a.$isTextNode(o)&&_<o.getTextContentSize()&&(0!==_&&(o=o.splitText(_)[1],_=0,c.set(o.getKey(),_,"text")),d(o,n)),a.$isTextNode(s)&&(_=s.getTextContent().length,s.__key!==l&&0!==t&&(t=_),t!==_&&([s]=s.splitText(t)),0!==t&&d(s,n)),t=1;t<r;t++)c=(_=i[t]).getKey(),a.$isTextNode(_)&&c!==o.getKey()&&c!==s.getKey()&&!_.isToken()&&d(_,n)}}else{for(s=(o=a.$createRangeSelection()).anchor,_=o.focus,c=0;c<r;c++)u=i[c],a.DEPRECATED_$isGridCellNode(u)&&(s.set(u.getKey(),0,"element"),_.set(u.getKey(),u.getChildrenSize(),"element"),e(a.$normalizeSelection__EXPERIMENTAL(o),n));a.$setSelection(t)}},t.$selectAll=function(e){let t=e.anchor;e=e.focus;var n=t.getNode().getTopLevelElementOrThrow().getParentOrThrow();let i=n.getFirstDescendant();n=n.getLastDescendant();let r="element",o="element",s=0;a.$isTextNode(i)?r="text":a.$isElementNode(i)||null===i||(i=i.getParentOrThrow()),a.$isTextNode(n)?(o="text",s=n.getTextContentSize()):a.$isElementNode(n)||null===n||(n=n.getParentOrThrow()),i&&n&&(t.set(i.getKey(),0,r),e.set(n.getKey(),s,o))},t.$setBlocksType=function(e,t){if("root"===e.anchor.key){t=t();var n=a.$getRoot();(e=n.getFirstChild())?e.replace(t,!0):n.append(t)}else{for(n=e.getNodes(),e=e.anchor.getNode();null!==e&&null!==e.getParent()&&!m(e);)e=e.getParentOrThrow();for((e=m(e)?e:null)&&-1===n.indexOf(e)&&n.push(e),e=0;e<n.length;e++){let i=n[e];if(!m(i))continue;if(!a.$isElementNode(i))throw Error("Expected block node to be an ElementNode");let r=t();r.setFormat(i.getFormatType()),r.setIndent(i.getIndent()),i.replace(r,!0)}}},t.$shouldOverrideDefaultCharacterSelection=function(e,t){return e=a.$getAdjacentNode(e.focus,t),a.$isDecoratorNode(e)&&!e.isIsolated()||a.$isElementNode(e)&&!e.isInline()&&!e.canBeEmpty()},t.$sliceSelectedTextNodeContent=function(e,t){if(t.isSelected(e)&&!t.isSegmented()&&!t.isToken()&&a.$INTERNAL_isPointSelection(e)){var n=e.anchor.getNode(),i=e.focus.getNode(),r=t.is(n),o=t.is(i);if(r||o){r=e.isBackward();let a,[s,c]=e.getCharacterOffsets();e=n.is(i),o=t.is(r?i:n),i=t.is(r?n:i),n=0,e?(n=s>c?c:s,a=s>c?s:c):o?(n=r?c:s,a=void 0):i&&(n=0,a=r=r?s:c),t.__text=t.__text.slice(n,a)}}return t},t.$wrapNodes=function(e,t,n=null){var i=e.getNodes();let r=i.length;var o=e.anchor;if(0===r||1===r&&"element"===o.type&&0===o.getNode().getChildrenSize()){i=(e="text"===o.type?o.getNode().getParentOrThrow():o.getNode()).getChildren();let a=t();a.setFormat(e.getFormatType()),a.setIndent(e.getIndent()),i.forEach(e=>a.append(e)),n&&(a=n.append(a)),e.replace(a)}else{o=null;var s=[];for(let c=0;c<r;c++){let r=i[c];a.$isRootOrShadowRoot(r)?(u(e,s,s.length,t,n),s=[],o=r):null===o||null!==o&&a.$hasAncestor(r,o)?s.push(r):(u(e,s,s.length,t,n),s=[r])}u(e,s,s.length,t,n)}},t.createDOMRange=function(e,t,n,i,s){let c=t.getKey(),d=i.getKey(),l=document.createRange(),u=e.getElementByKey(c);if(e=e.getElementByKey(d),a.$isTextNode(t)&&(u=r(u)),a.$isTextNode(i)&&(e=r(e)),void 0===t||void 0===i||null===u||null===e)return null;"BR"===u.nodeName&&([u,n]=o(u)),"BR"===e.nodeName&&([e,s]=o(e)),t=u.firstChild,u===e&&null!=t&&"BR"===t.nodeName&&0===n&&0===s&&(s=1);try{l.setStart(u,n),l.setEnd(e,s)}catch(e){return null}return!l.collapsed||n===s&&c===d||(l.setStart(e,s),l.setEnd(u,n)),l},t.createRectsFromDOMRange=function(e,t){var n=e.getRootElement();if(null===n)return[];e=n.getBoundingClientRect(),n=getComputedStyle(n),n=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight);let a,i=(t=Array.from(t.getClientRects())).length;t.sort((e,t)=>{let n=e.top-t.top;return 3>=Math.abs(n)?e.left-t.left:n});for(let r=0;r<i;r++){let o=t[r],s=o.width+n===e.width;a&&a.top<=o.top&&a.top+a.height>o.top&&a.left+a.width>o.left||s?(t.splice(r--,1),i--):a=o}return t},t.getStyleObjectFromCSS=c,t.trimTextContentFromAnchor=function(e,t,n){let i=t.getNode();if(a.$isElementNode(i)){var r=i.getDescendantByIndex(t.offset);null!==r&&(i=r)}for(;0<n&&null!==i;){a.$isElementNode(i)&&null!==(r=i.getLastDescendant())&&(i=r);var o=i.getPreviousSibling(),s=0;if(null===o){for(var c=(r=i.getParentOrThrow()).getPreviousSibling();null===c;){if(null===(r=r.getParent())){o=null;break}c=r.getPreviousSibling()}null!==r&&(s=r.isInline()?0:2,o=c)}if(""===(c=i.getTextContent())&&a.$isElementNode(i)&&!i.isInline()&&(c="\n\n"),r=c.length,!a.$isTextNode(i)||n>=r)c=i.getParent(),i.remove(),null==c||0!==c.getChildrenSize()||a.$isRootNode(c)||c.remove(),n-=r+s,i=o;else{let d=i.getKey();s=e.getEditorState().read(()=>{const e=a.$getNodeByKey(d);return a.$isTextNode(e)&&e.isSimpleText()?e.getTextContent():null}),o=r-n;let l=c.slice(0,o);null!==s&&s!==c?(n=a.$getPreviousSelection(),r=i,i.isSimpleText()?i.setTextContent(s):(r=a.$createTextNode(s),i.replace(r)),a.$isRangeSelection(n)&&n.isCollapsed()&&(n=n.anchor.offset,r.select(n,n))):i.isSimpleText()?(s=t.key===d,(c=t.offset)<n&&(c=r),n=s?c-n:0,r=s?c:o,s&&0===n?([n]=i.splitText(n,r),n.remove()):([,n]=i.splitText(n,r),n.remove())):(n=a.$createTextNode(l),i.replace(n)),n=0}}}}
,82:(e,t,n)=>{"use strict";const a=n(5083);e.exports=a}
,5083:(e,t,n)=>{"use strict";var a=n(2475);function i(e,t=!0){return!e&&(e=r(),t&&(e=e.trim()),""===e)}function r(){return a.$getRoot().getTextContent()}function o(e){if(!i(e,!1))return!1;let t=(e=a.$getRoot().getChildren()).length;if(1<t)return!1;for(let i=0;i<t;i++){var n=e[i];if(a.$isDecoratorNode(n))return!1;if(a.$isElementNode(n)){if(!a.$isParagraphNode(n)||0!==n.__indent)return!1;let e=(n=n.getChildren()).length;for(let t=0;t<e;t++)if(!a.$isTextNode(n[i]))return!1}}return!0}t.$canShowPlaceholder=o,t.$canShowPlaceholderCurry=function(e){return()=>o(e)},t.$findTextIntersectionFromCharacters=function(e,t){var n=e.getFirstChild();e=0;e:for(;null!==n;){if(a.$isElementNode(n)){var i=n.getFirstChild();if(null!==i){n=i;continue}}else if(a.$isTextNode(n)){if(e+(i=n.getTextContentSize())>t)return{node:n,offset:t-e};e+=i}if(null===(i=n.getNextSibling())){for(n=n.getParent();null!==n;){if(null!==(i=n.getNextSibling())){n=i;continue e}n=n.getParent()}break}n=i}return null},t.$isRootTextContentEmpty=i,t.$isRootTextContentEmptyCurry=function(e,t){return()=>i(e,t)},t.$rootTextContent=r,t.registerLexicalTextEntity=function(e,t,n,i){let r=e=>{const t=a.$createTextNode(e.getTextContent());t.setFormat(e.getFormat()),e.replace(t)};return[e.registerNodeTransform(a.TextNode,e=>{if(e.isSimpleText()){var o=e.getPreviousSibling(),s=e.getTextContent(),c=e;if(a.$isTextNode(o)){var d=o.getTextContent(),l=t(d+s);if(o instanceof n){if(null===l||0!==o.getLatest().__mode)return void r(o);if(0<(l=l.end-d.length))return c=d+(c=s.slice(0,l)),o.select(),o.setTextContent(c),void(l===s.length?e.remove():(o=s.slice(l),e.setTextContent(o)))}else if(null===l||l.start<d.length)return}for(;;){if(s=l=null===(e=t(s))?"":s.slice(e.end),""===l){if(d=c.getNextSibling(),a.$isTextNode(d)){if(l=c.getTextContent()+d.getTextContent(),null===(l=t(l))){d instanceof n?r(d):d.markDirty();break}if(0!==l.start)break}}else if(null!==(d=t(l))&&0===d.start)break;if(null===e)break;if(0===e.start&&a.$isTextNode(o)&&o.isTextEntity())continue;let u;if(0===e.start?[u,c]=c.splitText(e.end):[,u,c]=c.splitText(e.start,e.end),(e=i(u)).setFormat(u.getFormat()),u.replace(e),null==c)break}}}),e=e.registerNodeTransform(n,e=>{var i=e.getTextContent();const o=t(i);null===o||0!==o.start?r(e):i.length>o.end?e.splitText(o.end):(i=e.getPreviousSibling(),a.$isTextNode(i)&&i.isTextEntity()&&(r(i),r(e)),i=e.getNextSibling(),a.$isTextNode(i)&&i.isTextEntity()&&(r(i),e instanceof n&&r(e)))})]}}
,8182:(e,t,n)=>{"use strict";const a=n(8316);e.exports=a}
,8316:(e,t,n)=>{"use strict";var a=n(821),i=n(2475);function r(...e){return()=>{e.forEach(e=>e())}}let o={attributes:!0,characterData:!0,childList:!0,subtree:!0};function s(e,t,n){function i(){if(null===s)throw Error("Unexpected null rootDOMNode");if(null===c)throw Error("Unexpected null parentDOMNode");let{left:i,top:r}=s.getBoundingClientRect();var o=c;let d=a.createRectsFromDOMRange(e,t);u.isConnected||o.append(u),o=!1;for(let e=0;e<d.length;e++){var f=d[e];let t=l[e]||document.createElement("div"),n=t.style;"absolute"!==n.position&&(n.position="absolute",o=!0);var p=f.left-i+"px";n.left!==p&&(n.left=p,o=!0),p=f.top-r+"px",n.top!==p&&(t.style.top=p,o=!0),p=`${f.width}px`,n.width!==p&&(t.style.width=p,o=!0),f=`${f.height}px`,n.height!==f&&(t.style.height=f,o=!0),t.parentNode!==u&&(u.append(t),o=!0),l[e]=t}for(;l.length>d.length;)l.pop();o&&n(l)}function r(){s=c=null,null!==d&&d.disconnect(),d=null,u.remove();for(let e of l)e.remove();l=[]}let s=null,c=null,d=null,l=[],u=document.createElement("div"),f=e.registerRootListener(function t(){let n=e.getRootElement();if(null===n)return r();let a=n.parentElement;if(!(a instanceof HTMLElement))return r();r(),s=n,c=a,d=new MutationObserver(n=>{let a=e.getRootElement(),r=a&&a.parentElement;if(a!==s||r!==c)return t();for(let e of n)if(!u.contains(e.target))return i()}),d.observe(a,o),i()});return()=>{f(),r()}}function c(e,t){for(let n of t)if(e.type.startsWith(n))return!0;return!1}let d=(e,t)=>{for(;e!==i.$getRoot()&&null!=e;){if(t(e))return e;e=e.getParent()}return null};t.$splitNode=i.$splitNode,t.isHTMLAnchorElement=i.isHTMLAnchorElement,t.isHTMLElement=i.isHTMLElement,t.$dfs=function(e,t){let n=[];e=(e||i.$getRoot()).getLatest(),t=t||(i.$isElementNode(e)?e.getLastDescendant():e);for(var a=e,r=0;null!==(a=a.getParent());)r++;for(a=r;null!==e&&!e.is(t);)if(n.push({depth:a,node:e}),i.$isElementNode(e)&&0<e.getChildrenSize())e=e.getFirstChild(),a++;else for(r=null;null===r&&null!==e;)null===(r=e.getNextSibling())?(e=e.getParent(),a--):e=r;return null!==e&&e.is(t)&&n.push({depth:a,node:e}),n},t.$filter=function(e,t){let n=[];for(let a=0;a<e.length;a++){let i=t(e[a]);null!==i&&n.push(i)}return n},t.$findMatchingParent=d,t.$getNearestBlockElementAncestorOrThrow=function(e){let t=d(e,e=>i.$isElementNode(e)&&!e.isInline());return i.$isElementNode(t)||function(e){let t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(4,e.__key),t},t.$getNearestNodeOfType=function(e,t){for(;null!=e;){if(e instanceof t)return e;e=e.getParent()}return null},t.$insertFirst=function(e,t){let n=e.getFirstChild();null!==n?n.insertBefore(t):e.append(t)},t.$insertNodeToNearestRoot=function(e){var t=i.$getSelection()||i.$getPreviousSelection();if(i.$isRangeSelection(t)){var{focus:n}=t;if(t=n.getNode(),n=n.offset,i.$isRootOrShadowRoot(t))null==(n=t.getChildAtIndex(n))?t.append(e):n.insertBefore(e),e.selectNext();else{let a,r;i.$isTextNode(t)?(a=t.getParentOrThrow(),r=t.getIndexWithinParent(),0<n&&(r+=1,t.splitText(n))):(a=t,r=n),[,t]=i.$splitNode(a,r),t.insertBefore(e),t.selectStart()}}else null!=t?(t=t.getNodes())[t.length-1].getTopLevelElementOrThrow().insertAfter(e):i.$getRoot().append(e),t=i.$createParagraphNode(),e.insertAfter(t),t.select();return e.getLatest()},t.$restoreEditorState=function(e,t){let n=new Map,r=e._pendingEditorState;for(let[e,r]of t._nodeMap){let t=a.$cloneWithProperties(r);if(i.$isTextNode(t)){if(!i.$isTextNode(r))throw Error("Expected node be a TextNode");t.__text=r.__text}n.set(e,t)}r&&(r._nodeMap=n),e._dirtyType=2,e=t._selection,i.$setSelection(null===e?null:e.clone())},t.$wrapNodeInElement=function(e,t){return t=t(),e.replace(t),t.append(e),t},t.addClassNamesToElement=function(e,...t){t.forEach(t=>{"string"==typeof t&&(t=t.split(" ").filter(e=>""!==e),e.classList.add(...t))})},t.isMimeType=c,t.markSelection=function(e,t){function n(n){n.read(()=>{var n=i.$getSelection();if(i.$isRangeSelection(n)){var{anchor:r,focus:u}=n,f=(n=r.getNode()).getKey(),p=r.offset,m=u.getNode(),_=m.getKey(),h=u.offset,b=e.getElementByKey(f),g=e.getElementByKey(_);if(f=null===a||null===b||p!==o||f!==a.getKey()||n!==a&&(!(a instanceof i.TextNode)||n.updateDOM(a,b,e._config)),_=null===c||null===g||h!==d||_!==c.getKey()||m!==c&&(!(c instanceof i.TextNode)||m.updateDOM(c,g,e._config)),f||_){b=e.getElementByKey(r.getNode().getKey());var v=e.getElementByKey(u.getNode().getKey());if(null!==b&&null!==v&&"SPAN"===b.tagName&&"SPAN"===v.tagName){if(_=document.createRange(),u.isBefore(r)?(f=v,g=u.offset,v=b,b=r.offset):(f=b,g=r.offset,b=u.offset),null===(f=f.firstChild))throw Error("Expected text node to be first child of span");if(null===(v=v.firstChild))throw Error("Expected text node to be first child of span");_.setStart(f,g),_.setEnd(v,b),l(),l=s(e,_,e=>{for(let t of e){let e=t.style;"Highlight"!==e.background&&(e.background="Highlight"),"HighlightText"!==e.color&&(e.color="HighlightText"),"-1"!==e.zIndex&&(e.zIndex="-1"),"none"!==e.pointerEvents&&(e.pointerEvents="none"),"-1.5px"!==e.marginTop&&(e.marginTop="-1.5px"),"4px"!==e.paddingTop&&(e.paddingTop="4px"),"0px"!==e.paddingBottom&&(e.paddingBottom="0px")}void 0!==t&&t(e)})}}a=n,o=p,c=m,d=h}else d=c=o=a=null,l(),l=()=>{}})}let a=null,o=null,c=null,d=null,l=()=>{};return n(e.getEditorState()),r(e.registerUpdateListener(({editorState:e})=>n(e)),l,()=>{l()})},t.mediaFileReader=function(e,t){let n=e[Symbol.iterator]();return new Promise((e,a)=>{let i=[],r=()=>{const{done:o,value:s}=n.next();if(o)return e(i);const d=new FileReader;d.addEventListener("error",a),d.addEventListener("load",()=>{const e=d.result;"string"==typeof e&&i.push({file:s,result:e}),r()}),c(s,t)?d.readAsDataURL(s):r()};r()})},t.mergeRegister=r,t.objectKlassEquals=function(e,t){return null!==e&&Object.getPrototypeOf(e).constructor.name===t.name},t.positionNodeOnRange=s,t.registerNestedElementResolver=function(e,t,n,a){return e.registerNodeTransform(t,e=>{e:{for(var i=e.getChildren(),r=0;r<i.length;r++)if(i[r]instanceof t){i=null;break e}for(i=e;null!==i;)if(r=i,(i=i.getParent())instanceof t){i={child:r,parent:i};break e}i=null}if(null!==i){const{child:t,parent:o}=i;if(t.is(e)){if(a(o,e),i=(e=t.getNextSiblings()).length,o.insertAfter(t),0!==i){r=n(o),t.insertAfter(r);for(let t=0;t<i;t++)r.append(e[t])}o.canBeEmpty()||0!==o.getChildrenSize()||o.remove()}}})},t.removeClassNamesFromElement=function(e,...t){t.forEach(t=>{"string"==typeof t&&e.classList.remove(...t.split(" "))})}}
,2475:(e,t,n)=>{"use strict";const a=n(3880);e.exports=a}
,3880:(e,t)=>{"use strict";let n={},a={},i={},r={},o={},s={},c={},d={},l={},u={},f={},p={},m={},_={},h={},b={},g={},v={},y={},S={},D={},I={},x={},C={},O={},w={},E={},A={},L={},k={},M={},P={},T={},U={},F={},H={};function R(e){let t=new URLSearchParams;t.append("code",e);for(let e=1;e<arguments.length;e++)t.append("v",arguments[e]);throw Error(`Minified Lexical error #${e}; visit https://lexical.dev/docs/error?${t} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}let N="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement,B=N&&"documentMode"in document?document.documentMode:null,j=N&&/Mac|iPod|iPhone|iPad/.test(navigator.platform),V=N&&/^(?!.*Seamonkey)(?=.*Firefox).*/i.test(navigator.userAgent),z=!(!N||!("InputEvent"in window)||B)&&"getTargetRanges"in new window.InputEvent("input"),G=N&&/Version\/[\d.]+.*Safari/.test(navigator.userAgent),K=N&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,W=N&&/Android/.test(navigator.userAgent),q=N&&/^(?=.*Chrome).*/i.test(navigator.userAgent),Q=N&&/AppleWebKit\/[\d.]+/.test(navigator.userAgent)&&!q,Y=G||K||Q?" ":"​",J=V?" ":Y,X=/^[^A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]*[\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]/,Z=/^[^\u0591-\u07ff\ufb1d-\ufdfd\ufe70-\ufefc]*[A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff]/,$={bold:1,code:16,highlight:128,italic:2,strikethrough:4,subscript:32,superscript:64,underline:8},ee={directionless:1,unmergeable:2},te={center:2,end:6,justify:4,left:1,right:3,start:5},ne={2:"center",6:"end",4:"justify",1:"left",3:"right",5:"start"},ae={normal:0,segmented:2,token:1},ie={0:"normal",2:"segmented",1:"token"},re=!1,oe=0;function se(e){oe=e.timeStamp}function ce(e,t,n){return t.__lexicalLineBreak===e||void 0!==e[`__lexicalKey_${n._key}`]}function de(e,t,n){re=!0;let a=100<performance.now()-oe;try{La(e,()=>{let i=aa()||function(e){return e.getEditorState().read(()=>{let e=aa();return null!==e?e.clone():null})}(e);var r=new Map,o=e.getRootElement(),s=e._editorState,c=e._blockCursorElement;let d=!1,l="";for(var u=0;u<t.length;u++){var f=t[u],p=f.type,m=f.target,_=Me(m,s);if(!(null===_&&m!==o||Ma(_)))if("characterData"===p){if(f=a&&kn(_))e:{p=m;var h=_;if(zn(f=i)){var b=f.anchor.getNode();if(b.is(h)&&f.format!==b.getFormat()){f=!1;break e}}f=3===p.nodeType&&h.isAttached()}f&&(p=f=null,null!==(h=ot(e._window))&&h.anchorNode===m&&(f=h.anchorOffset,p=h.focusOffset),null!==(m=m.nodeValue)&&Ve(_,m,f,p,!1))}else if("childList"===p){for(d=!0,p=f.addedNodes,h=0;h<p.length;h++){var g=ke(b=p[h]),v=b.parentNode;null==v||b===c||null!==g||"BR"===b.nodeName&&ce(b,v,e)||(V&&(g=b.innerText||b.nodeValue)&&(l+=g),v.removeChild(b))}if(0<(p=(f=f.removedNodes).length)){for(h=0,b=0;b<p;b++)("BR"===(v=f[b]).nodeName&&ce(v,m,e)||c===v)&&(m.appendChild(v),h++);p!==h&&(m===o&&(_=s._nodeMap.get("root")),r.set(m,_))}}}if(0<r.size)for(let[t,n]of r)if(Ta(n))for(r=n.getChildrenKeys(),o=t.firstChild,s=0;s<r.length;s++)null!==(c=e.getElementByKey(r[s]))&&(null==o?(t.appendChild(c),o=c):o!==c&&t.replaceChild(c,o),o=o.nextSibling);else kn(n)&&n.markDirty();if(0<(r=n.takeRecords()).length){for(o=0;o<r.length;o++)for(s=(c=r[o]).addedNodes,c=c.target,u=0;u<s.length;u++)null==(m=(_=s[u]).parentNode)||"BR"!==_.nodeName||ce(_,c,e)||m.removeChild(_);n.takeRecords()}null!==i&&(d&&(i.dirty=!0,Fe(i)),V&&qe(e)&&i.insertRawText(l))})}finally{re=!1}}function le(e){let t=e._observer;null!==t&&de(e,t.takeRecords(),t)}function ue(e){0===oe&&Ze(e).addEventListener("textInput",se,!0),e._observer=new MutationObserver((t,n)=>{de(e,t,n)})}function fe(e,t){let n=e.__mode,a=e.__format;e=e.__style;let i=t.__mode,r=t.__format;return t=t.__style,!(null!==n&&n!==i||null!==a&&a!==r||null!==e&&e!==t)}function pe(e,t){let n=e.mergeWithSibling(t),a=Sa()._normalizedNodes;return a.add(e.__key),a.add(t.__key),n}function me(e){if(""===e.__text&&e.isSimpleText()&&!e.isUnmergeable())e.remove();else{for(var t;null!==(t=e.getPreviousSibling())&&kn(t)&&t.isSimpleText()&&!t.isUnmergeable();){if(""!==t.__text){fe(t,e)&&(e=pe(t,e));break}t.remove()}for(var n;null!==(n=e.getNextSibling())&&kn(n)&&n.isSimpleText()&&!n.isUnmergeable();){if(""!==n.__text){fe(e,n)&&pe(e,n);break}n.remove()}}}function _e(e){return he(e.anchor),he(e.focus),e}function he(e){for(;"element"===e.type;){var t=e.getNode(),n=e.offset;if(n===t.getChildrenSize()?(t=t.getChildAtIndex(n-1),n=!0):(t=t.getChildAtIndex(n),n=!1),kn(t)){e.set(t.__key,n?t.getTextContentSize():0,"text");break}if(!Ta(t))break;e.set(t.__key,n?t.getChildrenSize():0,"element")}}let be=1,ge="function"==typeof queueMicrotask?queueMicrotask:e=>{Promise.resolve().then(e)};function ve(e){let t=document.activeElement;if(null===t)return!1;let n=t.nodeName;return Ma(Me(e))&&("INPUT"===n||"TEXTAREA"===n||"true"===t.contentEditable&&null==t.__lexicalEditor)}function ye(e,t,n){let a=e.getRootElement();try{return null!==a&&a.contains(t)&&a.contains(n)&&null!==t&&!ve(t)&&Se(t)===e}catch(e){return!1}}function Se(e){for(;null!=e;){let t=e.__lexicalEditor;if(null!=t)return t;e=Je(e)}return null}function De(e){return e.isToken()||e.isSegmented()}function Ie(e){for(;null!=e;){if(3===e.nodeType)return e;e=e.firstChild}return null}function xe(e,t,n){let a=$[t];return null!==n&&(e&a)==(n&a)||(e^=a,"subscript"===t?e&=~$.superscript:"superscript"===t&&(e&=~$.subscript)),e}function Ce(e,t){if(null!=t)e.__key=t;else{va(),99<ha&&R(14),t=Sa();var n=ya(),a=""+be++;n._nodeMap.set(a,e),Ta(e)?t._dirtyElements.set(a,!0):t._dirtyLeaves.add(a),t._cloneNotNeeded.add(a),t._dirtyType=1,e.__key=a}}function Oe(e){var t=e.getParent();if(null!==t){let i=e.getWritable();t=t.getWritable();var n=e.getPreviousSibling();if(e=e.getNextSibling(),null===n)if(null!==e){var a=e.getWritable();t.__first=e.__key,a.__prev=null}else t.__first=null;else{if(a=n.getWritable(),null!==e){let t=e.getWritable();t.__prev=a.__key,a.__next=t.__key}else a.__next=null;i.__prev=null}null===e?null!==n?(e=n.getWritable(),t.__last=n.__key,e.__next=null):t.__last=null:(e=e.getWritable(),null!==n?((n=n.getWritable()).__next=e.__key,e.__prev=n.__key):e.__prev=null,i.__next=null),t.__size--,i.__parent=null}}function we(e){99<ha&&R(14);var t=e.getLatest(),n=t.__parent,a=ya();let i=Sa(),r=a._nodeMap;if(a=i._dirtyElements,null!==n)for(;null!==n&&!a.has(n);){let e=r.get(n);if(void 0===e)break;a.set(n,!1),n=e.__parent}t=t.__key,i._dirtyType=1,Ta(e)?a.set(t,!0):i._dirtyLeaves.add(t)}function Ee(e){va();var t=Sa();let n=t._compositionKey;e!==n&&(t._compositionKey=e,null!==n&&null!==(t=Le(n))&&t.getWritable(),null!==e&&null!==(e=Le(e))&&e.getWritable())}function Ae(){return ga()?null:Sa()._compositionKey}function Le(e,t){return void 0===(e=(t||ya())._nodeMap.get(e))?null:e}function ke(e,t){return void 0!==(e=e[`__lexicalKey_${Sa()._key}`])?Le(e,t):null}function Me(e,t){for(;null!=e;){let n=ke(e,t);if(null!==n)return n;e=Je(e)}return null}function Pe(e){let t=Object.assign({},e._decorators);return e._pendingDecorators=t}function Te(e){return e.read(()=>Ue().getTextContent())}function Ue(){return ya()._nodeMap.get("root")}function Fe(e){va();let t=ya();null!==e&&(e.dirty=!0,e.setCachedNodes(null)),t._selection=e}function He(e){var t,n=Sa();e:{for(t=e;null!=t;){let e=t[`__lexicalKey_${n._key}`];if(void 0!==e){t=e;break e}t=Je(t)}t=null}return null===t?e===(n=n.getRootElement())?Le("root"):null:Le(t)}function Re(e){return/[\uD800-\uDBFF][\uDC00-\uDFFF]/g.test(e)}function Ne(e){let t=[];for(;null!==e;)t.push(e),e=e._parentEditor;return t}function Be(){return Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)}function je(e,t,n){if(null!==(t=ot(t._window))){var a=t.anchorNode,{anchorOffset:i,focusOffset:r}=t;null!==a&&(t=3===a.nodeType?a.nodeValue:null,a=Me(a),null!==t&&kn(a))&&(t===Y&&n&&(t=n,r=i=n.length),null!==t&&Ve(a,t,i,r,e))}}function Ve(e,t,n,a,i){let r=e;if(r.isAttached()&&(i||!r.isDirty())){let d=r.isComposing(),l=t;if((d||i)&&t[t.length-1]===Y&&(l=t.slice(0,-1)),t=r.getTextContent(),i||l!==t)if(""===l)if(Ee(null),G||K||Q)r.remove();else{let e=Sa();setTimeout(()=>{e.update(()=>{r.isAttached()&&r.remove()})},20)}else{i=r.getParent(),t=ia();var o=r.getTextContentSize(),s=Ae(),c=r.getKey();r.isToken()||null!==s&&c===s&&!d||zn(t)&&(null!==i&&!i.canInsertTextBefore()&&0===t.anchor.offset||t.anchor.key===e.__key&&0===t.anchor.offset&&!r.canInsertTextBefore()&&!d||t.focus.key===e.__key&&t.focus.offset===o&&!r.canInsertTextAfter()&&!d)?r.markDirty():(zn(e=aa())&&null!==n&&null!==a&&(e.setTextNodeRange(r,n,r,a),r.isSegmented()&&(n=Ln(n=r.getTextContent()),r.replace(n),r=n)),r.setTextContent(l))}}}function ze(e,t){void 0===e.__lexicalClassNameCache&&(e.__lexicalClassNameCache={});let n=e.__lexicalClassNameCache,a=n[t];return void 0!==a?a:"string"==typeof(e=e[t])?(e=e.split(" "),n[t]=e):e}function Ge(e,t,n,a,i){0!==n.size&&(n=a.__type,a=a.__key,void 0===(t=t.get(n))&&R(33,n),n=t.klass,void 0===(t=e.get(n))&&(t=new Map,e.set(n,t)),n="destroyed"===(e=t.get(a))&&"created"===i,(void 0===e||n)&&t.set(a,n?"updated":i))}function Ke(e,t,n){let a=e.getParent(),i=n;return null!==a&&(t&&0===n?(i=e.getIndexWithinParent(),e=a):t||n!==e.getChildrenSize()||(i=e.getIndexWithinParent()+1,e=a)),e.getChildAtIndex(t?i-1:i)}function We(e,t){var n=e.offset;return"element"===e.type?Ke(e=e.getNode(),t,n):(e=e.getNode(),t&&0===n||!t&&n===e.getTextContentSize()?null===(n=t?e.getPreviousSibling():e.getNextSibling())?Ke(e.getParentOrThrow(),t,e.getIndexWithinParent()+(t?0:1)):n:null)}function qe(e){return"insertFromPaste"===(e=(e=Ze(e).event)&&e.inputType)||"insertFromPasteAsQuotation"===e}function Qe(e){return!Ha(e)&&!e.isLastChild()&&!e.isInline()}function Ye(e,t){return void 0===(e=e._keyToDOMMap.get(t))&&R(75,t),e}function Je(e){return null!==(e=e.assignedSlot||e.parentElement)&&11===e.nodeType?e.host:e}function Xe(e,t){for(e=e.getParent();null!==e;){if(e.is(t))return!0;e=e.getParent()}return!1}function Ze(e){return null===(e=e._window)&&R(78),e}function $e(e){for(e=e.getParentOrThrow();null!==e&&!et(e);)e=e.getParentOrThrow();return e}function et(e){return Ha(e)||Ta(e)&&e.isShadowRoot()}function tt(e){return Ce(e=e.constructor.clone(e),null),e}function nt(e){var t=Sa();let n=e.constructor.getType();return void 0===(t=t._nodes.get(n))&&R(97),null!==(t=t.replace)?((t=t(e))instanceof e.constructor||R(98),t):e}function at(e,t){!Ha(e=e.getParent())||Ta(t)||Ma(t)||R(99)}function it(e){return(Ma(e)||Ta(e)&&!e.canBeEmpty())&&!e.isInline()}function rt(e,t,n){n.style.removeProperty("caret-color"),t._blockCursorElement=null,null!==(t=e.parentElement)&&t.removeChild(e)}function ot(e){return N?(e||window).getSelection():null}function st(e,t){for(;e!==Ue()&&null!=e;){if(t(e))return e;e=e.getParent()}return null}function ct(e){return 1===e.nodeType}function dt(e){if(Ma(e)&&!e.isInline())return!0;if(!Ta(e)||et(e))return!1;var t=e.getFirstChild();return t=null===t||_n(t)||kn(t)||t.isInline(),!e.isInline()&&!1!==e.canBeEmpty()&&t}function lt(e,t){for(;null!==e&&null!==e.getParent()&&!t(e);)e=e.getParentOrThrow();return t(e)?e:null}function ut(e,t,n,a,i,r){for(e=e.getFirstChild();null!==e;){let o=e.__key;e.__parent===t&&(Ta(e)&&ut(e,o,n,a,i,r),n.has(o)||r.delete(o),i.push(o)),e=e.getNextSibling()}}let ft,pt,mt,_t,ht,bt,gt,vt,yt,St,Dt="",It="",xt="",Ct=!1,Ot=!1,wt=null;function Et(e,t){let n=gt.get(e);if(null!==t){let n=Vt(e);n.parentNode===t&&t.removeChild(n)}vt.has(e)||pt._keyToDOMMap.delete(e),Ta(n)&&At(e=Rt(n,gt),0,e.length-1,null),void 0!==n&&Ge(St,mt,_t,n,"destroyed")}function At(e,t,n,a){for(;t<=n;++t){let n=e[t];void 0!==n&&Et(n,a)}}function Lt(e,t){e.setProperty("text-align",t)}function kt(e,t){var n=ft.theme.indent;if("string"==typeof n){let a=e.classList.contains(n);0<t&&!a?e.classList.add(n):1>t&&a&&e.classList.remove(n)}n=getComputedStyle(e).getPropertyValue("--lexical-indent-base-value")||"40px",e.style.setProperty("padding-inline-start",0===t?"":`calc(${t} * ${n})`)}function Mt(e,t){e=e.style,0===t?Lt(e,""):1===t?Lt(e,"left"):2===t?Lt(e,"center"):3===t?Lt(e,"right"):4===t?Lt(e,"justify"):5===t?Lt(e,"start"):6===t&&Lt(e,"end")}function Pt(e,t,n){let a=vt.get(e);void 0===a&&R(60);let i=a.createDOM(ft,pt);var r=pt._keyToDOMMap;if(i["__lexicalKey_"+pt._key]=e,r.set(e,i),kn(a)?i.setAttribute("data-lexical-text","true"):Ma(a)&&i.setAttribute("data-lexical-decorator","true"),Ta(a)){if(e=a.__indent,r=a.__size,0!==e&&kt(i,e),0!==r){--r,e=Rt(a,vt);var o=It;It="",Tt(e,a,0,r,i,null),Ht(a,i),It=o}0!==(e=a.__format)&&Mt(i,e),a.isInline()||Ft(null,a,i),Qe(a)&&(Dt+="\n\n",xt+="\n\n")}else r=a.getTextContent(),Ma(a)?(null!==(o=a.decorate(pt,ft))&&Bt(e,o),i.contentEditable="false"):kn(a)&&(a.isDirectionless()||(It+=r)),Dt+=r,xt+=r;return null!==t&&(null!=n||null!=(n=t.__lexicalLineBreak)?t.insertBefore(i,n):t.appendChild(i)),Ge(St,mt,_t,a,"created"),i}function Tt(e,t,n,a,i,r){let o=Dt;for(Dt="";n<=a;++n)Pt(e[n],i,r);Qe(t)&&(Dt+="\n\n"),i.__lexicalTextContent=Dt,Dt=o+Dt}function Ut(e,t){return _n(e=t.get(e))||Ma(e)&&e.isInline()}function Ft(e,t,n){e=null!==e&&(0===e.__size||Ut(e.__last,gt)),t=0===t.__size||Ut(t.__last,vt),e?t||(null!=(t=n.__lexicalLineBreak)&&n.removeChild(t),n.__lexicalLineBreak=null):t&&(t=document.createElement("br"),n.__lexicalLineBreak=t,n.appendChild(t))}function Ht(e,t){var n=t.__lexicalDir;if(t.__lexicalDirTextContent!==It||n!==wt){let r=""===It;if(r)var a=wt;else a=It,a=X.test(a)?"rtl":Z.test(a)?"ltr":null;if(a!==n){let o=t.classList,s=ft.theme;var i=null!==n?s[n]:void 0;let c=null!==a?s[a]:void 0;void 0!==i&&("string"==typeof i&&(i=i.split(" "),i=s[n]=i),o.remove(...i)),null===a||r&&"ltr"===a?t.removeAttribute("dir"):(void 0!==c&&("string"==typeof c&&(n=c.split(" "),c=s[a]=n),void 0!==c&&o.add(...c)),t.dir=a),Ot||(e.getWritable().__dir=a)}wt=a,t.__lexicalDirTextContent=It,t.__lexicalDir=a}}function Rt(e,t){let n=[];for(e=e.__first;null!==e;){let a=t.get(e);void 0===a&&R(101),n.push(e),e=a.__next}return n}function Nt(e,t){var n=gt.get(e),a=vt.get(e);void 0!==n&&void 0!==a||R(61);var i=Ct||bt.has(e)||ht.has(e);let r=Ye(pt,e);if(n===a&&!i)return Ta(n)?(void 0!==(a=r.__lexicalTextContent)&&(Dt+=a,xt+=a),void 0!==(a=r.__lexicalDirTextContent)&&(It+=a)):(a=n.getTextContent(),kn(n)&&!n.isDirectionless()&&(It+=a),xt+=a,Dt+=a),r;if(n!==a&&i&&Ge(St,mt,_t,a,"updated"),a.updateDOM(n,r,ft))return a=Pt(e,null,null),null===t&&R(62),t.replaceChild(a,r),Et(e,null),a;if(Ta(n)&&Ta(a)){if((e=a.__indent)!==n.__indent&&kt(r,e),(e=a.__format)!==n.__format&&Mt(r,e),i){e=It,It="",i=Dt;var o=n.__size,s=a.__size;if(Dt="",1===o&&1===s){var c=n.__first;if(c===(t=a.__first))Nt(c,r);else{var d=Vt(c);t=Pt(t,null,null),r.replaceChild(t,d),Et(c,null)}}else{t=Rt(n,gt);var l=Rt(a,vt);if(0===o)0!==s&&Tt(l,a,0,s-1,r,null);else if(0===s)0!==o&&(At(t,0,o-1,(c=null==r.__lexicalLineBreak)?null:r),c&&(r.textContent=""));else{var u=t;t=l,l=o-1,o=s-1;let e=r.firstChild,n=0;for(s=0;n<=l&&s<=o;){var f=u[n];let a=t[s];if(f===a)e=jt(Nt(a,r)),n++,s++;else{void 0===c&&(c=new Set(u)),void 0===d&&(d=new Set(t));let i=d.has(f),o=c.has(a);i?(o?((f=Ye(pt,a))===e?e=jt(Nt(a,r)):(null!=e?r.insertBefore(f,e):r.appendChild(f),Nt(a,r)),n++):Pt(a,r,e),s++):(e=jt(Vt(f)),Et(f,r),n++)}}d=s>o,(c=n>l)&&!d?Tt(t,a,s,o,r,c=void 0===(c=t[o+1])?null:pt.getElementByKey(c)):d&&!c&&At(u,n,l,r)}}Qe(a)&&(Dt+="\n\n"),r.__lexicalTextContent=Dt,Dt=i+Dt,Ht(a,r),It=e,Ha(a)||a.isInline()||Ft(n,a,r)}Qe(a)&&(Dt+="\n\n",xt+="\n\n")}else n=a.getTextContent(),Ma(a)?null!==(i=a.decorate(pt,ft))&&Bt(e,i):kn(a)&&!a.isDirectionless()&&(It+=n),Dt+=n,xt+=n;return!Ot&&Ha(a)&&a.__cachedText!==xt&&(a.getWritable().__cachedText=xt),r}function Bt(e,t){let n=pt._pendingDecorators,a=pt._decorators;if(null===n){if(a[e]===t)return;n=Pe(pt)}n[e]=t}function jt(e){return null!==(e=e.nextSibling)&&e===pt._blockCursorElement&&(e=e.nextSibling),e}function Vt(e){let t=yt.get(e);return void 0===t&&R(75,e),t}let zt=Object.freeze({}),Gt=[["keydown",function(e,t){if(Kt=e.timeStamp,Wt=e.keyCode,!t.isComposing()){var{keyCode:n,shiftKey:a,ctrlKey:o,metaKey:s,altKey:c}=e;if(!wa(t,_,e)){if(39!==n||o||s||c)if(39!==n||c||a||!o&&!s)if(37!==n||o||s||c)if(37!==n||c||a||!o&&!s)if(38!==n||o||s)if(40!==n||o||s)if(13===n&&a)Zt=!0,wa(t,D,e);else if(32===n)wa(t,I,e);else if(j&&o&&79===n)e.preventDefault(),Zt=!0,wa(t,r,!0);else if(13!==n||a){var d=j?!c&&!s&&(8===n||72===n&&o):!(o||c||s)&&8===n;d?8===n?wa(t,x,e):(e.preventDefault(),wa(t,i,!0)):27===n?wa(t,C,e):(d=j?!(a||c||s)&&(46===n||68===n&&o):!(o||c||s)&&46===n)?46===n?wa(t,O,e):(e.preventDefault(),wa(t,i,!1)):8===n&&(j?c:o)?(e.preventDefault(),wa(t,l,!0)):46===n&&(j?c:o)?(e.preventDefault(),wa(t,l,!1)):j&&s&&8===n?(e.preventDefault(),wa(t,u,!0)):j&&s&&46===n?(e.preventDefault(),wa(t,u,!1)):66===n&&!c&&(j?s:o)?(e.preventDefault(),wa(t,f,"bold")):85===n&&!c&&(j?s:o)?(e.preventDefault(),wa(t,f,"underline")):73===n&&!c&&(j?s:o)?(e.preventDefault(),wa(t,f,"italic")):9!==n||c||o||s?90===n&&!a&&(j?s:o)?(e.preventDefault(),wa(t,p,void 0)):(d=j?90===n&&s&&a:89===n&&o||90===n&&o&&a)?(e.preventDefault(),wa(t,m,void 0)):Wn(t._editorState._selection)?(d=!a&&67===n&&(j?s:o))?(e.preventDefault(),wa(t,M,e)):(d=!a&&88===n&&(j?s:o))?(e.preventDefault(),wa(t,P,e)):65===n&&(j?s:o)&&(e.preventDefault(),wa(t,T,e)):!V&&65===n&&(j?s:o)&&(e.preventDefault(),wa(t,T,e)):wa(t,w,e)}else Zt=!1,wa(t,D,e);else wa(t,S,e);else wa(t,y,e);else wa(t,v,e);else wa(t,g,e);else wa(t,b,e);else wa(t,h,e);(o||a||c||s)&&wa(t,H,e)}}}],["pointerdown",function(e,t){let n=e.target;e=e.pointerType,n instanceof Node&&"touch"!==e&&La(t,()=>{Ma(Me(n))||(Xt=!0)})}],["compositionstart",function(e,t){La(t,()=>{let n=aa();if(zn(n)&&!t.isComposing()){let a=n.anchor,i=n.anchor.getNode();Ee(a.key),(e.timeStamp<Kt+30||"element"===a.type||!n.isCollapsed()||i.getFormat()!==n.format||kn(i)&&i.getStyle()!==n.style)&&wa(t,s,J)}})}],["compositionend",function(e,t){V?$t=!0:La(t,()=>{on(t,e.data)})}],["input",function(e,t){e.stopPropagation(),La(t,()=>{var n=aa(),a=e.data,i=rn(e);if(null!=a&&zn(n)&&tn(n,i,a,e.timeStamp,!1)){$t&&(on(t,a),$t=!1);var r=n.anchor,o=r.getNode();if(null===(i=ot(t._window)))return;let c=r.offset;(r=z&&!n.isCollapsed()&&kn(o)&&null!==i.anchorNode)&&(r=(o=o.getTextContent().slice(0,c)+a+o.getTextContent().slice(c+n.focus.offset))===(3===(i=i.anchorNode).nodeType?i.nodeValue:null)),r||wa(t,s,a),a=a.length,V&&1<a&&"insertCompositionText"===e.inputType&&!t.isComposing()&&(n.anchor.offset-=a),G||K||Q||!t.isComposing()||(Kt=0,Ee(null))}else je(!1,t,null!==a?a:void 0),$t&&(on(t,a||void 0),$t=!1);va(),le(n=Sa())}),Qt=null}],["click",function(e,t){La(t,()=>{let n=aa();var i=ot(t._window);let r=ia();if(i)if(zn(n)){let t=n.anchor;var o=t.getNode();"element"===t.type&&0===t.offset&&n.isCollapsed()&&!Ha(o)&&1===Ue().getChildrenSize()&&o.getTopLevelElementOrThrow().isEmpty()&&null!==r&&n.is(r)?(i.removeAllRanges(),n.dirty=!0):3!==e.detail||n.isCollapsed()||o!==(i=n.focus.getNode())&&(Ta(o)?o.select(0):o.getParentOrThrow().select(0))}else"touch"===e.pointerType&&null!==(o=i.anchorNode)&&(1===(o=o.nodeType)||3===o)&&Fe(i=na(r,i,t,e));wa(t,a,e)})}],["cut",zt],["copy",zt],["dragstart",zt],["dragover",zt],["dragend",zt],["paste",zt],["focus",zt],["blur",zt],["drop",zt]];z&&Gt.push(["beforeinput",(e,t)=>function(e,t){let n=e.inputType,a=rn(e);"deleteCompositionText"===n||V&&qe(t)||"insertCompositionText"!==n&&La(t,()=>{let _=aa();if("deleteContentBackward"===n){if(null===_){var h=ia();if(!zn(h))return;Fe(h.clone())}if(zn(_)){if(W&&Ee(_.anchor.key),229===Wt&&e.timeStamp<Kt+30&&t.isComposing()&&_.anchor.key===_.focus.key){if(Ee(null),Kt=0,setTimeout(()=>{La(t,()=>{Ee(null)})},30),zn(_)){if((h=_.anchor.getNode()).markDirty(),_.format=h.getFormat(),!kn(h))throw Error("Anchor node must be a TextNode");_.style=h.getStyle()}1>=_.anchor.getNode().getTextContent().length&&(e.preventDefault(),wa(t,i,!0))}else Ee(null),e.preventDefault(),wa(t,i,!0);return}}if(zn(_)){h=e.data,null!==Qt&&je(!1,t,Qt),_.dirty&&null===Qt||!_.isCollapsed()||Ha(_.anchor.getNode())||null===a||_.applyDOMRange(a),Qt=null;var b=_.focus,g=_.anchor.getNode();if(b=b.getNode(),"insertText"===n||"insertTranspose"===n)"\n"===h?(e.preventDefault(),wa(t,r,!1)):"\n\n"===h?(e.preventDefault(),wa(t,o,void 0)):null==h&&e.dataTransfer?(h=e.dataTransfer.getData("text/plain"),e.preventDefault(),_.insertRawText(h)):null!=h&&tn(_,a,h,e.timeStamp,!0)?(e.preventDefault(),wa(t,s,h)):Qt=h,qt=e.timeStamp;else switch(e.preventDefault(),n){case"insertFromYank":case"insertFromDrop":case"insertReplacementText":wa(t,s,e);break;case"insertFromComposition":Ee(null),wa(t,s,e);break;case"insertLineBreak":Ee(null),wa(t,r,!1);break;case"insertParagraph":Ee(null),Zt&&!K?(Zt=!1,wa(t,r,!1)):wa(t,o,void 0);break;case"insertFromPaste":case"insertFromPasteAsQuotation":wa(t,c,e);break;case"deleteByComposition":(function(e,t){return e!==t||Ta(e)||Ta(t)||!e.isToken()||!t.isToken()})(g,b)&&wa(t,d,e);break;case"deleteByDrag":case"deleteByCut":wa(t,d,e);break;case"deleteContent":wa(t,i,!1);break;case"deleteWordBackward":wa(t,l,!0);break;case"deleteWordForward":wa(t,l,!1);break;case"deleteHardLineBackward":case"deleteSoftLineBackward":wa(t,u,!0);break;case"deleteContentForward":case"deleteHardLineForward":case"deleteSoftLineForward":wa(t,u,!1);break;case"formatStrikeThrough":wa(t,f,"strikethrough");break;case"formatBold":wa(t,f,"bold");break;case"formatItalic":wa(t,f,"italic");break;case"formatUnderline":wa(t,f,"underline");break;case"historyUndo":wa(t,p,void 0);break;case"historyRedo":wa(t,m,void 0)}}})}(e,t)]);let Kt=0,Wt=0,qt=0,Qt=null,Yt=0,Jt=!1,Xt=!1,Zt=!1,$t=!1,en=[0,"",0,"root",0];function tn(e,t,n,a,i){let r=e.anchor,o=e.focus,s=r.getNode();var c=Sa();let d=ot(c._window),l=null!==d?d.anchorNode:null,u=r.key;c=c.getElementByKey(u);let f=n.length;return u!==o.key||!kn(s)||(!i&&(!z||qt<a+50)||s.isDirty()&&2>f||Re(n))&&r.offset!==o.offset&&!s.isComposing()||De(s)||s.isDirty()&&1<f||(i||!z)&&null!==c&&!s.isComposing()&&l!==Ie(c)||null!==d&&null!==t&&(!t.collapsed||t.startContainer!==d.anchorNode||t.startOffset!==d.anchorOffset)||s.getFormat()!==e.format||s.getStyle()!==e.style||function(e,t){if(t.isSegmented())return!0;if(!e.isCollapsed())return!1;e=e.anchor.offset;let n=t.getParentOrThrow(),a=t.isToken();return 0===e?((e=!t.canInsertTextBefore()||!n.canInsertTextBefore()||a)||(e=(kn(t=t.getPreviousSibling())||Ta(t)&&t.isInline())&&!t.canInsertTextAfter()),e):e===t.getTextContentSize()&&(!t.canInsertTextAfter()||!n.canInsertTextAfter()||a)}(e,s)}function nn(e,t){return null!==e&&null!==e.nodeValue&&3===e.nodeType&&0!==t&&t!==e.nodeValue.length}function an(e,t,a){let{anchorNode:i,anchorOffset:r,focusNode:o,focusOffset:s}=e;Jt&&(Jt=!1,nn(i,r)&&nn(o,s))||La(t,()=>{if(a){if(ye(t,i,o)){var r=aa();if(zn(r)){var s=r.anchor,c=s.getNode();if(r.isCollapsed()){"Range"===e.type&&e.anchorNode===e.focusNode&&(r.dirty=!0);var d=Ze(t).event;d=d?d.timeStamp:performance.now();let[n,a,i,o,u]=en;var l=Ue();if(l=!1===t.isComposing()&&""===l.getTextContent(),d<u+200&&s.offset===i&&s.key===o)r.format=n,r.style=a;else if("text"===s.type){if(!kn(c))throw Error("Point.getNode() must return TextNode when type is text");r.format=c.getFormat(),r.style=c.getStyle()}else"element"!==s.type||l||(r.format=0,r.style="")}else{s=255,c=!1,l=(d=r.getNodes()).length;for(let e=0;e<l;e++){let t=d[e];if(kn(t)&&(c=!0,0==(s&=t.getFormat())))break}r.format=c?s:0}}wa(t,n,void 0)}}else Fe(null)})}function rn(e){return e.getTargetRanges?0===(e=e.getTargetRanges()).length?null:e[0]:null}function on(e,t){var n=e._compositionKey;if(Ee(null),null!==n&&null!=t){if(""===t)return t=Le(n),void(null!==(e=Ie(e.getElementByKey(n)))&&null!==e.nodeValue&&kn(t)&&Ve(t,e.nodeValue,null,null,!0));if("\n"===t[t.length-1]&&zn(n=aa()))return t=n.focus,n.anchor.set(t.key,t.offset,t.type),void wa(e,D,null)}je(!0,e,t)}function sn(e){let t=e.__lexicalEventHandles;return void 0===t&&(t=[],e.__lexicalEventHandles=t),t}let cn=new Map;function dn(e){var t=e.target;let n=ot(null==t?null:9===t.nodeType?t.defaultView:t.ownerDocument.defaultView);if(null!==n){var a=Se(n.anchorNode);if(null!==a){Xt&&(Xt=!1,La(a,()=>{var t=ia(),i=n.anchorNode;null!==i&&(1===(i=i.nodeType)||3===i)&&Fe(t=na(t,n,a,e))}));var i=(t=(t=Ne(a))[t.length-1])._key,r=cn.get(i),o=r||t;o!==a&&an(n,o,!1),an(n,a,!0),a!==t?cn.set(i,a):r&&cn.delete(i)}}}function ln(e,t,n){va();var a=e.__key;let i=e.getParent();if(null!==i){var r=aa();if(zn(r)&&Ta(e)){var{anchor:o,focus:s}=r,c=o.getNode(),d=s.getNode();Xe(c,e)&&o.set(e.__key,0,"element"),Xe(d,e)&&s.set(e.__key,0,"element")}if(d=!1,zn(c=r)&&t){r=c.anchor;let t=c.focus;r.key===a&&(sa(r,e,i,e.getPreviousSibling(),e.getNextSibling()),d=!0),t.key===a&&(sa(t,e,i,e.getPreviousSibling(),e.getNextSibling()),d=!0)}else Wn(c)&&t&&e.isSelected()&&e.selectPrevious();zn(c)&&t&&!d?(a=e.getIndexWithinParent(),Oe(e),ra(c,i,a,-1)):Oe(e),n||et(i)||i.canBeEmpty()||!i.isEmpty()||ln(i,t),t&&Ha(i)&&i.isEmpty()&&i.selectEnd()}}class un{static getType(){R(64,this.name)}static clone(){R(65,this.name)}constructor(e){this.__type=this.constructor.getType(),this.__next=this.__prev=this.__parent=null,Ce(this,e)}getType(){return this.__type}isInline(){throw Error(`LexicalNode: Node ${this.constructor.name} does not implement .isInline().`)}isAttached(){for(var e=this.__key;null!==e;){if("root"===e)return!0;if(null===(e=Le(e)))break;e=e.__parent}return!1}isSelected(e){if(null==(e=e||aa()))return!1;let t=e.getNodes().some(e=>e.__key===this.__key);return(kn(this)||!zn(e)||"element"!==e.anchor.type||"element"!==e.focus.type||e.anchor.key!==e.focus.key||e.anchor.offset!==e.focus.offset)&&t}getKey(){return this.__key}getIndexWithinParent(){var e=this.getParent();if(null===e)return-1;e=e.getFirstChild();let t=0;for(;null!==e;){if(this.is(e))return t;t++,e=e.getNextSibling()}return-1}getParent(){let e=this.getLatest().__parent;return null===e?null:Le(e)}getParentOrThrow(){let e=this.getParent();return null===e&&R(66,this.__key),e}getTopLevelElement(){let e=this;for(;null!==e;){let t=e.getParent();if(et(t)){if(!Ta(e))throw Error("Children of root nodes must be elements");return e}e=t}return null}getTopLevelElementOrThrow(){let e=this.getTopLevelElement();return null===e&&R(67,this.__key),e}getParents(){let e=[],t=this.getParent();for(;null!==t;)e.push(t),t=t.getParent();return e}getParentKeys(){let e=[],t=this.getParent();for(;null!==t;)e.push(t.__key),t=t.getParent();return e}getPreviousSibling(){let e=this.getLatest().__prev;return null===e?null:Le(e)}getPreviousSiblings(){let e=[];var t=this.getParent();if(null===t)return e;for(t=t.getFirstChild();null!==t&&!t.is(this);)e.push(t),t=t.getNextSibling();return e}getNextSibling(){let e=this.getLatest().__next;return null===e?null:Le(e)}getNextSiblings(){let e=[],t=this.getNextSibling();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getCommonAncestor(e){let t=this.getParents();var n=e.getParents();Ta(this)&&t.unshift(this),Ta(e)&&n.unshift(e),e=t.length;var a=n.length;if(0===e||0===a||t[e-1]!==n[a-1])return null;for(n=new Set(n),a=0;a<e;a++){let e=t[a];if(n.has(e))return e}return null}is(e){return null!=e&&this.__key===e.__key}isBefore(e){if(this===e)return!1;if(e.isParentOf(this))return!0;if(this.isParentOf(e))return!1;var t=this.getCommonAncestor(e);let n=this;for(;;){var a=n.getParentOrThrow();if(a===t){a=n.getIndexWithinParent();break}n=a}for(n=e;;){if((e=n.getParentOrThrow())===t){t=n.getIndexWithinParent();break}n=e}return a<t}isParentOf(e){let t=this.__key;if(t===e.__key)return!1;for(;null!==e;){if(e.__key===t)return!0;e=e.getParent()}return!1}getNodesBetween(e){let t=this.isBefore(e),n=[],a=new Set;for(var i=this;;){var r=i.__key;if(a.has(r)||(a.add(r),n.push(i)),i===e)break;if(null!==(r=Ta(i)?t?i.getFirstChild():i.getLastChild():null))i=r;else if(null!==(r=t?i.getNextSibling():i.getPreviousSibling()))i=r;else{if(i=i.getParentOrThrow(),a.has(i.__key)||n.push(i),i===e)break;r=i;do{null===r&&R(68),i=t?r.getNextSibling():r.getPreviousSibling(),null!==(r=r.getParent())&&(null!==i||a.has(r.__key)||n.push(r))}while(null===i)}}return t||n.reverse(),n}isDirty(){let e=Sa()._dirtyLeaves;return null!==e&&e.has(this.__key)}getLatest(){let e=Le(this.__key);return null===e&&R(113),e}getWritable(){va();var e=ya(),t=Sa();e=e._nodeMap;let n=this.__key,a=this.getLatest(),i=a.__parent;t=t._cloneNotNeeded;var r=aa();return Gn(r)&&r.setCachedNodes(null),t.has(n)?(we(a),a):((r=a.constructor.clone(a)).__parent=i,r.__next=a.__next,r.__prev=a.__prev,Ta(a)&&Ta(r)?(r.__first=a.__first,r.__last=a.__last,r.__size=a.__size,r.__indent=a.__indent,r.__format=a.__format,r.__dir=a.__dir):kn(a)&&kn(r)&&(r.__format=a.__format,r.__style=a.__style,r.__mode=a.__mode,r.__detail=a.__detail),t.add(n),r.__key=n,we(r),e.set(n,r),r)}getTextContent(){return""}getTextContentSize(){return this.getTextContent().length}createDOM(){R(70)}updateDOM(){R(71)}exportDOM(e){return{element:this.createDOM(e._config,e)}}exportJSON(){R(72)}static importJSON(){R(18,this.name)}static transform(){return null}remove(e){ln(this,!0,e)}replace(e,t){va();var n=aa();null!==n&&(n=n.clone()),at(this,e);let a=this.getLatest(),i=this.__key,r=e.__key,o=e.getWritable(),s=(e=this.getParentOrThrow().getWritable()).__size;Oe(o);let c=a.getPreviousSibling(),d=a.getNextSibling(),l=a.__prev,u=a.__next,f=a.__parent;if(ln(a,!1,!0),null===c?e.__first=r:c.getWritable().__next=r,o.__prev=l,null===d?e.__last=r:d.getWritable().__prev=r,o.__next=u,o.__parent=f,e.__size=s,t){if(!Ta(this)||!Ta(o))throw Error("includeChildren should only be true for ElementNodes");this.getChildren().forEach(e=>{o.append(e)})}return zn(n)&&(Fe(n),t=n.anchor,n=n.focus,t.key===i&&Rn(t,o),n.key===i&&Rn(n,o)),Ae()===i&&Ee(r),o}insertAfter(e,t=!0){va(),at(this,e);var n=this.getWritable();let a=e.getWritable();var i=a.getParent();let r=aa();var o=!1,s=!1;if(null!==i){var c=e.getIndexWithinParent();Oe(a),zn(r)&&(s=i.__key,o=r.anchor,i=r.focus,o="element"===o.type&&o.key===s&&o.offset===c+1,s="element"===i.type&&i.key===s&&i.offset===c+1)}i=this.getNextSibling(),c=this.getParentOrThrow().getWritable();let d=a.__key,l=n.__next;return null===i?c.__last=d:i.getWritable().__prev=d,c.__size++,n.__next=d,a.__next=l,a.__prev=n.__key,a.__parent=n.__parent,t&&zn(r)&&(ra(r,c,(t=this.getIndexWithinParent())+1),n=c.__key,o&&r.anchor.set(n,t+2,"element"),s&&r.focus.set(n,t+2,"element")),e}insertBefore(e,t=!0){va(),at(this,e);var n=this.getWritable();let a=e.getWritable(),i=a.__key;Oe(a);let r=this.getPreviousSibling(),o=this.getParentOrThrow().getWritable(),s=n.__prev,c=this.getIndexWithinParent();return null===r?o.__first=i:r.getWritable().__next=i,o.__size++,n.__prev=i,a.__prev=s,a.__next=n.__key,a.__parent=n.__parent,n=aa(),t&&zn(n)&&ra(n,t=this.getParentOrThrow(),c),e}isParentRequired(){return!1}createParentElementNode(){return za()}selectStart(){return this.selectPrevious()}selectEnd(){return this.selectNext(0,0)}selectPrevious(e,t){va();let n=this.getPreviousSibling(),a=this.getParentOrThrow();return null===n?a.select(0,0):Ta(n)?n.select():kn(n)?n.select(e,t):(e=n.getIndexWithinParent()+1,a.select(e,e))}selectNext(e,t){va();let n=this.getNextSibling(),a=this.getParentOrThrow();return null===n?a.select():Ta(n)?n.select(0,0):kn(n)?n.select(e,t):(e=n.getIndexWithinParent(),a.select(e,e))}markDirty(){this.getWritable()}}class fn extends un{static getType(){return"linebreak"}static clone(e){return new fn(e.__key)}constructor(e){super(e)}getTextContent(){return"\n"}createDOM(){return document.createElement("br")}updateDOM(){return!1}static importDOM(){return{br:e=>{let t,n,a=e.parentElement;return null!==a&&((t=a.firstChild)===e||t.nextSibling===e&&3===t.nodeType&&null!==(t.textContent||"").match(/^( |\t|\r?\n)+$/))&&((n=a.lastChild)===e||n.previousSibling===e&&3===n.nodeType&&null!==(n.textContent||"").match(/^( |\t|\r?\n)+$/))?null:{conversion:pn,priority:0}}}}static importJSON(){return mn()}exportJSON(){return{type:"linebreak",version:1}}}function pn(){return{node:mn()}}function mn(){return nt(new fn)}function _n(e){return e instanceof fn}function hn(e,t){return 16&t?"code":128&t?"mark":32&t?"sub":64&t?"sup":null}function bn(e,t){return 1&t?"strong":2&t?"em":"span"}function gn(e,t,n,a,i){e=a.classList,void 0!==(a=ze(i,"base"))&&e.add(...a);let r=!1,o=8&t&&4&t;var s=8&n&&4&n;void 0!==(a=ze(i,"underlineStrikethrough"))&&(s?(r=!0,o||e.add(...a)):o&&e.remove(...a));for(let c in $)s=$[c],void 0!==(a=ze(i,c))&&(n&s&&(!r||"underline"!==c&&"strikethrough"!==c)?(0==(t&s)||o&&"underline"===c||"strikethrough"===c)&&e.add(...a):t&s&&e.remove(...a))}function vn(e,t,n){let a=t.firstChild;if(e+=(n=n.isComposing())?Y:"",null==a)t.textContent=e;else if((t=a.nodeValue)!==e)if(n||V){n=t.length;let i=e.length,r=0,o=0;for(;r<n&&r<i&&t[r]===e[r];)r++;for(;o+r<n&&o+r<i&&t[n-o-1]===e[i-o-1];)o++;e=[r,n-r-o,e.slice(r,i-o)];let[s,c,d]=e;0!==c&&a.deleteData(s,c),a.insertData(s,d)}else a.nodeValue=e}function yn(e,t){return(t=document.createElement(t)).appendChild(e),t}class Sn extends un{static getType(){return"text"}static clone(e){return new Sn(e.__text,e.__key)}constructor(e,t){super(t),this.__text=e,this.__format=0,this.__style="",this.__detail=this.__mode=0}getFormat(){return this.getLatest().__format}getDetail(){return this.getLatest().__detail}getMode(){let e=this.getLatest();return ie[e.__mode]}getStyle(){return this.getLatest().__style}isToken(){return 1===this.getLatest().__mode}isComposing(){return this.__key===Ae()}isSegmented(){return 2===this.getLatest().__mode}isDirectionless(){return 0!=(1&this.getLatest().__detail)}isUnmergeable(){return 0!=(2&this.getLatest().__detail)}hasFormat(e){return e=$[e],0!=(this.getFormat()&e)}isSimpleText(){return"text"===this.__type&&0===this.__mode}getTextContent(){return this.getLatest().__text}getFormatFlags(e,t){return xe(this.getLatest().__format,e,t)}createDOM(e){var t=this.__format,n=hn(0,t);let a=bn(0,t),i=document.createElement(null===n?a:n),r=i;return this.hasFormat("code")&&i.setAttribute("spellcheck","false"),null!==n&&(r=document.createElement(a),i.appendChild(r)),n=r,vn(this.__text,n,this),void 0!==(e=e.theme.text)&&gn(a,0,t,n,e),""!==(t=this.__style)&&(i.style.cssText=t),i}updateDOM(e,t,n){let a=this.__text;var i=e.__format,r=this.__format,o=hn(0,i);let s=hn(0,r);var c=bn(0,i);let d=bn(0,r);return(null===o?c:o)!==(null===s?d:s)||(o===s&&c!==d?(null==(i=t.firstChild)&&R(48),vn(a,e=o=document.createElement(d),this),void 0!==(n=n.theme.text)&&gn(d,0,r,e,n),t.replaceChild(o,i),!1):(c=t,null!==s&&null!==o&&null==(c=t.firstChild)&&R(49),vn(a,c,this),void 0!==(n=n.theme.text)&&i!==r&&gn(d,i,r,c,n),r=this.__style,e.__style!==r&&(t.style.cssText=r),!1))}static importDOM(){return{"#text":()=>({conversion:Cn,priority:0}),b:()=>({conversion:In,priority:0}),code:()=>({conversion:An,priority:0}),em:()=>({conversion:An,priority:0}),i:()=>({conversion:An,priority:0}),s:()=>({conversion:An,priority:0}),span:()=>({conversion:Dn,priority:0}),strong:()=>({conversion:An,priority:0}),sub:()=>({conversion:An,priority:0}),sup:()=>({conversion:An,priority:0}),u:()=>({conversion:An,priority:0})}}static importJSON(e){let t=Ln(e.text);return t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}exportDOM(e){return({element:e}=super.exportDOM(e)),null!==e&&ct(e)||R(132),e.style.whiteSpace="pre-wrap",this.hasFormat("bold")&&(e=yn(e,"b")),this.hasFormat("italic")&&(e=yn(e,"i")),this.hasFormat("strikethrough")&&(e=yn(e,"s")),this.hasFormat("underline")&&(e=yn(e,"u")),{element:e}}exportJSON(){return{detail:this.getDetail(),format:this.getFormat(),mode:this.getMode(),style:this.getStyle(),text:this.getTextContent(),type:"text",version:1}}selectionTransform(){}setFormat(e){let t=this.getWritable();return t.__format="string"==typeof e?$[e]:e,t}setDetail(e){let t=this.getWritable();return t.__detail="string"==typeof e?ee[e]:e,t}setStyle(e){let t=this.getWritable();return t.__style=e,t}toggleFormat(e){return e=xe(this.getFormat(),e,null),this.setFormat(e)}toggleDirectionless(){let e=this.getWritable();return e.__detail^=1,e}toggleUnmergeable(){let e=this.getWritable();return e.__detail^=2,e}setMode(e){if(e=ae[e],this.__mode===e)return this;let t=this.getWritable();return t.__mode=e,t}setTextContent(e){if(this.__text===e)return this;let t=this.getWritable();return t.__text=e,t}select(e,t){va();let n=aa();var a=this.getTextContent();let i=this.__key;return"string"==typeof a?(a=a.length,void 0===e&&(e=a),void 0===t&&(t=a)):t=e=0,zn(n)?((a=Ae())!==n.anchor.key&&a!==n.focus.key||Ee(i),n.setTextNodeRange(this,e,this,t),n):ea(i,e,i,t,"text","text")}selectStart(){return this.select(0,0)}selectEnd(){let e=this.getTextContentSize();return this.select(e,e)}spliceText(e,t,n,a){let i=this.getWritable(),r=i.__text,o=n.length,s=e;0>s&&(s=o+s,0>s&&(s=0));let c=aa();return a&&zn(c)&&(e+=o,c.setTextNodeRange(i,e,i,e)),t=r.slice(0,s)+n+r.slice(s+t),i.__text=t,i}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}splitText(...e){va();var t=this.getLatest(),n=t.getTextContent(),a=t.__key,i=Ae(),r=new Set(e);e=[];for(var o=n.length,s="",c=0;c<o;c++)""!==s&&r.has(c)&&(e.push(s),s=""),s+=n[c];if(""!==s&&e.push(s),0===(r=e.length))return[];if(e[0]===n)return[t];var d=e[0];n=t.getParentOrThrow(),c=t.getFormat();let l=t.getStyle(),u=t.__detail;o=!1,t.isSegmented()?((s=Ln(d)).__format=c,s.__style=l,s.__detail=u,o=!0):(s=t.getWritable()).__text=d,t=aa(),s=[s],d=d.length;for(let n=1;n<r;n++){var f=e[n],p=f.length;(f=Ln(f).getWritable()).__format=c,f.__style=l,f.__detail=u;let r=f.__key;if(p=d+p,zn(t)){let e=t.anchor,n=t.focus;e.key===a&&"text"===e.type&&e.offset>d&&e.offset<=p&&(e.key=r,e.offset-=d,t.dirty=!0),n.key===a&&"text"===n.type&&n.offset>d&&n.offset<=p&&(n.key=r,n.offset-=d,t.dirty=!0)}i===a&&Ee(r),d=p,s.push(f)}return a=this.getPreviousSibling(),i=this.getNextSibling(),null!==a&&we(a),null!==i&&we(i),a=n.getWritable(),i=this.getIndexWithinParent(),o?(a.splice(i,0,s),this.remove()):a.splice(i,1,s),zn(t)&&ra(t,n,i,r-1),s}mergeWithSibling(e){var t=e===this.getPreviousSibling();t||e===this.getNextSibling()||R(50);var n=this.__key;let a=e.__key,i=this.__text,r=i.length;Ae()===a&&Ee(n);let o=aa();if(zn(o)){let i=o.anchor,s=o.focus;null!==i&&i.key===a&&(ca(i,t,n,e,r),o.dirty=!0),null!==s&&s.key===a&&(ca(s,t,n,e,r),o.dirty=!0)}return n=e.__text,this.setTextContent(t?n+i:i+n),t=this.getWritable(),e.remove(),t}isTextEntity(){return!1}}function Dn(e){let t="700"===e.style.fontWeight,n="line-through"===e.style.textDecoration,a="italic"===e.style.fontStyle,i="underline"===e.style.textDecoration,r=e.style.verticalAlign;return{forChild:e=>kn(e)?(t&&e.toggleFormat("bold"),n&&e.toggleFormat("strikethrough"),a&&e.toggleFormat("italic"),i&&e.toggleFormat("underline"),"sub"===r&&e.toggleFormat("subscript"),"super"===r&&e.toggleFormat("superscript"),e):e,node:null}}function In(e){let t="normal"===e.style.fontWeight;return{forChild:e=>(kn(e)&&!t&&e.toggleFormat("bold"),e),node:null}}let xn=new WeakMap;function Cn(e){null===e.parentElement&&R(129);for(var t,n=e.textContent||"",a=e.parentNode,i=[e];null!==a&&void 0===(t=xn.get(a))&&!("PRE"===a.nodeName||1===a.nodeType&&void 0!==a.style&&void 0!==a.style.whiteSpace&&a.style.whiteSpace.startsWith("pre"));)i.push(a),a=a.parentNode;for(t=void 0===t?a:t,a=0;a<i.length;a++)xn.set(i[a],t);if(null!==t){for(e=[],i=(n=n.split(/(\r?\n|\t)/)).length,t=0;t<i;t++)"\n"===(a=n[t])||"\r\n"===a?e.push(mn()):"\t"===a?e.push(Pn()):""!==a&&e.push(Ln(a));return{node:e}}if(""===(n=n.replace(/\r/g,"").replace(/[ \t\n]+/g," ")))return{node:null};if(" "===n[0]){for(i=e,t=!0;null!==i&&null!==(i=wn(i,!1));)if(0<(a=i.textContent||"").length){/[ \t\n]$/.test(a)&&(n=n.slice(1)),t=!1;break}t&&(n=n.slice(1))}if(" "===n[n.length-1]){for(i=!0;null!==e&&null!==(e=wn(e,!0));)if(0<(e.textContent||"").replace(/^( |\t|\r?\n)+/,"").length){i=!1;break}i&&(n=n.slice(0,n.length-1))}return""===n?{node:null}:{node:Ln(n)}}let On=new RegExp(/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/,"i");function wn(e,t){for(;;){for(var n=void 0;null===(n=t?e.nextSibling:e.previousSibling);)if(null===(e=e.parentElement))return null;if(1===(e=n).nodeType&&(""===(n=e.style.display)&&null===e.nodeName.match(On)||""!==n&&!n.startsWith("inline")))return null;for(;null!==(n=t?e.firstChild:e.lastChild);)e=n;if(3===e.nodeType)return e;if("BR"===e.nodeName)return null}}let En={code:"code",em:"italic",i:"italic",s:"strikethrough",strong:"bold",sub:"subscript",sup:"superscript",u:"underline"};function An(e){let t=En[e.nodeName.toLowerCase()];return void 0===t?{node:null}:{forChild:e=>(kn(e)&&!e.hasFormat(t)&&e.toggleFormat(t),e),node:null}}function Ln(e=""){return nt(new Sn(e))}function kn(e){return e instanceof Sn}class Mn extends Sn{static getType(){return"tab"}static clone(e){let t=new Mn(e.__key);return t.__text=e.__text,t.__format=e.__format,t.__style=e.__style,t}constructor(e){super("\t",e),this.__detail=2}static importDOM(){return null}static importJSON(e){let t=Pn();return t.setFormat(e.format),t.setStyle(e.style),t}exportJSON(){return{...super.exportJSON(),type:"tab",version:1}}setTextContent(){R(126)}setDetail(){R(127)}setMode(){R(128)}canInsertTextBefore(){return!1}canInsertTextAfter(){return!1}}function Pn(){return nt(new Mn)}function Tn(e){return e instanceof Mn}class Un{constructor(e,t,n){this._selection=null,this.key=e,this.offset=t,this.type=n}is(e){return this.key===e.key&&this.offset===e.offset&&this.type===e.type}isBefore(e){let t=this.getNode(),n=e.getNode(),a=this.offset;if(e=e.offset,Ta(t)){var i=t.getDescendantByIndex(a);t=null!=i?i:t}return Ta(n)&&(i=n.getDescendantByIndex(e),n=null!=i?i:n),t===n?a<e:t.isBefore(n)}getNode(){let e=Le(this.key);return null===e&&R(20),e}set(e,t,n){let a=this._selection,i=this.key;this.key=e,this.offset=t,this.type=n,ga()||(Ae()===i&&Ee(e),null!==a&&(a.setCachedNodes(null),a.dirty=!0))}}function Fn(e,t,n){return new Un(e,t,n)}function Hn(e,t){let n=t.__key,a=e.offset,i="element";if(kn(t))i="text",a>(t=t.getTextContentSize())&&(a=t);else if(!Ta(t)){var r=t.getNextSibling();kn(r)?(n=r.__key,a=0,i="text"):(r=t.getParent())&&(n=r.__key,a=t.getIndexWithinParent()+1)}e.set(n,a,i)}function Rn(e,t){if(Ta(t)){let n=t.getLastDescendant();Ta(n)||kn(n)?Hn(e,n):Hn(e,t)}else Hn(e,t)}function Nn(e,t,n,a){let i=e.getNode(),r=i.getChildAtIndex(e.offset),o=Ln(),s=Ha(i)?za().append(o):o;o.setFormat(n),o.setStyle(a),null===r?i.append(s):r.insertBefore(s),e.is(t)&&t.set(o.__key,0,"text"),e.set(o.__key,0,"text")}function Bn(e,t,n,a){e.key=t,e.offset=n,e.type=a}class jn{constructor(e,t){this.anchor=e,this.focus=t,e._selection=this,t._selection=this,this._cachedNodes=null,this.dirty=!1}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){return!!Gn(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)}isCollapsed(){return!1}extract(){return this.getNodes()}isBackward(){return this.focus.isBefore(this.anchor)}getCharacterOffsets(){return Qn(this)}}class Vn{constructor(e){this.dirty=!1,this._nodes=e,this._cachedNodes=null}getCachedNodes(){return this._cachedNodes}setCachedNodes(e){this._cachedNodes=e}is(e){if(!Wn(e))return!1;let t=this._nodes,n=e._nodes;return t.size===n.size&&Array.from(t).every(e=>n.has(e))}add(e){this.dirty=!0,this._nodes.add(e),this._cachedNodes=null}delete(e){this.dirty=!0,this._nodes.delete(e),this._cachedNodes=null}clear(){this.dirty=!0,this._nodes.clear(),this._cachedNodes=null}has(e){return this._nodes.has(e)}clone(){return new Vn(new Set(this._nodes))}extract(){return this.getNodes()}insertRawText(){}insertText(){}insertNodes(e){let t=this.getNodes(),n=t.length;var a=t[n-1];if(kn(a))a=a.select();else{let e=a.getIndexWithinParent()+1;a=a.getParentOrThrow().select(e,e)}for(a.insertNodes(e),e=0;e<n;e++)t[e].remove()}getNodes(){var e=this._cachedNodes;if(null!==e)return e;var t=this._nodes;e=[];for(let n of t)null!==(t=Le(n))&&e.push(t);return ga()||(this._cachedNodes=e),e}getTextContent(){let e=this.getNodes(),t="";for(let n=0;n<e.length;n++)t+=e[n].getTextContent();return t}}function zn(e){return e instanceof Kn}function Gn(e){return e instanceof jn}class Kn extends jn{constructor(e,t,n,a){super(e,t),this.format=n,this.style=a}is(e){return!!zn(e)&&this.anchor.is(e.anchor)&&this.focus.is(e.focus)&&this.format===e.format&&this.style===e.style}isCollapsed(){return this.anchor.is(this.focus)}getNodes(){var e=this._cachedNodes;if(null!==e)return e;e=this.anchor;var t=this.focus,n=e.isBefore(t),a=n?e:t;n=n?t:e,e=a.getNode(),t=n.getNode();let i=a.offset;return a=n.offset,Ta(e)&&(n=e.getDescendantByIndex(i),e=null!=n?n:e),Ta(t)&&(null!==(n=t.getDescendantByIndex(a))&&n!==e&&t.getChildAtIndex(a)===n&&(n=n.getPreviousSibling()),t=null!=n?n:t),e=e.is(t)?Ta(e)&&0<e.getChildrenSize()?[]:[e]:e.getNodesBetween(t),ga()||(this._cachedNodes=e),e}setTextNodeRange(e,t,n,a){Bn(this.anchor,e.__key,t,"text"),Bn(this.focus,n.__key,a,"text"),this._cachedNodes=null,this.dirty=!0}getTextContent(){let e=this.getNodes();if(0===e.length)return"";let t=e[0],n=e[e.length-1],a=this.anchor,i=this.focus,r=a.isBefore(i),[o,s]=Qn(this),c="",d=!0;for(let l=0;l<e.length;l++){let u=e[l];if(Ta(u)&&!u.isInline())d||(c+="\n"),d=!u.isEmpty();else if(d=!1,kn(u)){let e=u.getTextContent();u===t?u===n?"element"===a.type&&"element"===i.type&&i.offset!==a.offset||(e=o<s?e.slice(o,s):e.slice(s,o)):e=r?e.slice(o):e.slice(s):u===n&&(e=r?e.slice(0,s):e.slice(0,o)),c+=e}else!Ma(u)&&!_n(u)||u===n&&this.isCollapsed()||(c+=u.getTextContent())}return c}applyDOMRange(e){let t=Sa(),n=t.getEditorState()._selection;if(null!==(e=$n(e.startContainer,e.startOffset,e.endContainer,e.endOffset,t,n))){var[a,i]=e;Bn(this.anchor,a.key,a.offset,a.type),Bn(this.focus,i.key,i.offset,i.type),this._cachedNodes=null}}clone(){let e=this.anchor,t=this.focus;return new Kn(Fn(e.key,e.offset,e.type),Fn(t.key,t.offset,t.type),this.format,this.style)}toggleFormat(e){this.format=xe(this.format,e,null),this.dirty=!0}setStyle(e){this.style=e,this.dirty=!0}hasFormat(e){return 0!=(this.format&$[e])}insertRawText(e){let t=[],n=(e=e.split(/(\r?\n|\t)/)).length;for(let a=0;a<n;a++){let n=e[a];"\n"===n||"\r\n"===n?t.push(mn()):"\t"===n?t.push(Pn()):t.push(Ln(n))}this.insertNodes(t)}insertText(e){var t=this.anchor,n=this.focus,a=this.isCollapsed()||t.isBefore(n),i=this.format,r=this.style;a&&"element"===t.type?Nn(t,n,i,r):a||"element"!==n.type||Nn(n,t,i,r);var o=this.getNodes(),s=o.length,c=a?n:t;n=(a?t:n).offset;var d=c.offset;kn(t=o[0])||R(26),a=t.getTextContent().length;var l=t.getParentOrThrow(),u=o[s-1];if(this.isCollapsed()&&n===a&&(t.isSegmented()||t.isToken()||!t.canInsertTextAfter()||!l.canInsertTextAfter()&&null===t.getNextSibling())){var f=t.getNextSibling();if(kn(f)&&f.canInsertTextBefore()&&!De(f)||((f=Ln()).setFormat(i),l.canInsertTextAfter()?t.insertAfter(f):l.insertAfter(f)),f.select(0,0),t=f,""!==e)return void this.insertText(e)}else if(this.isCollapsed()&&0===n&&(t.isSegmented()||t.isToken()||!t.canInsertTextBefore()||!l.canInsertTextBefore()&&null===t.getPreviousSibling())){if(kn(f=t.getPreviousSibling())&&!De(f)||((f=Ln()).setFormat(i),l.canInsertTextBefore()?t.insertBefore(f):l.insertBefore(f)),f.select(),t=f,""!==e)return void this.insertText(e)}else if(t.isSegmented()&&n!==a)(l=Ln(t.getTextContent())).setFormat(i),t.replace(l),t=l;else if(!(this.isCollapsed()||""===e||(f=u.getParent(),l.canInsertTextBefore()&&l.canInsertTextAfter()&&(!Ta(f)||f.canInsertTextBefore()&&f.canInsertTextAfter()))))return this.insertText(""),Zn(this.anchor,this.focus,null),void this.insertText(e);if(1===s)if(t.isToken())(e=Ln(e)).select(),t.replace(e);else{if(o=t.getFormat(),s=t.getStyle(),n!==d||o===i&&s===r){if(Tn(t))return(e=Ln(e)).setFormat(i),e.setStyle(r),e.select(),void t.replace(e)}else{if(""!==t.getTextContent())return(o=Ln(e)).setFormat(i),o.setStyle(r),o.select(),0===n?t.insertBefore(o,!1):([s]=t.splitText(n),s.insertAfter(o,!1)),void(o.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length));t.setFormat(i),t.setStyle(r)}""===(t=t.spliceText(n,d-n,e,!0)).getTextContent()?t.remove():"text"===this.anchor.type&&(t.isComposing()?this.anchor.offset-=e.length:(this.format=o,this.style=s))}else{if(i=new Set([...t.getParentKeys(),...u.getParentKeys()]),f=Ta(t)?t:t.getParentOrThrow(),r=Ta(u)?u:u.getParentOrThrow(),l=u,!f.is(r)&&r.isInline())do{l=r,r=r.getParentOrThrow()}while(r.isInline());if("text"===c.type&&(0!==d||""===u.getTextContent())||"element"===c.type&&u.getIndexWithinParent()<d)if(kn(u)&&!u.isToken()&&d!==u.getTextContentSize()){if(u.isSegmented()){var p=Ln(u.getTextContent());u.replace(p),u=p}Ha(c.getNode())||"text"!==c.type||(u=u.spliceText(0,d,"")),i.add(u.__key)}else(c=u.getParentOrThrow()).canBeEmpty()||1!==c.getChildrenSize()?u.remove():c.remove();else i.add(u.__key);for(c=r.getChildren(),d=new Set(o),u=f.is(r),f=f.isInline()&&null===t.getNextSibling()?f:t,p=c.length-1;0<=p;p--){let e=c[p];if(e.is(t)||Ta(e)&&e.isParentOf(t))break;e.isAttached()&&(!d.has(e)||e.is(l)?u||f.insertAfter(e,!1):e.remove())}if(!u)for(c=r,r=null;null!==c;)(0===(u=(d=c.getChildren()).length)||d[u-1].is(r))&&(i.delete(c.__key),r=c),c=c.getParent();for(t.isToken()?n===a?t.select():((e=Ln(e)).select(),t.replace(e)):""===(t=t.spliceText(n,a-n,e,!0)).getTextContent()?t.remove():t.isComposing()&&"text"===this.anchor.type&&(this.anchor.offset-=e.length),e=1;e<s;e++)t=o[e],i.has(t.__key)||t.remove()}}removeText(){this.insertText("")}formatText(e){if(this.isCollapsed())this.toggleFormat(e),Ee(null);else{var t=this.getNodes(),n=[];for(var a of t)kn(a)&&n.push(a);var i=n.length;if(0===i)this.toggleFormat(e),Ee(null);else{a=this.anchor;var r=this.focus,o=this.isBackward();t=o?r:a,a=o?a:r;var s=0,c=n[0];if(r="element"===t.type?0:t.offset,"text"===t.type&&r===c.getTextContentSize()&&(s=1,c=n[1],r=0),null!=c){o=c.getFormatFlags(e,null);var d=i-1,l=n[d];if(i="text"===a.type?a.offset:l.getTextContentSize(),c.is(l))r!==i&&(0===r&&i===c.getTextContentSize()?c.setFormat(o):(e=c.splitText(r,i),(e=0===r?e[0]:e[1]).setFormat(o),"text"===t.type&&t.set(e.__key,0,"text"),"text"===a.type&&a.set(e.__key,i-r,"text")),this.format=o);else{0!==r&&([,c]=c.splitText(r),r=0),c.setFormat(o);var u=l.getFormatFlags(e,o);for(0<i&&(i!==l.getTextContentSize()&&([l]=l.splitText(i)),l.setFormat(u)),s+=1;s<d;s++){let t=n[s];if(!t.isToken()){let n=t.getFormatFlags(e,u);t.setFormat(n)}}"text"===t.type&&t.set(c.__key,r,"text"),"text"===a.type&&a.set(l.__key,i,"text"),this.format=o|u}}}}}insertNodes(e){if(0!==e.length){if("root"===this.anchor.key){this.insertParagraph();var t=aa();if(!zn(t))throw Error("Expected RangeSelection after insertParagraph");return t.insertNodes(e)}var n=lt(this.anchor.getNode(),dt);if(t=e[e.length-1],"__language"in n&&Ta(n))if("__language"in e[0])this.insertText(e[0].getTextContent());else{var a=la(this);n.splice(a,0,e),t.selectEnd()}else if(e.some(e=>(Ta(e)||Ma(e))&&!e.isInline())){t=function(e){let t=za(),n=null;for(let a=0;a<e.length;a++){let i=e[a],r=_n(i);if(r||Ma(i)&&i.isInline()||Ta(i)&&i.isInline()||kn(i)||i.isParentRequired()){if(null===n&&(n=i.createParentElementNode(),t.append(n),r))continue;null!==n&&n.append(i)}else t.append(i),n=null}return t}(e),e=t.getLastDescendant();var i=t.getChildren();t=Ta(n)&&n.isEmpty()?null:this.insertParagraph(),a=i[i.length-1];var r=i[0];if(Ta(o=r)&&dt(o)&&!o.isEmpty()&&Ta(n)&&(!n.isEmpty()||"__value"in n&&"__checked"in n)){if(!Ta(n))throw Error("Expected 'firstBlock' to be an ElementNode");n.append(...r.getChildren()),r=i[1]}r&&function(e,t,n){n=n||t.getParentOrThrow().getLastChild();let a=t;for(t=[t];a!==n;){if(!a.getNextSibling())throw Error("insertRangeAfter: lastToInsert must be a later sibling of firstToInsert");a=a.getNextSibling(),t.push(a)}for(let n of t)e=e.insertAfter(n)}(n,r),i=lt(e,dt),t&&Ta(i)&&("__value"in t&&"__checked"in t||dt(a))&&(i.append(...t.getChildren()),t.remove()),Ta(n)&&n.isEmpty()&&n.remove(),e.selectEnd(),_n(e=Ta(n)?n.getLastChild():null)&&i!==n&&e.remove()}else{if(!Ta(n))throw Error("Expected 'firstBlock' to be an ElementNode");a=la(this),n.splice(a,0,e),t.selectEnd()}}var o}insertParagraph(){if("root"===this.anchor.key){var e=za();return Ue().splice(this.anchor.offset,0,[e]),e.select(),e}var t=la(this);if(!Ta(e=lt(this.anchor.getNode(),dt)))throw Error("Expected ancestor to be an ElementNode");return t=(t=e.getChildAtIndex(t))?[t,...t.getNextSiblings()]:[],(e=e.insertNewAfter(this,!1))?(e.append(...t),e.selectStart(),e):null}insertLineBreak(e){var t=mn();this.insertNodes([t]),e&&(e=t.getParentOrThrow(),t=t.getIndexWithinParent(),e.select(t,t))}extract(){var e=this.getNodes(),t=e.length,n=t-1,a=this.anchor;let i=this.focus;var r=e[0];let o=e[n],[s,c]=Qn(this);return 0===t?[]:1===t?kn(r)&&!this.isCollapsed()?(e=s>c?c:s,n=r.splitText(e,s>c?s:c),null!=(e=0===e?n[0]:n[1])?[e]:[]):[r]:(t=a.isBefore(i),kn(r)&&((a=t?s:c)===r.getTextContentSize()?e.shift():0!==a&&([,r]=r.splitText(a),e[0]=r)),kn(o)&&(r=o.getTextContent().length,0===(t=t?c:s)?e.pop():t!==r&&([o]=o.splitText(t),e[n]=o)),e)}modify(e,t,n){var a=this.focus,i=this.anchor,r="move"===e,o=We(a,t);if(Ma(o)&&!o.isIsolated())r&&o.isKeyboardSelectable()?((t=ta()).add(o.__key),Fe(t)):kn(e=t?o.getPreviousSibling():o.getNextSibling())?(o=e.__key,t=t?e.getTextContent().length:0,a.set(o,t,"text"),r&&i.set(o,t,"text")):(n=o.getParentOrThrow(),Ta(e)?(n=e.__key,o=t?e.getChildrenSize():0):(o=o.getIndexWithinParent(),n=n.__key,t||o++),a.set(n,o,"element"),r&&i.set(n,o,"element"));else if(a=ot((i=Sa())._window)){var s=i._blockCursorElement,c=i._rootElement;if(null===c||null===s||!Ta(o)||o.isInline()||o.canBeEmpty()||rt(s,i,c),a.modify(e,t?"backward":"forward",n),0<a.rangeCount&&(o=a.getRangeAt(0),i=Ha(i=this.anchor.getNode())?i:$e(i),this.applyDOMRange(o),this.dirty=!0,!r)){for(r=this.getNodes(),e=[],n=!1,s=0;s<r.length;s++)Xe(c=r[s],i)?e.push(c):n=!0;n&&0<e.length&&(t?Ta(t=e[0])?t.selectStart():t.getParentOrThrow().selectStart():Ta(t=e[e.length-1])?t.selectEnd():t.getParentOrThrow().selectEnd()),a.anchorNode===o.startContainer&&a.anchorOffset===o.startOffset||(t=this.focus,a=(r=this.anchor).key,o=r.offset,i=r.type,Bn(r,t.key,t.offset,t.type),Bn(t,a,o,i),this._cachedNodes=null)}}}deleteCharacter(e){let t=this.isCollapsed();if(this.isCollapsed()){var a=this.anchor,i=this.focus,r=a.getNode();if(!e&&("element"===a.type&&Ta(r)&&a.offset===r.getChildrenSize()||"text"===a.type&&a.offset===r.getTextContentSize())){var o=r.getParent();if(Ta(o=r.getNextSibling()||(null===o?null:o.getNextSibling()))&&o.isShadowRoot())return}if(Ma(o=We(i,e))&&!o.isIsolated())return void(o.isKeyboardSelectable()&&Ta(r)&&0===r.getChildrenSize()?(r.remove(),e=ta(),e.add(o.__key),Fe(e)):(o.remove(),Sa().dispatchCommand(n,void 0)));if(!e&&Ta(o)&&Ta(r)&&r.isEmpty())return r.remove(),void o.selectStart();if(this.modify("extend",e,"character"),this.isCollapsed()){if(e&&0===a.offset&&("element"===a.type?a.getNode():a.getNode().getParentOrThrow()).collapseAtStart(this))return}else{if(o="text"===i.type?i.getNode():null,r="text"===a.type?a.getNode():null,null!==o&&o.isSegmented()){if(a=i.offset,i=o.getTextContentSize(),o.is(r)||e&&a!==i||!e&&0!==a)return void Yn(o,e,a)}else if(null!==r&&r.isSegmented()&&(a=a.offset,i=r.getTextContentSize(),r.is(o)||e&&0!==a||!e&&a!==i))return void Yn(r,e,a);if(r=this.anchor,o=this.focus,(a=r.getNode())===(i=o.getNode())&&"text"===r.type&&"text"===o.type){var s=r.offset,c=o.offset;let t=s<c;(i=t?s:c)!==(s=(c=t?c:s)-1)&&(Re(a=a.getTextContent().slice(i,c))||(e?o.offset=s:r.offset=s))}}}this.removeText(),e&&!t&&this.isCollapsed()&&"element"===this.anchor.type&&0===this.anchor.offset&&(e=this.anchor.getNode()).isEmpty()&&Ha(e.getParent())&&0===e.getIndexWithinParent()&&e.collapseAtStart(this)}deleteLine(e){this.isCollapsed()&&("text"===this.anchor.type&&this.modify("extend",e,"lineboundary"),0===(e?this.focus:this.anchor).offset&&this.modify("extend",e,"character")),this.removeText()}deleteWord(e){this.isCollapsed()&&this.modify("extend",e,"word"),this.removeText()}}function Wn(e){return e instanceof Vn}function qn(e){let t=e.offset;return"text"===e.type?t:t===(e=e.getNode()).getChildrenSize()?e.getTextContent().length:0}function Qn(e){let t=e.anchor;return e=e.focus,"element"===t.type&&"element"===e.type&&t.key===e.key&&t.offset===e.offset?[0,0]:[qn(t),qn(e)]}function Yn(e,t,n){let a=e.getTextContent().split(/(?=\s)/g),i=a.length,r=0,o=0;for(let e=0;e<i;e++){let s=e===i-1;if(o=r,r+=a[e].length,t&&r===n||r>n||s){a.splice(e,1),s&&(o=void 0);break}}""===(t=a.join("").trim())?e.remove():(e.setTextContent(t),e.select(o,o))}function Jn(e,t,n,a){var i=t;if(1===e.nodeType){let s=!1;var r=e.childNodes,o=r.length;i===o&&(s=!0,i=o-1);let c=r[i];if(o=!1,c===a._blockCursorElement?(c=r[i+1],o=!0):null!==a._blockCursorElement&&i--,kn(a=He(c)))i=s?a.getTextContentSize():0;else{if(null===(r=He(e)))return null;if(Ta(r)?((t=Ta(e=r.getChildAtIndex(i)))&&(t=e.getParent(),t=null===n||null===t||!t.canBeEmpty()||t!==n.getNode()),t&&(null===(n=s?e.getLastDescendant():e.getFirstDescendant())?(r=e,i=0):r=Ta(e=n)?e:e.getParentOrThrow()),kn(e)?(a=e,r=null,i=s?e.getTextContentSize():0):e!==r&&s&&!o&&i++):(i=r.getIndexWithinParent(),i=0===t&&Ma(r)&&He(e)===r?i:i+1,r=r.getParentOrThrow()),Ta(r))return Fn(r.__key,i,"element")}}else a=He(e);return kn(a)?Fn(a.__key,i,"text"):null}function Xn(e,t,n){var a=e.offset,i=e.getNode();0===a?(a=i.getPreviousSibling(),i=i.getParent(),t?(n||!t)&&null===a&&Ta(i)&&i.isInline()&&kn(t=i.getPreviousSibling())&&(e.key=t.__key,e.offset=t.getTextContent().length):Ta(a)&&!n&&a.isInline()?(e.key=a.__key,e.offset=a.getChildrenSize(),e.type="element"):kn(a)&&(e.key=a.__key,e.offset=a.getTextContent().length)):a===i.getTextContent().length&&(a=i.getNextSibling(),i=i.getParent(),t&&Ta(a)&&a.isInline()?(e.key=a.__key,e.offset=0,e.type="element"):(n||t)&&null===a&&Ta(i)&&i.isInline()&&!i.canInsertTextAfter()&&kn(t=i.getNextSibling())&&(e.key=t.__key,e.offset=0))}function Zn(e,t,n){if("text"===e.type&&"text"===t.type){var a=e.isBefore(t);let i=e.is(t);Xn(e,a,i),Xn(t,!a,i),i&&(t.key=e.key,t.offset=e.offset,t.type=e.type),(a=Sa()).isComposing()&&a._compositionKey!==e.key&&zn(n)&&(a=n.anchor,n=n.focus,Bn(e,a.key,a.offset,a.type),Bn(t,n.key,n.offset,n.type))}}function $n(e,t,n,a,i,r){return null!==e&&null!==n&&ye(i,e,n)?null===(t=Jn(e,t,zn(r)?r.anchor:null,i))||null===(a=Jn(n,a,zn(r)?r.focus:null,i))||"element"===t.type&&"element"===a.type&&(e=He(e),n=He(n),Ma(e)&&Ma(n))?null:(Zn(t,a,r),[t,a]):null}function ea(e,t,n,a,i,r){let o=ya();return(e=new Kn(Fn(e,t,i),Fn(n,a,r),0,"")).dirty=!0,o._selection=e}function ta(){return new Vn(new Set)}function na(e,t,n,a){var i=n._window;if(null===i)return null;var r=(i=a||i.event)?i.type:void 0;let o;if(a="selectionchange"===r,i=!re&&(a||"beforeinput"===r||"compositionstart"===r||"compositionend"===r||"click"===r&&i&&3===i.detail||"drop"===r||void 0===r),zn(e)&&!i)return e.clone();if(null===t)return null;if(i=t.anchorNode,r=t.focusNode,o=t.anchorOffset,t=t.focusOffset,a&&zn(e)&&!ye(n,i,r))return e.clone();if(null===(n=$n(i,o,r,t,n,e)))return null;let[s,c]=n;return new Kn(s,c,zn(e)?e.format:0,zn(e)?e.style:"")}function aa(){return ya()._selection}function ia(){return Sa()._editorState._selection}function ra(e,t,n,a=1){var i=e.anchor,r=e.focus,o=i.getNode(),s=r.getNode();if(t.is(o)||t.is(s)){if(o=t.__key,e.isCollapsed())(n<=(t=i.offset)&&0<a||n<t&&0>a)&&(n=Math.max(0,t+a),i.set(o,n,"element"),r.set(o,n,"element"),oa(e));else{let d=e.isBackward();var c=(s=d?r:i).getNode();r=(i=d?i:r).getNode(),t.is(c)&&(n<=(c=s.offset)&&0<a||n<c&&0>a)&&s.set(o,Math.max(0,c+a),"element"),t.is(r)&&(n<=(t=i.offset)&&0<a||n<t&&0>a)&&i.set(o,Math.max(0,t+a),"element")}oa(e)}}function oa(e){var t=e.anchor,n=t.offset;let a=e.focus;var i=a.offset,r=t.getNode(),o=a.getNode();if(e.isCollapsed())Ta(r)&&kn(o=(i=n>=(o=r.getChildrenSize()))?r.getChildAtIndex(o-1):r.getChildAtIndex(n))&&(n=0,i&&(n=o.getTextContentSize()),t.set(o.__key,n,"text"),a.set(o.__key,n,"text"));else{if(Ta(r)){let a=r.getChildrenSize();kn(n=(e=n>=a)?r.getChildAtIndex(a-1):r.getChildAtIndex(n))&&(r=0,e&&(r=n.getTextContentSize()),t.set(n.__key,r,"text"))}Ta(o)&&kn(i=(t=i>=(n=o.getChildrenSize()))?o.getChildAtIndex(n-1):o.getChildAtIndex(i))&&(o=0,t&&(o=i.getTextContentSize()),a.set(i.__key,o,"text"))}}function sa(e,t,n,a,i){let r=null,o=0,s=null;null!==a?(r=a.__key,kn(a)?(o=a.getTextContentSize(),s="text"):Ta(a)&&(o=a.getChildrenSize(),s="element")):null!==i&&(r=i.__key,kn(i)?s="text":Ta(i)&&(s="element")),null!==r&&null!==s?e.set(r,o,s):(o=t.getIndexWithinParent(),-1===o&&(o=n.getChildrenSize()),e.set(n.__key,o,"element"))}function ca(e,t,n,a,i){"text"===e.type?(e.key=n,t||(e.offset+=i)):e.offset>a.getIndexWithinParent()&&--e.offset}function da(e){e instanceof Wa||(e instanceof un?qa(e=st(e,qa))||R(114):qa(e=st(e.getNode(),qa))||R(114));let t=e.getParent();Xa(t)||R(115);let n=t.getParent();return Ya(n)||R(116),[e,t,n]}function la(e){e.isCollapsed()||e.removeText();var t=e.anchor;for(e=t.getNode(),t=t.offset;!dt(e);)[e,t]=ua(e,t);return t}function ua(e,t){var n=e.getParent();if(!n)return n=za(),Ue().append(n),n.select(),[Ue(),0];if(kn(e)){var a=e.splitText(t);return 0===a.length?[n,e.getIndexWithinParent()]:(e=0===t?0:1,[n,e=a[0].getIndexWithinParent()+e])}return Ta(e)&&0!==t?((a=e.getChildAtIndex(t))&&(t=new Kn(Fn(e.__key,t,"element"),Fn(e.__key,t,"element"),0,""),(t=e.insertNewAfter(t))&&t.append(a,...a.getNextSiblings())),[n,e.getIndexWithinParent()+1]):[n,e.getIndexWithinParent()]}let fa=null,pa=null,ma=!1,_a=!1,ha=0,ba={characterData:!0,childList:!0,subtree:!0};function ga(){return ma||null!==fa&&fa._readOnly}function va(){ma&&R(13)}function ya(){return null===fa&&R(15),fa}function Sa(){return null===pa&&R(16),pa}function Da(e,t,n){var a=t.__type;let i=e._nodes.get(a);for(void 0===i&&R(30,a),void 0===(e=n.get(a))&&(e=Array.from(i.transforms),n.set(a,e)),n=e.length,a=0;a<n&&(e[a](t),t.isAttached());a++);}function Ia(e,t){var n=e.type,a=t.get(n);if(void 0===a&&R(17,n),n=a.klass,e.type!==n.getType()&&R(18,n.name),n=n.importJSON(e),e=e.children,Ta(n)&&Array.isArray(e))for(a=0;a<e.length;a++){let i=Ia(e[a],t);n.append(i)}return n}function xa(e,t){let n=fa,a=ma,i=pa;fa=e,ma=!0,pa=null;try{return t()}finally{fa=n,ma=a,pa=i}}function Ca(e,t){let a=e._pendingEditorState,i=e._rootElement,r=e._headless||null===i;if(null!==a){var o=e._editorState,s=o._selection,c=a._selection,d=0!==e._dirtyType,l=fa,u=ma,f=pa,p=e._updating,m=e._observer,_=null;if(e._pendingEditorState=null,e._editorState=a,!r&&d&&null!==m){pa=e,fa=a,ma=!1,e._updating=!0;try{let t=e._dirtyType,n=e._dirtyElements,r=e._dirtyLeaves;m.disconnect();var h=n,b=r;It=xt=Dt="",Ct=2===t,wt=null,pt=e,ft=e._config,mt=e._nodes,_t=pt._listeners.mutation,ht=h,bt=b,gt=o._nodeMap,vt=a._nodeMap,Ot=a._readOnly,yt=new Map(e._keyToDOMMap);let s=new Map;St=s,Nt("root",null),St=yt=ft=vt=gt=bt=ht=mt=pt=void 0,_=s}catch(t){if(t instanceof Error&&e._onError(t),_a)throw t;return Ga(e,null,i,a),ue(e),e._dirtyType=2,_a=!0,Ca(e,o),void(_a=!1)}finally{m.observe(i,ba),e._updating=p,fa=l,ma=u,pa=f}}a._readOnly||(a._readOnly=!0);var g=e._dirtyLeaves,v=e._dirtyElements,y=e._normalizedNodes,S=e._updateTags,D=e._deferred;d&&(e._dirtyType=0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements=new Map,e._normalizedNodes=new Set,e._updateTags=new Set);var I,x=e._decorators,C=e._pendingDecorators||x,O=a._nodeMap;for(I in C)O.has(I)||(C===x&&(C=Pe(e)),delete C[I]);var w=r?null:ot(e._window);if(e._editable&&null!==w&&(d||null===c||c.dirty)){pa=e,fa=a;try{if(null!==m&&m.disconnect(),d||null===c||c.dirty){let t=e._blockCursorElement;null!==t&&rt(t,e,i);e:{let t=w.anchorNode,n=w.focusNode,a=w.anchorOffset,r=w.focusOffset,o=document.activeElement;if(!(S.has("collaboration")&&o!==i||null!==o&&ve(o)))if(zn(c)){var E=c.anchor,A=c.focus,L=E.key,k=A.key,M=Ye(e,L),P=Ye(e,k),T=E.offset,U=A.offset,F=c.format,H=c.style,R=c.isCollapsed(),N=M,B=P,j=!1;if("text"===E.type){N=Ie(M);let e=E.getNode();j=e.getFormat()!==F||e.getStyle()!==H}else zn(s)&&"text"===s.anchor.type&&(j=!0);if("text"===A.type&&(B=Ie(P)),null!==N&&null!==B){if(R&&(null===s||j||zn(s)&&(s.format!==F||s.style!==H))){var V=performance.now();en=[F,H,T,L,V]}if(a===T&&r===U&&t===N&&n===B&&("Range"!==w.type||!R)&&(null!==o&&i.contains(o)||i.focus({preventScroll:!0}),"element"!==E.type))break e;try{w.setBaseAndExtent(N,T,B,U)}catch(e){}if(!S.has("skip-scroll-into-view")&&c.isCollapsed()&&null!==i&&i===document.activeElement){let t=c instanceof Kn&&"element"===c.anchor.type?N.childNodes[T]||null:0<w.rangeCount?w.getRangeAt(0):null;if(null!==t){let n;if(t instanceof Text){let e=document.createRange();e.selectNode(t),n=e.getBoundingClientRect()}else n=t.getBoundingClientRect();let a=i.ownerDocument,r=a.defaultView;if(null!==r)for(var z,G,{top:K,bottom:W}=n,q=i;null!==q;){let t=q===a.body;if(t)z=0,G=Ze(e).innerHeight;else{let e=q.getBoundingClientRect();z=e.top,G=e.bottom}let n=0;if(K<z?n=-(z-K):W>G&&(n=W-G),0!==n)if(t)r.scrollBy(0,n);else{let e=q.scrollTop;q.scrollTop+=n;let t=q.scrollTop-e;K-=t,W-=t}if(t)break;q=Je(q)}}}Jt=!0}}else null!==s&&ye(e,t,n)&&w.removeAllRanges()}}e:{let t=e._blockCursorElement;if(zn(c)&&c.isCollapsed()&&"element"===c.anchor.type&&i.contains(document.activeElement)){let n=c.anchor,a=n.getNode(),r=n.offset,o=a.getChildrenSize(),s=!1,d=null;if(r===o)it(a.getChildAtIndex(r-1))&&(s=!0);else{let t=a.getChildAtIndex(r);if(it(t)){let n=t.getPreviousSibling();(null===n||it(n))&&(s=!0,d=e.getElementByKey(t.__key))}}if(s){let n=e.getElementByKey(a.__key);if(null===t){let n=e._config.theme,a=document.createElement("div");a.contentEditable="false",a.setAttribute("data-lexical-cursor","true");let i=n.blockCursor;if(void 0!==i){if("string"==typeof i){let e=i.split(" ");i=n.blockCursor=e}void 0!==i&&a.classList.add(...i)}e._blockCursorElement=t=a}i.style.caretColor="transparent",null===d?n.appendChild(t):n.insertBefore(t,d);break e}}null!==t&&rt(t,e,i)}null!==m&&m.observe(i,ba)}finally{pa=f,fa=l}}if(null!==_){var Q=_;let t=Array.from(e._listeners.mutation),n=t.length;for(let e=0;e<n;e++){let[n,a]=t[e],i=Q.get(a);void 0!==i&&n(i,{dirtyLeaves:g,prevEditorState:o,updateTags:S})}}zn(c)||null===c||null!==s&&s.is(c)||e.dispatchCommand(n,void 0);var Y=e._pendingDecorators;null!==Y&&(e._decorators=Y,e._pendingDecorators=null,Oa("decorator",e,!0,Y));var J=Te(t||o),X=Te(a);if(J!==X&&Oa("textcontent",e,!0,X),Oa("update",e,!0,{dirtyElements:v,dirtyLeaves:g,editorState:a,normalizedNodes:y,prevEditorState:t||o,tags:S}),e._deferred=[],0!==D.length){let t=e._updating;e._updating=!0;try{for(let e=0;e<D.length;e++)D[e]()}finally{e._updating=t}}var Z=e._updates;if(0!==Z.length){let t=Z.shift();if(t){let[n,a]=t;Aa(e,n,a)}}}}function Oa(e,t,n,...a){let i=t._updating;t._updating=n;try{let n=Array.from(t._listeners[e]);for(e=0;e<n.length;e++)n[e].apply(null,a)}finally{t._updating=i}}function wa(e,t,n){if(!1===e._updating||pa!==e){let a=!1;return e.update(()=>{a=wa(e,t,n)}),a}let a=Ne(e);for(let r=4;0<=r;r--)for(let o=0;o<a.length;o++){var i=a[o]._commands.get(t);if(void 0!==i&&void 0!==(i=i[r])){let t=(i=Array.from(i)).length;for(let a=0;a<t;a++)if(!0===i[a](n,e))return!0}}return!1}function Ea(e,t){let n=e._updates;for(t=t||!1;0!==n.length;){var a=n.shift();if(a){let n,[i,r]=a;void 0!==r&&(a=r.onUpdate,n=r.tag,r.skipTransforms&&(t=!0),a&&e._deferred.push(a),n&&e._updateTags.add(n)),i()}}return t}function Aa(e,t,n){let a=e._updateTags;var i,r=i=!1;if(void 0!==n){var o=n.onUpdate;null!=(i=n.tag)&&a.add(i),i=n.skipTransforms||!1,r=n.discrete||!1}o&&e._deferred.push(o),n=e._editorState;let s=!1;(null===(o=e._pendingEditorState)||o._readOnly)&&(o=e._pendingEditorState=new Ba(new Map((o||n)._nodeMap)),s=!0),o._flushSync=r,r=fa;let c=ma,d=pa,l=e._updating;fa=o,ma=!1,e._updating=!0,pa=e;try{s&&(e._headless?null!=n._selection&&(o._selection=n._selection.clone()):o._selection=function(e){let t=e.getEditorState()._selection,n=ot(e._window);return zn(t)||null==t?na(t,n,e,null):t.clone()}(e));let a=e._compositionKey;t(),i=Ea(e,i),function(e,t){if(t=t.getEditorState()._selection,zn(e=e._selection)){var n=e.anchor;let a,i=e.focus;"text"===n.type&&(a=n.getNode(),a.selectionTransform(t,e)),"text"===i.type&&a!==(n=i.getNode())&&n.selectionTransform(t,e)}}(o,e),0!==e._dirtyType&&(i?function(e,t){t=t._dirtyLeaves,e=e._nodeMap;for(let n of t)kn(t=e.get(n))&&t.isAttached()&&t.isSimpleText()&&!t.isUnmergeable()&&me(t)}(o,e):function(e,t){let n=t._dirtyLeaves,a=t._dirtyElements;e=e._nodeMap;let i=Ae(),r=new Map;var o=n;let s=o.size;for(var c=a,d=c.size;0<s||0<d;){if(0<s){t._dirtyLeaves=new Set;for(let a of o)kn(o=e.get(a))&&o.isAttached()&&o.isSimpleText()&&!o.isUnmergeable()&&me(o),void 0!==o&&void 0!==o&&o.__key!==i&&o.isAttached()&&Da(t,o,r),n.add(a);if(s=(o=t._dirtyLeaves).size,0<s){ha++;continue}}t._dirtyLeaves=new Set,t._dirtyElements=new Map;for(let n of c)c=n[0],d=n[1],("root"===c||d)&&(void 0!==(o=e.get(c))&&void 0!==o&&o.__key!==i&&o.isAttached()&&Da(t,o,r),a.set(c,d));s=(o=t._dirtyLeaves).size,d=(c=t._dirtyElements).size,ha++}t._dirtyLeaves=n,t._dirtyElements=a}(o,e),Ea(e),function(e,t,n,a){e=e._nodeMap,t=t._nodeMap;let i=[];for(let[n]of a){let r=t.get(n);void 0===r||r.isAttached()||(Ta(r)&&ut(r,n,e,t,i,a),e.has(n)||a.delete(n),i.push(n))}for(let e of i)t.delete(e);for(let i of n)void 0===(a=t.get(i))||a.isAttached()||(e.has(i)||n.delete(i),t.delete(i))}(n,o,e._dirtyLeaves,e._dirtyElements)),a!==e._compositionKey&&(o._flushSync=!0);let u=o._selection;if(zn(u)){let e=o._nodeMap,t=u.focus.key;void 0!==e.get(u.anchor.key)&&void 0!==e.get(t)||R(19)}else Wn(u)&&0===u._nodes.size&&(o._selection=null)}catch(t){return t instanceof Error&&e._onError(t),e._pendingEditorState=n,e._dirtyType=2,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),void Ca(e)}finally{fa=r,ma=c,pa=d,e._updating=l,ha=0}0!==e._dirtyType||function(e,t){if(t=t.getEditorState()._selection,null!==(e=e._selection)){if(e.dirty||!e.is(t))return!0}else if(null!==t)return!0;return!1}(o,e)?o._flushSync?(o._flushSync=!1,Ca(e)):s&&ge(()=>{Ca(e)}):(o._flushSync=!1,s&&(a.clear(),e._deferred=[],e._pendingEditorState=null))}function La(e,t,n){e._updating?e._updates.push([t,n]):Aa(e,t,n)}class ka extends un{constructor(e){super(e)}decorate(){R(47)}isIsolated(){return!1}isInline(){return!0}isKeyboardSelectable(){return!0}}function Ma(e){return e instanceof ka}class Pa extends un{constructor(e){super(e),this.__last=this.__first=null,this.__indent=this.__format=this.__size=0,this.__dir=null}getFormat(){return this.getLatest().__format}getFormatType(){let e=this.getFormat();return ne[e]||""}getIndent(){return this.getLatest().__indent}getChildren(){let e=[],t=this.getFirstChild();for(;null!==t;)e.push(t),t=t.getNextSibling();return e}getChildrenKeys(){let e=[],t=this.getFirstChild();for(;null!==t;)e.push(t.__key),t=t.getNextSibling();return e}getChildrenSize(){return this.getLatest().__size}isEmpty(){return 0===this.getChildrenSize()}isDirty(){let e=Sa()._dirtyElements;return null!==e&&e.has(this.__key)}isLastChild(){let e=this.getLatest(),t=this.getParentOrThrow().getLastChild();return null!==t&&t.is(e)}getAllTextNodes(){let e=[],t=this.getFirstChild();for(;null!==t;){if(kn(t)&&e.push(t),Ta(t)){let n=t.getAllTextNodes();e.push(...n)}t=t.getNextSibling()}return e}getFirstDescendant(){let e=this.getFirstChild();for(;null!==e;){if(Ta(e)){let t=e.getFirstChild();if(null!==t){e=t;continue}}break}return e}getLastDescendant(){let e=this.getLastChild();for(;null!==e;){if(Ta(e)){let t=e.getLastChild();if(null!==t){e=t;continue}}break}return e}getDescendantByIndex(e){let t=this.getChildren(),n=t.length;return e>=n?Ta(e=t[n-1])&&e.getLastDescendant()||e||null:Ta(e=t[e])&&e.getFirstDescendant()||e||null}getFirstChild(){let e=this.getLatest().__first;return null===e?null:Le(e)}getFirstChildOrThrow(){let e=this.getFirstChild();return null===e&&R(45,this.__key),e}getLastChild(){let e=this.getLatest().__last;return null===e?null:Le(e)}getLastChildOrThrow(){let e=this.getLastChild();return null===e&&R(96,this.__key),e}getChildAtIndex(e){var t=this.getChildrenSize();let n;if(e<t/2){for(n=this.getFirstChild(),t=0;null!==n&&t<=e;){if(t===e)return n;n=n.getNextSibling(),t++}return null}for(n=this.getLastChild(),--t;null!==n&&t>=e;){if(t===e)return n;n=n.getPreviousSibling(),t--}return null}getTextContent(){let e="",t=this.getChildren(),n=t.length;for(let a=0;a<n;a++){let i=t[a];e+=i.getTextContent(),Ta(i)&&a!==n-1&&!i.isInline()&&(e+="\n\n")}return e}getTextContentSize(){let e=0,t=this.getChildren(),n=t.length;for(let a=0;a<n;a++){let i=t[a];e+=i.getTextContentSize(),Ta(i)&&a!==n-1&&!i.isInline()&&(e+=2)}return e}getDirection(){return this.getLatest().__dir}hasFormat(e){return""!==e&&(e=te[e],0!=(this.getFormat()&e))}select(e,t){va();let n=aa(),a=e,i=t;var r=this.getChildrenSize();if(!this.canBeEmpty())if(0===e&&0===t){if(kn(e=this.getFirstChild())||Ta(e))return e.select(0,0)}else if(!(void 0!==e&&e!==r||void 0!==t&&t!==r)&&(kn(e=this.getLastChild())||Ta(e)))return e.select();return void 0===a&&(a=r),void 0===i&&(i=r),r=this.__key,zn(n)?(n.anchor.set(r,a,"element"),n.focus.set(r,i,"element"),n.dirty=!0,n):ea(r,a,r,i,"element","element")}selectStart(){let e=this.getFirstDescendant();return e?e.selectStart():this.select()}selectEnd(){let e=this.getLastDescendant();return e?e.selectEnd():this.select()}clear(){let e=this.getWritable();return this.getChildren().forEach(e=>e.remove()),e}append(...e){return this.splice(this.getChildrenSize(),0,e)}setDirection(e){let t=this.getWritable();return t.__dir=e,t}setFormat(e){return this.getWritable().__format=""!==e?te[e]:0,this}setIndent(e){return this.getWritable().__indent=e,this}splice(e,t,n){let a=n.length,i=this.getChildrenSize(),r=this.getWritable(),o=r.__key;var s=[],c=[];let d=this.getChildAtIndex(e+t),l=null,u=i-t+a;if(0!==e)if(e===i)l=this.getLastChild();else{var f=this.getChildAtIndex(e);null!==f&&(l=f.getPreviousSibling())}if(0<t){var p=null===l?this.getFirstChild():l.getNextSibling();for(f=0;f<t;f++){null===p&&R(100);var m=p.getNextSibling(),_=p.__key;Oe(p=p.getWritable()),c.push(_),p=m}}for(f=l,m=0;m<a;m++){_=n[m],null!==f&&_.is(f)&&(l=f=f.getPreviousSibling()),(p=_.getWritable()).__parent===o&&u--,Oe(p);let e=_.__key;null===f?(r.__first=e,p.__prev=null):((f=f.getWritable()).__next=e,p.__prev=f.__key),_.__key===o&&R(76),p.__parent=o,s.push(e),f=_}if(e+t===i?null!==f&&(f.getWritable().__next=null,r.__last=f.__key):null!==d&&(e=d.getWritable(),null!==f?(t=f.getWritable(),e.__prev=f.__key,t.__next=d.__key):e.__prev=null),r.__size=u,c.length&&zn(e=aa())){c=new Set(c),s=new Set(s);let{anchor:t,focus:n}=e;Ua(t,c,s)&&sa(t,t.getNode(),this,l,d),Ua(n,c,s)&&sa(n,n.getNode(),this,l,d),0!==u||this.canBeEmpty()||et(this)||this.remove()}return r}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"element",version:1}}insertNewAfter(){return null}canIndent(){return!0}collapseAtStart(){return!1}excludeFromCopy(){return!1}canExtractContents(){return!0}canReplaceWith(){return!0}canInsertAfter(){return!0}canBeEmpty(){return!0}canInsertTextBefore(){return!0}canInsertTextAfter(){return!0}isInline(){return!1}isShadowRoot(){return!1}canMergeWith(){return!1}extractWithChild(){return!1}}function Ta(e){return e instanceof Pa}function Ua(e,t,n){for(e=e.getNode();e;){let a=e.__key;if(t.has(a)&&!n.has(a))return!0;e=e.getParent()}return!1}class Fa extends Pa{static getType(){return"root"}static clone(){return new Fa}constructor(){super("root"),this.__cachedText=null}getTopLevelElementOrThrow(){R(51)}getTextContent(){let e=this.__cachedText;return!ga()&&0!==Sa()._dirtyType||null===e?super.getTextContent():e}remove(){R(52)}replace(){R(53)}insertBefore(){R(54)}insertAfter(){R(55)}updateDOM(){return!1}append(...e){for(let t=0;t<e.length;t++){let n=e[t];Ta(n)||Ma(n)||R(56)}return super.append(...e)}static importJSON(e){let t=Ue();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{children:[],direction:this.getDirection(),format:this.getFormatType(),indent:this.getIndent(),type:"root",version:1}}collapseAtStart(){return!0}}function Ha(e){return e instanceof Fa}function Ra(){return new Ba(new Map([["root",new Fa]]))}function Na(e){let t=e.exportJSON();var n=e.constructor;if(t.type!==n.getType()&&R(130,n.name),Ta(e)){let a=t.children;for(Array.isArray(a)||R(59,n.name),e=e.getChildren(),n=0;n<e.length;n++){let t=Na(e[n]);a.push(t)}}return t}class Ba{constructor(e,t){this._nodeMap=e,this._selection=t||null,this._readOnly=this._flushSync=!1}isEmpty(){return 1===this._nodeMap.size&&null===this._selection}read(e){return xa(this,e)}clone(e){return(e=new Ba(this._nodeMap,void 0===e?this._selection:e))._readOnly=!0,e}toJSON(){return xa(this,()=>({root:Na(Ue())}))}}class ja extends Pa{static getType(){return"paragraph"}static clone(e){return new ja(e.__key)}createDOM(e){let t=document.createElement("p");return void 0!==(e=ze(e.theme,"paragraph"))&&t.classList.add(...e),t}updateDOM(){return!1}static importDOM(){return{p:()=>({conversion:Va,priority:0})}}exportDOM(e){if(({element:e}=super.exportDOM(e)),e&&ct(e)){this.isEmpty()&&e.append(document.createElement("br"));var t=this.getFormatType();e.style.textAlign=t,(t=this.getDirection())&&(e.dir=t),0<(t=this.getIndent())&&(e.style.textIndent=20*t+"px")}return{element:e}}static importJSON(e){let t=za();return t.setFormat(e.format),t.setIndent(e.indent),t.setDirection(e.direction),t}exportJSON(){return{...super.exportJSON(),type:"paragraph",version:1}}insertNewAfter(e,t){e=za();let n=this.getDirection();return e.setDirection(n),this.insertAfter(e,t),e}collapseAtStart(){let e=this.getChildren();if(0===e.length||kn(e[0])&&""===e[0].getTextContent().trim()){if(null!==this.getNextSibling())return this.selectNext(),this.remove(),!0;if(null!==this.getPreviousSibling())return this.selectPrevious(),this.remove(),!0}return!1}}function Va(e){let t=za();return e.style&&(t.setFormat(e.style.textAlign),0<(e=parseInt(e.style.textIndent,10)/20)&&t.setIndent(e)),{node:t}}function za(){return nt(new ja)}function Ga(e,t,n,a){let i=e._keyToDOMMap;i.clear(),e._editorState=Ra(),e._pendingEditorState=a,e._compositionKey=null,e._dirtyType=0,e._cloneNotNeeded.clear(),e._dirtyLeaves=new Set,e._dirtyElements.clear(),e._normalizedNodes=new Set,e._updateTags=new Set,e._updates=[],e._blockCursorElement=null,null!==(a=e._observer)&&(a.disconnect(),e._observer=null),null!==t&&(t.textContent=""),null!==n&&(n.textContent="",i.set("root",n))}class Ka{constructor(e,t,n,a,i,r,o){this._parentEditor=t,this._rootElement=null,this._editorState=e,this._compositionKey=this._pendingEditorState=null,this._deferred=[],this._keyToDOMMap=new Map,this._updates=[],this._updating=!1,this._listeners={decorator:new Set,editable:new Set,mutation:new Map,root:new Set,textcontent:new Set,update:new Set},this._commands=new Map,this._config=a,this._nodes=n,this._decorators={},this._pendingDecorators=null,this._dirtyType=0,this._cloneNotNeeded=new Set,this._dirtyLeaves=new Set,this._dirtyElements=new Map,this._normalizedNodes=new Set,this._updateTags=new Set,this._observer=null,this._key=Be(),this._onError=i,this._htmlConversions=r,this._editable=o,this._headless=null!==t&&t._headless,this._blockCursorElement=this._window=null}isComposing(){return null!=this._compositionKey}registerUpdateListener(e){let t=this._listeners.update;return t.add(e),()=>{t.delete(e)}}registerEditableListener(e){let t=this._listeners.editable;return t.add(e),()=>{t.delete(e)}}registerDecoratorListener(e){let t=this._listeners.decorator;return t.add(e),()=>{t.delete(e)}}registerTextContentListener(e){let t=this._listeners.textcontent;return t.add(e),()=>{t.delete(e)}}registerRootListener(e){let t=this._listeners.root;return e(this._rootElement,null),t.add(e),()=>{e(null,this._rootElement),t.delete(e)}}registerCommand(e,t,n){void 0===n&&R(35);let a=this._commands;a.has(e)||a.set(e,[new Set,new Set,new Set,new Set,new Set]);let i=a.get(e);void 0===i&&R(36,String(e));let r=i[n];return r.add(t),()=>{r.delete(t),i.every(e=>0===e.size)&&a.delete(e)}}registerMutationListener(e,t){void 0===this._nodes.get(e.getType())&&R(37,e.name);let n=this._listeners.mutation;return n.set(t,e),()=>{n.delete(t)}}registerNodeTransformToKlass(e,t){var n=e.getType();return void 0===(n=this._nodes.get(n))&&R(37,e.name),n.transforms.add(t),n}registerNodeTransform(e,t){var n=this.registerNodeTransformToKlass(e,t);let a=[n];return null!=(n=n.replaceWithKlass)&&(n=this.registerNodeTransformToKlass(n,t),a.push(n)),function(e,t){La(e,()=>{var e=ya();if(!e.isEmpty())if("root"===t)Ue().markDirty();else{e=e._nodeMap;for(let[,t]of e)t.markDirty()}},null===e._pendingEditorState?{tag:"history-merge"}:void 0)}(this,e.getType()),()=>{a.forEach(e=>e.transforms.delete(t))}}hasNode(e){return this._nodes.has(e.getType())}hasNodes(e){return e.every(this.hasNode.bind(this))}dispatchCommand(e,t){return wa(this,e,t)}getDecorators(){return this._decorators}getRootElement(){return this._rootElement}getKey(){return this._key}setRootElement(e){let t=this._rootElement;if(e!==t){let r=ze(this._config.theme,"root");var n=this._pendingEditorState||this._editorState;if(this._rootElement=e,Ga(this,t,e,n),null!==t){if(!this._config.disableEvents){0!==Yt&&(Yt--,0===Yt&&t.ownerDocument.removeEventListener("selectionchange",dn));var a=t.__lexicalEditor;if(null!=a){if(null!==a._parentEditor){var i=Ne(a);i=i[i.length-1]._key,cn.get(i)===a&&cn.delete(i)}else cn.delete(a._key);t.__lexicalEditor=null}for(a=sn(t),i=0;i<a.length;i++)a[i]();t.__lexicalEventHandles=[]}null!=r&&t.classList.remove(...r)}null!==e?(n=(n=e.ownerDocument)&&n.defaultView||null,(a=e.style).userSelect="text",a.whiteSpace="pre-wrap",a.wordBreak="break-word",e.setAttribute("data-lexical-editor","true"),this._window=n,this._dirtyType=2,ue(this),this._updateTags.add("history-merge"),Ca(this),this._config.disableEvents||function(e,t){0===Yt&&e.ownerDocument.addEventListener("selectionchange",dn),Yt++,e.__lexicalEditor=t;let n=sn(e);for(let a=0;a<Gt.length;a++){let[i,r]=Gt[a],o="function"==typeof r?e=>{!0!==e._lexicalHandled&&(e._lexicalHandled=!0,t.isEditable()&&r(e,t))}:e=>{if(!0!==e._lexicalHandled&&(e._lexicalHandled=!0,t.isEditable()))switch(i){case"cut":return wa(t,P,e);case"copy":return wa(t,M,e);case"paste":return wa(t,c,e);case"dragstart":return wa(t,A,e);case"dragover":return wa(t,L,e);case"dragend":return wa(t,k,e);case"focus":return wa(t,U,e);case"blur":return wa(t,F,e);case"drop":return wa(t,E,e)}};e.addEventListener(i,o),n.push(()=>{e.removeEventListener(i,o)})}}(e,this),null!=r&&e.classList.add(...r)):(this._editorState=n,this._window=this._pendingEditorState=null),Oa("root",this,!1,e,t)}}getElementByKey(e){return this._keyToDOMMap.get(e)||null}getEditorState(){return this._editorState}setEditorState(e,t){e.isEmpty()&&R(38),le(this);let n=this._pendingEditorState,a=this._updateTags;t=void 0!==t?t.tag:null,null===n||n.isEmpty()||(null!=t&&a.add(t),Ca(this)),this._pendingEditorState=e,this._dirtyType=2,this._dirtyElements.set("root",!1),this._compositionKey=null,null!=t&&a.add(t),Ca(this)}parseEditorState(e,t){e="string"==typeof e?JSON.parse(e):e;let n=Ra(),a=fa,i=ma,r=pa,o=this._dirtyElements,s=this._dirtyLeaves,c=this._cloneNotNeeded,d=this._dirtyType;this._dirtyElements=new Map,this._dirtyLeaves=new Set,this._cloneNotNeeded=new Set,this._dirtyType=0,fa=n,ma=!1,pa=this;try{Ia(e.root,this._nodes),t&&t(),n._readOnly=!0}catch(e){e instanceof Error&&this._onError(e)}finally{this._dirtyElements=o,this._dirtyLeaves=s,this._cloneNotNeeded=c,this._dirtyType=d,fa=a,ma=i,pa=r}return n}update(e,t){La(this,e,t)}focus(e,t={}){let n=this._rootElement;null!==n&&(n.setAttribute("autocapitalize","off"),La(this,()=>{let e=aa(),n=Ue();null!==e?e.dirty=!0:0!==n.getChildrenSize()&&("rootStart"===t.defaultSelection?n.selectStart():n.selectEnd())},{onUpdate:()=>{n.removeAttribute("autocapitalize"),e&&e()},tag:"focus"}),null===this._pendingEditorState&&n.removeAttribute("autocapitalize"))}blur(){var e=this._rootElement;null!==e&&e.blur(),null!==(e=ot(this._window))&&e.removeAllRanges()}isEditable(){return this._editable}setEditable(e){this._editable!==e&&(this._editable=e,Oa("editable",this,!0,e))}toJSON(){return{editorState:this._editorState.toJSON()}}}class Wa extends Pa{constructor(e,t){super(t),this.__colSpan=e,this.__rowSpan=1}exportJSON(){return{...super.exportJSON(),colSpan:this.__colSpan,rowSpan:this.__rowSpan}}getColSpan(){return this.__colSpan}setColSpan(e){return this.getWritable().__colSpan=e,this}getRowSpan(){return this.__rowSpan}setRowSpan(e){return this.getWritable().__rowSpan=e,this}}function qa(e){return e instanceof Wa}class Qa extends Pa{}function Ya(e){return e instanceof Qa}class Ja extends Pa{}function Xa(e){return e instanceof Ja}t.$INTERNAL_isPointSelection=Gn,t.$addUpdateTag=function(e){va(),Sa()._updateTags.add(e)},t.$applyNodeReplacement=nt,t.$copyNode=tt,t.$createLineBreakNode=mn,t.$createNodeSelection=ta,t.$createParagraphNode=za,t.$createPoint=Fn,t.$createRangeSelection=function(){let e=Fn("root",0,"element"),t=Fn("root",0,"element");return new Kn(e,t,0,"")},t.$createTabNode=Pn,t.$createTextNode=Ln,t.$getAdjacentNode=We,t.$getNearestNodeFromDOMNode=Me,t.$getNearestRootOrShadowRoot=$e,t.$getNodeByKey=Le,t.$getPreviousSelection=ia,t.$getRoot=Ue,t.$getSelection=aa,t.$getTextContent=function(){let e=aa();return null===e?"":e.getTextContent()},t.$hasAncestor=Xe,t.$hasUpdateTag=function(e){return Sa()._updateTags.has(e)},t.$insertNodes=function(e){let t=aa()||ia();null===t&&(t=Ue().selectEnd()),t.insertNodes(e)},t.$isBlockElementNode=function(e){return Ta(e)&&!e.isInline()},t.$isDecoratorNode=Ma,t.$isElementNode=Ta,t.$isInlineElementOrDecoratorNode=function(e){return Ta(e)&&e.isInline()||Ma(e)&&e.isInline()},t.$isLeafNode=function(e){return kn(e)||_n(e)||Ma(e)},t.$isLineBreakNode=_n,t.$isNodeSelection=Wn,t.$isParagraphNode=function(e){return e instanceof ja},t.$isRangeSelection=zn,t.$isRootNode=Ha,t.$isRootOrShadowRoot=et,t.$isTabNode=Tn,t.$isTextNode=kn,t.$nodesOfType=function(e){var t=ya();let n=t._readOnly,a=e.getType();t=t._nodeMap;let i=[];for(let[,r]of t)r instanceof e&&r.__type===a&&(n||r.isAttached())&&i.push(r);return i},t.$normalizeSelection__EXPERIMENTAL=_e,t.$parseSerializedNode=function(e){return Ia(e,Sa()._nodes)},t.$selectAll=function(){var e=Ue();Fe(_e(e=e.select(0,e.getChildrenSize())))},t.$setCompositionKey=Ee,t.$setSelection=Fe,t.$splitNode=function(e,t){let n=e.getChildAtIndex(t);null==n&&(n=e),et(e)&&R(102);let a=e=>{const t=e.getParentOrThrow(),i=et(t),r=e!==n||i?tt(e):e;if(i){if(!Ta(e)||!Ta(r))throw Error("Children of a root must be ElementNode");return e.insertAfter(r),[e,r,r]}const[o,s,c]=a(t);return e=e.getNextSiblings(),c.append(r,...e),[o,s,r]},[i,r]=a(n);return[i,r]},t.BLUR_COMMAND=F,t.CAN_REDO_COMMAND={},t.CAN_UNDO_COMMAND={},t.CLEAR_EDITOR_COMMAND={},t.CLEAR_HISTORY_COMMAND={},t.CLICK_COMMAND=a,t.COMMAND_PRIORITY_CRITICAL=4,t.COMMAND_PRIORITY_EDITOR=0,t.COMMAND_PRIORITY_HIGH=3,t.COMMAND_PRIORITY_LOW=1,t.COMMAND_PRIORITY_NORMAL=2,t.CONTROLLED_TEXT_INSERTION_COMMAND=s,t.COPY_COMMAND=M,t.CUT_COMMAND=P,t.DELETE_CHARACTER_COMMAND=i,t.DELETE_LINE_COMMAND=u,t.DELETE_WORD_COMMAND=l,t.DEPRECATED_$computeGridMap=function(e,t,n){let a=[],i=null,r=null;e=e.getChildren();for(let l=0;l<e.length;l++){var o=e[l];Xa(o)||R(108);var s=o.getChildren();o=0;for(let e of s){for(qa(e)||R(109);void 0!==a[l]&&void 0!==a[l][o];)o++;var c=o,d=e;let u={cell:d,startColumn:c,startRow:s=l},f=d.__rowSpan,p=d.__colSpan;for(let e=0;e<f;e++){void 0===a[s+e]&&(a[s+e]=[]);for(let t=0;t<p;t++)a[s+e][c+t]=u}t.is(d)&&(i=u),n.is(d)&&(r=u),o+=e.__colSpan}}return null===i&&R(110),null===r&&R(111),[a,i,r]},t.DEPRECATED_$getGridCellNodeRect=function(e){let[t,,n]=da(e),a=(e=n.getChildren()).length;var i=e[0].getChildren().length;let r=Array(a);for(var o=0;o<a;o++)r[o]=Array(i);for(i=0;i<a;i++){o=e[i].getChildren();let n=0;for(let e=0;e<o.length;e++){for(;r[i][n];)n++;let a=o[e],s=a.__rowSpan||1,c=a.__colSpan||1;for(let e=0;e<s;e++)for(let t=0;t<c;t++)r[i+e][n+t]=a;if(t===a)return{colSpan:c,columnIndex:n,rowIndex:i,rowSpan:s};n+=c}}return null},t.DEPRECATED_$getNodeTriplet=da,t.DEPRECATED_$isGridCellNode=qa,t.DEPRECATED_$isGridNode=Ya,t.DEPRECATED_$isGridRowNode=Xa,t.DEPRECATED_GridCellNode=Wa,t.DEPRECATED_GridNode=Qa,t.DEPRECATED_GridRowNode=Ja,t.DRAGEND_COMMAND=k,t.DRAGOVER_COMMAND=L,t.DRAGSTART_COMMAND=A,t.DROP_COMMAND=E,t.DecoratorNode=ka,t.ElementNode=Pa,t.FOCUS_COMMAND=U,t.FORMAT_ELEMENT_COMMAND={},t.FORMAT_TEXT_COMMAND=f,t.INDENT_CONTENT_COMMAND={},t.INSERT_LINE_BREAK_COMMAND=r,t.INSERT_PARAGRAPH_COMMAND=o,t.INSERT_TAB_COMMAND={},t.INTERNAL_PointSelection=jn,t.KEY_ARROW_DOWN_COMMAND=S,t.KEY_ARROW_LEFT_COMMAND=g,t.KEY_ARROW_RIGHT_COMMAND=h,t.KEY_ARROW_UP_COMMAND=y,t.KEY_BACKSPACE_COMMAND=x,t.KEY_DELETE_COMMAND=O,t.KEY_DOWN_COMMAND=_,t.KEY_ENTER_COMMAND=D,t.KEY_ESCAPE_COMMAND=C,t.KEY_MODIFIER_COMMAND=H,t.KEY_SPACE_COMMAND=I,t.KEY_TAB_COMMAND=w,t.LineBreakNode=fn,t.MOVE_TO_END=b,t.MOVE_TO_START=v,t.OUTDENT_CONTENT_COMMAND={},t.PASTE_COMMAND=c,t.ParagraphNode=ja,t.REDO_COMMAND=m,t.REMOVE_TEXT_COMMAND=d,t.RootNode=Fa,t.SELECTION_CHANGE_COMMAND=n,t.SELECTION_INSERT_CLIPBOARD_NODES_COMMAND={},t.SELECT_ALL_COMMAND=T,t.TabNode=Mn,t.TextNode=Sn,t.UNDO_COMMAND=p,t.createCommand=function(){return{}},t.createEditor=function(e){var t=e||{},n=pa,a=t.theme||{};let i=void 0===e?n:t.parentEditor||null,r=t.disableEvents||!1,o=Ra(),s=t.namespace||(null!==i?i._config.namespace:Be()),c=t.editorState,d=[Fa,Sn,fn,Mn,ja,...t.nodes||[]],{onError:l,html:u}=t;if(t=void 0===t.editable||t.editable,void 0===e&&null!==n)e=n._nodes;else for(e=new Map,n=0;n<d.length;n++){let t=d[n],a=null;var f=null;"function"!=typeof t&&(t=(f=t).replace,a=f.with,f=f.withKlass||null);let i=t.getType(),r=t.transform(),o=new Set;null!==r&&o.add(r),e.set(i,{exportDOM:u&&u.export?u.export.get(t):void 0,klass:t,replace:a,replaceWithKlass:f,transforms:o})}return a=new Ka(o,i,e,{disableEvents:r,namespace:s,theme:a},l||console.error,function(e,t){let n=new Map,a=new Set,i=e=>{Object.keys(e).forEach(t=>{let a=n.get(t);void 0===a&&(a=[],n.set(t,a)),a.push(e[t])})};return e.forEach(e=>{null==(e=null!=e.klass.importDOM?e.klass.importDOM.bind(e.klass):null)||a.has(e)||(a.add(e),null!==(e=e())&&i(e))}),t&&i(t),n}(e,u?u.import:void 0),t),void 0!==c&&(a._pendingEditorState=c,a._dirtyType=2),a},t.getNearestEditorFromDOMNode=Se,t.isCurrentlyReadOnlyMode=ga,t.isHTMLAnchorElement=function(e){return ct(e)&&"A"===e.tagName},t.isHTMLElement=ct,t.isSelectionCapturedInDecoratorInput=ve,t.isSelectionWithinEditor=ye}
,4088:(e,t,n)=>{var a=n(6277);e.exports=a.OdspErrorHelper}
,9940:(e,t,n)=>{var a=n(6277);e.exports=a.PairedEventBase}
,6658:e=>{"use strict";e.exports=a},9676:e=>{"use strict";e.exports=o},2207:e=>{"use strict";e.exports=c},1909:e=>{"use strict";e.exports=n},2737:e=>{"use strict";e.exports=r},529:e=>{"use strict";e.exports=d},7408:e=>{"use strict";e.exports=s},6277:e=>{"use strict";e.exports=g},8810:e=>{"use strict";e.exports=i},718:e=>{"use strict";e.exports=w},1717:e=>{"use strict";e.exports=u},7526:e=>{"use strict";e.exports=_},7675:e=>{"use strict";e.exports=I},9843:e=>{"use strict";e.exports=C},5711:e=>{"use strict";e.exports=f},6879:e=>{"use strict";e.exports=M},6321:e=>{"use strict";e.exports=L},216:e=>{"use strict";e.exports=P},5935:e=>{"use strict";e.exports=y},2307:e=>{"use strict";e.exports=v},2323:e=>{"use strict";e.exports=k},3054:e=>{"use strict";e.exports=O},1395:e=>{"use strict";e.exports=h},6794:e=>{"use strict";e.exports=x},5037:e=>{"use strict";e.exports=m},7781:e=>{"use strict";e.exports=S},1723:e=>{"use strict";e.exports=p},1589:e=>{"use strict";e.exports=D},606:e=>{"use strict";e.exports=l},5592:e=>{"use strict";e.exports=E},5959:e=>{"use strict";e.exports=t},8398:e=>{"use strict";e.exports=A},280:e=>{"use strict";e.exports=b}},F={};function H(e){var t=F[e];if(void 0!==t)return t.exports;var n=F[e]={exports:{}};return U[e](n,n.exports,H),n.exports}H.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return H.d(t,{a:t}),t},H.d=(e,t)=>{for(var n in t)H.o(t,n)&&!H.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},H.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),H.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},T=e?e.src:"",H.p=T.slice(0,T.lastIndexOf("/")+1);var R={};return(()=>{"use strict";H.r(R),H.d(R,{AttachmentIconSize:()=>We,AttachmentPicker:()=>Fa,AttachmentPickerTabs:()=>n,AttachmentType:()=>t,Attachments:()=>Ba,AttachmentsIcon:()=>qe,DEFAULT_ATTACHMENT_SENSITIVITY:()=>Ga,FileAttachmentsPicker:()=>xa,MeetingSensitiveLabelDataProvider:()=>Wa,MeetingType:()=>a,PromptInputBox:()=>lr,SensitivityLabel:()=>_a,SensitivityLabelsContextProvider:()=>la,TagPickerAttachments:()=>Qa,TagPickerControlledAttachments:()=>Ya,findSensitivityLabelById:()=>pa,useAttachments:()=>qa,useSensitivityLabel:()=>fa,useSensitivityLabels:()=>ua});var e={};H.r(e),H.d(e,{optionalDiagnostic:()=>jt,requiredDiagnostic:()=>Bt,requiredService:()=>Vt});var t,n,a,i,r={};H.r(r),H.d(r,{indexedDB:()=>_n,localStorage:()=>mn,none:()=>hn}),function(e){e[e.File=0]="File",e[e.Meeting=1]="Meeting",e[e.MeetingSeries=2]="MeetingSeries",e[e.Markdown=3]="Markdown",e[e.Site=4]="Site",e[e.Page=5]="Page",e[e.Unauthorized=6]="Unauthorized",e[e.MessageKey=7]="MessageKey"}(t||(t={})),function(e){e.All="All",e.Files="Files",e.Meetings="Meetings",e.MeetingSeries="Meeting series",e.Sites="Sites",e.Pages="Pages"}(n||(n={})),function(e){e.Occurrence="occurrence",e.Single="single",e.Exception="exception"}(a||(a={})),function(e){e[e.Querying=0]="Querying",e[e.Succeed=1]="Succeed",e[e.Failed=2]="Failed"}(i||(i={}));var o=H(5959),s=H.n(o),c=H(606),d=H(5037);const l=JSON.parse('{"fG":"{0} modified at {1}","UF":"Modified at {0}","gm":"{0} • {1}","Lq":"{0} • {1} • Recorded","q$":"Search","iq":"Load More","nF":"No suggestions available","kz":"You have reached the end","ki":"Clear and try a different search","Xu":"All","p7":"Files","e":"Meetings","iP":"Meeting series","m2":"Sites","L6":"Pages","HT":"Search results","Wi":"Dismiss"}');var u=H(1395),f=H(1723),p=H(1909),m=H(6658);class _{async requestData(e){if(e.searchingContentType!==n.Files)throw new Error(`Invalid search ${e.searchingContentType}`);try{const t=await this._postSearchData(e),n=this._handlePaginationInfo(e,t);return{attachments:this._processSearchedDriveItemData(t,e),nextPaginationInfo:n}}catch(t){return{attachments:[],nextPaginationInfo:e.paginationInfo}}}_handlePaginationInfo(e,t){const{paginationInfo:n}=e;if(null!=t&&null!=t.value&&t.value.length>0&&t.value[0].hitsContainers.length>0&&t.value[0].hitsContainers[0].moreResultsAvailable){const e=n.skip+20;return{...n,skip:e,canLoadMore:!0,isLoading:!1}}return{...n,canLoadMore:!1,isLoading:!1}}_processSearchedDriveItemData(e,n){if(n.abortSignal?.aborted){const e=new Error("action is aborted");throw e.name="AbortError",e}if(0===e.value.length)return[];if(e.value[0].hitsContainers&&0===e.value[0].hitsContainers.length)return[];const a=e.value[0].hitsContainers[0];return a&&0===a.total?[]:a.hits.map(e=>e.resource).map(e=>({type:t.File,id:e.id,name:e.name,sharepointIds:{uniqueId:e.listItem.fields.uniqueId,driveId:e.listItem.fields.driveId,listId:e.listItem.fields.listId,listItemUniqueId:e.listItem.fields.uniqueId,webId:e.listItem.fields.webId,siteId:e.listItem.fields.siteId,webUrl:e.webUrl},extension:e.name?.split(".")?.pop()||"",createdBy:e.createdBy,createdDateTime:e.createdDateTime,lastModifiedBy:e.lastModifiedBy,lastModifiedDateTime:e.lastModifiedDateTime}))}_postSearchData(e){const t=this._buildPostBody(e);return this._graphClientPromise.then(e=>e.api("search/query").responseType(m.ResponseType.JSON).post(t))}_buildPostBody(e){const{queryString:t,extensions:n,ignoredAttachmentsIds:a,paginationInfo:i}=e,r=["({searchterms})"];if(n.length>0){const e=n.map(e=>`FileExtension:${e}`).join(" OR ");r.push(`(${e})`)}if(a.length>0){const e=a.filter(e=>!!e).map(e=>`NOT(UniqueId:${e})`).join(" AND ");r.push(`(${e})`)}return JSON.stringify({requests:[{entityTypes:["driveItem"],query:{queryString:t,queryTemplate:r.join(" AND ")},from:i.skip,size:20,fields:["id","name","webUrl","uniqueId","driveId","listId","listItemId","webId","siteId","createdBy","createdDateTime","lastModifiedBy","lastModifiedDateTime"]}]})}constructor(e){this._graphClientFactory=e.consume(p.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}}const h="sp-pages-content-panel-search-box-dropdown-option";var b=H(8810);const g=(e,t)=>((t=t||new Date).setDate(t.getDate()+e),t.setHours(0,0,0,0),t),v=e=>{const t=e.match(/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})/);return t?t[0]+"Z":e},y=(e,t)=>{const n=new Date(v(e)),a=new Date(v(t));return`${(0,b.getFriendlyDateStringPast)(n,b.Locale.language)} ${(0,b.toLocaleTimeString)(n,{hour:"numeric",minute:"numeric",hour12:!0},!0)} - ${(0,b.toLocaleTimeString)(a,{hour:"numeric",minute:"numeric",hour12:!0},!0)}`},S=(e,t)=>{const n=(0,b.getHumanizedDateTimeStringPast)(new Date(v(e)),!1,b.Locale.language,!0),a=(0,b.getHumanizedDateTimeStringPast)(new Date(v(t)),!1,b.Locale.language,!0);return n&&a&&-1!==n.indexOf("at")&&-1!==a.indexOf("at")&&n.split("at")[0]===a.split("at")[0]?`${n} -${a.split("at")[1]}`:`${n} - ${a}`},D=e=>{switch(e.type){case t.Meeting:return new Date(v(e.start.dateTime));case t.MeetingSeries:return new Date(v(e.meetings[0].start.dateTime));case t.File:return new Date(e.lastModifiedDateTime);case t.Site:case t.Page:return new Date(e.lastAccessedDateTime);default:throw new Error("Unsupported attachment type")}},I=e=>""===e.trim()?{startDateTime:g(-30).toISOString(),endDateTime:g(1).toISOString(),skip:0,canLoadMore:!1,isLoading:!1}:{startDateTime:g(-180).toISOString(),endDateTime:g(1).toISOString(),skip:0,canLoadMore:!1,isLoading:!1},x=e=>e.map(e=>{switch(e.type){case t.File:return e.sharepointIds.listItemUniqueId||"";case t.Meeting:return e.id||"";case t.MeetingSeries:return e.seriesMasterId||"";case t.Site:case t.Page:return e.id||"";default:return""}}),C=e=>e.replace(/\+/g,"_").replace(/\//g,"-");class O{async requestData(e){try{const t=await this._getCalendarView(e);return this._processGraphCalendarViewData(t,e)}catch(t){return{nextPaginationInfo:e.paginationInfo,attachments:[]}}}_calculatePagination(e,t){const{paginationInfo:a,searchingContentType:i}=t;if(null!=e["@odata.nextLink"]){const t=new URL(e["@odata.nextLink"]),n=parseInt(t.searchParams.get("$skip")||"0",10);return{...a,skip:n,isLoading:!1,canLoadMore:!0}}return((e,t)=>{const a=t;if(void 0===a||void 0===a.startDateTime)return{...t,canLoadMore:!1,isLoading:!1};if((e===n.MeetingSeries||e===n.Meetings)&&new Date(a.startDateTime).getTime()<=g(-180).getTime())return{...t,canLoadMore:!1,isLoading:!1};const i=(new Date(a.startDateTime).getTime()-new Date(a.endDateTime).getTime())/864e5;return{skip:0,startDateTime:g(i,new Date(a.startDateTime)).toISOString(),endDateTime:a.startDateTime,canLoadMore:!0,isLoading:!1}})(i,a)}_filterByOrganizersName(e,t){return!(t.filterByOrganizersName.length>0)||t.filterByOrganizersName.map(e=>e.toLocaleLowerCase()).includes(e.organizer?.emailAddress?.name?.toLocaleLowerCase())}_processMeetingSeriesData(e,n){const{ignoredAttachmentsIds:i}=n,r=e.value.filter(e=>!e.isCancelled).filter(e=>null!=e.seriesMasterId).filter(e=>e.seriesMasterId&&-1===i.indexOf(e.seriesMasterId)).filter(e=>this._filterByOrganizersName(e,n)).map(e=>{if(null==e.seriesMasterId)throw new Error("seriesMasterId is null");return{type:t.Meeting,id:e.id,name:e.subject,seriesMasterId:e.seriesMasterId,start:e.start,end:e.end,sensitivity:e.sensitivity,meetingType:a.Occurrence,organizer:e.organizer,isOrganizer:e.isOrganizer,isOnlineMeeting:e.isOnlineMeeting,onlineMeeting:e.onlineMeeting}}).reduce((e,t)=>(e[t.seriesMasterId]?e[t.seriesMasterId].push(t):e[t.seriesMasterId]=[t],e),{});return Object.values(r).map(e=>(e.sort((e,t)=>new Date(t.end.dateTime).getTime()-new Date(e.end.dateTime).getTime()),{meetings:e,type:t.MeetingSeries,id:e[0].id,name:e[0].name,seriesMasterId:e[0].seriesMasterId}))}_processMeetingEventData(e,n){const{ignoredAttachmentsIds:i}=n,r=new Date;return e.value.filter(e=>!e.isCancelled&&-1===i.indexOf(e.id)&&this._filterByOrganizersName(e,n)&&new Date(v(e.end.dateTime))<r).map(e=>{let n;return n="occurrence"===e.type?a.Occurrence:"singleInstance"===e.type?a.Single:a.Exception,{type:t.Meeting,id:e.id,name:e.subject,start:e.start,end:e.end,sensitivity:e.sensitivity,meetingType:n,organizer:e.organizer,isOrganizer:e.isOrganizer,isOnlineMeeting:e.isOnlineMeeting,onlineMeeting:e.onlineMeeting}})}_processGraphCalendarViewData(e,t){if(t.abortSignal?.aborted){const e=new Error("action is aborted");throw e.name="AbortError",e}const a=this._calculatePagination(e,t);let i;if(0===e.value.length&&(i=[]),t.searchingContentType===n.MeetingSeries)i=this._processMeetingSeriesData(e,t);else{if(t.searchingContentType!==n.Meetings)throw new Error("Unsupported searching content type:"+t.searchingContentType);i=this._processMeetingEventData(e,t)}return{nextPaginationInfo:a,attachments:i}}async _getCalendarView(e){return await this._getRawClientResponse(e)}_getRawClientResponse(e){return this._graphClientPromise.then(t=>t.api(this._getCalendarViewUrl(e)).responseType(m.ResponseType.JSON).get())}_getCalendarViewUrl(e){const{filterByOrganizersName:t,queryString:a,searchingContentType:i,paginationInfo:r}=e;let o="";if(""===a.trim()&&t.length>0){let e=!0;for(let n=0;n<t.length;n++){const a=t[n];if(""===a.trim())continue;const i=encodeURIComponent(a);e?(e=!1,o+=`$filter=organizer/emailAddress/name eq '${i}'`):o+=` or organizer/emailAddress/name eq '${i}'`}}else o="$filter=isCancelled ne true",i===n.MeetingSeries&&(o+=" and seriesMasterId ne null"),a?.trim()?.length>0&&(o+=` and contains(subject, '${encodeURIComponent(a.trim())}')`);return`me/calendarView?top=${(e=>e===n.MeetingSeries?40:20)(i)}${(e=>{let t="&";return"startDateTime"in e&&"endDateTime"in e&&(t+=`startdatetime=${e.startDateTime}&enddatetime=${e.endDateTime}`),"skip"in e&&(t+=`&skip=${e.skip}`),t})(r)}&${o}&$select=isCancelled,id,seriesMasterId,isOnlineMeeting,isOrganizer,organizer,onlineMeeting,start,end,sensitivity,type,subject,hasAttachments,isAllDay&$orderby=start/dateTime desc`}constructor(e){this._graphClientFactory=e.consume(p.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}}var w=H(2737),E=H(9676),A=H(7408);function L(){return E._SPKillSwitch.isActivated("6d7ac0be-14d6-426c-b73d-08637818220c")}function k(){return E._SPKillSwitch.isActivated("9a044a88-337f-5ca5-ad43-00c8006f092d")}function M(){return E._SPKillSwitch.isActivated("0daf0393-4d55-61fc-382b-0124f969655f")}function P(){return E._SPKillSwitch.isActivated("293519d1-ff21-45e2-8316-614871177f43")}function T(){return E._SPKillSwitch.isActivated("1840ea49-fc37-434a-befa-eacf4cc5d870")}function U(){return E._SPKillSwitch.isActivated("917a9ab8-6605-4203-80b8-fd3216f206a9")}function F(){return E._SPKillSwitch.isActivated("dda412c4-828e-4733-adca-050d7ac34dff")}function N(){return E._SPKillSwitch.isActivated("96257f80-c95f-4fd7-adc9-fa03d8b87962")}function B(){return E._SPKillSwitch.isActivated("8e0fb903-0f38-40c5-b6c8-fed3d915413d")}function j(){return E._SPKillSwitch.isActivated("f528c6f6-58a6-497a-ac70-a9814dfc0481")}function V(){return E._SPKillSwitch.isActivated("a5e7cd0e-cb8b-4411-b23c-705fdfe94f28")}function z(){return E._SPKillSwitch.isActivated("6955527b-d583-4de2-98cc-0e8fa89e5aec")}function G(){return E._SPKillSwitch.isActivated("c833014a-86a7-4277-90c5-f05c6f869887")}function K(){return E._SPKillSwitch.isActivated("f31eb762-bc31-4aa8-ad12-8ad22cacef9a")}function W(){return E._SPKillSwitch.isActivated("0f8cfa17-e9aa-456e-8958-2108e387f515")}function q(){return E._SPKillSwitch.isActivated("65901a51-571f-489b-a742-eadf5a0a8908")}function Q(){return E._SPKillSwitch.isActivated("c4211df7-e7d3-471e-9fa5-1b257846cf3f")}const Y=new Map([[n.Meetings,"Event"],[n.Files,"File"],[n.Sites,"Site"],[n.Pages,"Site"]]),J=W()?["Powerpoint","Word","Loop","Pdf"]:["Powerpoint","Word","Loop","Pdf","Excel"];function X(e){return{type:t.Meeting,id:C(e.EventId.Id),name:e.Subject,start:{dateTime:e.Start,timeZone:"UTC"},end:{dateTime:e.End,timeZone:"UTC"},meetingType:e.SeriesMasterId?a.Occurrence:a.Single,organizer:{emailAddress:{name:e.OrganizerName,address:e.OrganizerAddress}},hasRecording:e.HasRecording||!1}}function Z(e){const[,n,a]=e.SpoId.split("_"),[i,r,o]=atob(n).split(",");return{type:t.File,id:a,name:e.FileName,extension:e.FileExtension,sharepointIds:{siteId:i,webId:r,listId:o,driveId:"",webUrl:e.AccessUrl,listItemUniqueId:e.SpoUniqueId},createdBy:{user:{displayName:e.Author,email:""}},createdDateTime:e.DateCreated,lastModifiedBy:{user:{displayName:e.ModifiedByDisplayName,email:e.ModifiedBy}},lastModifiedDateTime:e.DateModified}}function $(e,n=!1){const[,a,i]=e.SpoId.split("_"),[r,o,s]=atob(a).split(",");return{type:t.Page,id:e.SpoId,name:!G()&&n?`${e.Title}.aspx`:e.Title,url:e.AccessUrl,sharepointIds:{siteId:r,webId:o,listId:s,driveId:a,webUrl:e.AccessUrl,listItemUniqueId:i},lastAccessedDateTime:e.LastAccessedDateTime}}function ee(e){const[,n,a]=e.SpoId.split("_"),[i,r,o]=atob(n).split(",");return{type:t.Site,id:e.SpoId,name:e.Title,url:e.AccessUrl,sharepointIds:{siteId:i,webId:r,listId:o,driveId:n,webUrl:e.AccessUrl,listItemUniqueId:a},lastAccessedDateTime:e.LastAccessedDateTime,color:e.Color,acronym:e.Acronym}}class te{async requestData(e,t,n){try{const a=await this._tokenProvider._getTokenInternal(`${this._substrateHost}/search`,w._AadTokenProviders.preAuthorizedConfiguration),i=JSON.stringify({scenario:{name:"SharePoint.AuthoringCopilot"},entityRequests:t.map(t=>{const n={entityType:t,query:{queryString:e}};return E._SPKillSwitch.isActivated("06eb46f0-31c3-4370-b60c-d0e481750b1c")||"File"===t&&(n.filter=this._getFileTypeFilter()),n}),timeZone:"UTC",cvid:n??E.Guid.newGuid().toString()}),r=new Headers;r.set("Authorization","Bearer "+a),r.set("Content-Type","application/json"),r.set("Accept","application/json");const o={credentials:"same-origin",headers:r,body:i},s=new p.HttpClientConfiguration(p.HttpClient.configurations.v1);return this._serviceScope.consume(p.HttpClient.serviceKey).post(`${this._substrateHost}/search/api/v1/suggestions`,s,o).then(e=>e.json())}catch(e){return{Groups:[]}}}getRequestEntities(e,t){return(e===n.All?t.filter(e=>e!==n.All):[e]).map(e=>Y.get(e)||"").filter(e=>""!==e)}_getFileTypeFilter(){return{And:[{Or:J.map(e=>({Term:{FileType:e}}))}]}}constructor(e){this._tokenProvider=w._AadTokenProviders.configurable,this._serviceScope=e,this._substrateHost=e.consume(A.PageContext.serviceKey).legacyPageContext.substrateEndpointUrl}}var ne=H(2207);const ae=async e=>{const{serviceScope:t,queryString:a,activatedTab:i,displayTabs:r,selectedAttachments:o,abortSignal:s,filterByOrganizersName:c,ignoredAttachmentsIds:d=[],paginationInfo:l}=e,u=q()?void 0:new ne._QosMonitor("SPAttachmentBox.attachment.Attachments.loadAttachmentsData"),f=new _(t),p=new O(t);let m=[],h=l;const b=z()?x(o):[...d,...x(o)],g=i===n.All?r:[i],v=[];for(const e of g)switch(e){case n.Files:const t=W()?["doc","docx","ppt","pptx","pdf","loop"]:["doc","docx","ppt","pptx","pdf","loop","xls","xlsx"];if(!q()&&u)try{v.push(f.requestData({queryString:a||"*",extensions:t,ignoredAttachmentsIds:b,searchingContentType:e,abortSignal:s,paginationInfo:l}))}catch(e){throw u.writeUnexpectedFailure("SearchRequestFailure.Files",e),e}else v.push(f.requestData({queryString:a||"*",extensions:t,ignoredAttachmentsIds:b,searchingContentType:e,abortSignal:s,paginationInfo:l}));break;case n.Meetings:if(!q()&&u)try{v.push(p.requestData({ignoredAttachmentsIds:b,searchingContentType:e,paginationInfo:l,queryString:a,abortSignal:s,filterByOrganizersName:c}))}catch(e){throw u.writeUnexpectedFailure("SearchRequestFailure.Meetings",e),e}else v.push(p.requestData({ignoredAttachmentsIds:b,searchingContentType:e,paginationInfo:l,queryString:a,abortSignal:s,filterByOrganizersName:c}));break;case n.MeetingSeries:let i=!0,r=m.length;for(;i;){let t;if(!q()&&u)try{t=await p.requestData({ignoredAttachmentsIds:b,searchingContentType:e,paginationInfo:h,queryString:a,abortSignal:s,filterByOrganizersName:c})}catch(e){throw u.writeUnexpectedFailure("SearchRequestFailure.MeetingSeries",e),e}else t=await p.requestData({ignoredAttachmentsIds:b,searchingContentType:e,paginationInfo:h,queryString:a,abortSignal:s,filterByOrganizersName:c});m=[...m,...t.attachments],h=t.nextPaginationInfo,i=h.canLoadMore&&m.length===r,r=m.length}break;case n.All:break;default:throw!q()&&u&&u.writeUnexpectedFailure("UnsupportedContentType"),new Error("Unsupported searching content type")}const y=await Promise.all(v);return i!==n.All&&1===y.length&&(h=y[0].nextPaginationInfo),m=y.reduce((e,t)=>[...e,...t.attachments],m),i===n.All&&(m=m.sort((e,t)=>D(t).getTime()-D(e).getTime()).slice(0,20)),!q()&&u&&u.writeSuccess(),{attachments:m,nextPaginationInfo:h}},ie=async e=>{const t=q()?void 0:new ne._QosMonitor("SPAttachmentBox.attachment.Attachments.loadSubstrateAttachmentsData"),{serviceScope:a,queryString:i,activatedTab:r,displayTabs:o,abortSignal:s,paginationInfo:c,cvid:d,selectedAttachments:l,ignoredAttachmentsIds:u=[]}=e,f=new te(a);let p;if(!q()&&t)try{p=await f.requestData(i,f.getRequestEntities(r,o),d)}catch(e){throw t.writeUnexpectedFailure("SubstrateRequestFailure",e),e}else p=await f.requestData(i,f.getRequestEntities(r,o),d);if(s?.aborted){!q()&&t&&t.writeExpectedFailure("ActionAborted");const e=new Error("action is aborted");throw e.name="AbortError",e}const m=[],_=new Date,h=x(l),b=z()?h:[...u,...h];for(const e of p.Groups)switch(e.Type){case"File":m.push(...e.Suggestions.filter(e=>e.SpoId&&e.SpoId.length>0&&!b.includes(e.SpoUniqueId)).map(Z));break;case"Event":m.push(...e.Suggestions.filter(e=>new Date(e.End)<_&&!b.includes(C(e.EventId.Id))).map(X));break;case"Site":m.push(...e.Suggestions.filter(e=>!b.includes(e.SpoId)).map(e=>(E._SPKillSwitch.isActivated("b8e7d789-a8a8-4e30-aca8-a02e39050d83")?"Color"in e:!e.AccessUrl.endsWith(".aspx"))?ee(e):$(e,r===n.Pages)))}return r===n.All&&m.sort((e,t)=>D(t).getTime()-D(e).getTime()),!q()&&t&&t.writeSuccess(),{attachments:m,nextPaginationInfo:{...c,canLoadMore:!1}}};var re=H(529);function oe(e){const{dropdownViewboxRef:t,loadMoreRef:n,onScrollEnd:a}=e;(0,o.useEffect)(()=>{const e=t?.current;if(null==e)return;const i=(0,re.debounce)(()=>{const e=t?.current,i=n?.current;if(null==e||null==i)return;const r=e.getBoundingClientRect(),o=i.getBoundingClientRect();o.bottom-2*o.height<=r.bottom&&a()},200);return e.addEventListener("scroll",i),()=>{e.removeEventListener("scroll",i),i.cancel()}},[t,n,a])}const se=(0,c.makeStyles)({loadMoreBtn:{display:"flex",justifyContent:"center",padding:"8px 0px",cursor:"pointer"},loadMoreSpinner:{alignContent:"center",alignItems:"center",justifyContent:"center",height:"28px",display:"flex",width:"100%"},reachTheEndText:{color:"var(--colorNeutralForeground3)",alignContent:"center",alignItems:"center",justifyContent:"center",display:"flex"}});function ce(){return E._SPFlight.isEnabled(60696)}var de=H(7526),le={accdb:{extensions:["accdb","mdb"]},aipage:{extensions:["page"]},archive:{extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},album:{},audio:{extensions:["aif","aiff","aac","alac","amr","ape","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","oga","ra","rm","wav","wma","wv"]},calendar:{extensions:["ical","icalendar","ics","ifb","vcs"]},classifier:{extensions:["classifier"]},clipchamp:{extensions:["clipchamp"]},cliptemplate:{extensions:["cliptemplate"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","cbl","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","h","h++","haml","handlebars","hbs","hcp","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsproj","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","ps1xml","psd1","psm1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","shtml","sml","svn-base","swift","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},contact:{extensions:["vcf"]},copilot:{extensions:["copilot"]},csv:{extensions:["csv"]},designer:{extensions:["design"]},desktopfolder:{},docset:{},documentsfolder:{},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{extensions:["eml","msg","oft","ost","pst"]},exe:{extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},favoritesfolder:{},folder:{},font:{extensions:["ttf","otf","woff"]},form:{},genericfile:{},html:{extensions:["htm","html","mht","mhtml"]},ipynb:{extensions:["nnb","ipynb"]},link:{extensions:["lnk","link","url","website","webloc"]},linkedfolder:{},listform:{},listitem:{},loop:{extensions:["fluid","loop","note"]},loopworkspace:{},officescript:{extensions:["osts"]},splist:{},mcworld:{extensions:["mcworld"]},mctemplate:{extensions:["mctemplate"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layer","layout","max","mtl","obj","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},multiple:{},one:{extensions:["one","onepart"]},onepage:{extensions:["onepage"]},onetoc:{extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pbiapp:{},pdf:{extensions:["pdf"]},photo:{extensions:["arw","bmp","cr2","crw","dic","dicm","dcm","dcm30","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","jxr","kdc","mrw","nef","orf","pct","pict","png","pns","psb","psd","raw","tga","tif","tiff","wdp"]},photo360:{},picturesfolder:{},planner:{},portfolio:{},potx:{extensions:["pot","potm","potx"]},powerbi:{extensions:["pbids","pbix"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},spreadsheet:{extensions:["odc","ods","gsheet","numbers","tsv"]},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{},playlist:{},sway:{},sysfile:{extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","ldt","lrprev","pkpass","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xlb","xll"]},todoitem:{},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vaultclosed:{},vaultopen:{},vector:{extensions:["ai","ait","cvs","dgn","gdraw","pd","emf","eps","fig","ind","indd","indl","indt","indb","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vdx","vsd","vsdm","vsdx","vsw","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx","vsx"]},whiteboard:{extensions:["whiteboard","wbtx"]},xlsx:{extensions:["xlc","xls","xlsb","xlsm","xlsx","xlw"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{extensions:["zip"]}};const ue="#207347",fe="#C8C8C8",pe="#2B579A",me="#094AB2",_e="#0078d4",he="#D04727",be="#3A56A0",ge={};[{color:"#A23739",extensions:["accdb","mdb"]},{color:me,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","rar","z"]},{color:"#038387",extensions:["aspx"]},{color:fe,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},{color:fe,extensions:["asp","bat","c","coffee","config","cpp","cs","cshtml","css","dat","fsx","h","inf","ini","java","js","json","less","log","manifest","master","nfo","php","prefs","preferences","ps","ps1","pss","py","rb","rdf","reg","ruby","sql","svn-base","vmg","webpart","wsp","vb"]},{color:ue,extensions:["csv"]},{color:pe,extensions:["doc","docm","docx"]},{color:pe,extensions:["dot","dotm","dotx"]},{color:fe,extensions:["eml","msg","ost","pst"]},{color:fe,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},{color:fe,extensions:["ttf","otf","woff"]},{color:_e,extensions:["htm","html","mht"]},{color:_e,extensions:["lnk","link","url","website","webloc"]},{color:fe,extensions:["3mf","3ds","blend","cool","dae","df","dwfx","dwg","dxf","fbx","gltf","glb","layout","obj","off","max","ply","skp","stp","stl","t","thl","x"]},{color:ue,extensions:["mpp"]},{color:ue,extensions:["mpt"]},{color:ue,extensions:["ods"]},{color:pe,extensions:["odt"]},{color:"#803A7A",extensions:["one","onepkg","ms-one-stub","onetoc","onetoc2"]},{color:"#D76244",extensions:["pdf"]},{color:fe,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},{color:he,extensions:["pot","potm","potx"]},{color:he,extensions:["pps","ppsm","ppsx"]},{color:he,extensions:["ppt","pptm","pptx"]},{color:"#077568",extensions:["pub"]},{color:fe,extensions:["epub","rtf","wri"]},{color:fe,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","obj","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},{color:fe,extensions:["log","md","readme","text","txt"]},{color:be,extensions:["ai","dgn","pd","emf","eps","indd","indt","ps","svg","svgz","wmf"]},{color:fe,extensions:["3gp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},{color:be,extensions:["vsd","vsdm","vsdx","vdw"]},{color:fe,extensions:["vss","vssm","vssx"]},{color:be,extensions:["vst","vstm","vstx"]},{color:ue,extensions:["xls","xlsb","xlsm","xlsx"]},{color:fe,extensions:["xlt","xltm","xltx"]},{color:fe,extensions:["xaml","xml","xsl"]},{color:"#0EB5ED",extensions:["oxps","xps"]},{color:"#6A3889",extensions:["xsn"]},{color:me,extensions:["zip"]}].forEach(e=>{e.extensions&&e.extensions.forEach(t=>{ge[t]=e})});const ve=Object.keys(le),ye={};ve.forEach(e=>{(le[e].extensions||[]).forEach(t=>{ye[t]=e})});const Se=H.p+"odm_newsCarousel1_3bd855d4.png",De="folder";class Ie{static getIconColorFromExtension(e){return(ge[e]||{color:fe}).color}static getIconUrl(e,t=32,n=!1){let a="";const{devicePixelRatio:i}=window;let r;n?a="":i>1&&i<=1.5?a="_1.5x":i>1.5&&i<=2?a="_2x":i>2&&i<=3?a="_3x":i>3&&(a="_4x"),r=e===De?De:"listItem"===e?"splist":E._SPKillSwitch.isActivated("f3372891-15c7-4ed1-81c8-b84a24d31460")||"sponews"!==e?ye[e]||"genericfile":"sponews",t>32&&i>1&&i===Math.floor(i)&&(t=Ie._mapToValidIconSize(t/i));const o=`${E._SPKillSwitch.isActivated("db5efa28-2e9c-4025-9ecb-59a733278af0")?E._FluentIconVersionedCdnPathTemp:(0,E._getPrimaryVersionedPath)()}/assets/`;let s=`https://res-1.cdn.office.net${o}item-types`;if(!sessionStorage.getItem("spfx-debug")&&E.Environment.type===E.EnvironmentType.SharePoint){const e=new b.Uri(Se);s=b.Uri.concatenate(e.getLeftPart(b.UriPartial.authority),o+"item-types")}return`${s}/${t}${a}/${r}.png`}}Ie._mapToValidIconSize=e=>{const t=[16,20,24,32,40,48,64,96,Number.MAX_VALUE],n=t.filter((n,a)=>e>=n&&a<t.length-1&&e<t[a+1]);return 0===n.length?16:n[0]};var xe=H(5711);const Ce=o.createContext(void 0),Oe={},we=(Ce.Provider,(0,c.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]})),Ee=(e,t)=>{const{title:n,primaryFill:a="currentColor",...i}=e,r={...i,title:void 0,fill:a},s=we(),d=o.useContext(Ce)?o.useContext(Ce):Oe;return r.className=(0,c.mergeClasses)(s.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==d?void 0:d.textDirection)&&s.rtl,r.className),n&&(r["aria-label"]=n),r["aria-label"]||r["aria-labelledby"]?r.role="img":r["aria-hidden"]=!0,r},Ae=(e,t,n,a)=>{const i="1em"===t?"20":t,r=o.forwardRef((e,r)=>{const s={...Ee(e,{flipInRtl:null==a?void 0:a.flipInRtl}),ref:r,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?o.createElement("svg",{...s,dangerouslySetInnerHTML:{__html:n}}):o.createElement("svg",s,...n.map(e=>o.createElement("path",{d:e,fill:s.fill})))});return r.displayName=e,r},Le=Ae("AddCircleRegular","1em",["M6 10c0-.28.22-.5.5-.5h3v-3a.5.5 0 0 1 1 0v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3A.5.5 0 0 1 6 10Zm4 8a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm0-1a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"]),ke=Ae("ArrowCircleUpFilled","1em",["M2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm4.65-.85a.5.5 0 1 0 .7.7L9.5 7.71v5.79a.5.5 0 0 0 1 0V7.7l2.15 2.15a.5.5 0 0 0 .7-.7l-3-3a.5.5 0 0 0-.7 0l-3 3Z"]),Me=Ae("ArrowCircleUpRegular","1em",["m6.65 9.15 3-3c.2-.2.5-.2.7 0l3 3a.5.5 0 0 1-.7.7L10.5 7.71v5.79a.5.5 0 0 1-1 0V7.7L7.35 9.86a.5.5 0 0 1-.7-.7ZM10 2a8 8 0 1 0 0 16 8 8 0 0 0 0-16Zm-7 8a7 7 0 1 1 14 0 7 7 0 0 1-14 0Z"]),Pe=Ae("CalendarLtrRegular","1em",["M7 11a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 2a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm2-2a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm4-5.5A2.5 2.5 0 0 0 14.5 3h-9A2.5 2.5 0 0 0 3 5.5v9A2.5 2.5 0 0 0 5.5 17h9a2.5 2.5 0 0 0 2.5-2.5v-9ZM4 7h12v7.5c0 .83-.67 1.5-1.5 1.5h-9A1.5 1.5 0 0 1 4 14.5V7Zm1.5-3h9c.83 0 1.5.67 1.5 1.5V6H4v-.5C4 4.67 4.67 4 5.5 4Z"]),Te=Ae("CalendarSyncRegular","1em",["M14.5 3A2.5 2.5 0 0 1 17 5.5v4.1c-.32-.16-.65-.3-1-.4V7H4v7.5c0 .83.67 1.5 1.5 1.5h3.7c.1.35.24.68.4 1H5.5A2.5 2.5 0 0 1 3 14.5v-9A2.5 2.5 0 0 1 5.5 3h9Zm0 1h-9C4.67 4 4 4.67 4 5.5V6h12v-.5c0-.83-.67-1.5-1.5-1.5ZM10 14.5a4.5 4.5 0 1 0 9 0 4.5 4.5 0 0 0-9 0Zm6.5-3c.28 0 .5.22.5.5v1.5a.5.5 0 0 1-.5.5H15a.5.5 0 0 1 0-1h.47a1.97 1.97 0 0 0-.94-.25 2 2 0 0 0-1.44.59.5.5 0 0 1-.71-.71 3 3 0 0 1 3.62-.48V12c0-.28.22-.5.5-.5Zm-.88 5.53a3 3 0 0 1-2.62-.18V17a.5.5 0 0 1-1 0v-1.5c0-.28.22-.5.5-.5H14a.5.5 0 0 1 0 1h-.47a1.97 1.97 0 0 0 .94.25 2 2 0 0 0 1.44-.59.5.5 0 0 1 .71.71 3 3 0 0 1-1 .66Z"]),Ue=Ae("DismissFilled","1em",["m3.9 4.05.07-.08a.75.75 0 0 1 .98-.07l.08.07L10 8.94l4.97-4.97a.75.75 0 0 1 .98-.07l.08.07c.27.27.3.68.07.98l-.07.08L11.06 10l4.97 4.97c.27.27.3.68.07.98l-.07.08a.75.75 0 0 1-.98.07l-.08-.07L10 11.06l-4.97 4.97a.75.75 0 0 1-.98.07l-.08-.07a.75.75 0 0 1-.07-.98l.07-.08L8.94 10 3.97 5.03a.75.75 0 0 1-.07-.98l.07-.08-.07.08Z"]),Fe=Ae("DismissRegular","1em",["m4.09 4.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L10 9.29l5.15-5.14a.5.5 0 0 1 .63-.06l.07.06c.18.17.2.44.06.63l-.06.07L10.71 10l5.14 5.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L10 10.71l-5.15 5.14a.5.5 0 0 1-.63.06l-.07-.06a.5.5 0 0 1-.06-.63l.06-.07L9.29 10 4.15 4.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"]),He=Ae("DocumentOnePageRegular","1em",["M6 2h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.1.9-2 2-2Zm0 1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H6Zm7 3.5a.5.5 0 0 1-.41.5H7.5a.5.5 0 0 1-.09-1h5.09c.28 0 .5.22.5.5Zm0 3.5a.5.5 0 0 1-.41.5H7.5a.5.5 0 0 1-.09-1h5.09c.28 0 .5.22.5.5Zm0 3.5a.5.5 0 0 1-.41.5H7.5a.5.5 0 0 1-.09-1h5.09c.28 0 .5.22.5.5Z"]),Re=Ae("InfoFilled","1em",["M18 10a8 8 0 1 0-16 0 8 8 0 0 0 16 0ZM9.5 8.91a.5.5 0 0 1 1 0V13.6a.5.5 0 0 1-1 0V8.9Zm-.25-2.16a.75.75 0 1 1 1.5 0 .75.75 0 0 1-1.5 0Z"]),Ne=Ae("LockClosedRegular","1em",["M10 13a1 1 0 1 0 0-2 1 1 0 0 0 0 2ZM6 6h1V5a3 3 0 0 1 6 0v1h1a3 3 0 0 1 3 3v6a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V9a3 3 0 0 1 3-3Zm4-3a2 2 0 0 0-2 2v1h4V5a2 2 0 0 0-2-2Zm6 6a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v6c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V9Z"]),Be=(0,c.makeStyles)({meetingIconLarge:{width:"20px",height:"20px",minWidth:"20px"},meetingIconExtraLarge:{width:"24px",height:"24px",minWidth:"20px"}});var je=H(1717);const Ve={ignoredAttachmentsIds:[],disableSiteInSiteTab:!1,isCurrentPageSelected:!1,currentPage:void 0},ze=o.createContext(Ve);function Ge({children:e,ignoredAttachmentsIds:t,disableSiteInSiteTab:n,isCurrentPageSelected:a,currentPage:i}){const r=o.useMemo(()=>({ignoredAttachmentsIds:t,disableSiteInSiteTab:n,isCurrentPageSelected:a,currentPage:i}),[t,n,a,i]);return o.createElement(ze.Provider,{value:r},e)}const Ke=()=>o.useContext(ze);var We;function qe(e){const{size:n,attachment:i}=e,{currentPage:r}=Ke(),o="large"===n?20:24,c=Be();let d=null;const l="large"===n?c.meetingIconLarge:c.meetingIconExtraLarge;if(i.type===t.File){let e=i.extension;P()||(e=e?e.toLowerCase():""),d=s().createElement(xe.Image,{src:Ie.getIconUrl(e),height:o,width:o,role:"presentation"})}else if(i.type===t.MeetingSeries)d=s().createElement(Te,{className:l});else if(i.type===t.Meeting)d=i.meetingType===a.Occurrence?s().createElement(Te,{className:l}):s().createElement(Pe,{className:l});else if(i.type===t.Site){const e=i,{acronym:t,color:n}=e;d=s().createElement("div",{style:{height:o,width:o,backgroundColor:n,color:(0,je.isDarkTheme)(n?.startsWith("#")?n:"#ffffff")?"white":"black"}},t)}else if(i.type===t.Page){if(!K()&&r&&r.id===i.id)return s().createElement(He,{className:l});d=s().createElement(xe.Image,{src:Ie.getIconUrl("aspx"),role:"presentation",height:o,width:o})}else if(V()||i.type!==t.Unauthorized){if(P())throw new Error(`Unsupported attachment type: ${i.type}`);d=s().createElement(xe.Image,{src:Ie.getIconUrl(""),height:o,width:o,role:"presentation"})}else d=s().createElement(Ne,{className:l});return s().createElement(s().Fragment,null,d)}!function(e){e.Large="large",e.extraLarge="extra-large"}(We||(We={}));const Qe=(0,c.makeStyles)({spinner:{alignContent:"center",alignItems:"center",justifyContent:"center",height:"184px"},attachmentOptionContainer:{display:"flex",flexDirection:"row",width:"100%",overflow:"hidden",alignItems:"center"},attachmentInfo:{padding:"0 var(--spacingHorizontalS)",overflow:"hidden"},attachmentName:{width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"var(--fontSizeBase300)",lineHeight:"var(--lineHeightBase300)",height:"var(--lineHeightBase300)"},attachmentActivity:{width:"100%",fontSize:"var(--fontSizeBase100)",lineHeight:"var(--lineHeightBase100)",height:"var(--lineHeightBase100)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--colorNeutralForeground3)"},clearContainer:{display:"flex",flexDirection:"column",marginTop:"10px",paddingLeft:"6px",paddingRight:"6px"},noResultsFound:{marginBottom:"12px",paddingLeft:"10px",fontFamily:"var(--fontFamilyBase)"},noResultsFoundV2:{height:"30px",fontFamily:"var(--fontFamilyBase)",display:"flex",alignItems:"center",margin:"6px 8px 6px 8px"},clearButton:{backgroundColor:"var(--colorNeutralBackground3)",color:"var(--colorBrandForeground1)",border:"1px",borderRadius:"4px",padding:"10px",justifyContent:"left"},clearButtonV2:{backgroundColor:"var(--colorNeutralBackground3)",color:"var(--colorBrandForeground1)",border:"1px",borderRadius:"4px",justifyContent:"left",paddingLeft:"0px",width:"100%"},tagPickerList:{maxHeight:"184px",width:"440px !important",left:"-12px !important",transform:"none !important",boxShadow:"0 0 0 1px var(--color-neutral-200)",position:"relative !important"}}),Ye=e=>{const{searchResult:n,queryString:a,handleClearAndTryAgain:r,loadingComponent:o}=e,c=Qe(),p=(e=!1,t=!1)=>e?s().createElement(s().Fragment,null,s().createElement(f.Text,{className:c.noResultsFoundV2},l.nF),t&&s().createElement(d.TagPickerOption,{text:"clearAndTryAgain",key:"clearAndTryAgain",value:"clearAndTryAgain",style:{backgroundColor:"var(--colorNeutralBackground3)"}},s().createElement(de.Button,{className:c.clearButtonV2,onClick:r,onKeyDown:e=>{E._SPKillSwitch.isActivated("7e6b43f6-4082-4add-83a0-3dbf34d6b2f6")||"Enter"!==e.key||(e.preventDefault(),r())}},l.ki))):s().createElement("div",{className:c.clearContainer},s().createElement(f.Text,{className:c.noResultsFound},l.nF),t&&s().createElement(de.Button,{className:c.clearButton,onClick:r},l.ki)),m=t=>s().createElement(d.TagPickerList,{className:e.customizedStyles?.dropDownOptionList??c.tagPickerList,ref:E._SPKillSwitch.isActivated("3d00bf73-3d07-45ea-af4c-6a6863e45ac9")?void 0:e.dropdownViewboxRef},t),_=e=>{let n="";switch(e.type){case t.File:{const{lastModifiedBy:t,lastModifiedDateTime:a}=e,i=t?.user?.displayName,r=(0,b.getFriendlyDateTimeStringPast)(new Date(a||""));n=i?b.StringHelper.format(l.fG,i,r):b.StringHelper.format(l.UF,r);break}case t.MeetingSeries:{const t=e.meetings[0];n=b.StringHelper.format(l.gm,S(t.start.dateTime,t.end.dateTime),t.organizer.emailAddress.name);break}case t.Meeting:{const t=e;n=b.StringHelper.format(e.hasRecording?l.Lq:l.gm,y(t.start.dateTime,t.end.dateTime),t.organizer.emailAddress.name);break}case t.Site:case t.Page:n=e.url;break;default:if(P())throw new Error("Unsupported attachment type:"+e.type)}return s().createElement(d.TagPickerOption,{text:e.name,key:e.id,value:e.id,"data-automation-id":h},s().createElement("div",{className:c.attachmentOptionContainer},s().createElement(qe,{size:We.Large,attachment:e}),s().createElement("div",{className:c.attachmentInfo},s().createElement("div",{className:c.attachmentName},e.name),s().createElement("div",{className:c.attachmentActivity},n))))};switch(n.status){case i.Querying:return s().createElement(u.Spinner,{className:c.spinner});case i.Succeed:return 0===n.results.length&&a?.length>0?B()?p(!1,!0):m(p(!0,!0)):m(s().createElement(s().Fragment,null,n.results.map(_),o));case i.Failed:if(P())throw new Error("Unsupported search status");return B()?p():m(p(!0))}},Je={loading:"loading",loadMore:"loadMore"},Xe=e=>Object.values(Je).includes(e);function Ze(e){const{searchResult:t,activatedTab:a,serviceScope:r,dropdownViewboxRef:o,displayTabs:c,filterByOrganizersName:p,queryString:m,paginationInfo:_,cvid:h,selectedAttachments:b,setPaginationInfo:g,setQueryString:v,setSearchResult:y,onClearAndTryAgain:S}=e,D=s().useRef(null),x=s().useRef(void 0),C=async()=>{if(a===n.All)return;g({..._,isLoading:!0});const e=ce()?ie:ae;try{const{attachments:n,nextPaginationInfo:i}=await e({serviceScope:r,queryString:m,activatedTab:a,displayTabs:c,paginationInfo:_,abortSignal:x.current?.signal,selectedAttachments:b,filterByOrganizersName:p,cvid:h});if(x.current?.signal?.aborted){const e=new Error("action is aborted");throw e.name="AbortError",e}const o=[...t.results,...n];g(i),y({...t,results:o})}catch(e){if(P())throw e;"AbortError"!==e.name&&(y({status:i.Failed,error:e}),g(I(m)))}};oe({dropdownViewboxRef:o,loadMoreRef:D,onScrollEnd:async()=>{!0===_.canLoadMore&&!1===_.isLoading&&await C()}}),s().useEffect(()=>{const e=new AbortController;return x.current=e,()=>{e.abort()}},[x]);const O=se();let w;return w=!0===_.canLoadMore&&a!==n.All?!0===_.isLoading?s().createElement(d.TagPickerOption,{text:"",value:Je.loading,ref:D},s().createElement(u.Spinner,{size:"small",className:O.loadMoreSpinner})):s().createElement(d.TagPickerOption,{value:Je.loadMore,className:O.loadMoreBtn,onClick:C,ref:D,role:"button"},l.iq):s().createElement("div",{className:O.reachTheEndText},s().createElement(f.Text,null,l.kz)),s().createElement(Ye,{dropdownViewboxRef:o,searchResult:t,queryString:m,loadingComponent:w,handleClearAndTryAgain:()=>{v(""),S?.()},customizedStyles:e.customizedStyles})}var $e=H(7781),et=H(1589),tt=H(2307),nt=H(5935);const at={colorBrandFlair1:"rgba(24, 90, 189, 1)",colorBrandFlair2:"rgba(71, 207, 250, 1)",colorBrandFlair3:"rgba(180, 124, 248, 1)",colorBrandFlair1Transparent:"rgba(24, 90, 189, 0)",colorBrandFlair2Transparent:"rgba(71, 207, 250, 0)",colorBrandFlair3Transparent:"rgba(180, 124, 248, 0)",colorBrandMorseCode1:"#ad5ae1",colorBrandMorseCode2:"#e9618d",colorBrandMorseCode3:"#fd9e5f",colorBrandMorseCode4:"#0e94e1",colorBrandMorseCode5:"#57ab82",colorBrandMorseCode6:"#c6c225",colorBrandMorseCode7:"#669fc2",colorBrandMorseCode8:"#6377e0",colorBrandMorseCode9:"#9b80ec",colorHCFlair1:"Highlight",colorHCFlair2:"HighlightText",colorHCFlair3:"Highlight",colorHCMorseCode1:"CanvasText",colorHCMorseCode2:"CanvasText",colorHCMorseCode3:"CanvasText",colorHCMorseCode4:"CanvasText",colorHCMorseCode5:"CanvasText",colorHCMorseCode6:"CanvasText",colorHCMorseCode7:"CanvasText",colorHCMorseCode8:"CanvasText",colorHCMorseCode9:"CanvasText",borderRadius2XL:"12px",borderRadius3XL:"16px",borderRadius4XL:"24px",borderRadius5XL:"40px",spacingVertical4XL:"40px",spacingVertical5XL:"48px",spacingHorizontal4XL:"40px",spacingHorizontal5XL:"48px",lineHeightBase450:"24px",lineHeightHero850:"48px",fontSizeBase450:"18px",shadowFlair1:"0 10px 12px 0 rgba(0, 30, 68, 0.04), 0 2px 8px 0 rgba(0, 30, 68, 0.06)",shadowFlair2:"0 12px 14px 0 rgba(0, 30, 68, 0.05), 0 6px 8px 0 rgba(0, 30, 68, 0.04), 0 1px 4px 0 rgba(0, 30, 68, 0.06)",shadowFlair3:"0 20px 16px 0 rgba(0, 30, 68, 0.05), 0 10px 12px 0 rgba(0, 30, 68, 0.04), 0 2px 8px 0 rgba(0, 30, 68, 0.06)"},it=o.createContext({mode:"canvas"}),rt=(0,c.createContext)(void 0),ot=e=>{const t=dt(e=>e.designVersion);var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:"current"},st={designVersion:"current"},ct=rt.Provider,dt=e=>(0,c.useContextSelector)(rt,(t=st)=>e(t)),lt={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",width:"1px",position:"absolute",overflow:"hidden",textWrap:"nowrap"};function ut(e,t){return e&&t?{...e,...t}:e||t}const ft=o.createContext(void 0).Provider,pt=(0,c.__styles)({root:{De3pzq:"f1k92xex"}},{d:[".f1k92xex{background-color:unset;}"]}),mt={};o.forwardRef((e,t)=>{const n=((e,t)=>{const n=(()=>{const{targetDocument:e}=(0,c.useFluent_unstable)(),t=o.useRef(void 0),[n,a]=(0,c.useTimeout)(),i=o.useRef(null),r=o.useRef(0),s=o.useRef([]),[d]=o.useState(()=>(0,c.createPriorityQueue)((e,t)=>e.priority!==t.priority?t.priority-e.priority:e.createdAt-t.createdAt)),l=o.useCallback(()=>{if(t.current)return;const r=()=>{if(i.current)if(e&&d.peek()){const a=e.createElement("span");a.innerText=d.all().filter(e=>e.message.trim().length>0).reduce((e,t)=>e+t.message+". ",""),i.current.innerText="",i.current.appendChild(a),d.clear(),s.current=[],t.current=n(()=>{r()},500)}else i.current.textContent="",a(),t.current=void 0};r()},[a,d,n,e]),u=o.useMemo(()=>(e,t={})=>{const{alert:n=!1,priority:a=0,batchId:i}=t,o={message:e,createdAt:r.current++,priority:a,batchId:i};if(i){const e=s.current.find(e=>e.batchId===i);e?(d.remove(e.message),e.message=o):s.current=[...s.current,{batchId:i,message:o}]}d.enqueue(o),l()},[d,l]);return o.useEffect(()=>{if(!i.current&&e)return i.current=e.createElement("div"),i.current.setAttribute("aria-live","assertive"),Object.assign(i.current.style,lt),e.body.append(i.current),()=>{var e;null===(e=i.current)||void 0===e||e.remove(),i.current=null}},[e]),u})(),{announce:a=n,theme:i,themeExtension:r,customStyleHooks:s}=e,d=(e=>{const t=o.useContext(it).mode;var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:"canvas"})(e.mode),l=ot(e.designVersion),u=o.useMemo(()=>ut(i,ut(at,r)),[i,r]);return{...(0,c.useFluentProvider_unstable)({...e,customStyleHooks_unstable:s,theme:u},t),announce:a,mode:d,designVersion:l}})(e,t);(e=>{const t=pt();e.root.className=(0,c.mergeClasses)("fai-CopilotProvider",t.root,e.root.className),(0,c.useFluentProviderStyles_unstable)(e)})(n);const a=function(e){const{mode:t,customStyleHooks_unstable:n=mt}=e,a=o.useMemo(()=>({announce:e.announce}),[e.announce]),i=o.useMemo(()=>({mode:t}),[t]),r=o.useMemo(()=>({designVersion:e.designVersion}),[e.designVersion]);return{...(0,c.useFluentProviderContextValues_unstable)(e),announce:a,copilotMode:i,customStyleHooks_unstable:n,designVersion:r}}(n);return((e,t)=>((0,c.assertSlots)(e),(0,c.jsx)(it.Provider,{value:t.copilotMode,children:(0,c.jsx)(ct,{value:t.designVersion,children:(0,c.jsx)(c.AnnounceProvider_unstable,{value:t.announce,children:(0,c.jsx)(ft,{value:t.customStyleHooks_unstable,children:(0,c.renderFluentProvider_unstable)(e,t)})})})})))(n,a)}).displayName="CopilotProvider";const _t=(0,c.__styles)({base:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f16d74zd",B7ck84d:"f1ewtqcl"}},{d:[[".f16d74zd{padding:var(--spacingVerticalXS) var(--spacingHorizontalXS);}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}"]}),ht=(0,c.__styles)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu"}},{d:[[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}]]}),bt=o.forwardRef((e,t)=>{const n=((e,t)=>({designVersion:ot(e.designVersion),...(0,nt.usePopoverSurface_unstable)(e,t)}))(e,t);return(e=>{const{designVersion:t}=e,n=_t(),a=ht();e.root.className=(0,c.mergeClasses)("fai-PreviewSurface",n.base,"next"===t&&a.root,e.root.className),(0,nt.usePopoverSurfaceStyles_unstable)(e)})(n),(e=>(0,nt.renderPopoverSurface_unstable)(e))(n)});bt.displayName="PreviewSurface";const gt="Enter",vt=[];function yt(e){let t=vt.findIndex(t=>t.id===e);for(;-1!==t;)vt.splice(t,1),t=vt.findIndex(t=>t.id===e)}const St=250,Dt=(e,t)=>"focus"===e||"blur"===e?0:t,It=(0,c.createContext)(void 0).Provider,xt=e=>(e=>{const{appearance:t,arrowRef:n,contentRef:a,inertTrapFocus:i,inline:r,isPreviewLocked:s,mountNode:c,open:d,openOnContext:l,openOnHover:u,setOpen:f,size:p,toggleOpen:m,trapFocus:_,triggerRef:h,withArrow:b}=e;return o.createElement(It,{value:{appearance:t,arrowRef:n,contentRef:a,inertTrapFocus:i,inline:r,isPreviewLocked:s,mountNode:c,open:d,openOnContext:l,openOnHover:u,setOpen:f,size:p,toggleOpen:m,trapFocus:_,triggerRef:h,withArrow:b}},(0,nt.renderPopover_unstable)(e))})((e=>{const{hideDelay:t=St,onOpenChange:n,open:a,positioning:i,showDelay:r=St,unstable_disableAutoFocus:s}=e,d=o.Children.toArray(e.children),{targetDocument:l}=(0,c.useFluent_unstable)(),[u,f]=(0,c.useTimeout)(),[p,m]=(0,c.useTimeout)(),[_,h]=o.useState(!0),{current:b}=o.useRef({openByClick:!1,openByHoverOverTrigger:!1,openByHoverOverPopover:!1,openByKeyboard:!1}),g=o.useRef(!1),v=()=>b.openByClick||b.openByHoverOverTrigger||b.openByHoverOverPopover||b.openByKeyboard,[y,S]=o.useState(!1),D=o.useRef(!1);let I,x;2===d.length?(I=d[0],x=d[1]):1===d.length&&(x=d[0]);const C=(0,c.useId)("preview-surface",null==x?void 0:x.props.id),O=()=>{b.openByClick=!1,b.openByHoverOverTrigger=!1,b.openByHoverOverPopover=!1,b.openByKeyboard=!1,S(v()),f()};if(o.useEffect(()=>()=>{yt(C)},[C]),x&&I){const e=e=>{b.openByHoverOverTrigger=!0,g.current=!0,b.openByClick||b.openByKeyboard||y||(h(!0),function(e){for(const t of vt)t.id!==e&&t.closeCallback();vt.length=0}(C)),u(()=>{b.openByClick||b.openByKeyboard||y||!v()||(null==n||n(e,{open:!0}),function(e,t){vt.push({id:e,closeCallback:t})}(C,O)),S(v())},r)},a=e=>{b.openByHoverOverTrigger=!1,g.current=!1,p(()=>{S(v()),b.openByClick||b.openByKeyboard||b.openByHoverOverPopover||!y||(null==n||n(e,{open:!1}),yt(C))},Dt(e.type,t))},i=e=>{D.current=!0,h(!1);const t=b.openByHoverOverTrigger;b.openByClick=!b.openByKeyboard&&!b.openByClick,b.openByHoverOverTrigger=!1,b.openByHoverOverPopover=!1,b.openByKeyboard=!1,g.current?(b.openByClick=!1,g.current=!1):e.preventDefault(),t||null==n||n(e,{open:b.openByClick}),v()||yt(C),S(v())},s=e=>{if(e.key===gt){m(),e.preventDefault(),h(!1);const t=b.openByHoverOverTrigger;b.openByKeyboard=!b.openByClick&&!b.openByKeyboard,b.openByClick=!1,b.openByHoverOverTrigger=!1,b.openByHoverOverPopover=!1,t||null==n||n(e,{open:b.openByKeyboard}),v()||yt(C),S(v())}},d=e=>{b.openByHoverOverPopover=!0,S(v())},l=e=>{b.openByHoverOverPopover=!1,p(()=>{S(v()),b.openByClick||b.openByKeyboard||b.openByHoverOverTrigger||(null==n||n(e,{open:!1}),yt(C))},Dt(e.type,t))};var w;I=o.cloneElement(I,{...I.props,children:o.cloneElement(I.props.children,{...I.props.children.props,onBlur:(0,c.mergeCallbacks)(I.props.children.props.onBlur,a),onClick:(0,c.mergeCallbacks)(I.props.children.props.onClick,i),onKeyDown:(0,c.mergeCallbacks)(I.props.children.props.onKeyDown,s),onMouseEnter:(0,c.mergeCallbacks)(I.props.children.props.onMouseEnter,e),onMouseLeave:(0,c.mergeCallbacks)(I.props.children.props.onMouseLeave,a)})}),x=o.cloneElement(x,{...x.props,"aria-labelledby":null!==(w=x.props["aria-labelledby"])&&void 0!==w?w:x.props["aria-label"]?void 0:C,id:C,onMouseEnter:(0,c.mergeCallbacks)(x.props.onMouseEnter,d),onMouseLeave:(0,c.mergeCallbacks)(x.props.onMouseLeave,l),onFocus:(0,c.mergeCallbacks)(x.props.onFocus,d)})}(0,c.useIsomorphicLayoutEffect)(()=>{if(y){const e=e=>{!b.openByClick&&!b.openByKeyboard&&"Escape"===e.key&&(m(),h(!0),O(),yt(C),null==n||n(e,{open:!1}),e.stopPropagation())};return null==l||l.addEventListener("keydown",e,{capture:!0}),()=>{null==l||l.removeEventListener("keydown",e,{capture:!0})}}},[l,y]);let E=d;return x&&(E=I?[I,x]:x),{...(0,nt.usePopover_unstable)({...e,children:E,onOpenChange:(e,t)=>{D.current||(t.open||(m(),O(),yt(C)),null==n||n(e,t)),D.current=!1},open:null!=a?a:y,positioning:"string"==typeof i?{autoSize:!0,...(0,tt.resolvePositioningShorthand)(i)}:{autoSize:!0,...i},unstable_disableAutoFocus:null!=s?s:_}),isPreviewLocked:b.openByClick||b.openByKeyboard}})(e));xt.displayName="Preview";const Ct=e=>{const t=(e=>(0,nt.usePopoverTrigger_unstable)(e))(e);return(e=>(0,nt.renderPopoverTrigger_unstable)(e))(t)};Ct.displayName="PreviewTrigger";const Ot=(0,c.__resetStyles)("rd6u8g",null,[".rd6u8g{color:var(--colorNeutralForeground3);display:flex;flex-direction:column;max-width:calc(256px - var(--spacingHorizontalXS) * 2);padding:var(--spacingVerticalS) var(--spacingHorizontalS);row-gap:var(--spacingVerticalXS);word-break:break-word;box-sizing:border-box;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase200);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase200);}"]),wt=o.forwardRef((e,t)=>{const n=((e,t)=>({components:{root:"div"},root:c.slot.always((0,c.getIntrinsicElementProps)("div",{ref:t,...e}),{elementType:"div"})}))(e,t);return(e=>{const t=Ot();e.root.className=(0,c.mergeClasses)("fai-PreviewContent",t,e.root.className)})(n),(e=>((0,c.assertSlots)(e),(0,c.jsx)(e.root,{})))(n)});wt.displayName="PreviewContent";const Et=(0,c.__styles)({root:{Bt984gj:"f1q9h2pe",B7ck84d:"f1ewtqcl",mc9l5x:"ftuwxu6",Brf1p80:"f4d9j23",sshi5w:"f1pha7fy"},heading:{Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"flh3ekv",Bg96gwp:"fwrc4pm",sj55zd:"f19n0e5"},message:{},previewSurface:{B2u0y6b:"fwf794f"},trigger:{Bt984gj:"f122n59",mc9l5x:"ftuwxu6"},backplate:{De3pzq:"f16xq7d1",B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"f68mrw8",h3c5rm:["f7pw515","fw35ms5"],B9xav0g:"frpde29",zhjwy3:["fw35ms5","f7pw515"],Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"ft85np5",Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fa9u6mc",Jwef8y:"f1h648pw",Bgoe8wy:"fvcxoqz",Bwzppfd:["f1ub3y4t","f1m52nbi"],oetu4i:"f1xlaoq0",gg5e9n:["f1m52nbi","f1ub3y4t"],Bi91k9c:"fnwyq0v"},":hover:active":{De3pzq:"f1xndk82",g2u3we:"f1q2k61k",h3c5rm:["f1qqrid1","f148nk5o"],B9xav0g:"f6uf0aq",zhjwy3:["f148nk5o","f1qqrid1"],sj55zd:"f20gb8v"}},{d:[".f1q9h2pe{align-items:stretch;}",".f1ewtqcl{box-sizing:border-box;}",".ftuwxu6{display:inline-flex;}",".f4d9j23{justify-content:center;}",".f1pha7fy{min-height:24px;}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".flh3ekv{font-weight:var(--fontWeightBold);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f19n0e5{color:var(--colorNeutralForeground1);}",".fwf794f{max-width:293px;}",".f122n59{align-items:center;}",".f16xq7d1{background-color:var(--colorNeutralBackground3);}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f68mrw8{border-top-color:var(--colorNeutralStroke2);}",".f7pw515{border-right-color:var(--colorNeutralStroke2);}",".fw35ms5{border-left-color:var(--colorNeutralStroke2);}",".frpde29{border-bottom-color:var(--colorNeutralStroke2);}",[".ft85np5{border-radius:var(--borderRadiusMedium);}",{p:-1}],[".fa9u6mc{padding:var(--spacingVerticalXXS) var(--spacingHorizontalXS);}",{p:-1}],".f1xndk82{background-color:var(--colorNeutralBackground3Pressed);}",".f1q2k61k{border-top-color:var(--colorNeutralStroke1Pressed);}",".f1qqrid1{border-right-color:var(--colorNeutralStroke1Pressed);}",".f148nk5o{border-left-color:var(--colorNeutralStroke1Pressed);}",".f6uf0aq{border-bottom-color:var(--colorNeutralStroke1Pressed);}",".f20gb8v{color:var(--colorNeutralForeground2Pressed);}"],h:[".f1h648pw:hover{background-color:var(--colorNeutralBackground3Hover);}",".fvcxoqz:hover{border-top-color:var(--colorNeutralStroke1Hover);}",".f1ub3y4t:hover{border-right-color:var(--colorNeutralStroke1Hover);}",".f1m52nbi:hover{border-left-color:var(--colorNeutralStroke1Hover);}",".f1xlaoq0:hover{border-bottom-color:var(--colorNeutralStroke1Hover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}"]}),At=o.forwardRef((e,t)=>{const n=((e,t)=>{const{withBackplate:n=!1,withArrow:a=!1}=e;return{positioning:{offset:8,...(0,tt.resolvePositioningShorthand)(e.positioning)},withBackplate:n,withArrow:a,components:{root:"span",heading:"span",message:"span",previewSurface:bt,trigger:"span"},root:c.slot.always((0,c.getIntrinsicElementProps)("span",{ref:t,...e}),{elementType:"span"}),heading:c.slot.optional(e.heading,{elementType:"span"}),message:c.slot.optional(e.message,{elementType:"span"}),previewSurface:c.slot.optional(e.previewSurface,{defaultProps:{tabIndex:0},elementType:bt,renderByDefault:!0}),trigger:c.slot.optional(e.trigger,{elementType:"span",defaultProps:{children:e.children},renderByDefault:!0})}})(e,t);return(e=>{const{withBackplate:t}=e,n=Et();e.root.className=(0,c.mergeClasses)("fai-SensitivityTooltip",n.root,e.root.className),e.heading&&(e.heading.className=(0,c.mergeClasses)("fai-SensitivityTooltip__heading",n.heading,e.heading.className)),e.message&&(e.message.className=(0,c.mergeClasses)("fai-SensitivityTooltip__message",n.message,e.message.className)),e.previewSurface&&(e.previewSurface.className=(0,c.mergeClasses)("fai-SensitivityTooltip__previewSurface",n.previewSurface,e.previewSurface.className)),e.trigger&&(e.trigger.className=(0,c.mergeClasses)("fai-SensitivityTooltip__trigger",n.trigger,t&&n.backplate,e.trigger.className))})(n),(e=>((0,c.assertSlots)(e),(0,c.jsx)(e.root,{children:e.previewSurface&&(0,c.jsxs)(xt,{withArrow:e.withArrow,trapFocus:!0,positioning:e.positioning,children:[(0,c.jsx)(Ct,{children:e.trigger&&(0,c.jsx)(e.trigger,{})}),(0,c.jsx)(e.previewSurface,{children:(0,c.jsxs)(wt,{children:[e.heading&&(0,c.jsx)(e.heading,{}),e.message&&(0,c.jsx)(e.message,{})]})})]})})))(n)});At.displayName="SensitivityTooltip";const Lt=Ae("Search20Regular","20",["M12.73 13.44a6.5 6.5 0 1 1 .7-.7l3.42 3.4a.5.5 0 0 1-.63.77l-.07-.06-3.42-3.41Zm-.71-.71A5.54 5.54 0 0 0 14 8.5a5.5 5.5 0 1 0-1.98 4.23Z"]),kt=Ae("Shield16Filled","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v3c0 3.22-1.64 5.4-4.84 6.47a.5.5 0 0 1-.32 0C4.64 12.91 3 10.72 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85Z"]),Mt=Ae("Shield16Regular","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v3c0 3.22-1.64 5.4-4.84 6.47a.5.5 0 0 1-.32 0C4.64 12.91 3 10.72 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85ZM8 3.19a6.65 6.65 0 0 1-4 1.8V7.5c0 1.43.36 2.57 1.02 3.45.64.85 1.61 1.54 2.98 2.02a6.13 6.13 0 0 0 2.98-2.02A5.57 5.57 0 0 0 12 7.5V4.98a6.64 6.64 0 0 1-4-1.8Z"]),Pt=Ae("ShieldLock16Filled","16",["M8.35 2.15a.5.5 0 0 0-.7 0A5.72 5.72 0 0 1 3.5 4a.5.5 0 0 0-.5.5v3c0 2.92 1.35 5 4 6.15V10a2 2 0 0 1 1.5-1.94V8A3 3 0 0 1 13 5.4v-.9a.5.5 0 0 0-.5-.5c-1.53 0-2.9-.61-4.15-1.85ZM9.5 9V8a2 2 0 1 1 4 0v1h.5a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1h.5Zm1-1v1h2V8a1 1 0 1 0-2 0Zm1.75 4a.75.75 0 1 0-1.5 0 .75.75 0 0 0 1.5 0Z"]),Tt=Ae("ShieldLock16Regular","16",["M7.65 2.15c.2-.2.5-.2.7 0A5.71 5.71 0 0 0 12.5 4c.28 0 .5.22.5.5v.9c-.3-.17-.64-.3-1-.36v-.06a6.64 6.64 0 0 1-4-1.8 6.65 6.65 0 0 1-4 1.8V7.5c0 1.43.36 2.57 1.02 3.45A5.54 5.54 0 0 0 7 12.55v1.1A6.24 6.24 0 0 1 3 7.5v-3c0-.28.22-.5.5-.5 1.53 0 2.9-.61 4.15-1.85ZM9.5 8v1H9a1 1 0 0 0-1 1v4a1 1 0 0 0 1 1h5a1 1 0 0 0 1-1v-4a1 1 0 0 0-1-1h-.5V8a2 2 0 1 0-4 0Zm1 1V8a1 1 0 1 1 2 0v1h-2Zm1 2.25a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5Z"]),Ut=(0,c.__styles)({root:{mc9l5x:"f14t3ns0",qhf8xq:"f10pi13n",a9b677:"fjw5fx7",Bqenvij:"fd461yt"},backgroundIcon:{qhf8xq:"f1euv43f",Bj3rh1h:"f11zp4z2"},foregroundIcon:{qhf8xq:"f1euv43f",Bj3rh1h:"f19g0ac",sj55zd:"f19n0e5"}},{d:[".f14t3ns0{display:inline-block;}",".f10pi13n{position:relative;}",".fjw5fx7{width:16px;}",".fd461yt{height:16px;}",".f1euv43f{position:absolute;}",".f11zp4z2{z-index:0;}",".f19g0ac{z-index:1;}",".f19n0e5{color:var(--colorNeutralForeground1);}"]}),Ft=o.forwardRef((e,t)=>{const n=((e,t)=>{var n,a;const{fillColor:i,withLock:r=!1,role:s="img"}=e,d={components:{root:"span",foregroundIcon:"span",backgroundIcon:"span"},root:c.slot.always((0,c.getIntrinsicElementProps)("span",{ref:t,role:s,...e}),{elementType:"span"}),foregroundIcon:c.slot.optional(e.foregroundIcon,{renderByDefault:!0,elementType:"span"}),backgroundIcon:c.slot.optional(e.backgroundIcon,{renderByDefault:!0,elementType:"span"})};return!!o.Children.count(null===(n=d.foregroundIcon)||void 0===n?void 0:n.children)||!!o.Children.count(null===(a=d.backgroundIcon)||void 0===a?void 0:a.children)||(d.foregroundIcon&&(d.foregroundIcon.children=r?o.createElement(Tt,null):o.createElement(Mt,null)),d.backgroundIcon&&i&&(d.backgroundIcon.children=r?o.createElement(Pt,{primaryFill:i}):o.createElement(kt,{primaryFill:i}))),d})(e,t);return(e=>{const t=Ut();e.root.className=(0,c.mergeClasses)("fai-SensitivityIcon",t.root,e.root.className),e.foregroundIcon&&(e.foregroundIcon.className=(0,c.mergeClasses)("fai-SensitivityIcon__foregroundIcon",t.foregroundIcon,e.foregroundIcon.className)),e.backgroundIcon&&(e.backgroundIcon.className=(0,c.mergeClasses)("fai-SensitivityIcon__backgroundIcon",t.backgroundIcon,e.backgroundIcon.className))})(n),(e=>((0,c.assertSlots)(e),(0,c.jsxs)(e.root,{children:[e.backgroundIcon&&(0,c.jsx)(e.backgroundIcon,{}),e.foregroundIcon&&(0,c.jsx)(e.foregroundIcon,{}),e.root.children]})))(n)});Ft.displayName="SensitivityIcon";var Ht=H(280),Rt=H(6277),Nt=H(9940),Bt="requiredDiagnostic",jt="optionalDiagnostic",Vt="requiredService",zt=e,Gt=(0,Nt.createPairedEvent)({eventName:"Api,Qos,",shortEventName:"Api"},{url:1,privacyClassification:{isPrefixingDisabled:!0,type:1}},Rt.Qos).withData({privacyClassification:zt.requiredService});function Kt(e){return function(e){return!!e&&!0===e.__isPrivacyDataWrapper}(e)?e._value:e}var Wt=function(e){void 0===e&&(e={});var t,n,a=e.message,i=e.innerError;a&&("string"==typeof a?t=a:(t=Kt(a))&&(n=a)),!t&&i&&(t=i.message,i.loggableMessage&&(n=i.loggableMessage));var r=new Error(t);for(var o in this.message=r.message,this.innerError=i,this.loggableMessage=n||function(e,t){if(void 0!==e&&""!==e)return{_value:Kt(e),_type:"unsafe",__isPrivacyDataWrapper:!0}}(this.message),this.stack=r.stack,this.name=r.name,this)Object.prototype.hasOwnProperty.call(this,o)&&(r[o]=this[o]);var s=Object.getPrototypeOf(this);if(Error.captureStackTrace&&Error.captureStackTrace(r,s),Object.setPrototypeOf)return Object.setPrototypeOf(r,s),r};try{Object.setPrototypeOf&&(Wt.prototype=Object.create(Error.prototype,{constructor:{value:Error,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf(Wt,Error))}catch(e){}var qt=function(e){function t(t){var n=e.call(this,t)||this;n.name="ApiError";var a=t.innerError||void 0,i=a?(0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({},"string"==typeof a.correlationId?{correlationId:a.correlationId}:{}),"boolean"==typeof a.isExpected?{isExpected:a.isExpected}:{}),"string"==typeof a.name?{code:a.name}:{}),"string"==typeof a.code?{code:a.code}:{}),"object"==typeof a.extraData?{extraData:a.extraData}:{}):{},r=t.correlationId,o=void 0===r?i.correlationId:r,s=t.isExpected,c=void 0===s?i.isExpected:s,d=t.extraData;return n.correlationId=o,n.isExpected=!!c,n.code="function"==typeof t.code?t.code(i.code)||"":t.code||i.code||"",n.extraData=(0,Ht.__assign)((0,Ht.__assign)({},i.extraData||{}),d||{}),n}return(0,Ht.__extends)(t,e),t}(Wt),Qt=function(e){function t(t,n){var a=this,i=n.response,r=(void 0===i?{}:i).error,o=(void 0===r?{}:r).innerError,s=(void 0===o?{}:o).stackTrace,c=void 0===s?"":s,d=n.response,l=n.request,u=n.status,f=n.code,p=void 0===f?Jt(d,u,function(e){return"".concat(e)})||"unhandled":f,m=(0,Ht.__assign)({innerError:t,code:p},n);return(a=e.call(this,m)||this).name="GraphError",a.response=d,a.status=u,a.serverStack=c,a.request=l,a.error=t,a}return(0,Ht.__extends)(t,e),t}(qt);function Yt(e){var t={};if(t.errorMessage=e.message,function(e){return!!e&&e instanceof Qt}(e)){t.vroomStatus=e.status;var n=e.response;if(n&&n.error){var a=n.error;t.vroomErrorCode=a.code,t.vroomErrorMessage=a.message;var i=a.innerError||a.innererror;i&&(t.vroomErrorInnerCode=i.code,t.vroomErrorInnerMessage=i.message,t.vroomErrorInnerDebugMessage=i.debugMessage,t.vroomErrorInnerStack=i.stackTrace)}}return t}function Jt(e,t,n){if(e){for(var a=[],i=e.error;i;)a.push(i),i=i.innerError||i.innererror;for(;i=a.pop();)if(void 0!==i.code){var r=n(i.code);if(void 0!==r)return r}}return n(t)}var Xt,Zt=H(4088),$t="Authorization",en=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl"}(Xt||(Xt={}));var tn=function(e,t){var n;void 0===e&&(e="");var a=null!==(n=null==t?void 0:t.allowDataUrl)&&void 0!==n&&n,i=e.indexOf("//"),r=e.indexOf("/"),o=i>-1&&i<=r?i+"//".length:-1,s=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,o),c=s&&s.slice(o),d=e.slice(s.length),l=s?Xt.absolute:a&&en.test(e)?Xt.dataUrl:"/"===d[0]?Xt.serverRelative:Xt.relative,u=d.split("/");this.authority=s,this.domain=c,this.format=l,this.path=d,this.segments=u,this.value=e};function nn(e,t){var n,a,i;try{for(var r=(0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({},globalThis.window&&window.location.origin?((n={})[window.location.origin]="<location.origin>",n):{}),globalThis.window&&(null===(i=window._spPageContextInfo)||void 0===i?void 0:i.webAbsoluteUrl)?((a={})[window._spPageContextInfo.webAbsoluteUrl]="<pageContext.webAbsoluteUrl>",a):{}),t||{}),o=new tn(e),s=o.authority,c=o.path,d=s,l=0,u=Object.keys(r);l<u.length;l++){var f=u[l];if(e.slice(0,f.length)===f){c=e.slice(f.length),d=r[f];break}}var p=c.split("/");return"".concat(d,"/{ length: ").concat(c.length,", segments: ").concat(p.length," }")}catch(e){return"ErrorWhileScrubbingUrl"}}function an(e){var t,n,a=null!==(n=null===(t=e.getAllResponseHeaders())||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"";return a.indexOf("sprequestguid")>=0&&e.getResponseHeader("sprequestguid")||a.indexOf("request-id")>=0&&e.getResponseHeader("request-id")||void 0}function rn(e){var t,n;return(null!==(n=null===(t=e.getAllResponseHeaders())||void 0===t?void 0:t.toLowerCase())&&void 0!==n?n:"").indexOf("ms-cv:")>=0&&e.getResponseHeader("MS-CV")||void 0}var on=!Rt.KillSwitch.isActivated("884C4D49-FAA1-41DA-AB27-76D985D391FF"),sn=Rt.KillSwitch.isActivated("E70D6CFA-D257-4F72-9045-2BF6BB243817"),cn=Rt.KillSwitch.isActivated("32629518-3CBD-4B34-8DAC-52AC471DCC11"),dn=(new Set,new Set,window&&window.performance),ln={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},un="Bearer",fn=function(){function e(e,t){this._sendSyncClientHeadersKs=Rt.KillSwitch.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");var n=e.alwaysSendContentType,a=void 0!==n&&n,i=t.sessionManagementProvider,r=t.urlDataSource,o=t.apiEvent,s=void 0===o?Gt:o,c=t.cookieOrigin,d=t.isOffline,l=t.dataSyncClient;this._sessionManagementProvider=i,this._alwaysSendContentType=a,this._apiEvent=s,this._apiName=r&&"function"==typeof r.getApiName?r.getApiName():"Vroom",this._urlDataSource=r,this._cookieOrigin=c,this._isOffline=d,this._dataSyncClient=l,this._encodingFixEnabled=!Rt.KillSwitch.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!Rt.FeatureOverrides.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!Rt.KillSwitch.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}return e.prototype.send=function(e){var t=this,n=function(n){var a,i,r,o,s=e.headers,c=void 0===s?{}:s,d=e.driveUrl,l=e.driveId,u=e.apiName,f=e.disableLogging,p=void 0!==f&&f,m=e.timeout,_=e.onProgress,h=e.onUploadProgress,g=e.qosExtraData,v=e.apiVersion,y=void 0===v?"v2.0":v,S=e.needsAuthorization,D=void 0===S||S,I=e.useStrongAuthToken,x=void 0!==I&&I,C=e.postProcessQos,O=e.breakCache,w=e.allowCookies,E=e.hasContentType,A=void 0===E||E,L=e.useMultiPart,k=void 0!==L&&L,M=e.getErrorAsMessage,P=void 0!==M&&M,T=e.expectedErrors,U=e.disallowSelfIssuedToken,F=e.endpoint,H=n.path,R=n.accessToken,N=n.forceContentType,B=void 0!==N&&N,j=n.useExactAuthToken,V=void 0!==j&&j,z=n.headers;if(!F){var G="v2.1"===y?y:void 0;F=t._urlDataSource?"function"==typeof t._urlDataSource.getApiBaseUrl?t._urlDataSource.getApiBaseUrl({apiVersion:G,driveId:l}):null===(i=(a=t._urlDataSource).getVroomApiBaseUrl)||void 0===i?void 0:i.call(a):void 0}var K=null===(o=null===(r=t._urlDataSource)||void 0===r?void 0:r.getRoutingKey)||void 0===o?void 0:o.call(r);if(t._driveIdUrlCheckEnabled&&d&&l&&("me"!==l?"".concat(F,"/drives/").concat(l):d)!==d)throw new qt({code:"DriveIdAndDriveUrlMismatch"});var W=(0,Ht.__assign)((0,Ht.__assign)({},ln),e.expectedErrorCodes||{}),q=e.requestType,Q=void 0===q?"GET":q,Y=t._cookieOrigin,J=new b.SimpleUri(H).authority?H:"".concat(F).concat(H),X=function(n){var a,i,r,o="",s={};k?(o=Rt.Guid.generate(),s={"Content-Type":"multipart/form-data;boundary=".concat(o)}):s=(0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({Accept:"application/json"},(e.postData||t._alwaysSendContentType)&&A||B?{"Content-Type":"application/json"}:{}),n.useCookies&&n.digestValue?{"x-requestdigest":n.digestValue}:{}),K?{"X-FDROUTEKEYHEADER":K}:{}),P?{prefer:"rich-error-as-message"}:{}),Rt.KillSwitch.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{}:{"Accept-Language":Rt.Locale.language}),c),t._sendSyncClientHeadersKs?{}:z),n.sessionToken&&n.sessionToken.tokenUrl&&0===H.indexOf("/drive/")?r=new Rt.Uri("".concat(n.sessionToken.tokenUrl,"/").concat(H.substring(7))):(r=new Rt.Uri(H),F&&!r.getScheme()&&(r=new Rt.Uri(F+H))),k&&(r.setQueryParameter("ump","1"),"POST"!==Q&&(c["X-HTTP-Method-Override"]=Q),Q="POST");var d,l,f=function(e){var t=e.sessionToken,n=e.useExactAuthToken;if(t){var a=t.accessToken,i=t.proofToken,r=t.wlidToken,o=t.isBadger;if(r)return{name:$t,value:"wlid1.1 ".concat(r)};if(a)return{name:$t,value:n?a:"".concat(o?"badger":"bearer"," ").concat(a)};if(i)return{name:"X-PROOF_TOKEN",value:i}}}({sessionToken:n.sessionToken,useExactAuthToken:V});if(k||f&&(s=(0,Ht.__assign)((0,Ht.__assign)({},s),((a={})[f.name]=f.value,a))),k){if(d="",d+="--".concat(o,"\r\n"),d+="Content-Disposition: form-data;name=data\r\n",c)for(var v=0,y=Object.keys(c);v<y.length;v++){var S=y[v];d+="".concat(S,": ").concat(c[S],"\r\n")}d+="Content-Type: application/json\r\n",f&&(d+="".concat(f.name,": ").concat(f.value,"\r\n")),P&&(d+="prefer: rich-error-as-message\r\n"),d+="\r\n",d+="".concat(void 0!==e.postData?e.postData:"","\r\n"),d+="--".concat(o,"--")}O&&r.setQueryParameter("r",Math.random().toFixed(8)),(null===(i=n.sessionToken)||void 0===i?void 0:i.authKey)&&r.setQueryParameter("authKey",n.sessionToken.authKey);var D="".concat(t._apiName,"DataRequest.").concat(u);if(!p){var I={url:nn(r.toString()),name:D,extraData:g};l=new t._apiEvent(I)}var x=r.toString(),w=dn&&dn.now();return b.XHRPromise.start({url:x,headers:s,method:Q,json:d||e.postData||"",requestTimeoutInMS:m,withCredentials:n.useCookies,onProgress:_,onUploadProgress:h,responseType:e.responseType||void 0}).then(function(t){var n=(0,b.getRequestEntryDurationMetrics)(x,w);if(l){var a=an(t),i={resultType:Rt.ResultTypeEnum.Success,extraData:(0,Ht.__assign)((0,Ht.__assign)({},g||{}),{rawRequestDuration:n.duration,performanceEntry:JSON.stringify(n),requestId:a,CorrelationId:a,MSCorrelationVector:rn(t)})};l.end(i)}return e.parseResponse?e.parseResponse(t):0===t.responseText.length?null:JSON.parse(t.responseText)},function(e){return(0,Ht.__awaiter)(t,void 0,void 0,function(){var t,a,i,o,s,c,d,u,f,p,m,_,h,v,y,S,I,O,E,A,L,k,M;return(0,Ht.__generator)(this,function(U){switch(U.label){case 0:return t=function(e,t){return C&&(e=C(e,t)),l&&l.end(e),Rt.Promise.reject(t)},a=(0,b.getRequestEntryDurationMetrics)(x,w),e instanceof Error?(i=Rt.Promise.isCanceled(e),o=i?Rt.ResultTypeEnum.ExpectedFailure:Rt.ResultTypeEnum.Failure,s={error:e.message,resultCode:i?"Canceled":"",resultType:o,extraData:{rawRequestDuration:a.duration,performanceEntry:JSON.stringify(a)}},[2,t(s,e)]):[3,1];case 1:if(("text"===e.responseType||""===e.responseType)&&e.responseText)try{c=JSON.parse(e.responseText)}catch(e){}if(!(!cn&&"blob"===e.responseType&&e.response&&e.response.size>0))return[3,5];U.label=2;case 2:return U.trys.push([2,4,,5]),u=(d=JSON).parse,[4,e.response.text()];case 3:return c=u.apply(d,[U.sent()]),[3,5];case 4:return U.sent(),[3,5];case 5:if(P)try{"string"==typeof(f=null===(M=null==c?void 0:c.error)||void 0===M?void 0:M.message)&&(p=this._encodingFixEnabled?JSON.parse(decodeURIComponent(escape(atob(f)))):JSON.parse(atob(f)),c={error:p})}catch(e){}return m=e.status,_=e.statusText,h=(c||{}).error,y=(v=void 0===h?{}:h).message,S=void 0===y?"":y,I=v.innerError,E=(O=void 0===I?{}:I).stackTrace,A=void 0===E?"":E,L=O.debugMessage,k=void 0===L?"":L,[2,(m||!this._isOffline?Rt.Promise.resolve(!1):this._isOffline()).then(function(i){var o=an(e),s=i||!!Jt(c,m,function(e){return W[e]||!(!T||!(0,Zt.isExpectedError)({code:"".concat(e),message:S},T))||void 0}),d=function(e){var t=e.error,n=e.isOffline,a=(null==t?void 0:t.message)||"",i=a;return("string"!=typeof i&&i.value?i.value:a)||(n?"Offline":"")}({error:null==c?void 0:c.error,isOffline:i}),l=new Qt(new Error(d),{response:c,status:m,request:e,correlationId:o,isExpected:s,extraData:{apiEventName:D}}),u={resultType:s?Rt.ResultTypeEnum.ExpectedFailure:Rt.ResultTypeEnum.Failure,error:S,resultCode:l.code,extraData:(0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({},g||{}),Yt(l)),{stack:A,httpStatus:m,httpStatusText:_,requestId:o,CorrelationId:o,MSCorrelationVector:rn(e),debugMessage:k,accessTokenLength:n.sessionToken&&n.sessionToken.accessToken?n.sessionToken.accessToken.length:-1,urlLength:r.toString().length,useCookies:!!n.useCookies,isOffline:i,rawRequestDuration:a.duration,performanceEntry:JSON.stringify(a)})};return t(u,l)})]}})})})},Z=t._sessionManagementProvider;if(D){if(R)return X({sessionToken:R});if(on&&x&&Z&&Z.getToken)return Z.getToken({apiVersion:y,path:J,apiQosName:u,useStrongAuthToken:!0}).then(function(e){return X({sessionToken:e})});var $=new b.SimpleUri(J).authority;if(w&&$&&Y&&$===Y){if("GET"===Q)return X({useCookies:!0});if(Z&&Z.getFormDigest)return Z.getFormDigest({url:J}).then(function(e){return X({digestValue:e,useCookies:!0})})}if(Z&&Z.getSessionToken){var ee={apiVersion:y,endpoint:F,driveUrl:d,path:J,apiQosName:u,disallowSelfIssuedToken:sn?void 0:U};return Rt.Promise.resolve(Z.getSessionToken(ee)).then(function(e){return X({sessionToken:e}).catch(function(t){return Z.getSessionToken&&e&&function(e){if(e instanceof Qt){var t=e.request,n=t&&t.getResponseHeader("WWW-Authenticate");if(n&&n.slice(0,un.length)===un&&n.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(t)?Z.getSessionToken((0,Ht.__assign)((0,Ht.__assign)({},ee),{claimsChallenge:{sessionToken:e,claims:pn(t),error:t}})).then(function(n){return n.accessToken!==e.accessToken?X({sessionToken:n}):Rt.Promise.reject(t)}):Rt.Promise.reject(t)})})}if(Z&&Z.getToken)return Z.getToken({apiVersion:y,path:J,apiQosName:u,disallowSelfIssuedToken:U}).then(function(e){return X({sessionToken:e})})}return X({})},a=(0,Ht.__assign)({},e);return!Rt.KillSwitch.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(e){var t=e.dataSyncClient,n=e.options,a=e.getData,i=function(){return a(n)};return Rt.Promise.resolve(t).then(function(t){return t?function(t){return t.getData({url:n.path,method:n.requestType},function(t){var n=t.endpoint,i=t.headers,r=t.onComplete,o=(0,Ht.__assign)((0,Ht.__assign)({},e.options),{path:n.url,accessToken:{accessToken:n.authToken},forceContentType:!0,useExactAuthToken:!0,headers:i,onComplete:r});return a(o)},i)}(t):i()})}({dataSyncClient:this._dataSyncClient,options:a,getData:n}):n(a)},e}();function pn(e){var t=e.request&&e.request.getResponseHeader("WWW-Authenticate"),n='claims="';if(t){var a=t.indexOf(n);if(a>-1){var i=t.indexOf('"',a+n.length);if(i>-1){var r=t.slice(a+n.length,i);return Rt.KillSwitch.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?r:atob(r)}}}}var mn=0,_n=1,hn=2,bn=r;function gn(e,t){for(var n="";n.length<e;){var a=16*(null!=t?t:Math.random)();n+=(a|=0).toString(16)}return n}function vn(e){var t=[];t.push(gn(8,e)),t.push(gn(4,e));var n="4"+gn(3,e);t.push(n);var a=gn(4,e),i=parseInt(a[0],16);return i&=3,a=(i|=8).toString(16)+a.substr(1),t.push(a),t.push(gn(12,e)),t.join("-")}var yn,Sn="undefined"==typeof window?self:window,Dn=Rt.KillSwitch.isActivated("18a3d374-cced-4d7f-be15-3b0a8dda8152"),In=Rt.KillSwitch.isActivated("9ed80e27-f0bc-4d9b-ad35-6407121dbfbb"),xn=Rt.KillSwitch.isActivated("88402522-C263-48C2-92B6-3A314BA00F90");!function(e){e.success="success",e.error="error"}(yn||(yn={}));var Cn="app",On="app_lastRead",wn="ODSP_DB",En="ODSP_DB_TABLE",An="lastModified",Ln="lastRead",kn="ODSP_DB_METADATA_TABLE",Mn="database_metadata",Pn="parentKey",Tn="reads",Un=(new function(e){var t="undefined"!=typeof window?window:"undefined"!=typeof self?self:void 0;e||(e=t&&t.navigator&&navigator.userAgent||"");var n,a=e,i=e.toLowerCase(),r=function(e){var t;function n(n){return t=RegExp("".concat(n,"(\\d+)([\\d.]*)")).exec(e)}e=e.toLowerCase();var a=n("msie ")||n("trident.*rv:"),i=t&&"9"===t[1],r=!t&&n("(?:edge|edgios)/"),o=!t&&n("edg/"),s=!t&&n("fxios|firefox/"),c=!t&&n("(?:chrome|crios)/"),d=!t&&/safari\/(\d+)/.test(e);d&&n("version/");var l=!t&&/compatible; [a-z]+;/.test(e);return l&&n("trident/"),{browserName:a||l?"IE":r?"Edge":o?"EdgeChromium":s?"Firefox":c?"Chrome":d?"Safari":"NA",isChrome:!!c,isEdge:!!r,isEdgeChromium:!!o,isFirefox:!!s,isIE:!!a||!!l,isIE9:!!i,isSafari:!!d,matchedBrowser:t}}(i),o={browserMajor:(n=r.matchedBrowser)&&parseInt(n[1],10)||0,browserMinor:n&&n[2]&&n[2].slice(1)||"0"},s=function(e){e=e.toLowerCase();var t=/windows phone|wpdesktop/.test(e),n=t||/ipad|iphone|ipod|android/.exec(e),a=n&&n[0],i="android"===a,r="ipad"===a,o=!!a&&!i,s=!n&&e.indexOf("macintosh")>-1,c=!n&&e.indexOf("windows nt")>-1;return{isAndroid:i,isIOS:o,isIPad:r,isMac:s,isWindows:c,isWinPhone:!!t,isMobile:!!n,osName:c?"Windows":t?"Windows Phone":s?"OSX":o?"IOS":i?"Android":"NA"}}(i),c=s.isMobile,d=/electron\/\\d+[\\d.]*/.test(i),l=!("undefined"==typeof window||!window.matchMedia)&&(window.matchMedia("(display-mode: standalone)").matches||window.matchMedia("(display-mode: minimal-ui)").matches),u=/[\s\(](os|os x|windows (?:phone|nt)|android) ([\d._]+)/.exec(i),f=!1,p=!1,m=!1,_=!1;if(t&&t.document){var h=document.createElement("style");h.type="text/css",f=!h.styleSheet,p="addBehavior"in HTMLDivElement.prototype;var b=document.createElement("input");b.type="file";var g=t.File,v=g&&g.prototype;_=!(!v||!(v.slice||v.mozSlice||v.webkitSlice)),m="webkitdirectory"in b&&!d}return(0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({},r),o),s),{isElectron:d,osVersion:u?u[2]:"NA",isWindows81:!c&&/windows (?:8\.1|nt 6\.3)/.test(i),isWindows10:!c&&i.indexOf("windows nt 10")>-1,isWindows7:!c&&i.indexOf("windows nt 6.1")>-1,isPWA:l,areCSS3TransitionsSupported:!r.isIE||o.browserMajor>9,areTouchEventsSupported:!!t&&"ontouchstart"in t,isFolderUploadSupported:m,isHtml5FileUploadSupported:_,isRetinaSupported:!!t&&t.devicePixelRatio>1,isUnlimitedStyleSheetsSupported:f,isWebDavSupported:p,userAgent:a})}).isFirefox,Fn="indexedDB is not supported",Hn=function(){function e(t){if(!("indexedDB"in Sn)||!Sn.indexedDB)throw new Error(Fn);var n,a;this._logger=t,e._openDBPromise||(Dn||(n=this._logger({name:"PersistentCacheIDB.openDB"}),a=Date.now()),e._openDBPromise=this._openIndexedDB().then(function(t){return Dn||n&&n({resultType:Rt.ResultTypeEnum.Success,extraData:{dbOpen:Math.round(Date.now()-a)}}),e._db=t,t}).catch(function(e){throw Dn||n&&n({resultType:Rt.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}))}return e.prototype.freeSpace=function(t,n){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return(0,Ht.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=a.transaction([En],"readwrite").objectStore(En).index(On).openCursor();r.onsuccess=function(a){var i=r.result;i?(i.value.app===t&&n>0&&(n-=i.value.size,i.delete()),n>0?i.continue():e()):e()},r.onerror=function(e){o._errorHandling(e,i)}})]}})})},e.prototype.read=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){return(0,Ht.__generator)(this,function(t){return[2,this._readInternal(En,function(t){return t.get(e)})]})})},e.prototype.rangeQuery=function(t){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c,d,l,u,f,p,m,_=this;return(0,Ht.__generator)(this,function(h){switch(h.label){case 0:return n={},i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=h.sent(),h.label=2;case 2:return a=i._db=r,o=a.transaction([En],"readonly"),s=o.objectStore(En),c=[],d=t.index,l=t.range,u=t.direction,f=t.count,p=s.index(d),(m=p.openKeyCursor(l,u)).onerror=function(e){_._errorHandling(e,n.reject)},m.onsuccess=function(e){var t=e.target.result;t?(c.push(t.primaryKey),c.length>=f?n.resolve(c):t.continue()):n.resolve(c)},[2,new Promise(function(e,t){n.resolve=e,n.reject=t})]}})})},e.prototype.write=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t;return(0,Ht.__generator)(this,function(n){return t=e.key,void 0!==e.data?[2,this._writeInternal({tableName:En,key:t,row:(0,Ht.__assign)((0,Ht.__assign)({},e),{lastModified:Date.now()})})]:void 0!==e.parentKey?[2,this._deleteDataRows(e.parentKey)]:[2,this._writeInternal({tableName:En,key:t,row:void 0})]})})},e.prototype.statistics=function(){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var e,t;return(0,Ht.__generator)(this,function(n){switch(n.label){case 0:return this._dbMetaData?[3,2]:[4,this._readAndSetMetadataDB()];case 1:e=n.sent(),this._dbMetaData=e,n.label=2;case 2:return[4,this._iterate(En,function(e){return e.size})];case 3:return t=n.sent(),[2,{metaData:this._dbMetaData,count:t.length,totalBytes:t.reduce(function(e,t){return e+t},0)}]}})})},e.prototype._openIndexedDB=function(){var t=this;return new Promise(function(n,a){if(e._db)n(e._db);else{var i=In&&Un?indexedDB.open(wn,{version:4,storage:"temporary"}):indexedDB.open(wn,4);i.onerror=function(e){t._errorHandling(e,a)},i.onsuccess=function(t){var a=e._db=i.result;n(a)},i.onupgradeneeded=function(e){var n=e.target.result;n.onerror=function(e){t._errorHandling(e,a)};var r=e.oldVersion;t._handleDBUpgrade(i,n,r)}}})},e.prototype._handleDBUpgrade=function(e,t,n){var a;n<1&&((a=t.createObjectStore(En,{keyPath:"key"})).createIndex(An,An,{unique:!1}),a.createIndex(Tn,Tn,{unique:!1}),t.createObjectStore(kn,{keyPath:"key"})),n<2&&((a=a||e.transaction.objectStore(En)).createIndex(Cn,Cn,{unique:!1}),a.createIndex(Ln,Ln,{unique:!1}),a.createIndex(On,[Cn,Ln],{unique:!1})),n<3&&((a=a||e.transaction.objectStore(En)).createIndex("app_lastModified",[Cn,An],{unique:!1}),a.createIndex("app_reads",[Cn,Tn],{unique:!1})),n<4&&((a=a||e.transaction.objectStore(En)).createIndex(Pn,Pn,{unique:!1}),a.createIndex("parentKey_app",[Pn,Cn],{unique:!1}),a.createIndex("parentKey_app_lastModified",[Pn,Cn,An],{unique:!1}),a.createIndex("parentKey_app_lastRead",[Pn,Cn,Ln],{unique:!1}),a.createIndex("parentKey_app_reads",[Pn,Cn,Tn],{unique:!1}))},e.prototype._readAndSetMetadataDB=function(){var e=this;return this._readInternal(kn,function(e){return e.get(Mn)}).then(function(t){if(t)return t.data;var n={id:vn(),created:Date.now(),cacheType:bn.indexedDB};return e._writeInternal({tableName:kn,key:Mn,row:{key:Mn,data:n}}).then(function(){return n})})},e.prototype._readInternal=function(t,n){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var a,i,r,o=this;return(0,Ht.__generator)(this,function(s){switch(s.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=s.sent(),s.label=2;case 2:return a=i._db=r,[2,new Promise(function(e,i){var r=o._logger({name:"PersistentCacheIDB.readInternal"}),s=Date.now(),c=a.transaction([t],"readonly").objectStore(t),d=n(c);d.onsuccess=function(t){xn&&r({resultType:Rt.ResultTypeEnum.Success,extraData:{io:Math.round(Date.now()-s)}}),e(d.result)},d.onerror=function(e){r({resultType:Rt.ResultTypeEnum.Failure,extraData:{io:Math.round(Date.now()-s)}}),o._errorHandling(e,i)}})]}})})},e.prototype._iterate=function(t,n){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var a,i,r,o,s=this;return(0,Ht.__generator)(this,function(c){switch(c.label){case 0:return i=e,(r=e._db)?[3,2]:[4,e._openDBPromise];case 1:r=c.sent(),c.label=2;case 2:return a=i._db=r,o=[],[2,new Promise(function(e,i){var r=a.transaction([t],"readonly").objectStore(t).openCursor();r.onsuccess=function(t){var a=r.result;a?(o.push(n(a.value)),a.continue()):e(o)},r.onerror=function(e){s._errorHandling(e,i)}})]}})})},e.prototype._writeInternal=function(t){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var n,a,i,r,o,s,c=this;return(0,Ht.__generator)(this,function(d){switch(d.label){case 0:return n=t.tableName,a=t.key,i=t.row,o=e,(s=e._db)?[3,2]:[4,e._openDBPromise];case 1:s=d.sent(),d.label=2;case 2:return r=o._db=s,[2,new Promise(function(e,t){try{var o=r.transaction([n],"readwrite"),s=o.objectStore(n);o.oncomplete=function(){},o.onerror=function(e){c._errorHandling(e,t)};var d=i?s.put(i):s.delete(a);d.onsuccess=function(t){e()},d.onerror=function(e){c._errorHandling(e,t)}}catch(e){throw e}})]}})})},e.prototype._deleteDataRows=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n=this;return(0,Ht.__generator)(this,function(a){return t=e.slice(0,e.length-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1),[2,this.rangeQuery({index:Pn,range:IDBKeyRange.bound(e,t,!1,!0),direction:"next"}).then(function(e){return Promise.all(e.map(function(e){return n._writeInternal({tableName:En,key:e,row:void 0})}))}).then(function(){})]})})},e.prototype._errorHandling=function(e,t){if(e.type===yn.error){var n=e.target.error;t({name:n.name,message:n.message,code:n.code})}},e}(),Rn="PersistentCache",Nn="PersistentCache_metadata",Bn=function(){function e(){try{if("localStorage"in Sn&&Sn.localStorage&&(this._localStorage=Sn.localStorage,!this._localStorage.getItem(Nn))){var e={id:vn(),created:Date.now(),cacheType:bn.localStorage};this._localStorage.setItem(Nn,JSON.stringify(e))}}catch(e){}if(!this._localStorage)throw new Error("localStorage is not supported")}return e.prototype.freeSpace=function(e,t){throw new Error("Method not implemented.")},e.prototype.read=function(e){return JSON.parse(this._localStorage.getItem(this._cacheKey(e)))},e.prototype.write=function(e){var t=e.key;if(void 0!==e.data){var n=(0,Ht.__assign)((0,Ht.__assign)({},e),{lastModified:Date.now()});this._localStorage.setItem(this._cacheKey(t),JSON.stringify(n))}else this._localStorage.removeItem(this._cacheKey(t))},e.prototype.statistics=function(){var e=[];for(var t in this._localStorage)if(0===t.indexOf(Rn)){var n=this._localStorage.getItem(t);e.push(n?n.length:0)}return{metaData:JSON.parse(this._localStorage.getItem(Nn)),count:e.length,totalBytes:e.reduce(function(e,t){return e+t},0)}},e.prototype.rangeQuery=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){return(0,Ht.__generator)(this,function(e){return[2,void 0]})})},e.prototype._cacheKey=function(e){return"".concat(Rn,"_").concat(e)},e}(),jn=0,Vn=function(){function e(){this._queue={}}return e.prototype.enqueue=function(e,t){var n=this._queue[e]=this._queue[e]||[],a=!0,i=[];n.length>0&&(n[0].schedule?(i=n.slice(1),this._queue[e]=[n[0]],a=!1):(i=this._queue[e],this._queue[e]=[]));var r=this._createUpateTask(e,t);return i.length>0&&(r.signal=i[0].signal),this._queue[e].push(r),a&&this._scheduleTask(e),r},e.prototype._createUpateTask=function(e,t){var n=this,a={};a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t});var i={execute:function(){return(0,Ht.__awaiter)(n,void 0,void 0,function(){var e;return(0,Ht.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,3,4]),[4,t()];case 1:return n.sent(),[3,4];case 2:return e=n.sent(),i.error=e,[3,4];case 3:return this._completeTask(i),[7];case 4:return[2]}})})},schedule:0,id:jn++,key:e,signal:a};return i},e.prototype._scheduleTask=function(e){var t=this._queue[e];if(t&&t.length>0){var n=t[0];n.schedule=Sn.setTimeout(n.execute,5)}},e.prototype._completeTask=function(e){var t=e.id,n=e.key,a=this._queue[n],i=a[0],r=a.slice(1);if(i.id!==t)throw new Error("this should not happen, currently running task must be the top of the queue");this._queue[n]=r,this._scheduleTask(n),e.error?e.signal.reject(e.error):e.signal.resolve()},e}();function zn(){return Sn.performance&&performance.now?Math.round(performance.now()):Date.now()}var Gn=Rt.KillSwitch.isActivated("2A0E7367-E6F7-4540-87A3-F3F5C5981CF3"),Kn="_odspcache_",Wn="_____",qn={cacheType:bn.indexedDB},Qn=function(){function e(e){var t=e.cacheType,n=void 0===t?qn.cacheType:t,a=(0,Ht.__rest)(e,["cacheType"]);if(this._config=(0,Ht.__assign)((0,Ht.__assign)({},a),{cacheType:n}),this._cacheSecret=this._config.secret,this._dataIsEncrypted=!!this._cacheSecret,this._crypto=this._config.crypto,this._dataIsEncrypted&&!this._crypto)throw new Error("When data needs encryption, crypto implementing ICrypto has to be provided when initiating PersistentCache.");this._cacheType=this._config.cacheType,this._app=e.app,this._cacheUpdateTaskManager=new Vn,this._qos=this._config.telemetry&&this._config.telemetry.qos,this._initLocalStorage(this._cacheType)}return Object.defineProperty(e.prototype,"configuration",{get:function(){return this._config},enumerable:!1,configurable:!0}),e.prototype.read=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s;return(0,Ht.__generator)(this,function(c){switch(c.label){case 0:t=e.cacheKey,n=e.validBufferTime,a=this._logQos({name:"PersistentCache.read"}),r=zn(),Date.now(),c.label=1;case 1:return c.trys.push([1,4,,5]),(o=this._getStorageKey(t))?[4,this._getData({cacheKey:t,storageKey:o,validBufferTime:n})]:[3,3];case 2:i=c.sent(),c.label=3;case 3:return i=i||{key:{original:t,encoded:o},app:this._app,data:void 0,cacheStats:{lastModified:NaN,lastRead:NaN,reads:0},cacheType:this._cacheType,performance:{total:Math.round(zn()-r)}},[3,5];case 4:throw s=c.sent(),a({resultType:Rt.ResultTypeEnum.Failure,error:s.message?s.message:s.toString(),extraData:{cacheResult:"miss"}}),s;case 5:return Gn&&a({resultType:Rt.ResultTypeEnum.Success,extraData:{cacheResult:"".concat(void 0!==i.data?"hit":"miss")}}),[2,Promise.resolve(i)]}})})},e.prototype.rangeQuery=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c=this;return(0,Ht.__generator)(this,function(d){if(this._cacheType!==bn.indexedDB)throw new Error("Only indexedDB supports range query, your storage does not support!");t=this._logQos({name:"PersistentCache.rangeQuery"}),n=0,a=zn(),i=Date.now(),o={lastModified:NaN,lastRead:i,reads:1};try{s=zn(),r=this._storage.rangeQuery(e).then(function(e){return n=Math.round(zn()-s),{key:void 0,app:void 0,data:e.map(function(e){return{original:c._getOriginalKeyFromCacheKey(e),encoded:e}}),cacheStats:o,cacheType:c._cacheType,performance:{io:n,total:Math.round(zn()-a)}}})}catch(e){throw t({resultType:Rt.ResultTypeEnum.Failure,error:e.message?e.message:e.toString()}),e}return t({resultType:Rt.ResultTypeEnum.Success}),[2,r||Promise.resolve({key:void 0,app:void 0,data:[],cacheStats:o,cacheType:this._cacheType,performance:{io:n,total:Math.round(zn()-a)}})]})})},e.prototype.update=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i=this;return(0,Ht.__generator)(this,function(r){switch(r.label){case 0:return t=e.cacheKey,n=e.data,a=this._getStorageKey(t),[4,this._cacheUpdateTaskManager.enqueue(a,function(){return i._doCacheUpdate(t,n)}).signal.promise];case 1:return r.sent(),this._logCacheStats(),[2]}})})},e.prototype.remove=function(e){var t=e.cacheKey;return(0,Ht.__awaiter)(this,void 0,void 0,function(){return(0,Ht.__generator)(this,function(e){return[2,this.update({cacheKey:t,data:void 0})]})})},e.prototype.freeSpace=function(e,t){return(0,Ht.__awaiter)(this,void 0,void 0,function(){return(0,Ht.__generator)(this,function(n){return[2,this._storage.freeSpace(e,t)]})})},e.prototype.readAndUpdate=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c,d=this;return(0,Ht.__generator)(this,function(l){switch(l.label){case 0:t=e.cacheKey,n=e.getData,a=zn(),i=Date.now(),r=this._logQos({name:"PersistentCache.readAndUpdate"}),o=n().then(function(e){var n={app:d._app,key:{original:t,encoded:d._getStorageKey(t)},data:e,cacheType:bn.none,cacheStats:{lastModified:void 0,lastRead:i,reads:1},performance:{total:Math.round(zn()-a)}};return d.update({cacheKey:t,data:e}),n}),l.label=1;case 1:l.trys.push([1,8,,9]),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,Promise.race([this.read(e),o])];case 3:return s=l.sent(),[3,5];case 4:return l.sent(),[3,5];case 5:return!s||s.cacheType!==bn.none&&void 0===s.data?[4,o]:[3,7];case 6:s=l.sent(),l.label=7;case 7:return[3,9];case 8:throw c=l.sent(),r({resultType:Rt.ResultTypeEnum.Failure,error:c.message?c.message:c.toString()}),c;case 9:return r({resultType:Rt.ResultTypeEnum.Success}),[2,s]}})})},e.prototype._initLocalStorage=function(e){if(e===bn.localStorage)this._storage=new Bn;else try{this._storage=new Hn(this._logQos.bind(this))}catch(e){e.message===Fn&&(this._storage=new Bn,this._cacheType=bn.localStorage)}},e.prototype._getStorageKey=function(e){var t=encodeURIComponent("".concat(e.key).concat(e.user?Wn+e.user:""));return"".concat(Kn).concat(this._dataIsEncrypted?btoa(t):t)},e.prototype._getOriginalKeyFromCacheKey=function(e){var t=e.replace(Kn,""),n=this._dataIsEncrypted?atob(t):t,a=decodeURIComponent(n);if(a.indexOf(Wn)>=0){var i=a.split(Wn);return{key:i[0],user:i[1]}}return{key:a}},e.prototype._getData=function(t){var n,a;return(0,Ht.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x=this;return(0,Ht.__generator)(this,function(C){switch(C.label){case 0:return i=t.cacheKey,r=t.storageKey,o=t.validBufferTime,s=zn(),(c=e._buffer[r])&&o&&s-c.readTime<o?[2,c.data]:(d=zn(),l=Date.now(),[4,this._storage.read(r)]);case 1:if(u=C.sent(),f=Math.round(zn()-d),p={lastModified:(null==u?void 0:u.lastModified)||NaN,lastRead:l,reads:((null==u?void 0:u.reads)||0)+1},m=void 0,_=function(t){var n=(0,Ht.__assign)({cacheStats:p,cacheType:x._cacheType,app:(null==u?void 0:u.app)||x._app,key:{original:i,encoded:(null==u?void 0:u.key)||r},performance:{io:f,crypto:m,total:Math.round(zn()-s)}},t);return e._buffer[r]={data:n,readTime:d},n},!u)return[2,_({data:void 0})];if(u.lastModified&&(null===(a=null===(n=null==c?void 0:c.data)||void 0===n?void 0:n.cacheStats)||void 0===a?void 0:a.lastModified)===u.lastModified)return[2,_(c.data)];if(void 0===(h=u.data))return[2,_({data:void 0})];if(!this._dataIsEncrypted)return[2,_({data:h})];b=h,g=this._cacheSecret,v=g.CurrentKey.Key,y=g.PreviousKey.Key,S=zn(),C.label=2;case 2:return C.trys.push([2,4,,7]),[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:v})];case 3:return D=C.sent(),[3,7];case 4:return(I=C.sent())&&I.message&&I.message.indexOf("wrong secret or signature.")>=0?[4,this._crypto.decrypt({encryptedData:b,encryptionSecret:y})]:[3,6];case 5:void 0!==(D=C.sent())&&this.update({cacheKey:i,data:D}),C.label=6;case 6:if(void 0===D)throw I;return[3,7];case 7:return m=Math.round(zn()-S),[2,_({data:D})]}})})},e.prototype._doCacheUpdate=function(t,n){var a;return(0,Ht.__awaiter)(this,void 0,void 0,function(){var i,r,o,s,c,d,l;return(0,Ht.__generator)(this,function(u){switch(u.label){case 0:i=this._logQos({name:"PersistentCache.update"}),u.label=1;case 1:return u.trys.push([1,9,,10]),r=this._getStorageKey(t),void 0===n?[3,6]:(o=(0,Ht.__assign)((0,Ht.__assign)({cacheStats:{lastModified:NaN,lastRead:zn(),reads:1}},null===(a=e._buffer[r])||void 0===a?void 0:a.data),{data:n,app:this._app,cacheType:this._cacheType,key:{original:t,encoded:r}}),e._buffer[r]={data:o,readTime:zn()},s=n,c=NaN,this._dataIsEncrypted?(d=this._cacheSecret.CurrentKey.Key,[4,this._crypto.encrypt({encryptionSecret:d,data:n,doSerialize:this._cacheType===bn.localStorage})]):[3,3]);case 2:return s=u.sent(),c=s.cipherText?s.cipherText.byteLength:0,[3,4];case 3:try{c="string"==typeof n?n.length:JSON.stringify(n).length}catch(e){}u.label=4;case 4:return[4,this._storage.write({app:this._app,key:r,data:s,lastRead:o.cacheStats.lastRead,parentKey:t.parentKey,reads:o.cacheStats.reads,size:c})];case 5:return u.sent(),[3,8];case 6:return delete e._buffer[r],[4,this._storage.write({key:r,app:void 0,data:void 0,lastRead:void 0,parentKey:t.parentKey,reads:void 0,size:void 0})];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:throw l=u.sent(),i({resultType:Rt.ResultTypeEnum.Failure,error:l.message?l.message:l.toString()}),l;case 10:return i({resultType:Rt.ResultTypeEnum.Success}),[2]}})})},e.prototype._logCacheStats=function(){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var e=this;return(0,Ht.__generator)(this,function(t){return this._logStatsTimer||(this._logStatsTimer=setTimeout(function(){return(0,Ht.__awaiter)(e,void 0,void 0,function(){return(0,Ht.__generator)(this,function(e){switch(e.label){case 0:return[4,this._storage.statistics()];case 1:return e.sent(),[2]}})})},3e4)),[2]})})},e.prototype._logQos=function(e){if(this._qos){var t=this._app;e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t;var n=new this._qos(e);return function(e){e.extraData||(e.extraData={}),e.extraData.alias=e.extraData.alias||t,n.end(e)}}return function(e){}},e._buffer={},e}(),Yn=function(){function e(e,t){this._getDataPromises={},this._isDistinguishDataSourcesKSActivated=Rt.KillSwitch.isActivated("6f03f183-611a-404f-8e80-e7b6f3abdfcb");var n=e.id,a=e.dataSourceName,i=e.cacheType,r=void 0===i?bn.indexedDB:i,o=(t.pageContext||{}).aadUserId;this._id=n,this._userId=o;var s=a||n,c=Rt.Qos.withData(function(e){return e.name&&s&&!e.name.startsWith(s)?(0,Ht.__assign)((0,Ht.__assign)({},e),{name:"".concat(s,".").concat(e.name)}):e});this._cache=new Qn({cacheType:r,telemetry:{qos:c}})}return e.prototype.getDataUtilizingCache=function(e){var t=this,n=e,a=n.cacheRequestKey,i=n.cachingStrategy,r=void 0===i?0:i,o=n.cacheTimeoutTime,s=void 0===o?864e5:o,c=n.getData,d=n.returnStatistics,l=void 0!==d&&d,u=n.cacheRequestParentKey,f=n.callback,p={key:a,user:this._userId,parentKey:u},m=function(){var e=t._getDataPromises[a];if(!e){var n=c();t._getDataPromises[a]=n,e=n.then(function(e){return t._cache.update({cacheKey:p,data:e}).catch(function(){}),delete t._getDataPromises[a],e}).catch(function(e){throw delete t._getDataPromises[a],e})}return e.then(function(e){return l?{data:e,cacheStats:{lastModified:NaN,lastRead:Date.now(),reads:1,dataSourceType:t._isDistinguishDataSourcesKSActivated?void 0:"request"}}:e})};return 2===r?Rt.Promise.resolve(this._cache.read({cacheKey:p})).then(function(e){var t=e||{},n=t.data,a=t.cacheStats;return null==n?null:l?{data:n,cacheStats:a}:n}).catch(function(){return null}):Rt.Promise.resolve(this._cache.read({cacheKey:p})).then(function(e){var n=e||{},a=n.data,i=n.cacheStats;if(null==a)return m();!t._isDistinguishDataSourcesKSActivated&&i&&(i.dataSourceType="cache");var o=l?{data:a,cacheStats:i}:a,c=t._isCacheExpired(i.lastModified,s);switch(r){case 4:return o;case 0:return c&&m(),o;case 1:return c?m():o;case 5:return c?m().catch(function(){return o}):o;case 6:return m().then(f),o;default:return m()}},function(){return m()})},e.prototype.getRequestKey=function(e,t,n){var a=[];return a.push(e),a.push(t),n&&a.push(n.toString()),a.join(",")},Object.defineProperty(e.prototype,"cacheId",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cacheVersionId",{get:function(){return this._id+"-version"},enumerable:!1,configurable:!0}),e.prototype.flushCache=function(e,t){var n={key:e,user:this._userId,parentKey:t};delete this._cache[e],this._cache.remove({cacheKey:n})},e.prototype.updateCache=function(e,t){var n={key:e,user:this._userId};this._cache.update({cacheKey:n,data:t})},e.prototype._isCacheExpired=function(e,t){return e<=(new Date).valueOf()-t},e}(),Jn=Rt.KillSwitch.isActivated("0b87858b-d63c-4252-9f55-d3c55ed9e0fc"),Xn=Rt.KillSwitch.isActivated("8d7a8d27-52ef-45fd-904a-cb4ae0e05989"),Zn=Rt.KillSwitch.isActivated("e43bfa56-e434-4c69-ab17-4e77f2b8e82f"),$n=Rt.KillSwitch.isActivated("ecdc359b-47ac-402f-b41f-d529fa813171"),ea=Rt.KillSwitch.isActivated("f5cb7242-2b1c-4d77-9891-269a05072013"),ta=Rt.KillSwitch.isActivated("0F22FC56-CC8D-418F-BA2D-CD0880BD96B5"),na=Rt.KillSwitch.isActivated("d30d7d78-8704-424f-bc30-19fbe9bc9948"),aa=Rt.KillSwitch.isActivated("8548e37c-464a-47ce-b9d0-5d3a72739e9f"),ia=Rt.KillSwitch.isActivated("4f8b4a16-9d3e-4c8f-b7b0-5f6d8a3c1e27"),ra=Rt.KillSwitch.isActivated("e5246556-bb3d-4598-8d40-4b92e2a83836"),oa="Manual",sa="Privileged",ca=function(){function e(e,t){var n=t.pageContext,a=t.graphDataRequestor;this._pageContext=n;var i=Xn?{}:{dataSyncClient:this._pageContext.dataSyncClient};this._graphDataRequestor=a||new fn({},i),this._getOAuthToken=e.getOAuthToken,this._getOAuthToken2=t.getOAuthToken,this._cache=new Yn({id:"SensitivityLabelsDataSource"},{pageContext:n})}return e.prototype.getSensitivityLabels=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,Ht.__generator)(this,function(n){return ta?[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return t._getSensitivityLabels(e)}}).catch(function(){return null})]:[2,this._cache.getDataUtilizingCache({cachingStrategy:0,cacheRequestKey:"SensitivityLabelsDataSource",getData:function(){return t._getSensitivityLabels(e)}})]})})},e.prototype.flushSensitiveLabelsCache=function(){return(0,Ht.__awaiter)(this,void 0,void 0,function(){return(0,Ht.__generator)(this,function(e){return this._cache.flushCache("SensitivityLabelsDataSource"),[2]})})},e.prototype.getDocLibSensitivityLabelsCached=function(e){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var t=this;return(0,Ht.__generator)(this,function(n){return ta?[2,this._cache.getDataUtilizingCache({cachingStrategy:Jn?0:3,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return t.getDocLibSensitivityLabels(e)}}).catch(function(){return null})]:[2,this._cache.getDataUtilizingCache({cachingStrategy:Jn?0:3,cacheRequestKey:"SensitivityLabelsDataSourceDocLib",getData:function(){return t.getDocLibSensitivityLabels(e)}})]})})},e.prototype.getDocLibSensitivityLabels=function(e){return Rt.Promise.resolve((0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o,s,c=this;return(0,Ht.__generator)(this,function(d){switch(d.label){case 0:return t="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],t)]:[3,2];case 1:return a=d.sent(),[3,4];case 2:return[4,this._getOAuthToken2(t)];case 3:a=d.sent(),d.label=4;case 4:return n=a,e&&(n||(this._getOAuthToken&&this._getOAuthToken2?e.end({resultType:Rt.ResultTypeEnum.Failure,error:"failed to get sensitivitylabels because no token provided"}):e.end({resultType:Rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}))),i=Zn?"$expand=sensitivityPolicySettings,sublabels($expand=sensitivityPolicySettings)":"$expand=sensitivityPolicySettings,sublabels($expand=sensitivityPolicySettings)&$filter=applicableto has 'file'",r=$n?"beta":"v1.0",o="".concat(t,"/").concat(r,"/me/informationprotection/sensitivityLabels?").concat(i),this._sensitivityLabels?(s=this._sensitivityLabels,[3,7]):[3,5];case 5:return[4,this._graphDataRequestor.send({endpoint:t,path:o,apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:n},requestType:"GET",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){var t=JSON.parse(e.responseText).value;return c._sensitivityLabels=t,t}})];case 6:s=d.sent(),d.label=7;case 7:return[2,s]}})}))},e.prototype.setSensitivityLabel=function(e,t,n,a,i){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var r,o,s,c;return(0,Ht.__generator)(this,function(d){switch(d.label){case 0:return r={id:n,assignmentMethod:sa,justificationText:a||"",actionSource:oa},this._getOAuthToken||this._getOAuthToken2?(o="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],o)]:[3,2]):(null==i||i.end({resultType:Rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,Promise.resolve("")]);case 1:return c=d.sent(),[3,4];case 2:return[4,this._getOAuthToken2(o)];case 3:c=d.sent(),d.label=4;case 4:return s=c,[4,this._graphDataRequestor.send({endpoint:o,path:"".concat(o,"/beta/drives/").concat(e,"/items/").concat(t,"/setSensitivityLabel"),apiName:"GraphDataProvider.setSensitivityLabel",postData:JSON.stringify(r),accessToken:{accessToken:s},requestType:"POST",useAuthorizationHeaders:!0,qosExtraData:{host:"Document libraries"},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,d.sent()]}})})},e.prototype.setSensitivityLabelVroom=function(e,t,n,a,i,r){return(0,Ht.__awaiter)(this,void 0,void 0,function(){var o,s,c,d,l,u;return(0,Ht.__generator)(this,function(f){switch(f.label){case 0:return o={id:n,assignmentMethod:sa,justificationText:i||"",actionSource:oa},this._getOAuthToken||this._getOAuthToken2?(s=decodeURIComponent(this._pageContext.webAbsoluteUrl),c="".concat(s)+"/_api/v2.1"+(a?"/sites/"+a:""),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],s)]:[3,2]):(null==r||r.end({resultType:Rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,Promise.resolve("")]);case 1:return l=f.sent(),[3,4];case 2:return[4,this._getOAuthToken2(s)];case 3:l=f.sent(),f.label=4;case 4:return d=l,u=c+"/drives/".concat(e,"/items/").concat(t,"/setSensitivityLabel"),[4,this._graphDataRequestor.send({path:u,apiName:"VroomDataProvider.setSensitivityLabel",postData:JSON.stringify(o),requestType:"POST",apiVersion:"v2.1",qosExtraData:{host:"Document libraries"},accessToken:{accessToken:d},parseResponse:function(e){return null==e?void 0:e.responseText}})];case 5:return[2,f.sent()]}})})},e.prototype.parseSensitivityLabelsForProdEndpoint=function(e){var t=this,n=[];return e.filter(function(e){return!0===e.isEnabled}).sort(function(e,t){return e.priority&&t.priority?e.priority>t.priority?1:-1:0}).forEach(function(e){var a,i;(null===(a=e.sublabels)||void 0===a?void 0:a.length)||n.push((0,Ht.__assign)((0,Ht.__assign)({id:e.id,name:e.displayName||"",tooltip:e.toolTip,description:e.description,hasIRMProtection:e.hasIRMProtection,displayName:e.displayName,hasProtection:ra?void 0:t._getHasProtectionByActionLabels(e.labelActions)},!ia&&{color:e.color}),!na&&{applicableTo:e.applicableTo})),null===(i=e.sublabels)||void 0===i||i.forEach(function(a){n.push((0,Ht.__assign)((0,Ht.__assign)((0,Ht.__assign)({id:aa?a.name:a.id,name:aa?a.displayName||"":a.name,tooltip:a.toolTip},!ia&&{color:a.color}),{description:a.description,parent:{name:e.displayName||""},hasIRMProtection:a.hasIRMProtection,displayName:aa?void 0:a.displayName,hasProtection:ra?void 0:t._getHasProtectionByActionLabels(a.labelActions)}),!na&&{applicableTo:a.applicableTo}))})}),n},e.prototype._getSensitivityLabels=function(e){return Rt.Promise.resolve((0,Ht.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,r,o=this;return(0,Ht.__generator)(this,function(s){switch(s.label){case 0:return this._getOAuthToken||this._getOAuthToken2?(t=ea?"beta":"v1.0",n=ea?"security/informationProtection/sensitivityLabels":"informationProtection/sensitivityLabels",a="".concat(this._pageContext.msGraphEndpointUrl),this._getOAuthToken?[4,this._getOAuthToken(["InformationProtection.Read.All"],a)]:[3,2]):(null==e||e.end({resultType:Rt.ResultTypeEnum.Failure,error:"no get auth callback passed in"}),[2,Rt.Promise.resolve([])]);case 1:return r=s.sent(),[3,4];case 2:return[4,this._getOAuthToken2(a)];case 3:r=s.sent(),s.label=4;case 4:return(i=r)?[4,this._graphDataRequestor.send({endpoint:a,path:"".concat(a,"/").concat(t,"/me/").concat(n),apiName:"GraphDataProvider.getSensitivityLabels",accessToken:{accessToken:i},requestType:"GET",useAuthorizationHeaders:!0,parseResponse:function(e){return ea?JSON.parse(e.responseText).value.filter(function(e){return!0===e.isActive}).sort(function(e,t){return e.sensitivity>t.sensitivity?1:-1}):o.parseSensitivityLabelsForProdEndpoint(JSON.parse(e.responseText).value)}})]:(null==e||e.end({resultType:Rt.ResultTypeEnum.Failure,error:"failed to get sensitivitylabels because no token provided"}),[2,Rt.Promise.resolve([])]);case 5:return[2,s.sent()]}})}))},e.prototype._getHasProtectionByActionLabels=function(e){return!!(e&&e.length>0)&&e.some(function(e){return"encryptWithTemplate"===e.name||"encryptWithUserDefinedRights"===e.name||"encryptWithHoldYourOwnKey"===e.name})},e}();const da=s().createContext({sensitivityLabels:[],sensitivityLabelsUpdated:!1});function la(e){const{serviceScope:t}=e,n=function(e){const[t,n]=s().useState(void 0);return s().useEffect(()=>{e.whenFinished(()=>{n(e.consume(A.PageContext.serviceKey))})},[e]),t}(t),[a,i]=s().useState([]),[r,c]=s().useState(!1);return(0,o.useEffect)(()=>{let e=!1;return(async()=>{if(!n)return;let t;const a=new w.AadTokenProvider(w._AadTokenProviders.preAuthorizedConfiguration),r=new ca({},{pageContext:n.legacyPageContext,getOAuthToken:e=>a.getToken(e,{})});t=await r.getSensitivityLabels(),e||(E._SPKillSwitch.isActivated("7d025918-e9fa-404c-b98a-3c8955ffa889")?(t&&!t[0].color||t&&void 0===t[0].hasProtection)&&(await r.flushSensitiveLabelsCache(),t=await r.getSensitivityLabels()):t&&t.length>0&&(t[0].color&&void 0!==t[0].hasProtection||(await r.flushSensitiveLabelsCache(),t=await r.getSensitivityLabels())),i(t),c(!0))})(),()=>{e=!0}},[n,i]),s().createElement(da.Provider,{value:{sensitivityLabels:a,sensitivityLabelsUpdated:r}},e.children)}function ua(){return s().useContext(da)}function fa(e){const{sensitivityLabels:t}=ua();if(e)return pa(t,e)}function pa(e,t){if(!t)return;let n;for(const a of e){if(a.id===t){n=a;break}if(a.sublabels&&a.sublabels.length>0)for(const e of a.sublabels)if(e.id===t){n=e;break}}return n}const ma=(0,c.makeStyles)({sensitivityTooltip:{fontFamily:c.tokens.fontFamilyBase},sensitivityTooltipLarge:{padding:"0",width:"16px",height:"16px"},sensitivityTooltipExtraLarge:{width:"20px",height:"20px"},sensitivityLabelIcon:{top:0,left:0,width:"100%",height:"100%"},sensitivityLabelIconLarge:{transform:"scale(1)"},sensitivityLabelIconExtraLarge:{transform:"scale(1.25)"}});function _a(e){const t=ma(),{size:n,sensitivityLabel:a}=e,i="large"===n?t.sensitivityLabelIconLarge:t.sensitivityLabelIconExtraLarge,r=fa(a?.id);return a?""===a.id?s().createElement(s().Fragment,null):r?s().createElement(At,{message:r.tooltip,heading:a.displayName,"data-automation-id":"sp-pages-content-panel-attachment-file-sensitivity-label",className:(0,c.mergeClasses)(t.sensitivityTooltip,"large"===n?t.sensitivityTooltipLarge:t.sensitivityTooltipExtraLarge)},s().createElement(Ft,{"aria-label":a.displayName,fillColor:r.color,withLock:a.protectionEnabled,backgroundIcon:{className:i},foregroundIcon:{className:i}})):s().createElement(u.Spinner,{size:"extra-tiny"}):s().createElement(u.Spinner,{size:"extra-tiny"})}const ha=(0,c.makeStyles)({tagGroup:{flexWrap:"wrap",rowGap:"var(--spacingVerticalS)",width:"100%"},attachmentTag:{overflow:"hidden",border:"none",textOverflow:"ellipsis",display:"flex",alignItems:"center",backgroundColor:"var(--colorNeutralBackground3) !important"},attachmentTagShadow:{boxShadow:"var(--shadow2)"},attachmentTagLarge:{height:"26px"},attachmentTagExtraLarge:{height:"30px"},attachmentTagPrimaryBorderless:{border:"none"},attachmentTagPrimaryLarge:{paddingLeft:"13px"},attachmentTagPrimaryExtraLarge:{paddingLeft:"12px"},attachmentTagPrimaryText:{maxWidth:"100%",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"center",height:"20px",color:"var(--colorNeutralForeground1)",":hover":{color:"var(--colorNeutralForeground1)"},":focus":{color:"var(--colorNeutralForeground1)"},":active":{color:"var(--colorNeutralForeground1)"}},attachmentTagPrimaryTextDisabled:{cursor:"not-allowed !important"},attachmentTagPrimaryTextLarge:{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightRegular)"},attachmentTagPrimaryTextExtraLarge:{fontSize:"var(--fontSizeBase400)",fontWeight:"var(--fontWeightRegular)"},attachmentName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"var(--spacingHorizontalXS)"},attachmentSecondary:{display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},attachmentTagSecondary:{borderLeft:"0 !important",backgroundColor:"var(--colorNeutralBackground3)",":hover":{backgroundColor:"var(--colorNeutralBackground3Hover)"},":active":{backgroundColor:"var(--colorNeutralBackground3Pressed)"},borderBottomColor:"transparent !important",borderLeftColor:"transparent !important",borderRightColor:"transparent !important",borderTopColor:"transparent !important"},attachmentTagSecondaryDisabled:{backgroundColor:"var(--colorNeutralBackground3)",cursor:"not-allowed !important",":hover":{backgroundColor:"var(--colorNeutralBackground3)"},":active":{backgroundColor:"var(--colorNeutralBackground3)"}},attachmentTagSecondaryBorderless:{borderTop:"none",borderRight:"none",borderBottom:"none"},attachmentTagSecondaryLarge:{fontSize:"16px",paddingRight:"8px"},attachmentTagSecondaryExtraLarge:{fontSize:"16px",paddingRight:"8px"},attachmentTagPrimary:{paddingLeft:"6px",paddingRight:"8px",cursor:"default !important",backgroundColor:"var(--colorNeutralBackground3)",":hover":{backgroundColor:"var(--colorNeutralBackground3)"},":active":{backgroundColor:"var(--colorNeutralBackground3)"},borderBottomColor:"transparent !important",borderLeftColor:"transparent !important",borderRightColor:"transparent !important",borderTopColor:"transparent !important"},icon:{height:"16px",width:"16px"},buttonSize:{padding:"2px 8px"},button:{color:c.tokens.colorNeutralForeground1,border:`dashed 1px ${c.tokens.colorNeutralStroke1}`,":hover":{color:c.tokens.colorBrandBackground,border:`dashed 1px ${c.tokens.colorNeutralStroke1}`},":focus":{color:c.tokens.colorBrandBackground,border:`dashed 1px ${c.tokens.colorNeutralStroke1}`},":active":{color:c.tokens.colorBrandBackground,border:`dashed 1px ${c.tokens.colorNeutralStroke1}`},":hover:active":{border:`dashed 1px ${c.tokens.colorNeutralStroke1}`,color:c.tokens.colorBrandBackground}},buttonDisabled:{border:`dashed 1px ${c.tokens.colorNeutralForegroundDisabled}`,":hover":{border:`dashed 1px ${c.tokens.colorNeutralForegroundDisabled}`},":focus":{border:`dashed 1px ${c.tokens.colorNeutralForegroundDisabled}`},":active":{border:`dashed 1px ${c.tokens.colorNeutralForegroundDisabled}`},":hover:active":{border:`dashed 1px ${c.tokens.colorNeutralForegroundDisabled}`,color:c.tokens.colorNeutralForegroundDisabled}},useCurrentPageButton:{marginLeft:"6px"},TagPickerControl:{padding:"8px",display:"flex",alignContent:"flex-start",flexWrap:"wrap",gap:"var(--spacingVerticalS)"},TagPickerGroup:{padding:"0 !important"}}),ba=JSON.parse('{"T0":"Remove","Vt":"Protected file","CH":"You don\\u0027t have access to this file."}');function ga(e){const{attachment:n,size:a="large",decoration:i="none",onAttachmentRemoveHandler:r}=e,s=ha();return o.createElement($e.InteractionTag,{shape:"rounded",appearance:"outline",key:n.id,value:n.id,"data-size":a,className:(0,c.mergeClasses)(s.attachmentTag,"large"===a?s.attachmentTagLarge:s.attachmentTagExtraLarge)},o.createElement($e.InteractionTagPrimary,{className:s.attachmentTagPrimary,media:o.createElement(qe,{size:We.Large,attachment:n}),hasSecondaryAction:!0,primaryText:{className:(0,c.mergeClasses)(s.attachmentTagPrimaryText,e.disabled&&s.attachmentTagPrimaryTextDisabled,"large"===a?s.attachmentTagPrimaryTextLarge:s.attachmentTagPrimaryTextExtraLarge)}},o.createElement(et.Tooltip,{content:V()||n.type!==t.Unauthorized?n.name:ba.CH,relationship:"label",withArrow:!0},o.createElement("span",{className:s.attachmentName,...(()=>{const a=!N()&&n.type===t.File,i=!Q()&&n.type===t.Page;return e.disabled||!a&&!i?{}:{style:{cursor:"pointer"},onClick:()=>window.open(n.sharepointIds.webUrl,"_blank","noopener noreferrer")}})()},V()||n.type!==t.Unauthorized?n.name:n.name||ba.Vt)),n.type!==t.Unauthorized&&o.createElement(_a,{size:"extra-large",sensitivityLabel:n.sensitiveLabel})),o.createElement($e.InteractionTagSecondary,{disabled:e.disabled,"aria-label":ba.T0,className:(0,c.mergeClasses)(s.attachmentTagSecondary,e.disabled&&s.attachmentTagSecondaryDisabled,"none"===i?s.attachmentTagSecondaryBorderless:"","large"===a?s.attachmentTagSecondaryLarge:s.attachmentTagSecondaryExtraLarge),onClick:()=>r(n)}))}function va(e){const{serviceScope:a,queryString:r,activatedTab:c,displayTabs:d,filterByOrganizersName:l,cvid:u,selectedAttachments:f,setSearchResult:p,setPaginationInfo:m,disabled:_}=e,{currentPage:h,isCurrentPageSelected:b,ignoredAttachmentsIds:g=[],disableSiteInSiteTab:v=!1}=Ke(),y=s().useRef(null);(0,o.useEffect)(()=>{if(_)return;y.current&&(y.current.abort(),y.current=null),p({status:i.Querying});const e=new AbortController,o=e.signal;return y.current=e,(0,re.debounce)(async()=>{try{if(o.aborted)return;const e=ce()?ie:ae,{attachments:s,nextPaginationInfo:_}=await e({serviceScope:a,paginationInfo:I(r),queryString:r,activatedTab:c,displayTabs:d,abortSignal:o,selectedAttachments:f,ignoredAttachmentsIds:g,filterByOrganizersName:l,cvid:u}),y=c===n.All||c===n.Sites&&G()||c===n.Pages&&!G(),S=v&&y?s.filter(e=>e.type!==t.Site):s;G()||!h||b||!y||!K()&&0!==r.trim().length||S.unshift(h),p({status:i.Succeed,results:S}),m(_)}catch(e){"AbortError"!==e.name&&(p({status:i.Failed,error:e}),m(I(r)))}},300)(),()=>{y.current?.abort(),y.current=null}},[c,r,_,h])}const ya=n.Files,Sa=[n.Files],Da=[],Ia=(0,c.makeStyles)({DropDownOptionList:{maxHeight:"184px",position:"relative",borderRadius:"4px",boxShadow:"0px 8px 16px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12)"}});function xa(e){const{serviceScope:t,selectedAttachments:n,onAttachmentSelect:a,onAttachmentRemove:r,multiSelection:o=!1}=e,c=o||0===n.length,[l,u]=s().useState(c?{status:i.Querying}:{status:i.Succeed,results:[]}),[f,p]=s().useState(""),[m,_]=s().useState(c),[h,b]=s().useState(I("")),g=Ia(),[v,y]=s().useState(E.Guid.newGuid().toString()),S=s().useRef(null),D=s().useRef(null);va({disabled:!m,serviceScope:t,selectedAttachments:n,queryString:f,activatedTab:ya,displayTabs:Sa,filterByOrganizersName:Da,cvid:v,setSearchResult:u,setPaginationInfo:b});const x=s().useCallback(async e=>{if(l.status!==i.Succeed)return;const t=l,n=t.results.find(t=>t.id===e);if(!n)return;p(""),a(n),y(E.Guid.newGuid().toString());const r=t.results.filter(t=>t.id!==e);u({status:i.Succeed,results:r})},[a,l]),C=s().useCallback(async(e,t)=>{"no-options"===t.value||Xe(t.value)||await x(t.value)},[x]),O=s().useCallback(e=>{r(e),o||_(!0);const t=l;t.results.some(t=>t.id===e.id)||u({status:i.Succeed,results:[...t.results,e]})},[o,r,l]),w=s().useCallback((e,t)=>{c&&(!t.open&&f.length>0&&l.status===i.Succeed&&0===l.results.length||_(t.open))},[f.length,l,c]);return s().createElement("div",{style:{display:"flex",flexDirection:"column"}},s().createElement(d.TagPicker,{open:m,onOpenChange:w,inline:!0,onOptionSelect:C,selectedOptions:n.map(e=>e.name)},s().createElement(d.TagPickerControl,{expandIcon:null},s().createElement(d.TagPickerGroup,null,n.map(e=>s().createElement(ga,{key:`AttachmentTag-${e.id}`,attachment:e,onAttachmentRemoveHandler:O}))),s().createElement(d.TagPickerInput,{ref:D,value:f,onInput:e=>{m&&(p(e.target.value),b(I(e.target.value)))}})),s().createElement(Ze,{dropdownViewboxRef:S,searchResult:l,activatedTab:ya,queryString:f,paginationInfo:h,serviceScope:t,selectedAttachments:n,displayTabs:Sa,filterByOrganizersName:Da,cvid:v,setSearchResult:u,setPaginationInfo:b,setQueryString:p,onClearAndTryAgain:()=>{D.current?.focus()},customizedStyles:{dropDownOptionList:g.DropDownOptionList}})))}const Ca=(0,c.makeStyles)({popoverSurface:{padding:0}});var Oa=H(6794),wa=H(9843),Ea=H(3054);const Aa=(0,c.makeStyles)({searchContainer:{display:"flex",flexDirection:"column",width:"440px"},referenceContainer:{display:"flex",flexDirection:"column",padding:"0 12px",gap:"2px"},referenceSearchBox:{padding:"0px 10px 0 10px"},referenceSearchBoxPlaceholder:{"&::placeholder":{color:"var(--colorNeutralForeground3)"}},suggestionContainer:{display:"flex",flexDirection:"column",padding:"6px",gap:"2px"},suggestionItemContainer:{display:"flex",flexDirection:"column",maxHeight:"184px",overflowY:"auto"},divider:{width:"100%",padding:"0px 0 12px 0"},TabContainer:{alignItems:"flex-start",display:"flex",flexDirection:"column",justifyContent:"flex-start",rowGap:"20px"},DismissButton:{position:"relative",right:"-5px",maxWidth:"20px",minWidth:"20px"}});var La=H(7675);const ka=e=>{const{searchResult:n,queryString:a,handleOptionSelected:r,handleClearAndTryAgain:o,loadingComponent:c}=e,d=Qe();if(n.status===i.Querying)return s().createElement(u.Spinner,{className:d.spinner});if(n.status===i.Succeed){if(0===n.results.length&&a?.length>0)return s().createElement("div",{className:d.clearContainer},s().createElement(f.Text,{className:d.noResultsFound},l.nF),s().createElement(de.Button,{className:d.clearButton,onClick:o},l.ki));{const e=n.results.map(e=>{let n="";if(e.type===t.File){const t=e;n=t.lastModifiedBy?.user.displayName?b.StringHelper.format(l.fG,t.lastModifiedBy?.user?.displayName,(0,b.getFriendlyDateTimeStringPast)(new Date(t.lastModifiedDateTime||""))):b.StringHelper.format(l.UF,(0,b.getFriendlyDateTimeStringPast)(new Date(t.lastModifiedDateTime||"")))}else if(e.type===t.MeetingSeries){const t=e.meetings[0];n=b.StringHelper.format(l.gm,S(t.start.dateTime,t.end.dateTime),t.organizer.emailAddress.name)}else if(e.type===t.Meeting){const t=e;n=b.StringHelper.format(e.hasRecording?l.Lq:l.gm,y(t.start.dateTime,t.end.dateTime),t.organizer.emailAddress.name)}else if(e.type===t.Page||e.type===t.Site)n=e.url;else{if(P())throw new Error("Unsupported attachment type:"+e.type);n=""}return s().createElement(La.Option,{text:e.name,key:e.id,value:e.id,checkIcon:null,"data-automation-id":h,onClick:()=>{r?.(e.id)},tabIndex:0,onKeyDown:t=>"Enter"===t.key&&r?.(e.id)},s().createElement("div",{className:d.attachmentOptionContainer},s().createElement(qe,{size:We.Large,attachment:e}),s().createElement("div",{className:d.attachmentInfo},s().createElement("div",{className:d.attachmentName},e.name),s().createElement("div",{className:d.attachmentActivity},n))))});return s().createElement("div",null,s().createElement("div",{role:"listbox","aria-label":l.HT},e),s().createElement(s().Fragment,null,c))}}if(P())throw new Error("Unsupported search status");return s().createElement("div",{className:d.clearContainer},s().createElement(f.Text,{className:d.noResultsFound},l.nF))};function Ma(e){const{searchResult:t,activatedTab:a,serviceScope:r,dropdownViewboxRef:c,displayTabs:d,filterByOrganizersName:p,queryString:m,paginationInfo:_,cvid:h,selectedAttachments:b,setPaginationInfo:g,setQueryString:v,handleOptionSelected:y,setSearchResult:S}=e,D=s().useRef(null),x=s().useRef(void 0),C=async()=>{if(a===n.All)return;g({..._,isLoading:!0});const e=ce()?ie:ae;try{const{attachments:n,nextPaginationInfo:i}=await e({serviceScope:r,queryString:m,activatedTab:a,displayTabs:d,paginationInfo:_,abortSignal:x.current?.signal,selectedAttachments:b,filterByOrganizersName:p,cvid:h});if(x.current?.signal?.aborted){const e=new Error("action is aborted");throw e.name="AbortError",e}const o=[...t.results,...n];g(i),S({...t,results:o})}catch(e){if(P())throw e;"AbortError"!==e.name&&(S({status:i.Failed,error:e}),g(I(m)))}};oe({dropdownViewboxRef:c,loadMoreRef:D,onScrollEnd:async()=>{!0===_.canLoadMore&&!1===_.isLoading&&await C()}}),(0,o.useEffect)(()=>{const e=new AbortController;return x.current=e,()=>{e.abort()}},[x]);const O=se();let w;return w=!0===_.canLoadMore&&a!==n.All?!0===_.isLoading?s().createElement(La.Option,{text:"",ref:D},s().createElement(u.Spinner,{size:"small",className:O.loadMoreSpinner})):s().createElement(La.Option,{className:O.loadMoreBtn,onClick:C,ref:D,role:"button",tabIndex:0,onKeyDown:e=>"Enter"===e.key&&C()},l.iq):s().createElement("div",{className:O.reachTheEndText},s().createElement(f.Text,null,l.kz)),s().createElement(ka,{searchResult:t,queryString:m,loadingComponent:w,handleOptionSelected:y,handleClearAndTryAgain:()=>{v("")}})}const Pa={[n.All]:l.Xu,[n.Files]:l.p7,[n.Meetings]:l.e,[n.MeetingSeries]:l.iP,[n.Sites]:l.m2,[n.Pages]:l.L6};function Ta(e){const t=Aa(),{useAttachmentSearchBoxV2:a,serviceScope:r,selectedAttachments:c,displayTabs:u,filterByOrganizersName:f,enableAutoFocusOnSearchBox:p,onSelect:m}=e,_=!E._SPKillSwitch.isActivated("c1ffa028-e418-4543-aeb8-def4abff0eec")&&a,[h,b]=s().useState({status:i.Querying}),[g,v]=s().useState(""),[y,S]=s().useState(I("")),[D,x]=s().useState(E.Guid.newGuid().toString()),C=s().useRef(null),O=s().useRef(null),[w,A]=s().useState(u[0]||n.Files);va({serviceScope:r,selectedAttachments:c,queryString:g,activatedTab:w,displayTabs:u,filterByOrganizersName:f,cvid:D,setSearchResult:b,setPaginationInfo:S}),(0,o.useEffect)(()=>{!k()&&p&&O.current&&setTimeout(()=>{O.current&&O.current.focus()},0)},[p]);const L=e=>{v(e.target.value),S(I(e.target.value))},M=s().useCallback(async e=>{if(h.status===i.Succeed){const t=h.results.find(t=>t.id===e);t&&(m(t),x(E.Guid.newGuid().toString()))}},[m,h]),P=()=>{v(""),x(E.Guid.newGuid().toString())},T=s().useCallback(async(e,t)=>{"no-options"===t.value||Xe(t.value)||await(M?.(t.value))},[M]);return s().createElement("div",{role:"search",className:t.searchContainer},s().createElement("div",{className:t.referenceContainer},s().createElement("div",{className:t.TabContainer},s().createElement(Oa.TabList,{selectedValue:w,onTabSelect:(e,t)=>{A(t.value),S(I(g)),!k()&&p&&O.current&&O.current.focus()}},u.map(e=>{const t=(e=>{let t="";switch(e){case n.All:t="sp-pages-content-panel-attachments-all-tab-btn";break;case n.Files:t="sp-pages-content-panel-attachments-file-tab-btn";break;case n.Meetings:t="sp-pages-content-panel-attachments-meeting-tab-btn";break;case n.MeetingSeries:t="sp-pages-content-panel-attachments-meeting-series-tab-btn";break;case n.Sites:t="sp-pages-content-panel-attachments-site-tab-btn";break;case n.Pages:t="sp-pages-content-panel-attachments-site-page-tab-btn";break;default:throw new Error("Unsupported searching content type")}return t})(e);return s().createElement(Oa.Tab,{key:e,value:e,"data-automation-id":t},Pa[e])}))),s().createElement(wa.Divider,{className:t.divider}),_?s().createElement(d.TagPicker,{open:!0,inline:!0,onOptionSelect:T},s().createElement(d.TagPickerControl,{expandIcon:s().createElement(s().Fragment,null)},s().createElement(Lt,null),s().createElement(d.TagPickerInput,{ref:O,value:g,className:t.referenceSearchBox,placeholder:l.q$,onInput:L,onKeyDown:t=>{"Escape"===t.key&&e.handleOpenChange(t,{open:!1})}}),s().createElement(et.Tooltip,{content:l.Wi,relationship:"label",withArrow:!0},s().createElement(de.Button,{icon:s().createElement(Fe,{"aria-label":l.Wi,fontSize:20}),appearance:"transparent",className:t.DismissButton,onClick:P}))),s().createElement(Ze,{dropdownViewboxRef:C,searchResult:h,activatedTab:w,queryString:g,paginationInfo:y,serviceScope:r,selectedAttachments:c,displayTabs:u,filterByOrganizersName:f,cvid:D,setSearchResult:b,setPaginationInfo:S,setQueryString:v,onClearAndTryAgain:()=>{O.current?.focus()}})):s().createElement(Ea.SearchBox,{ref:O,value:g,onInput:L,className:t.referenceSearchBox,input:{className:t.referenceSearchBoxPlaceholder},placeholder:l.q$,dismiss:{"aria-label":l.Wi,children:s().createElement(et.Tooltip,{content:l.Wi,relationship:"label",withArrow:!0},s().createElement(Fe,null)),onClick:P}})),!_&&s().createElement("div",{className:t.suggestionContainer},s().createElement("div",{className:t.suggestionItemContainer,ref:C},s().createElement(Ma,{dropdownViewboxRef:C,searchResult:h,activatedTab:w,queryString:g,paginationInfo:y,serviceScope:r,selectedAttachments:c,displayTabs:u,filterByOrganizersName:f,cvid:D,handleOptionSelected:M,setSearchResult:b,setPaginationInfo:S,setQueryString:v}))))}const Ua=JSON.parse('{"z":"Source files dialog for searching and selecting files."}');function Fa(e){const{serviceScope:t,selectedAttachments:a,filterByOrganizersName:i,onAttachmentSelect:r,displayTabs:c=[n.MeetingSeries],openPicker:d,setOpenPicker:l,children:u,disabled:f,enableAutoFocusOnSearchBox:p}=e,[m,_]=s().useState(!1);s().useEffect(()=>{U()||T()||!e.useAttachmentSearchBoxV2||m||!e.buttonRef||e.buttonRef.current?.focus()},[m,e.buttonRef,e.useAttachmentSearchBoxV2]);const h=(t,n)=>{f||(_(n.open),!L()&&l?.(n.open,!0),U()&&(T()||!e.useAttachmentSearchBoxV2||n.open||e.buttonRef?.current?.focus()))};(0,o.useEffect)(()=>{L()||f||d&&(_(!0),l?.(!1,!0))},[d,f,l]);const b=E._SPKillSwitch.isActivated("484352cf-3d80-4d39-8fcc-5496abef5f85")?{}:{role:"dialog","aria-modal":!0,"aria-label":Ua.z},g=Ca();return s().createElement(nt.Popover,{open:m,onOpenChange:h,positioning:"below-start",trapFocus:!0},s().createElement(nt.PopoverTrigger,{disableButtonEnhancement:!0},!E._SPKillSwitch.isActivated("213fb74e-63a5-4201-ae45-af115943e854")&&s().isValidElement(u)?u:s().createElement("div",null,u)),s().createElement(nt.PopoverSurface,{className:g.popoverSurface,...b},s().createElement(Ta,{useAttachmentSearchBoxV2:e.useAttachmentSearchBoxV2,handleOpenChange:h,serviceScope:t,filterByOrganizersName:i||[],onSelect:e=>{r(e),h(0,{open:!1})},displayTabs:c,selectedAttachments:a,enableAutoFocusOnSearchBox:p})))}const Ha=JSON.parse('{"qs":"Attachments","T0":"Remove","c6":"Only up to {0} files can be added currently","Dc":"Add resources for better results","aW":"More","QR":"This meeting has no recording, so it may not contain enough information to create a good quality page."}'),Ra=(0,c.makeStyles)({tagGroup:{flexWrap:"wrap",rowGap:"var(--spacingVerticalS)",width:"100%","@media screen and (max-width: 772px)":{flexDirection:"column"}},attachmentTag:{"@media screen and (min-width: 772px)":{maxWidth:"calc(50% - var(--spacingHorizontalS))"},padding:"0"},attachmentTagShadow:{boxShadow:"var(--shadow2)"},attachmentTagLarge:{height:"40px"},attachmentTagExtraLarge:{height:"40px"},attachmentTagPrimary:{flex:1,minWidth:"0",backgroundColor:"var(--colorNeutralBackground1)",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)"}},attachmentTagPrimaryBorderless:{border:"none"},attachmentTagPrimaryLarge:{paddingLeft:"13px"},attachmentTagPrimaryExtraLarge:{paddingLeft:"12px"},attachmentTagPrimaryText:{maxWidth:"100%",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"center",paddingBottom:"0"},attachmentTagPrimaryTextLarge:{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightSemibold)"},attachmentTagPrimaryTextExtraLarge:{fontSize:"var(--fontSizeBase400)",fontWeight:"var(--fontWeightSemibold)"},attachmentName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"var(--spacingHorizontalXS)"},attachmentTagSecondary:{backgroundColor:"var(--colorNeutralBackground1)",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)"}},attachmentTagSecondaryBorderless:{borderTop:"none",borderRight:"none",borderBottom:"none"},attachmentTagSecondaryLarge:{fontSize:"12px",paddingRight:"12px"},attachmentTagSecondaryExtraLarge:{fontSize:"16px",paddingRight:"12px"},attachmentPicker:{padding:"0"},button:{border:"dashed 1px var(--colorBrandForeground1)",":hover":{border:"dashed 1px var(--colorBrandForeground1)"},":focus":{border:"dashed 1px var(--colorBrandForeground1)"},":active":{border:"dashed 1px var(--colorBrandForeground1)"}},buttonDisabled:{border:"dashed 1px var(--colorNeutralForegroundDisabled)",":hover":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":focus":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":active":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"}},buttonLarge:{paddingLeft:"6px",paddingRight:"12px"},buttonExtraLarge:{paddingLeft:"12px",paddingRight:"17px"},icon:{color:"var(--colorBrandForeground1)",":hover":{color:"var(--colorBrandForeground1)"},":focus":{color:"var(--colorBrandForeground1)"},":active":{color:"var(--colorBrandForeground1)"}},iconDisabled:{color:"var(--colorNeutralForegroundDisabled)",":hover":{color:"var(--colorNeutralForegroundDisabled)"},":focus":{color:"var(--colorNeutralForegroundDisabled)"},":active":{color:"var(--colorNeutralForegroundDisabled)"}},meetingInfo:{gap:"4px",display:"flex",alignItems:"center",alignSelf:"center"}});var Na=H(718);function Ba(e){const{serviceScope:a,size:i="large",decoration:r="none",disableEdit:s,attachments:d,displayTabs:l,pickLabel:u,onAttachmentSelect:f,onAttachmentRemove:p}=e,m=Ra(),_="large"===i?20:24,h=d.length>=5||s,b=o.createElement(de.Button,{shape:"circular",appearance:"transparent",icon:o.createElement(Le,{className:h?m.iconDisabled:m.icon,width:_,height:_}),size:"large","data-automation-id":"sp-pages-content-panel-attachments-pick-button",disabled:h,"aria-disabled":h,className:(0,c.mergeClasses)(h?m.buttonDisabled:m.button,"large"===i?m.buttonLarge:m.buttonExtraLarge)},0===d.length?u||Ha.Dc:Ha.aW),g=o.createElement($e.TagGroup,{className:m.tagGroup,onDismiss:(e,t)=>{const n=d.find(e=>e.id===t.value);n&&p(n)},"aria-label":Ha.qs,role:"group"},d.map(e=>o.createElement($e.InteractionTag,{shape:"circular",appearance:"outline",key:e.id,value:e.id,"data-size":i,className:(0,c.mergeClasses)(m.attachmentTag,"large"===i?m.attachmentTagLarge:m.attachmentTagExtraLarge)},o.createElement($e.InteractionTagPrimary,{"data-size":i,hasSecondaryAction:!0,media:o.createElement(qe,{size:We.Large,attachment:e}),className:(0,c.mergeClasses)(m.attachmentTagPrimary,"none"===r?m.attachmentTagPrimaryBorderless:"","large"===i?m.attachmentTagPrimaryLarge:m.attachmentTagPrimaryExtraLarge),primaryText:{className:(0,c.mergeClasses)(m.attachmentTagPrimaryText,"large"===i?m.attachmentTagPrimaryTextLarge:m.attachmentTagPrimaryTextExtraLarge)}},o.createElement(et.Tooltip,{content:e.name,relationship:"label",withArrow:!0},o.createElement("span",{className:m.attachmentName},e.name)),o.createElement("span",{className:m.meetingInfo},e.type===t.Meeting&&!e.hasRecording&&o.createElement(et.Tooltip,{content:Ha.QR,relationship:"label",withArrow:!0},o.createElement(Re,{fontSize:"large"===i?"16px":"19px"})),e.type!==t.Unauthorized&&o.createElement(_a,{size:i,sensitivityLabel:e.sensitiveLabel}))),o.createElement($e.InteractionTagSecondary,{"aria-label":Ha.T0,className:(0,c.mergeClasses)(m.attachmentTagSecondary,"none"===r?m.attachmentTagSecondaryBorderless:"","large"===i?m.attachmentTagSecondaryLarge:m.attachmentTagSecondaryExtraLarge),disabled:s,"aria-disabled":s}))),o.createElement(Fa,{useAttachmentSearchBoxV2:e.useAttachmentSearchBoxV2,serviceScope:a,displayTabs:l??[n.MeetingSeries],selectedAttachments:d,onAttachmentSelect:f},h&&!s?o.createElement(et.Tooltip,{content:E.Text.format(Ha.c6,5)??"",relationship:"description",withArrow:!0},b):b));if(P())return g;{const e=(e,t)=>{new ne._QosMonitor("SPAttachmentBox.attachment.Attachments.Render").writeUnexpectedFailure("RenderError",e,{errorMessage:e.message,errorName:e.name,errorInfo:t?.componentStack})};return o.createElement(Na.ErrorBoundary,{onRenderFailure:e,errorRenderer:()=>o.createElement(o.Fragment,null)},g)}}const ja=JSON.parse('{"xx":"Selected Attachments","T0":"Remove","KT":"Add a file","Is":"Add file","Pf":"Add","Tn":"More","RV":"Use current page"}');function Va(e){const{attachment:n}=e;let a=!1;return n.type===t.File?a=null==n.sensitiveLabel:n.type===t.MeetingSeries?a=null==n.calendarId:n.type===t.Meeting&&(a=!1),s().createElement(s().Fragment,null,a&&s().createElement(u.Spinner,{size:"extra-tiny"}))}class za{async requestData(e){const t=await this._getCalendarId(e);return{calendarId:this._processCalendarIdData(t)}}_processCalendarIdData(e){if(e&&e["calendar@odata.navigationLink"]){const t=e["calendar@odata.navigationLink"].match(/calendars\('([^']+)'\)/);if(t&&t.length>0)return t[1]}throw new Error("Calendar Id not found")}_getCalendarId(e){return this._graphClientPromise.then(t=>t.api(this._getCalendarIdUrl(e)).responseType(m.ResponseType.JSON).get())}_getCalendarIdUrl(e){const{seriesMasterId:t}=e;return`me/events/${t}?$select=calendar`}constructor(e){this._graphClientFactory=e.consume(p.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}}const Ga={displayName:"None",id:"",protectionEnabled:!1};class Ka{async requestData(e){const t=await this._getSensitiveLabel(e);return this._processSensitiveData(t)}_processSensitiveData(e){if(e&&e.sensitivityLabel)return e.sensitivityLabel}_getSensitiveLabel(e){return new Promise((t,n)=>{e.abortSignal?.addEventListener("abort",()=>{const e=new Error("action is aborted");e.name="AbortError",n(e)});const a=e.driveId.length>0?this._getSensitiveLabelUrlByDrive(e):this._getSensitiveLabelUrlBySiteAndList(e);this._graphClientPromise.then(e=>e.api(a).responseType(m.ResponseType.JSON).get().then(t).catch(e=>{t({sensitivityLabel:Ga})}))})}_getSensitiveLabelUrlByDrive(e){const{driveId:t,itemId:n}=e;return`drives/${t}/items/${n?.replace(/{|}/g,"")}?$select=sensitivityLabel`}_getSensitiveLabelUrlBySiteAndList(e){const{siteId:t,listId:n,itemId:a}=e;return`sites/${t}/lists/${n}/items/${a?.replace(/{|}/g,"")}/driveItem?$select=sensitivityLabel`}constructor(e){this._graphClientFactory=e.consume(p.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}}class Wa{async requestData(e){const t=await this._getSingleExtendedProperties(e);return this._getSensitiveLabelId(t)}_getSensitiveLabelId(e){if(e.singleValueExtendedProperties&&e.singleValueExtendedProperties.length>0){const t=e.singleValueExtendedProperties[0].value.match(/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/);return t?t[0]:void 0}}async _getSingleExtendedProperties(e){return new Promise((t,n)=>{const{meetingId:a,abortSignal:i}=e;i?.addEventListener("abort",()=>{const e=new Error("action is aborted");e.name="AbortError",n(e)});const r=this._getMeetingSensitiveLabelUrl(a);this._graphClientPromise.then(e=>e.api(r).responseType(m.ResponseType.JSON).get().then(t).catch(e=>{t({singleValueExtendedProperties:[{id:"",value:""}]})}))})}_getMeetingSensitiveLabelUrl(e){return`/me/events/${e}?$expand=singleValueExtendedProperties($filter=id eq 'String {00020386-0000-0000-c000-000000000046} Name msip_labels')`}constructor(e){this._graphClientFactory=e.consume(p.MSGraphClientFactory.serviceKey),this._graphClientPromise=this._graphClientFactory.getClientInternal("3")}}function qa(e){const{multiSelection:n,defaultAttachments:a,serviceScope:i}=e,[r,c]=(0,o.useState)(a),[d,l]=(0,o.useState)((e=>{let n=0;return e?(e.forEach(e=>{e.type!==t.File||e.sensitiveLabel||(n+=1)}),n):n})(a)),{sensitivityLabels:u}=ua(),f=s().useRef({}),p=(e,t)=>{c(n=>n.map(n=>n.id===e&&null!=t?{...n,calendarId:t}:n)),l(e=>e-1)},m=(e,t)=>{c(n=>n.map(n=>n.id===e?{...n,sensitiveLabel:t}:n)),l(e=>e-1)},_=async e=>{if(e.type===t.File){const t=e;if(!t.sensitiveLabel&&!f.current[e.id]){l(e=>e+1);try{f.current[e.id]=new AbortController;const n={driveId:t.sharepointIds.driveId,itemId:t.sharepointIds.listItemUniqueId,abortSignal:f.current[t.id].signal,siteId:t.sharepointIds.siteId,listId:t.sharepointIds.listId},a=new Ka(i),r=await a.requestData(n);m(t.id,r||Ga)}catch(t){"AbortError"!==t.name&&m(e.id,Ga)}}}else if(e.type===t.MeetingSeries){l(e=>e+1);const t=e;try{f.current[e.id]=new AbortController;const n=f.current[e.id].signal,a=new za(i),{calendarId:r}=await a.requestData({seriesMasterId:t.seriesMasterId,abortSignal:n});p(e.id,r)}catch(t){"AbortError"!==t.name&&p(e.id,"")}}else if(e.type===t.Meeting){const t=e;try{l(e=>e+1),f.current[e.id]=new AbortController;const n=new Wa(i),a=await n.requestData({abortSignal:f.current[t.id].signal,meetingId:t.id}),r=a?pa(u,a):void 0;let o=Ga;r&&(o={displayName:r.displayName||"",id:r.id,protectionEnabled:r.hasProtection??!1}),m(e.id,o)}catch(t){"AbortError"!==t.name&&m(e.id,Ga)}}else e.type!==t.Page&&e.type!==t.Site||c(t=>t.map(t=>t.id===e.id?{...t,sensitiveLabel:Ga}:t))};return(0,o.useEffect)(()=>{const e=f.current;return()=>{Object.keys(e).forEach(t=>{const n=e[t];n&&(n.abort(),delete e[t])})}},[]),(0,o.useEffect)(()=>{a.forEach(async e=>{await _(e)})},[]),{internalAttachments:r,loadingAttachmentCount:d,addAttachment:async e=>{c(t=>t.find(t=>t.id===e.id)?t:n?[...t,e]:[e]),await _(e)},removeAttachment:e=>{c(t=>{const n=t.filter(t=>t.id!==e.id);return f.current[e.id]&&(f.current[e.id].abort(),delete f.current[e.id]),n})},checkSensitivity:()=>{let e=0,n=0;const a=u[u.length-1];return r.forEach(i=>{const r=i.type!==t.Unauthorized?i.sensitiveLabel:void 0;if(r?.protectionEnabled&&(e+=1),r?.id){const e=pa(u,r.id);if(e){const t=a?.parent?a.parent.name:a.displayName;(e?.parent?e.parent.name:e.displayName)===t&&r?.protectionEnabled&&(n+=1)}}}),{isSensitiveBarVisible:e>0,isHighlySensitiveBarVisible:n>0,highestLevelLabelFileCount:n}},setAttachments:c}}function Qa(e){const{serviceScope:a,size:i="large",decoration:r="none",defaultAttachments:s,displayTabs:l,multiSelection:u,filterByOrganizersName:f,openPicker:p,enableAutoFocusOnSearchBox:m,setOpenPicker:_,onAttachmentsSelect:h}=e,b=ha(),{internalAttachments:g,loadingAttachmentCount:v,addAttachment:y,removeAttachment:S}=qa({serviceScope:e.serviceScope,multiSelection:!!u,defaultAttachments:s}),D=e=>t=>{t.stopPropagation(),S(e)};(0,o.useEffect)(()=>{0===v&&((e,t)=>{if(e.length!==t.length)return!0;const n=e.map(e=>e.id),a=t.map(e=>e.id);return!n.every(e=>a.includes(e))})(s,g)&&h(g)},[v,s,g,h]);const I=o.createElement(d.TagPicker,{noPopover:!0,selectedOptions:g.map(e=>e.name),disabled:e.disabled},o.createElement(d.TagPickerControl,{className:b.TagPickerControl},o.createElement(d.TagPickerGroup,{"aria-label":ja.xx,className:b.TagPickerGroup},g.map((n,a)=>o.createElement($e.InteractionTag,{shape:"rounded",appearance:"outline",key:n.id,value:n.id,"data-size":i,className:(0,c.mergeClasses)(b.attachmentTag,"large"===i?b.attachmentTagLarge:b.attachmentTagExtraLarge)},o.createElement($e.InteractionTagPrimary,{className:b.attachmentTagPrimary,media:o.createElement(qe,{size:We.Large,attachment:n}),hasSecondaryAction:!0,primaryText:{className:(0,c.mergeClasses)(b.attachmentTagPrimaryText,e.disabled&&b.attachmentTagPrimaryTextDisabled,"large"===i?b.attachmentTagPrimaryTextLarge:b.attachmentTagPrimaryTextExtraLarge)}},o.createElement("div",{className:b.attachmentName},n.name),E._SPKillSwitch.isActivated("13d510f8-9d9d-49ff-055e-a68ffa726ccf")?o.createElement("div",{className:b.attachmentSecondary},o.createElement(Va,{attachment:n})):o.createElement(_a,{size:"extra-large",sensitivityLabel:n.type!==t.Unauthorized?n.sensitiveLabel:void 0})),o.createElement($e.InteractionTagSecondary,{disabled:e.disabled,"aria-label":ja.T0,className:(0,c.mergeClasses)(b.attachmentTagSecondary,e.disabled&&b.attachmentTagSecondaryDisabled,"none"===r?b.attachmentTagSecondaryBorderless:"","large"===i?b.attachmentTagSecondaryLarge:b.attachmentTagSecondaryExtraLarge),onClick:D(n)})))),o.createElement(Fa,{useAttachmentSearchBoxV2:e.useAttachmentSearchBoxV2,serviceScope:a,enableAutoFocusOnSearchBox:m,displayTabs:l??[n.MeetingSeries],selectedAttachments:g,filterByOrganizersName:f,disabled:e.disabled,openPicker:p,setOpenPicker:_,onAttachmentSelect:y},o.createElement(de.Button,{appearance:"transparent",disabled:e.disabled,icon:o.createElement(Le,{className:b.icon}),size:"small","aria-disabled":e.disabled,className:(0,c.mergeClasses)(b.buttonSize,e.disabled?b.buttonDisabled:b.button)},0===g.length?ja.Pf:ja.Tn))));if(P())return I;{const e=(e,t)=>{new ne._QosMonitor("SPAttachmentBox.attachment.TagPickerAttachments.Render").writeUnexpectedFailure("RenderError",e,{errorMessage:e.message,errorName:e.name,errorInfo:t?.componentStack})};return o.createElement(Na.ErrorBoundary,{onRenderFailure:e,errorRenderer:()=>o.createElement(o.Fragment,null)},I)}}function Ya(e){const{serviceScope:a,size:i="large",decoration:r="none",attachments:s,displayTabs:l,filterByOrganizersName:u,openPicker:f,enableAutoFocusOnSearchBox:p,setOpenPicker:m,addAttachment:_,removeAttachment:h}=e,b=ha(),g=o.useRef(null),v=e=>t=>{t.stopPropagation(),h(e)},y=o.createElement(d.TagPicker,{noPopover:!0,selectedOptions:s.map(e=>e.name),disabled:e.disabled},o.createElement(d.TagPickerControl,{className:b.TagPickerControl},o.createElement(d.TagPickerGroup,{"aria-label":ja.xx,className:b.TagPickerGroup},s.map((n,a)=>o.createElement($e.InteractionTag,{shape:"rounded",appearance:"outline",key:n.id,value:n.id,"data-size":i,className:(0,c.mergeClasses)(b.attachmentTag,"large"===i?b.attachmentTagLarge:b.attachmentTagExtraLarge)},o.createElement($e.InteractionTagPrimary,{className:b.attachmentTagPrimary,media:o.createElement(qe,{size:We.Large,attachment:n}),hasSecondaryAction:!0,primaryText:{className:(0,c.mergeClasses)(b.attachmentTagPrimaryText,e.disabled&&b.attachmentTagPrimaryTextDisabled,"large"===i?b.attachmentTagPrimaryTextLarge:b.attachmentTagPrimaryTextExtraLarge)}},o.createElement("div",{className:b.attachmentName},n.name),n.type!==t.Unauthorized&&o.createElement(_a,{size:"extra-large",sensitivityLabel:n.sensitiveLabel})),o.createElement($e.InteractionTagSecondary,{disabled:e.disabled,"aria-label":ja.T0,className:(0,c.mergeClasses)(b.attachmentTagSecondary,e.disabled&&b.attachmentTagSecondaryDisabled,"none"===r?b.attachmentTagSecondaryBorderless:"","large"===i?b.attachmentTagSecondaryLarge:b.attachmentTagSecondaryExtraLarge),onClick:v(n)})))),o.createElement(Fa,{useAttachmentSearchBoxV2:e.useAttachmentSearchBoxV2,buttonRef:g,serviceScope:a,enableAutoFocusOnSearchBox:p,displayTabs:l??[n.MeetingSeries],selectedAttachments:s,filterByOrganizersName:u,disabled:e.disabled,openPicker:f,setOpenPicker:m,onAttachmentSelect:_},o.createElement(de.Button,{ref:g,appearance:"transparent",disabled:e.disabled,icon:o.createElement(Le,{className:b.icon}),size:"small","aria-disabled":e.disabled,"aria-label":ja.KT,className:(0,c.mergeClasses)(b.buttonSize,e.disabled?b.buttonDisabled:b.button)},M()?0===s.length?ja.Pf:ja.Tn:ja.Pf))));if(P())return y;{const e=(e,t)=>{new ne._QosMonitor("SPAttachmentBox.attachment.TagPickerControlledAttachments.Render").writeUnexpectedFailure("RenderError",e,{errorMessage:e.message,errorName:e.name,errorInfo:t?.componentStack})};return o.createElement(Na.ErrorBoundary,{onRenderFailure:e,errorRenderer:()=>o.createElement(o.Fragment,null)},y)}}var Ja=H(2475),Xa=H(6321);class Za extends Ja.TextNode{static getType(){return"sentinel"}static clone(e){return new Za(e.__key)}createDOM(e){const t=super.createDOM(e);return t.ariaHidden="true",t}isToken(){return!0}exportJSON(){return{...super.exportJSON(),type:"sentinel",version:1}}constructor(e){super("​‌",e)}}var $a=H(8262),ei=H(8182),ti=H(7746),ni=H(226),ai=H.n(ni),ii=H(9161),ri=H(8407),oi=H(3679),si=H(5592);class ci{__enterHandler(e){const t=(0,Ja.$getSelection)();return!!(0,Ja.$isRangeSelection)(t)&&null!==e&&(e.preventDefault(),!e.shiftKey||this.__editor.dispatchCommand(Ja.INSERT_PARAGRAPH_COMMAND,void 0))}insertDefaultValue(e){e&&this.__editor.update(()=>{(0,Ja.$insertNodes)([(0,Ja.$createTextNode)(e)])})}activateContentCallbacks(e,t){this.deactivateContentCallbacks(),this.__contentChangeCleanup=this.__editor.registerTextContentListener(n=>{const a=n.replace("​‌","");null==e||e(a),null==t||t(a.length)})}deactivateContentCallbacks(){var e;null===(e=this.__contentChangeCleanup)||void 0===e||e.call(this),this.__contentChangeCleanup=void 0}activatePasteCallback(e){this.__pasteHandlerCleanup=this.__editor.registerCommand(Ja.PASTE_COMMAND,t=>!!function(e){return"paste"===e.type}(t)&&(e(t),!!t.defaultPrevented),Ja.COMMAND_PRIORITY_HIGH)}deactivatePasteCallback(){var e;null===(e=this.__pasteHandlerCleanup)||void 0===e||e.call(this),this.__pasteHandlerCleanup=void 0}activateTrimWhitespace(){this.deactivateTrimWhitespace(),this.__trimWhitespaceCleanup=this.__editor.registerTextContentListener(e=>{""===e.trim()&&this.__editor.update(()=>{(0,Ja.$getRoot)().getAllTextNodes().forEach(e=>{e.remove()})},{tag:"historic"})})}deactivateTrimWhitespace(){var e;null===(e=this.__trimWhitespaceCleanup)||void 0===e||e.call(this),this.__trimWhitespaceCleanup=void 0}setIsDisabled(e){this.__editor.setEditable(!e)}cleanup(){var e;this.deactivateContentCallbacks(),this.deactivateTrimWhitespace(),this.deactivatePasteCallback(),null===(e=this.__baseHandlersCleanup)||void 0===e||e.call(this),this.__baseHandlersCleanup=void 0}constructor(e){(0,si._define_property)(this,"__editor",void 0),(0,si._define_property)(this,"__contentChangeCleanup",void 0),(0,si._define_property)(this,"__trimWhitespaceCleanup",void 0),(0,si._define_property)(this,"__baseHandlersCleanup",void 0),(0,si._define_property)(this,"__pasteHandlerCleanup",void 0),this.__editor=e,this.__baseHandlersCleanup=(0,ei.mergeRegister)(this.__editor.registerCommand(Ja.KEY_ENTER_COMMAND,this.__enterHandler.bind(this),Ja.COMMAND_PRIORITY_HIGH),function(e){return(0,ei.mergeRegister)(e.registerUpdateListener(({editorState:t})=>{t.read(()=>{const t=function(e){const t=[],n=[e];for(;n.length>0;){const a=n.shift();a&&((0,Ja.$isElementNode)(a)?n.unshift(...a.getChildren()):a!==e&&t.push(a))}return t}((0,Ja.$getRoot)());if(0===t.length)return;const n=t[t.length-1],a=n.getKey();if(!(n instanceof Za))return void e.update(()=>{var e;null===(e=(0,Ja.$getNodeByKey)(a))||void 0===e||e.insertAfter(new Za(void 0))},{discrete:!0,tag:"historic"});if(!n.getPreviousSibling()||!n.isSelected())return;const i=(0,Ja.$getSelection)();if((0,Ja.$isRangeSelection)(i))if(i.isCollapsed()&&i.anchor.offset>0)e.update(()=>{var e;null===(e=(0,Ja.$getNodeByKey)(a))||void 0===e||e.selectStart()});else if(!i.isCollapsed()){let t=!1;const r=i.clone();r.anchor.getNode()===n&&r.anchor.offset>0&&(r.anchor.set(a,0,"text"),t=!0),r.focus.getNode()===n&&r.focus.offset>0&&(r.focus.set(a,0,"text"),t=!0),t&&e.update(()=>{null!==(0,Ja.$getNodeByKey)(a)&&(0,Ja.$setSelection)((0,Ja.$normalizeSelection__EXPERIMENTAL)(r))})}})}),e.registerNodeTransform(Za,e=>{e.getPreviousSibling()&&!e.getNextSibling()||e.remove()}))}(e))}}const di=o.forwardRef((e,t)=>{const{defaultValue:n,trimWhitespace:a,onCountChanged:i,onContentChange:r,onPaste:s}=e,[d]=(0,oi.useLexicalComposerContext)(),l=o.useRef(null);return(0,c.useIsomorphicLayoutEffect)(()=>(l.current=new ci(d),()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.cleanup()}),[d]),o.useImperativeHandle(t,()=>({setIsDisabled(e){var t;null===(t=l.current)||void 0===t||t.setIsDisabled(e)}})),(0,c.useIsomorphicLayoutEffect)(()=>{var e;n&&(null===(e=l.current)||void 0===e||e.insertDefaultValue(n))},[d]),o.useEffect(()=>{var e;return null===(e=l.current)||void 0===e||e.activateContentCallbacks(r,i),()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.deactivateContentCallbacks()}},[d,r,i]),o.useEffect(()=>{var e;return s&&(null===(e=l.current)||void 0===e||e.activatePasteCallback(s)),()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.deactivatePasteCallback()}},[d,s]),o.useEffect(()=>{var e;return a&&(null===(e=l.current)||void 0===e||e.activateTrimWhitespace()),()=>{var e;return null===(e=l.current)||void 0===e?void 0:e.deactivateTrimWhitespace()}},[d,a]),null}),li=(0,c.__resetStyles)("r1x54j0a",null,[".r1x54j0a{display:inline-grid;white-space:pre-wrap;}"]),ui=(0,c.__styles)({paragraph:{jrapky:0,Frg6f3:0,t21cq0:0,B6of3ja:0,B74szlk:"f1s184ao"}},{d:[[".f1s184ao{margin:0;}",{p:-1}]]}),fi=(0,c.__resetStyles)("rrmx5oh",null,{r:[".rrmx5oh{z-index:0;grid-area:1/1/1/1;color:var(--colorNeutralForeground4);font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);}"],s:["@media (forced-colors: active){.rrmx5oh{color:GrayText;}}"]}),pi=(0,c.__resetStyles)("r18fti29",null,[".r18fti29{grid-area:1/1/1/1;z-index:1;width:100%;}"]),mi=(0,c.__styles)({placeholderDisabled:{sj55zd:"f1s2aq7o"}},{d:[".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}"]}),_i=o.forwardRef((e,t)=>{const n=((e,t)=>{const{onChange:n,onPaste:a,trimWhiteSpace:i=!1,textPlugin:r=$a.PlainTextPlugin,history:s=!0,editorRef:d}=e,{root:l,primary:u}=(0,c.getPartitionedNativeProps)({primarySlotTagName:"span",props:e,excludedPropNames:["onChange","onPaste","defaultValue"]}),f=(0,c.useMergedRefs)(o.useRef(null),d),[p,m]=(0,c.useControllableState)({state:e.disabled,initialState:!1}),_=e.customNodes?[...e.customNodes,Za]:[Za],h=o.useCallback(e=>{var t;null===(t=f.current)||void 0===t||t.setRootElement(e)},[f]);(0,c.useIsomorphicLayoutEffect)(()=>{var e;f.current&&(null===(e=f.current)||void 0===e||e.setEditable(!p))},[p]),(0,c.useIsomorphicLayoutEffect)(()=>{var e;if(f.current)return(0,ei.mergeRegister)(f.current.registerEditableListener(e=>{m(!e)}),null===(e=f.current)||void 0===e?void 0:e.registerRootListener(e=>{e&&(e.style.whiteSpace="")}))},[f]);const b=o.useCallback(e=>{null==n||n({},{value:e})},[n]),[g,v]="function"==typeof e.defaultValue?[void 0,e.defaultValue]:[e.defaultValue,void 0],y=c.slot.optional(e.placeholderValue,{elementType:"span"}),S=(0,c.useId)("chat-input-placeholder",null==y?void 0:y.id);return y&&(y.id=S),{components:{root:"span",input:"span",placeholderValue:"span"},root:c.slot.always(e.root,{defaultProps:{...l},elementType:"span"}),input:c.slot.always(e.input,{defaultProps:{ref:(0,c.useMergedRefs)(t,h),role:"textbox",contentEditable:!p,"aria-readonly":!!p||void 0,tabIndex:p?-1:0,disabled:p,suppressContentEditableWarning:!0,...u,"aria-describedby":u["aria-describedby"]?`${u["aria-describedby"]} ${S}`:S},elementType:"span"}),placeholderValue:y,lexicalInitialConfig:{namespace:"fai-EditorInput",onError:console.error,nodes:_,editorState:v},editorRef:f,disabled:p,textPlugin:r,onPaste:a,handleOnChange:b,defaultValue:g,trimWhiteSpace:i,history:s}})(e,t);return(e=>{const{disabled:t}=e,n=fi(),a=li(),i=pi(),r=mi();e.root.className=(0,c.mergeClasses)("fai-EditorInput",a,e.root.className),e.input.className=(0,c.mergeClasses)("fai-EditorInput__input",i,e.input.className),e.lexicalInitialConfig={...e.lexicalInitialConfig,theme:{...ui(),...e.lexicalInitialConfig.theme}},e.placeholderValue&&(e.placeholderValue.className=(0,c.mergeClasses)("fai-EditorInput__placeholderValue",n,t&&r.placeholderDisabled,e.placeholderValue.className))})(n),(e=>((0,c.assertSlots)(e),(0,c.jsx)(e.root,{children:(0,c.jsxs)(ti.LexicalComposer,{initialConfig:e.lexicalInitialConfig,children:[(0,c.jsx)(e.textPlugin,{contentEditable:(0,c.jsx)(e.input,{}),ErrorBoundary:ai(),placeholder:e.placeholderValue?(0,c.jsx)(e.placeholderValue,{}):null}),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(di,{onContentChange:e.handleOnChange,onPaste:e.onPaste,trimWhitespace:e.trimWhiteSpace,defaultValue:e.defaultValue}),e.history&&(0,c.jsx)(ii.HistoryPlugin,{})]}),(0,c.jsx)(ri.EditorRefPlugin,{editorRef:e.editorRef})]})})))(n)});_i.displayName="EditorInput";const hi=(0,c.__styles)({root:{mc9l5x:"fjseox"},visible:{mc9l5x:"f1w7gpdv"}},{d:[".fjseox{display:none;}",".f1w7gpdv{display:inline;}"]}),bi=(e,t)=>{const n=n=>{const{className:a,filled:i,...r}=n,s=hi();return o.createElement(o.Fragment,null,o.createElement(e,Object.assign({},r,{className:(0,c.mergeClasses)(s.root,i&&s.visible,"fui-Icon-filled",a)})),o.createElement(t,Object.assign({},r,{className:(0,c.mergeClasses)(s.root,!i&&s.visible,"fui-Icon-regular",a)})))};return n.displayName="CompoundIcon",n},gi=Ae("ErrorCircle16Filled","16",["M8 2a6 6 0 1 1 0 12A6 6 0 0 1 8 2Zm0 8a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5Zm0-5.5a.5.5 0 0 0-.5.41V8.59a.5.5 0 0 0 1 0V4.91A.5.5 0 0 0 8 4.5Z"]),vi=bi(ke,Me),yi=bi(Ue,Fe),Si="fai-PromptInput__editor",Di=(0,c.__resetStyles)("r1y0bpiz",null,[".r1y0bpiz{display:flex;flex-direction:column-reverse;position:relative;}"]),Ii=(0,c.__resetStyles)("r1fd1cjs","r34chhf",{r:['.r1fd1cjs{box-sizing:border-box;display:grid;grid-template-areas:"media input actions" "attachments attachments attachments" "error error error";grid-template-columns:max-content 1fr max-content;grid-template-rows:auto auto;column-gap:var(--spacingHorizontalXS);align-items:center;width:100%;border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusLarge);position:relative;margin:0;padding:var(--spacingVerticalS) var(--spacingHorizontalMNudge);}',".r1fd1cjs:focus,.r1fd1cjs:focus-within{background-color:var(--colorNeutralBackground1);}",'.r1fd1cjs::after{transform:scaleX(0);box-sizing:border-box;content:"";position:absolute;left:-1px;bottom:-1px;right:-1px;height:var(--borderRadiusLarge);border-bottom-left-radius:var(--borderRadiusLarge);border-bottom-right-radius:var(--borderRadiusLarge);border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - var(--strokeWidthThick)) 0 0 0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}','.r34chhf{box-sizing:border-box;display:grid;grid-template-areas:"media input actions" "attachments attachments attachments" "error error error";grid-template-columns:max-content 1fr max-content;grid-template-rows:auto auto;column-gap:var(--spacingHorizontalXS);align-items:center;width:100%;border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusLarge);position:relative;margin:0;padding:var(--spacingVerticalS) var(--spacingHorizontalMNudge);}',".r34chhf:focus,.r34chhf:focus-within{background-color:var(--colorNeutralBackground1);}",'.r34chhf::after{transform:scaleX(0);box-sizing:border-box;content:"";position:absolute;right:-1px;bottom:-1px;left:-1px;height:var(--borderRadiusLarge);border-bottom-right-radius:var(--borderRadiusLarge);border-bottom-left-radius:var(--borderRadiusLarge);border-bottom:var(--strokeWidthThick) solid var(--colorCompoundBrandStroke);clip-path:inset(calc(100% - var(--strokeWidthThick)) 0 0 0);transition-property:transform;transition-duration:var(--durationUltraFast);transition-delay:var(--curveAccelerateMid);}'],s:["@media screen and (prefers-reduced-motion: reduce){.r1fd1cjs::after{transition-duration:0.01ms;transition-delay:0.01ms;}}","@media screen and (prefers-reduced-motion: reduce){.r34chhf::after{transition-duration:0.01ms;transition-delay:0.01ms;}}"]}),xi=(0,c.__styles)({adjustToContentSize:{Bf4jedk:"ftxbdd3",a9b677:"f1acs6jw"}},{d:[".ftxbdd3{min-width:240px;}",".f1acs6jw{width:fit-content;}"]}),Ci=(0,c.__styles)({overflowing:{zoa1oz:"f1xb1dxl",Budl1dq:"f1787940",a9b677:"fly5x3f"},dismissableOverflowing:{zoa1oz:"f10be46f",Budl1dq:"f10rvxd0",a9b677:"fly5x3f"},inline:{B9xav0g:"fskmnqw",oetu4i:"f1l4zc64",B9zn80p:"fzjvmt4"},elevated:{icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],E5pizo:"f1hg901r",Eqx8gd:["f1n6gb5g","f15yvnhg"],By385i5:"fo72kxq",B1piin3:["f15yvnhg","f1n6gb5g"],B1q35kw:"faznu88"},focus:{b1kco5:"f16t1kdf",Ba2ppi3:"fhwpy7i",F2fol1:"f15cmg8x",lck23g:"f491wbe",B1q35kw:"f1jc6hxc",wi16st:"fsrmcvb",ywj3b2:"f1t3k7v9",jgq6uv:"f73i0vf"},disabled:{De3pzq:"f1c21dwh",B4j52fo:"f192inf7",Bekrc4i:["f5tn483","f1ojsxk5"],Bn0qgzm:"f1vxd6vx",ibv6hh:["f1ojsxk5","f5tn483"],icvyot:"fzkkow9",vrafjx:["fcdblym","fjik90z"],oivjwe:"fg706s2",wvpqe5:["fjik90z","fcdblym"],g2u3we:"f1jj8ep1",h3c5rm:["f15xbau","fy0fskl"],B9xav0g:"f4ikngz",zhjwy3:["fy0fskl","f15xbau"],Bcq6wej:"f9dbb4x",Jcjdmf:["f3qs60o","f5u9ap2"],sc4o1m:"fwd1oij",Bosien3:["f5u9ap2","f3qs60o"]}},{d:['.f1xb1dxl{grid-template-areas:"media input input" ". attachments attachments" ". error error" ". count actions";}',".f1787940{grid-template-columns:max-content repeat(2, 1fr);}",".fly5x3f{width:100%;}",'.f10be46f{grid-template-areas:"media input input dismiss" ". attachments attachments attachments" ". error error error" ". count actions actions";}',".f10rvxd0{grid-template-columns:max-content 1fr max-content max-content;}",".fskmnqw{border-bottom-color:var(--colorNeutralForeground2);}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".f1hg901r{box-shadow:var(--shadow16);}",".f1n6gb5g::after{left:0;}",".f15yvnhg::after{right:0;}",".fo72kxq::after{bottom:0;}",".faznu88::after{border-bottom-color:transparent;}",".f16t1kdf::after{transform:scaleX(1);}",".fhwpy7i::after{transition-property:transform;}",".f15cmg8x::after{transition-duration:var(--durationNormal);}",".f491wbe::after{transition-delay:var(--curveDecelerateMid);}",".f1jc6hxc::after{border-bottom-color:var(--colorCompoundBrandStroke);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f192inf7{border-top-width:var(--strokeWidthThin);}",".f5tn483{border-right-width:var(--strokeWidthThin);}",".f1ojsxk5{border-left-width:var(--strokeWidthThin);}",".f1vxd6vx{border-bottom-width:var(--strokeWidthThin);}",".fzkkow9{border-top-style:solid;}",".fcdblym{border-right-style:solid;}",".fjik90z{border-left-style:solid;}",".fg706s2{border-bottom-style:solid;}",".f1jj8ep1{border-top-color:var(--colorNeutralStrokeDisabled);}",".f15xbau{border-right-color:var(--colorNeutralStrokeDisabled);}",".fy0fskl{border-left-color:var(--colorNeutralStrokeDisabled);}",".f4ikngz{border-bottom-color:var(--colorNeutralStrokeDisabled);}"],h:[".f1l4zc64:hover{border-bottom-color:var(--colorNeutralStrokeAccessibleHover);}",".fzjvmt4:hover:active{border-bottom-color:var(--colorNeutralForeground2Pressed);}"],m:[["@media screen and (prefers-reduced-motion: reduce){.fsrmcvb::after{transition-duration:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1t3k7v9::after{transition-delay:0.01ms;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media (forced-colors: active){.f9dbb4x{border-top-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f3qs60o{border-right-color:GrayText;}.f5u9ap2{border-left-color:GrayText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.fwd1oij{border-bottom-color:GrayText;}}",{m:"(forced-colors: active)"}]],a:[".f73i0vf:active::after{border-bottom-color:var(--colorCompoundBrandStrokePressed);}"]}),Oi=(0,c.__styles)({disabled:{Bceei9c:"fdrzuqr"},editorRoot:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"frl7btn"},input:{Huce71:"fz5stix",Biipf1f:"f1bftd5k",Bmxbyg5:"f1sil6mw",B68tc82:"f1p9o1ba",icvyot:"f1ern45e",vrafjx:["f1n71otn","f1deefiw"],oivjwe:"f1h8hb77",wvpqe5:["f1deefiw","f1n71otn"],De3pzq:"f3rmtva",B7ck84d:"f1ewtqcl",oeaueh:"f1s6fcnf"},overflowingInput:{Huce71:"fibxuh5",Biipf1f:"f9ijwd5",Bmxbyg5:"f5zp4f",Bxyxcbc:"fkaqm7j"},placeholderValue:{B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",Huce71:"fz5stix",ygn44y:"f1cmbuwj"}},{d:[".fdrzuqr{cursor:not-allowed;}",[".frl7btn{grid-area:input;}",{p:-1}],".fz5stix{white-space:nowrap;}",".f1bftd5k{word-break:normal;}",".f1sil6mw{overflow-y:hidden;}",".f1p9o1ba{overflow-x:hidden;}",".f1ern45e{border-top-style:none;}",".f1n71otn{border-right-style:none;}",".f1deefiw{border-left-style:none;}",".f1h8hb77{border-bottom-style:none;}",".f3rmtva{background-color:transparent;}",".f1ewtqcl{box-sizing:border-box;}",".f1s6fcnf{outline-style:none;}",".fibxuh5{white-space:pre-wrap;}",".f9ijwd5{word-break:break-word;}",".f5zp4f{overflow-y:auto;}",".fkaqm7j{max-height:240px;}",".f1cmbuwj{text-overflow:ellipsis;}"]}),wi=(0,c.__styles)({media:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"fujjg13",mc9l5x:"f22iagw",Bt984gj:"f122n59",qb2dma:"f9h729m",Brf1p80:"f4d9j23",Bf4jedk:"f17fgpbq",sshi5w:"f1pha7fy"},disabledCount:{sj55zd:"f1s2aq7o"},dismiss:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"f1m4f10d",mc9l5x:"f22iagw",Bt984gj:"f122n59",qb2dma:"f9h729m",Brf1p80:"f4d9j23"},actions:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"fceb517",qb2dma:"f9h729m",B7ck84d:"f1ewtqcl",mc9l5x:"f22iagw",Eh141a:"fni485r",a9b677:"fly5x3f",Brf1p80:"f9c4gz4",Bmliigx:"fxe27oy"},actionsOverflow:{Bdqf98w:"f133pu1g",a9b677:"f1acs6jw"},attachments:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"f17lhllk",B6of3ja:"f1m82j8g",jrapky:"f8l5zjj"},errorMessage:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"f12xo2lb",sj55zd:"f1ca9wz",Bahqtrf:"fk6fouc",Be2twd7:"fy9rknc",Bhrd7zp:"figsok6",Bg96gwp:"fwrc4pm",mc9l5x:"f22iagw",Bt984gj:"f122n59",i8kkvl:"f1ufnopg",B6of3ja:"f1m82j8g"},errorMessageIcon:{mc9l5x:"ftuwxu6",Bt984gj:"f122n59"},count:{Bw0ie65:0,Br312pm:0,nk6f5a:0,Ijaq50:0,Bq1tomu:"fhw3785",qb2dma:"f7nlbp4",sj55zd:"fxc4j92",Bahqtrf:"fk6fouc",Be2twd7:"f13mqy1h",Bhrd7zp:"figsok6",Bg96gwp:"fcpl73t"},countError:{sj55zd:"f1ca9wz"}},{d:[[".fujjg13{grid-area:media;}",{p:-1}],".f22iagw{display:flex;}",".f122n59{align-items:center;}",".f9h729m{align-self:start;}",".f4d9j23{justify-content:center;}",".f17fgpbq{min-width:24px;}",".f1pha7fy{min-height:24px;}",".f1s2aq7o{color:var(--colorNeutralForegroundDisabled);}",[".f1m4f10d{grid-area:dismiss;}",{p:-1}],[".fceb517{grid-area:actions;}",{p:-1}],".f1ewtqcl{box-sizing:border-box;}",".fni485r{flex-wrap:wrap;}",".fly5x3f{width:100%;}",".f9c4gz4{justify-content:flex-end;}",".fxe27oy{align-content:center;}",".f133pu1g{justify-self:flex-end;}",".f1acs6jw{width:fit-content;}",[".f17lhllk{grid-area:attachments;}",{p:-1}],".f1m82j8g{margin-top:calc(var(--spacingVerticalM) - var(--spacingVerticalS));}",".f8l5zjj{margin-bottom:var(--spacingVerticalXS);}",[".f12xo2lb{grid-area:error;}",{p:-1}],".f1ca9wz{color:var(--colorStatusDangerForeground1);}",".fk6fouc{font-family:var(--fontFamilyBase);}",".fy9rknc{font-size:var(--fontSizeBase200);}",".figsok6{font-weight:var(--fontWeightRegular);}",".fwrc4pm{line-height:var(--lineHeightBase200);}",".f1ufnopg{column-gap:var(--spacingHorizontalXS);}",".ftuwxu6{display:inline-flex;}",[".fhw3785{grid-area:count;}",{p:-1}],".f7nlbp4{align-self:center;}",".fxc4j92{color:var(--colorNeutralForeground4);}",".f13mqy1h{font-size:var(--fontSizeBase100);}",".fcpl73t{line-height:var(--lineHeightBase100);}"]}),Ei=o.forwardRef((e,t)=>{const n=((e,t)=>{const{appearance:n="inline",characterCount:a,characterLimitErrorMessage:i="Character limit exceeded",className:r,disabled:s=!1,maxLength:d=500,fluid:l=!0,style:u,onSubmit:f,onChange:p,showCount:m=!1,listbox:_,isInSelectionMode:h,dismissable:b=!1,divider:g,onLineModeChange:v,trapFocus:y=!0,messageBar:S,...D}=e,I=o.useRef(null),[x,C]=o.useState(!1),[O,w]=o.useState("");var E;const[A,L]=(0,c.useControllableState)({state:a,initialState:null!==(E=null==O?void 0:O.length)&&void 0!==E?E:0}),[k,M]=(0,c.useControllableState)({state:e.lineMode,initialState:"singleline"}),P=o.useCallback(e=>{M(e),null==v||v({lineMode:e})},[v,M]),{announce:T}=(0,c.useAnnounce_unstable)(),U=e.disableSend||s,F=o.useCallback((e,t)=>{null==p||p({},t),I.current&&(I.current.clientWidth<I.current.scrollWidth||t.value.includes("\n")?P("multiline"):""===t.value.trim()&&P("singleline")),w(t.value),L(t.value.length)},[p,L,P]),H=c.slot.always(e.editor,{defaultProps:{...D,disabled:s},elementType:_i});H.ref=(0,c.useMergedRefs)(t,I);const R=(e=>{const{characterLimitErrorMessage:t,characterCountExceeded:n,errorMessage:a,announce:i}=e,r=o.useRef(null),s=n?{children:t}:void 0,d=c.slot.optional(a,{defaultProps:s,renderByDefault:n,elementType:"span"}),l=(0,c.useMergedRefs)(r,null==d?void 0:d.ref);d&&(d.ref=l);const u=o.useRef(!1),f=o.useRef("");return o.useEffect(()=>{var e,o;const s=null===(o=r.current)||void 0===o||null===(e=o.innerText)||void 0===e?void 0:e.trim();s||(f.current=""),n||(u.current=!1),a||!n||u.current?s&&s!==f.current&&(i(s),f.current=s):(i(t),u.current=!0)},[i,a,n,t]),d})({announce:T,characterLimitErrorMessage:i,characterCountExceeded:A>d,errorMessage:e.errorMessage}),N=(0,c.useFocusableGroup)({tabBehavior:"limited-trap-focus"}),B=m&&"multiline"===k?c.slot.optional(e.count,{defaultProps:{children:`${A} / ${d}`},elementType:"span",renderByDefault:!0}):void 0,j=c.slot.always(e.root,{defaultProps:{...y?N:{},className:r,style:u},elementType:"div"}),V={appearance:n,disabled:s,fluid:l,divider:g,hasEditorFocus:x,lineMode:k,listbox:_,components:{root:"div",inputWrapper:"div",editor:_i,actions:"span",count:"span",send:de.Button,dismiss:de.Button,attachments:"span",media:"span",errorMessage:"span",errorMessageIcon:"span",messageBar:Xa.MessageBar},editor:H,root:j,inputWrapper:c.slot.always(e.inputWrapper,{elementType:"div"}),attachments:c.slot.optional(e.attachments,{elementType:"span"}),count:B,media:c.slot.optional(e.media,{elementType:"span"}),actions:c.slot.always(e.actions,{elementType:"span"}),send:c.slot.optional(e.send,{defaultProps:{appearance:"transparent",disabled:U,disabledFocusable:!!U||void 0,icon:o.createElement(vi,null),"aria-disabled":!!U||void 0,"aria-label":"Send",size:"small",type:"submit",tabIndex:U?-1:void 0},elementType:de.Button,renderByDefault:!0}),dismiss:c.slot.optional(e.dismiss,{defaultProps:{appearance:"transparent",icon:o.createElement(yi,null),size:"small",type:"dismiss"},elementType:de.Button,renderByDefault:b}),errorMessage:R,errorMessageIcon:c.slot.optional(e.errorMessageIcon,{defaultProps:{children:o.createElement(gi,null)},renderByDefault:!!R,elementType:"span"}),messageBar:c.slot.optional(e.messageBar,{elementType:Xa.MessageBar,defaultProps:{layout:"auto"}})},{onFocus:z,onBlur:G}=V.editor;V.editor.onFocus=(0,c.useEventCallback)((0,c.mergeCallbacks)(z,()=>{C(!0)})),V.editor.onBlur=(0,c.useEventCallback)((0,c.mergeCallbacks)(G,()=>{C(!1)})),V.editor.onChange=(0,c.useEventCallback)((0,c.mergeCallbacks)(H.onChange,F));const K=o.useRef(!1),W=o.useRef(null);V.editor.editorRef=(0,c.useMergedRefs)(W,V.editor.editorRef),o.useEffect(()=>{var e;return null===(e=W.current)||void 0===e?void 0:e.registerCommand(Ja.KEY_ENTER_COMMAND,()=>(K.current=!0,!1),Ja.COMMAND_PRIORITY_CRITICAL)},[]);const{onKeyDown:q}=V.editor;V.editor.onKeyDown=(0,c.useEventCallback)((0,c.mergeCallbacks)(q,e=>{const{key:t,shiftKey:n}=e;!K.current||e.nativeEvent.isComposing||h||U||n||t!==gt||(null==f||f(e,{value:O}),e.preventDefault()),K.current=!1}));const{onClick:Q}=V.send||{},Y=(0,c.useEventCallback)((0,c.mergeCallbacks)(Q,e=>{U&&e.preventDefault(),null==f||f(e,{value:O})}));return V.send&&(V.send.onClick=Y),V})(e,t);return(e=>{const{appearance:t,disabled:n,dismiss:a,hasEditorFocus:i,fluid:r,lineMode:o}=e,s=wi(),d=Di(),l=xi(),u=Ii(),f=Ci(),p=Oi();e.root.className=(0,c.mergeClasses)("fai-PromptInput",d,!r&&"singleline"===o&&l.adjustToContentSize,e.root.className),e.inputWrapper.className=(0,c.mergeClasses)("fai-PromptInput__inputWrapper",u,!n&&("elevated"===t?f.elevated:f.inline),n&&f.disabled,!n&&i&&f.focus,"multiline"===o&&(a?f.dismissableOverflowing:f.overflowing),e.inputWrapper.className),e.editor.className=(0,c.mergeClasses)(p.editorRoot,e.editor.className),e.count&&(e.count.className=(0,c.mergeClasses)("fai-PromptInput__count",s.count,n&&s.disabledCount,e.errorMessage&&s.countError,e.count.className));const m=c.slot.always(e.editor.input,{elementType:"span"});if(m.className=(0,c.mergeClasses)(Si,p.input,"multiline"===o&&p.overflowingInput,n&&p.disabled,m.className),e.editor.input=m,e.editor.placeholderValue){const t=c.slot.always(e.editor.placeholderValue,{elementType:"span"});t.className=(0,c.mergeClasses)(Si,p.placeholderValue,t.className),e.editor.placeholderValue=t}e.actions&&(e.actions.className=(0,c.mergeClasses)("fai-PromptInput__actions",s.actions,"multiline"===o&&s.actionsOverflow,e.actions.className)),e.send&&(e.send.className=(0,c.mergeClasses)("fai-PromptInput__send",e.send.className)),e.errorMessage&&(e.errorMessage.className=(0,c.mergeClasses)("fai-PromptInput__errorMessage",s.errorMessage,e.errorMessage.className)),e.errorMessageIcon&&(e.errorMessageIcon.className=(0,c.mergeClasses)("fai-PromptInput__errorMessageIcon",s.errorMessageIcon,e.errorMessageIcon.className)),e.attachments&&(e.attachments.className=(0,c.mergeClasses)("fai-PromptInput__attachments",s.attachments,e.attachments.className)),e.media&&(e.media.className=(0,c.mergeClasses)("fai-PromptInput__media",s.media,e.media.className)),e.dismiss&&(e.dismiss.className=(0,c.mergeClasses)("fai-PromptInput__dismiss",s.dismiss,e.dismiss.className)),e.messageBar&&(e.messageBar.className=(0,c.mergeClasses)("fai-PromptInput__messageBar",e.messageBar.className))})(n),(e=>{const{lineMode:t}=e;return(0,c.assertSlots)(e),(0,c.jsxs)(e.root,{children:[(0,c.jsxs)(e.inputWrapper,{children:[e.media&&(0,c.jsx)(e.media,{}),(0,c.jsx)(e.editor,{}),e.listbox,e.count&&(0,c.jsx)(e.count,{}),(0,c.jsxs)(e.actions,{children:[e.actions.children,("multiline"===t||!e.dismiss)&&e.divider,e.send&&(0,c.jsx)(e.send,{}),"singleline"===t&&e.dismiss&&e.divider,"singleline"===t&&e.dismiss&&(0,c.jsx)(e.dismiss,{})]}),e.attachments&&(0,c.jsx)(e.attachments,{}),"multiline"===t&&e.dismiss&&(0,c.jsx)(e.dismiss,{}),e.errorMessage&&(0,c.jsxs)(e.errorMessage,{children:[e.errorMessageIcon&&(0,c.jsx)(e.errorMessageIcon,{}),e.errorMessage.children]})]}),e.messageBar&&(0,c.jsx)(e.messageBar,{})]})})(n)});Ei.displayName="PromptInput",(0,c.__resetStyles)("r16wonf3",null,[".r16wonf3{display:inline-flex;flex-wrap:nowrap;vertical-align:middle;box-sizing:border-box;width:fit-content;align-self:end;position:relative;}"]),c.tokens.colorNeutralBackground1,c.tokens.strokeWidthThin,c.tokens.colorNeutralStroke1,c.tokens.borderRadiusMedium,c.tokens.spacingHorizontalSNudge,c.tokens.colorNeutralForeground1,(0,c.createCustomFocusIndicatorStyle)({outline:`${c.tokens.strokeWidthThick} solid ${c.tokens.colorStrokeFocus2}`,zIndex:1}),(0,c.__resetStyles)("r1ng7ytw","r154t9rh",[".r1ng7ytw{align-items:center;background-color:var(--colorNeutralBackground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);box-sizing:border-box;column-gap:var(--spacingHorizontalSNudge);color:var(--colorNeutralForeground1);cursor:pointer;display:inline-flex;flex-wrap:nowrap;justify-content:center;vertical-align:middle;border-top-right-radius:var(--borderRadiusNone);border-bottom-right-radius:var(--borderRadiusNone);border-right-style:none;max-width:calc(180px - 20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS) - var(--spacingHorizontalXS));padding:var(--spacingVerticalXS) var(--spacingHorizontalS) var(--spacingVerticalXS) var(--spacingHorizontalS);}",".r1ng7ytw[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);z-index:1;}",".r154t9rh{align-items:center;background-color:var(--colorNeutralBackground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);box-sizing:border-box;column-gap:var(--spacingHorizontalSNudge);color:var(--colorNeutralForeground1);cursor:pointer;display:inline-flex;flex-wrap:nowrap;justify-content:center;vertical-align:middle;border-top-left-radius:var(--borderRadiusNone);border-bottom-left-radius:var(--borderRadiusNone);border-left-style:none;max-width:calc(180px - 20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS) - var(--spacingHorizontalXS));padding:var(--spacingVerticalXS) var(--spacingHorizontalS) var(--spacingVerticalXS) var(--spacingHorizontalS);}",".r154t9rh[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);z-index:1;}"]),(0,c.__styles)({button:{eoavqd:"f8491dx",Jwef8y:"f1h648pw",Bi91k9c:"fnwyq0v",ecr2s2:"fwdzr64",lj723h:"flvvhsy",Bbkh6qg:"fkiggi6",Cnge2b:"f8zknr1"}},{h:[".f8491dx:hover{cursor:pointer;}",".f1h648pw:hover{background-color:var(--colorNeutralBackground3Hover);}",".fnwyq0v:hover{color:var(--colorNeutralForeground2Hover);}"],a:[".fwdzr64:active{background-color:var(--colorNeutralBackground3Pressed);}",".flvvhsy:active{color:var(--colorNeutralForeground2Pressed);}"],m:[["@media (forced-colors: active){.fkiggi6:hover{background-color:HighlightText;}}",{m:"(forced-colors: active)"}],["@media (forced-colors: active){.f8zknr1:active{background-color:HighlightText;}}",{m:"(forced-colors: active)"}]]}),(0,c.__resetStyles)("r1ky29as","rhkudax",{r:[".r1ky29as{align-items:center;background-color:var(--colorNeutralBackground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);box-sizing:border-box;column-gap:var(--spacingHorizontalSNudge);color:var(--colorNeutralForeground1);cursor:pointer;display:inline-flex;flex-wrap:nowrap;justify-content:center;vertical-align:middle;padding:var(--spacingVerticalXS) var(--spacingHorizontalXS) var(--spacingVerticalXS) var(--spacingHorizontalXS);max-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS))+var(--spacingHorizontalXS);min-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS))+var(--spacingHorizontalXS);border-left-color:var(--colorNeutralStroke1);border-top-left-radius:var(--borderRadiusNone);border-bottom-left-radius:var(--borderRadiusNone);border-top-right-radius:var(--borderRadiusMedium);border-bottom-right-radius:var(--borderRadiusMedium);}",".r1ky29as[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);z-index:1;}",".r1ky29as:hover{cursor:pointer;background-color:var(--colorNeutralBackground3Hover);color:var(--colorNeutralForeground2BrandHover);}",".r1ky29as:hover .fai-Attachment__dismissIcon{color:var(--colorBrandForegroundLinkHover);}",".r1ky29as:active{background-color:var(--colorNeutralBackground3Pressed);color:var(--colorNeutralForeground2BrandPressed);}",".r1ky29as:focus .fai-Attachment__dismissIcon{color:var(--colorNeutralForeground2BrandHover);}",".rhkudax{align-items:center;background-color:var(--colorNeutralBackground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);box-sizing:border-box;column-gap:var(--spacingHorizontalSNudge);color:var(--colorNeutralForeground1);cursor:pointer;display:inline-flex;flex-wrap:nowrap;justify-content:center;vertical-align:middle;padding:var(--spacingVerticalXS) var(--spacingHorizontalXS) var(--spacingVerticalXS) var(--spacingHorizontalXS);max-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS))+var(--spacingHorizontalXS);min-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS))+var(--spacingHorizontalXS);border-right-color:var(--colorNeutralStroke1);border-top-right-radius:var(--borderRadiusNone);border-bottom-right-radius:var(--borderRadiusNone);border-top-left-radius:var(--borderRadiusMedium);border-bottom-left-radius:var(--borderRadiusMedium);}",".rhkudax[data-fui-focus-visible]{outline:var(--strokeWidthThick) solid var(--colorStrokeFocus2);z-index:1;}",".rhkudax:hover{cursor:pointer;background-color:var(--colorNeutralBackground3Hover);color:var(--colorNeutralForeground2BrandHover);}",".rhkudax:hover .fai-Attachment__dismissIcon{color:var(--colorBrandForegroundLinkHover);}",".rhkudax:active{background-color:var(--colorNeutralBackground3Pressed);color:var(--colorNeutralForeground2BrandPressed);}",".rhkudax:focus .fai-Attachment__dismissIcon{color:var(--colorNeutralForeground2BrandHover);}"],s:["@media (forced-colors: active){.r1ky29as:hover{background-color:HighlightText;}.r1ky29as:active{background-color:HighlightText;}}","@media (forced-colors: active){.rhkudax:hover{background-color:HighlightText;}.rhkudax:active{background-color:HighlightText;}}"]}),(0,c.__resetStyles)("r1a4a4my",null,[".r1a4a4my{align-items:center;display:inline-flex;font-size:20px;height:20px;line-height:20px;width:20px;}"]),(0,c.__resetStyles)("rmt99gk",null,[".rmt99gk{overflow-x:hidden;text-overflow:ellipsis;white-space:nowrap;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);line-height:var(--lineHeightBase300);}"]),(0,c.__resetStyles)("r176grtk",null,[".r176grtk{align-items:center;border-radius:var(--borderRadiusCircular);border:var(--strokeWidthThin) solid var(--colorTransparentStroke);box-sizing:border-box;color:var(--colorNeutralForeground1);display:inline-flex;font-size:20px;height:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingVerticalXXS));justify-content:center;max-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS));min-width:calc(20px + var(--strokeWidthThin) * 2 + var(--spacingHorizontalXXS));padding:calc(var(--spacingVerticalXXS) / 2) calc(var(--spacingHorizontalXXS) / 2);}"]),(0,c.__styles)({primaryAction:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1mk8lai"},content:{Bg96gwp:"fez10in"}},{d:[[".f1mk8lai{padding:0;}",{p:-1}],".fez10in{line-height:0;}"]});const Ai=(0,c.__styles)({overflow:{B2u0y6b:"f6dzj5z",a9b677:"fly5x3f"}},{d:[".f6dzj5z{max-width:100%;}",".fly5x3f{width:100%;}"]});var Li=H(2323);const ki=(0,c.createContext)(void 0),Mi={isOverflowing:!1,overflowButtonRef:void 0,overflowCount:0},Pi=ki.Provider;var Ti=H(6879);const Ui=(0,c.__styles)({progress:{a9b677:"fly5x3f",qhf8xq:"f1euv43f",B5kzvoi:"f1yab3r1",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bqenvij:"f6ywr7j",Beyfa6y:["f16jpd5f","f1aa9q02"],Bbmb7ep:["f1aa9q02","f16jpd5f"]},regularProgressBar:{Bqenvij:"f1l02sjl",Bcmaq0h:"fx7worf"},indeterminateProgressBar:{Bqenvij:"f1l02sjl",De3pzq:"f1c21dwh",Bcmaq0h:"f1hxqsn5",jpy9cc:"f3z2g5w",Bqo2lbl:"fz5izi4",B6plc1d:"fv40pdu",I82g5a:"f1uj6jbf"}},{d:[".fly5x3f{width:100%;}",".f1euv43f{position:absolute;}",".f1yab3r1{bottom:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".f6ywr7j{height:4px;}",".f16jpd5f{border-bottom-left-radius:var(--borderRadiusMedium);}",".f1aa9q02{border-bottom-right-radius:var(--borderRadiusMedium);}",".f1l02sjl{height:100%;}",".fx7worf{background-image:linear-gradient(90deg, var(--fai-colorBrandFlair1) 35%, var(--fai-colorBrandFlair2) 70%, var(--fai-colorBrandFlair3) 92%);}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".f1hxqsn5{background-image:linear-gradient(90deg, rgba(0,0,0,0) 0%, var(--fai-colorBrandFlair1) 35%, var(--fai-colorBrandFlair2) 70%, var(--fai-colorBrandFlair3) 92%,  rgba(0,0,0,0));}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f3z2g5w{max-width:100%;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.fz5izi4{animation-iteration-count:infinite;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.fv40pdu{animation-duration:3s;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1uj6jbf{animation-name:ftc26vs;}}",{m:"screen and (prefers-reduced-motion: reduce)"}]],k:["@keyframes ftc26vs{0%{opacity:.2;}50%{opacity:1;}100%{opacity:.2;}}"]}),Fi="fai-AttachmentOverflowMenuButton",Hi=(0,c.__resetStyles)("rn3o5tq",null,{r:[".rn3o5tq{color:var(--colorNeutralForeground1);align-items:center;background-color:var(--colorNeutralBackground1);border:var(--strokeWidthThin) solid var(--colorNeutralStroke1);border-radius:var(--borderRadiusMedium);box-sizing:border-box;column-gap:var(--spacingHorizontalSNudge);cursor:pointer;display:inline-flex;flex-wrap:nowrap;font-family:var(--fontFamilyBase);font-size:var(--fontSizeBase300);font-weight:var(--fontWeightRegular);justify-content:center;padding:var(--spacingVerticalXS) var(--spacingHorizontalS);vertical-align:middle;position:relative;}",".rn3o5tq:hover{cursor:pointer;background-color:var(--colorNeutralBackground3Hover);color:var(--colorNeutralForeground2Hover);}",".rn3o5tq:active{background-color:var(--colorNeutralBackground3Pressed);color:var(--colorNeutralForeground2Pressed);}"],s:["@media (forced-colors: active){.rn3o5tq:hover{background-color:HighlightText;}.rn3o5tq:active{background-color:HighlightText;}}"]}),Ri=o.forwardRef((e,t)=>{const n=((e,t)=>{const{children:n,text:a}=e,{isOverflowing:i,overflowCount:r,overflowButtonRef:o}=(0,c.useContextSelector)(ki,(e=Mi)=>e),s=!!e.isLoading,d=null!=n?n:"function"==typeof a?a(r):a;return{components:{root:"button",progress:Li.ProgressBar},root:c.slot.always((0,c.getIntrinsicElementProps)("button",{ref:(0,c.useMergedRefs)(t,o),...e}),{defaultProps:{children:null!=d?d:`+${r}`},elementType:"button"}),progress:c.slot.always(e.progress,{defaultProps:{value:void 0,shape:"square",thickness:"large","aria-label":"Loading"},elementType:Li.ProgressBar}),isOverflowing:i,overflowCount:r,isLoading:s}})(e,t);return(e=>{const t=Hi(),n=Ui();if(e.root.className=(0,c.mergeClasses)(Fi,t,e.root.className),e.progress){e.progress.className=(0,c.mergeClasses)("fai-AttachmentOverflowMenuButton__progress",n.progress,e.progress.className);const t=c.slot.optional(e.progress.bar,{elementType:"div",renderByDefault:!0});t&&(void 0===e.progress.value?t.className=(0,c.mergeClasses)(n.indeterminateProgressBar,t.className):t.className=(0,c.mergeClasses)(n.regularProgressBar,t.className),e.progress.bar=t)}})(n),(e=>((0,c.assertSlots)(e),e.isOverflowing?(0,c.jsx)(Ti.MenuTrigger,{children:(0,c.jsxs)(e.root,{children:[e.root.children,e.isLoading&&(0,c.jsx)(e.progress,{})]})}):null))(n)});function Ni(e,t){const{elementType:n,renderFunction:a,props:i}=function(e){const{as:t,[c.SLOT_CLASS_NAME_PROP_SYMBOL]:n,[c.SLOT_ELEMENT_TYPE_SYMBOL]:a,[c.SLOT_RENDER_FUNCTION_SYMBOL]:i,...r}=e,o=r,s="string"==typeof a&&null!=t?t:a;return"string"!=typeof s&&t&&(o.as=t),{elementType:s,props:o,renderFunction:i}}(e);return a?(t.length>0&&(i.children=o.createElement(o.Fragment,{},...t)),o.createElement(o.Fragment,{},a(n,i))):o.createElement(n,i,...t)}function Bi(e,t,...n){return(0,c.isSlot)(t)?Ni(function(e,t){return{...t,[c.SLOT_ELEMENT_TYPE_SYMBOL]:e}}(e,t),n):(0,c.isSlot)(e)?Ni(e,n):o.createElement(e,t,...n)}Ri.displayName="AttachmentOverflowMenuButton";var ji=H(216);const Vi=(0,c.createContext)(void 0),zi={onAttachmentDismiss:()=>null,shouldUseOverflow:!1},Gi=Vi.Provider,Ki=e=>{const t=(e=>{const t=(0,Ti.useMenu_unstable)(e),{isOverflowing:n,ref:a,overflowCount:i}=(0,ji.useOverflowMenu)();return{...t,isOverflowing:n,overflowButtonRef:a,overflowCount:i}})(e),n=(0,Ti.useMenuContextValues_unstable)(t),a=function(e){const{isOverflowing:t,overflowButtonRef:n,overflowCount:a}=e;return{attachmentOverflowMenu:{isOverflowing:t,overflowButtonRef:n,overflowCount:a}}}(t);return((e,t)=>{const{menuContextValues:n,attachmentOverflowMenuContextValues:a}=t;return(0,c.assertSlots)(e),e.isOverflowing?(0,c.jsx)(Pi,{value:a.attachmentOverflowMenu,children:(0,Ti.renderMenu_unstable)(e,n)}):null})(t,{menuContextValues:n,attachmentOverflowMenuContextValues:a})};Ki.displayName="AttachmentOverflowMenu";const Wi=Ae("Dismiss20Regular","20",["m4.09 4.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L10 9.29l5.15-5.14a.5.5 0 0 1 .63-.06l.07.06c.18.17.2.44.06.63l-.06.07L10.71 10l5.14 5.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L10 10.71l-5.15 5.14a.5.5 0 0 1-.63.06l-.07-.06a.5.5 0 0 1-.06-.63l.06-.07L9.29 10 4.15 4.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"]),qi=(0,c.__styles)({imageOnly:{Bt984gj:"f122n59"}},{d:[".f122n59{align-items:center;}"]}),Qi=o.forwardRef((e,t)=>{const n=((e,t)=>{const{imageOnly:n,media:a}=e,i=(0,c.useId)("attachment-",e.id),r=(0,ji.useIsOverflowItemVisible)(i),{onAttachmentDismiss:s}=(0,c.useContextSelector)(Vi,(e=zi)=>e),d=c.slot.always({ref:t,icon:a,secondaryContent:o.createElement(Wi,null),...e,id:i},{elementType:Ti.MenuItem});d.onClick=(0,c.mergeCallbacks)(d.onClick,t=>{null==s||s(t,{content:e.children,media:a,id:i})});const l=c.slot.optional(e.progress,{defaultProps:{shape:"square",thickness:"large","aria-labelledby":e.id},elementType:Li.ProgressBar});return{components:{root:Ti.MenuItem,progress:Li.ProgressBar},root:d,progress:l,isVisible:r,imageOnly:n}})(e,t);return(e=>{const{imageOnly:t}=e,n=qi(),a=Ui();if(e.root.className=(0,c.mergeClasses)("fai-AttachmentOverflowMenuItem",t&&n.imageOnly,e.root.className),e.progress){e.progress.className=(0,c.mergeClasses)("fai-AttachmentOverflowMenuItem__progress",a.progress,e.progress.className);const t=c.slot.optional(e.progress.bar,{elementType:"div",renderByDefault:!0});t&&(void 0===e.progress.value?t.className=(0,c.mergeClasses)(a.indeterminateProgressBar,t.className):t.className=(0,c.mergeClasses)(a.regularProgressBar,t.className),e.progress.bar=t)}})(n),(e=>((0,c.assertSlots)(e),e.isVisible?null:(0,c.jsxs)(e.root,{children:[e.root.children,e.progress&&(0,c.jsx)(e.progress,{})]})))(n)});Qi.displayName="AttachmentOverflowMenuItem";const Yi=(0,c.__resetStyles)("r168fwfa",null,[".r168fwfa{column-gap:var(--spacingHorizontalSNudge);display:flex;flex-direction:row;flex-shrink:0;flex-wrap:wrap;row-gap:var(--spacingVerticalXS);}"]),Ji=(0,c.__resetStyles)("rvxcmzt",null,[".rvxcmzt{display:inline-flex;}"]),Xi=o.forwardRef((e,t)=>{const n=((e,t)=>{const{children:n,maxVisibleAttachments:a,onAttachmentDismiss:i,overflowMenuProps:r}=e,s=o.useRef(null),[d]=(0,c.useTimeout)(),{targetDocument:l}=(0,c.useFluent_unstable)(),{findNextFocusable:u,findPrevFocusable:f,findLastFocusable:p}=(0,c.useFocusFinders)(),[m,_]=o.useState([]),h=(0,c.useEventCallback)((e,t)=>{var n;if(!i)return;i(e,t);const a=null==l?void 0:l.activeElement;if(null===(n=s.current)||void 0===n?void 0:n.contains(a)){const e=u(a,{container:s.current});if(e)e.classList.contains(Fi)?d(()=>{var e;null===(e=p(s.current))||void 0===e||e.focus()},0):e.focus();else{const e=f(null==a?void 0:a.parentElement,{container:s.current});null==e||e.focus()}}else d(()=>{var e;null===(e=p(s.current))||void 0===e||e.focus()},0)}),b=(e=>{const{additionalCondition:t=!0,children:n,maxVisibleItems:a,minVisibleItems:i,overflowClassName:r}=e;return o.useMemo(()=>{if(void 0===n)return[];let e=a;void 0!==a&&void 0!==i&&i>=a&&(e=i);const s=o.Children.toArray(n);if(void 0!==e&&e>s.length)return s;if(void 0!==e&&t){const t=[],n=s.length;for(let a=0;a<n;a++){const n=s[a];a>=e&&o.isValidElement(n)&&r?t.push(o.cloneElement(n,{...n.props,className:(0,c.mergeClasses)(n.props.className,r)})):t.push(n)}return t}return s},[t,n,a,i,r])})({children:n,maxVisibleItems:a,overflowClassName:Ai().overflow});o.useEffect(()=>{b&&Array.isArray(b)&&_(b.filter(e=>o.isValidElement(e)).map(e=>e.props))},[b]);const g=(0,c.useArrowNavigationGroup)({circular:!0,axis:"both",memorizeCurrent:!0});return{attachments:m,onAttachmentDismiss:h,shouldUseOverflow:void 0!==a,overflowMenuProps:r,components:{root:"div",overflowMenuButton:"span"},root:c.slot.always((0,c.getIntrinsicElementProps)("div",{"aria-label":"Attachments",ref:(0,c.useMergedRefs)(t,s),role:"toolbar",...g,...e,children:b}),{elementType:"div"}),overflowMenuButton:c.slot.optional(e.overflowMenuButton,{defaultProps:{children:o.createElement(Ri,null)},elementType:"span",renderByDefault:!0})}})(e,t),a=function(e){const{onAttachmentDismiss:t,shouldUseOverflow:n}=e;return{attachmentList:{onAttachmentDismiss:t,shouldUseOverflow:n}}}(n);return(e=>{const t=Yi(),n=Ji();e.root.className=(0,c.mergeClasses)("fai-AttachmentList",t,e.root.className),e.overflowMenuButton&&(e.overflowMenuButton.className=(0,c.mergeClasses)("fai-AttachmentList__overflowMenuButton",n,e.overflowMenuButton.className))})(n),((e,t)=>{(0,c.assertSlots)(e);const{attachments:n,overflowMenuProps:a,root:i,shouldUseOverflow:r}=e;return(0,c.jsx)(Gi,{value:t.attachmentList,children:r?(0,c.jsx)(ji.Overflow,{ref:i.ref,children:(0,c.jsxs)(e.root,{children:[i.children,(0,c.jsxs)(Ki,{positioning:"above",...a,children:[(0,c.jsx)(e.overflowMenuButton,{}),(0,c.jsx)(Ti.MenuPopover,{children:(0,c.jsx)(Ti.MenuList,{children:n.map(e=>Bi(Qi,{...e,key:e.id}))})})]})]})}):(0,c.jsx)(e.root,{})})})(n,a)});Xi.displayName="AttachmentList";const Zi=(0,c.__styles)({root:{},text:{sj55zd:"f16muhyy"},href:{sj55zd:"fyind8e",Bde5pd6:"f1tx3yz7",Bi91k9c:"f1deo86v",i089h6:"f1eh06m1",lj723h:"f1iescvh"},sensitivity:{uwmqm3:["fgiv446","ffczdla"]}},{d:[".f16muhyy{color:var(--colorBrandForeground1);}",".fyind8e{color:var(--colorBrandForegroundLink);}",".fgiv446{padding-left:var(--spacingHorizontalXXS);}",".ffczdla{padding-right:var(--spacingHorizontalXXS);}"],h:[".f1tx3yz7:hover{text-decoration-line:underline;}",".f1deo86v:hover{color:var(--colorBrandForegroundLinkHover);}"],a:[".f1eh06m1:active{text-decoration-line:underline;}",".f1iescvh:active{color:var(--colorBrandForegroundLinkPressed);}"]}),$i=o.forwardRef((e,t)=>{const n=((e,t)=>{const{as:n}=e,a=null!=n?n:"span",i=(0,c.getPartitionedNativeProps)({props:e,primarySlotTagName:a}),r="a"===a?{target:"_blank",rel:"noopener",tabIndex:-1,...i.primary,as:"a",ref:t}:{...i.primary,as:"span",ref:t};return{components:{root:"span",sensitivity:"span",text:a},root:c.slot.always(e.root,{defaultProps:i.root,elementType:"span"}),sensitivity:c.slot.optional(e.sensitivity,{elementType:"span"}),text:c.slot.optional(e.text,{defaultProps:r,renderByDefault:!0,elementType:a})}})(e,t);return(e=>{const t=Zi();e.root.className=(0,c.mergeClasses)("fai-ChatInputEntity",t.root,e.root.className),e.text&&(e.text.className=(0,c.mergeClasses)("fai-ChatInputEntity__text",t.text,"a"===e.text.as&&t.href,e.text.className)),e.sensitivity&&(e.sensitivity.className=(0,c.mergeClasses)("fai-ChatInputEntity__sensitivity",t.sensitivity,e.sensitivity.className))})(n),(e=>((0,c.assertSlots)(e),(0,c.jsxs)(e.root,{children:[(0,c.jsx)(e.text,{}),e.sensitivity&&(0,c.jsx)(e.sensitivity,{})]})))(n)});$i.displayName="ChatInputEntity";class er extends Ja.DecoratorNode{static getType(){return"entity"}static clone(e){return new er(e.__pluginId,e.__text,e.__data,e.__entityProps,e.__key)}static importJSON(e){return tr(e.pluginId,e.text,e.data,e.entityProps)}isIsolated(){return!0}isInline(){return!0}getTextContent(){return this.__text}exportJSON(){return{pluginId:this.__pluginId,text:this.__text,data:this.__data,entityProps:this.__entityProps,type:er.getType(),version:1}}createDOM(){return document.createElement("span")}updateDOM(){return!1}decorate(e,t){var n;return(null===(n=this.__entityProps)||void 0===n?void 0:n.children)?o.createElement($i,this.__entityProps):o.createElement($i,this.__entityProps,this.__text)}getEntityData(){return{text:this.__text,data:this.__data,entityProps:this.__entityProps}}updateEntityData(e){const t=this.getWritable();t.__text=e.text,t.__data=e.data,t.__entityProps=e.entityProps}constructor(e,t,n,a,i){super(i),(0,si._define_property)(this,"__pluginId",void 0),(0,si._define_property)(this,"__text",void 0),(0,si._define_property)(this,"__entityProps",void 0),(0,si._define_property)(this,"__data",void 0),this.__pluginId=e,this.__text=t,this.__data=n,this.__entityProps=a}}function tr(e,t,n,a,i){return new er(e,t,n,a,i)}class nr extends er{static setHandleTextContent(e){this._handleTextContent=e}static getType(){return rr}static clone(e){const t=e;return new nr(t.__pluginId,t.__text,t.__data,t.__entityProps,t.__key)}static importJSON(e){const{pluginId:t,text:n,data:a,entityProps:i}=e;return new nr(t,n,a,i)}exportJSON(){return{...super.exportJSON(),type:nr.getType()}}getTextContent(){return nr._handleTextContent?nr._handleTextContent(super.getTextContent()):super.getTextContent()}constructor(e,t,n,a,i){super(e,t,n,a,i),this.createDOM=super.createDOM,this.decorate=super.decorate}}const ar={textDecoration:"underline",color:"inherit"},ir="attachment",rr="attachment_entity",or=()=>j()?er:nr,sr=()=>(0,Ja.$nodesOfType)(or());function cr(e){requestAnimationFrame(()=>{const t=e.current;t&&(t.focus(),t.update(()=>{const e=(0,Ja.$getRoot)(),t=e.getLastChild(),n=(0,Ja.$createRangeSelection)(),a=(e,t,a)=>{const i=e.getKey();n.anchor.set(i,t,a),n.focus.set(i,t,a)};if(t)if((0,Ja.$isElementNode)(t)){const e=t.getLastDescendant();e?a(e,e.getTextContentSize(),"text"):a(t,t.getChildrenSize(),"element")}else a(t,t.getTextContentSize(),"text");else a(e,0,"element");(0,Ja.$setSelection)(n)}))})}const dr=(e,n,a,i)=>{const r=a||{text:{style:ar}},o=!N()&&n.type===t.File,s=!Q()&&n.type===t.Page;(o||s)&&(r.text={...r.text??{},as:"a",href:n.sharepointIds.webUrl,target:"_blank",rel:"noopener noreferrer"});let c=!1;e.update(()=>{if(!E._SPKillSwitch.isActivated("a21f1d17-86a9-4eea-8b1c-e6b4483d7b64")&&void 0!==sr().find(e=>e.__data?.attachmentId===n.id))return;const e=(0,Ja.$getRoot)();let t=e.getFirstChild();(0,Ja.$isElementNode)(t)||(t=(0,Ja.$createParagraphNode)(),e.append(t));const a=((e,t,n,a)=>j()?tr(ir,e,t,n):new nr(ir,e,t,n,void 0))(n.name,{attachmentId:n.id},r),i=(0,Ja.$createTextNode)(" ");if(!F()){const e=(0,Ja.$getSelection)();if((0,Ja.$isRangeSelection)(e))return void e.insertNodes([a,i]);c=!0}t.append(a,i)},i),c&&requestAnimationFrame(()=>{cr({current:e})})};function lr(e){const{selectedAttachments:t,initialEditorState:n,attachmentNodeProps:a,revertChanges:i,useCurrentPageProps:r,onAttachmentSelect:s,onAttachmentRemove:d,onInputChange:l}=e,u=o.useRef(null),f=ha(),p=o.useRef(!1),m=o.useRef(null);o.useEffect(()=>{if(!u.current)return;const e=()=>{j()||nr.setHandleTextContent(e=>`"${e}"`),n?queueMicrotask(()=>{u.current&&(n.root.children.forEach(e=>{const t=e.children;t.length>0&&("sentinel"===t[t.length-1].type&&t.pop(),j()||(e=>{const t=or()===nr,n=t?"entity":rr,a=t?rr:"entity";e.forEach(e=>{e.type===n&&"pluginId"in e&&e.pluginId===ir&&(e.type=a)})})(t))}),u.current.setEditorState(u.current.parseEditorState(n)),j()||cr(u))}):t.length>0&&t.forEach((e,n)=>{u.current&&dr(u.current,e,a,E._SPKillSwitch.isActivated("2f84ef5c-3263-494e-b3d4-d1cff28406d6")||n!==t.length-1?void 0:{onUpdate:()=>{const e=u?.current?.getEditorState().read(()=>(0,Ja.$getRoot)().getTextContent());e&&u.current&&l&&l(e,u.current.getEditorState().toJSON(),"Initial")}})})};p.current?i?.shouldRevert&&(e(),i?.setShouldRevert?.(!1)):(e(),p.current=!0);const r=u.current.registerMutationListener(or(),e=>{i?.shouldRevert||e.forEach(e=>{if("destroyed"===e&&u.current){const e=(e=>{const t=new Set;return e.getEditorState().read(()=>{sr().forEach(e=>{const n=e.__data?.attachmentId;n&&t.add(n)})}),t})(u.current);t.forEach(t=>{e.has(t.id)||d(t)})}})});return()=>r()},[t,d,n,a,i,l]);const _=o.useCallback(e=>{const n=!t.find(t=>t.id===e.id);!G()&&n&&e.id===r?.currentPage?.id&&r.setActive(!0),n&&u.current&&dr(u.current,e,a),s(e),F()&&cr(u)},[t,r,s,a]),h=o.useCallback(e=>{var t,n;d(e),u.current&&(t=u.current,n=e.id,t.update(()=>{const e=sr().find(e=>e.__data?.attachmentId===n);if(e){const t=e.getNextSibling();t&&" "===t.getTextContent()&&t.remove(),e.remove()}}))},[d]);o.useEffect(()=>{r?.currentPage&&(r.active?_(r.currentPage):h(r.currentPage))},[r?.active,r?.currentPage]);const b=o.useCallback((e,t)=>{l&&u.current&&l(t.value,u.current.getEditorState().toJSON())},[l]);return o.createElement(Ge,{ignoredAttachmentsIds:r?.currentPage?.id?[r.currentPage.id]:[],disableSiteInSiteTab:!0,isCurrentPageSelected:r?.active,currentPage:r?.currentPage},o.createElement(Ei,{...e.promptInputProps,editorRef:u,onChange:b,attachments:o.createElement(Xi,{style:!G()&&t.length>0?{marginTop:"16px"}:{marginTop:"8px"}},t.map(t=>o.createElement(ga,{...e,key:`AttachmentTag-${t.id}`,attachment:t,onAttachmentRemoveHandler:h}))),customNodes:[or()],actions:{style:{marginTop:"8px"},children:o.createElement(o.Fragment,null,o.createElement(Fa,{...e,buttonRef:m,onAttachmentSelect:_},o.createElement(de.Button,{ref:m,appearance:"transparent",disabled:e.disabled,icon:o.createElement(Le,{className:f.icon}),size:"small","aria-disabled":e.disabled,"aria-label":ja.KT,className:(0,c.mergeClasses)(f.buttonSize,e.disabled?f.buttonDisabled:f.button)},G()?M()?0===t.length?ja.Pf:ja.Tn:ja.Pf:ja.Is)),G()&&r&&o.createElement(de.Button,{disabled:e.disabled,style:{backgroundColor:r.active?"var(--colorNeutralStroke1)":void 0},onClick:()=>{r.setActive(!r.active)},className:(0,c.mergeClasses)(f.buttonSize,f.useCurrentPageButton)},ja.RV))}}))}})(),R})())})();