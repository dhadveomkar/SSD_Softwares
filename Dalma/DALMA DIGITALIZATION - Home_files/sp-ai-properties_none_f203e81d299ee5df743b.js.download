define("b2ac7964-d899-494b-98e0-eaca3debee00_0.12.3",["@microsoft/sp-lodash-subset"],e=>(()=>{"use strict";var t={529:t=>{t.exports=e}},n={};function a(e){var i=n[e];if(void 0!==i)return i.exports;var r=n[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{var e,t;function n(e,t){return e=r(e),t=r(t),e&&t?`${e} ${t}`:e||t}function r(e){return e?.trim()||""}a.r(i),a.d(i,{AIArray:()=>y,AIBoolean:()=>Y,AIDate:()=>se,AIEmailAddress:()=>H,AIIdentifier:()=>U,AIImage:()=>ie,AIImageReady:()=>te,AIImageSearchKeyword:()=>A,AIImageType:()=>e,AIInteger:()=>ce,AILink:()=>w,AILinkSource:()=>S,AINumber:()=>Q,AINumberUnion:()=>ue,AINumberUnionOptional:()=>fe,AIPeopleDisplayName:()=>R,AIPropertiesUnion:()=>G,AIReferenceImage:()=>ne,AIRichText:()=>E,AIRichTextForTextWebPart:()=>de,AISPFileMetadata:()=>$,AISPHeroItem:()=>re,AISPIMAGE_LEAF_FIELDS:()=>P,AISPImage:()=>T,AISPImageSource:()=>M,AISPPeople:()=>N,AISPReferenceImage:()=>F,AIStockImage:()=>W,AIStringUnion:()=>X,AIStringUnionOptional:()=>Z,AIText:()=>x,AIUrl:()=>C,AIWebPartTitle:()=>le,BaseAINumber:()=>q,BaseAIObject:()=>_,BaseAIPrimitive:()=>h,BaseAIProperties:()=>u,BaseAIString:()=>I,BaseAIUnion:()=>J,CustomAIObject:()=>b,DEFAULT_DATA_USAGE_OPTIONAL:()=>s,DEFAULT_DATA_USAGE_REQUIRED:()=>o,DEFAULT_SYSTEM_PROMPT:()=>p,DEFAULT_SYSTEM_PROMPT_STRUCTURE:()=>f,GENERATION_ONLY_DATA_USAGE:()=>c,UsageLevel:()=>t,VIBE_AUTHORING_ONLY_DATA_USAGE:()=>d,_AIFreeFormObject:()=>oe,_AIPropertiesLogger:()=>z,_AIReadOnlyWebPart:()=>Ce,_AI_PROPERTIES_SCHEMA_CLASS_ID_DEFINITION_KEY:()=>ge,_defaultDataUsageMatrixGeneration:()=>pe,_defaultDataUsageMatrixVibeAuthoring:()=>me,_getAIPropertiesJSON:()=>ve,_getDefaultAIPropertiesDataProcessor:()=>Ve,_getDefaultAIPropertiesDataProcessorNotImplemented:()=>je,_processAIPropertiesDataOnObject:()=>m,buildMappingFragment:()=>L,buildTargetedMappingFragment:()=>k,defineElemMap:()=>we,defineMapping:()=>Oe,fromJSON:()=>Ae,getWebPartAIProperties:()=>Se,mapData:()=>Fe,oneOf:()=>K,reverseMapData:()=>He,toJSON:()=>Ee,withAISchemaMetadata:()=>he}),function(e){e.StockImage="StockImage",e.Ready="Ready",e.ReferenceImage="ReferenceImage"}(e||(e={})),function(e){e[e.MUST=4e3]="MUST",e[e.SHOULD=3e3]="SHOULD",e[e.MAY=2e3]="MAY",e[e.SHOULD_NOT=1e3]="SHOULD_NOT",e[e.MUST_NOT=0]="MUST_NOT"}(t||(t={}));const o={generationUsage:t.MUST,vibeAuthoringUsage:t.MUST,informationUsage:t.MUST},s={generationUsage:t.MAY,vibeAuthoringUsage:t.MAY,informationUsage:t.MAY},c={generationUsage:t.MUST,vibeAuthoringUsage:t.MUST_NOT,informationUsage:t.MAY},d={generationUsage:t.MUST_NOT,vibeAuthoringUsage:t.SHOULD,informationUsage:t.MAY};function l(e){return"required"===e?o:"optional"===e?s:e?{...o,...e}:o}class u{get fullPrompt(){return n(this.systemPrompt,this.userPrompt)}updatePrompts(e){this._prompts={...this._prompts,...e}}get reinstantiationParams(){return this._params}processDataToResult(e){const{data:t,getDataProcessor:n,path:a}=e,i=n(this.classUniqueId);if(!i)throw new Error(`No data processor found for AI-properties: ${this.className} (${this.classUniqueId}). Make sure it is provided via getDataProcessor.`);return i({data:t,getDataProcessor:n,instance:this,path:a})}get dataUsage(){return this._metadata.dataUsage}get metadata(){return this._metadata}get systemPrompt(){return n(this._prompts.systemPromptForAI,this._prompts.additionalSystemPromptForAI)}get userPrompt(){return this._prompts.userPromptForAI}get prompts(){return this._prompts}get className(){return this.constructor.name}constructor(e={}){this._params=e;const{options:t,customMetadata:n,customPrompts:a}=e,i=this.initDefaultMetadata(),{dataUsage:r}=i,{dataUsage:o}=n||{};this._metadata={...i,...n,dataUsage:{...l(r),...o?l(o):{}}},this._prompts={systemPromptForAI:a?.systemPromptForAI||this.getDefaultSystemPrompt(),additionalSystemPromptForAI:a?.additionalSystemPromptForAI,userPromptForAI:a?.userPromptForAI},this._options=t}}const f={primitives:{text:"",richText:"",richTextForTextWebPart:{additionalSystemPrompt:""},emailAddress:"",peopleDisplayName:"",url:"",decorativeImageKeyword:"",boolean:"",webPartTitle:"",date:"",identifier:{default:"",imageReference:"",instanceId:"",task:""},readOnlyWebPartManifestId:"",readOnlyWebPartDataString:""},objects:{people:"",link:"",linkExternal:"",linkSPFile:"",linkExternalOrSPFile:"",heroItem:"",aiImageStock:"",aiImageReference:"",aiImageReady:"",spFileMetadata:"",readOnlyWebPart:""},arrays:{default:"",defaultRequireGrounding:""}},p=function e(t,n=""){if("string"==typeof t)return`{{${n}}}`;if("object"==typeof t&&null!==t){const a={};for(const[i,r]of Object.entries(t)){const t=n?`${n}.${i}`:i;a[i]=e(r,t)}return a}return t}(f);async function m(e,{data:t,getDataProcessor:n,path:a}){if(e instanceof u)return e.processDataToResult({data:t,getDataProcessor:n,path:a});const i={},r=[];for(const i in e)if(Object.prototype.hasOwnProperty.call(e,i)){const o=e[i],s=t[i];o&&s&&r.push(m(o,{data:s,getDataProcessor:n,path:a?`${a}.${i}`:i}).then(e=>({key:i,result:e})))}const o=await Promise.all(r);for(const{key:e,result:t}of o)i[e]=t;return i}class _ extends u{processDataToResult({data:e,getDataProcessor:t,path:n}){return t(this.classUniqueId)?super.processDataToResult({data:e,getDataProcessor:t,path:n}):m(this._structure,{data:e,getDataProcessor:t,path:n})}get structure(){return this._structure}initDefaultMetadata(){return{}}constructor(e){super(e),this._structure=this.initStructure(),g(this._structure,e?.options?.promptTree)}}class h extends u{initDefaultMetadata(){return{}}}class b extends u{get classUniqueId(){return b.classUniqueId}processDataToResult({data:e,getDataProcessor:t,path:n}){return m(this._structure,{data:e,getDataProcessor:t,path:n})}get structure(){return this._structure}initDefaultMetadata(){return{}}getDefaultSystemPrompt(){}constructor(e){const{structure:t,...n}=e;g(t,e.options?.promptTree),super(n),this._structure=t}}function g(e,t){return v(e,t)}function v(e,t,n=!1){if(e&&t)if(e instanceof h)n||e.updatePrompts(t);else if(e instanceof y)n||e.updatePrompts(t.root),v(e.element,t.elementSystemPrompt);else if(e instanceof _||e instanceof b)n||e.updatePrompts(t.root),t.fields&&g(e.structure,t);else{if(e instanceof u)throw new Error("Unrecognized AI-properties type.");{const n=t.fields;Object.keys(e).forEach(t=>{const a=e[t],i=n?.[t];null!=a&&i&&g(a,i)})}}}b.classUniqueId="222ace3f-b9fe-47f3-89cc-9e02e575faff";class y extends u{async processDataToResult({data:e,getDataProcessor:t,path:n}){return(await Promise.all(e.map((e,a)=>this._element.processDataToResult({data:e,getDataProcessor:t,path:n?`${n}[${a}]`:void 0})))).filter(e=>void 0!==e)}get element(){return this._element}get minItems(){return this.metadata.minItems}get maxItems(){return this.metadata.maxItems}get classUniqueId(){return y.classUniqueId}getDefaultSystemPrompt(){return p.arrays.default}initDefaultMetadata(){return{}}constructor(e){super(e),this._element=e.element,g(this._element,e.elementPromptTree)}}y.classUniqueId="08577206-4098-4c09-b52c-1e2a3248dcff";var S,D=a(529);class I extends h{get primitiveJsonSchemaType(){return"string"}get regex(){return this.metadata.regex}get regexPattern(){const e=this.metadata.regex;if(void 0!==e)return"string"==typeof e?e:e.source}}class x extends I{get classUniqueId(){return x.classUniqueId}getDefaultSystemPrompt(){return p.primitives.text}}x.classUniqueId="6cdb8b03-19ba-4e21-8a2a-351b1e063753";class C extends I{get classUniqueId(){return C.classUniqueId}getDefaultSystemPrompt(){return p.primitives.url}}C.classUniqueId="584068f2-60ff-474c-a213-2685462caf60",function(e){e.External="External",e.SPFile="SPFile"}(S||(S={}));const O=["External","SPFile"];class w extends _{get sources(){return this.metadata.sources||[]}get classUniqueId(){return w.classUniqueId}getDefaultSystemPrompt(){return p.objects.link}initDefaultMetadata(){return{sources:(0,D.clone)(O)}}initStructure(){let e;if(this.sources.includes("SPFile"))e=this.sources.includes("External")?p.objects.linkExternalOrSPFile:p.objects.linkSPFile;else{if(!this.sources.includes("External"))throw new Error("Link sources must be specified for AILink");e=p.objects.linkExternal}return{name:new x,url:new C({customPrompts:{systemPromptForAI:e}})}}}w.classUniqueId="e16f330d-3736-4627-8c6c-929ecb3502ee";class E extends I{get classUniqueId(){return E.classUniqueId}getDefaultSystemPrompt(){return p.primitives.richText}}E.classUniqueId="487e8886-1a36-4e4e-a55d-afe0fc8a44a4";class A extends E{get classUniqueId(){return A.classUniqueId}getDefaultSystemPrompt(){return p.primitives.decorativeImageKeyword}}function L(e){const{sourceRootKey:t,leafFields:n,options:a}=e,i={},r=a?.baseTargetPath,o=a?.mapping??{};return n.forEach(e=>{if(!Object.prototype.hasOwnProperty.call(o,e))return;const n=`${t}.${e}`,a=o[e];i[n]=void 0===a?void 0!==r?`${r}.${e}`:n:a}),i}function k(e){const{sourceRootKey:t,leafFields:n,options:a}=e,i={},r=a?.baseTargetPath,o=a?.mapping??{};return n.forEach(e=>{if(!Object.prototype.hasOwnProperty.call(o,e))return;const n=`${t}.${e}`,a=o[e];if(void 0!==a)return void(i[n]=a);const s=void 0!==r?`${r}.${e}`:n;i[n]=s}),i}var M;A.classUniqueId="b48bd7dd-9a4a-47dd-aa33-47f521800d83",function(e){e.Getty="Getty",e.Hubble="Hubble",e.StockImages="StockImagesSearch",e.TAS="TAS",e.TasFirstPartyImageSearch="TasFirstPartyImageSearch",e.Grounded="Grounded",e.CuratedFallback="CuratedFallback",e.MultiModel="MultiModel",e.Unknown="Unknown"}(M||(M={}));const P=["url","width","height","isDecorative","fileName","contentProvider","altText","cropWidth","cropHeight","isAspectRatioLockedOnLoad","aspectRatioOnLoad","fixAspectRatio","insertionISOTimestamp","stockMediaId","siteId","webId","listId","uniqueId"];class T extends _{static mappingHelper(e,t){return k({sourceRootKey:e,leafFields:P,options:t})}get imageUsage(){return this._imageUsage}get classUniqueId(){return T.classUniqueId}getDefaultSystemPrompt(){}initStructure(){return{description:new A}}constructor(e){super(e),this._imageUsage=e?.imageUsage??"Presentational"}}T.classUniqueId="14880897-e127-4e91-82ea-2ee6228a503f";class U extends I{get classUniqueId(){return U.classUniqueId}getDefaultSystemPrompt(){return p.primitives.identifier.default}}U.classUniqueId="c7cca2ac-46ea-47fb-8c4a-cc01eada4cc6";class F extends _{static mappingHelper(e,t){return k({sourceRootKey:e,leafFields:P,options:t})}get imageUsage(){return this._imageUsage}get classUniqueId(){return F.classUniqueId}getDefaultSystemPrompt(){}initStructure(){return{identifier:new U({customPrompts:{systemPromptForAI:p.primitives.identifier.imageReference}})}}constructor(e){super(e),this._imageUsage=e?.imageUsage??"Grounded"}}F.classUniqueId="a3d8a1f4-7f67-4c2f-9e4b-9c2a1d8e6f5b";class H extends I{get classUniqueId(){return H.classUniqueId}getDefaultSystemPrompt(){return p.primitives.emailAddress}}H.classUniqueId="e28cd59e-492b-4dd2-8930-974a2f8b9b53";class R extends I{get classUniqueId(){return R.classUniqueId}getDefaultSystemPrompt(){return p.primitives.peopleDisplayName}}R.classUniqueId="682c449f-49a5-4a8d-bf53-78d9ace0d0c3";class N extends _{get classUniqueId(){return N.classUniqueId}getDefaultSystemPrompt(){return p.objects.people}initStructure(){return{name:new R,email:new H}}}N.classUniqueId="6793a7ea-5563-40e2-873e-bc30c3cb8fcc";const B={info:()=>{},warning:()=>{},error:()=>{}};function j(){const e="undefined"!=typeof globalThis?globalThis:void 0,t=e&&e.console?e.console:void 0;if(t&&"function"==typeof t.log&&"function"==typeof t.warn&&"function"==typeof t.error){const e=t;return{info:(...t)=>e.log(...t),warning:(...t)=>e.warn(...t),error:(...t)=>e.error(...t)}}return B}let V=j();const z={info:(e,...t)=>V.info(e,...t),warning:(e,...t)=>V.warning(e,...t),error:(e,...t)=>V.error(e,...t),set:e=>{V=e??B},get:()=>V,reset:()=>{V=j()}};class G extends u{get classUniqueId(){return G.classUniqueId}get variants(){return this._variants}get defaultVariantKey(){return this._defaultVariantKey}getReverseDefaults(){return this._defaultVariantKey?{variantKey:this._defaultVariantKey}:{}}get reinstantiationParams(){let e=super.reinstantiationParams;return e={...e,...e.options&&{options:{...e.options,variants:void 0,defaultVariantKey:this._defaultVariantKey}}},e}async processDataToResult({data:e,getDataProcessor:t,path:n}){const a=t(this.classUniqueId);if(a)return a({data:e,getDataProcessor:t,instance:this,path:n});const i=e??{},r="string"==typeof i.variantKey?i.variantKey:void 0,o=r??this._defaultVariantKey,s=o?this._variantMap.get(o):void 0;if(!s){const e=new Error(`Unknown union variant: ${r||"undefined"} (allowed: ${this._variants.map(e=>e.key).join(", ")})`);throw z.error(e),e}try{const e=s.aiProperties,a=this._variantPayloadMode.get(s.key)??"object",r=this._extractVariantData(i,a),o=await e.processDataToResult({data:r,getDataProcessor:t,path:n});return this._composeVariantResult(s.key,o,a)}catch(e){throw z.error(e),new Error(`Variant processing failed (${s?s.key:r||"unknown"}): ${e.message}`)}}getDefaultSystemPrompt(){}initDefaultMetadata(){return{}}_determinePayloadMode(e){return e instanceof h||e instanceof y?"value":"object"}_extractVariantData(e,t){if("value"===t){if(!Object.prototype.hasOwnProperty.call(e,"value")){const t=e.variantKey;throw new Error(`AIPropertiesUnion: flattened payload for variant '${"string"==typeof t?t:"unknown"}' is missing required 'value' field.`)}return e.value}const n={};return Object.keys(e).forEach(t=>{"variantKey"!==t&&(n[t]=e[t])}),n}_composeVariantResult(e,t,n){return"value"===n?{variantKey:e,value:t}:"object"!=typeof(a=t)||null===a||Array.isArray(a)?void 0===t?{variantKey:e}:{variantKey:e,value:t}:{variantKey:e,...t};var a}constructor(e){super(e);const t=e.options?.variants;if(!t||0===t.length){const e=new Error("AIPropertiesUnion: options.variants must be a non-empty array.");throw z.error(e),e}const n=new Set;for(const e of t){if(n.has(e.key)){const t=new Error(`AIPropertiesUnion: duplicate variant key '${e.key}'.`);throw z.error(t),t}n.add(e.key)}this._variants=t,this._variantMap=new Map(t.map(e=>[e.key,e])),this._variantPayloadMode=new Map(t.map(e=>[e.key,this._determinePayloadMode(e.aiProperties)]));const a=e.options?.defaultVariantKey;if(void 0!==a&&!this._variantMap.has(a)){const e=new Error(`AIPropertiesUnion: defaultVariantKey '${a}' is not defined in variants.`);throw z.error(e),e}this._defaultVariantKey=a}}function K(e){return new G({options:e})}G.classUniqueId="42c3f1c5-f1ca-4114-b55d-4f4bb03e28f4";class W extends _{get classUniqueId(){return W.classUniqueId}initStructure(){return{description:new A}}initDefaultMetadata(){return{dataUsage:c}}getDefaultSystemPrompt(){return p.objects.aiImageStock}constructor(e){super(e)}}W.classUniqueId="a22a1118-55cf-4be0-af33-8038bb25ac48";class q extends h{}class Q extends q{get primitiveJsonSchemaType(){return"number"}get classUniqueId(){return Q.classUniqueId}getDefaultSystemPrompt(){}}Q.classUniqueId="5fe109ff-d499-4ee2-9fbf-9a834011d8e7";class Y extends h{get primitiveJsonSchemaType(){return"boolean"}get classUniqueId(){return Y.classUniqueId}getDefaultSystemPrompt(){return p.primitives.boolean}}Y.classUniqueId="a64f2948-bb3c-4245-a519-244e3fa13c5c";class J extends u{get unionOptions(){return this._union}async processDataToResult({data:e}){const t=this._union.find(t=>t.value===e)?.value;return void 0!==t?t:this._defaultValue}getDefaultSystemPrompt(){}initDefaultMetadata(){return{}}constructor(e){super(e),this._union=e.union.every(e=>"object"==typeof e&&null!==e&&"value"in e)?e.union:e.union.map(e=>({value:e})),this._defaultValue=e.defaultValue}}class X extends J{get primitiveJsonSchemaType(){return"string"}get classUniqueId(){return X.classUniqueId}}X.classUniqueId="173c765d-60ae-411b-a551-10c367f9a5e4";class Z extends J{get primitiveJsonSchemaType(){return"string"}get classUniqueId(){return Z.classUniqueId}}Z.classUniqueId="08d3779d-646c-4885-a4d1-41fd8e9f2957";class $ extends _{get classUniqueId(){return $.classUniqueId}initStructure(){return{siteId:this._createIdentifier(),webId:this._createIdentifier(),listId:this._createIdentifier(),uniqueId:this._createIdentifier()}}getDefaultSystemPrompt(){return p.objects.spFileMetadata}_createIdentifier(){return new U({customMetadata:{dataUsage:"optional"}})}constructor(e){super(e)}}$.classUniqueId="757fea3c-3e2d-401d-a53b-d64adb4868ab";const ee=[M.StockImages,M.Grounded,M.CuratedFallback,M.MultiModel,M.Unknown];class te extends _{get classUniqueId(){return te.classUniqueId}initStructure(){return{urlOrBlob:new x,fileMetadata:new $({customMetadata:{dataUsage:d}}),fileName:new x({customMetadata:{dataUsage:d}}),width:new Q({customMetadata:{dataUsage:"required"}}),height:new Q({customMetadata:{dataUsage:"required"}}),contentProvider:new Z({union:ee,defaultValue:void 0,customMetadata:{dataUsage:d}}),isDecorative:new Y({customMetadata:{dataUsage:d}}),altText:new x({customMetadata:{dataUsage:d}}),insertionISOTimestamp:new x({customMetadata:{dataUsage:d}}),stockMediaId:new x({customMetadata:{dataUsage:d}})}}initDefaultMetadata(){return{dataUsage:d}}getDefaultSystemPrompt(){return p.objects.aiImageReady}constructor(e){super(e)}}te.classUniqueId="94dcbfde-b0ca-4618-aa5a-1b09b4aa330b";class ne extends _{get classUniqueId(){return ne.classUniqueId}initStructure(){return{identifier:new U({customPrompts:{systemPromptForAI:p.primitives.identifier.imageReference}})}}initDefaultMetadata(){return{dataUsage:c}}getDefaultSystemPrompt(){return p.objects.aiImageReference}constructor(e){super(e)}}ne.classUniqueId="7b13848a-530c-452c-b5ce-2e6005c7b147";const ae=["urlOrBlob","width","height","fileName","contentProvider","altText","isDecorative","insertionISOTimestamp","stockMediaId","fileMetadata.siteId","fileMetadata.webId","fileMetadata.listId","fileMetadata.uniqueId"];class ie extends G{static readyMappingHelper(e,t){return{...k({sourceRootKey:e,leafFields:ae,options:t}),[`${e}.variantKey`]:void 0,[e]:t?.rootTarget}}get reinstantiationParams(){return{...super.reinstantiationParams,variantConfiguration:this._variantConfiguration,enableAIReferenceImage:this._enableAIReferenceImage,imageUsage:this._imageUsage}}get classUniqueId(){return ie.classUniqueId}get imageUsage(){return this._imageUsage}async processDataToResult({data:e,getDataProcessor:t,path:n}){return super.processDataToResult({data:e,getDataProcessor:t,path:n})}initDefaultMetadata(){return{dataUsage:"optional"}}getDefaultSystemPrompt(){}constructor(t){const n=t?.variantConfiguration,a=t?.options,i=t?.enableAIReferenceImage??!1,r=function(t,n){const{readyVariantOverrides:a}=t??{},{stock:i,ready:r,reference:o}=function(e){const t=e?{...e,customMetadata:{...e.customMetadata}}:void 0;return{stock:new W,reference:new ne,ready:new te(t)}}(a),s=[{key:e.StockImage,aiProperties:i}];return n&&s.push({key:e.ReferenceImage,aiProperties:o}),s.push({key:e.Ready,aiProperties:r}),s}(n,i),o={...a,variants:r,defaultVariantKey:a?.defaultVariantKey??e.Ready};super({customMetadata:t?.customMetadata,customPrompts:t?.customPrompts,options:o}),this._enableAIReferenceImage=i,this._variantConfiguration=n,this._imageUsage=t?.imageUsage??"Presentational"}}ie.classUniqueId="d8694901-674f-4f9c-9cea-9eb0ec9ac1e2";class re extends _{get classUniqueId(){return re.classUniqueId}getDefaultSystemPrompt(){return p.objects.heroItem}initStructure(){return{item:new w,description:new x({customPrompts:{systemPromptForAI:"descritpion of the link item"}}),callToActionText:new x({customMetadata:{dataUsage:"optional"}}),image:new ie({variantConfiguration:{readyVariantOverrides:{customPrompts:{systemPromptForAI:"Preview image of the link item"}}}})}}}re.classUniqueId="67b2291e-60f8-4f8b-8d2c-0bd878bf5b44";class oe extends _{initStructure(){return{}}get classUniqueId(){return oe.classUniqueId}get schemaDescriptor(){return this._schemaDescriptor}getDefaultSystemPrompt(){}constructor(e){super(e),this._schemaDescriptor=e?.options?.schema}}oe.classUniqueId="4edd54ae-aee8-4959-98cb-00ab84b18429";class se extends I{get classUniqueId(){return se.classUniqueId}getDefaultSystemPrompt(){return p.primitives.date}constructor(e){super({customMetadata:{format:se.defaultFormat,...e.customMetadata},...e})}}se.classUniqueId="2047532a-db08-45fe-9a19-32b10c122419",se.defaultFormat="JS Date.toString()";class ce extends q{get primitiveJsonSchemaType(){return"integer"}get classUniqueId(){return ce.classUniqueId}getDefaultSystemPrompt(){}}ce.classUniqueId="4baa1b8f-aa12-441c-9c8a-df271a207edf";class de extends E{get classUniqueId(){return de.classUniqueId}constructor(){super({customPrompts:{additionalSystemPromptForAI:p.primitives.richTextForTextWebPart.additionalSystemPrompt}})}}de.classUniqueId="fa70d29c-9b82-41b3-b506-6bf6e780fe55";class le extends x{get classUniqueId(){return le.classUniqueId}getDefaultSystemPrompt(){return p.primitives.webPartTitle}initDefaultMetadata(){return{dataUsage:{generationUsage:t.MAY,vibeAuthoringUsage:t.MAY,informationUsage:t.MUST}}}}le.classUniqueId="fdc67c21-5946-4716-9cd0-36b2ac24ec92";class ue extends J{get primitiveJsonSchemaType(){return"number"}get classUniqueId(){return ue.classUniqueId}}ue.classUniqueId="1127ad65-cf63-4b34-86da-5cfc6eab4352";class fe extends J{get primitiveJsonSchemaType(){return"number"}get classUniqueId(){return fe.classUniqueId}}fe.classUniqueId="b016e7ce-317e-4338-8e1b-459dd30fcca5";const pe=e=>{const{generationUsage:n}=e;return n>=t.MUST?"required":n>=t.MAY?"optional":"omit"},me=e=>{const{vibeAuthoringUsage:n}=e;return n>=t.MUST?"required":n>t.MUST_NOT?"optional":"omit"},_e=Symbol("AI_SCHEMA_METADATA");function he(e,t){const n=function(e){const{schemaExtensions:t}=e;return t?Object.freeze({...e,schemaExtensions:be(t)}):Object.freeze({...e})}(t);return Object.defineProperty(e,_e,{value:n,enumerable:!1,configurable:!1,writable:!1}),e}function be(e,t=new WeakSet){if("object"!=typeof e||null===e||t.has(e))return e;t.add(e);const n=Object.keys(e);for(const a of n){const n=e[a];"object"==typeof n&&null!==n&&be(n,t)}return Object.freeze(e)}const ge="__aiPropertiesClassId";function ve(e,{includingReinstantiationParams:t,systemPrompts:n,dataUsageMatrix:a,useSchemaId:i=!1,useExperimentalFreeFormSchema:r=!1,...o}){function s(e){return n?function(e,t){return e?e.replace(/{{\s*([^}]+?)\s*}}/g,(e,n)=>{const a=(0,D.get)(t,n);return"string"==typeof a?a:e}):e}(e,n):e}return function e(n,{description:o,id:c}){if(!n||"object"!=typeof n)return;let d=i?c:void 0;if(n instanceof u){if("omit"===a?.(n.dataUsage))return;i&&n.classUniqueId&&n.classUniqueId!==ye&&(d=n.classUniqueId)}if(n instanceof h){const e=n instanceof I?n.regexPattern:void 0;return{...d?{$id:d}:{},type:n.primitiveJsonSchemaType,description:s(n.fullPrompt),...e?{pattern:e}:{},...t?{definitions:{params:{type:"string",description:JSON.stringify(n.reinstantiationParams)}}}:{}}}if(n instanceof oe){const e=n.schemaDescriptor,a=s(n.fullPrompt);let i;e&&r?(function(e){if("jsonSchema7"!==e.type)throw new Error(`Unsupported free-form schema type: ${e.type}`);const t=e.schema;if(!t||"object"!=typeof t||Array.isArray(t))throw new Error("AIFreeFormObject JSON schema must be a plain JSON object.");if(void 0!==t.type&&"object"!==t.type)throw new Error("AIFreeFormObject JSON schema must describe an object when providing a schema.")}(e),i={...e.schema},d&&!i.$id&&(i.$id=d),a&&!i.description&&(i.description=a)):i={...d?{$id:d}:{},type:"object",...a?{description:a}:{},additionalProperties:!0};const o=function(e,t){const n={},a=t?function(e){if(!e)return;const{options:t,...n}=e,a=t?Object.fromEntries(Object.entries(t).filter(([e])=>"schema"!==e)):void 0,i={...n};return a&&Object.keys(a).length>0&&(i.options=a),Object.keys(i).length>0?i:void 0}(e.reinstantiationParams):void 0;return a&&(n.params={type:"string",description:JSON.stringify(a)}),e.classUniqueId&&(n[ge]={type:"string",const:e.classUniqueId,description:"Reserved metadata for AI-properties reinstantiation."}),n}(n,t);return Object.keys(o).length>0&&(i.definitions=(f=i.definitions,(p=o)&&0!==Object.keys(p).length?{...f?{...f}:{},...p}:f)),i}var f,p;if(n instanceof _||n instanceof b){const a=e(n.structure,{id:d,description:s(n.fullPrompt)});if(!a)return;if(t){const e=n.reinstantiationParams;e&&(a.definitions={...a.definitions||{},params:{type:"string",description:JSON.stringify(e)}})}return a}if(n instanceof y){const a=e(n.element,{description:s(n.fullPrompt)});if(a){let e;if(t)if(e={...n.reinstantiationParams},n instanceof y&&n.reinstantiationParams){const{element:t,...a}=n.reinstantiationParams;e=a}else e=n.reinstantiationParams;return{...d?{$id:d}:{},type:"array",description:s(n.fullPrompt),items:a,...void 0!==n.minItems?{minItems:n.minItems}:{},...void 0!==n.maxItems?{maxItems:n.maxItems}:{},...t&&e?{definitions:{params:{type:"string",description:JSON.stringify(e)}}}:{}}}return}if(n instanceof G){const a=[],i=n.defaultVariantKey;for(const r of n.variants){const n=e(r.aiProperties,{description:void 0});if(!n)continue;t&&r.aiProperties.reinstantiationParams&&(n.definitions={...n.definitions||{},params:{type:"string",description:JSON.stringify(r.aiProperties.reinstantiationParams)}});const o={const:r.key,...r.description?{description:r.description}:{}},s="object"===n.type||void 0!==n.properties||void 0!==n.allOf,c=void 0===i||r.key!==i;if(s){const{properties:e,required:t,...i}=n,r={variantKey:o,...e??{}},s=Array.isArray(t)?[...t]:[];if(c)s.includes("variantKey")||s.push("variantKey");else{const e=s.indexOf("variantKey");-1!==e&&s.splice(e,1)}const d={...i,type:"object",properties:r,...s.length>0?{required:s}:{}};a.push(d)}else{const e={type:"object",properties:{variantKey:o,value:n},required:c?["variantKey","value"]:["value"]};a.push(e)}}if(0===a.length)return;return{...d?{$id:d}:{},type:"object",description:s(n.fullPrompt),oneOf:a,...t&&n.reinstantiationParams?{definitions:{params:{type:"string",description:JSON.stringify(n.reinstantiationParams)}}}:{}}}if(n instanceof J){const e=n.unionOptions.map(e=>{if("omit"!==(a?a(l(e.dataUsage)):void 0))return{const:e.value,...e.description?{description:e.description}:{}}}).filter(e=>void 0!==e);if(0===e.length)return;return{...d?{$id:d}:{},description:s(n.fullPrompt),oneOf:e,...t?{definitions:{params:{type:"string",description:JSON.stringify(n.reinstantiationParams)}}}:{}}}if(n instanceof u)throw new Error("Unrecognized AI-properties type.");const m={},g=[];if(Object.keys(n).forEach(t=>{const i=n[t];if(null!=i){const n=e(i,{description:void 0});n&&(m[t]=n,i instanceof u&&"required"===a?.(i.dataUsage)&&g.push(t))}}),0===Object.keys(m).length)return;const v={...d?{$id:d}:{},type:"object",...o?{description:o}:{},properties:m,...g.length?{required:g}:{}};return S=v,D=function(e){if(e&&"object"==typeof e)return e[_e]}(n)?.schemaExtensions,D&&function(e,t){if(!t)return;if(Array.isArray(t))return void(e.dependencies=t);const n=e.dependencies;n?Array.isArray(n)?e.dependencies={...t}:e.dependencies={...n,...t}:e.dependencies={...t}}(S,D.dependencies),v;var S,D}(e,o)}const ye="4458dd61-d74b-41c5-983e-cd474ea95806";function Se({structure:e,systemPromptForAI:t,webPartId:n,dataVersionString:a,aliasForAI:i}){var r;const o=(new(r=class t extends _{get webPartId(){return n}toJSON(){const e=ve(this,{description:void 0,includingReinstantiationParams:!0,systemPrompts:void 0,useSchemaId:!0,useExperimentalFreeFormSchema:!0});if(!e)throw new Error("Failed to JSONify AIWebPart");return e}get classUniqueId(){return t.classUniqueId}initStructure(){return e}getDefaultSystemPrompt(){}},r.classUniqueId=ye,r)).toJSON();return{webPartId:n,schema:o,description:t,dataVersionString:a,...void 0!==i?{aliasForAI:i}:{}}}const De=p.objects.readOnlyWebPart,Ie=p.primitives.readOnlyWebPartManifestId,xe=p.primitives.readOnlyWebPartDataString;class Ce extends _{get classUniqueId(){return Ce.classUniqueId}getDefaultSystemPrompt(){return De}initDefaultMetadata(){return{dataUsage:d}}initStructure(){return{manifestId:new U({customPrompts:{systemPromptForAI:Ie}}),data_DO_NOT_CHANGE:new x({customPrompts:{systemPromptForAI:xe}})}}}function Oe(e){return e}function we(e){return e}function Ee(e){return JSON.stringify(e,void 0,2)}function Ae(e){return JSON.parse(e)}function Le(e,t){return t.split(".").reduce((e,t)=>{if(null!=e)return e[t]},e)}function ke(e,t,n){const a=t.split("."),i=a.pop();let r=e;for(const e of a){const t=r[e];if("object"==typeof t&&null!==t)r=t;else{const t={};r[e]=t,r=t}}return r[i]=n,e}function Me(e){if(Array.isArray(e))return e.map(e=>Me(e)).filter(e=>void 0!==e);if(null!==e&&"object"==typeof e){const t=e,n={};for(const e of Object.keys(t)){const a=Me(t[e]);void 0!==a&&(n[e]=a)}return n}return void 0===e?void 0:e}function Pe(e,t){const n={};if(("object"!=typeof e||null===e)&&"$"in t){const a=t.$;return"string"==typeof a&&ke(n,a,e),n}return Object.keys(t).forEach(a=>{const i=t[a],r=Le(e,a);if("string"!=typeof i){if(void 0!==i){const{path:e,element:t}=i,a=e,o=(Array.isArray(r)?r:[]).map(e=>Pe(e,t));ke(n,a,o)}}else ke(n,i,r)}),n}function Te(e,t){const n={};if("$"in t){const n=t.$;if("string"==typeof n)return Le(e,n)}return Object.keys(t).forEach(a=>{const i=t[a];if("string"!=typeof i){if(void 0!==i){const{path:t,element:r}=i,o=Le(e,t),s=(Array.isArray(o)?o:[]).map(e=>Te(e,r));ke(n,a,s)}}else{const t=Le(e,i);ke(n,a,t)}}),n}Ce.classUniqueId="731208ea-e445-43ba-8c2e-c4c2d7643998";const Ue="*";function Fe(e,t,n){const a=Re(e,t,n),i="object"==typeof a&&null!==a?a:{},r={};return Object.entries(t).forEach(([e,t])=>{if(null==t)return;const n=Le(i,e);if("string"!=typeof t)if(void 0===t.valueMap){if(void 0!==t.element){const e=t,a=e.path,i=Array.isArray(n)?n:[];let o=Le(r,a)??[];void 0===e.key&&0===o.length&&(o=[]);const s=new Map;let c;return c=void 0===e.key?{}:e.key,void 0!==c.target&&o.forEach((e,t)=>{const n=Le(e,c.target);"string"==typeof n&&s.set(n,t)}),i.forEach((t,n)=>{const a=Pe(t,e.element);if(void 0===c.source&&void 0===c.target)return void(n<o.length&&"object"==typeof o[n]&&null!==o[n]&&"object"==typeof a&&null!==a?o[n]={...o[n],...a}:o.push(a));const i=void 0!==c.source?Le(t,c.source):Le(a,c.target),r="string"==typeof i?i:void 0;if(void 0!==r&&s.has(r)){const e=s.get(r),t={...o[e],...a};o[e]=t}else o.push(a)}),void ke(r,a,o)}}else{const e=t,a=String(n),i=Object.prototype.hasOwnProperty.call(e.valueMap,a)?e.valueMap[a]:e.fallback;void 0!==i&&ke(r,e.path,i)}else ke(r,t,n)}),Me(r)}function He(e,t,n){const a={};return Object.entries(t).forEach(([t,n])=>{if("string"!=typeof n){if(void 0!==n)if(void 0===n.valueMap)if(void 0===n.element);else{const i=n,r=i.path,o=Le(e,r),s=(Array.isArray(o)?o:[]).map(e=>Te(e,i.element));ke(a,t,s)}else{const i=n,r=Le(e,i.path);if(void 0!==r){const e=Object.keys(i.valueMap).find(e=>i.valueMap[e]===r);void 0!==e&&ke(a,t,e)}}}else{const i=Le(e,n);ke(a,t,i)}}),Me(Re(a,t,n))}function Re(e,t,n){if(null===e||"object"!=typeof e)return e;const a=(0,D.cloneDeep)(e),i=Ne(n),r=i.get(Ue)??[];return i.has(Ue)&&i.delete(Ue),Object.entries(t).forEach(([t,n])=>{if(!t||null==n)return;const o=[...r,...i.get(t)??[]];0!==o.length&&(o.every(t=>t(e,a))||function(e,t){if(!t)return e;const n=t.split("."),a=n.pop();let i=e;for(const t of n){if(null==i)return e;if(Array.isArray(i)){const n=Number(t);if(Number.isNaN(n)||n<0||n>=i.length)return e;i=i[n]}else{if("object"!=typeof i)return e;{const n=i;if(!Object.prototype.hasOwnProperty.call(n,t))return e;i=n[t]}}}if(null==i)return e;if(Array.isArray(i)){const t=Number(a);return!Number.isNaN(t)&&t>=0&&t<i.length&&(i[t]=void 0),e}if("object"==typeof i){const e=i;Object.prototype.hasOwnProperty.call(e,a)&&delete e[a]}}(a,t))}),Me(a)}function Ne(e){const t=new Map;if(!e)return t;if(Array.isArray(e)){if(e.length>0){const n=e.filter(e=>"string"==typeof e);n.length>0&&t.set(Ue,[(e,t)=>n.every(e=>void 0!==Le(t,e))])}return t}return Object.entries(e).forEach(([e,n])=>{const a=function(e){if(Array.isArray(e)){const t=e.filter(e=>"string"==typeof e);return 0===t.length?[]:[(e,n)=>t.every(e=>void 0!==Le(n,e))]}return"boolean"==typeof e?e?[]:[()=>!1]:e?[(t,n)=>Be(e,n,n)]:[]}(n);a.length>0&&t.set(e,a)}),t}function Be(e,t,n){if(void 0===e)return!0;if("boolean"==typeof e)return e;if(void 0!==e.const&&t!==e.const)return!1;if(e.enum&&!e.enum.includes(t))return!1;if(e.type&&(a=t,i=e.type,!(Array.isArray(i)?i:[i]).some(e=>{switch(e){case"string":return"string"==typeof a;case"number":return"number"==typeof a&&Number.isFinite(a);case"integer":return"number"==typeof a&&Number.isInteger(a);case"boolean":return"boolean"==typeof a;case"object":return"object"==typeof a&&null!==a&&!Array.isArray(a);case"array":return Array.isArray(a);case"null":return null===a;default:return!0}})))return!1;var a,i;if(e.pattern){if("string"!=typeof t)return!1;if(!new RegExp(e.pattern).test(t))return!1}if(e.required||e.properties){if("object"!=typeof t||null===t)return!1;const a=t;if(e.required)for(const t of e.required)if(void 0===Le(a,t))return!1;if(e.properties)for(const[t,i]of Object.entries(e.properties)){const e=Le(a,t);if(void 0!==e&&!Be(i,e,n))return!1}}if(e.allOf&&!e.allOf.every(e=>Be(e,t,n)))return!1;if(e.anyOf&&!e.anyOf.some(e=>Be(e,t,n)))return!1;if(e.oneOf){let a=0;for(const i of e.oneOf)if(Be(i,t,n)&&(a+=1,a>1))break;if(1!==a)return!1}if(e.not&&Be(e.not,t,n))return!1;if("dependencies"in e&&e.dependencies){const a=Ne(e.dependencies),i=a.get(Ue)??[];a.has(Ue)&&a.delete(Ue);const r="object"==typeof t&&null!==t?t:n;for(const e of i)if(!e(n,r))return!1;for(const[e,t]of a.entries())if(void 0!==Le(r,e)&&!t.every(e=>e(n,r)))return!1}return!0}function je(){return()=>function(){throw new Error("Not implemented. Default processors are not supposed to be invoked directly")}()}function Ve(){return(...e)=>Promise.resolve(e[0].data)}})(),i})());