/*! For license information please see sp-authoring-copilot_en-us_e2a6a83edb739cf00279.js.LICENSE.txt */
(()=>{var e=document.currentScript;define("8fe6b755-c819-4f0a-bde4-34c292b918de_0.1.0",["@msinternal/sp-component-utilities","@msinternal/sp-canvas-read","@microsoft/sp-core-library","@msinternal/sp-safehtml","@msinternal/sp-pages-templates","@msinternal/odsp-core-bundle","react","@microsoft/sp-webpart-base","@msinternal/sp-fluentui-v9-utilities-bundle","@microsoft/sp-diagnostics","@microsoft/load-themed-styles","@msinternal/sp-coachmark-utility","@msinternal/sp-fluentui-v9-react-tabs-bundle","@msinternal/sp-fluentui-v9-react-card-bundle","@msinternal/sp-fluentui-v9-react-image-bundle","@ms/office-ui-fabric-react-bundle","@msinternal/sp-fluentui-v9-react-text-bundle","@msinternal/sp-fluentui-v9-react-input-bundle","@msinternal/sp-attachment-box","@microsoft/sp-http-base","@msinternal/sp-fluentui-v9-react-message-bar-bundle","@msinternal/sp-fluentui-v9-react-button-bundle","@microsoft/sp-http","@microsoft/microsoft-graph-client","@microsoft/sp-page-context","@msinternal/sp-fluentui-v9-react-menu-bundle","@msinternal/sp-fluentui-v9-react-tooltip-bundle","@msinternal/sp-fluentui-v9-react-spinner-bundle","@msinternal/sp-fluentui-v9-react-search-bundle","@msinternal/sp-fluentui-v9-react-divider-bundle","@msinternal/odsp-utilities-bundle","@msinternal/sp-fluentui-v9-react-combobox-bundle","@msinternal/sp-fluentui-v9-react-popover-bundle","@msinternal/sp-fluentui-v9-react-tags-bundle","@msinternal/sp-fluentui-v9-react-checkbox-bundle","@msinternal/sp-fluentui-v9-react-link-bundle","@microsoft/sp-lodash-subset","@msinternal/sp-fluentui-v9-react-progress-bundle","@msinternal/sp-fluentui-v9-react-badge-bundle","@msinternal/sp-grid-layout","@msinternal/sp-authoring-copilot-client","@msinternal/sp-fluentui-v9-react-label-bundle","tslib","@msinternal/sp-fluentui-v9-react-switch-bundle","@msinternal/uifabric-styling-bundle","@msinternal/sp-fluentui-migration-utilities-bundle","@msinternal/sp-fluent-theme-bundle","@msinternal/sharepoint-ui-tokens-bundle","@msinternal/sp-fluentui-v9-react-dialog-bundle","@msinternal/sp-ai-context-template","@msinternal/sp-people-dataprovider","@msinternal/sp-canvas-types","@msinternal/sp-webpart-shared","@msinternal/sp-design-ideas-styler","@msinternal/sp-adaptive-card-extension-components","@msinternal/sp-webpart-shared-editmode","@msinternal/sp-ai-properties-tools-internal","@msinternal/sp-pages-feedback","@msinternal/sp-ai-properties-fluid-internal"],(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b,g,v,y,S,D,I,x,C,O,w,E,A,L,k,M,P,T,U,F,H,R,N,B,j,V,z,G,K,W,q,Q,Y,J,X,Z,$,ee,te,ne,ae,ie,re)=>(()=>{var oe={9647:(e,t)=>{"use strict";t.Uf=t.az=void 0;var n=/^([^\w]*)(javascript|data|vbscript)/im,a=/&#(\w+)(^\w|;)?/g,i=/&(newline|tab);/gi,r=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,o=/^.+(:|&colon;)/gim,s=[".","/"];t.az="about:blank",t.Uf=function(e){if(!e)return t.az;var c,d=(c=e,c.replace(r,"").replace(a,function(e,t){return String.fromCharCode(t)})).replace(i,"").replace(r,"").trim();if(!d)return t.az;if(function(e){return s.indexOf(e[0])>-1}(d))return d;var l=d.match(o);if(!l)return d;var u=l[0];return n.test(u)?t.az:d}}
,3530:function(e){e.exports=function(){"use strict";var e=6e4,t=36e5,n="millisecond",a="second",i="minute",r="hour",o="day",s="week",c="month",d="quarter",l="year",u="date",f="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,m=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,_={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},h=function(e,t,n){var a=String(e);return!a||a.length>=t?e:""+Array(t+1-a.length).join(n)+e},b={s:h,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),a=Math.floor(n/60),i=n%60;return(t<=0?"+":"-")+h(a,2,"0")+":"+h(i,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var a=12*(n.year()-t.year())+(n.month()-t.month()),i=t.clone().add(a,c),r=n-i<0,o=t.clone().add(a+(r?-1:1),c);return+(-(a+(n-i)/(r?i-o:o-i))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:l,w:s,d:o,D:u,h:r,m:i,s:a,ms:n,Q:d}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},g="en",v={};v[g]=_;var y="$isDayjsObject",S=function(e){return e instanceof C||!(!e||!e[y])},D=function e(t,n,a){var i;if(!t)return g;if("string"==typeof t){var r=t.toLowerCase();v[r]&&(i=r),n&&(v[r]=n,i=r);var o=t.split("-");if(!i&&o.length>1)return e(o[0])}else{var s=t.name;v[s]=t,i=s}return!a&&i&&(g=i),i||!a&&g},I=function(e,t){if(S(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new C(n)},x=b;x.l=D,x.i=S,x.w=function(e,t){return I(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var C=function(){function _(e){this.$L=D(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[y]=!0}var h=_.prototype;return h.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(x.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var a=t.match(p);if(a){var i=a[2]-1||0,r=(a[7]||"0").substring(0,3);return n?new Date(Date.UTC(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,r)):new Date(a[1],i,a[3]||1,a[4]||0,a[5]||0,a[6]||0,r)}}return new Date(t)}(e),this.init()},h.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},h.$utils=function(){return x},h.isValid=function(){return!(this.$d.toString()===f)},h.isSame=function(e,t){var n=I(e);return this.startOf(t)<=n&&n<=this.endOf(t)},h.isAfter=function(e,t){return I(e)<this.startOf(t)},h.isBefore=function(e,t){return this.endOf(t)<I(e)},h.$g=function(e,t,n){return x.u(e)?this[t]:this.set(n,e)},h.unix=function(){return Math.floor(this.valueOf()/1e3)},h.valueOf=function(){return this.$d.getTime()},h.startOf=function(e,t){var n=this,d=!!x.u(t)||t,f=x.p(e),p=function(e,t){var a=x.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return d?a:a.endOf(o)},m=function(e,t){return x.w(n.toDate()[e].apply(n.toDate("s"),(d?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},_=this.$W,h=this.$M,b=this.$D,g="set"+(this.$u?"UTC":"");switch(f){case l:return d?p(1,0):p(31,11);case c:return d?p(1,h):p(0,h+1);case s:var v=this.$locale().weekStart||0,y=(_<v?_+7:_)-v;return p(d?b-y:b+(6-y),h);case o:case u:return m(g+"Hours",0);case r:return m(g+"Minutes",1);case i:return m(g+"Seconds",2);case a:return m(g+"Milliseconds",3);default:return this.clone()}},h.endOf=function(e){return this.startOf(e,!1)},h.$set=function(e,t){var s,d=x.p(e),f="set"+(this.$u?"UTC":""),p=(s={},s[o]=f+"Date",s[u]=f+"Date",s[c]=f+"Month",s[l]=f+"FullYear",s[r]=f+"Hours",s[i]=f+"Minutes",s[a]=f+"Seconds",s[n]=f+"Milliseconds",s)[d],m=d===o?this.$D+(t-this.$W):t;if(d===c||d===l){var _=this.clone().set(u,1);_.$d[p](m),_.init(),this.$d=_.set(u,Math.min(this.$D,_.daysInMonth())).$d}else p&&this.$d[p](m);return this.init(),this},h.set=function(e,t){return this.clone().$set(e,t)},h.get=function(e){return this[x.p(e)]()},h.add=function(n,d){var u,f=this;n=Number(n);var p=x.p(d),m=function(e){var t=I(f);return x.w(t.date(t.date()+Math.round(e*n)),f)};if(p===c)return this.set(c,this.$M+n);if(p===l)return this.set(l,this.$y+n);if(p===o)return m(1);if(p===s)return m(7);var _=(u={},u[i]=e,u[r]=t,u[a]=1e3,u)[p]||1,h=this.$d.getTime()+n*_;return x.w(h,this)},h.subtract=function(e,t){return this.add(-1*e,t)},h.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||f;var a=e||"YYYY-MM-DDTHH:mm:ssZ",i=x.z(this),r=this.$H,o=this.$m,s=this.$M,c=n.weekdays,d=n.months,l=n.meridiem,u=function(e,n,i,r){return e&&(e[n]||e(t,a))||i[n].slice(0,r)},p=function(e){return x.s(r%12||12,e,"0")},_=l||function(e,t,n){var a=e<12?"AM":"PM";return n?a.toLowerCase():a};return a.replace(m,function(e,a){return a||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return x.s(t.$y,4,"0");case"M":return s+1;case"MM":return x.s(s+1,2,"0");case"MMM":return u(n.monthsShort,s,d,3);case"MMMM":return u(d,s);case"D":return t.$D;case"DD":return x.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return u(n.weekdaysMin,t.$W,c,2);case"ddd":return u(n.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(r);case"HH":return x.s(r,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return _(r,o,!0);case"A":return _(r,o,!1);case"m":return String(o);case"mm":return x.s(o,2,"0");case"s":return String(t.$s);case"ss":return x.s(t.$s,2,"0");case"SSS":return x.s(t.$ms,3,"0");case"Z":return i}return null}(e)||i.replace(":","")})},h.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},h.diff=function(n,u,f){var p,m=this,_=x.p(u),h=I(n),b=(h.utcOffset()-this.utcOffset())*e,g=this-h,v=function(){return x.m(m,h)};switch(_){case l:p=v()/12;break;case c:p=v();break;case d:p=v()/3;break;case s:p=(g-b)/6048e5;break;case o:p=(g-b)/864e5;break;case r:p=g/t;break;case i:p=g/e;break;case a:p=g/1e3;break;default:p=g}return f?p:x.a(p)},h.daysInMonth=function(){return this.endOf(c).$D},h.$locale=function(){return v[this.$L]},h.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),a=D(e,t,!0);return a&&(n.$L=a),n},h.clone=function(){return x.w(this.$d,this)},h.toDate=function(){return new Date(this.valueOf())},h.toJSON=function(){return this.isValid()?this.toISOString():null},h.toISOString=function(){return this.$d.toISOString()},h.toString=function(){return this.$d.toUTCString()},_}(),O=C.prototype;return I.prototype=O,[["$ms",n],["$s",a],["$m",i],["$H",r],["$W",o],["$M",c],["$y",l],["$D",u]].forEach(function(e){O[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),I.extend=function(e,t){return e.$i||(e(t,C,I),e.$i=!0),I},I.locale=D,I.isDayjs=S,I.unix=function(e){return I(1e3*e)},I.en=v[g],I.Ls=v,I.p={},I}()}
,1018:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:a,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:o,create:s}=Object,{apply:c,construct:d}="undefined"!=typeof Reflect&&Reflect;r||(r=function(e){return e}),o||(o=function(e){return e}),c||(c=function(e,t,n){return e.apply(t,n)}),d||(d=function(e,t){return new e(...t)});const l=x(Array.prototype.forEach),u=x(Array.prototype.pop),f=x(Array.prototype.push),p=x(String.prototype.toLowerCase),m=x(String.prototype.toString),_=x(String.prototype.match),h=x(String.prototype.replace),b=x(String.prototype.indexOf),g=x(String.prototype.trim),v=x(Object.prototype.hasOwnProperty),y=x(RegExp.prototype.test),S=(D=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(D,t)});var D;function I(e){return"number"==typeof e&&isNaN(e)}function x(e){return function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return c(e,t,a)}}function C(e,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;t&&t(e,null);let r=a.length;for(;r--;){let t=a[r];if("string"==typeof t){const e=i(t);e!==t&&(n(a)||(a[r]=e),t=e)}e[t]=!0}return e}function O(e){for(let t=0;t<e.length;t++)v(e,t)||(e[t]=null);return e}function w(t){const n=s(null);for(const[a,i]of e(t))v(t,a)&&(Array.isArray(i)?n[a]=O(i):i&&"object"==typeof i&&i.constructor===Object?n[a]=w(i):n[a]=i);return n}function E(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return x(n.get);if("function"==typeof n.value)return x(n.value)}e=a(e)}return function(){return null}}const A=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),k=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),T=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=r(["#text"]),F=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),H=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),N=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j=o(/<%[\w\W]*|[\w\W]*%>/gm),V=o(/\${[\w\W]*}/gm),z=o(/^data-[\-\w.\u00B7-\uFFFF]/),G=o(/^aria-[\-\w]+$/),K=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=o(/^(?:\w+script|data):/i),q=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=o(/^html$/i),Y=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var J=Object.freeze({__proto__:null,MUSTACHE_EXPR:B,ERB_EXPR:j,TMPLIT_EXPR:V,DATA_ATTR:z,ARIA_ATTR:G,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:q,DOCTYPE_NAME:Q,CUSTOM_ELEMENT:Y});const X=function(){return"undefined"==typeof window?null:window},Z=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const a="data-tt-policy-suffix";t&&t.hasAttribute(a)&&(n=t.getAttribute(a));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X();const a=e=>t(e);if(a.version="3.1.4",a.removed=[],!n||!n.document||9!==n.document.nodeType)return a.isSupported=!1,a;let{document:i}=n;const o=i,c=o.currentScript,{DocumentFragment:d,HTMLTemplateElement:D,Node:x,Element:O,NodeFilter:B,NamedNodeMap:j=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:z,trustedTypes:G}=n,W=O.prototype,q=E(W,"cloneNode"),Y=E(W,"nextSibling"),$=E(W,"childNodes"),ee=E(W,"parentNode");if("function"==typeof D){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let te,ne="";const{implementation:ae,createNodeIterator:ie,createDocumentFragment:re,getElementsByTagName:oe}=i,{importNode:se}=o;let ce={};a.isSupported="function"==typeof e&&"function"==typeof ee&&ae&&void 0!==ae.createHTMLDocument;const{MUSTACHE_EXPR:de,ERB_EXPR:le,TMPLIT_EXPR:ue,DATA_ATTR:fe,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:me,ATTR_WHITESPACE:_e,CUSTOM_ELEMENT:he}=J;let{IS_ALLOWED_URI:be}=J,ge=null;const ve=C({},[...A,...L,...k,...P,...U]);let ye=null;const Se=C({},[...F,...H,...R,...N]);let De=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,xe=null,Ce=!0,Oe=!0,we=!1,Ee=!0,Ae=!1,Le=!0,ke=!1,Me=!1,Pe=!1,Te=!1,Ue=!1,Fe=!1,He=!0,Re=!1;const Ne="user-content-";let Be=!0,je=!1,Ve={},ze=null;const Ge=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const We=C({},["audio","video","img","source","image","track"]);let qe=null;const Qe=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ye="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml";let Ze=Xe,$e=!1,et=null;const tt=C({},[Ye,Je,Xe],m);let nt=null;const at=["application/xhtml+xml","text/html"],it="text/html";let rt=null,ot=null;const st=255,ct=i.createElement("form"),dt=function(e){return e instanceof RegExp||e instanceof Function},lt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ot||ot!==e){if(e&&"object"==typeof e||(e={}),e=w(e),nt=-1===at.indexOf(e.PARSER_MEDIA_TYPE)?it:e.PARSER_MEDIA_TYPE,rt="application/xhtml+xml"===nt?m:p,ge=v(e,"ALLOWED_TAGS")?C({},e.ALLOWED_TAGS,rt):ve,ye=v(e,"ALLOWED_ATTR")?C({},e.ALLOWED_ATTR,rt):Se,et=v(e,"ALLOWED_NAMESPACES")?C({},e.ALLOWED_NAMESPACES,m):tt,qe=v(e,"ADD_URI_SAFE_ATTR")?C(w(Qe),e.ADD_URI_SAFE_ATTR,rt):Qe,Ke=v(e,"ADD_DATA_URI_TAGS")?C(w(We),e.ADD_DATA_URI_TAGS,rt):We,ze=v(e,"FORBID_CONTENTS")?C({},e.FORBID_CONTENTS,rt):Ge,Ie=v(e,"FORBID_TAGS")?C({},e.FORBID_TAGS,rt):{},xe=v(e,"FORBID_ATTR")?C({},e.FORBID_ATTR,rt):{},Ve=!!v(e,"USE_PROFILES")&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,Oe=!1!==e.ALLOW_DATA_ATTR,we=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ae=e.SAFE_FOR_TEMPLATES||!1,Le=!1!==e.SAFE_FOR_XML,ke=e.WHOLE_DOCUMENT||!1,Te=e.RETURN_DOM||!1,Ue=e.RETURN_DOM_FRAGMENT||!1,Fe=e.RETURN_TRUSTED_TYPE||!1,Pe=e.FORCE_BODY||!1,He=!1!==e.SANITIZE_DOM,Re=e.SANITIZE_NAMED_PROPS||!1,Be=!1!==e.KEEP_CONTENT,je=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||K,Ze=e.NAMESPACE||Xe,De=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(De.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(De.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(De.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ae&&(Oe=!1),Ue&&(Te=!0),Ve&&(ge=C({},U),ye=[],!0===Ve.html&&(C(ge,A),C(ye,F)),!0===Ve.svg&&(C(ge,L),C(ye,H),C(ye,N)),!0===Ve.svgFilters&&(C(ge,k),C(ye,H),C(ye,N)),!0===Ve.mathMl&&(C(ge,P),C(ye,R),C(ye,N))),e.ADD_TAGS&&(ge===ve&&(ge=w(ge)),C(ge,e.ADD_TAGS,rt)),e.ADD_ATTR&&(ye===Se&&(ye=w(ye)),C(ye,e.ADD_ATTR,rt)),e.ADD_URI_SAFE_ATTR&&C(qe,e.ADD_URI_SAFE_ATTR,rt),e.FORBID_CONTENTS&&(ze===Ge&&(ze=w(ze)),C(ze,e.FORBID_CONTENTS,rt)),Be&&(ge["#text"]=!0),ke&&C(ge,["html","head","body"]),ge.table&&(C(ge,["tbody"]),delete Ie.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');te=e.TRUSTED_TYPES_POLICY,ne=te.createHTML("")}else void 0===te&&(te=Z(G,c)),null!==te&&"string"==typeof ne&&(ne=te.createHTML(""));r&&r(e),ot=e}},ut=C({},["mi","mo","mn","ms","mtext"]),ft=C({},["foreignobject","annotation-xml"]),pt=C({},["title","style","font","a","script"]),mt=C({},[...L,...k,...M]),_t=C({},[...P,...T]),ht=function(e){let t=ee(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=p(e.tagName),a=p(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Je?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ye?"svg"===n&&("annotation-xml"===a||ut[a]):Boolean(mt[n]):e.namespaceURI===Ye?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Je?"math"===n&&ft[a]:Boolean(_t[n]):e.namespaceURI===Xe?!(t.namespaceURI===Je&&!ft[a])&&!(t.namespaceURI===Ye&&!ut[a])&&!_t[n]&&(pt[n]||!mt[n]):!("application/xhtml+xml"!==nt||!et[e.namespaceURI]))},bt=function(e){f(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},gt=function(e,t){try{f(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){f(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ye[e])if(Te||Ue)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},vt=function(e){let t=null,n=null;if(Pe)e="<remove></remove>"+e;else{const t=_(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===nt&&Ze===Xe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=te?te.createHTML(e):e;if(Ze===Xe)try{t=(new z).parseFromString(a,nt)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=$e?ne:a}catch(e){}}const r=t.body||t.documentElement;return e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),Ze===Xe?oe.call(t,ke?"html":"body")[0]:ke?t.documentElement:r},yt=function(e){return ie.call(e.ownerDocument||e,e,B.SHOW_ELEMENT|B.SHOW_COMMENT|B.SHOW_TEXT|B.SHOW_PROCESSING_INSTRUCTION|B.SHOW_CDATA_SECTION,null)},St=function(e){return e instanceof V&&(void 0!==e.__depth&&"number"!=typeof e.__depth||void 0!==e.__removalCount&&"number"!=typeof e.__removalCount||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof j)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Dt=function(e){return"function"==typeof x&&e instanceof x},It=function(e,t,n){ce[e]&&l(ce[e],e=>{e.call(a,t,n,ot)})},xt=function(e){let t=null;if(It("beforeSanitizeElements",e,null),St(e))return bt(e),!0;const n=rt(e.nodeName);if(It("uponSanitizeElement",e,{tagName:n,allowedTags:ge}),e.hasChildNodes()&&!Dt(e.firstElementChild)&&y(/<[/\w]/g,e.innerHTML)&&y(/<[/\w]/g,e.textContent))return bt(e),!0;if(7===e.nodeType)return bt(e),!0;if(Le&&8===e.nodeType&&y(/<[/\w]/g,e.data))return bt(e),!0;if(!ge[n]||Ie[n]){if(!Ie[n]&&Ot(n)){if(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n))return!1;if(De.tagNameCheck instanceof Function&&De.tagNameCheck(n))return!1}if(Be&&!ze[n]){const t=ee(e)||e.parentNode,n=$(e)||e.childNodes;if(n&&t)for(let a=n.length-1;a>=0;--a){const i=q(n[a],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,Y(e))}}return bt(e),!0}return e instanceof O&&!ht(e)?(bt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!y(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ae&&3===e.nodeType&&(t=e.textContent,l([de,le,ue],e=>{t=h(t,e," ")}),e.textContent!==t&&(f(a.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(bt(e),!0)},Ct=function(e,t,n){if(He&&("id"===t||"name"===t)&&(n in i||n in ct||"__depth"===n||"__removalCount"===n))return!1;if(Oe&&!xe[t]&&y(fe,t));else if(Ce&&y(pe,t));else if(!ye[t]||xe[t]){if(!(Ot(e)&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,e)||De.tagNameCheck instanceof Function&&De.tagNameCheck(e))&&(De.attributeNameCheck instanceof RegExp&&y(De.attributeNameCheck,t)||De.attributeNameCheck instanceof Function&&De.attributeNameCheck(t))||"is"===t&&De.allowCustomizedBuiltInElements&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n)||De.tagNameCheck instanceof Function&&De.tagNameCheck(n))))return!1}else if(qe[t]);else if(y(be,h(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!Ke[e])if(we&&!y(me,h(n,_e,"")));else if(n)return!1;return!0},Ot=function(e){return"annotation-xml"!==e&&_(e,he)},wt=function(e){It("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};let i=t.length;for(;i--;){const r=t[i],{name:o,namespaceURI:s,value:c}=r,d=rt(o);let f="value"===o?c:g(c);if(n.attrName=d,n.attrValue=f,n.keepAttr=!0,n.forceKeepAttr=void 0,It("uponSanitizeAttribute",e,n),f=n.attrValue,n.forceKeepAttr)continue;if(gt(o,e),!n.keepAttr)continue;if(!Ee&&y(/\/>/i,f)){gt(o,e);continue}if(Le&&y(/((--!?|])>)|<\/(style|title)/i,f)){gt(o,e);continue}Ae&&l([de,le,ue],e=>{f=h(f,e," ")});const p=rt(e.nodeName);if(Ct(p,d,f)){if(!Re||"id"!==d&&"name"!==d||(gt(o,e),f=Ne+f),te&&"object"==typeof G&&"function"==typeof G.getAttributeType)if(s);else switch(G.getAttributeType(p,d)){case"TrustedHTML":f=te.createHTML(f);break;case"TrustedScriptURL":f=te.createScriptURL(f)}try{s?e.setAttributeNS(s,o,f):e.setAttribute(o,f),St(e)?bt(e):u(a.removed)}catch(e){}}}It("afterSanitizeAttributes",e,null)},Et=function e(t){let n=null;const a=yt(t);for(It("beforeSanitizeShadowDOM",t,null);n=a.nextNode();){if(It("uponSanitizeShadowNode",n,null),xt(n))continue;const t=ee(n);1===n.nodeType&&(t&&t.__depth?n.__depth=(n.__removalCount||0)+t.__depth+1:n.__depth=1),(n.__depth>=st||n.__depth<0||I(n.__depth))&&bt(n),n.content instanceof d&&(n.content.__depth=n.__depth,e(n.content)),wt(n)}It("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,r=null,s=null;if($e=!e,$e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Dt(e)){if("function"!=typeof e.toString)throw S("toString is not a function");if("string"!=typeof(e=e.toString()))throw S("dirty is not a string, aborting")}if(!a.isSupported)return e;if(Me||lt(t),a.removed=[],"string"==typeof e&&(je=!1),je){if(e.nodeName){const t=rt(e.nodeName);if(!ge[t]||Ie[t])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof x)n=vt("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!Te&&!Ae&&!ke&&-1===e.indexOf("<"))return te&&Fe?te.createHTML(e):e;if(n=vt(e),!n)return Te?null:Fe?ne:""}n&&Pe&&bt(n.firstChild);const c=yt(je?e:n);for(;r=c.nextNode();){if(xt(r))continue;const e=ee(r);1===r.nodeType&&(e&&e.__depth?r.__depth=(r.__removalCount||0)+e.__depth+1:r.__depth=1),(r.__depth>=st||r.__depth<0||I(r.__depth))&&bt(r),r.content instanceof d&&(r.content.__depth=r.__depth,Et(r.content)),wt(r)}if(je)return e;if(Te){if(Ue)for(s=re.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return(ye.shadowroot||ye.shadowrootmode)&&(s=se.call(o,s,!0)),s}let u=ke?n.outerHTML:n.innerHTML;return ke&&ge["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&y(Q,n.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+u),Ae&&l([de,le,ue],e=>{u=h(u,e," ")}),te&&Fe?te.createHTML(u):u},a.setConfig=function(){lt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Me=!0},a.clearConfig=function(){ot=null,Me=!1},a.isValidAttribute=function(e,t,n){ot||lt({});const a=rt(e),i=rt(t);return Ct(a,i,n)},a.addHook=function(e,t){"function"==typeof t&&(ce[e]=ce[e]||[],f(ce[e],t))},a.removeHook=function(e){if(ce[e])return u(ce[e])},a.removeHooks=function(e){ce[e]&&(ce[e]=[])},a.removeAllHooks=function(){ce={}},a}()}()}
,1396:(e,t,n)=>{"use strict";function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var a=Array.from("string"==typeof e?[e]:e);a[a.length-1]=a[a.length-1].replace(/\r?\n([\t ]*)$/,"");var i=a.reduce(function(e,t){var n=t.match(/\n([\t ]+|(?!\s).)/g);return n?e.concat(n.map(function(e){var t,n;return null!==(n=null===(t=e.match(/[\t ]/g))||void 0===t?void 0:t.length)&&void 0!==n?n:0})):e},[]);if(i.length){var r=new RegExp("\n[\t ]{"+Math.min.apply(Math,i)+"}","g");a=a.map(function(e){return e.replace(r,"\n")})}a[0]=a[0].replace(/^\r?\n/,"");var o=a[0];return t.forEach(function(e,t){var n=o.match(/(?:^|\n)( *)$/),i=n?n[1]:"",r=e;"string"==typeof e&&e.includes("\n")&&(r=String(e).split("\n").map(function(e,t){return 0===t?e:""+i+e}).join("\n")),o+=r+a[t+1]}),o}n.d(t,{T:()=>a})}
,5648:(e,t,n)=>{var a=n(6277);e.exports=a.StringHelper}
,8424:e=>{"use strict";e.exports=u},6658:e=>{"use strict";e.exports=x},9676:e=>{"use strict";e.exports=a},2207:e=>{"use strict";e.exports=l},1909:e=>{"use strict";e.exports=I},2737:e=>{"use strict";e.exports=y},529:e=>{"use strict";e.exports=H},7408:e=>{"use strict";e.exports=C},6642:e=>{"use strict";e.exports=c},2141:e=>{"use strict";e.exports=h},6277:e=>{"use strict";e.exports=o},8810:e=>{"use strict";e.exports=k},9930:e=>{"use strict";e.exports=Q},9170:e=>{"use strict";e.exports=te},2657:e=>{"use strict";e.exports=J},1853:e=>{"use strict";e.exports=re},6384:e=>{"use strict";e.exports=ae},7301:e=>{"use strict";e.exports=v},152:e=>{"use strict";e.exports=j},631:e=>{"use strict";e.exports=n},2560:e=>{"use strict";e.exports=Z},9318:e=>{"use strict";e.exports=f},718:e=>{"use strict";e.exports=t},6567:e=>{"use strict";e.exports=ee},1717:e=>{"use strict";e.exports=q},4107:e=>{"use strict";e.exports=W},6557:e=>{"use strict";e.exports=N},7526:e=>{"use strict";e.exports=D},6724:e=>{"use strict";e.exports=m},3117:e=>{"use strict";e.exports=U},7675:e=>{"use strict";e.exports=M},7806:e=>{"use strict";e.exports=Y},9843:e=>{"use strict";e.exports=L},5711:e=>{"use strict";e.exports=_},5864:e=>{"use strict";e.exports=g},4458:e=>{"use strict";e.exports=V},4830:e=>{"use strict";e.exports=F},6879:e=>{"use strict";e.exports=O},6321:e=>{"use strict";e.exports=S},5935:e=>{"use strict";e.exports=P},2323:e=>{"use strict";e.exports=R},3054:e=>{"use strict";e.exports=A},1395:e=>{"use strict";e.exports=E},5494:e=>{"use strict";e.exports=G},6794:e=>{"use strict";e.exports=p},7781:e=>{"use strict";e.exports=T},1723:e=>{"use strict";e.exports=b},1589:e=>{"use strict";e.exports=w},606:e=>{"use strict";e.exports=d},7793:e=>{"use strict";e.exports=B},3048:e=>{"use strict";e.exports=ie},530:e=>{"use strict";e.exports=r},303:e=>{"use strict";e.exports=X},6356:e=>{"use strict";e.exports=i},8919:e=>{"use strict";e.exports=$},1181:e=>{"use strict";e.exports=ne},9825:e=>{"use strict";e.exports=K},5959:e=>{"use strict";e.exports=s},280:e=>{"use strict";e.exports=z},7712:(e,t,n)=>{"use strict";function a(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function i(e,t){let n;if(void 0===t)for(const t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let a=-1;for(let i of e)null!=(i=t(i,++a,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function r(e){return e}n.d(t,{ULW:()=>Qs,u78:()=>m,vlR:()=>p,hrM:()=>sc,Ju4:()=>dc,TA3:()=>uc,Qi0:()=>pc,jGM:()=>mc,BEq:()=>hc,x8u:()=>vc,mlC:()=>Sc,TrU:()=>Ic,mDi:()=>Oc,V7f:()=>Ec,nVp:()=>Lc,uUB:()=>Xs,Hx9:()=>Mc,pVG:()=>Bc,yxU:()=>jc,Yf2:()=>Gc,MZz:()=>Wc,WPb:()=>Qc,ayv:()=>qc,tEH:()=>da,p8j:()=>ec,K9B:()=>a,dkA:()=>i,bLf:()=>ac,QH:()=>ba,f4Y:()=>zi,WMr:()=>ha,D7C:()=>hs,Ct:()=>bs,Htv:()=>gs,Wbm:()=>vs,UWy:()=>Gn,WAC:()=>dd,ACK:()=>Fd,KUC:()=>gd,Ogd:()=>sd,v6C:()=>Zc,DXd:()=>rd,OBi:()=>md,Wi6:()=>Ed,bGn:()=>vd,ycG:()=>id,JPH:()=>pd,Rol:()=>bd,jGu:()=>_d,MuW:()=>hd});var o=1e-6;function s(e){return"translate("+e+",0)"}function c(e){return"translate(0,"+e+")"}function d(e){return t=>+e(t)}function l(e,t){return t=Math.max(0,e.bandwidth()-2*t)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function u(){return!this.__axis}function f(e,t){var n=[],a=null,i=null,f=6,p=6,m=3,_="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,h=1===e||4===e?-1:1,b=4===e||2===e?"x":"y",g=1===e||3===e?s:c;function v(s){var c=null==a?t.ticks?t.ticks.apply(t,n):t.domain():a,v=null==i?t.tickFormat?t.tickFormat.apply(t,n):r:i,y=Math.max(f,0)+m,S=t.range(),D=+S[0]+_,I=+S[S.length-1]+_,x=(t.bandwidth?l:d)(t.copy(),_),C=s.selection?s.selection():s,O=C.selectAll(".domain").data([null]),w=C.selectAll(".tick").data(c,t).order(),E=w.exit(),A=w.enter().append("g").attr("class","tick"),L=w.select("line"),k=w.select("text");O=O.merge(O.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),w=w.merge(A),L=L.merge(A.append("line").attr("stroke","currentColor").attr(b+"2",h*f)),k=k.merge(A.append("text").attr("fill","currentColor").attr(b,h*y).attr("dy",1===e?"0em":3===e?"0.71em":"0.32em")),s!==C&&(O=O.transition(s),w=w.transition(s),L=L.transition(s),k=k.transition(s),E=E.transition(s).attr("opacity",o).attr("transform",function(e){return isFinite(e=x(e))?g(e+_):this.getAttribute("transform")}),A.attr("opacity",o).attr("transform",function(e){var t=this.parentNode.__axis;return g((t&&isFinite(t=t(e))?t:x(e))+_)})),E.remove(),O.attr("d",4===e||2===e?p?"M"+h*p+","+D+"H"+_+"V"+I+"H"+h*p:"M"+_+","+D+"V"+I:p?"M"+D+","+h*p+"V"+_+"H"+I+"V"+h*p:"M"+D+","+_+"H"+I),w.attr("opacity",1).attr("transform",function(e){return g(x(e)+_)}),L.attr(b+"2",h*f),k.attr(b,h*y).text(v),C.filter(u).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",2===e?"start":4===e?"end":"middle"),C.each(function(){this.__axis=x})}return v.scale=function(e){return arguments.length?(t=e,v):t},v.ticks=function(){return n=Array.from(arguments),v},v.tickArguments=function(e){return arguments.length?(n=null==e?[]:Array.from(e),v):n.slice()},v.tickValues=function(e){return arguments.length?(a=null==e?null:Array.from(e),v):a&&a.slice()},v.tickFormat=function(e){return arguments.length?(i=e,v):i},v.tickSize=function(e){return arguments.length?(f=p=+e,v):f},v.tickSizeInner=function(e){return arguments.length?(f=+e,v):f},v.tickSizeOuter=function(e){return arguments.length?(p=+e,v):p},v.tickPadding=function(e){return arguments.length?(m=+e,v):m},v.offset=function(e){return arguments.length?(_=+e,v):_},v}function p(e){return f(1,e)}function m(e){return f(3,e)}function _(){}function h(e){return null==e?_:function(){return this.querySelector(e)}}function b(e){return null==e?[]:Array.isArray(e)?e:Array.from(e)}function g(){return[]}function v(e){return null==e?g:function(){return this.querySelectorAll(e)}}function y(e){return function(){return this.matches(e)}}function S(e){return function(t){return t.matches(e)}}var D=Array.prototype.find;function I(){return this.firstElementChild}var x=Array.prototype.filter;function C(){return Array.from(this.children)}function O(e){return new Array(e.length)}function w(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}function E(e){return function(){return e}}function A(e,t,n,a,i,r){for(var o,s=0,c=t.length,d=r.length;s<d;++s)(o=t[s])?(o.__data__=r[s],a[s]=o):n[s]=new w(e,r[s]);for(;s<c;++s)(o=t[s])&&(i[s]=o)}function L(e,t,n,a,i,r,o){var s,c,d,l=new Map,u=t.length,f=r.length,p=new Array(u);for(s=0;s<u;++s)(c=t[s])&&(p[s]=d=o.call(c,c.__data__,s,t)+"",l.has(d)?i[s]=c:l.set(d,c));for(s=0;s<f;++s)d=o.call(e,r[s],s,r)+"",(c=l.get(d))?(a[s]=c,c.__data__=r[s],l.delete(d)):n[s]=new w(e,r[s]);for(s=0;s<u;++s)(c=t[s])&&l.get(p[s])===c&&(i[s]=c)}function k(e){return e.__data__}function M(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function P(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}w.prototype={constructor:w,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};var T="http://www.w3.org/1999/xhtml";const U={svg:"http://www.w3.org/2000/svg",xhtml:T,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function F(e){var t=e+="",n=t.indexOf(":");return n>=0&&"xmlns"!==(t=e.slice(0,n))&&(e=e.slice(n+1)),U.hasOwnProperty(t)?{space:U[t],local:e}:e}function H(e){return function(){this.removeAttribute(e)}}function R(e){return function(){this.removeAttributeNS(e.space,e.local)}}function N(e,t){return function(){this.setAttribute(e,t)}}function B(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function j(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}}function V(e,t){return function(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function z(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function G(e){return function(){this.style.removeProperty(e)}}function K(e,t,n){return function(){this.style.setProperty(e,t,n)}}function W(e,t,n){return function(){var a=t.apply(this,arguments);null==a?this.style.removeProperty(e):this.style.setProperty(e,a,n)}}function q(e,t){return e.style.getPropertyValue(t)||z(e).getComputedStyle(e,null).getPropertyValue(t)}function Q(e){return function(){delete this[e]}}function Y(e,t){return function(){this[e]=t}}function J(e,t){return function(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}}function X(e){return e.trim().split(/^|\s+/)}function Z(e){return e.classList||new $(e)}function $(e){this._node=e,this._names=X(e.getAttribute("class")||"")}function ee(e,t){for(var n=Z(e),a=-1,i=t.length;++a<i;)n.add(t[a])}function te(e,t){for(var n=Z(e),a=-1,i=t.length;++a<i;)n.remove(t[a])}function ne(e){return function(){ee(this,e)}}function ae(e){return function(){te(this,e)}}function ie(e,t){return function(){(t.apply(this,arguments)?ee:te)(this,e)}}function re(){this.textContent=""}function oe(e){return function(){this.textContent=e}}function se(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function ce(){this.innerHTML=""}function de(e){return function(){this.innerHTML=e}}function le(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function ue(){this.nextSibling&&this.parentNode.appendChild(this)}function fe(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===T&&t.documentElement.namespaceURI===T?t.createElement(e):t.createElementNS(n,e)}}function me(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function _e(e){var t=F(e);return(t.local?me:pe)(t)}function he(){return null}function be(){var e=this.parentNode;e&&e.removeChild(this)}function ge(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ve(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function ye(e){return e.trim().split(/^|\s+/).map(function(e){var t="",n=e.indexOf(".");return n>=0&&(t=e.slice(n+1),e=e.slice(0,n)),{type:e,name:t}})}function Se(e){return function(){var t=this.__on;if(t){for(var n,a=0,i=-1,r=t.length;a<r;++a)n=t[a],e.type&&n.type!==e.type||n.name!==e.name?t[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?t.length=i:delete this.__on}}}function De(e,t,n){return function(){var a,i=this.__on,r=function(e){return function(t){e.call(this,t,this.__data__)}}(t);if(i)for(var o=0,s=i.length;o<s;++o)if((a=i[o]).type===e.type&&a.name===e.name)return this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=r,a.options=n),void(a.value=t);this.addEventListener(e.type,r,n),a={type:e.type,name:e.name,value:t,listener:r,options:n},i?i.push(a):this.__on=[a]}}function Ie(e,t,n){var a=z(e),i=a.CustomEvent;"function"==typeof i?i=new i(t,n):(i=a.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function xe(e,t){return function(){return Ie(this,e,t)}}function Ce(e,t){return function(){return Ie(this,e,t.apply(this,arguments))}}$.prototype={add:function(e){this._names.indexOf(e)<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};var Oe=[null];function we(e,t){this._groups=e,this._parents=t}function Ee(){return new we([[document.documentElement]],Oe)}we.prototype=Ee.prototype={constructor:we,select:function(e){"function"!=typeof e&&(e=h(e));for(var t=this._groups,n=t.length,a=new Array(n),i=0;i<n;++i)for(var r,o,s=t[i],c=s.length,d=a[i]=new Array(c),l=0;l<c;++l)(r=s[l])&&(o=e.call(r,r.__data__,l,s))&&("__data__"in r&&(o.__data__=r.__data__),d[l]=o);return new we(a,this._parents)},selectAll:function(e){e="function"==typeof e?function(e){return function(){return b(e.apply(this,arguments))}}(e):v(e);for(var t=this._groups,n=t.length,a=[],i=[],r=0;r<n;++r)for(var o,s=t[r],c=s.length,d=0;d<c;++d)(o=s[d])&&(a.push(e.call(o,o.__data__,d,s)),i.push(o));return new we(a,i)},selectChild:function(e){return this.select(null==e?I:function(e){return function(){return D.call(this.children,e)}}("function"==typeof e?e:S(e)))},selectChildren:function(e){return this.selectAll(null==e?C:function(e){return function(){return x.call(this.children,e)}}("function"==typeof e?e:S(e)))},filter:function(e){"function"!=typeof e&&(e=y(e));for(var t=this._groups,n=t.length,a=new Array(n),i=0;i<n;++i)for(var r,o=t[i],s=o.length,c=a[i]=[],d=0;d<s;++d)(r=o[d])&&e.call(r,r.__data__,d,o)&&c.push(r);return new we(a,this._parents)},data:function(e,t){if(!arguments.length)return Array.from(this,k);var n=t?L:A,a=this._parents,i=this._groups;"function"!=typeof e&&(e=E(e));for(var r=i.length,o=new Array(r),s=new Array(r),c=new Array(r),d=0;d<r;++d){var l=a[d],u=i[d],f=u.length,p=M(e.call(l,l&&l.__data__,d,a)),m=p.length,_=s[d]=new Array(m),h=o[d]=new Array(m),b=c[d]=new Array(f);n(l,u,_,h,b,p,t);for(var g,v,y=0,S=0;y<m;++y)if(g=_[y]){for(y>=S&&(S=y+1);!(v=h[S])&&++S<m;);g._next=v||null}}return(o=new we(o,a))._enter=s,o._exit=c,o},enter:function(){return new we(this._enter||this._groups.map(O),this._parents)},exit:function(){return new we(this._exit||this._groups.map(O),this._parents)},join:function(e,t,n){var a=this.enter(),i=this,r=this.exit();return"function"==typeof e?(a=e(a))&&(a=a.selection()):a=a.append(e+""),null!=t&&(i=t(i))&&(i=i.selection()),null==n?r.remove():n(r),a&&i?a.merge(i).order():i},merge:function(e){for(var t=e.selection?e.selection():e,n=this._groups,a=t._groups,i=n.length,r=a.length,o=Math.min(i,r),s=new Array(i),c=0;c<o;++c)for(var d,l=n[c],u=a[c],f=l.length,p=s[c]=new Array(f),m=0;m<f;++m)(d=l[m]||u[m])&&(p[m]=d);for(;c<i;++c)s[c]=n[c];return new we(s,this._parents)},selection:function(){return this},order:function(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var a,i=e[t],r=i.length-1,o=i[r];--r>=0;)(a=i[r])&&(o&&4^a.compareDocumentPosition(o)&&o.parentNode.insertBefore(a,o),o=a);return this},sort:function(e){function t(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}e||(e=P);for(var n=this._groups,a=n.length,i=new Array(a),r=0;r<a;++r){for(var o,s=n[r],c=s.length,d=i[r]=new Array(c),l=0;l<c;++l)(o=s[l])&&(d[l]=o);d.sort(t)}return new we(i,this._parents).order()},call:function(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a=e[t],i=0,r=a.length;i<r;++i){var o=a[i];if(o)return o}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(e){for(var t=this._groups,n=0,a=t.length;n<a;++n)for(var i,r=t[n],o=0,s=r.length;o<s;++o)(i=r[o])&&e.call(i,i.__data__,o,r);return this},attr:function(e,t){var n=F(e);if(arguments.length<2){var a=this.node();return n.local?a.getAttributeNS(n.space,n.local):a.getAttribute(n)}return this.each((null==t?n.local?R:H:"function"==typeof t?n.local?V:j:n.local?B:N)(n,t))},style:function(e,t,n){return arguments.length>1?this.each((null==t?G:"function"==typeof t?W:K)(e,t,null==n?"":n)):q(this.node(),e)},property:function(e,t){return arguments.length>1?this.each((null==t?Q:"function"==typeof t?J:Y)(e,t)):this.node()[e]},classed:function(e,t){var n=X(e+"");if(arguments.length<2){for(var a=Z(this.node()),i=-1,r=n.length;++i<r;)if(!a.contains(n[i]))return!1;return!0}return this.each(("function"==typeof t?ie:t?ne:ae)(n,t))},text:function(e){return arguments.length?this.each(null==e?re:("function"==typeof e?se:oe)(e)):this.node().textContent},html:function(e){return arguments.length?this.each(null==e?ce:("function"==typeof e?le:de)(e)):this.node().innerHTML},raise:function(){return this.each(ue)},lower:function(){return this.each(fe)},append:function(e){var t="function"==typeof e?e:_e(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})},insert:function(e,t){var n="function"==typeof e?e:_e(e),a=null==t?he:"function"==typeof t?t:h(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),a.apply(this,arguments)||null)})},remove:function(){return this.each(be)},clone:function(e){return this.select(e?ve:ge)},datum:function(e){return arguments.length?this.property("__data__",e):this.node().__data__},on:function(e,t,n){var a,i,r=ye(e+""),o=r.length;if(!(arguments.length<2)){for(s=t?De:Se,a=0;a<o;++a)this.each(s(r[a],t,n));return this}var s=this.node().__on;if(s)for(var c,d=0,l=s.length;d<l;++d)for(a=0,c=s[d];a<o;++a)if((i=r[a]).type===c.type&&i.name===c.name)return c.value},dispatch:function(e,t){return this.each(("function"==typeof t?Ce:xe)(e,t))},[Symbol.iterator]:function*(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var a,i=e[t],r=0,o=i.length;r<o;++r)(a=i[r])&&(yield a)}};const Ae=Ee;var Le={value:()=>{}};function ke(){for(var e,t=0,n=arguments.length,a={};t<n;++t){if(!(e=arguments[t]+"")||e in a||/[\s.]/.test(e))throw new Error("illegal type: "+e);a[e]=[]}return new Me(a)}function Me(e){this._=e}function Pe(e,t){return e.trim().split(/^|\s+/).map(function(e){var n="",a=e.indexOf(".");if(a>=0&&(n=e.slice(a+1),e=e.slice(0,a)),e&&!t.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:n}})}function Te(e,t){for(var n,a=0,i=e.length;a<i;++a)if((n=e[a]).name===t)return n.value}function Ue(e,t,n){for(var a=0,i=e.length;a<i;++a)if(e[a].name===t){e[a]=Le,e=e.slice(0,a).concat(e.slice(a+1));break}return null!=n&&e.push({name:t,value:n}),e}Me.prototype=ke.prototype={constructor:Me,on:function(e,t){var n,a=this._,i=Pe(e+"",a),r=-1,o=i.length;if(!(arguments.length<2)){if(null!=t&&"function"!=typeof t)throw new Error("invalid callback: "+t);for(;++r<o;)if(n=(e=i[r]).type)a[n]=Ue(a[n],e.name,t);else if(null==t)for(n in a)a[n]=Ue(a[n],e.name,null);return this}for(;++r<o;)if((n=(e=i[r]).type)&&(n=Te(a[n],e.name)))return n},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Me(e)},call:function(e,t){if((n=arguments.length-2)>0)for(var n,a,i=new Array(n),r=0;r<n;++r)i[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(r=0,n=(a=this._[e]).length;r<n;++r)a[r].value.apply(t,i)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var a=this._[e],i=0,r=a.length;i<r;++i)a[i].value.apply(t,n)}};const Fe=ke;var He,Re,Ne=0,Be=0,je=0,Ve=0,ze=0,Ge=0,Ke="object"==typeof performance&&performance.now?performance:Date,We="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function qe(){return ze||(We(Qe),ze=Ke.now()+Ge)}function Qe(){ze=0}function Ye(){this._call=this._time=this._next=null}function Je(e,t,n){var a=new Ye;return a.restart(e,t,n),a}function Xe(){ze=(Ve=Ke.now())+Ge,Ne=Be=0;try{!function(){qe(),++Ne;for(var e,t=He;t;)(e=ze-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ne}()}finally{Ne=0,function(){for(var e,t,n=He,a=1/0;n;)n._call?(a>n._time&&(a=n._time),e=n,n=n._next):(t=n._next,n._next=null,n=e?e._next=t:He=t);Re=e,$e(a)}(),ze=0}}function Ze(){var e=Ke.now(),t=e-Ve;t>1e3&&(Ge-=t,Ve=e)}function $e(e){Ne||(Be&&(Be=clearTimeout(Be)),e-ze>24?(e<1/0&&(Be=setTimeout(Xe,e-Ke.now()-Ge)),je&&(je=clearInterval(je))):(je||(Ve=Ke.now(),je=setInterval(Ze,1e3)),Ne=1,We(Xe)))}function et(e,t,n){var a=new Ye;return t=null==t?0:+t,a.restart(n=>{a.stop(),e(n+t)},t,n),a}Ye.prototype=Je.prototype={constructor:Ye,restart:function(e,t,n){if("function"!=typeof e)throw new TypeError("callback is not a function");n=(null==n?qe():+n)+(null==t?0:+t),this._next||Re===this||(Re?Re._next=this:He=this,Re=this),this._call=e,this._time=n,$e()},stop:function(){this._call&&(this._call=null,this._time=1/0,$e())}};var tt=Fe("start","end","cancel","interrupt"),nt=[];function at(e,t,n,a,i,r){var o=e.__transition;if(o){if(n in o)return}else e.__transition={};!function(e,t,n){var a,i=e.__transition;function r(c){var d,l,u,f;if(1!==n.state)return s();for(d in i)if((f=i[d]).name===n.name){if(3===f.state)return et(r);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",e,e.__data__,f.index,f.group),delete i[d]):+d<t&&(f.state=6,f.timer.stop(),f.on.call("cancel",e,e.__data__,f.index,f.group),delete i[d])}if(et(function(){3===n.state&&(n.state=4,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=2,n.on.call("start",e,e.__data__,n.index,n.group),2===n.state){for(n.state=3,a=new Array(u=n.tween.length),d=0,l=-1;d<u;++d)(f=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(a[++l]=f);a.length=l+1}}function o(t){for(var i=t<n.duration?n.ease.call(null,t/n.duration):(n.timer.restart(s),n.state=5,1),r=-1,o=a.length;++r<o;)a[r].call(e,i);5===n.state&&(n.on.call("end",e,e.__data__,n.index,n.group),s())}function s(){for(var a in n.state=6,n.timer.stop(),delete i[t],i)return;delete e.__transition}i[t]=n,n.timer=Je(function(e){n.state=1,n.timer.restart(r,n.delay,n.time),n.delay<=e&&r(e-n.delay)},0,n.time)}(e,n,{name:t,index:a,group:i,on:tt,tween:nt,time:r.time,delay:r.delay,duration:r.duration,ease:r.ease,timer:null,state:0})}function it(e,t){var n=ot(e,t);if(n.state>0)throw new Error("too late; already scheduled");return n}function rt(e,t){var n=ot(e,t);if(n.state>3)throw new Error("too late; already running");return n}function ot(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function st(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var ct,dt=180/Math.PI,lt={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ut(e,t,n,a,i,r){var o,s,c;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(c=e*n+t*a)&&(n-=e*c,a-=t*c),(s=Math.sqrt(n*n+a*a))&&(n/=s,a/=s,c/=s),e*a<t*n&&(e=-e,t=-t,c=-c,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*dt,skewX:Math.atan(c)*dt,scaleX:o,scaleY:s}}function ft(e,t,n,a){function i(e){return e.length?e.pop()+" ":""}return function(r,o){var s=[],c=[];return r=e(r),o=e(o),function(e,a,i,r,o,s){if(e!==i||a!==r){var c=o.push("translate(",null,t,null,n);s.push({i:c-4,x:st(e,i)},{i:c-2,x:st(a,r)})}else(i||r)&&o.push("translate("+i+t+r+n)}(r.translateX,r.translateY,o.translateX,o.translateY,s,c),function(e,t,n,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:n.push(i(n)+"rotate(",null,a)-2,x:st(e,t)})):t&&n.push(i(n)+"rotate("+t+a)}(r.rotate,o.rotate,s,c),function(e,t,n,r){e!==t?r.push({i:n.push(i(n)+"skewX(",null,a)-2,x:st(e,t)}):t&&n.push(i(n)+"skewX("+t+a)}(r.skewX,o.skewX,s,c),function(e,t,n,a,r,o){if(e!==n||t!==a){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:st(e,n)},{i:s-2,x:st(t,a)})}else 1===n&&1===a||r.push(i(r)+"scale("+n+","+a+")")}(r.scaleX,r.scaleY,o.scaleX,o.scaleY,s,c),r=o=null,function(e){for(var t,n=-1,a=c.length;++n<a;)s[(t=c[n]).i]=t.x(e);return s.join("")}}}var pt=ft(function(e){const t=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?lt:ut(t.a,t.b,t.c,t.d,t.e,t.f)},"px, ","px)","deg)"),mt=ft(function(e){return null==e?lt:(ct||(ct=document.createElementNS("http://www.w3.org/2000/svg","g")),ct.setAttribute("transform",e),(e=ct.transform.baseVal.consolidate())?ut((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):lt)},", ",")",")");function _t(e,t){var n,a;return function(){var i=rt(this,e),r=i.tween;if(r!==n)for(var o=0,s=(a=n=r).length;o<s;++o)if(a[o].name===t){(a=a.slice()).splice(o,1);break}i.tween=a}}function ht(e,t,n){var a,i;if("function"!=typeof n)throw new Error;return function(){var r=rt(this,e),o=r.tween;if(o!==a){i=(a=o).slice();for(var s={name:t,value:n},c=0,d=i.length;c<d;++c)if(i[c].name===t){i[c]=s;break}c===d&&i.push(s)}r.tween=i}}function bt(e,t,n){var a=e._id;return e.each(function(){var e=rt(this,a);(e.value||(e.value={}))[t]=n.apply(this,arguments)}),function(e){return ot(e,a).value[t]}}function gt(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function vt(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function yt(){}var St=.7,Dt=1/St,It="\\s*([+-]?\\d+)\\s*",xt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ot=/^#([0-9a-f]{3,8})$/,wt=new RegExp(`^rgb\\(${It},${It},${It}\\)$`),Et=new RegExp(`^rgb\\(${Ct},${Ct},${Ct}\\)$`),At=new RegExp(`^rgba\\(${It},${It},${It},${xt}\\)$`),Lt=new RegExp(`^rgba\\(${Ct},${Ct},${Ct},${xt}\\)$`),kt=new RegExp(`^hsl\\(${xt},${Ct},${Ct}\\)$`),Mt=new RegExp(`^hsla\\(${xt},${Ct},${Ct},${xt}\\)$`),Pt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Tt(){return this.rgb().formatHex()}function Ut(){return this.rgb().formatRgb()}function Ft(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Ot.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?Ht(t):3===n?new jt(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Rt(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Rt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=wt.exec(e))?new jt(t[1],t[2],t[3],1):(t=Et.exec(e))?new jt(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=At.exec(e))?Rt(t[1],t[2],t[3],t[4]):(t=Lt.exec(e))?Rt(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=kt.exec(e))?qt(t[1],t[2]/100,t[3]/100,1):(t=Mt.exec(e))?qt(t[1],t[2]/100,t[3]/100,t[4]):Pt.hasOwnProperty(e)?Ht(Pt[e]):"transparent"===e?new jt(NaN,NaN,NaN,0):null}function Ht(e){return new jt(e>>16&255,e>>8&255,255&e,1)}function Rt(e,t,n,a){return a<=0&&(e=t=n=NaN),new jt(e,t,n,a)}function Nt(e){return e instanceof yt||(e=Ft(e)),e?new jt((e=e.rgb()).r,e.g,e.b,e.opacity):new jt}function Bt(e,t,n,a){return 1===arguments.length?Nt(e):new jt(e,t,n,null==a?1:a)}function jt(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function Vt(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}`}function zt(){const e=Gt(this.opacity);return`${1===e?"rgb(":"rgba("}${Kt(this.r)}, ${Kt(this.g)}, ${Kt(this.b)}${1===e?")":`, ${e})`}`}function Gt(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Kt(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wt(e){return((e=Kt(e))<16?"0":"")+e.toString(16)}function qt(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Yt(e,t,n,a)}function Qt(e){if(e instanceof Yt)return new Yt(e.h,e.s,e.l,e.opacity);if(e instanceof yt||(e=Ft(e)),!e)return new Yt;if(e instanceof Yt)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,i=Math.min(t,n,a),r=Math.max(t,n,a),o=NaN,s=r-i,c=(r+i)/2;return s?(o=t===r?(n-a)/s+6*(n<a):n===r?(a-t)/s+2:(t-n)/s+4,s/=c<.5?r+i:2-r-i,o*=60):s=c>0&&c<1?0:o,new Yt(o,s,c,e.opacity)}function Yt(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function Jt(e){return(e=(e||0)%360)<0?e+360:e}function Xt(e){return Math.max(0,Math.min(1,e||0))}function Zt(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function $t(e,t,n,a,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*n+(1+3*e+3*r-3*o)*a+o*i)/6}gt(yt,Ft,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Tt,formatHex:Tt,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Qt(this).formatHsl()},formatRgb:Ut,toString:Ut}),gt(jt,Bt,vt(yt,{brighter(e){return e=null==e?Dt:Math.pow(Dt,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=null==e?St:Math.pow(St,e),new jt(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jt(Kt(this.r),Kt(this.g),Kt(this.b),Gt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Vt,formatHex:Vt,formatHex8:function(){return`#${Wt(this.r)}${Wt(this.g)}${Wt(this.b)}${Wt(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:zt,toString:zt})),gt(Yt,function(e,t,n,a){return 1===arguments.length?Qt(e):new Yt(e,t,n,null==a?1:a)},vt(yt,{brighter(e){return e=null==e?Dt:Math.pow(Dt,e),new Yt(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=null==e?St:Math.pow(St,e),new Yt(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new jt(Zt(e>=240?e-240:e+120,i,a),Zt(e,i,a),Zt(e<120?e+240:e-120,i,a),this.opacity)},clamp(){return new Yt(Jt(this.h),Xt(this.s),Xt(this.l),Gt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gt(this.opacity);return`${1===e?"hsl(":"hsla("}${Jt(this.h)}, ${100*Xt(this.s)}%, ${100*Xt(this.l)}%${1===e?")":`, ${e})`}`}}));const en=e=>()=>e;function tn(e,t){return function(n){return e+n*t}}function nn(e,t){var n=t-e;return n?tn(e,n):en(isNaN(e)?t:e)}const an=function e(t){var n=function(e){return 1==(e=+e)?nn:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):en(isNaN(t)?n:t)}}(t);function a(e,t){var a=n((e=Bt(e)).r,(t=Bt(t)).r),i=n(e.g,t.g),r=n(e.b,t.b),o=nn(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=i(t),e.b=r(t),e.opacity=o(t),e+""}}return a.gamma=e,a}(1);function rn(e){return function(t){var n,a,i=t.length,r=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)a=Bt(t[n]),r[n]=a.r||0,o[n]=a.g||0,s[n]=a.b||0;return r=e(r),o=e(o),s=e(s),a.opacity=1,function(e){return a.r=r(e),a.g=o(e),a.b=s(e),a+""}}}rn(function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[a],r=e[a+1],o=a>0?e[a-1]:2*i-r,s=a<t-1?e[a+2]:2*r-i;return $t((n-a/t)*t,o,i,r,s)}}),rn(function(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),i=e[(a+t-1)%t],r=e[a%t],o=e[(a+1)%t],s=e[(a+2)%t];return $t((n-a/t)*t,i,r,o,s)}});var on=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,sn=new RegExp(on.source,"g");function cn(e,t){var n,a,i,r=on.lastIndex=sn.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=on.exec(e))&&(a=sn.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,c.push({i:o,x:st(n,a)})),r=sn.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,a=0;a<t;++a)s[(n=c[a]).i]=n.x(e);return s.join("")})}function dn(e,t){var n;return("number"==typeof t?st:t instanceof Ft?an:(n=Ft(t))?(t=n,an):cn)(e,t)}function ln(e){return function(){this.removeAttribute(e)}}function un(e){return function(){this.removeAttributeNS(e.space,e.local)}}function fn(e,t,n){var a,i,r=n+"";return function(){var o=this.getAttribute(e);return o===r?null:o===a?i:i=t(a=o,n)}}function pn(e,t,n){var a,i,r=n+"";return function(){var o=this.getAttributeNS(e.space,e.local);return o===r?null:o===a?i:i=t(a=o,n)}}function mn(e,t,n){var a,i,r;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttribute(e))===(s=c+"")?null:o===a&&s===i?r:(i=s,r=t(a=o,c));this.removeAttribute(e)}}function _n(e,t,n){var a,i,r;return function(){var o,s,c=n(this);if(null!=c)return(o=this.getAttributeNS(e.space,e.local))===(s=c+"")?null:o===a&&s===i?r:(i=s,r=t(a=o,c));this.removeAttributeNS(e.space,e.local)}}function hn(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function bn(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function gn(e,t){var n,a;function i(){var i=t.apply(this,arguments);return i!==a&&(n=(a=i)&&bn(e,i)),n}return i._value=t,i}function vn(e,t){var n,a;function i(){var i=t.apply(this,arguments);return i!==a&&(n=(a=i)&&hn(e,i)),n}return i._value=t,i}function yn(e,t){return function(){it(this,e).delay=+t.apply(this,arguments)}}function Sn(e,t){return t=+t,function(){it(this,e).delay=t}}function Dn(e,t){return function(){rt(this,e).duration=+t.apply(this,arguments)}}function In(e,t){return t=+t,function(){rt(this,e).duration=t}}function xn(e,t){if("function"!=typeof t)throw new Error;return function(){rt(this,e).ease=t}}function Cn(e,t,n){var a,i,r=function(e){return(e+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||"start"===e})}(t)?it:rt;return function(){var o=r(this,e),s=o.on;s!==a&&(i=(a=s).copy()).on(t,n),o.on=i}}var On=Ae.prototype.constructor;function wn(e){return function(){this.style.removeProperty(e)}}function En(e,t,n){return function(a){this.style.setProperty(e,t.call(this,a),n)}}function An(e,t,n){var a,i;function r(){var r=t.apply(this,arguments);return r!==i&&(a=(i=r)&&En(e,r,n)),a}return r._value=t,r}function Ln(e){return function(t){this.textContent=e.call(this,t)}}function kn(e){var t,n;function a(){var a=e.apply(this,arguments);return a!==n&&(t=(n=a)&&Ln(a)),t}return a._value=e,a}var Mn=0;function Pn(e,t,n,a){this._groups=e,this._parents=t,this._name=n,this._id=a}function Tn(){return++Mn}var Un=Ae.prototype;Pn.prototype=function(e){return Ae().transition(e)}.prototype={constructor:Pn,select:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=h(e));for(var a=this._groups,i=a.length,r=new Array(i),o=0;o<i;++o)for(var s,c,d=a[o],l=d.length,u=r[o]=new Array(l),f=0;f<l;++f)(s=d[f])&&(c=e.call(s,s.__data__,f,d))&&("__data__"in s&&(c.__data__=s.__data__),u[f]=c,at(u[f],t,n,f,u,ot(s,n)));return new Pn(r,this._parents,t,n)},selectAll:function(e){var t=this._name,n=this._id;"function"!=typeof e&&(e=v(e));for(var a=this._groups,i=a.length,r=[],o=[],s=0;s<i;++s)for(var c,d=a[s],l=d.length,u=0;u<l;++u)if(c=d[u]){for(var f,p=e.call(c,c.__data__,u,d),m=ot(c,n),_=0,h=p.length;_<h;++_)(f=p[_])&&at(f,t,n,_,p,m);r.push(p),o.push(c)}return new Pn(r,o,t,n)},selectChild:Un.selectChild,selectChildren:Un.selectChildren,filter:function(e){"function"!=typeof e&&(e=y(e));for(var t=this._groups,n=t.length,a=new Array(n),i=0;i<n;++i)for(var r,o=t[i],s=o.length,c=a[i]=[],d=0;d<s;++d)(r=o[d])&&e.call(r,r.__data__,d,o)&&c.push(r);return new Pn(a,this._parents,this._name,this._id)},merge:function(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,a=t.length,i=n.length,r=Math.min(a,i),o=new Array(a),s=0;s<r;++s)for(var c,d=t[s],l=n[s],u=d.length,f=o[s]=new Array(u),p=0;p<u;++p)(c=d[p]||l[p])&&(f[p]=c);for(;s<a;++s)o[s]=t[s];return new Pn(o,this._parents,this._name,this._id)},selection:function(){return new On(this._groups,this._parents)},transition:function(){for(var e=this._name,t=this._id,n=Tn(),a=this._groups,i=a.length,r=0;r<i;++r)for(var o,s=a[r],c=s.length,d=0;d<c;++d)if(o=s[d]){var l=ot(o,t);at(o,e,n,d,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new Pn(a,this._parents,e,n)},call:Un.call,nodes:Un.nodes,node:Un.node,size:Un.size,empty:Un.empty,each:Un.each,on:function(e,t){var n=this._id;return arguments.length<2?ot(this.node(),n).on.on(e):this.each(Cn(n,e,t))},attr:function(e,t){var n=F(e),a="transform"===n?mt:dn;return this.attrTween(e,"function"==typeof t?(n.local?_n:mn)(n,a,bt(this,"attr."+e,t)):null==t?(n.local?un:ln)(n):(n.local?pn:fn)(n,a,t))},attrTween:function(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==t)return this.tween(n,null);if("function"!=typeof t)throw new Error;var a=F(e);return this.tween(n,(a.local?gn:vn)(a,t))},style:function(e,t,n){var a="transform"==(e+="")?pt:dn;return null==t?this.styleTween(e,function(e,t){var n,a,i;return function(){var r=q(this,e),o=(this.style.removeProperty(e),q(this,e));return r===o?null:r===n&&o===a?i:i=t(n=r,a=o)}}(e,a)).on("end.style."+e,wn(e)):"function"==typeof t?this.styleTween(e,function(e,t,n){var a,i,r;return function(){var o=q(this,e),s=n(this),c=s+"";return null==s&&(this.style.removeProperty(e),c=s=q(this,e)),o===c?null:o===a&&c===i?r:(i=c,r=t(a=o,s))}}(e,a,bt(this,"style."+e,t))).each(function(e,t){var n,a,i,r,o="style."+t,s="end."+o;return function(){var c=rt(this,e),d=c.on,l=null==c.value[o]?r||(r=wn(t)):void 0;d===n&&i===l||(a=(n=d).copy()).on(s,i=l),c.on=a}}(this._id,e)):this.styleTween(e,function(e,t,n){var a,i,r=n+"";return function(){var o=q(this,e);return o===r?null:o===a?i:i=t(a=o,n)}}(e,a,t),n).on("end.style."+e,null)},styleTween:function(e,t,n){var a="style."+(e+="");if(arguments.length<2)return(a=this.tween(a))&&a._value;if(null==t)return this.tween(a,null);if("function"!=typeof t)throw new Error;return this.tween(a,An(e,t,null==n?"":n))},text:function(e){return this.tween("text","function"==typeof e?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(bt(this,"text",e)):function(e){return function(){this.textContent=e}}(null==e?"":e+""))},textTween:function(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(null==e)return this.tween(t,null);if("function"!=typeof e)throw new Error;return this.tween(t,kn(e))},remove:function(){return this.on("end.remove",function(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}(this._id))},tween:function(e,t){var n=this._id;if(e+="",arguments.length<2){for(var a,i=ot(this.node(),n).tween,r=0,o=i.length;r<o;++r)if((a=i[r]).name===e)return a.value;return null}return this.each((null==t?_t:ht)(n,e,t))},delay:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?yn:Sn)(t,e)):ot(this.node(),t).delay},duration:function(e){var t=this._id;return arguments.length?this.each(("function"==typeof e?Dn:In)(t,e)):ot(this.node(),t).duration},ease:function(e){var t=this._id;return arguments.length?this.each(xn(t,e)):ot(this.node(),t).ease},easeVarying:function(e){if("function"!=typeof e)throw new Error;return this.each(function(e,t){return function(){var n=t.apply(this,arguments);if("function"!=typeof n)throw new Error;rt(this,e).ease=n}}(this._id,e))},end:function(){var e,t,n=this,a=n._id,i=n.size();return new Promise(function(r,o){var s={value:o},c={value:function(){0==--i&&r()}};n.each(function(){var n=rt(this,a),i=n.on;i!==e&&((t=(e=i).copy())._.cancel.push(s),t._.interrupt.push(s),t._.end.push(c)),n.on=t}),0===i&&r()})},[Symbol.iterator]:Un[Symbol.iterator]};var Fn={time:null,delay:0,duration:250,ease:function(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}};function Hn(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}Ae.prototype.interrupt=function(e){return this.each(function(){!function(e,t){var n,a,i,r=e.__transition,o=!0;if(r){for(i in t=null==t?null:t+"",r)(n=r[i]).name===t?(a=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(a?"interrupt":"cancel",e,e.__data__,n.index,n.group),delete r[i]):o=!1;o&&delete e.__transition}}(this,e)})},Ae.prototype.transition=function(e){var t,n;e instanceof Pn?(t=e._id,e=e._name):(t=Tn(),(n=Fn).time=qe(),e=null==e?null:e+"");for(var a=this._groups,i=a.length,r=0;r<i;++r)for(var o,s=a[r],c=s.length,d=0;d<c;++d)(o=s[d])&&at(o,e,t,d,s,n||Hn(o,t));return new Pn(a,this._parents,e,t)};const{abs:Rn,max:Nn,min:Bn}=Math;function jn(e){return{type:e}}function Vn(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function zn(e){return(t,n)=>function(e,t){return fetch(e,t).then(Vn)}(t,n).then(t=>(new DOMParser).parseFromString(t,e))}["w","e"].map(jn),["n","s"].map(jn),["n","w","e","s","nw","ne","sw","se"].map(jn),zn("application/xml"),zn("text/html");var Gn=zn("image/svg+xml");const Kn=Math.PI/180,Wn=180/Math.PI,qn=.96422,Qn=.82521,Yn=4/29,Jn=6/29,Xn=3*Jn*Jn;function Zn(e){if(e instanceof $n)return new $n(e.l,e.a,e.b,e.opacity);if(e instanceof oa)return sa(e);e instanceof jt||(e=Nt(e));var t,n,a=aa(e.r),i=aa(e.g),r=aa(e.b),o=ea((.2225045*a+.7168786*i+.0606169*r)/1);return a===i&&i===r?t=n=o:(t=ea((.4360747*a+.3850649*i+.1430804*r)/qn),n=ea((.0139322*a+.0971045*i+.7141733*r)/Qn)),new $n(116*o-16,500*(t-o),200*(o-n),e.opacity)}function $n(e,t,n,a){this.l=+e,this.a=+t,this.b=+n,this.opacity=+a}function ea(e){return e>.008856451679035631?Math.pow(e,1/3):e/Xn+Yn}function ta(e){return e>Jn?e*e*e:Xn*(e-Yn)}function na(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function aa(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function ia(e){if(e instanceof oa)return new oa(e.h,e.c,e.l,e.opacity);if(e instanceof $n||(e=Zn(e)),0===e.a&&0===e.b)return new oa(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Wn;return new oa(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function ra(e,t,n,a){return 1===arguments.length?ia(e):new oa(e,t,n,null==a?1:a)}function oa(e,t,n,a){this.h=+e,this.c=+t,this.l=+n,this.opacity=+a}function sa(e){if(isNaN(e.h))return new $n(e.l,0,0,e.opacity);var t=e.h*Kn;return new $n(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}function ca(e){return function(t,n){var a=e((t=ra(t)).h,(n=ra(n)).h),i=nn(t.c,n.c),r=nn(t.l,n.l),o=nn(t.opacity,n.opacity);return function(e){return t.h=a(e),t.c=i(e),t.l=r(e),t.opacity=o(e),t+""}}}gt($n,function(e,t,n,a){return 1===arguments.length?Zn(e):new $n(e,t,n,null==a?1:a)},vt(yt,{brighter(e){return new $n(this.l+18*(null==e?1:e),this.a,this.b,this.opacity)},darker(e){return new $n(this.l-18*(null==e?1:e),this.a,this.b,this.opacity)},rgb(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return new jt(na(3.1338561*(t=qn*ta(t))-1.6168667*(e=1*ta(e))-.4906146*(n=Qn*ta(n))),na(-.9787684*t+1.9161415*e+.033454*n),na(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}})),gt(oa,ra,vt(yt,{brighter(e){return new oa(this.h,this.c,this.l+18*(null==e?1:e),this.opacity)},darker(e){return new oa(this.h,this.c,this.l-18*(null==e?1:e),this.opacity)},rgb(){return sa(this).rgb()}}));const da=ca(function(e,t){var n=t-e;return n?tn(e,n>180||n<-180?n-360*Math.round(n/360):n):en(isNaN(e)?t:e)});function la(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var a=-1,i=0|Math.max(0,Math.ceil((t-e)/n)),r=new Array(i);++a<i;)r[a]=e+a*n;return r}function ua(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e)}return this}ca(nn);class fa extends Map{constructor(e,t=ma){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),null!=e)for(const[t,n]of e)this.set(t,n)}get(e){return super.get(pa(this,e))}has(e){return super.has(pa(this,e))}set(e,t){return super.set(function({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):(e.set(a,n),n)}(this,e),t)}delete(e){return super.delete(function({_intern:e,_key:t},n){const a=t(n);return e.has(a)&&(n=e.get(n),e.delete(a)),n}(this,e))}}function pa({_intern:e,_key:t},n){const a=t(n);return e.has(a)?e.get(a):n}function ma(e){return null!==e&&"object"==typeof e?e.valueOf():e}Set;const _a=Symbol("implicit");function ha(){var e=new fa,t=[],n=[],a=_a;function i(i){let r=e.get(i);if(void 0===r){if(a!==_a)return a;e.set(i,r=t.push(i)-1)}return n[r%n.length]}return i.domain=function(n){if(!arguments.length)return t.slice();t=[],e=new fa;for(const a of n)e.has(a)||e.set(a,t.push(a)-1);return i},i.range=function(e){return arguments.length?(n=Array.from(e),i):n.slice()},i.unknown=function(e){return arguments.length?(a=e,i):a},i.copy=function(){return ha(t,n).unknown(a)},ua.apply(i,arguments),i}function ba(){var e,t,n=ha().unknown(void 0),a=n.domain,i=n.range,r=0,o=1,s=!1,c=0,d=0,l=.5;function u(){var n=a().length,u=o<r,f=u?o:r,p=u?r:o;e=(p-f)/Math.max(1,n-c+2*d),s&&(e=Math.floor(e)),f+=(p-f-e*(n-c))*l,t=e*(1-c),s&&(f=Math.round(f),t=Math.round(t));var m=la(n).map(function(t){return f+e*t});return i(u?m.reverse():m)}return delete n.unknown,n.domain=function(e){return arguments.length?(a(e),u()):a()},n.range=function(e){return arguments.length?([r,o]=e,r=+r,o=+o,u()):[r,o]},n.rangeRound=function(e){return[r,o]=e,r=+r,o=+o,s=!0,u()},n.bandwidth=function(){return t},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,u()):s},n.padding=function(e){return arguments.length?(c=Math.min(1,d=+e),u()):c},n.paddingInner=function(e){return arguments.length?(c=Math.min(1,e),u()):c},n.paddingOuter=function(e){return arguments.length?(d=+e,u()):d},n.align=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),u()):l},n.copy=function(){return ba(a(),[r,o]).round(s).paddingInner(c).paddingOuter(d).align(l)},ua.apply(u(),arguments)}var ga=Math.sqrt(50),va=Math.sqrt(10),ya=Math.sqrt(2);function Sa(e,t,n){var a=(t-e)/Math.max(0,n),i=Math.floor(Math.log(a)/Math.LN10),r=a/Math.pow(10,i);return i>=0?(r>=ga?10:r>=va?5:r>=ya?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(r>=ga?10:r>=va?5:r>=ya?2:1)}function Da(e,t,n){var a=Math.abs(t-e)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(a)/Math.LN10)),r=a/i;return r>=ga?i*=10:r>=va?i*=5:r>=ya&&(i*=2),t<e?-i:i}function Ia(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xa(e){let t=e,n=e;function a(e,t,a,i){for(null==a&&(a=0),null==i&&(i=e.length);a<i;){const r=a+i>>>1;n(e[r],t)<0?a=r+1:i=r}return a}return 1===e.length&&(t=(t,n)=>e(t)-n,n=function(e){return(t,n)=>Ia(e(t),n)}(e)),{left:a,center:function(e,n,i,r){null==i&&(i=0),null==r&&(r=e.length);const o=a(e,n,i,r-1);return o>i&&t(e[o-1],n)>-t(e[o],n)?o-1:o},right:function(e,t,a,i){for(null==a&&(a=0),null==i&&(i=e.length);a<i;){const r=a+i>>>1;n(e[r],t)>0?i=r:a=r+1}return a}}}const Ca=xa(Ia),Oa=Ca.right,wa=(Ca.left,xa(function(e){return null===e?NaN:+e}).center,Oa);function Ea(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Aa(e,t){var n=Object.create(e.prototype);for(var a in t)n[a]=t[a];return n}function La(){}var ka=.7,Ma=1/ka,Pa="\\s*([+-]?\\d+)\\s*",Ta="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ua="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Fa=/^#([0-9a-f]{3,8})$/,Ha=new RegExp("^rgb\\("+[Pa,Pa,Pa]+"\\)$"),Ra=new RegExp("^rgb\\("+[Ua,Ua,Ua]+"\\)$"),Na=new RegExp("^rgba\\("+[Pa,Pa,Pa,Ta]+"\\)$"),Ba=new RegExp("^rgba\\("+[Ua,Ua,Ua,Ta]+"\\)$"),ja=new RegExp("^hsl\\("+[Ta,Ua,Ua]+"\\)$"),Va=new RegExp("^hsla\\("+[Ta,Ua,Ua,Ta]+"\\)$"),za={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Ga(){return this.rgb().formatHex()}function Ka(){return this.rgb().formatRgb()}function Wa(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Fa.exec(e))?(n=t[1].length,t=parseInt(t[1],16),6===n?qa(t):3===n?new Xa(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===n?Qa(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===n?Qa(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=Ha.exec(e))?new Xa(t[1],t[2],t[3],1):(t=Ra.exec(e))?new Xa(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=Na.exec(e))?Qa(t[1],t[2],t[3],t[4]):(t=Ba.exec(e))?Qa(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=ja.exec(e))?ti(t[1],t[2]/100,t[3]/100,1):(t=Va.exec(e))?ti(t[1],t[2]/100,t[3]/100,t[4]):za.hasOwnProperty(e)?qa(za[e]):"transparent"===e?new Xa(NaN,NaN,NaN,0):null}function qa(e){return new Xa(e>>16&255,e>>8&255,255&e,1)}function Qa(e,t,n,a){return a<=0&&(e=t=n=NaN),new Xa(e,t,n,a)}function Ya(e){return e instanceof La||(e=Wa(e)),e?new Xa((e=e.rgb()).r,e.g,e.b,e.opacity):new Xa}function Ja(e,t,n,a){return 1===arguments.length?Ya(e):new Xa(e,t,n,null==a?1:a)}function Xa(e,t,n,a){this.r=+e,this.g=+t,this.b=+n,this.opacity=+a}function Za(){return"#"+ei(this.r)+ei(this.g)+ei(this.b)}function $a(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function ei(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function ti(e,t,n,a){return a<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ai(e,t,n,a)}function ni(e){if(e instanceof ai)return new ai(e.h,e.s,e.l,e.opacity);if(e instanceof La||(e=Wa(e)),!e)return new ai;if(e instanceof ai)return e;var t=(e=e.rgb()).r/255,n=e.g/255,a=e.b/255,i=Math.min(t,n,a),r=Math.max(t,n,a),o=NaN,s=r-i,c=(r+i)/2;return s?(o=t===r?(n-a)/s+6*(n<a):n===r?(a-t)/s+2:(t-n)/s+4,s/=c<.5?r+i:2-r-i,o*=60):s=c>0&&c<1?0:o,new ai(o,s,c,e.opacity)}function ai(e,t,n,a){this.h=+e,this.s=+t,this.l=+n,this.opacity=+a}function ii(e,t,n){return 255*(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)}function ri(e,t,n,a,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*n+(1+3*e+3*r-3*o)*a+o*i)/6}Ea(La,Wa,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:Ga,formatHex:Ga,formatHsl:function(){return ni(this).formatHsl()},formatRgb:Ka,toString:Ka}),Ea(Xa,Ja,Aa(La,{brighter:function(e){return e=null==e?Ma:Math.pow(Ma,e),new Xa(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?ka:Math.pow(ka,e),new Xa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Za,formatHex:Za,formatRgb:$a,toString:$a})),Ea(ai,function(e,t,n,a){return 1===arguments.length?ni(e):new ai(e,t,n,null==a?1:a)},Aa(La,{brighter:function(e){return e=null==e?Ma:Math.pow(Ma,e),new ai(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?ka:Math.pow(ka,e),new ai(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,a=n+(n<.5?n:1-n)*t,i=2*n-a;return new Xa(ii(e>=240?e-240:e+120,i,a),ii(e,i,a),ii(e<120?e+240:e-120,i,a),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));const oi=e=>()=>e;function si(e,t){var n=t-e;return n?function(e,t){return function(n){return e+n*t}}(e,n):oi(isNaN(e)?t:e)}const ci=function e(t){var n=function(e){return 1==(e=+e)?si:function(t,n){return n-t?function(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(a){return Math.pow(e+a*t,n)}}(t,n,e):oi(isNaN(t)?n:t)}}(t);function a(e,t){var a=n((e=Ja(e)).r,(t=Ja(t)).r),i=n(e.g,t.g),r=n(e.b,t.b),o=si(e.opacity,t.opacity);return function(t){return e.r=a(t),e.g=i(t),e.b=r(t),e.opacity=o(t),e+""}}return a.gamma=e,a}(1);function di(e){return function(t){var n,a,i=t.length,r=new Array(i),o=new Array(i),s=new Array(i);for(n=0;n<i;++n)a=Ja(t[n]),r[n]=a.r||0,o[n]=a.g||0,s[n]=a.b||0;return r=e(r),o=e(o),s=e(s),a.opacity=1,function(e){return a.r=r(e),a.g=o(e),a.b=s(e),a+""}}}function li(e,t){var n,a=t?t.length:0,i=e?Math.min(a,e.length):0,r=new Array(i),o=new Array(a);for(n=0;n<i;++n)r[n]=gi(e[n],t[n]);for(;n<a;++n)o[n]=t[n];return function(e){for(n=0;n<i;++n)o[n]=r[n](e);return o}}function ui(e,t){var n=new Date;return e=+e,t=+t,function(a){return n.setTime(e*(1-a)+t*a),n}}function fi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function pi(e,t){var n,a={},i={};for(n in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)n in e?a[n]=gi(e[n],t[n]):i[n]=t[n];return function(e){for(n in a)i[n]=a[n](e);return i}}di(function(e){var t=e.length-1;return function(n){var a=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),i=e[a],r=e[a+1],o=a>0?e[a-1]:2*i-r,s=a<t-1?e[a+2]:2*r-i;return ri((n-a/t)*t,o,i,r,s)}}),di(function(e){var t=e.length;return function(n){var a=Math.floor(((n%=1)<0?++n:n)*t),i=e[(a+t-1)%t],r=e[a%t],o=e[(a+1)%t],s=e[(a+2)%t];return ri((n-a/t)*t,i,r,o,s)}});var mi=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,_i=new RegExp(mi.source,"g");function hi(e,t){var n,a,i,r=mi.lastIndex=_i.lastIndex=0,o=-1,s=[],c=[];for(e+="",t+="";(n=mi.exec(e))&&(a=_i.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(n=n[0])===(a=a[0])?s[o]?s[o]+=a:s[++o]=a:(s[++o]=null,c.push({i:o,x:fi(n,a)})),r=_i.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?c[0]?function(e){return function(t){return e(t)+""}}(c[0].x):function(e){return function(){return e}}(t):(t=c.length,function(e){for(var n,a=0;a<t;++a)s[(n=c[a]).i]=n.x(e);return s.join("")})}function bi(e,t){t||(t=[]);var n,a=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(n=0;n<a;++n)i[n]=e[n]*(1-r)+t[n]*r;return i}}function gi(e,t){var n,a,i=typeof t;return null==t||"boolean"===i?oi(t):("number"===i?fi:"string"===i?(n=Wa(t))?(t=n,ci):hi:t instanceof Wa?ci:t instanceof Date?ui:(a=t,!ArrayBuffer.isView(a)||a instanceof DataView?Array.isArray(t)?li:"function"!=typeof t.valueOf&&"function"!=typeof t.toString||isNaN(t)?pi:fi:bi))(e,t)}function vi(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function yi(e){return+e}var Si=[0,1];function Di(e){return e}function Ii(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:(n=isNaN(t)?NaN:.5,function(){return n});var n}function xi(e,t,n){var a=e[0],i=e[1],r=t[0],o=t[1];return i<a?(a=Ii(i,a),r=n(o,r)):(a=Ii(a,i),r=n(r,o)),function(e){return r(a(e))}}function Ci(e,t,n){var a=Math.min(e.length,t.length)-1,i=new Array(a),r=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)i[o]=Ii(e[o],e[o+1]),r[o]=n(t[o],t[o+1]);return function(t){var n=wa(e,t,1,a)-1;return r[n](i[n](t))}}function Oi(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function wi(){return function(){var e,t,n,a,i,r,o=Si,s=Si,c=gi,d=Di;function l(){var e,t,n,c=Math.min(o.length,s.length);return d!==Di&&(e=o[0],t=o[c-1],e>t&&(n=e,e=t,t=n),d=function(n){return Math.max(e,Math.min(t,n))}),a=c>2?Ci:xi,i=r=null,u}function u(t){return null==t||isNaN(t=+t)?n:(i||(i=a(o.map(e),s,c)))(e(d(t)))}return u.invert=function(n){return d(t((r||(r=a(s,o.map(e),fi)))(n)))},u.domain=function(e){return arguments.length?(o=Array.from(e,yi),l()):o.slice()},u.range=function(e){return arguments.length?(s=Array.from(e),l()):s.slice()},u.rangeRound=function(e){return s=Array.from(e),c=vi,l()},u.clamp=function(e){return arguments.length?(d=!!e||Di,l()):d!==Di},u.interpolate=function(e){return arguments.length?(c=e,l()):c},u.unknown=function(e){return arguments.length?(n=e,u):n},function(n,a){return e=n,t=a,l()}}()(Di,Di)}var Ei,Ai=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Li(e){if(!(t=Ai.exec(e)))throw new Error("invalid format: "+e);var t;return new ki({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function ki(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function Mi(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,a=e.slice(0,n);return[a.length>1?a[0]+a.slice(2):a,+e.slice(n+1)]}function Pi(e){return(e=Mi(Math.abs(e)))?e[1]:NaN}function Ti(e,t){var n=Mi(e,t);if(!n)return e+"";var a=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}Li.prototype=ki.prototype,ki.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const Ui={"%":(e,t)=>(100*e).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:function(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)},e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Ti(100*e,t),r:Ti,s:function(e,t){var n=Mi(e,t);if(!n)return e+"";var a=n[0],i=n[1],r=i-(Ei=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,o=a.length;return r===o?a:r>o?a+new Array(r-o+1).join("0"):r>0?a.slice(0,r)+"."+a.slice(r):"0."+new Array(1-r).join("0")+Mi(e,Math.max(0,t+r-1))[0]},X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Fi(e){return e}var Hi,Ri,Ni,Bi=Array.prototype.map,ji=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Vi(e){var t=e.domain;return e.ticks=function(e){var n=t();return function(e,t,n){var a,i,r,o,s=-1;if(n=+n,(e=+e)==(t=+t)&&n>0)return[e];if((a=t<e)&&(i=e,e=t,t=i),0===(o=Sa(e,t,n))||!isFinite(o))return[];if(o>0){let n=Math.round(e/o),a=Math.round(t/o);for(n*o<e&&++n,a*o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)*o}else{o=-o;let n=Math.round(e*o),a=Math.round(t*o);for(n/o<e&&++n,a/o>t&&--a,r=new Array(i=a-n+1);++s<i;)r[s]=(n+s)/o}return a&&r.reverse(),r}(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,n){var a=t();return function(e,t,n,a){var i,r=Da(e,t,n);switch((a=Li(null==a?",f":a)).type){case"s":var o=Math.max(Math.abs(e),Math.abs(t));return null!=a.precision||isNaN(i=function(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(Pi(t)/3)))-Pi(Math.abs(e)))}(r,o))||(a.precision=i),Ni(a,o);case"":case"e":case"g":case"p":case"r":null!=a.precision||isNaN(i=function(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Pi(t)-Pi(e))+1}(r,Math.max(Math.abs(e),Math.abs(t))))||(a.precision=i-("e"===a.type));break;case"f":case"%":null!=a.precision||isNaN(i=function(e){return Math.max(0,-Pi(Math.abs(e)))}(r))||(a.precision=i-2*("%"===a.type))}return Ri(a)}(a[0],a[a.length-1],null==e?10:e,n)},e.nice=function(n){null==n&&(n=10);var a,i,r=t(),o=0,s=r.length-1,c=r[o],d=r[s],l=10;for(d<c&&(i=c,c=d,d=i,i=o,o=s,s=i);l-- >0;){if((i=Sa(c,d,n))===a)return r[o]=c,r[s]=d,t(r);if(i>0)c=Math.floor(c/i)*i,d=Math.ceil(d/i)*i;else{if(!(i<0))break;c=Math.ceil(c*i)/i,d=Math.floor(d*i)/i}a=i}return e},e}function zi(){var e=wi();return e.copy=function(){return Oi(e,zi())},ua.apply(e,arguments),Vi(e)}Hi=function(e){var t,n,a=void 0===e.grouping||void 0===e.thousands?Fi:(t=Bi.call(e.grouping,Number),n=e.thousands+"",function(e,a){for(var i=e.length,r=[],o=0,s=t[0],c=0;i>0&&s>0&&(c+s+1>a&&(s=Math.max(1,a-c)),r.push(e.substring(i-=s,i+s)),!((c+=s+1)>a));)s=t[o=(o+1)%t.length];return r.reverse().join(n)}),i=void 0===e.currency?"":e.currency[0]+"",r=void 0===e.currency?"":e.currency[1]+"",o=void 0===e.decimal?".":e.decimal+"",s=void 0===e.numerals?Fi:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Bi.call(e.numerals,String)),c=void 0===e.percent?"%":e.percent+"",d=void 0===e.minus?"":e.minus+"",l=void 0===e.nan?"NaN":e.nan+"";function u(e){var t=(e=Li(e)).fill,n=e.align,u=e.sign,f=e.symbol,p=e.zero,m=e.width,_=e.comma,h=e.precision,b=e.trim,g=e.type;"n"===g?(_=!0,g="g"):Ui[g]||(void 0===h&&(h=12),b=!0,g="g"),(p||"0"===t&&"="===n)&&(p=!0,t="0",n="=");var v="$"===f?i:"#"===f&&/[boxX]/.test(g)?"0"+g.toLowerCase():"",y="$"===f?r:/[%p]/.test(g)?c:"",S=Ui[g],D=/[defgprs%]/.test(g);function I(e){var i,r,c,f=v,I=y;if("c"===g)I=S(e)+I,e="";else{var x=(e=+e)<0||1/e<0;if(e=isNaN(e)?l:S(Math.abs(e),h),b&&(e=function(e){e:for(var t,n=e.length,a=1,i=-1;a<n;++a)switch(e[a]){case".":i=t=a;break;case"0":0===i&&(i=a),t=a;break;default:if(!+e[a])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}(e)),x&&0==+e&&"+"!==u&&(x=!1),f=(x?"("===u?u:d:"-"===u||"("===u?"":u)+f,I=("s"===g?ji[8+Ei/3]:"")+I+(x&&"("===u?")":""),D)for(i=-1,r=e.length;++i<r;)if(48>(c=e.charCodeAt(i))||c>57){I=(46===c?o+e.slice(i+1):e.slice(i))+I,e=e.slice(0,i);break}}_&&!p&&(e=a(e,1/0));var C=f.length+e.length+I.length,O=C<m?new Array(m-C+1).join(t):"";switch(_&&p&&(e=a(O+e,O.length?m-I.length:1/0),O=""),n){case"<":e=f+e+I+O;break;case"=":e=f+O+e+I;break;case"^":e=O.slice(0,C=O.length>>1)+f+e+I+O.slice(C);break;default:e=O+f+e+I}return s(e)}return h=void 0===h?6:/[gprs]/.test(g)?Math.max(1,Math.min(21,h)):Math.max(0,Math.min(20,h)),I.toString=function(){return e+""},I}return{format:u,formatPrefix:function(e,t){var n=u(((e=Li(e)).type="f",e)),a=3*Math.max(-8,Math.min(8,Math.floor(Pi(t)/3))),i=Math.pow(10,-a),r=ji[8+a/3];return function(e){return n(i*e)+r}}}}({thousands:",",grouping:[3],currency:["$",""]}),Ri=Hi.format,Ni=Hi.formatPrefix;const Gi=1e3,Ki=6e4,Wi=36e5,qi=864e5,Qi=6048e5,Yi=31536e6;var Ji=new Date,Xi=new Date;function Zi(e,t,n,a){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=function(t){return e(t=new Date(+t)),t},i.ceil=function(n){return e(n=new Date(n-1)),t(n,1),e(n),n},i.round=function(e){var t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},i.range=function(n,a,r){var o,s=[];if(n=i.ceil(n),r=null==r?1:Math.floor(r),!(n<a&&r>0))return s;do{s.push(o=new Date(+n)),t(n,r),e(n)}while(o<n&&n<a);return s},i.filter=function(n){return Zi(function(t){if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););})},n&&(i.count=function(t,a){return Ji.setTime(+t),Xi.setTime(+a),e(Ji),e(Xi),Math.floor(n(Ji,Xi))},i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(a?function(t){return a(t)%e==0}:function(t){return i.count(0,t)%e==0}):i:null}),i}var $i=Zi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});$i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?Zi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):$i:null};const er=$i;$i.range;var tr=Zi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*Gi)},function(e,t){return(t-e)/Gi},function(e){return e.getUTCSeconds()});const nr=tr;tr.range;var ar=Zi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gi)},function(e,t){e.setTime(+e+t*Ki)},function(e,t){return(t-e)/Ki},function(e){return e.getMinutes()});const ir=ar;ar.range;var rr=Zi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*Gi-e.getMinutes()*Ki)},function(e,t){e.setTime(+e+t*Wi)},function(e,t){return(t-e)/Wi},function(e){return e.getHours()});const or=rr;rr.range;var sr=Zi(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ki)/qi,e=>e.getDate()-1);const cr=sr;function dr(e){return Zi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ki)/Qi})}sr.range;var lr=dr(0),ur=dr(1),fr=dr(2),pr=dr(3),mr=dr(4),_r=dr(5),hr=dr(6),br=(lr.range,ur.range,fr.range,pr.range,mr.range,_r.range,hr.range,Zi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}));const gr=br;br.range;var vr=Zi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});vr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Zi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)}):null};const yr=vr;vr.range;var Sr=Zi(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Ki)},function(e,t){return(t-e)/Ki},function(e){return e.getUTCMinutes()});const Dr=Sr;Sr.range;var Ir=Zi(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*Wi)},function(e,t){return(t-e)/Wi},function(e){return e.getUTCHours()});const xr=Ir;Ir.range;var Cr=Zi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/qi},function(e){return e.getUTCDate()-1});const Or=Cr;function wr(e){return Zi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/Qi})}Cr.range;var Er=wr(0),Ar=wr(1),Lr=wr(2),kr=wr(3),Mr=wr(4),Pr=wr(5),Tr=wr(6),Ur=(Er.range,Ar.range,Lr.range,kr.range,Mr.range,Pr.range,Tr.range,Zi(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}));const Fr=Ur;Ur.range;var Hr=Zi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Hr.every=function(e){return isFinite(e=Math.floor(e))&&e>0?Zi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null};const Rr=Hr;function Nr(e,t,n,a,i,r){const o=[[nr,1,Gi],[nr,5,5e3],[nr,15,15e3],[nr,30,3e4],[r,1,Ki],[r,5,3e5],[r,15,9e5],[r,30,18e5],[i,1,Wi],[i,3,108e5],[i,6,216e5],[i,12,432e5],[a,1,qi],[a,2,1728e5],[n,1,Qi],[t,1,2592e6],[t,3,7776e6],[e,1,Yi]];function s(t,n,a){const i=Math.abs(n-t)/a,r=xa(([,,e])=>e).right(o,i);if(r===o.length)return e.every(Da(t/Yi,n/Yi,a));if(0===r)return er.every(Math.max(Da(t,n,a),1));const[s,c]=o[i/o[r-1][2]<o[r][2]/i?r-1:r];return s.every(c)}return[function(e,t,n){const a=t<e;a&&([e,t]=[t,e]);const i=n&&"function"==typeof n.range?n:s(e,t,n),r=i?i.range(e,+t+1):[];return a?r.reverse():r},s]}Hr.range;const[Br,jr]=Nr(Rr,Fr,Er,Or,xr,Dr),[Vr,zr]=Nr(yr,gr,lr,cr,or,ir);function Gr(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Kr(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Wr(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}var qr,Qr,Yr={"-":"",_:" ",0:"0"},Jr=/^\s*\d+/,Xr=/^%/,Zr=/[\\^$*+?|[\]().{}]/g;function $r(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",r=i.length;return a+(r<n?new Array(n-r+1).join(t)+i:i)}function eo(e){return e.replace(Zr,"\\$&")}function to(e){return new RegExp("^(?:"+e.map(eo).join("|")+")","i")}function no(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function ao(e,t,n){var a=Jr.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function io(e,t,n){var a=Jr.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function ro(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function oo(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function so(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function co(e,t,n){var a=Jr.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function lo(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function uo(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function fo(e,t,n){var a=Jr.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function po(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function mo(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function _o(e,t,n){var a=Jr.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function ho(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function bo(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function go(e,t,n){var a=Jr.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function vo(e,t,n){var a=Jr.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function yo(e,t,n){var a=Jr.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function So(e,t,n){var a=Xr.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function Do(e,t,n){var a=Jr.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function Io(e,t,n){var a=Jr.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function xo(e,t){return $r(e.getDate(),t,2)}function Co(e,t){return $r(e.getHours(),t,2)}function Oo(e,t){return $r(e.getHours()%12||12,t,2)}function wo(e,t){return $r(1+cr.count(yr(e),e),t,3)}function Eo(e,t){return $r(e.getMilliseconds(),t,3)}function Ao(e,t){return Eo(e,t)+"000"}function Lo(e,t){return $r(e.getMonth()+1,t,2)}function ko(e,t){return $r(e.getMinutes(),t,2)}function Mo(e,t){return $r(e.getSeconds(),t,2)}function Po(e){var t=e.getDay();return 0===t?7:t}function To(e,t){return $r(lr.count(yr(e)-1,e),t,2)}function Uo(e){var t=e.getDay();return t>=4||0===t?mr(e):mr.ceil(e)}function Fo(e,t){return e=Uo(e),$r(mr.count(yr(e),e)+(4===yr(e).getDay()),t,2)}function Ho(e){return e.getDay()}function Ro(e,t){return $r(ur.count(yr(e)-1,e),t,2)}function No(e,t){return $r(e.getFullYear()%100,t,2)}function Bo(e,t){return $r((e=Uo(e)).getFullYear()%100,t,2)}function jo(e,t){return $r(e.getFullYear()%1e4,t,4)}function Vo(e,t){var n=e.getDay();return $r((e=n>=4||0===n?mr(e):mr.ceil(e)).getFullYear()%1e4,t,4)}function zo(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+$r(t/60|0,"0",2)+$r(t%60,"0",2)}function Go(e,t){return $r(e.getUTCDate(),t,2)}function Ko(e,t){return $r(e.getUTCHours(),t,2)}function Wo(e,t){return $r(e.getUTCHours()%12||12,t,2)}function qo(e,t){return $r(1+Or.count(Rr(e),e),t,3)}function Qo(e,t){return $r(e.getUTCMilliseconds(),t,3)}function Yo(e,t){return Qo(e,t)+"000"}function Jo(e,t){return $r(e.getUTCMonth()+1,t,2)}function Xo(e,t){return $r(e.getUTCMinutes(),t,2)}function Zo(e,t){return $r(e.getUTCSeconds(),t,2)}function $o(e){var t=e.getUTCDay();return 0===t?7:t}function es(e,t){return $r(Er.count(Rr(e)-1,e),t,2)}function ts(e){var t=e.getUTCDay();return t>=4||0===t?Mr(e):Mr.ceil(e)}function ns(e,t){return e=ts(e),$r(Mr.count(Rr(e),e)+(4===Rr(e).getUTCDay()),t,2)}function as(e){return e.getUTCDay()}function is(e,t){return $r(Ar.count(Rr(e)-1,e),t,2)}function rs(e,t){return $r(e.getUTCFullYear()%100,t,2)}function os(e,t){return $r((e=ts(e)).getUTCFullYear()%100,t,2)}function ss(e,t){return $r(e.getUTCFullYear()%1e4,t,4)}function cs(e,t){var n=e.getUTCDay();return $r((e=n>=4||0===n?Mr(e):Mr.ceil(e)).getUTCFullYear()%1e4,t,4)}function ds(){return"+0000"}function ls(){return"%"}function us(e){return+e}function fs(e){return Math.floor(+e/1e3)}function ps(e){return new Date(e)}function ms(e){return e instanceof Date?+e:+new Date(+e)}function _s(e,t,n,a,i,r,o,s,c,d){var l=wi(),u=l.invert,f=l.domain,p=d(".%L"),m=d(":%S"),_=d("%I:%M"),h=d("%I %p"),b=d("%a %d"),g=d("%b %d"),v=d("%B"),y=d("%Y");function S(e){return(c(e)<e?p:s(e)<e?m:o(e)<e?_:r(e)<e?h:a(e)<e?i(e)<e?b:g:n(e)<e?v:y)(e)}return l.invert=function(e){return new Date(u(e))},l.domain=function(e){return arguments.length?f(Array.from(e,ms)):f().map(ps)},l.ticks=function(t){var n=f();return e(n[0],n[n.length-1],null==t?10:t)},l.tickFormat=function(e,t){return null==t?S:d(t)},l.nice=function(e){var n=f();return e&&"function"==typeof e.range||(e=t(n[0],n[n.length-1],null==e?10:e)),e?f(function(e,t){var n,a=0,i=(e=e.slice()).length-1,r=e[a],o=e[i];return o<r&&(n=a,a=i,i=n,n=r,r=o,o=n),e[a]=t.floor(r),e[i]=t.ceil(o),e}(n,e)):l},l.copy=function(){return Oi(l,_s(e,t,n,a,i,r,o,s,c,d))},l}function hs(){return ua.apply(_s(Vr,zr,yr,gr,lr,cr,or,ir,nr,Qr).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}qr=function(e){var t=e.dateTime,n=e.date,a=e.time,i=e.periods,r=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,d=to(i),l=no(i),u=to(r),f=no(r),p=to(o),m=no(o),_=to(s),h=no(s),b=to(c),g=no(c),v={a:function(e){return o[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:xo,e:xo,f:Ao,g:Bo,G:Vo,H:Co,I:Oo,j:wo,L:Eo,m:Lo,M:ko,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:us,s:fs,S:Mo,u:Po,U:To,V:Fo,w:Ho,W:Ro,x:null,X:null,y:No,Y:jo,Z:zo,"%":ls},y={a:function(e){return o[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:Go,e:Go,f:Yo,g:os,G:cs,H:Ko,I:Wo,j:qo,L:Qo,m:Jo,M:Xo,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:us,s:fs,S:Zo,u:$o,U:es,V:ns,w:as,W:is,x:null,X:null,y:rs,Y:ss,Z:ds,"%":ls},S={a:function(e,t,n){var a=p.exec(t.slice(n));return a?(e.w=m.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=u.exec(t.slice(n));return a?(e.w=f.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=b.exec(t.slice(n));return a?(e.m=g.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=_.exec(t.slice(n));return a?(e.m=h.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,n,a){return x(e,t,n,a)},d:mo,e:mo,f:yo,g:lo,G:co,H:ho,I:ho,j:_o,L:vo,m:po,M:bo,p:function(e,t,n){var a=d.exec(t.slice(n));return a?(e.p=l.get(a[0].toLowerCase()),n+a[0].length):-1},q:fo,Q:Do,s:Io,S:go,u:io,U:ro,V:oo,w:ao,W:so,x:function(e,t,a){return x(e,n,t,a)},X:function(e,t,n){return x(e,a,t,n)},y:lo,Y:co,Z:uo,"%":So};function D(e,t){return function(n){var a,i,r,o=[],s=-1,c=0,d=e.length;for(n instanceof Date||(n=new Date(+n));++s<d;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(i=Yr[a=e.charAt(++s)])?a=e.charAt(++s):i="e"===a?" ":"0",(r=t[a])&&(a=r(n,i)),o.push(a),c=s+1);return o.push(e.slice(c,s)),o.join("")}}function I(e,t){return function(n){var a,i,r=Wr(1900,void 0,1);if(x(r,e,n+="",0)!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(t&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(i=(a=Kr(Wr(r.y,0,1))).getUTCDay(),a=i>4||0===i?Ar.ceil(a):Ar(a),a=Or.offset(a,7*(r.V-1)),r.y=a.getUTCFullYear(),r.m=a.getUTCMonth(),r.d=a.getUTCDate()+(r.w+6)%7):(i=(a=Gr(Wr(r.y,0,1))).getDay(),a=i>4||0===i?ur.ceil(a):ur(a),a=cr.offset(a,7*(r.V-1)),r.y=a.getFullYear(),r.m=a.getMonth(),r.d=a.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),i="Z"in r?Kr(Wr(r.y,0,1)).getUTCDay():Gr(Wr(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(i+5)%7:r.w+7*r.U-(i+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Kr(r)):Gr(r)}}function x(e,t,n,a){for(var i,r,o=0,s=t.length,c=n.length;o<s;){if(a>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=S[i in Yr?t.charAt(o++):i])||(a=r(e,n,a))<0)return-1}else if(i!=n.charCodeAt(a++))return-1}return a}return v.x=D(n,v),v.X=D(a,v),v.c=D(t,v),y.x=D(n,y),y.X=D(a,y),y.c=D(t,y),{format:function(e){var t=D(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=I(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=D(e+="",y);return t.toString=function(){return e},t},utcParse:function(e){var t=I(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Qr=qr.format,qr.parse,qr.utcFormat,qr.utcParse;const bs=function(e){for(var t=e.length/6|0,n=new Array(t),a=0;a<t;)n[a]="#"+e.slice(6*a,6*++a);return n}("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab");function gs(e){return"string"==typeof e?new we([[document.querySelector(e)]],[document.documentElement]):new we([[e]],Oe)}function vs(e){return"string"==typeof e?new we([document.querySelectorAll(e)],[document.documentElement]):new we([b(e)],Oe)}function ys(e){return function(){return e}}const Ss=Math.abs,Ds=Math.atan2,Is=Math.cos,xs=Math.max,Cs=Math.min,Os=Math.sin,ws=Math.sqrt,Es=1e-12,As=Math.PI,Ls=As/2,ks=2*As;function Ms(e){return e>1?0:e<-1?As:Math.acos(e)}function Ps(e){return e>=1?Ls:e<=-1?-Ls:Math.asin(e)}const Ts=Math.PI,Us=2*Ts,Fs=1e-6,Hs=Us-Fs;function Rs(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}class Ns{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==e?Rs:function(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return Rs;const n=10**t;return function(e){this._+=e[0];for(let t=1,a=e.length;t<a;++t)this._+=Math.round(arguments[t]*n)/n+e[t]}}(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,n,a){this._append`Q${+e},${+t},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(e,t,n,a,i,r){this._append`C${+e},${+t},${+n},${+a},${this._x1=+i},${this._y1=+r}`}arcTo(e,t,n,a,i){if(e=+e,t=+t,n=+n,a=+a,(i=+i)<0)throw new Error(`negative radius: ${i}`);let r=this._x1,o=this._y1,s=n-e,c=a-t,d=r-e,l=o-t,u=d*d+l*l;if(null===this._x1)this._append`M${this._x1=e},${this._y1=t}`;else if(u>Fs)if(Math.abs(l*s-c*d)>Fs&&i){let f=n-r,p=a-o,m=s*s+c*c,_=f*f+p*p,h=Math.sqrt(m),b=Math.sqrt(u),g=i*Math.tan((Ts-Math.acos((m+u-_)/(2*h*b)))/2),v=g/b,y=g/h;Math.abs(v-1)>Fs&&this._append`L${e+v*d},${t+v*l}`,this._append`A${i},${i},0,0,${+(l*f>d*p)},${this._x1=e+y*s},${this._y1=t+y*c}`}else this._append`L${this._x1=e},${this._y1=t}`}arc(e,t,n,a,i,r){if(e=+e,t=+t,r=!!r,(n=+n)<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),s=n*Math.sin(a),c=e+o,d=t+s,l=1^r,u=r?a-i:i-a;null===this._x1?this._append`M${c},${d}`:(Math.abs(this._x1-c)>Fs||Math.abs(this._y1-d)>Fs)&&this._append`L${c},${d}`,n&&(u<0&&(u=u%Us+Us),u>Hs?this._append`A${n},${n},0,1,${l},${e-o},${t-s}A${n},${n},0,1,${l},${this._x1=c},${this._y1=d}`:u>Fs&&this._append`A${n},${n},0,${+(u>=Ts)},${l},${this._x1=e+n*Math.cos(i)},${this._y1=t+n*Math.sin(i)}`)}rect(e,t,n,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Bs(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(null==n)t=null;else{const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);t=e}return e},()=>new Ns(t)}function js(e){return e.innerRadius}function Vs(e){return e.outerRadius}function zs(e){return e.startAngle}function Gs(e){return e.endAngle}function Ks(e){return e&&e.padAngle}function Ws(e,t,n,a,i,r,o,s){var c=n-e,d=a-t,l=o-i,u=s-r,f=u*c-l*d;if(!(f*f<Es))return[e+(f=(l*(t-r)-u*(e-i))/f)*c,t+f*d]}function qs(e,t,n,a,i,r,o){var s=e-n,c=t-a,d=(o?r:-r)/ws(s*s+c*c),l=d*c,u=-d*s,f=e+l,p=t+u,m=n+l,_=a+u,h=(f+m)/2,b=(p+_)/2,g=m-f,v=_-p,y=g*g+v*v,S=i-r,D=f*_-m*p,I=(v<0?-1:1)*ws(xs(0,S*S*y-D*D)),x=(D*v-g*I)/y,C=(-D*g-v*I)/y,O=(D*v+g*I)/y,w=(-D*g+v*I)/y,E=x-h,A=C-b,L=O-h,k=w-b;return E*E+A*A>L*L+k*k&&(x=O,C=w),{cx:x,cy:C,x01:-l,y01:-u,x11:x*(i/S-1),y11:C*(i/S-1)}}function Qs(){var e=js,t=Vs,n=ys(0),a=null,i=zs,r=Gs,o=Ks,s=null,c=Bs(d);function d(){var d,l,u=+e.apply(this,arguments),f=+t.apply(this,arguments),p=i.apply(this,arguments)-Ls,m=r.apply(this,arguments)-Ls,_=Ss(m-p),h=m>p;if(s||(s=d=c()),f<u&&(l=f,f=u,u=l),f>Es)if(_>ks-Es)s.moveTo(f*Is(p),f*Os(p)),s.arc(0,0,f,p,m,!h),u>Es&&(s.moveTo(u*Is(m),u*Os(m)),s.arc(0,0,u,m,p,h));else{var b,g,v=p,y=m,S=p,D=m,I=_,x=_,C=o.apply(this,arguments)/2,O=C>Es&&(a?+a.apply(this,arguments):ws(u*u+f*f)),w=Cs(Ss(f-u)/2,+n.apply(this,arguments)),E=w,A=w;if(O>Es){var L=Ps(O/u*Os(C)),k=Ps(O/f*Os(C));(I-=2*L)>Es?(S+=L*=h?1:-1,D-=L):(I=0,S=D=(p+m)/2),(x-=2*k)>Es?(v+=k*=h?1:-1,y-=k):(x=0,v=y=(p+m)/2)}var M=f*Is(v),P=f*Os(v),T=u*Is(D),U=u*Os(D);if(w>Es){var F,H=f*Is(y),R=f*Os(y),N=u*Is(S),B=u*Os(S);if(_<As)if(F=Ws(M,P,N,B,H,R,T,U)){var j=M-F[0],V=P-F[1],z=H-F[0],G=R-F[1],K=1/Os(Ms((j*z+V*G)/(ws(j*j+V*V)*ws(z*z+G*G)))/2),W=ws(F[0]*F[0]+F[1]*F[1]);E=Cs(w,(u-W)/(K-1)),A=Cs(w,(f-W)/(K+1))}else E=A=0}x>Es?A>Es?(b=qs(N,B,M,P,f,A,h),g=qs(H,R,T,U,f,A,h),s.moveTo(b.cx+b.x01,b.cy+b.y01),A<w?s.arc(b.cx,b.cy,A,Ds(b.y01,b.x01),Ds(g.y01,g.x01),!h):(s.arc(b.cx,b.cy,A,Ds(b.y01,b.x01),Ds(b.y11,b.x11),!h),s.arc(0,0,f,Ds(b.cy+b.y11,b.cx+b.x11),Ds(g.cy+g.y11,g.cx+g.x11),!h),s.arc(g.cx,g.cy,A,Ds(g.y11,g.x11),Ds(g.y01,g.x01),!h))):(s.moveTo(M,P),s.arc(0,0,f,v,y,!h)):s.moveTo(M,P),u>Es&&I>Es?E>Es?(b=qs(T,U,H,R,u,-E,h),g=qs(M,P,N,B,u,-E,h),s.lineTo(b.cx+b.x01,b.cy+b.y01),E<w?s.arc(b.cx,b.cy,E,Ds(b.y01,b.x01),Ds(g.y01,g.x01),!h):(s.arc(b.cx,b.cy,E,Ds(b.y01,b.x01),Ds(b.y11,b.x11),!h),s.arc(0,0,u,Ds(b.cy+b.y11,b.cx+b.x11),Ds(g.cy+g.y11,g.cx+g.x11),h),s.arc(g.cx,g.cy,E,Ds(g.y11,g.x11),Ds(g.y01,g.x01),!h))):s.arc(0,0,u,D,S,h):s.lineTo(T,U)}else s.moveTo(0,0);if(s.closePath(),d)return s=null,d+""||null}return d.centroid=function(){var n=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,a=(+i.apply(this,arguments)+ +r.apply(this,arguments))/2-As/2;return[Is(a)*n,Os(a)*n]},d.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:ys(+t),d):e},d.outerRadius=function(e){return arguments.length?(t="function"==typeof e?e:ys(+e),d):t},d.cornerRadius=function(e){return arguments.length?(n="function"==typeof e?e:ys(+e),d):n},d.padRadius=function(e){return arguments.length?(a=null==e?null:"function"==typeof e?e:ys(+e),d):a},d.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:ys(+e),d):i},d.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:ys(+e),d):r},d.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:ys(+e),d):o},d.context=function(e){return arguments.length?(s=null==e?null:e,d):s},d}function Ys(e){return"object"==typeof e&&"length"in e?e:Array.from(e)}function Js(e){this._context=e}function Xs(e){return new Js(e)}function Zs(e){return e[0]}function $s(e){return e[1]}function ec(e,t){var n=ys(!0),a=null,i=Xs,r=null,o=Bs(s);function s(s){var c,d,l,u=(s=Ys(s)).length,f=!1;for(null==a&&(r=i(l=o())),c=0;c<=u;++c)!(c<u&&n(d=s[c],c,s))===f&&((f=!f)?r.lineStart():r.lineEnd()),f&&r.point(+e(d,c,s),+t(d,c,s));if(l)return r=null,l+""||null}return e="function"==typeof e?e:void 0===e?Zs:ys(e),t="function"==typeof t?t:void 0===t?$s:ys(t),s.x=function(t){return arguments.length?(e="function"==typeof t?t:ys(+t),s):e},s.y=function(e){return arguments.length?(t="function"==typeof e?e:ys(+e),s):t},s.defined=function(e){return arguments.length?(n="function"==typeof e?e:ys(!!e),s):n},s.curve=function(e){return arguments.length?(i=e,null!=a&&(r=i(a)),s):i},s.context=function(e){return arguments.length?(null==e?a=r=null:r=i(a=e),s):a},s}function tc(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function nc(e){return e}function ac(){var e=nc,t=tc,n=null,a=ys(0),i=ys(ks),r=ys(0);function o(o){var s,c,d,l,u,f=(o=Ys(o)).length,p=0,m=new Array(f),_=new Array(f),h=+a.apply(this,arguments),b=Math.min(ks,Math.max(-ks,i.apply(this,arguments)-h)),g=Math.min(Math.abs(b)/f,r.apply(this,arguments)),v=g*(b<0?-1:1);for(s=0;s<f;++s)(u=_[m[s]=s]=+e(o[s],s,o))>0&&(p+=u);for(null!=t?m.sort(function(e,n){return t(_[e],_[n])}):null!=n&&m.sort(function(e,t){return n(o[e],o[t])}),s=0,d=p?(b-f*v)/p:0;s<f;++s,h=l)c=m[s],l=h+((u=_[c])>0?u*d:0)+v,_[c]={data:o[c],index:s,value:u,startAngle:h,endAngle:l,padAngle:g};return _}return o.value=function(t){return arguments.length?(e="function"==typeof t?t:ys(+t),o):e},o.sortValues=function(e){return arguments.length?(t=e,n=null,o):t},o.sort=function(e){return arguments.length?(n=e,t=null,o):n},o.startAngle=function(e){return arguments.length?(a="function"==typeof e?e:ys(+e),o):a},o.endAngle=function(e){return arguments.length?(i="function"==typeof e?e:ys(+e),o):i},o.padAngle=function(e){return arguments.length?(r="function"==typeof e?e:ys(+e),o):r},o}function ic(){}function rc(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function oc(e){this._context=e}function sc(e){return new oc(e)}function cc(e){this._context=e}function dc(e){return new cc(e)}function lc(e){this._context=e}function uc(e){return new lc(e)}Array.prototype.slice,Js.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}},oc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:rc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:rc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},cc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:rc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},lc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,a):this._context.moveTo(n,a);break;case 3:this._point=4;default:rc(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};class fc{constructor(e,t){this._context=e,this._x=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,t,e,t):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+t)/2,e,this._y0,e,t)}this._x0=e,this._y0=t}}function pc(e){return new fc(e,!0)}function mc(e){return new fc(e,!1)}function _c(e,t){this._basis=new oc(e),this._beta=t}_c.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var a,i=e[0],r=t[0],o=e[n]-i,s=t[n]-r,c=-1;++c<=n;)a=c/n,this._basis.point(this._beta*e[c]+(1-this._beta)*(i+a*o),this._beta*t[c]+(1-this._beta)*(r+a*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const hc=function e(t){function n(e){return 1===t?new oc(e):new _c(e,t)}return n.beta=function(t){return e(+t)},n}(.85);function bc(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function gc(e,t){this._context=e,this._k=(1-t)/6}gc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:bc(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:bc(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const vc=function e(t){function n(e){return new gc(e,t)}return n.tension=function(t){return e(+t)},n}(0);function yc(e,t){this._context=e,this._k=(1-t)/6}yc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:bc(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Sc=function e(t){function n(e){return new yc(e,t)}return n.tension=function(t){return e(+t)},n}(0);function Dc(e,t){this._context=e,this._k=(1-t)/6}Dc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:bc(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ic=function e(t){function n(e){return new Dc(e,t)}return n.tension=function(t){return e(+t)},n}(0);function xc(e,t,n){var a=e._x1,i=e._y1,r=e._x2,o=e._y2;if(e._l01_a>Es){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);a=(a*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Es){var d=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,l=3*e._l23_a*(e._l23_a+e._l12_a);r=(r*d+e._x1*e._l23_2a-t*e._l12_2a)/l,o=(o*d+e._y1*e._l23_2a-n*e._l12_2a)/l}e._context.bezierCurveTo(a,i,r,o,e._x2,e._y2)}function Cc(e,t){this._context=e,this._alpha=t}Cc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:xc(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Oc=function e(t){function n(e){return t?new Cc(e,t):new gc(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function wc(e,t){this._context=e,this._alpha=t}wc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:xc(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ec=function e(t){function n(e){return t?new wc(e,t):new yc(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function Ac(e,t){this._context=e,this._alpha=t}Ac.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,a=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+a*a,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:xc(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Lc=function e(t){function n(e){return t?new Ac(e,t):new Dc(e,0)}return n.alpha=function(t){return e(+t)},n}(.5);function kc(e){this._context=e}function Mc(e){return new kc(e)}function Pc(e){return e<0?-1:1}function Tc(e,t,n){var a=e._x1-e._x0,i=t-e._x1,r=(e._y1-e._y0)/(a||i<0&&-0),o=(n-e._y1)/(i||a<0&&-0),s=(r*i+o*a)/(a+i);return(Pc(r)+Pc(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(s))||0}function Uc(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Fc(e,t,n){var a=e._x0,i=e._y0,r=e._x1,o=e._y1,s=(r-a)/3;e._context.bezierCurveTo(a+s,i+s*t,r-s,o-s*n,r,o)}function Hc(e){this._context=e}function Rc(e){this._context=new Nc(e)}function Nc(e){this._context=e}function Bc(e){return new Hc(e)}function jc(e){return new Rc(e)}function Vc(e){this._context=e}function zc(e){var t,n,a=e.length-1,i=new Array(a),r=new Array(a),o=new Array(a);for(i[0]=0,r[0]=2,o[0]=e[0]+2*e[1],t=1;t<a-1;++t)i[t]=1,r[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[a-1]=2,r[a-1]=7,o[a-1]=8*e[a-1]+e[a],t=1;t<a;++t)n=i[t]/r[t-1],r[t]-=n,o[t]-=n*o[t-1];for(i[a-1]=o[a-1]/r[a-1],t=a-2;t>=0;--t)i[t]=(o[t]-i[t+1])/r[t];for(r[a-1]=(e[a]+i[a-1])/2,t=0;t<a-1;++t)r[t]=2*e[t+1]-i[t+1];return[i,r]}function Gc(e){return new Vc(e)}function Kc(e,t){this._context=e,this._t=t}function Wc(e){return new Kc(e,.5)}function qc(e){return new Kc(e,0)}function Qc(e){return new Kc(e,1)}kc.prototype={areaStart:ic,areaEnd:ic,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},Hc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Fc(this,this._t0,Uc(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Fc(this,Uc(this,n=Tc(this,e,t)),n);break;default:Fc(this,this._t0,n=Tc(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}},(Rc.prototype=Object.create(Hc.prototype)).point=function(e,t){Hc.prototype.point.call(this,t,e)},Nc.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,a,i,r){this._context.bezierCurveTo(t,e,a,n,r,i)}},Vc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===n)this._context.lineTo(e[1],t[1]);else for(var a=zc(e),i=zc(t),r=0,o=1;o<n;++r,++o)this._context.bezierCurveTo(a[0][r],i[0][r],a[1][r],i[1][r],e[o],t[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},Kc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}}this._x=e,this._y=t}};const Yc=new Date,Jc=new Date;function Xc(e,t,n,a){function i(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return i.floor=t=>(e(t=new Date(+t)),t),i.ceil=n=>(e(n=new Date(n-1)),t(n,1),e(n),n),i.round=e=>{const t=i(e),n=i.ceil(e);return e-t<n-e?t:n},i.offset=(e,n)=>(t(e=new Date(+e),null==n?1:Math.floor(n)),e),i.range=(n,a,r)=>{const o=[];if(n=i.ceil(n),r=null==r?1:Math.floor(r),!(n<a&&r>0))return o;let s;do{o.push(s=new Date(+n)),t(n,r),e(n)}while(s<n&&n<a);return o},i.filter=n=>Xc(t=>{if(t>=t)for(;e(t),!n(t);)t.setTime(t-1)},(e,a)=>{if(e>=e)if(a<0)for(;++a<=0;)for(;t(e,-1),!n(e););else for(;--a>=0;)for(;t(e,1),!n(e););}),n&&(i.count=(t,a)=>(Yc.setTime(+t),Jc.setTime(+a),e(Yc),e(Jc),Math.floor(n(Yc,Jc))),i.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?i.filter(a?t=>a(t)%e==0:t=>i.count(0,t)%e==0):i:null)),i}const Zc=Xc(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Zc.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?Xc(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):Zc:null),Zc.range;const $c=1e3,ed=6e4,td=36e5,nd=864e5,ad=6048e5,id=Xc(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*$c)},(e,t)=>(t-e)/$c,e=>e.getUTCSeconds()),rd=(id.range,Xc(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$c)},(e,t)=>{e.setTime(+e+t*ed)},(e,t)=>(t-e)/ed,e=>e.getMinutes())),od=(rd.range,Xc(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*ed)},(e,t)=>(t-e)/ed,e=>e.getUTCMinutes())),sd=(od.range,Xc(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*$c-e.getMinutes()*ed)},(e,t)=>{e.setTime(+e+t*td)},(e,t)=>(t-e)/td,e=>e.getHours())),cd=(sd.range,Xc(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*td)},(e,t)=>(t-e)/td,e=>e.getUTCHours())),dd=(cd.range,Xc(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ed)/nd,e=>e.getDate()-1)),ld=(dd.range,Xc(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/nd,e=>e.getUTCDate()-1)),ud=(ld.range,Xc(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/nd,e=>Math.floor(e/nd)));function fd(e){return Xc(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+7*t)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*ed)/ad)}ud.range;const pd=fd(0),md=fd(1),_d=fd(2),hd=fd(3),bd=fd(4),gd=fd(5),vd=fd(6);function yd(e){return Xc(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+7*t)},(e,t)=>(t-e)/ad)}pd.range,md.range,_d.range,hd.range,bd.range,gd.range,vd.range;const Sd=yd(0),Dd=yd(1),Id=yd(2),xd=yd(3),Cd=yd(4),Od=yd(5),wd=yd(6),Ed=(Sd.range,Dd.range,Id.range,xd.range,Cd.range,Od.range,wd.range,Xc(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear()),e=>e.getMonth())),Ad=(Ed.range,Xc(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear()),e=>e.getUTCMonth())),Ld=(Ad.range,Xc(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear()));Ld.every=e=>isFinite(e=Math.floor(e))&&e>0?Xc(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)}):null,Ld.range;const kd=Xc(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());function Md(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Pd(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Td(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}kd.every=e=>isFinite(e=Math.floor(e))&&e>0?Xc(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)}):null,kd.range;var Ud,Fd,Hd={"-":"",_:" ",0:"0"},Rd=/^\s*\d+/,Nd=/^%/,Bd=/[\\^$*+?|[\]().{}]/g;function jd(e,t,n){var a=e<0?"-":"",i=(a?-e:e)+"",r=i.length;return a+(r<n?new Array(n-r+1).join(t)+i:i)}function Vd(e){return e.replace(Bd,"\\$&")}function zd(e){return new RegExp("^(?:"+e.map(Vd).join("|")+")","i")}function Gd(e){return new Map(e.map((e,t)=>[e.toLowerCase(),t]))}function Kd(e,t,n){var a=Rd.exec(t.slice(n,n+1));return a?(e.w=+a[0],n+a[0].length):-1}function Wd(e,t,n){var a=Rd.exec(t.slice(n,n+1));return a?(e.u=+a[0],n+a[0].length):-1}function qd(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.U=+a[0],n+a[0].length):-1}function Qd(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.V=+a[0],n+a[0].length):-1}function Yd(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.W=+a[0],n+a[0].length):-1}function Jd(e,t,n){var a=Rd.exec(t.slice(n,n+4));return a?(e.y=+a[0],n+a[0].length):-1}function Xd(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),n+a[0].length):-1}function Zd(e,t,n){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),n+a[0].length):-1}function $d(e,t,n){var a=Rd.exec(t.slice(n,n+1));return a?(e.q=3*a[0]-3,n+a[0].length):-1}function el(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.m=a[0]-1,n+a[0].length):-1}function tl(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.d=+a[0],n+a[0].length):-1}function nl(e,t,n){var a=Rd.exec(t.slice(n,n+3));return a?(e.m=0,e.d=+a[0],n+a[0].length):-1}function al(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.H=+a[0],n+a[0].length):-1}function il(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.M=+a[0],n+a[0].length):-1}function rl(e,t,n){var a=Rd.exec(t.slice(n,n+2));return a?(e.S=+a[0],n+a[0].length):-1}function ol(e,t,n){var a=Rd.exec(t.slice(n,n+3));return a?(e.L=+a[0],n+a[0].length):-1}function sl(e,t,n){var a=Rd.exec(t.slice(n,n+6));return a?(e.L=Math.floor(a[0]/1e3),n+a[0].length):-1}function cl(e,t,n){var a=Nd.exec(t.slice(n,n+1));return a?n+a[0].length:-1}function dl(e,t,n){var a=Rd.exec(t.slice(n));return a?(e.Q=+a[0],n+a[0].length):-1}function ll(e,t,n){var a=Rd.exec(t.slice(n));return a?(e.s=+a[0],n+a[0].length):-1}function ul(e,t){return jd(e.getDate(),t,2)}function fl(e,t){return jd(e.getHours(),t,2)}function pl(e,t){return jd(e.getHours()%12||12,t,2)}function ml(e,t){return jd(1+dd.count(Ld(e),e),t,3)}function _l(e,t){return jd(e.getMilliseconds(),t,3)}function hl(e,t){return _l(e,t)+"000"}function bl(e,t){return jd(e.getMonth()+1,t,2)}function gl(e,t){return jd(e.getMinutes(),t,2)}function vl(e,t){return jd(e.getSeconds(),t,2)}function yl(e){var t=e.getDay();return 0===t?7:t}function Sl(e,t){return jd(pd.count(Ld(e)-1,e),t,2)}function Dl(e){var t=e.getDay();return t>=4||0===t?bd(e):bd.ceil(e)}function Il(e,t){return e=Dl(e),jd(bd.count(Ld(e),e)+(4===Ld(e).getDay()),t,2)}function xl(e){return e.getDay()}function Cl(e,t){return jd(md.count(Ld(e)-1,e),t,2)}function Ol(e,t){return jd(e.getFullYear()%100,t,2)}function wl(e,t){return jd((e=Dl(e)).getFullYear()%100,t,2)}function El(e,t){return jd(e.getFullYear()%1e4,t,4)}function Al(e,t){var n=e.getDay();return jd((e=n>=4||0===n?bd(e):bd.ceil(e)).getFullYear()%1e4,t,4)}function Ll(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+jd(t/60|0,"0",2)+jd(t%60,"0",2)}function kl(e,t){return jd(e.getUTCDate(),t,2)}function Ml(e,t){return jd(e.getUTCHours(),t,2)}function Pl(e,t){return jd(e.getUTCHours()%12||12,t,2)}function Tl(e,t){return jd(1+ld.count(kd(e),e),t,3)}function Ul(e,t){return jd(e.getUTCMilliseconds(),t,3)}function Fl(e,t){return Ul(e,t)+"000"}function Hl(e,t){return jd(e.getUTCMonth()+1,t,2)}function Rl(e,t){return jd(e.getUTCMinutes(),t,2)}function Nl(e,t){return jd(e.getUTCSeconds(),t,2)}function Bl(e){var t=e.getUTCDay();return 0===t?7:t}function jl(e,t){return jd(Sd.count(kd(e)-1,e),t,2)}function Vl(e){var t=e.getUTCDay();return t>=4||0===t?Cd(e):Cd.ceil(e)}function zl(e,t){return e=Vl(e),jd(Cd.count(kd(e),e)+(4===kd(e).getUTCDay()),t,2)}function Gl(e){return e.getUTCDay()}function Kl(e,t){return jd(Dd.count(kd(e)-1,e),t,2)}function Wl(e,t){return jd(e.getUTCFullYear()%100,t,2)}function ql(e,t){return jd((e=Vl(e)).getUTCFullYear()%100,t,2)}function Ql(e,t){return jd(e.getUTCFullYear()%1e4,t,4)}function Yl(e,t){var n=e.getUTCDay();return jd((e=n>=4||0===n?Cd(e):Cd.ceil(e)).getUTCFullYear()%1e4,t,4)}function Jl(){return"+0000"}function Xl(){return"%"}function Zl(e){return+e}function $l(e){return Math.floor(+e/1e3)}function eu(e,t,n){this.k=e,this.x=t,this.y=n}Ud=function(e){var t=e.dateTime,n=e.date,a=e.time,i=e.periods,r=e.days,o=e.shortDays,s=e.months,c=e.shortMonths,d=zd(i),l=Gd(i),u=zd(r),f=Gd(r),p=zd(o),m=Gd(o),_=zd(s),h=Gd(s),b=zd(c),g=Gd(c),v={a:function(e){return o[e.getDay()]},A:function(e){return r[e.getDay()]},b:function(e){return c[e.getMonth()]},B:function(e){return s[e.getMonth()]},c:null,d:ul,e:ul,f:hl,g:wl,G:Al,H:fl,I:pl,j:ml,L:_l,m:bl,M:gl,p:function(e){return i[+(e.getHours()>=12)]},q:function(e){return 1+~~(e.getMonth()/3)},Q:Zl,s:$l,S:vl,u:yl,U:Sl,V:Il,w:xl,W:Cl,x:null,X:null,y:Ol,Y:El,Z:Ll,"%":Xl},y={a:function(e){return o[e.getUTCDay()]},A:function(e){return r[e.getUTCDay()]},b:function(e){return c[e.getUTCMonth()]},B:function(e){return s[e.getUTCMonth()]},c:null,d:kl,e:kl,f:Fl,g:ql,G:Yl,H:Ml,I:Pl,j:Tl,L:Ul,m:Hl,M:Rl,p:function(e){return i[+(e.getUTCHours()>=12)]},q:function(e){return 1+~~(e.getUTCMonth()/3)},Q:Zl,s:$l,S:Nl,u:Bl,U:jl,V:zl,w:Gl,W:Kl,x:null,X:null,y:Wl,Y:Ql,Z:Jl,"%":Xl},S={a:function(e,t,n){var a=p.exec(t.slice(n));return a?(e.w=m.get(a[0].toLowerCase()),n+a[0].length):-1},A:function(e,t,n){var a=u.exec(t.slice(n));return a?(e.w=f.get(a[0].toLowerCase()),n+a[0].length):-1},b:function(e,t,n){var a=b.exec(t.slice(n));return a?(e.m=g.get(a[0].toLowerCase()),n+a[0].length):-1},B:function(e,t,n){var a=_.exec(t.slice(n));return a?(e.m=h.get(a[0].toLowerCase()),n+a[0].length):-1},c:function(e,n,a){return x(e,t,n,a)},d:tl,e:tl,f:sl,g:Xd,G:Jd,H:al,I:al,j:nl,L:ol,m:el,M:il,p:function(e,t,n){var a=d.exec(t.slice(n));return a?(e.p=l.get(a[0].toLowerCase()),n+a[0].length):-1},q:$d,Q:dl,s:ll,S:rl,u:Wd,U:qd,V:Qd,w:Kd,W:Yd,x:function(e,t,a){return x(e,n,t,a)},X:function(e,t,n){return x(e,a,t,n)},y:Xd,Y:Jd,Z:Zd,"%":cl};function D(e,t){return function(n){var a,i,r,o=[],s=-1,c=0,d=e.length;for(n instanceof Date||(n=new Date(+n));++s<d;)37===e.charCodeAt(s)&&(o.push(e.slice(c,s)),null!=(i=Hd[a=e.charAt(++s)])?a=e.charAt(++s):i="e"===a?" ":"0",(r=t[a])&&(a=r(n,i)),o.push(a),c=s+1);return o.push(e.slice(c,s)),o.join("")}}function I(e,t){return function(n){var a,i,r=Td(1900,void 0,1);if(x(r,e,n+="",0)!=n.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(t&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(i=(a=Pd(Td(r.y,0,1))).getUTCDay(),a=i>4||0===i?Dd.ceil(a):Dd(a),a=ld.offset(a,7*(r.V-1)),r.y=a.getUTCFullYear(),r.m=a.getUTCMonth(),r.d=a.getUTCDate()+(r.w+6)%7):(i=(a=Md(Td(r.y,0,1))).getDay(),a=i>4||0===i?md.ceil(a):md(a),a=dd.offset(a,7*(r.V-1)),r.y=a.getFullYear(),r.m=a.getMonth(),r.d=a.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),i="Z"in r?Pd(Td(r.y,0,1)).getUTCDay():Md(Td(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(i+5)%7:r.w+7*r.U-(i+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,Pd(r)):Md(r)}}function x(e,t,n,a){for(var i,r,o=0,s=t.length,c=n.length;o<s;){if(a>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=S[i in Hd?t.charAt(o++):i])||(a=r(e,n,a))<0)return-1}else if(i!=n.charCodeAt(a++))return-1}return a}return v.x=D(n,v),v.X=D(a,v),v.c=D(t,v),y.x=D(n,y),y.X=D(a,y),y.c=D(t,y),{format:function(e){var t=D(e+="",v);return t.toString=function(){return e},t},parse:function(e){var t=I(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=D(e+="",y);return t.toString=function(){return e},t},utcParse:function(e){var t=I(e+="",!0);return t.toString=function(){return e},t}}}({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Fd=Ud.format,Ud.parse,Ud.utcFormat,Ud.utcParse,eu.prototype={constructor:eu,scale:function(e){return 1===e?this:new eu(this.k*e,this.x,this.y)},translate:function(e,t){return 0===e&0===t?this:new eu(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new eu(1,0,0),eu.prototype}
,435:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(4579),i=n(3140);const r=new class{constructor(e,t){this.color=t,this.changed=!1,this.data=e,this.type=new class{constructor(){this.type=i.Z.ALL}get(){return this.type}set(e){if(this.type&&this.type!==e)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=e}reset(){this.type=i.Z.ALL}is(e){return this.type===e}}}set(e,t){return this.color=t,this.changed=!1,this.data=e,this.type.type=i.Z.ALL,this}_ensureHSL(){const e=this.data,{h:t,s:n,l:i}=e;void 0===t&&(e.h=a.A.channel.rgb2hsl(e,"h")),void 0===n&&(e.s=a.A.channel.rgb2hsl(e,"s")),void 0===i&&(e.l=a.A.channel.rgb2hsl(e,"l"))}_ensureRGB(){const e=this.data,{r:t,g:n,b:i}=e;void 0===t&&(e.r=a.A.channel.hsl2rgb(e,"r")),void 0===n&&(e.g=a.A.channel.hsl2rgb(e,"g")),void 0===i&&(e.b=a.A.channel.hsl2rgb(e,"b"))}get r(){const e=this.data,t=e.r;return this.type.is(i.Z.HSL)||void 0===t?(this._ensureHSL(),a.A.channel.hsl2rgb(e,"r")):t}get g(){const e=this.data,t=e.g;return this.type.is(i.Z.HSL)||void 0===t?(this._ensureHSL(),a.A.channel.hsl2rgb(e,"g")):t}get b(){const e=this.data,t=e.b;return this.type.is(i.Z.HSL)||void 0===t?(this._ensureHSL(),a.A.channel.hsl2rgb(e,"b")):t}get h(){const e=this.data,t=e.h;return this.type.is(i.Z.RGB)||void 0===t?(this._ensureRGB(),a.A.channel.rgb2hsl(e,"h")):t}get s(){const e=this.data,t=e.s;return this.type.is(i.Z.RGB)||void 0===t?(this._ensureRGB(),a.A.channel.rgb2hsl(e,"s")):t}get l(){const e=this.data,t=e.l;return this.type.is(i.Z.RGB)||void 0===t?(this._ensureRGB(),a.A.channel.rgb2hsl(e,"l")):t}get a(){return this.data.a}set r(e){this.type.set(i.Z.RGB),this.changed=!0,this.data.r=e}set g(e){this.type.set(i.Z.RGB),this.changed=!0,this.data.g=e}set b(e){this.type.set(i.Z.RGB),this.changed=!0,this.data.b=e}set h(e){this.type.set(i.Z.HSL),this.changed=!0,this.data.h=e}set s(e){this.type.set(i.Z.HSL),this.changed=!0,this.data.s=e}set l(e){this.type.set(i.Z.HSL),this.changed=!0,this.data.l=e}set a(e){this.changed=!0,this.data.a=e}}({r:0,g:0,b:0,a:0},"transparent")}
,1792:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var a=n(435),i=n(3140);const r={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(35!==e.charCodeAt(0))return;const t=e.match(r.re);if(!t)return;const n=t[1],i=parseInt(n,16),o=n.length,s=o%4==0,c=o>4,d=c?1:17,l=c?8:4,u=s?0:-1,f=c?255:15;return a.A.set({r:(i>>l*(u+3)&f)*d,g:(i>>l*(u+2)&f)*d,b:(i>>l*(u+1)&f)*d,a:s?(i&f)*d/255:1},e)},stringify:e=>{const{r:t,g:n,b:a,a:r}=e;return r<1?`#${i.Y[Math.round(t)]}${i.Y[Math.round(n)]}${i.Y[Math.round(a)]}${i.Y[Math.round(255*r)]}`:`#${i.Y[Math.round(t)]}${i.Y[Math.round(n)]}${i.Y[Math.round(a)]}`}},o=r;var s=n(4579);const c={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(c.hueRe);if(t){const[,e,n]=t;switch(n){case"grad":return s.A.channel.clamp.h(.9*parseFloat(e));case"rad":return s.A.channel.clamp.h(180*parseFloat(e)/Math.PI);case"turn":return s.A.channel.clamp.h(360*parseFloat(e))}}return s.A.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(104!==t&&72!==t)return;const n=e.match(c.re);if(!n)return;const[,i,r,o,d,l]=n;return a.A.set({h:c._hue2deg(i),s:s.A.channel.clamp.s(parseFloat(r)),l:s.A.channel.clamp.l(parseFloat(o)),a:d?s.A.channel.clamp.a(l?parseFloat(d)/100:parseFloat(d)):1},e)},stringify:e=>{const{h:t,s:n,l:a,a:i}=e;return i<1?`hsla(${s.A.lang.round(t)}, ${s.A.lang.round(n)}%, ${s.A.lang.round(a)}%, ${i})`:`hsl(${s.A.lang.round(t)}, ${s.A.lang.round(n)}%, ${s.A.lang.round(a)}%)`}},d=c,l={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=l.colors[e];if(t)return o.parse(t)},stringify:e=>{const t=o.stringify(e);for(const e in l.colors)if(l.colors[e]===t)return e}},u=l,f={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(114!==t&&82!==t)return;const n=e.match(f.re);if(!n)return;const[,i,r,o,c,d,l,u,p]=n;return a.A.set({r:s.A.channel.clamp.r(r?2.55*parseFloat(i):parseFloat(i)),g:s.A.channel.clamp.g(c?2.55*parseFloat(o):parseFloat(o)),b:s.A.channel.clamp.b(l?2.55*parseFloat(d):parseFloat(d)),a:u?s.A.channel.clamp.a(p?parseFloat(u)/100:parseFloat(u)):1},e)},stringify:e=>{const{r:t,g:n,b:a,a:i}=e;return i<1?`rgba(${s.A.lang.round(t)}, ${s.A.lang.round(n)}, ${s.A.lang.round(a)}, ${s.A.lang.round(i)})`:`rgb(${s.A.lang.round(t)}, ${s.A.lang.round(n)}, ${s.A.lang.round(a)})`}},p=f,m={format:{keyword:l,hex:o,rgb:f,rgba:f,hsl:c,hsla:c},parse:e=>{if("string"!=typeof e)return e;const t=o.parse(e)||p.parse(e)||d.parse(e)||u.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(i.Z.HSL)||void 0===e.data.r?d.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?p.stringify(e):o.stringify(e)},_=m}
,3140:(e,t,n)=>{"use strict";n.d(t,{Y:()=>i,Z:()=>r});var a=n(4579);const i={};for(let e=0;e<=255;e++)i[e]=a.A.unit.dec2hex(e);const r={ALL:0,RGB:1,HSL:2}}
,8957:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(4579),i=n(1792);const r=(e,t,n)=>{const r=i.A.parse(e),o=r[t],s=a.A.channel.clamp[t](o+n);return o!==s&&(r[t]=s),i.A.stringify(r)}}
,5862:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(4579),i=n(1792);const r=(e,t)=>{const n=i.A.parse(e);for(const e in t)n[e]=a.A.channel.clamp[e](t[e]);return i.A.stringify(n)}}
,6789:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(8957);const i=(e,t)=>(0,a.A)(e,"l",-t)}
,6771:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(4579),i=n(1792);const r=e=>!(e=>(e=>{const{r:t,g:n,b:r}=i.A.parse(e),o=.2126*a.A.channel.toLinear(t)+.7152*a.A.channel.toLinear(n)+.0722*a.A.channel.toLinear(r);return a.A.lang.round(o)})(e)>=.5)(e)}
,15:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(8957);const i=(e,t)=>(0,a.A)(e,"l",t)}
,1852:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(4579),i=n(435),r=n(1792),o=n(5862);const s=(e,t,n=0,s=1)=>{if("number"!=typeof e)return(0,o.A)(e,{a:t});const c=i.A.set({r:a.A.channel.clamp.r(e),g:a.A.channel.clamp.g(t),b:a.A.channel.clamp.b(n),a:a.A.channel.clamp.a(s)});return r.A.stringify(c)}}
,4579:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});const a={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},i)=>{if(!t)return 2.55*n;e/=360,t/=100;const r=(n/=100)<.5?n*(1+t):n+t-n*t,o=2*n-r;switch(i){case"r":return 255*a.hue2rgb(o,r,e+1/3);case"g":return 255*a.hue2rgb(o,r,e);case"b":return 255*a.hue2rgb(o,r,e-1/3)}},rgb2hsl:({r:e,g:t,b:n},a)=>{e/=255,t/=255,n/=255;const i=Math.max(e,t,n),r=Math.min(e,t,n),o=(i+r)/2;if("l"===a)return 100*o;if(i===r)return 0;const s=i-r;if("s"===a)return 100*(o>.5?s/(2-i-r):s/(i+r));switch(i){case e:return 60*((t-n)/s+(t<n?6:0));case t:return 60*((n-e)/s+2);case n:return 60*((e-t)/s+4);default:return-1}}},i={channel:a,lang:{clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(1e10*e)/1e10},unit:{dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}}}}
,1219:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(5910);const i=function(e,t){for(var n=e.length;n--;)if((0,a.A)(e[n][0],t))return n;return-1};var r=Array.prototype.splice;function o(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}o.prototype.clear=function(){this.__data__=[],this.size=0},o.prototype.delete=function(e){var t=this.__data__,n=i(t,e);return!(n<0||(n==t.length-1?t.pop():r.call(t,n,1),--this.size,0))},o.prototype.get=function(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]},o.prototype.has=function(e){return i(this.__data__,e)>-1},o.prototype.set=function(e,t){var n=this.__data__,a=i(n,e);return a<0?(++this.size,n.push([e,t])):n[a][1]=t,this};const s=o}
,3489:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(7258),i=n(4271);const r=(0,a.A)(i.A,"Map")}
,3750:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});const a=(0,n(7258).A)(Object,"create");var i=Object.prototype.hasOwnProperty,r=Object.prototype.hasOwnProperty;function o(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}o.prototype.clear=function(){this.__data__=a?a(null):{},this.size=0},o.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},o.prototype.get=function(e){var t=this.__data__;if(a){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return i.call(t,e)?t[e]:void 0},o.prototype.has=function(e){var t=this.__data__;return a?void 0!==t[e]:r.call(t,e)},o.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=a&&void 0===t?"__lodash_hash_undefined__":t,this};const s=o;var c=n(1219),d=n(3489);const l=function(e,t){var n,a,i=e.__data__;return("string"==(a=typeof(n=t))||"number"==a||"symbol"==a||"boolean"==a?"__proto__"!==n:null===n)?i["string"==typeof t?"string":"hash"]:i.map};function u(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var a=e[t];this.set(a[0],a[1])}}u.prototype.clear=function(){this.size=0,this.__data__={hash:new s,map:new(d.A||c.A),string:new s}},u.prototype.delete=function(e){var t=l(this,e).delete(e);return this.size-=t?1:0,t},u.prototype.get=function(e){return l(this,e).get(e)},u.prototype.has=function(e){return l(this,e).has(e)},u.prototype.set=function(e,t){var n=l(this,e),a=n.size;return n.set(e,t),this.size+=n.size==a?0:1,this};const f=u}
,8871:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(7258),i=n(4271);const r=(0,a.A)(i.A,"Set")}
,4778:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(1219),i=n(3489),r=n(3750);function o(e){var t=this.__data__=new a.A(e);this.size=t.size}o.prototype.clear=function(){this.__data__=new a.A,this.size=0},o.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},o.prototype.get=function(e){return this.__data__.get(e)},o.prototype.has=function(e){return this.__data__.has(e)},o.prototype.set=function(e,t){var n=this.__data__;if(n instanceof a.A){var o=n.__data__;if(!i.A||o.length<199)return o.push([e,t]),this.size=++n.size,this;n=this.__data__=new r.A(o)}return n.set(e,t),this.size=n.size,this};const s=o}
,7155:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=n(4271).A.Symbol}
,8158:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=n(4271).A.Uint8Array}
,6095:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(5905),i=n(959),r=n(7241),o=n(7803),s=n(8082),c=Object.prototype.hasOwnProperty;const d=function(e,t){var n=(0,i.A)(e),d=!n&&(0,a.A)(e),l=!n&&!d&&(0,r.A)(e),u=!n&&!d&&!l&&(0,s.A)(e),f=n||d||l||u,p=f?function(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a}(e.length,String):[],m=p.length;for(var _ in e)!t&&!c.call(e,_)||f&&("length"==_||l&&("offset"==_||"parent"==_)||u&&("buffer"==_||"byteLength"==_||"byteOffset"==_)||(0,o.A)(_,m))||p.push(_);return p}}
,3249:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(7750),i=n(5910),r=Object.prototype.hasOwnProperty;const o=function(e,t,n){var o=e[t];r.call(e,t)&&(0,i.A)(o,n)&&(void 0!==n||t in e)||(0,a.A)(e,t,n)}}
,7750:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(2997);const i=function(e,t,n){"__proto__"==t&&a.A?(0,a.A)(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}}
,4087:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e,t,n){for(var a=-1,i=Object(e),r=n(e),o=r.length;o--;){var s=r[++a];if(!1===t(i[s],s,i))break}return e}}
,3714:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(7155),i=Object.prototype,r=i.hasOwnProperty,o=i.toString,s=a.A?a.A.toStringTag:void 0,c=Object.prototype.toString,d=a.A?a.A.toStringTag:void 0;const l=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":d&&d in Object(e)?function(e){var t=r.call(e,s),n=e[s];try{e[s]=void 0;var a=!0}catch(e){}var i=o.call(e);return a&&(t?e[s]=n:delete e[s]),i}(e):function(e){return c.call(e)}(e)}}
,4069:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(6345);const i=(0,n(421).A)(Object.keys,Object);var r=Object.prototype.hasOwnProperty;const o=function(e){if(!(0,a.A)(e))return i(e);var t=[];for(var n in Object(e))r.call(e,n)&&"constructor"!=n&&t.push(n);return t}}
,4060:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var a=n(6946),i=n(7729),r=n(445);const o=function(e,t){return(0,r.A)((0,i.A)(e,t,a.A),e+"")}}
,6575:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){return function(t){return e(t)}}}
,1988:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(8158);const i=function(e){var t=new e.constructor(e.byteLength);return new a.A(t).set(new a.A(e)),t}}
,6128:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(4271),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,r=i&&"object"==typeof module&&module&&!module.nodeType&&module,o=r&&r.exports===i?a.A.Buffer:void 0,s=o?o.allocUnsafe:void 0;const c=function(e,t){if(t)return e.slice();var n=e.length,a=s?s(n):new e.constructor(n);return e.copy(a),a}}
,4167:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(1988);const i=function(e,t){var n=t?(0,a.A)(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}}
,1897:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e,t){var n=-1,a=e.length;for(t||(t=Array(a));++n<a;)t[n]=e[n];return t}}
,3781:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(3249),i=n(7750);const r=function(e,t,n,r){var o=!n;n||(n={});for(var s=-1,c=t.length;++s<c;){var d=t[s],l=r?r(n[d],e[d],d,n,e):void 0;void 0===l&&(l=e[d]),o?(0,i.A)(n,d,l):(0,a.A)(n,d,l)}return n}}
,2997:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=n(7258);const i=function(){try{var e=(0,a.A)(Object,"defineProperty");return e({},"",{}),e}catch(e){}}()}
,1098:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a="object"==typeof global&&global&&global.Object===Object&&global}
,7258:(e,t,n)=>{"use strict";n.d(t,{A:()=>_});var a=n(9096);const i=n(4271).A["__core-js_shared__"];var r,o=(r=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"",s=n(4479),c=n(4211),d=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,f=l.toString,p=u.hasOwnProperty,m=RegExp("^"+f.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const _=function(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!(0,s.A)(e)||(t=e,o&&o in t))&&((0,a.A)(e)?m:d).test((0,c.A)(e));var t}(n)?n:void 0}}
,2245:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=(0,n(421).A)(Object.getPrototypeOf,Object)}
,8025:(e,t,n)=>{"use strict";n.d(t,{A:()=>I});var a=n(7258),i=n(4271);const r=(0,a.A)(i.A,"DataView");var o=n(3489);const s=(0,a.A)(i.A,"Promise");var c=n(8871);const d=(0,a.A)(i.A,"WeakMap");var l=n(3714),u=n(4211),f="[object Map]",p="[object Promise]",m="[object Set]",_="[object WeakMap]",h="[object DataView]",b=(0,u.A)(r),g=(0,u.A)(o.A),v=(0,u.A)(s),y=(0,u.A)(c.A),S=(0,u.A)(d),D=l.A;(r&&D(new r(new ArrayBuffer(1)))!=h||o.A&&D(new o.A)!=f||s&&D(s.resolve())!=p||c.A&&D(new c.A)!=m||d&&D(new d)!=_)&&(D=function(e){var t=(0,l.A)(e),n="[object Object]"==t?e.constructor:void 0,a=n?(0,u.A)(n):"";if(a)switch(a){case b:return h;case g:return f;case v:return p;case y:return m;case S:return _}return t});const I=D}
,8891:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(4479),i=Object.create;const r=function(){function e(){}return function(t){if(!(0,a.A)(t))return{};if(i)return i(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var o=n(2245),s=n(6345);const c=function(e){return"function"!=typeof e.constructor||(0,s.A)(e)?{}:r((0,o.A)(e))}}
,7803:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=/^(?:0|[1-9]\d*)$/;const i=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&a.test(e))&&e>-1&&e%1==0&&e<t}}
,6842:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(5910),i=n(88),r=n(7803),o=n(4479);const s=function(e,t,n){if(!(0,o.A)(n))return!1;var s=typeof t;return!!("number"==s?(0,i.A)(n)&&(0,r.A)(t,n.length):"string"==s&&t in n)&&(0,a.A)(n[t],e)}}
,6345:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=Object.prototype;const i=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||a)}}
,2631:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(1098),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,r=i&&"object"==typeof module&&module&&!module.nodeType&&module,o=r&&r.exports===i&&a.A.process;const s=function(){try{return r&&r.require&&r.require("util").types||o&&o.binding&&o.binding("util")}catch(e){}}()}
,421:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e,t){return function(n){return e(t(n))}}}
,7729:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});const a=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)};var i=Math.max;const r=function(e,t,n){return t=i(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,s=i(r.length-t,0),c=Array(s);++o<s;)c[o]=r[t+o];o=-1;for(var d=Array(t+1);++o<t;)d[o]=r[o];return d[t]=n(c),a(e,this,d)}}}
,4271:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(1098),i="object"==typeof self&&self&&self.Object===Object&&self;const r=a.A||i||Function("return this")()}
,445:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(6040),i=n(2997),r=n(6946);const o=i.A?function(e,t){return(0,i.A)(e,"toString",{configurable:!0,enumerable:!1,value:(0,a.A)(t),writable:!0})}:r.A;var s=Date.now;const c=(d=o,l=0,u=0,function(){var e=s(),t=16-(e-u);if(u=e,t>0){if(++l>=800)return arguments[0]}else l=0;return d.apply(void 0,arguments)});var d,l,u}
,4211:(e,t,n)=>{"use strict";n.d(t,{A:()=>i});var a=Function.prototype.toString;const i=function(e){if(null!=e){try{return a.call(e)}catch(e){}try{return e+""}catch(e){}}return""}}
,6040:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){return function(){return e}}}
,5910:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e,t){return e===t||e!=e&&t!=t}}
,6946:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){return e}}
,5905:(e,t,n)=>{"use strict";n.d(t,{A:()=>d});var a=n(3714),i=n(2232);const r=function(e){return(0,i.A)(e)&&"[object Arguments]"==(0,a.A)(e)};var o=Object.prototype,s=o.hasOwnProperty,c=o.propertyIsEnumerable;const d=r(function(){return arguments}())?r:function(e){return(0,i.A)(e)&&s.call(e,"callee")&&!c.call(e,"callee")}}
,959:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=Array.isArray}
,88:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(9096),i=n(8200);const r=function(e){return null!=e&&(0,i.A)(e.length)&&!(0,a.A)(e)}}
,9359:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(88),i=n(2232);const r=function(e){return(0,i.A)(e)&&(0,a.A)(e)}}
,7241:(e,t,n)=>{"use strict";n.d(t,{A:()=>s});var a=n(4271),i="object"==typeof exports&&exports&&!exports.nodeType&&exports,r=i&&"object"==typeof module&&module&&!module.nodeType&&module,o=r&&r.exports===i?a.A.Buffer:void 0;const s=(o?o.isBuffer:void 0)||function(){return!1}}
,1615:(e,t,n)=>{"use strict";n.d(t,{A:()=>f});var a=n(4069),i=n(8025),r=n(5905),o=n(959),s=n(88),c=n(7241),d=n(6345),l=n(8082),u=Object.prototype.hasOwnProperty;const f=function(e){if(null==e)return!0;if((0,s.A)(e)&&((0,o.A)(e)||"string"==typeof e||"function"==typeof e.splice||(0,c.A)(e)||(0,l.A)(e)||(0,r.A)(e)))return!e.length;var t=(0,i.A)(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if((0,d.A)(e))return!(0,a.A)(e).length;for(var n in e)if(u.call(e,n))return!1;return!0}}
,9096:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(3714),i=n(4479);const r=function(e){if(!(0,i.A)(e))return!1;var t=(0,a.A)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}}
,8200:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}}
,4479:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}}
,2232:(e,t,n)=>{"use strict";n.d(t,{A:()=>a});const a=function(e){return null!=e&&"object"==typeof e}}
,6365:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var a=n(3714),i=n(2245),r=n(2232),o=Function.prototype,s=Object.prototype,c=o.toString,d=s.hasOwnProperty,l=c.call(Object);const u=function(e){if(!(0,r.A)(e)||"[object Object]"!=(0,a.A)(e))return!1;var t=(0,i.A)(e);if(null===t)return!0;var n=d.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==l}}
,8082:(e,t,n)=>{"use strict";n.d(t,{A:()=>l});var a=n(3714),i=n(8200),r=n(2232),o={};o["[object Float32Array]"]=o["[object Float64Array]"]=o["[object Int8Array]"]=o["[object Int16Array]"]=o["[object Int32Array]"]=o["[object Uint8Array]"]=o["[object Uint8ClampedArray]"]=o["[object Uint16Array]"]=o["[object Uint32Array]"]=!0,o["[object Arguments]"]=o["[object Array]"]=o["[object ArrayBuffer]"]=o["[object Boolean]"]=o["[object DataView]"]=o["[object Date]"]=o["[object Error]"]=o["[object Function]"]=o["[object Map]"]=o["[object Number]"]=o["[object Object]"]=o["[object RegExp]"]=o["[object Set]"]=o["[object String]"]=o["[object WeakMap]"]=!1;var s=n(6575),c=n(2631),d=c.A&&c.A.isTypedArray;const l=d?(0,s.A)(d):function(e){return(0,r.A)(e)&&(0,i.A)(e.length)&&!!o[(0,a.A)(e)]}}
,2947:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var a=n(6095),i=n(4479),r=n(6345),o=Object.prototype.hasOwnProperty;var s=n(88);const c=function(e){return(0,s.A)(e)?(0,a.A)(e,!0):function(e){if(!(0,i.A)(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=(0,r.A)(e),n=[];for(var a in e)("constructor"!=a||!t&&o.call(e,a))&&n.push(a);return n}(e)}}
,5738:(e,t,n)=>{"use strict";n.d(t,{A:()=>r});var a=n(3750);function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function(){var a=arguments,i=t?t.apply(this,a):a[0],r=n.cache;if(r.has(i))return r.get(i);var o=e.apply(this,a);return n.cache=r.set(i,o)||r,o};return n.cache=new(i.Cache||a.A),n}i.Cache=a.A;const r=i}
,5681:(e,t,n)=>{"use strict";n.d(t,{A:()=>O});var a=n(4778),i=n(7750),r=n(5910);const o=function(e,t,n){(void 0!==n&&!(0,r.A)(e[t],n)||void 0===n&&!(t in e))&&(0,i.A)(e,t,n)};var s=n(4087),c=n(6128),d=n(4167),l=n(1897),u=n(8891),f=n(5905),p=n(959),m=n(9359),_=n(7241),h=n(9096),b=n(4479),g=n(6365),v=n(8082);const y=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]};var S=n(3781),D=n(2947);const I=function e(t,n,i,r,I){t!==n&&(0,s.A)(n,function(s,x){if(I||(I=new a.A),(0,b.A)(s))!function(e,t,n,a,i,r,s){var I,x=y(e,n),C=y(t,n),O=s.get(C);if(O)o(e,n,O);else{var w=r?r(x,C,n+"",e,t,s):void 0,E=void 0===w;if(E){var A=(0,p.A)(C),L=!A&&(0,_.A)(C),k=!A&&!L&&(0,v.A)(C);w=C,A||L||k?(0,p.A)(x)?w=x:(0,m.A)(x)?w=(0,l.A)(x):L?(E=!1,w=(0,c.A)(C,!0)):k?(E=!1,w=(0,d.A)(C,!0)):w=[]:(0,g.A)(C)||(0,f.A)(C)?(w=x,(0,f.A)(x)?(I=x,w=(0,S.A)(I,(0,D.A)(I))):(0,b.A)(x)&&!(0,h.A)(x)||(w=(0,u.A)(C))):E=!1}E&&(s.set(C,w),i(w,C,a,r,s),s.delete(C)),o(e,n,w)}}(t,n,x,i,e,r,I);else{var C=r?r(y(t,x),s,x+"",t,n,I):void 0;void 0===C&&(C=s),o(t,x,C)}},D.A)};var x=n(4060),C=n(6842);const O=(w=function(e,t,n){I(e,t,n)},(0,x.A)(function(e,t){var n=-1,a=t.length,i=a>1?t[a-1]:void 0,r=a>2?t[2]:void 0;for(i=w.length>3&&"function"==typeof i?(a--,i):void 0,r&&(0,C.A)(t[0],t[1],r)&&(i=a<3?void 0:i,a=1),e=Object(e);++n<a;){var o=t[n];o&&w(e,o,n)}return e}));var w}
,6915:(e,t,n)=>{"use strict";n.d(t,{A:()=>Rn,B:()=>Fe,C:()=>ht,D:()=>_t,E:()=>Ae,F:()=>Et,G:()=>De,H:()=>Ie,I:()=>rt,J:()=>ce,K:()=>kn,L:()=>On,M:()=>gt,N:()=>Ni,Z:()=>Ye,a:()=>In,b:()=>Dn,c:()=>An,d:()=>fe,e:()=>Ce,f:()=>Qe,g:()=>Sn,h:()=>ut,i:()=>fn,j:()=>lt,k:()=>at,l:()=>re,m:()=>_e,n:()=>$e,o:()=>pn,p:()=>Ln,q:()=>xn,r:()=>xe,s:()=>yn,t:()=>Cn,u:()=>bt,v:()=>vn,w:()=>ct,x:()=>he,y:()=>ot,z:()=>Pn});var a=n(1396),i=n(3530),r=n(9647),o=n(7712),s=n(1018),c=n(1792),d=n(5862);const l=(e,t)=>{const n=c.A.parse(e),a={};for(const e in t)t[e]&&(a[e]=n[e]+t[e]);return(0,d.A)(e,a)};var u=n(1852);const f=(e,t=100)=>{const n=c.A.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,((e,t,n=50)=>{const{r:a,g:i,b:r,a:o}=c.A.parse(e),{r:s,g:d,b:l,a:f}=c.A.parse(t),p=n/100,m=2*p-1,_=o-f,h=((m*_==-1?m:(m+_)/(1+m*_))+1)/2,b=1-h,g=a*h+s*b,v=i*h+d*b,y=r*h+l*b,S=o*p+f*(1-p);return(0,u.A)(g,v,y,S)})(n,e,t)};var p=n(6789),m=n(15),_=n(6771),h=n(5738),b=n(5681),g="comm",v="rule",y="decl",S=Math.abs,D=String.fromCharCode;function I(e){return e.trim()}function x(e,t,n){return e.replace(t,n)}function C(e,t){return e.indexOf(t)}function O(e,t){return 0|e.charCodeAt(t)}function w(e,t,n){return e.slice(t,n)}function E(e){return e.length}function A(e){return e.length}function L(e,t){return t.push(e),e}function k(e,t){for(var n="",a=A(e),i=0;i<a;i++)n+=t(e[i],i,e,t)||"";return n}function M(e,t,n,a){switch(e.type){case"@layer":if(e.children.length)break;case"@import":case y:return e.return=e.return||e.value;case g:return"";case"@keyframes":return e.return=e.value+"{"+k(e.children,a)+"}";case v:e.value=e.props.join(",")}return E(n=k(e.children,a))?e.return=e.value+"{"+n+"}":""}Object.assign;var P=1,T=1,U=0,F=0,H=0,R="";function N(e,t,n,a,i,r,o){return{value:e,root:t,parent:n,type:a,props:i,children:r,line:P,column:T,length:o,return:""}}function B(){return H=F>0?O(R,--F):0,T--,10===H&&(T=1,P--),H}function j(){return H=F<U?O(R,F++):0,T++,10===H&&(T=1,P++),H}function V(){return O(R,F)}function z(){return F}function G(e,t){return w(R,e,t)}function K(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function W(e){return I(G(F-1,Y(91===e?e+2:40===e?e+1:e)))}function q(e){for(;(H=V())&&H<33;)j();return K(e)>2||K(H)>3?"":" "}function Q(e,t){for(;--t&&j()&&!(H<48||H>102||H>57&&H<65||H>70&&H<97););return G(e,z()+(t<6&&32==V()&&32==j()))}function Y(e){for(;j();)switch(H){case e:return F;case 34:case 39:34!==e&&39!==e&&Y(H);break;case 40:41===e&&Y(e);break;case 92:j()}return F}function J(e,t){for(;j()&&e+H!==57&&(e+H!==84||47!==V()););return"/*"+G(t,F-1)+"*"+D(47===e?e:j())}function X(e){for(;!K(V());)j();return G(e,F)}function Z(e){return function(e){return R="",e}($("",null,null,null,[""],e=function(e){return P=T=1,U=E(R=e),F=0,[]}(e),0,[0],e))}function $(e,t,n,a,i,r,o,s,c){for(var d=0,l=0,u=o,f=0,p=0,m=0,_=1,h=1,b=1,g=0,v="",y=i,S=r,I=a,w=v;h;)switch(m=g,g=j()){case 40:if(108!=m&&58==O(w,u-1)){-1!=C(w+=x(W(g),"&","&\f"),"&\f")&&(b=-1);break}case 34:case 39:case 91:w+=W(g);break;case 9:case 10:case 13:case 32:w+=q(m);break;case 92:w+=Q(z()-1,7);continue;case 47:switch(V()){case 42:case 47:L(te(J(j(),z()),t,n),c);break;default:w+="/"}break;case 123*_:s[d++]=E(w)*b;case 125*_:case 59:case 0:switch(g){case 0:case 125:h=0;case 59+l:-1==b&&(w=x(w,/\f/g,"")),p>0&&E(w)-u&&L(p>32?ne(w+";",a,n,u-1):ne(x(w," ","")+";",a,n,u-2),c);break;case 59:w+=";";default:if(L(I=ee(w,t,n,d,l,i,s,v,y=[],S=[],u),r),123===g)if(0===l)$(w,t,I,I,y,r,u,s,S);else switch(99===f&&110===O(w,3)?100:f){case 100:case 108:case 109:case 115:$(e,I,I,a&&L(ee(e,I,I,0,0,i,s,v,i,y=[],u),S),i,S,u,s,a?y:S);break;default:$(w,I,I,I,[""],S,0,s,S)}}d=l=p=0,_=b=1,v=w="",u=o;break;case 58:u=1+E(w),p=m;default:if(_<1)if(123==g)--_;else if(125==g&&0==_++&&125==B())continue;switch(w+=D(g),g*_){case 38:b=l>0?1:(w+="\f",-1);break;case 44:s[d++]=(E(w)-1)*b,b=1;break;case 64:45===V()&&(w+=W(j())),f=V(),l=u=E(v=w+=X(z())),g++;break;case 45:45===m&&2==E(w)&&(_=0)}}return r}function ee(e,t,n,a,i,r,o,s,c,d,l){for(var u=i-1,f=0===i?r:[""],p=A(f),m=0,_=0,h=0;m<a;++m)for(var b=0,g=w(e,u+1,u=S(_=o[m])),y=e;b<p;++b)(y=I(_>0?f[b]+" "+g:x(g,/&\f/g,f[b])))&&(c[h++]=y);return N(e,t,n,0===i?v:s,c,d,l)}function te(e,t,n){return N(e,t,n,g,D(H),w(e,2,-2),0)}function ne(e,t,n,a){return N(e,t,n,y,w(e,0,a),w(e,a+1,-1),a)}var ae=n(1615);const ie={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},re={trace:(...e)=>{},debug:(...e)=>{},info:(...e)=>{},warn:(...e)=>{},error:(...e)=>{},fatal:(...e)=>{}},oe=function(e="fatal"){let t=ie.fatal;"string"==typeof e?(e=e.toLowerCase())in ie&&(t=ie[e]):"number"==typeof e&&(t=e),re.trace=()=>{},re.debug=()=>{},re.info=()=>{},re.warn=()=>{},re.error=()=>{},re.fatal=()=>{},t<=ie.fatal&&(re.fatal=console.error?console.error.bind(console,se("FATAL"),"color: orange"):console.log.bind(console,"[35m",se("FATAL"))),t<=ie.error&&(re.error=console.error?console.error.bind(console,se("ERROR"),"color: orange"):console.log.bind(console,"[31m",se("ERROR"))),t<=ie.warn&&(re.warn=console.warn?console.warn.bind(console,se("WARN"),"color: orange"):console.log.bind(console,"[33m",se("WARN"))),t<=ie.info&&(re.info=console.info?console.info.bind(console,se("INFO"),"color: lightblue"):console.log.bind(console,"[34m",se("INFO"))),t<=ie.debug&&(re.debug=console.debug?console.debug.bind(console,se("DEBUG"),"color: lightgreen"):console.log.bind(console,"[32m",se("DEBUG"))),t<=ie.trace&&(re.trace=console.debug?console.debug.bind(console,se("TRACE"),"color: lightgreen"):console.log.bind(console,"[32m",se("TRACE")))},se=e=>`%c${i().format("ss.SSS")} : ${e} : `,ce=/<br\s*\/?>/gi,de=(()=>{let e=!1;return()=>{e||(function(){const e="data-temp-href-target";s.addHook("beforeSanitizeAttributes",t=>{"A"===t.tagName&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")||"")}),s.addHook("afterSanitizeAttributes",t=>{"A"===t.tagName&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)||""),t.removeAttribute(e),"_blank"===t.getAttribute("target")&&t.setAttribute("rel","noopener"))})}(),e=!0)}})(),le=e=>(de(),s.sanitize(e)),ue=(e,t)=>{var n;if(!1!==(null==(n=t.flowchart)?void 0:n.htmlLabels)){const n=t.securityLevel;"antiscript"===n||"strict"===n?e=le(e):"loose"!==n&&(e=(e=(e=me(e)).replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/=/g,"&equals;"),e=pe(e))}return e},fe=(e,t)=>e?e=t.dompurifyConfig?s.sanitize(ue(e,t),t.dompurifyConfig).toString():s.sanitize(ue(e,t),{FORBID_TAGS:["style"]}).toString():e,pe=e=>e.replace(/#br#/g,"<br/>"),me=e=>e.replace(ce,"#br#"),_e=e=>!1!==e&&!["false","null","0"].includes(String(e).trim().toLowerCase()),he=function(e){const t=e.split(/(,)/),n=[];for(let e=0;e<t.length;e++){let a=t[e];if(","===a&&e>0&&e+1<t.length){const i=t[e-1],r=t[e+1];ge(i,r)&&(a=i+","+r,e++,n.pop())}n.push(ve(a))}return n.join("")},be=(e,t)=>Math.max(0,e.split(t).length-1),ge=(e,t)=>{const n=be(e,"~"),a=be(t,"~");return 1===n&&1===a},ve=e=>{const t=be(e,"~");let n=!1;if(t<=1)return e;t%2!=0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const a=[...e];let i=a.indexOf("~"),r=a.lastIndexOf("~");for(;-1!==i&&-1!==r&&i!==r;)a[i]="<",a[r]=">",i=a.indexOf("~"),r=a.lastIndexOf("~");return n&&a.unshift("~"),a.join("")},ye=()=>void 0!==window.MathMLElement,Se=/\$\$(.*)\$\$/g,De=e=>{var t;return((null==(t=e.match(Se))?void 0:t.length)??0)>0},Ie=async(e,t)=>{e=await xe(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const a=document.querySelector("body");null==a||a.insertAdjacentElement("beforeend",n);const i={width:n.clientWidth,height:n.clientHeight};return n.remove(),i},xe=async(e,t)=>{if(!De(e))return e;if(!ye()&&!t.legacyMathML)return e.replace(Se,"MathML is unsupported in this environment.");const{default:a}=await n.e(516).then(n.bind(n,3516));return e.split(ce).map(e=>De(e)?`\n            <div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">\n              ${e}\n            </div>\n          `:`<div>${e}</div>`).join("").replace(Se,(e,t)=>a.renderToString(t,{throwOnError:!0,displayMode:!0,output:ye()?"mathml":"htmlAndMathml"}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},Ce={getRows:e=>e?me(e).replace(/\\n/g,"#br#").split("#br#"):[""],sanitizeText:fe,sanitizeTextOrArray:(e,t)=>"string"==typeof e?fe(e,t):e.flat().map(e=>fe(e,t)),hasBreaks:e=>ce.test(e),splitBreaks:e=>e.split(ce),lineBreakRegex:ce,removeScript:le,getUrl:e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},evaluate:_e,getMax:function(...e){const t=e.filter(e=>!isNaN(e));return Math.max(...t)},getMin:function(...e){const t=e.filter(e=>!isNaN(e));return Math.min(...t)}},Oe=(e,t)=>l(e,t?{s:-40,l:10}:{s:-40,l:-10}),we="#ffffff",Ee="#f2f2f2",Ae=e=>{const t=new class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=l(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=l(this.primaryColor,{h:-160}),this.primaryBorderColor=Oe(this.primaryColor,this.darkMode),this.secondaryBorderColor=Oe(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Oe(this.tertiaryColor,this.darkMode),this.primaryTextColor=f(this.primaryColor),this.secondaryTextColor=f(this.secondaryColor),this.tertiaryTextColor=f(this.tertiaryColor),this.lineColor=f(this.background),this.textColor=f(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#e8e8e8",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="grey",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=(0,u.A)(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var e,t,n,a,i,r,o,s,c,d,u;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||l(this.primaryColor,{h:30}),this.cScale4=this.cScale4||l(this.primaryColor,{h:60}),this.cScale5=this.cScale5||l(this.primaryColor,{h:90}),this.cScale6=this.cScale6||l(this.primaryColor,{h:120}),this.cScale7=this.cScale7||l(this.primaryColor,{h:150}),this.cScale8=this.cScale8||l(this.primaryColor,{h:210}),this.cScale9=this.cScale9||l(this.primaryColor,{h:270}),this.cScale10=this.cScale10||l(this.primaryColor,{h:300}),this.cScale11=this.cScale11||l(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||(0,p.A)(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||(0,p.A)(this.tertiaryColor,40);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=(0,p.A)(this["cScale"+e],10),this["cScalePeer"+e]=this["cScalePeer"+e]||(0,p.A)(this["cScale"+e],25);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||l(this["cScale"+e],{h:180});for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||l(this.mainBkg,{h:30,l:-(5+5*e)}),this["surfacePeer"+e]=this["surfacePeer"+e]||l(this.mainBkg,{h:30,l:-(7+5*e)});if(this.scaleLabelColor="calculated"!==this.scaleLabelColor&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,"calculated"!==this.labelTextColor){this.cScaleLabel0=this.cScaleLabel0||f(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||f(this.labelTextColor);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=(0,m.A)(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=l(this.primaryColor,{h:64}),this.fillType3=l(this.secondaryColor,{h:64}),this.fillType4=l(this.primaryColor,{h:-64}),this.fillType5=l(this.secondaryColor,{h:-64}),this.fillType6=l(this.primaryColor,{h:128}),this.fillType7=l(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||l(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||l(this.primaryColor,{l:-10}),this.pie5=this.pie5||l(this.secondaryColor,{l:-30}),this.pie6=this.pie6||l(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||l(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||l(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||l(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||l(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||l(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||l(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||l(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||l(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||l(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||l(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||l(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||l(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||(0,_.A)(this.quadrant1Fill)?(0,m.A)(this.quadrant1Fill):(0,p.A)(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:(null==(e=this.xyChart)?void 0:e.backgroundColor)||this.background,titleColor:(null==(t=this.xyChart)?void 0:t.titleColor)||this.primaryTextColor,xAxisTitleColor:(null==(n=this.xyChart)?void 0:n.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:(null==(a=this.xyChart)?void 0:a.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:(null==(i=this.xyChart)?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:(null==(r=this.xyChart)?void 0:r.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:(null==(o=this.xyChart)?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:(null==(s=this.xyChart)?void 0:s.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:(null==(c=this.xyChart)?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:(null==(d=this.xyChart)?void 0:d.yAxisLineColor)||this.primaryTextColor,plotColorPalette:(null==(u=this.xyChart)?void 0:u.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||l(this.primaryColor,{h:-30}),this.git4=this.git4||l(this.primaryColor,{h:-60}),this.git5=this.git5||l(this.primaryColor,{h:-90}),this.git6=this.git6||l(this.primaryColor,{h:60}),this.git7=this.git7||l(this.primaryColor,{h:120}),this.darkMode?(this.git0=(0,m.A)(this.git0,25),this.git1=(0,m.A)(this.git1,25),this.git2=(0,m.A)(this.git2,25),this.git3=(0,m.A)(this.git3,25),this.git4=(0,m.A)(this.git4,25),this.git5=(0,m.A)(this.git5,25),this.git6=(0,m.A)(this.git6,25),this.git7=(0,m.A)(this.git7,25)):(this.git0=(0,p.A)(this.git0,25),this.git1=(0,p.A)(this.git1,25),this.git2=(0,p.A)(this.git2,25),this.git3=(0,p.A)(this.git3,25),this.git4=(0,p.A)(this.git4,25),this.git5=(0,p.A)(this.git5,25),this.git6=(0,p.A)(this.git6,25),this.git7=(0,p.A)(this.git7,25)),this.gitInv0=this.gitInv0||(0,p.A)(f(this.git0),25),this.gitInv1=this.gitInv1||f(this.git1),this.gitInv2=this.gitInv2||f(this.git2),this.gitInv3=this.gitInv3||f(this.git3),this.gitInv4=this.gitInv4||f(this.git4),this.gitInv5=this.gitInv5||f(this.git5),this.gitInv6=this.gitInv6||f(this.git6),this.gitInv7=this.gitInv7||f(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||f(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||f(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||we,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ee}calculate(e){if("object"!=typeof e)return void this.updateColors();const t=Object.keys(e);t.forEach(t=>{this[t]=e[t]}),this.updateColors(),t.forEach(t=>{this[t]=e[t]})}};return t.calculate(e),t};class Le{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=(0,m.A)(this.contrast,55),this.background="#ffffff",this.tertiaryColor=l(this.primaryColor,{h:-160}),this.primaryBorderColor=Oe(this.primaryColor,this.darkMode),this.secondaryBorderColor=Oe(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Oe(this.tertiaryColor,this.darkMode),this.primaryTextColor=f(this.primaryColor),this.secondaryTextColor=f(this.secondaryColor),this.tertiaryTextColor=f(this.tertiaryColor),this.lineColor=f(this.background),this.textColor=f(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var e,t,n,a,i,r,o,s,c,d,u;this.secondBkg=(0,m.A)(this.contrast,55),this.border2=this.contrast,this.actorBorder=(0,m.A)(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.lineColor,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||f(this["cScale"+e]);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this.darkMode?this["cScalePeer"+e]=this["cScalePeer"+e]||(0,m.A)(this["cScale"+e],10):this["cScalePeer"+e]=this["cScalePeer"+e]||(0,p.A)(this["cScale"+e],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||l(this.mainBkg,{l:-(5+5*e)}),this["surfacePeer"+e]=this["surfacePeer"+e]||l(this.mainBkg,{l:-(8+5*e)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=(0,m.A)(this.contrast,30),this.sectionBkgColor2=(0,m.A)(this.contrast,30),this.taskBorderColor=(0,p.A)(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=(0,m.A)(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=(0,p.A)(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=l(this.primaryColor,{h:64}),this.fillType3=l(this.secondaryColor,{h:64}),this.fillType4=l(this.primaryColor,{h:-64}),this.fillType5=l(this.secondaryColor,{h:-64}),this.fillType6=l(this.primaryColor,{h:128}),this.fillType7=l(this.secondaryColor,{h:128});for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["pie"+e]=this["cScale"+e];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||l(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||l(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||l(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||l(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||l(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||l(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||(0,_.A)(this.quadrant1Fill)?(0,m.A)(this.quadrant1Fill):(0,p.A)(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:(null==(e=this.xyChart)?void 0:e.backgroundColor)||this.background,titleColor:(null==(t=this.xyChart)?void 0:t.titleColor)||this.primaryTextColor,xAxisTitleColor:(null==(n=this.xyChart)?void 0:n.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:(null==(a=this.xyChart)?void 0:a.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:(null==(i=this.xyChart)?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:(null==(r=this.xyChart)?void 0:r.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:(null==(o=this.xyChart)?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:(null==(s=this.xyChart)?void 0:s.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:(null==(c=this.xyChart)?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:(null==(d=this.xyChart)?void 0:d.yAxisLineColor)||this.primaryTextColor,plotColorPalette:(null==(u=this.xyChart)?void 0:u.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=(0,p.A)(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||l(this.primaryColor,{h:-30}),this.git4=this.pie5||l(this.primaryColor,{h:-60}),this.git5=this.pie6||l(this.primaryColor,{h:-90}),this.git6=this.pie7||l(this.primaryColor,{h:60}),this.git7=this.pie8||l(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||f(this.git0),this.gitInv1=this.gitInv1||f(this.git1),this.gitInv2=this.gitInv2||f(this.git2),this.gitInv3=this.gitInv3||f(this.git3),this.gitInv4=this.gitInv4||f(this.git4),this.gitInv5=this.gitInv5||f(this.git5),this.gitInv6=this.gitInv6||f(this.git6),this.gitInv7=this.gitInv7||f(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||we,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ee}calculate(e){if("object"!=typeof e)return void this.updateColors();const t=Object.keys(e);t.forEach(t=>{this[t]=e[t]}),this.updateColors(),t.forEach(t=>{this[t]=e[t]})}}const ke={base:{getThemeVariables:e=>{const t=new class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var e,t,n,a,i,r,o,s,c,d,u;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||l(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||l(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||Oe(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||Oe(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||Oe(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||Oe(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||f(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||f(this.tertiaryColor),this.lineColor=this.lineColor||f(this.background),this.arrowheadColor=this.arrowheadColor||f(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?(0,p.A)(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||"grey",this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||(0,p.A)(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||f(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||(0,m.A)(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||l(this.primaryColor,{h:30}),this.cScale4=this.cScale4||l(this.primaryColor,{h:60}),this.cScale5=this.cScale5||l(this.primaryColor,{h:90}),this.cScale6=this.cScale6||l(this.primaryColor,{h:120}),this.cScale7=this.cScale7||l(this.primaryColor,{h:150}),this.cScale8=this.cScale8||l(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||l(this.primaryColor,{h:270}),this.cScale10=this.cScale10||l(this.primaryColor,{h:300}),this.cScale11=this.cScale11||l(this.primaryColor,{h:330}),this.darkMode)for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=(0,p.A)(this["cScale"+e],75);else for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=(0,p.A)(this["cScale"+e],25);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||f(this["cScale"+e]);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this.darkMode?this["cScalePeer"+e]=this["cScalePeer"+e]||(0,m.A)(this["cScale"+e],10):this["cScalePeer"+e]=this["cScalePeer"+e]||(0,p.A)(this["cScale"+e],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;const h=this.darkMode?-4:-1;for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||l(this.mainBkg,{h:180,s:-15,l:h*(5+3*e)}),this["surfacePeer"+e]=this["surfacePeer"+e]||l(this.mainBkg,{h:180,s:-15,l:h*(8+3*e)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||l(this.primaryColor,{h:64}),this.fillType3=this.fillType3||l(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||l(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||l(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||l(this.primaryColor,{h:128}),this.fillType7=this.fillType7||l(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||l(this.primaryColor,{l:-10}),this.pie5=this.pie5||l(this.secondaryColor,{l:-10}),this.pie6=this.pie6||l(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||l(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||l(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||l(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||l(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||l(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||l(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||l(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||l(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||l(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||l(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||l(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||l(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||(0,_.A)(this.quadrant1Fill)?(0,m.A)(this.quadrant1Fill):(0,p.A)(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:(null==(e=this.xyChart)?void 0:e.backgroundColor)||this.background,titleColor:(null==(t=this.xyChart)?void 0:t.titleColor)||this.primaryTextColor,xAxisTitleColor:(null==(n=this.xyChart)?void 0:n.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:(null==(a=this.xyChart)?void 0:a.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:(null==(i=this.xyChart)?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:(null==(r=this.xyChart)?void 0:r.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:(null==(o=this.xyChart)?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:(null==(s=this.xyChart)?void 0:s.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:(null==(c=this.xyChart)?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:(null==(d=this.xyChart)?void 0:d.yAxisLineColor)||this.primaryTextColor,plotColorPalette:(null==(u=this.xyChart)?void 0:u.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?(0,p.A)(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||l(this.primaryColor,{h:-30}),this.git4=this.git4||l(this.primaryColor,{h:-60}),this.git5=this.git5||l(this.primaryColor,{h:-90}),this.git6=this.git6||l(this.primaryColor,{h:60}),this.git7=this.git7||l(this.primaryColor,{h:120}),this.darkMode?(this.git0=(0,m.A)(this.git0,25),this.git1=(0,m.A)(this.git1,25),this.git2=(0,m.A)(this.git2,25),this.git3=(0,m.A)(this.git3,25),this.git4=(0,m.A)(this.git4,25),this.git5=(0,m.A)(this.git5,25),this.git6=(0,m.A)(this.git6,25),this.git7=(0,m.A)(this.git7,25)):(this.git0=(0,p.A)(this.git0,25),this.git1=(0,p.A)(this.git1,25),this.git2=(0,p.A)(this.git2,25),this.git3=(0,p.A)(this.git3,25),this.git4=(0,p.A)(this.git4,25),this.git5=(0,p.A)(this.git5,25),this.git6=(0,p.A)(this.git6,25),this.git7=(0,p.A)(this.git7,25)),this.gitInv0=this.gitInv0||f(this.git0),this.gitInv1=this.gitInv1||f(this.git1),this.gitInv2=this.gitInv2||f(this.git2),this.gitInv3=this.gitInv3||f(this.git3),this.gitInv4=this.gitInv4||f(this.git4),this.gitInv5=this.gitInv5||f(this.git5),this.gitInv6=this.gitInv6||f(this.git6),this.gitInv7=this.gitInv7||f(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||we,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ee}calculate(e){if("object"!=typeof e)return void this.updateColors();const t=Object.keys(e);t.forEach(t=>{this[t]=e[t]}),this.updateColors(),t.forEach(t=>{this[t]=e[t]})}};return t.calculate(e),t}},dark:{getThemeVariables:e=>{const t=new class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=(0,m.A)(this.primaryColor,16),this.tertiaryColor=l(this.primaryColor,{h:-160}),this.primaryBorderColor=f(this.background),this.secondaryBorderColor=Oe(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Oe(this.tertiaryColor,this.darkMode),this.primaryTextColor=f(this.primaryColor),this.secondaryTextColor=f(this.secondaryColor),this.tertiaryTextColor=f(this.tertiaryColor),this.lineColor=f(this.background),this.textColor=f(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=(0,m.A)(f("#323D47"),10),this.lineColor="calculated",this.border1="#81B1DB",this.border2=(0,u.A)(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=(0,p.A)("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=(0,p.A)(this.sectionBkgColor,10),this.taskBorderColor=(0,u.A)(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=(0,u.A)(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var e,t,n,a,i,r,o,s,c,d,u;this.secondBkg=(0,m.A)(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=(0,m.A)(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.mainContrastColor,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=(0,m.A)(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=l(this.primaryColor,{h:64}),this.fillType3=l(this.secondaryColor,{h:64}),this.fillType4=l(this.primaryColor,{h:-64}),this.fillType5=l(this.secondaryColor,{h:-64}),this.fillType6=l(this.primaryColor,{h:128}),this.fillType7=l(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||l(this.primaryColor,{h:30}),this.cScale4=this.cScale4||l(this.primaryColor,{h:60}),this.cScale5=this.cScale5||l(this.primaryColor,{h:90}),this.cScale6=this.cScale6||l(this.primaryColor,{h:120}),this.cScale7=this.cScale7||l(this.primaryColor,{h:150}),this.cScale8=this.cScale8||l(this.primaryColor,{h:210}),this.cScale9=this.cScale9||l(this.primaryColor,{h:270}),this.cScale10=this.cScale10||l(this.primaryColor,{h:300}),this.cScale11=this.cScale11||l(this.primaryColor,{h:330});for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||f(this["cScale"+e]);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScalePeer"+e]=this["cScalePeer"+e]||(0,m.A)(this["cScale"+e],10);for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||l(this.mainBkg,{h:30,s:-30,l:-(4*e-10)}),this["surfacePeer"+e]=this["surfacePeer"+e]||l(this.mainBkg,{h:30,s:-30,l:-(4*e-7)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["pie"+e]=this["cScale"+e];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||l(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||l(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||l(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||l(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||l(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||l(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||(0,_.A)(this.quadrant1Fill)?(0,m.A)(this.quadrant1Fill):(0,p.A)(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:(null==(e=this.xyChart)?void 0:e.backgroundColor)||this.background,titleColor:(null==(t=this.xyChart)?void 0:t.titleColor)||this.primaryTextColor,xAxisTitleColor:(null==(n=this.xyChart)?void 0:n.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:(null==(a=this.xyChart)?void 0:a.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:(null==(i=this.xyChart)?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:(null==(r=this.xyChart)?void 0:r.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:(null==(o=this.xyChart)?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:(null==(s=this.xyChart)?void 0:s.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:(null==(c=this.xyChart)?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:(null==(d=this.xyChart)?void 0:d.yAxisLineColor)||this.primaryTextColor,plotColorPalette:(null==(u=this.xyChart)?void 0:u.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?(0,p.A)(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=(0,m.A)(this.secondaryColor,20),this.git1=(0,m.A)(this.pie2||this.secondaryColor,20),this.git2=(0,m.A)(this.pie3||this.tertiaryColor,20),this.git3=(0,m.A)(this.pie4||l(this.primaryColor,{h:-30}),20),this.git4=(0,m.A)(this.pie5||l(this.primaryColor,{h:-60}),20),this.git5=(0,m.A)(this.pie6||l(this.primaryColor,{h:-90}),10),this.git6=(0,m.A)(this.pie7||l(this.primaryColor,{h:60}),10),this.git7=(0,m.A)(this.pie8||l(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||f(this.git0),this.gitInv1=this.gitInv1||f(this.git1),this.gitInv2=this.gitInv2||f(this.git2),this.gitInv3=this.gitInv3||f(this.git3),this.gitInv4=this.gitInv4||f(this.git4),this.gitInv5=this.gitInv5||f(this.git5),this.gitInv6=this.gitInv6||f(this.git6),this.gitInv7=this.gitInv7||f(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||f(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||f(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||(0,m.A)(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||(0,m.A)(this.background,2)}calculate(e){if("object"!=typeof e)return void this.updateColors();const t=Object.keys(e);t.forEach(t=>{this[t]=e[t]}),this.updateColors(),t.forEach(t=>{this[t]=e[t]})}};return t.calculate(e),t}},default:{getThemeVariables:Ae},forest:{getThemeVariables:e=>{const t=new class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=(0,m.A)("#cde498",10),this.primaryBorderColor=Oe(this.primaryColor,this.darkMode),this.secondaryBorderColor=Oe(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=Oe(this.tertiaryColor,this.darkMode),this.primaryTextColor=f(this.primaryColor),this.secondaryTextColor=f(this.secondaryColor),this.tertiaryTextColor=f(this.primaryColor),this.lineColor=f(this.background),this.textColor=f(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="grey",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var e,t,n,a,i,r,o,s,c,d,u;this.actorBorder=(0,p.A)(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||l(this.primaryColor,{h:30}),this.cScale4=this.cScale4||l(this.primaryColor,{h:60}),this.cScale5=this.cScale5||l(this.primaryColor,{h:90}),this.cScale6=this.cScale6||l(this.primaryColor,{h:120}),this.cScale7=this.cScale7||l(this.primaryColor,{h:150}),this.cScale8=this.cScale8||l(this.primaryColor,{h:210}),this.cScale9=this.cScale9||l(this.primaryColor,{h:270}),this.cScale10=this.cScale10||l(this.primaryColor,{h:300}),this.cScale11=this.cScale11||l(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||(0,p.A)(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||(0,p.A)(this.tertiaryColor,40);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScale"+e]=(0,p.A)(this["cScale"+e],10),this["cScalePeer"+e]=this["cScalePeer"+e]||(0,p.A)(this["cScale"+e],25);for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleInv"+e]=this["cScaleInv"+e]||l(this["cScale"+e],{h:180});this.scaleLabelColor="calculated"!==this.scaleLabelColor&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let e=0;e<this.THEME_COLOR_LIMIT;e++)this["cScaleLabel"+e]=this["cScaleLabel"+e]||this.scaleLabelColor;for(let e=0;e<5;e++)this["surface"+e]=this["surface"+e]||l(this.mainBkg,{h:30,s:-30,l:-(5+5*e)}),this["surfacePeer"+e]=this["surfacePeer"+e]||l(this.mainBkg,{h:30,s:-30,l:-(8+5*e)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=l(this.primaryColor,{h:64}),this.fillType3=l(this.secondaryColor,{h:64}),this.fillType4=l(this.primaryColor,{h:-64}),this.fillType5=l(this.secondaryColor,{h:-64}),this.fillType6=l(this.primaryColor,{h:128}),this.fillType7=l(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||l(this.primaryColor,{l:-30}),this.pie5=this.pie5||l(this.secondaryColor,{l:-30}),this.pie6=this.pie6||l(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||l(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||l(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||l(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||l(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||l(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||l(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||l(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||l(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||l(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||l(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||l(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||l(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||(0,_.A)(this.quadrant1Fill)?(0,m.A)(this.quadrant1Fill):(0,p.A)(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:(null==(e=this.xyChart)?void 0:e.backgroundColor)||this.background,titleColor:(null==(t=this.xyChart)?void 0:t.titleColor)||this.primaryTextColor,xAxisTitleColor:(null==(n=this.xyChart)?void 0:n.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:(null==(a=this.xyChart)?void 0:a.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:(null==(i=this.xyChart)?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:(null==(r=this.xyChart)?void 0:r.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:(null==(o=this.xyChart)?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:(null==(s=this.xyChart)?void 0:s.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:(null==(c=this.xyChart)?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:(null==(d=this.xyChart)?void 0:d.yAxisLineColor)||this.primaryTextColor,plotColorPalette:(null==(u=this.xyChart)?void 0:u.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||l(this.primaryColor,{h:-30}),this.git4=this.git4||l(this.primaryColor,{h:-60}),this.git5=this.git5||l(this.primaryColor,{h:-90}),this.git6=this.git6||l(this.primaryColor,{h:60}),this.git7=this.git7||l(this.primaryColor,{h:120}),this.darkMode?(this.git0=(0,m.A)(this.git0,25),this.git1=(0,m.A)(this.git1,25),this.git2=(0,m.A)(this.git2,25),this.git3=(0,m.A)(this.git3,25),this.git4=(0,m.A)(this.git4,25),this.git5=(0,m.A)(this.git5,25),this.git6=(0,m.A)(this.git6,25),this.git7=(0,m.A)(this.git7,25)):(this.git0=(0,p.A)(this.git0,25),this.git1=(0,p.A)(this.git1,25),this.git2=(0,p.A)(this.git2,25),this.git3=(0,p.A)(this.git3,25),this.git4=(0,p.A)(this.git4,25),this.git5=(0,p.A)(this.git5,25),this.git6=(0,p.A)(this.git6,25),this.git7=(0,p.A)(this.git7,25)),this.gitInv0=this.gitInv0||f(this.git0),this.gitInv1=this.gitInv1||f(this.git1),this.gitInv2=this.gitInv2||f(this.git2),this.gitInv3=this.gitInv3||f(this.git3),this.gitInv4=this.gitInv4||f(this.git4),this.gitInv5=this.gitInv5||f(this.git5),this.gitInv6=this.gitInv6||f(this.git6),this.gitInv7=this.gitInv7||f(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||f(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||f(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||we,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Ee}calculate(e){if("object"!=typeof e)return void this.updateColors();const t=Object.keys(e);t.forEach(t=>{this[t]=e[t]}),this.updateColors(),t.forEach(t=>{this[t]=e[t]})}};return t.calculate(e),t}},neutral:{getThemeVariables:e=>{const t=new Le;return t.calculate(e),t}}},Me={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},theme:"default",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","maxEdges"],legacyMathML:!1,deterministicIds:!1,fontSize:16},Pe={...Me,deterministicIDSeed:void 0,themeCSS:void 0,themeVariables:ke.default.getThemeVariables(),sequence:{...Me.sequence,messageFont:function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},noteFont:function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},actorFont:function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}}},gantt:{...Me.gantt,tickInterval:void 0,useWidth:void 0},c4:{...Me.c4,useWidth:void 0,personFont:function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},external_personFont:function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},systemFont:function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},external_systemFont:function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},system_dbFont:function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},external_system_dbFont:function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},system_queueFont:function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},external_system_queueFont:function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},containerFont:function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},external_containerFont:function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},container_dbFont:function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},external_container_dbFont:function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},container_queueFont:function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},external_container_queueFont:function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},componentFont:function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},external_componentFont:function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},component_dbFont:function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},external_component_dbFont:function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},component_queueFont:function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},external_component_queueFont:function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},boundaryFont:function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},messageFont:function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}}},pie:{...Me.pie,useWidth:984},xyChart:{...Me.xyChart,useWidth:void 0},requirement:{...Me.requirement,useWidth:void 0},gitGraph:{...Me.gitGraph,useMaxWidth:!1},sankey:{...Me.sankey,useMaxWidth:!1}},Te=(e,t="")=>Object.keys(e).reduce((n,a)=>Array.isArray(e[a])?n:"object"==typeof e[a]&&null!==e[a]?[...n,t+a,...Te(e[a],"")]:[...n,t+a],[]),Ue=new Set(Te(Pe,"")),Fe=Pe,He=e=>{if(re.debug("sanitizeDirective called with",e),"object"==typeof e&&null!=e)if(Array.isArray(e))e.forEach(e=>He(e));else{for(const t of Object.keys(e)){if(re.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!Ue.has(t)||null==e[t]){re.debug("sanitize deleting key: ",t),delete e[t];continue}if("object"==typeof e[t]){re.debug("sanitizing object",t),He(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const a of n)t.includes(a)&&(re.debug("sanitizing css option",t),e[t]=Re(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];(null==n?void 0:n.match)&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}re.debug("After sanitization",e)}},Re=e=>{let t=0,n=0;for(const a of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";"{"===a?t++:"}"===a&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},Ne=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Be=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,je=/\s*%%.*\n/gm;class Ve extends Error{constructor(e){super(e),this.name="UnknownDiagramError"}}const ze={},Ge=function(e,t){e=e.replace(Ne,"").replace(Be,"").replace(je,"\n");for(const[n,{detector:a}]of Object.entries(ze))if(a(e,t))return n;throw new Ve(`No diagram type detected matching given configuration for text: ${e}`)},Ke=(...e)=>{for(const{id:t,detector:n,loader:a}of e)We(t,n,a)},We=(e,t,n)=>{ze[e]?re.error(`Detector with key ${e} already exists`):ze[e]={detector:t,loader:n},re.debug(`Detector with key ${e} added${n?" with loader":""}`)},qe=(e,t,{depth:n=2,clobber:a=!1}={})=>{const i={depth:n,clobber:a};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(t=>qe(e,t,i)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(t=>{e.includes(t)||e.push(t)}),e):void 0===e||n<=0?null!=e&&"object"==typeof e&&"object"==typeof t?Object.assign(e,t):t:(void 0!==t&&"object"==typeof e&&"object"==typeof t&&Object.keys(t).forEach(i=>{"object"!=typeof t[i]||void 0!==e[i]&&"object"!=typeof e[i]?(a||"object"!=typeof e[i]&&"object"!=typeof t[i])&&(e[i]=t[i]):(void 0===e[i]&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=qe(e[i],t[i],{depth:n-1,clobber:a}))}),e)},Qe=qe,Ye="",Je={curveBasis:o.hrM,curveBasisClosed:o.Ju4,curveBasisOpen:o.TA3,curveBumpX:o.Qi0,curveBumpY:o.jGM,curveBundle:o.BEq,curveCardinalClosed:o.mlC,curveCardinalOpen:o.TrU,curveCardinal:o.x8u,curveCatmullRomClosed:o.V7f,curveCatmullRomOpen:o.nVp,curveCatmullRom:o.mDi,curveLinear:o.uUB,curveLinearClosed:o.Hx9,curveMonotoneX:o.pVG,curveMonotoneY:o.yxU,curveNatural:o.Yf2,curveStep:o.MZz,curveStepAfter:o.WPb,curveStepBefore:o.ayv},Xe=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,Ze=function(e,t=null){try{const n=new RegExp(`[%]{2}(?![{]${Xe.source})(?=[}][%]{2}).*\n`,"ig");let a;e=e.trim().replace(n,"").replace(/'/gm,'"'),re.debug(`Detecting diagram directive${null!==t?" type:"+t:""} based on the text:${e}`);const i=[];for(;null!==(a=Be.exec(e));)if(a.index===Be.lastIndex&&Be.lastIndex++,a&&!t||t&&a[1]&&a[1].match(t)||t&&a[2]&&a[2].match(t)){const e=a[1]?a[1]:a[2],t=a[3]?a[3].trim():a[4]?JSON.parse(a[4].trim()):null;i.push({type:e,args:t})}return 0===i.length?{type:e,args:null}:1===i.length?i[0]:i}catch(n){return re.error(`ERROR: ${n.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}};function $e(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return Je[n]??t}function et(e,t){return e&&t?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):0}const tt=(e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},nt=(e,t)=>{let n,a=t;for(const t of e){if(n){const e=et(t,n);if(e<a)a-=e;else{const i=a/e;if(i<=0)return n;if(i>=1)return{x:t.x,y:t.y};if(i>0&&i<1)return{x:tt((1-i)*n.x+i*t.x,5),y:tt((1-i)*n.y+i*t.y,5)}}}n=t}throw new Error("Could not find a suitable point for the given distance")};function at(e){let t="",n="";for(const a of e)void 0!==a&&(a.startsWith("color:")||a.startsWith("text-align:")?n=n+a+";":t=t+a+";");return{style:t,labelStyle:n}}let it=0;const rt=()=>(it++,"id-"+Math.random().toString(36).substr(2,12)+"-"+it),ot=e=>function(e){let t="";const n="0123456789abcdef",a=n.length;for(let i=0;i<e;i++)t+=n.charAt(Math.floor(Math.random()*a));return t}(e.length),st=function(e,t){const n=t.text.replace(Ce.lineBreakRegex," "),[,a]=_t(t.fontSize),i=e.append("text");i.attr("x",t.x),i.attr("y",t.y),i.style("text-anchor",t.anchor),i.style("font-family",t.fontFamily),i.style("font-size",a),i.style("font-weight",t.fontWeight),i.attr("fill",t.fill),void 0!==t.class&&i.attr("class",t.class);const r=i.append("tspan");return r.attr("x",t.x+2*t.textMargin),r.attr("fill",t.fill),r.text(n),i},ct=(0,h.A)((e,t,n)=>{if(!e)return e;if(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),Ce.lineBreakRegex.test(e))return e;const a=e.split(" "),i=[];let r="";return a.forEach((e,o)=>{const s=ut(`${e} `,n),c=ut(r,n);if(s>t){const{hyphenatedStrings:a,remainingWord:o}=dt(e,t,"-",n);i.push(r,...a),r=o}else c+s>=t?(i.push(r),r=e):r=[r,e].filter(Boolean).join(" ");o+1===a.length&&i.push(r)}),i.filter(e=>""!==e).join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),dt=(0,h.A)((e,t,n="-",a)=>{a=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},a);const i=[...e],r=[];let o="";return i.forEach((e,s)=>{const c=`${o}${e}`;if(ut(c,a)>=t){const e=s+1,t=i.length===e,a=`${c}${n}`;r.push(t?c:a),o=""}else o=c}),{hyphenatedStrings:r,remainingWord:o}},(e,t,n="-",a)=>`${e}${t}${n}${a.fontSize}${a.fontWeight}${a.fontFamily}`);function lt(e,t){return ft(e,t).height}function ut(e,t){return ft(e,t).width}const ft=(0,h.A)((e,t)=>{const{fontSize:n=12,fontFamily:a="Arial",fontWeight:i=400}=t;if(!e)return{width:0,height:0};const[,r]=_t(n),s=["sans-serif",a],c=e.split(Ce.lineBreakRegex),d=[],l=(0,o.Htv)("body");if(!l.remove)return{width:0,height:0,lineHeight:0};const u=l.append("svg");for(const e of s){let t=0;const n={width:0,height:0,lineHeight:0};for(const a of c){const o={x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""};o.text=a||Ye;const s=st(u,o).style("font-size",r).style("font-weight",i).style("font-family",e),c=(s._groups||s)[0][0].getBBox();if(0===c.width&&0===c.height)throw new Error("svg element not in render tree");n.width=Math.round(Math.max(n.width,c.width)),t=Math.round(c.height),n.height+=t,n.lineHeight=Math.round(Math.max(n.lineHeight,t))}d.push(n)}return u.remove(),d[isNaN(d[1].height)||isNaN(d[1].width)||isNaN(d[1].lineHeight)||d[0].height>d[1].height&&d[0].width>d[1].width&&d[0].lineHeight>d[1].lineHeight?0:1]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`);let pt;function mt(e){return"str"in e}const _t=e=>{if("number"==typeof e)return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]};function ht(e,t){return(0,b.A)({},e,t)}const bt={assignWithDepth:Qe,wrapLabel:ct,calculateTextHeight:lt,calculateTextWidth:ut,calculateTextDimensions:ft,cleanAndMerge:ht,detectInit:function(e,t){const n=Ze(e,/(?:init\b)|(?:initialize\b)/);let a={};if(Array.isArray(n)){const e=n.map(e=>e.args);He(e),a=Qe(a,[...e])}else a=n.args;if(!a)return;let i=Ge(e,t);const r="config";return void 0!==a[r]&&("flowchart-v2"===i&&(i="flowchart"),a[i]=a[r],delete a[r]),a},detectDirective:Ze,isSubstringInArray:function(e,t){for(const[n,a]of t.entries())if(a.match(e))return n;return-1},interpolateToCurve:$e,calcLabelPosition:function(e){return 1===e.length?e[0]:function(e){let t,n=0;return e.forEach(e=>{n+=et(e,t),t=e}),nt(e,n/2)}(e)},calcCardinalityPosition:(e,t,n)=>{re.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const a=nt(t,25),i=e?10:5,r=Math.atan2(t[0].y-a.y,t[0].x-a.x),o={x:0,y:0};return o.x=Math.sin(r)*i+(t[0].x+a.x)/2,o.y=-Math.cos(r)*i+(t[0].y+a.y)/2,o},calcTerminalLabelPosition:function(e,t,n){const a=structuredClone(n);re.info("our points",a),"start_left"!==t&&"start_right"!==t&&a.reverse();const i=nt(a,25+e),r=10+.5*e,o=Math.atan2(a[0].y-i.y,a[0].x-i.x),s={x:0,y:0};return"start_left"===t?(s.x=Math.sin(o+Math.PI)*r+(a[0].x+i.x)/2,s.y=-Math.cos(o+Math.PI)*r+(a[0].y+i.y)/2):"end_right"===t?(s.x=Math.sin(o-Math.PI)*r+(a[0].x+i.x)/2-5,s.y=-Math.cos(o-Math.PI)*r+(a[0].y+i.y)/2-5):"end_left"===t?(s.x=Math.sin(o)*r+(a[0].x+i.x)/2-5,s.y=-Math.cos(o)*r+(a[0].y+i.y)/2-5):(s.x=Math.sin(o)*r+(a[0].x+i.x)/2,s.y=-Math.cos(o)*r+(a[0].y+i.y)/2),s},formatUrl:function(e,t){const n=e.trim();if(n)return"loose"!==t.securityLevel?(0,r.Uf)(n):n},getStylesFromArray:at,generateId:rt,random:ot,runFunc:(e,...t)=>{const n=e.split("."),a=n.length-1,i=n[a];let r=window;for(let t=0;t<a;t++)if(r=r[n[t]],!r)return void re.error(`Function name: ${e} not found in window`);r[i](...t)},entityDecode:function(e){return pt=pt||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),pt.innerHTML=e,unescape(pt.textContent)},insertTitle:(e,t,n,a)=>{var i;if(!a)return;const r=null==(i=e.node())?void 0:i.getBBox();r&&e.append("text").text(a).attr("x",r.x+r.width/2).attr("y",-n).attr("class",t)},parseFontSize:_t,InitIDGenerator:class{constructor(e=!1,t){this.count=0,this.count=t?t.length:0,this.next=e?()=>this.count++:()=>Date.now()}}},gt=function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},vt="10.9.3",yt=Object.freeze(Fe);let St,Dt=Qe({},yt),It=[],xt=Qe({},yt);const Ct=(e,t)=>{let n=Qe({},e),a={};for(const e of t)At(e),a=Qe(a,e);if(n=Qe(n,a),a.theme&&a.theme in ke){const e=Qe({},St),t=Qe(e.themeVariables||{},a.themeVariables);n.theme&&n.theme in ke&&(n.themeVariables=ke[n.theme].getThemeVariables(t))}return xt=n,Pt(xt),xt},Ot=()=>Qe({},Dt),wt=e=>(Pt(e),Qe(xt,e),Et()),Et=()=>Qe({},xt),At=e=>{e&&(["secure",...Dt.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(re.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{"string"==typeof e[t]&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],"object"==typeof e[t]&&At(e[t])}))},Lt=(e=Dt)=>{It=[],Ct(e,It)},kt={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},Mt={},Pt=e=>{var t;e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&(Mt[t="LAZY_LOAD_DEPRECATED"]||(re.warn(kt[t]),Mt[t]=!0))},Tt={id:"c4",detector:e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),loader:async()=>{const{diagram:e}=await n.e(309).then(n.bind(n,7309));return{id:"c4",diagram:e}}},Ut="flowchart",Ft={id:Ut,detector:(e,t)=>{var n,a;return"dagre-wrapper"!==(null==(n=null==t?void 0:t.flowchart)?void 0:n.defaultRenderer)&&"elk"!==(null==(a=null==t?void 0:t.flowchart)?void 0:a.defaultRenderer)&&/^\s*graph/.test(e)},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(916),n.e(396),n.e(531),n.e(738),n.e(743),n.e(618)]).then(n.bind(n,3618));return{id:Ut,diagram:e}}},Ht="flowchart-v2",Rt={id:Ht,detector:(e,t)=>{var n,a,i;return"dagre-d3"!==(null==(n=null==t?void 0:t.flowchart)?void 0:n.defaultRenderer)&&"elk"!==(null==(a=null==t?void 0:t.flowchart)?void 0:a.defaultRenderer)&&(!(!/^\s*graph/.test(e)||"dagre-wrapper"!==(null==(i=null==t?void 0:t.flowchart)?void 0:i.defaultRenderer))||/^\s*flowchart/.test(e))},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(916),n.e(396),n.e(531),n.e(738),n.e(743),n.e(402)]).then(n.bind(n,8402));return{id:Ht,diagram:e}}},Nt={id:"er",detector:e=>/^\s*erDiagram/.test(e),loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(396),n.e(431)]).then(n.bind(n,431));return{id:"er",diagram:e}}},Bt="gitGraph",jt={id:Bt,detector:e=>/^\s*gitGraph/.test(e),loader:async()=>{const{diagram:e}=await n.e(568).then(n.bind(n,3568));return{id:Bt,diagram:e}}},Vt="gantt",zt={id:Vt,detector:e=>/^\s*gantt/.test(e),loader:async()=>{const{diagram:e}=await n.e(882).then(n.bind(n,4882));return{id:Vt,diagram:e}}},Gt="info",Kt={id:Gt,detector:e=>/^\s*info/.test(e),loader:async()=>{const{diagram:e}=await n.e(60).then(n.bind(n,60));return{id:Gt,diagram:e}}},Wt={id:"pie",detector:e=>/^\s*pie/.test(e),loader:async()=>{const{diagram:e}=await n.e(109).then(n.bind(n,7109));return{id:"pie",diagram:e}}},qt="quadrantChart",Qt={id:qt,detector:e=>/^\s*quadrantChart/.test(e),loader:async()=>{const{diagram:e}=await n.e(741).then(n.bind(n,1741));return{id:qt,diagram:e}}},Yt="xychart",Jt={id:Yt,detector:e=>/^\s*xychart-beta/.test(e),loader:async()=>{const{diagram:e}=await Promise.all([n.e(916),n.e(758)]).then(n.bind(n,5758));return{id:Yt,diagram:e}}},Xt="requirement",Zt={id:Xt,detector:e=>/^\s*requirement(Diagram)?/.test(e),loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(396),n.e(854)]).then(n.bind(n,5854));return{id:Xt,diagram:e}}},$t="sequence",en={id:$t,detector:e=>/^\s*sequenceDiagram/.test(e),loader:async()=>{const{diagram:e}=await n.e(330).then(n.bind(n,7330));return{id:$t,diagram:e}}},tn="class",nn={id:tn,detector:(e,t)=>{var n;return"dagre-wrapper"!==(null==(n=null==t?void 0:t.class)?void 0:n.defaultRenderer)&&/^\s*classDiagram/.test(e)},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(396),n.e(128),n.e(989)]).then(n.bind(n,1989));return{id:tn,diagram:e}}},an="classDiagram",rn={id:an,detector:(e,t)=>{var n;return!(!/^\s*classDiagram/.test(e)||"dagre-wrapper"!==(null==(n=null==t?void 0:t.class)?void 0:n.defaultRenderer))||/^\s*classDiagram-v2/.test(e)},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(916),n.e(396),n.e(531),n.e(738),n.e(128),n.e(405)]).then(n.bind(n,8405));return{id:an,diagram:e}}},on="state",sn={id:on,detector:(e,t)=>{var n;return"dagre-wrapper"!==(null==(n=null==t?void 0:t.state)?void 0:n.defaultRenderer)&&/^\s*stateDiagram/.test(e)},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(396),n.e(652),n.e(412)]).then(n.bind(n,2412));return{id:on,diagram:e}}},cn="stateDiagram",dn={id:cn,detector:(e,t)=>{var n;return!!/^\s*stateDiagram-v2/.test(e)||!(!/^\s*stateDiagram/.test(e)||"dagre-wrapper"!==(null==(n=null==t?void 0:t.state)?void 0:n.defaultRenderer))},loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(916),n.e(396),n.e(531),n.e(738),n.e(652),n.e(760)]).then(n.bind(n,6760));return{id:cn,diagram:e}}},ln="journey",un={id:ln,detector:e=>/^\s*journey/.test(e),loader:async()=>{const{diagram:e}=await n.e(107).then(n.bind(n,3107));return{id:ln,diagram:e}}},fn=function(e,t,n,a){const i=function(e,t,n){let a=new Map;return n?(a.set("width","100%"),a.set("style",`max-width: ${t}px;`)):(a.set("height",e),a.set("width",t)),a}(t,n,a);!function(e,t){for(let n of t)e.attr(n[0],n[1])}(e,i)},pn=function(e,t,n,a){const i=t.node().getBBox(),r=i.width,o=i.height;re.info(`SVG bounds: ${r}x${o}`,i);let s=0,c=0;re.info(`Graph bounds: ${s}x${c}`,e),s=r+2*n,c=o+2*n,re.info(`Calculated bounds: ${s}x${c}`),fn(t,c,s,a);const d=`${i.x-n} ${i.y-n} ${i.width+2*n} ${i.height+2*n}`;t.attr("viewBox",d)},mn={};let _n="",hn="",bn="";const gn=e=>fe(e,Et()),vn=()=>{_n="",bn="",hn=""},yn=e=>{_n=gn(e).replace(/^\s+/g,"")},Sn=()=>_n,Dn=e=>{bn=gn(e).replace(/\n\s+/g,"\n")},In=()=>bn,xn=e=>{hn=gn(e)},Cn=()=>hn,On=Object.freeze(Object.defineProperty({__proto__:null,clear:vn,getAccDescription:In,getAccTitle:Sn,getDiagramTitle:Cn,setAccDescription:Dn,setAccTitle:yn,setDiagramTitle:xn},Symbol.toStringTag,{value:"Module"})),wn=re,En=oe,An=Et,Ln=wt,kn=yt,Mn=e=>fe(e,An()),Pn=pn,Tn={},Un=(e,t,n)=>{var a,i,r;if(Tn[e])throw new Error(`Diagram ${e} already registered.`);Tn[e]=t,n&&We(e,n),i=e,void 0!==(r=t.styles)&&(mn[i]=r),null==(a=t.injectUtils)||a.call(t,wn,En,An,Mn,Pn,On,()=>{})},Fn=e=>{if(e in Tn)return Tn[e];throw new Hn(e)};class Hn extends Error{constructor(e){super(`Diagram ${e} not found.`)}}const Rn=e=>{var t;const{securityLevel:n}=An();let a=(0,o.Htv)("body");if("sandbox"===n){const n=(null==(t=(0,o.Htv)(`#i${e}`).node())?void 0:t.contentDocument)??document;a=(0,o.Htv)(n.body)}return a.select(`#${e}`)},Nn={draw:(e,t,n)=>{re.debug("rendering svg for syntax error\n");const a=Rn(t),i=a.append("g");a.attr("viewBox","0 0 2412 512"),fn(a,100,512,!0),i.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),i.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),i.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),i.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),i.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),i.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),i.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),i.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)}},Bn=Nn,jn={db:{},renderer:Nn,parser:{parser:{yy:{}},parse:()=>{}}},Vn="flowchart-elk",zn={id:Vn,detector:(e,t)=>{var n;return!!(/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&"elk"===(null==(n=null==t?void 0:t.flowchart)?void 0:n.defaultRenderer))},loader:async()=>{const{diagram:e}=await Promise.all([n.e(916),n.e(531),n.e(743),n.e(499)]).then(n.bind(n,9499));return{id:Vn,diagram:e}}},Gn="timeline",Kn={id:Gn,detector:e=>/^\s*timeline/.test(e),loader:async()=>{const{diagram:e}=await n.e(674).then(n.bind(n,4674));return{id:Gn,diagram:e}}},Wn="mindmap",qn={id:Wn,detector:e=>/^\s*mindmap/.test(e),loader:async()=>{const{diagram:e}=await Promise.all([n.e(916),n.e(361)]).then(n.bind(n,2361));return{id:Wn,diagram:e}}},Qn="sankey",Yn={id:Qn,detector:e=>/^\s*sankey-beta/.test(e),loader:async()=>{const{diagram:e}=await n.e(421).then(n.bind(n,3421));return{id:Qn,diagram:e}}},Jn="block",Xn={id:Jn,detector:e=>/^\s*block-beta/.test(e),loader:async()=>{const{diagram:e}=await Promise.all([n.e(857),n.e(916),n.e(531),n.e(50)]).then(n.bind(n,4050));return{id:Jn,diagram:e}}};let Zn=!1;const $n=()=>{Zn||(Zn=!0,Un("error",jn,e=>"error"===e.toLowerCase().trim()),Un("---",{db:{clear:()=>{}},styles:{},renderer:{draw:()=>{}},parser:{parser:{yy:{}},parse:()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")}},init:()=>null},e=>e.toLowerCase().trimStart().startsWith("---")),Ke(Tt,rn,nn,Nt,zt,Kt,Wt,Zt,en,zn,Rt,Ft,qn,Kn,jt,dn,sn,un,Qt,Yn,Jt,Xn))};class ea{constructor(e,t={}){this.text=e,this.metadata=t,this.type="graph",this.text=function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(e){return e.substring(0,e.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(e){return e.substring(0,e.length-1)}),t=t.replace(/#\w+;/g,function(e){const t=e.substring(1,e.length-1);return/^\+?\d+$/.test(t)?""+t+"":""+t+""}),t}(e),this.text+="\n";const n=Et();try{this.type=Ge(e,n)}catch(e){this.type="error",this.detectError=e}const a=Fn(this.type);re.debug("Type "+this.type),this.db=a.db,this.renderer=a.renderer,this.parser=a.parser,this.parser.parser.yy=this.db,this.init=a.init,this.parse()}parse(){var e,t,n,a,i;if(this.detectError)throw this.detectError;null==(t=(e=this.db).clear)||t.call(e);const r=Et();null==(n=this.init)||n.call(this,r),this.metadata.title&&(null==(i=(a=this.db).setDiagramTitle)||i.call(a,this.metadata.title)),this.parser.parse(this.text)}async render(e,t){await this.renderer.draw(this.text,e,t,this)}getParser(){return this.parser}getType(){return this.type}}let ta=[];var na=function(e,t){var n,a="";for(n=0;n<t;n+=1)a+=e;return a},aa=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e};function ia(e,t){var n="",a=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),a+" "+n):a}function ra(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=ia(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}ra.prototype=Object.create(Error.prototype),ra.prototype.constructor=ra,ra.prototype.toString=function(e){return this.name+": "+ia(this,e)};var oa=ra;function sa(e,t,n,a,i){var r="",o="",s=Math.floor(i/2)-1;return a-t>s&&(t=a-s+(r=" ... ").length),n-a>s&&(n=a+s-(o=" ...").length),{str:r+e.slice(t,n).replace(/\t/g,"")+o,pos:a-t+r.length}}function ca(e,t){return na(" ",t-e.length)+e}var da=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],la=["scalar","sequence","mapping"],ua=function(e,t){var n,a;if(t=t||{},Object.keys(t).forEach(function(t){if(-1===da.indexOf(t))throw new oa('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(n=t.styleAliases||null,a={},null!==n&&Object.keys(n).forEach(function(e){n[e].forEach(function(t){a[String(t)]=e})}),a),-1===la.indexOf(this.kind))throw new oa('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function fa(e,t){var n=[];return e[t].forEach(function(e){var t=n.length;n.forEach(function(n,a){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=a)}),n[t]=e}),n}function pa(e){return this.extend(e)}pa.prototype.extend=function(e){var t=[],n=[];if(e instanceof ua)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new oa("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach(function(e){if(!(e instanceof ua))throw new oa("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new oa("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new oa("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(e){if(!(e instanceof ua))throw new oa("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(pa.prototype);return a.implicit=(this.implicit||[]).concat(t),a.explicit=(this.explicit||[]).concat(n),a.compiledImplicit=fa(a,"implicit"),a.compiledExplicit=fa(a,"explicit"),a.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function a(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(a);return n}(a.compiledImplicit,a.compiledExplicit),a};var ma=new pa({explicit:[new ua("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new ua("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new ua("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),_a=new ua("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),ha=new ua("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function ba(e){return 48<=e&&e<=55}function ga(e){return 48<=e&&e<=57}var va=new ua("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,a=e.length,i=0,r=!1;if(!a)return!1;if("-"!==(t=e[i])&&"+"!==t||(t=e[++i]),"0"===t){if(i+1===a)return!0;if("b"===(t=e[++i])){for(i++;i<a;i++)if("_"!==(t=e[i])){if("0"!==t&&"1"!==t)return!1;r=!0}return r&&"_"!==t}if("x"===t){for(i++;i<a;i++)if("_"!==(t=e[i])){if(!(48<=(n=e.charCodeAt(i))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;r=!0}return r&&"_"!==t}if("o"===t){for(i++;i<a;i++)if("_"!==(t=e[i])){if(!ba(e.charCodeAt(i)))return!1;r=!0}return r&&"_"!==t}}if("_"===t)return!1;for(;i<a;i++)if("_"!==(t=e[i])){if(!ga(e.charCodeAt(i)))return!1;r=!0}return!(!r||"_"===t)},construct:function(e){var t,n=e,a=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(a=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return a*parseInt(n.slice(2),2);if("x"===n[1])return a*parseInt(n.slice(2),16);if("o"===n[1])return a*parseInt(n.slice(2),8)}return a*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!aa(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),ya=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),Sa=/^[-+]?[0-9]+e/,Da=new ua("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!ya.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||aa(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(aa(e))return"-0.0";return n=e.toString(10),Sa.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),Ia=ma.extend({implicit:[_a,ha,va,Da]}),xa=Ia,Ca=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Oa=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),wa=new ua("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==Ca.exec(e)||null!==Oa.exec(e))},construct:function(e){var t,n,a,i,r,o,s,c,d=0,l=null;if(null===(t=Ca.exec(e))&&(t=Oa.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],a=+t[2]-1,i=+t[3],!t[4])return new Date(Date.UTC(n,a,i));if(r=+t[4],o=+t[5],s=+t[6],t[7]){for(d=t[7].slice(0,3);d.length<3;)d+="0";d=+d}return t[9]&&(l=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(l=-l)),c=new Date(Date.UTC(n,a,i,r,o,s,d)),l&&c.setTime(c.getTime()-l),c},instanceOf:Date,represent:function(e){return e.toISOString()}}),Ea=new ua("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),Aa="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",La=new ua("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,a=0,i=e.length,r=Aa;for(n=0;n<i;n++)if(!((t=r.indexOf(e.charAt(n)))>64)){if(t<0)return!1;a+=6}return a%8==0},construct:function(e){var t,n,a=e.replace(/[\r\n=]/g,""),i=a.length,r=Aa,o=0,s=[];for(t=0;t<i;t++)t%4==0&&t&&(s.push(o>>16&255),s.push(o>>8&255),s.push(255&o)),o=o<<6|r.indexOf(a.charAt(t));return 0==(n=i%4*6)?(s.push(o>>16&255),s.push(o>>8&255),s.push(255&o)):18===n?(s.push(o>>10&255),s.push(o>>2&255)):12===n&&s.push(o>>4&255),new Uint8Array(s)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,a="",i=0,r=e.length,o=Aa;for(t=0;t<r;t++)t%3==0&&t&&(a+=o[i>>18&63],a+=o[i>>12&63],a+=o[i>>6&63],a+=o[63&i]),i=(i<<8)+e[t];return 0==(n=r%3)?(a+=o[i>>18&63],a+=o[i>>12&63],a+=o[i>>6&63],a+=o[63&i]):2===n?(a+=o[i>>10&63],a+=o[i>>4&63],a+=o[i<<2&63],a+=o[64]):1===n&&(a+=o[i>>2&63],a+=o[i<<4&63],a+=o[64],a+=o[64]),a}}),ka=Object.prototype.hasOwnProperty,Ma=Object.prototype.toString,Pa=new ua("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,a,i,r,o=[],s=e;for(t=0,n=s.length;t<n;t+=1){if(a=s[t],r=!1,"[object Object]"!==Ma.call(a))return!1;for(i in a)if(ka.call(a,i)){if(r)return!1;r=!0}if(!r)return!1;if(-1!==o.indexOf(i))return!1;o.push(i)}return!0},construct:function(e){return null!==e?e:[]}}),Ta=Object.prototype.toString,Ua=new ua("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,a,i,r,o=e;for(r=new Array(o.length),t=0,n=o.length;t<n;t+=1){if(a=o[t],"[object Object]"!==Ta.call(a))return!1;if(1!==(i=Object.keys(a)).length)return!1;r[t]=[i[0],a[i[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,a,i,r,o=e;for(r=new Array(o.length),t=0,n=o.length;t<n;t+=1)a=o[t],i=Object.keys(a),r[t]=[i[0],a[i[0]]];return r}}),Fa=Object.prototype.hasOwnProperty,Ha=new ua("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(Fa.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),Ra=xa.extend({implicit:[wa,Ea],explicit:[La,Pa,Ua,Ha]}),Na=Object.prototype.hasOwnProperty,Ba=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,ja=/[\x85\u2028\u2029]/,Va=/[,\[\]\{\}]/,za=/^(?:!|!!|![a-z\-]+!)$/i,Ga=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Ka(e){return Object.prototype.toString.call(e)}function Wa(e){return 10===e||13===e}function qa(e){return 9===e||32===e}function Qa(e){return 9===e||32===e||10===e||13===e}function Ya(e){return 44===e||91===e||93===e||123===e||125===e}function Ja(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function Xa(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?"":76===e?"\u2028":80===e?"\u2029":""}function Za(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var $a=new Array(256),ei=new Array(256),ti=0;ti<256;ti++)$a[ti]=Xa(ti)?1:0,ei[ti]=Xa(ti);function ni(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Ra,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function ai(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,a=/\r?\n|\r|\0/g,i=[0],r=[],o=-1;n=a.exec(e.buffer);)r.push(n.index),i.push(n.index+n[0].length),e.position<=n.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var s,c,d="",l=Math.min(e.line+t.linesAfter,r.length).toString().length,u=t.maxLength-(t.indent+l+3);for(s=1;s<=t.linesBefore&&!(o-s<0);s++)c=sa(e.buffer,i[o-s],r[o-s],e.position-(i[o]-i[o-s]),u),d=na(" ",t.indent)+ca((e.line-s+1).toString(),l)+" | "+c.str+"\n"+d;for(c=sa(e.buffer,i[o],r[o],e.position,u),d+=na(" ",t.indent)+ca((e.line+1).toString(),l)+" | "+c.str+"\n",d+=na("-",t.indent+l+3+c.pos)+"^\n",s=1;s<=t.linesAfter&&!(o+s>=r.length);s++)c=sa(e.buffer,i[o+s],r[o+s],e.position-(i[o]-i[o+s]),u),d+=na(" ",t.indent)+ca((e.line+s+1).toString(),l)+" | "+c.str+"\n";return d.replace(/\n$/,"")}(n),new oa(t,n)}function ii(e,t){throw ai(e,t)}function ri(e,t){e.onWarning&&e.onWarning.call(null,ai(e,t))}var oi={YAML:function(e,t,n){var a,i,r;null!==e.version&&ii(e,"duplication of %YAML directive"),1!==n.length&&ii(e,"YAML directive accepts exactly one argument"),null===(a=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&ii(e,"ill-formed argument of the YAML directive"),i=parseInt(a[1],10),r=parseInt(a[2],10),1!==i&&ii(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=r<2,1!==r&&2!==r&&ri(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var a,i;2!==n.length&&ii(e,"TAG directive accepts exactly two arguments"),a=n[0],i=n[1],za.test(a)||ii(e,"ill-formed tag handle (first argument) of the TAG directive"),Na.call(e.tagMap,a)&&ii(e,'there is a previously declared suffix for "'+a+'" tag handle'),Ga.test(i)||ii(e,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch(t){ii(e,"tag prefix is malformed: "+i)}e.tagMap[a]=i}};function si(e,t,n,a){var i,r,o,s;if(t<n){if(s=e.input.slice(t,n),a)for(i=0,r=s.length;i<r;i+=1)9===(o=s.charCodeAt(i))||32<=o&&o<=1114111||ii(e,"expected valid JSON character");else Ba.test(s)&&ii(e,"the stream contains non-printable characters");e.result+=s}}function ci(e,t,n,a){var i,r,o,s,c;for("object"==typeof(c=n)&&null!==c||ii(e,"cannot merge mappings; the provided source object is unacceptable"),o=0,s=(i=Object.keys(n)).length;o<s;o+=1)r=i[o],Na.call(t,r)||(t[r]=n[r],a[r]=!0)}function di(e,t,n,a,i,r,o,s,c){var d,l;if(Array.isArray(i))for(d=0,l=(i=Array.prototype.slice.call(i)).length;d<l;d+=1)Array.isArray(i[d])&&ii(e,"nested arrays are not supported inside keys"),"object"==typeof i&&"[object Object]"===Ka(i[d])&&(i[d]="[object Object]");if("object"==typeof i&&"[object Object]"===Ka(i)&&(i="[object Object]"),i=String(i),null===t&&(t={}),"tag:yaml.org,2002:merge"===a)if(Array.isArray(r))for(d=0,l=r.length;d<l;d+=1)ci(e,t,r[d],n);else ci(e,t,r,n);else e.json||Na.call(n,i)||!Na.call(t,i)||(e.line=o||e.line,e.lineStart=s||e.lineStart,e.position=c||e.position,ii(e,"duplicated mapping key")),"__proto__"===i?Object.defineProperty(t,i,{configurable:!0,enumerable:!0,writable:!0,value:r}):t[i]=r,delete n[i];return t}function li(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):ii(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function ui(e,t,n){for(var a=0,i=e.input.charCodeAt(e.position);0!==i;){for(;qa(i);)9===i&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),i=e.input.charCodeAt(++e.position);if(t&&35===i)do{i=e.input.charCodeAt(++e.position)}while(10!==i&&13!==i&&0!==i);if(!Wa(i))break;for(li(e),i=e.input.charCodeAt(e.position),a++,e.lineIndent=0;32===i;)e.lineIndent++,i=e.input.charCodeAt(++e.position)}return-1!==n&&0!==a&&e.lineIndent<n&&ri(e,"deficient indentation"),a}function fi(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!Qa(t)))}function pi(e,t){1===t?e.result+=" ":t>1&&(e.result+=na("\n",t-1))}function mi(e,t){var n,a,i=e.tag,r=e.anchor,o=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),a=e.input.charCodeAt(e.position);0!==a&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,ii(e,"tab characters must not be used in indentation")),45===a)&&Qa(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,ui(e,!0,-1)&&e.lineIndent<=t)o.push(null),a=e.input.charCodeAt(e.position);else if(n=e.line,bi(e,t,3,!1,!0),o.push(e.result),ui(e,!0,-1),a=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==a)ii(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=i,e.anchor=r,e.kind="sequence",e.result=o,!0)}function _i(e){var t,n,a,i,r=!1,o=!1;if(33!==(i=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&ii(e,"duplication of a tag property"),60===(i=e.input.charCodeAt(++e.position))?(r=!0,i=e.input.charCodeAt(++e.position)):33===i?(o=!0,n="!!",i=e.input.charCodeAt(++e.position)):n="!",t=e.position,r){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&62!==i);e.position<e.length?(a=e.input.slice(t,e.position),i=e.input.charCodeAt(++e.position)):ii(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==i&&!Qa(i);)33===i&&(o?ii(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),za.test(n)||ii(e,"named tag handle cannot contain such characters"),o=!0,t=e.position+1)),i=e.input.charCodeAt(++e.position);a=e.input.slice(t,e.position),Va.test(a)&&ii(e,"tag suffix cannot contain flow indicator characters")}a&&!Ga.test(a)&&ii(e,"tag name cannot contain such characters: "+a);try{a=decodeURIComponent(a)}catch(t){ii(e,"tag name is malformed: "+a)}return r?e.tag=a:Na.call(e.tagMap,n)?e.tag=e.tagMap[n]+a:"!"===n?e.tag="!"+a:"!!"===n?e.tag="tag:yaml.org,2002:"+a:ii(e,'undeclared tag handle "'+n+'"'),!0}function hi(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&ii(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!Qa(n)&&!Ya(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&ii(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function bi(e,t,n,a,i){var r,o,s,c,d,l,u,f,p,m=1,_=!1,h=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,r=o=s=4===n||3===n,a&&ui(e,!0,-1)&&(_=!0,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)),1===m)for(;_i(e)||hi(e);)ui(e,!0,-1)?(_=!0,s=r,e.lineIndent>t?m=1:e.lineIndent===t?m=0:e.lineIndent<t&&(m=-1)):s=!1;if(s&&(s=_||i),1!==m&&4!==n||(f=1===n||2===n?t:t+1,p=e.position-e.lineStart,1===m?s&&(mi(e,p)||function(e,t,n){var a,i,r,o,s,c,d,l=e.tag,u=e.anchor,f={},p=Object.create(null),m=null,_=null,h=null,b=!1,g=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=f),d=e.input.charCodeAt(e.position);0!==d;){if(b||-1===e.firstTabInLine||(e.position=e.firstTabInLine,ii(e,"tab characters must not be used in indentation")),a=e.input.charCodeAt(e.position+1),r=e.line,63!==d&&58!==d||!Qa(a)){if(o=e.line,s=e.lineStart,c=e.position,!bi(e,n,2,!1,!0))break;if(e.line===r){for(d=e.input.charCodeAt(e.position);qa(d);)d=e.input.charCodeAt(++e.position);if(58===d)Qa(d=e.input.charCodeAt(++e.position))||ii(e,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(di(e,f,p,m,_,null,o,s,c),m=_=h=null),g=!0,b=!1,i=!1,m=e.tag,_=e.result;else{if(!g)return e.tag=l,e.anchor=u,!0;ii(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!g)return e.tag=l,e.anchor=u,!0;ii(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===d?(b&&(di(e,f,p,m,_,null,o,s,c),m=_=h=null),g=!0,b=!0,i=!0):b?(b=!1,i=!0):ii(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,d=a;if((e.line===r||e.lineIndent>t)&&(b&&(o=e.line,s=e.lineStart,c=e.position),bi(e,t,4,!0,i)&&(b?_=e.result:h=e.result),b||(di(e,f,p,m,_,h,o,s,c),m=_=h=null),ui(e,!0,-1),d=e.input.charCodeAt(e.position)),(e.line===r||e.lineIndent>t)&&0!==d)ii(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return b&&di(e,f,p,m,_,null,o,s,c),g&&(e.tag=l,e.anchor=u,e.kind="mapping",e.result=f),g}(e,p,f))||function(e,t){var n,a,i,r,o,s,c,d,l,u,f,p,m=!0,_=e.tag,h=e.anchor,b=Object.create(null);if(91===(p=e.input.charCodeAt(e.position)))o=93,d=!1,r=[];else{if(123!==p)return!1;o=125,d=!0,r={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=r),p=e.input.charCodeAt(++e.position);0!==p;){if(ui(e,!0,t),(p=e.input.charCodeAt(e.position))===o)return e.position++,e.tag=_,e.anchor=h,e.kind=d?"mapping":"sequence",e.result=r,!0;m?44===p&&ii(e,"expected the node content, but found ','"):ii(e,"missed comma between flow collection entries"),f=null,s=c=!1,63===p&&Qa(e.input.charCodeAt(e.position+1))&&(s=c=!0,e.position++,ui(e,!0,t)),n=e.line,a=e.lineStart,i=e.position,bi(e,t,1,!1,!0),u=e.tag,l=e.result,ui(e,!0,t),p=e.input.charCodeAt(e.position),!c&&e.line!==n||58!==p||(s=!0,p=e.input.charCodeAt(++e.position),ui(e,!0,t),bi(e,t,1,!1,!0),f=e.result),d?di(e,r,b,u,l,f,n,a,i):s?r.push(di(e,null,b,u,l,f,n,a,i)):r.push(l),ui(e,!0,t),44===(p=e.input.charCodeAt(e.position))?(m=!0,p=e.input.charCodeAt(++e.position)):m=!1}ii(e,"unexpected end of the stream within a flow collection")}(e,f)?h=!0:(o&&function(e,t){var n,a,i,r,o,s=1,c=!1,d=!1,l=t,u=0,f=!1;if(124===(r=e.input.charCodeAt(e.position)))a=!1;else{if(62!==r)return!1;a=!0}for(e.kind="scalar",e.result="";0!==r;)if(43===(r=e.input.charCodeAt(++e.position))||45===r)1===s?s=43===r?3:2:ii(e,"repeat of a chomping mode identifier");else{if(!((i=48<=(o=r)&&o<=57?o-48:-1)>=0))break;0===i?ii(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):d?ii(e,"repeat of an indentation width identifier"):(l=t+i-1,d=!0)}if(qa(r)){do{r=e.input.charCodeAt(++e.position)}while(qa(r));if(35===r)do{r=e.input.charCodeAt(++e.position)}while(!Wa(r)&&0!==r)}for(;0!==r;){for(li(e),e.lineIndent=0,r=e.input.charCodeAt(e.position);(!d||e.lineIndent<l)&&32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position);if(!d&&e.lineIndent>l&&(l=e.lineIndent),Wa(r))u++;else{if(e.lineIndent<l){3===s?e.result+=na("\n",c?1+u:u):1===s&&c&&(e.result+="\n");break}for(a?qa(r)?(f=!0,e.result+=na("\n",c?1+u:u)):f?(f=!1,e.result+=na("\n",u+1)):0===u?c&&(e.result+=" "):e.result+=na("\n",u):e.result+=na("\n",c?1+u:u),c=!0,d=!0,u=0,n=e.position;!Wa(r)&&0!==r;)r=e.input.charCodeAt(++e.position);si(e,n,e.position,!1)}}return!0}(e,f)||function(e,t){var n,a,i;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,a=i=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(si(e,a,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;a=e.position,e.position++,i=e.position}else Wa(n)?(si(e,a,i,!0),pi(e,ui(e,!1,t)),a=i=e.position):e.position===e.lineStart&&fi(e)?ii(e,"unexpected end of the document within a single quoted scalar"):(e.position++,i=e.position);ii(e,"unexpected end of the stream within a single quoted scalar")}(e,f)||function(e,t){var n,a,i,r,o,s,c;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=a=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return si(e,n,e.position,!0),e.position++,!0;if(92===s){if(si(e,n,e.position,!0),Wa(s=e.input.charCodeAt(++e.position)))ui(e,!1,t);else if(s<256&&$a[s])e.result+=ei[s],e.position++;else if((o=120===(c=s)?2:117===c?4:85===c?8:0)>0){for(i=o,r=0;i>0;i--)(o=Ja(s=e.input.charCodeAt(++e.position)))>=0?r=(r<<4)+o:ii(e,"expected hexadecimal character");e.result+=Za(r),e.position++}else ii(e,"unknown escape sequence");n=a=e.position}else Wa(s)?(si(e,n,a,!0),pi(e,ui(e,!1,t)),n=a=e.position):e.position===e.lineStart&&fi(e)?ii(e,"unexpected end of the document within a double quoted scalar"):(e.position++,a=e.position)}ii(e,"unexpected end of the stream within a double quoted scalar")}(e,f)?h=!0:function(e){var t,n,a;if(42!==(a=e.input.charCodeAt(e.position)))return!1;for(a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!Qa(a)&&!Ya(a);)a=e.input.charCodeAt(++e.position);return e.position===t&&ii(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Na.call(e.anchorMap,n)||ii(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],ui(e,!0,-1),!0}(e)?(h=!0,null===e.tag&&null===e.anchor||ii(e,"alias node should not have any properties")):function(e,t,n){var a,i,r,o,s,c,d,l,u=e.kind,f=e.result;if(Qa(l=e.input.charCodeAt(e.position))||Ya(l)||35===l||38===l||42===l||33===l||124===l||62===l||39===l||34===l||37===l||64===l||96===l)return!1;if((63===l||45===l)&&(Qa(a=e.input.charCodeAt(e.position+1))||n&&Ya(a)))return!1;for(e.kind="scalar",e.result="",i=r=e.position,o=!1;0!==l;){if(58===l){if(Qa(a=e.input.charCodeAt(e.position+1))||n&&Ya(a))break}else if(35===l){if(Qa(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&fi(e)||n&&Ya(l))break;if(Wa(l)){if(s=e.line,c=e.lineStart,d=e.lineIndent,ui(e,!1,-1),e.lineIndent>=t){o=!0,l=e.input.charCodeAt(e.position);continue}e.position=r,e.line=s,e.lineStart=c,e.lineIndent=d;break}}o&&(si(e,i,r,!1),pi(e,e.line-s),i=r=e.position,o=!1),qa(l)||(r=e.position+1),l=e.input.charCodeAt(++e.position)}return si(e,i,r,!1),!!e.result||(e.kind=u,e.result=f,!1)}(e,f,1===n)&&(h=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===m&&(h=s&&mi(e,p))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&ii(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),c=0,d=e.implicitTypes.length;c<d;c+=1)if((u=e.implicitTypes[c]).resolve(e.result)){e.result=u.construct(e.result),e.tag=u.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(Na.call(e.typeMap[e.kind||"fallback"],e.tag))u=e.typeMap[e.kind||"fallback"][e.tag];else for(u=null,c=0,d=(l=e.typeMap.multi[e.kind||"fallback"]).length;c<d;c+=1)if(e.tag.slice(0,l[c].tag.length)===l[c].tag){u=l[c];break}u||ii(e,"unknown tag !<"+e.tag+">"),null!==e.result&&u.kind!==e.kind&&ii(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+u.kind+'", not "'+e.kind+'"'),u.resolve(e.result,e.tag)?(e.result=u.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):ii(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||h}function gi(e){var t,n,a,i,r=e.position,o=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(i=e.input.charCodeAt(e.position))&&(ui(e,!0,-1),i=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==i));){for(o=!0,i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!Qa(i);)i=e.input.charCodeAt(++e.position);for(a=[],(n=e.input.slice(t,e.position)).length<1&&ii(e,"directive name must not be less than one character in length");0!==i;){for(;qa(i);)i=e.input.charCodeAt(++e.position);if(35===i){do{i=e.input.charCodeAt(++e.position)}while(0!==i&&!Wa(i));break}if(Wa(i))break;for(t=e.position;0!==i&&!Qa(i);)i=e.input.charCodeAt(++e.position);a.push(e.input.slice(t,e.position))}0!==i&&li(e),Na.call(oi,n)?oi[n](e,n,a):ri(e,'unknown document directive "'+n+'"')}ui(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,ui(e,!0,-1)):o&&ii(e,"directives end mark is expected"),bi(e,e.lineIndent-1,4,!1,!0),ui(e,!0,-1),e.checkLineBreaks&&ja.test(e.input.slice(r,e.position))&&ri(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&fi(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,ui(e,!0,-1)):e.position<e.length-1&&ii(e,"end of the stream or a document separator is expected")}var vi=Ia,yi=function(e,t){var n=function(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new ni(e,t),a=e.indexOf("\0");for(-1!==a&&(n.position=a,ii(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)gi(n);return n.documents}(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new oa("expected a single document in the stream, but found more")}};function Si(e){const t=(e=>e.replace(/\r\n?/g,"\n").replace(/<(\w+)([^>]*)>/g,(e,t,n)=>"<"+t+n.replace(/="([^"]*)"/g,"='$1'")+">"))(e),n=(e=>{const{text:t,metadata:n}=function(e){const t=e.match(Ne);if(!t)return{text:e,metadata:{}};let n=yi(t[1],{schema:vi})??{};n="object"!=typeof n||Array.isArray(n)?{}:n;const a={};return n.displayMode&&(a.displayMode=n.displayMode.toString()),n.title&&(a.title=n.title.toString()),n.config&&(a.config=n.config),{text:e.slice(t[0].length),metadata:a}}(e),{displayMode:a,title:i,config:r={}}=n;return a&&(r.gantt||(r.gantt={}),r.gantt.displayMode=a),{title:i,config:r,text:t}})(t),a=(e=>{const t=bt.detectInit(e)??{},n=bt.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:e})=>{}):"wrap"===(null==n?void 0:n.type)&&(t.wrap=!0),{text:(a=e,a.replace(Be,"")),directive:t};var a})(n.text),i=ht(n.config,a.directive);return{code:e=a.text.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),title:n.title,config:i}}const Di=["foreignobject"],Ii=["dominant-baseline"];function xi(e){const t=Si(e);var n;return Lt(),n=t.config??{},He(n),!n.fontFamily||n.themeVariables&&n.themeVariables.fontFamily||(n.themeVariables={fontFamily:n.fontFamily}),It.push(n),Ct(Dt,It),t}const Ci=(e,t,n=[])=>`\n.${e} ${t} { ${n.join(" !important; ")} !important; }`,Oi=(e,t,n,a,i)=>{const r=e.append("div");r.attr("id",n),a&&r.attr("style",a);const o=r.append("svg").attr("id",t).attr("width","100%").attr("xmlns","http://www.w3.org/2000/svg");return i&&o.attr("xmlns:xlink",i),o.append("g"),e};function wi(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}const Ei=(e,t={})=>{const{code:n}=Si(e);return(async(e,t={})=>{const n=Ge(e,Et());try{Fn(n)}catch(e){const t=ze[n].loader;if(!t)throw new Ve(`Diagram ${n} not found.`);const{id:a,diagram:i}=await t();Un(a,i)}return new ea(e,t)})(n,t)},Ai=Object.freeze({render:async function(e,t,n){var a,i,r,c,d,l;$n();const u=xi(t);t=u.code;const f=Et();re.debug(f),t.length>((null==f?void 0:f.maxTextSize)??5e4)&&(t="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa");const p="#"+e,m="i"+e,_="#"+m,h="d"+e,b="#"+h;let g=(0,o.Htv)("body");const v="sandbox"===f.securityLevel,y="loose"===f.securityLevel,S=f.fontFamily;if(void 0!==n){if(n&&(n.innerHTML=""),v){const e=wi((0,o.Htv)(n),m);g=(0,o.Htv)(e.nodes()[0].contentDocument.body),g.node().style.margin=0}else g=(0,o.Htv)(n);Oi(g,e,h,`font-family: ${S}`,"http://www.w3.org/1999/xlink")}else{if(((e,t,n,a)=>{var i,r,o;null==(i=e.getElementById(t))||i.remove(),null==(r=e.getElementById(n))||r.remove(),null==(o=e.getElementById(a))||o.remove()})(document,e,h,m),v){const e=wi((0,o.Htv)("body"),m);g=(0,o.Htv)(e.nodes()[0].contentDocument.body),g.node().style.margin=0}else g=(0,o.Htv)("body");Oi(g,e,h)}let D,I;try{D=await Ei(t,{title:u.title})}catch(e){D=new ea("error"),I=e}const x=g.select(b).node(),C=D.type,O=x.firstChild,w=O.firstChild,E=((e,t,n,a)=>{const i=((e,t={})=>{var n;let a="";if(void 0!==e.themeCSS&&(a+=`\n${e.themeCSS}`),void 0!==e.fontFamily&&(a+=`\n:root { --mermaid-font-family: ${e.fontFamily}}`),void 0!==e.altFontFamily&&(a+=`\n:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),!(0,ae.A)(t)){const i=["> *","span"],r=["rect","polygon","ellipse","circle","path"],o=e.htmlLabels||(null==(n=e.flowchart)?void 0:n.htmlLabels)?i:r;for(const e in t){const n=t[e];(0,ae.A)(n.styles)||o.forEach(e=>{a+=Ci(n.id,e,n.styles)}),(0,ae.A)(n.textStyles)||(a+=Ci(n.id,"tspan",n.textStyles))}}return a})(e,n);return k(Z(`${a}{${((e,t,n)=>{let a="";return e in mn&&mn[e]?a=mn[e](n):re.warn(`No theme found for ${e}`),` & {\n    font-family: ${n.fontFamily};\n    font-size: ${n.fontSize};\n    fill: ${n.textColor}\n  }\n\n  /* Classes common for multiple diagrams */\n\n  & .error-icon {\n    fill: ${n.errorBkgColor};\n  }\n  & .error-text {\n    fill: ${n.errorTextColor};\n    stroke: ${n.errorTextColor};\n  }\n\n  & .edge-thickness-normal {\n    stroke-width: 2px;\n  }\n  & .edge-thickness-thick {\n    stroke-width: 3.5px\n  }\n  & .edge-pattern-solid {\n    stroke-dasharray: 0;\n  }\n\n  & .edge-pattern-dashed{\n    stroke-dasharray: 3;\n  }\n  .edge-pattern-dotted {\n    stroke-dasharray: 2;\n  }\n\n  & .marker {\n    fill: ${n.lineColor};\n    stroke: ${n.lineColor};\n  }\n  & .marker.cross {\n    stroke: ${n.lineColor};\n  }\n\n  & svg {\n    font-family: ${n.fontFamily};\n    font-size: ${n.fontSize};\n  }\n\n  ${a}\n\n  ${t}\n`})(t,i,e.themeVariables)}}`),M)})(f,C,null==(i=(a=D.renderer).getClasses)?void 0:i.call(a,t,D),p),A=document.createElement("style");A.innerHTML=E,O.insertBefore(A,w);try{await D.renderer.draw(t,e,vt,D)}catch(n){throw Bn.draw(t,e,vt),n}!function(e,t,n,a){(function(e,t){e.attr("role","graphics-document document"),""!==t&&e.attr("aria-roledescription",t)})(t,e),function(e,t,n,a){if(void 0!==e.insert){if(n){const t=`chart-desc-${a}`;e.attr("aria-describedby",t),e.insert("desc",":first-child").attr("id",t).text(n)}if(t){const n=`chart-title-${a}`;e.attr("aria-labelledby",n),e.insert("title",":first-child").attr("id",n).text(t)}}}(t,n,a,t.attr("id"))}(C,g.select(`${b} svg`),null==(c=(r=D.db).getAccTitle)?void 0:c.call(r),null==(l=(d=D.db).getAccDescription)?void 0:l.call(d)),g.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns","http://www.w3.org/1999/xhtml");let L=g.select(b).node().innerHTML;if(re.debug("config.arrowMarkerAbsolute",f.arrowMarkerAbsolute),L=((e="",t,n)=>{let a=e;return n||t||(a=a.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),a=gt(a),a=a.replace(/<br>/g,"<br/>"),a})(L,v,_e(f.arrowMarkerAbsolute)),v?L=((e="",t)=>{var n,a;return`<iframe style="width:100%;height:${(null==(a=null==(n=null==t?void 0:t.viewBox)?void 0:n.baseVal)?void 0:a.height)?t.viewBox.baseVal.height+"px":"100%"};border:0;margin:0;" src="data:text/html;base64,${btoa('<body style="margin:0">'+e+"</body>")}" sandbox="allow-top-navigation-by-user-activation allow-popups">\n  The "iframe" tag is not supported by your browser.\n</iframe>`})(L,g.select(b+" svg").node()):y||(L=s.sanitize(L,{ADD_TAGS:Di,ADD_ATTR:Ii})),ta.forEach(e=>{e()}),ta=[],I)throw I;const P=v?_:b,T=(0,o.Htv)(P).node();return T&&"remove"in T&&T.remove(),{svg:L,bindFunctions:D.db.bindFunctions}},parse:async function(e,t){$n(),e=xi(e).code;try{await Ei(e)}catch(e){if(null==t?void 0:t.suppressErrors)return!1;throw e}return!0},getDiagramFromText:Ei,initialize:function(e={}){var t;(null==e?void 0:e.fontFamily)&&!(null==(t=e.themeVariables)?void 0:t.fontFamily)&&(e.themeVariables||(e.themeVariables={}),e.themeVariables.fontFamily=e.fontFamily),St=Qe({},e),(null==e?void 0:e.theme)&&e.theme in ke?e.themeVariables=ke[e.theme].getThemeVariables(e.themeVariables):e&&(e.themeVariables=ke.default.getThemeVariables(e.themeVariables));const n="object"==typeof e?(a=e,Dt=Qe({},yt),Dt=Qe(Dt,a),a.theme&&ke[a.theme]&&(Dt.themeVariables=ke[a.theme].getThemeVariables(a.themeVariables)),Ct(Dt,It),Dt):Ot();var a;oe(n.logLevel),$n()},getConfig:Et,setConfig:wt,getSiteConfig:Ot,updateSiteConfig:e=>(Dt=Qe(Dt,e),Ct(Dt,It),Dt),reset:()=>{Lt()},globalReset:()=>{Lt(yt)},defaultConfig:yt});oe(Et().logLevel),Lt(Et());const Li=(e,t,n)=>{re.warn(e),mt(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},ki=async function(e={querySelector:".mermaid"}){try{await Mi(e)}catch(t){if(mt(t)&&re.error(t.str),Ni.parseError&&Ni.parseError(t),!e.suppressErrors)throw re.error("Use the suppressErrors option to suppress these errors"),t}},Mi=async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const i=Ai.getConfig();let r;if(re.debug((e?"":"No ")+"Callback function found"),n)r=n;else{if(!t)throw new Error("Nodes and querySelector are both undefined");r=document.querySelectorAll(t)}re.debug(`Found ${r.length} diagrams`),void 0!==(null==i?void 0:i.startOnLoad)&&(re.debug("Start On Load: "+(null==i?void 0:i.startOnLoad)),Ai.updateSiteConfig({startOnLoad:null==i?void 0:i.startOnLoad}));const o=new bt.InitIDGenerator(i.deterministicIds,i.deterministicIDSeed);let s;const c=[];for(const t of Array.from(r)){if(re.info("Rendering diagram: "+t.id),t.getAttribute("data-processed"))continue;t.setAttribute("data-processed","true");const n=`mermaid-${o.next()}`;s=t.innerHTML,s=(0,a.T)(bt.entityDecode(s)).trim().replace(/<br\s*\/?>/gi,"<br/>");const i=bt.detectInit(s);i&&re.debug("Detected early reinit: ",i);try{const{svg:a,bindFunctions:i}=await Ri(n,s,t);t.innerHTML=a,e&&await e(n),i&&i(t)}catch(e){Li(e,c,Ni.parseError)}}if(c.length>0)throw c[0]},Pi=function(e){Ai.initialize(e)},Ti=function(){if(Ni.startOnLoad){const{startOnLoad:e}=Ai.getConfig();e&&Ni.run().catch(e=>re.error("Mermaid failed to initialize",e))}};"undefined"!=typeof document&&window.addEventListener("load",Ti,!1);const Ui=[];let Fi=!1;const Hi=async()=>{if(!Fi){for(Fi=!0;Ui.length>0;){const e=Ui.shift();if(e)try{await e()}catch(e){re.error("Error executing queue",e)}}Fi=!1}},Ri=(e,t,n)=>new Promise((a,i)=>{Ui.push(()=>new Promise((r,o)=>{Ai.render(e,t,n).then(e=>{r(e),a(e)},e=>{var t;re.error("Error parsing",e),null==(t=Ni.parseError)||t.call(Ni,e),o(e),i(e)})})),Hi().catch(i)}),Ni={startOnLoad:!0,mermaidAPI:Ai,parse:async(e,t)=>new Promise((n,a)=>{Ui.push(()=>new Promise((i,r)=>{Ai.parse(e,t).then(e=>{i(e),n(e)},e=>{var t;re.error("Error parsing",e),null==(t=Ni.parseError)||t.call(Ni,e),r(e),a(e)})})),Hi().catch(a)}),render:Ri,init:async function(e,t,n){re.warn("mermaid.init is deprecated. Please use run instead."),e&&Pi(e);const a={postRenderCallback:n,querySelector:".mermaid"};"string"==typeof t?a.querySelector=t:t&&(t instanceof HTMLElement?a.nodes=[t]:a.nodes=t),await ki(a)},run:ki,registerExternalDiagrams:async(e,{lazyLoad:t=!0}={})=>{Ke(...e),!1===t&&await(async()=>{re.debug("Loading registered diagrams");const e=(await Promise.allSettled(Object.entries(ze).map(async([e,{detector:t,loader:n}])=>{if(n)try{Fn(e)}catch(a){try{const{diagram:e,id:a}=await n();Un(a,e,t)}catch(t){throw re.error(`Failed to load external diagram with key ${e}. Removing from detectors.`),delete ze[e],t}}}))).filter(e=>"rejected"===e.status);if(e.length>0){re.error(`Failed to load ${e.length} external diagrams`);for(const t of e)re.error(t);throw new Error(`Failed to load ${e.length} external diagrams`)}})()},initialize:Pi,parseError:void 0,contentLoaded:Ti,setParseErrorHandler:function(e){Ni.parseError=e},detectType:Ge}}
},se={};function ce(e){var t=se[e];if(void 0!==t)return t.exports;var n=se[e]={exports:{}};return oe[e].call(n.exports,n,n.exports,ce),n.exports}ce.m=oe;var de,le,ue,fe={"50":"ZxezT003S+pTrtP/WrPddoSH1wiKx+B78FRNeiZYD1k=","60":"zVU4u3NDNhcFCI2YrzV8pHiUn4trmGxEIzsSn9kcWjY=","107":"vv1e/6wV1EZcFGqLp6/fKNVM6UzP18rDGq5zTeF/dDQ=","109":"mONUI5LBXofjlZqSBVbCtkzsyerFhfq1Y1RRjLVGYfA=","128":"XNBV8U0kwSpaRHSKkf072P/bt6EqbGm91e6o6M1NUkw=","309":"lLEGJMngmKI16CDjQL3KiUMZBbsCevVlqg4sVK9P6ng=","330":"xViRYJ3cWme6cA6pviUX2KC/Mq4lTNh+wv1+35rvw1M=","361":"xuhr66lF6RO75X6HxZ94S8MHZ9cFshFVTfG5zKrkqac=","396":"42RMNyooYeTCOYYfdyaeS012A9sRws9nA3FcwfETJ08=","402":"dzIHQRbvG8uWk060bYr547/wDSLWiGPxfME/EF5fpcg=","405":"jxHl73EIY6AbhOZIJxgOuXBd6wzlrQ2Fl4H4WD+qgac=","412":"lH86qxsOOSObjb+mucNKDh3KHyzKusrxmViojpX1vOs=","421":"646l6cg8Y6Bjjug4BVwK68ODLpBUy7EEZwL8aFL9Q10=","431":"u4XUEsdpcZOSE9JI6p5/LyS0DE4hkezs6F6JJlgVnJc=","499":"7V6vhJeLQM3vRVRRJ8awW2Ykv53eU4lfcnDnZhmMAzU=","516":"pxjOFjSTzqgZFlB/XNXZzSEBvYY0k+75Agez0vOZDrc=","531":"1BcYearkRBKzXBiYB+o/mZxf1ecTq//Az9IQwABTuZA=","568":"j0Tocojz6HlocY/lSiKzVFDBsR5k9xZmi6Nivk9gaJc=","618":"azZ5bivVGCav9l+I4EFImtEE3KX35tsNLJd9z7t6yBE=","652":"akWyrHlJn6Tg+U5y4JNNMbtj2KWedY5yOlVP5QJC1B8=","674":"oi49YjyMy0O6YnELVVvRrY+65xhR3E2sK94AHNsiHs8=","738":"ZCJOlU1tDQ46x2y9PwcJQWRWEQ2q0supnzY0t4vAD68=","741":"3/hux3kI+zjoH8ZKC3/1J61+470BXLojsrsUfWJCURM=","743":"5qnu/0PBZHk6smzJNFbzj7Qq3lM7c/uyJ8ayAfWjuf8=","758":"pE/Fg9CJQWd4inwcvsPD+JWhUyUjrzYSb4+aMQ2HETE=","760":"ha1mY3Mzu2eLEpVsPERgFs5VHgESoGO7Sysq1EDfthM=","794":"Y8HPKCVaOXFrjRlgo4c7/JHH9ycT29Uz6CHJuIXuDYc=","854":"xPgiXqvDnzS1dxWzPU4Uh6EglKbqkfuRGz/u0PZvo+Y=","857":"qQygBHYgj/dSUJrcabC1BXFNcNbWCdmQVHHjiPQ++Iw=","882":"qGyxa9d4W94FMLmpunOOiPiMyMVyzKffaudQ7j9EDeI=","916":"nNDYpnML8GNe6hBZ5FJd7uhYn+5OnLFCZQ4toClsAH4=","989":"fCdGroC7TTMd/mBmhlSt11Fdtggz73jY6+lvs2vqvDg="};ce.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return ce.d(t,{a:t}),t},ce.d=(e,t)=>{for(var n in t)ce.o(t,n)&&!ce.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},ce.f={},ce.e=e=>Promise.all(Object.keys(ce.f).reduce((t,n)=>(ce.f[n](e,t),t),[])),ce.u=e=>"chunk."+(794===e?"page-builder-test-data":e)+"_none_"+{50:"cf0787e18dd64a9d849f",60:"03a74c2c6d03963bc714",107:"ba11ccba59a47fbe6fde",109:"c36655bb06e19f40ddb0",128:"0c683119a71e39b6c92d",309:"41d45e68c0dc5174118b",330:"4ceeb2da864d8d1233a7",361:"8a02665f3a0ab5dc6d84",396:"84df0643c4996ece0974",402:"dca7a3baa755f8634983",405:"aaf65aae92a310182ab6",412:"06ab3a1443e40e798dc1",421:"904c29618af7ed2e6e0d",431:"de23fd39ebdf3e45811b",499:"9838e8bc4cfdf1f49e91",516:"82baf0776d22a6a2fe23",531:"bbc849f22af81fd9c837",568:"7c4d92b584c652cd46d0",618:"fa765d2fbc666614c14b",652:"3a494f1d826365dbc778",674:"8e0e79ef28776c5dcb64",738:"6e25e38ff8aecefc7fd2",741:"2c580603df0e0733a202",743:"976286541d56459bea90",758:"477c1cff107a0c71f352",760:"ec1ae9db253ba28809e7",794:"385aa0db398dfee3c280",854:"832787d8123cc3421e70",857:"115b1b8c146f1aa811db",882:"9aefb92cedc431d64eaf",916:"8ab503970f184ee606e5",989:"b345a83472d75ca043fb"}[e]+".js",ce.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),ce.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),de={},le="8fe6b755-c819-4f0a-bde4-34c292b918de_0.1.0:",ce.l=(e,t,n,a)=>{if(de[e])de[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==le+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,ce.nc&&i.setAttribute("nonce",ce.nc),i.setAttribute("data-webpack",le+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(fe[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}de[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=de[e];if(delete de[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},ce.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},ue=e?e.src:"",ce.p=ue.slice(0,ue.lastIndexOf("/")+1),(()=>{var e={365:0};ce.f.j=(t,n)=>{var a=ce.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=ce.p+ce.u(t),o=new Error;ce.l(r,n=>{if(ce.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)ce.o(o,a)&&(ce.m[a]=o[a]);s&&s(ce)}for(t&&t(n);c<r.length;c++)i=r[c],ce.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_8fe6b755-c819-4f0a-bde4-34c292b918de_0.1.0"]=self["webpackJsonp_8fe6b755-c819-4f0a-bde4-34c292b918de_0.1.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var pe={};return(()=>{"use strict";ce.r(pe),ce.d(pe,{AuthoringCopilotScenarioKey:()=>v,CombineLogger:()=>xs,CopilotCreationQueryParam:()=>Zr,CopilotErrorType:()=>ys,CopilotFinishedBar:()=>Zc,CopilotInProgressBar:()=>Sr,CopilotPageGeneratorError:()=>Ss,CopilotPageGeneratorErrorCode:()=>vs,CopilotProgressIndicator:()=>cr,CreateAIPageWithoutWizard:()=>gs,CreatePageWithCopilotDialog:()=>bs,DELIMITER:()=>$r,DebugLogger:()=>Sc,EngagementLogger:()=>td,FreePromptEditor:()=>ka,LOG_SOURCE:()=>yc,Length:()=>he,LoggerProvider:()=>lt,NEWS_POST_FROM_DOCUMENT_FREE_PROMPT:()=>Ka,PAGE_FROM_DOCUMENT_FREE_PROMPT:()=>Ga,PageCreation:()=>Hs,PageGenerator:()=>kc,PageTemplatePreviewer:()=>je,PageType:()=>ws,PerformanceLogger:()=>nd,PrivateDraftCheckbox:()=>wa,QosLogger:()=>ed,RumOneLogger:()=>As,SPDesignPageClient:()=>Td,SPDesignPageClientV2:()=>Fd,SUPPORTED_PARTNER_SCENARIOS:()=>me,ServiceScopeProvider:()=>ra,TEMPLATE_PROMPT_GENERATE_FUNCTIONS:()=>i,TemplateCategory:()=>_,TemplateSource:()=>m,TokenType:()=>r,Tone:()=>_e,buildPageUrl:()=>ls,buildPromptFromTemplate:()=>g,buildPromptString:()=>f,buildUserPrompt:()=>p,createPage:()=>fr,debugUrl:()=>eo,getWebPartTypeByManifestId:()=>Is,isAuthoringCopilotDebugEnabled:()=>Xo,isBizchatHandoffEnabled:()=>Un,isExpectedPagesApiError:()=>_r,isLoopToPageHandoffEnabled:()=>Fn,isMappingPageGeneratorEnabled:()=>Mn,isMeetingPickerEnabled:()=>En,isUseAIPropertiesFlowEnabled:()=>Hn,useAbortSignal:()=>ur,useLogger:()=>ut,useServiceScope:()=>oa});const e=JSON.parse('{"cXA":"Create a newsletter page.","yCs":"Create a {0} page for {1}, featuring sections on {2}, {3}, {4}, {5}, {6} and {7}.","jG0":"Create a meeting newsletter page.","IHl":"Create a {0} page for {1}, featuring sections on {2}, {3}, {4} and {5}.","glk":"meeting newsletter","ZJQ":"summary","mrY":"meeting overview","MmR":"synopsis","qNh":"meeting digest","x2p":"TL;DR","JiV":"agenda","RC8":"meeting schedule","Cjd":"meeting program","ffE":"discussion topics","WRq":"action items","wzw":"key outcome","DFN":"meeting notes","MOv":"takeaways","aK3":"meeting conclusions","xdX":"meeting highlights","GsF":"follow-up tasks","O_x":"subsequent steps","_7u":"follow-up measures","ZAZ":"continued actions","M$6":"next actions","wUZ":"newsletter","tvJ":"subject","XGH":"teamwork","HGJ":"innovation highlights","Jve":"health and wellness","c3_":"community","dyc":"latest news","LXo":"recent achievements","UOY":"industry updates","Cdg":"product launches","iJD":"policy changes","PRo":"quote","Haj":"inspiration","Jq":"thought for the day","M_R":"insights","rAr":"motivational message","I_F":"spotlight","zN5":"employee of the month","XDl":"project showcase","dZg":"department highlight","UCB":"success story","qaU":"event","woN":"workshops","fSq":"social gatherings","ahb":"training","E9m":"charity events","Qo":"upcoming initiatives","bvI":"future projects","QPk":"strategic goals","d0g":"new partnerships","srx":"development plans","vgE":"until next time","v0Z":"closing remarks","j$t":"final thoughts","a7R":"stay connected","YTI":"next issue preview","NW$":"Create an event page.","qOp":"Create an {0} page for {1}, featuring sections regarding {2}, {3}, {4}, and {5}.","loN":"event","UNI":"event name","jbH":"team retreat","HEE":"innovation summit","yX2":"wellness fair","ma6":"community meetup","LCk":"event details","lOX":"agenda","tGq":"schedule","VG$":"program","A3X":"overview","p96":"resources","K7T":"materials","yBl":"downloads","JkH":"links","rBf":"toolkit","byB":"location","WYh":"venue","XaI":"address","jTN":"directions","d4C":"map","xEs":"FAQ","CvJ":"questions","w1C":"help","XBE":"support","DDP":"info","Dgm":"Compose a status update page.","OHt":"Compose a {0} page for {1} for the time period of {2}, featuring sections on {3}, {4}, {5}, {6}, and {7}.","C7l":"status update","mpJ":"project","j1u":"new launch","Z5x":"marketing campaign","HTu":"infrastructure upgrade","$tL":"mobile app","E7M":"current month","AIq":"this year","rN4":"current quarter","JKg":"this sprint","VLv":"year-end","X6q":"summary","f$s":"overview","RrX":"highlights","Zcu":"recap","sQv":"introduction","jDE":"key progress areas","OEZ":"milestones","sIy":"achievements","bTS":"updates","SAM":"developments","qs3":"next phase","IPy":"next steps","HKT":"roadmap","M33":"future plans","k8j":"objectives","_rJ":"transition plan","VRD":"handover","AvO":"migration","sqG":"shift","tJn":"changeover","DHO":"what to expect next","OLn":"coming soon","REI":"looking ahead","ypY":"future outlook","ncX":"upcoming","yp":"Create a process page.","ThL":"Create a {0} page for {1}, featuring sections on {2}, {3}, {4}, and {5}.","j5M":"process","T$8":"project","zG2":"automation initiative","TOi":"security upgrade","mPE":"data migration","aKT":"cloud integration","po9":"background","Dvy":"overview","t6A":"introduction","ZNn":"context","$Zh":"history","s8k":"monthly status reports","zsv":"updates","eFc":"progress","fv":"metrics","dCM":"summaries","Y3U":"monthly reviews","Lxd":"assessments","R6k":"feedback","i_f":"evaluations","SKF":"meetings","b7B":"quarterly activities and resources","U8P":"workshops","DxL":"Initiatives","jGo":"training","E6A":"events","kBI":"Spotlight a topic.","svG":"Create a {0} page for {1}, featuring sections on {2}, {3}, {4}, and {5}.","HAm":"topic","lsq":"topic name","w9w":"sustainability","qY_":"leadership","wQH":"innovation","Hft":"compliance","ea_":"description","uVr":"overview","E0h":"summary","Ldg":"introduction","cGr":"insight","m2e":"sub topic a","KI":"strategy","Mn":"objectives","KlI":"initiatives","hes":"policies","SEs":"sub topic b","CB7":"implementation","tnF":"challenges","Cji":"solutions","klJ":"updates","XG_":"conclusion","QUK":"wrap-up","Qu2":"closing","A4b":"summary","_Pu":"next steps","tDD":"Create a training page.","dLO":"Create a {0} page for {1}, featuring sections on {2}, {3}, and {4}.","BT7":"training","EpJ":"title","e4h":"orientation","RH$":"skill development","qNt":"compliance training","HHT":"software tutorial","Yct":"video","N9k":"webinar","JAA":"demonstration","qPP":"presentation","_TT":"lecture","DwB":"description","aGM":"overview","GfJ":"summary","T1c":"details","GKQ":"outline","jRe":"training leads","X37":"instructors","oyT":"facilitators","Ue8":"coaches","_Uf":"mentors","m3Q":"Write a meeting recap.","oYQ":"Write a {0} page for {1}, featuring sections on {2}, {3}, {4}, and {5}.","aVn":"recap","WBk":"meeting title","pnp":"team briefing","Pyi":"strategy session","m3w":"project update","tg0":"quarterly review","oRx":"video","pCP":"recording","Imb":"highlights","vTR":"replay","uXg":"clips","U_L":"description","z9I":"summary","Elz":"overview","gIW":"notes","m$F":"insights","OoN":"recap details","Idq":"minutes","WYg":"key points","J1_":"action items","g9y":"takeaways","Jj3":"team","nm0":"participants","jc4":"members","ufU":"attendees","DuV":"contributors","JVN":"Create a message page for communication.","Oo8":"Create a leadership team {0} page for {1} communication, featuring sections on {2}, and {3}.","Ipj":"message","Jhs":"topic","s06":"strategy","R7N":"vision","tAC":"growth","_XH":"innovation","tpm":"description","T0M":"overview","pSu":"summary","Aqp":"insight","p5r":"details","Say":"quote","tfS":"inspiration","xwH":"motto","Eci":"thought","oc2":"saying"}'),t={Newsletter:{short:e.cXA,long:{template:e.yCs,tokens:[{text:e.wUZ,suggestions:[]},{text:e.tvJ,suggestions:[e.XGH,e.HGJ,e.Jve,e.c3_]},{text:e.dyc,suggestions:[e.LXo,e.UOY,e.Cdg,e.iJD]},{text:e.PRo,suggestions:[e.Haj,e.Jq,e.M_R,e.rAr]},{text:e.I_F,suggestions:[e.zN5,e.XDl,e.dZg,e.UCB]},{text:e.qaU,suggestions:[e.woN,e.fSq,e.ahb,e.E9m]},{text:e.Qo,suggestions:[e.bvI,e.QPk,e.d0g,e.srx]},{text:e.vgE,suggestions:[e.v0Z,e.j$t,e.a7R,e.YTI]}]}},Event:{short:e.NW$,long:{template:e.qOp,tokens:[{text:e.loN,suggestions:[]},{text:e.UNI,suggestions:[e.jbH,e.HEE,e.yX2,e.ma6]},{text:e.LCk,suggestions:[e.lOX,e.tGq,e.VG$,e.A3X]},{text:e.p96,suggestions:[e.K7T,e.yBl,e.JkH,e.rBf]},{text:e.byB,suggestions:[e.WYh,e.XaI,e.jTN,e.d4C]},{text:e.xEs,suggestions:[e.CvJ,e.w1C,e.XBE,e.DDP]}]}},StatusUpdate:{short:e.Dgm,long:{template:e.OHt,tokens:[{text:e.C7l,suggestions:[]},{text:e.mpJ,suggestions:[e.j1u,e.Z5x,e.HTu,e.$tL]},{text:e.E7M,suggestions:[e.AIq,e.rN4,e.JKg,e.VLv]},{text:e.X6q,suggestions:[e.f$s,e.RrX,e.Zcu,e.sQv]},{text:e.jDE,suggestions:[e.OEZ,e.sIy,e.bTS,e.SAM]},{text:e.qs3,suggestions:[e.IPy,e.HKT,e.M33,e.k8j]},{text:e._rJ,suggestions:[e.VRD,e.AvO,e.sqG,e.tJn]},{text:e.DHO,suggestions:[e.OLn,e.REI,e.ypY,e.ncX]}]}},Process:{short:e.yp,long:{template:e.ThL,tokens:[{text:e.j5M,suggestions:[]},{text:e.T$8,suggestions:[e.zG2,e.TOi,e.mPE,e.aKT]},{text:e.po9,suggestions:[e.Dvy,e.t6A,e.ZNn,e.$Zh]},{text:e.s8k,suggestions:[e.zsv,e.eFc,e.fv,e.dCM]},{text:e.Y3U,suggestions:[e.Lxd,e.R6k,e.i_f,e.SKF]},{text:e.b7B,suggestions:[e.U8P,e.DxL,e.jGo,e.E6A]}]}},Topics:{short:e.kBI,long:{template:e.svG,tokens:[{text:e.HAm,suggestions:[]},{text:e.lsq,suggestions:[e.w9w,e.qY_,e.wQH,e.Hft]},{text:e.ea_,suggestions:[e.uVr,e.E0h,e.Ldg,e.cGr]},{text:e.m2e,suggestions:[e.KI,e.Mn,e.KlI,e.hes]},{text:e.SEs,suggestions:[e.CB7,e.tnF,e.Cji,e.klJ]},{text:e.XG_,suggestions:[e.QUK,e.Qu2,e.A4b,e._Pu]}]}},Training:{short:e.tDD,long:{template:e.dLO,tokens:[{text:e.BT7,suggestions:[]},{text:e.EpJ,suggestions:[e.e4h,e.RH$,e.qNt,e.HHT]},{text:e.Yct,suggestions:[e.N9k,e.JAA,e.qPP,e._TT]},{text:e.DwB,suggestions:[e.aGM,e.GfJ,e.T1c,e.GKQ]},{text:e.jRe,suggestions:[e.X37,e.oyT,e.Ue8,e._Uf]}]}},Recap:{short:e.m3Q,long:{template:e.oYQ,tokens:[{text:e.aVn,suggestions:[]},{text:e.WBk,suggestions:[e.pnp,e.Pyi,e.m3w,e.tg0]},{text:e.oRx,suggestions:[e.pCP,e.Imb,e.vTR,e.uXg]},{text:e.U_L,suggestions:[e.z9I,e.Elz,e.gIW,e.m$F]},{text:e.OoN,suggestions:[e.Idq,e.WYg,e.J1_,e.g9y]},{text:e.Jj3,suggestions:[e.nm0,e.jc4,e.ufU,e.DuV]}]}},Message:{short:e.JVN,long:{template:e.Oo8,tokens:[{text:e.Ipj,suggestions:[]},{text:e.Jhs,suggestions:[e.s06,e.R7N,e.tAC,e._XH]},{text:e.tpm,suggestions:[e.T0M,e.pSu,e.Aqp,e.p5r]},{text:e.Say,suggestions:[e.tfS,e.xwH,e.Eci,e.oc2]}]}},MeetingNewletter:{short:e.jG0,long:{template:e.IHl,tokens:[{text:e.glk,suggestions:[]},{text:e.tvJ,suggestions:[e.XGH,e.HGJ,e.Jve,e.c3_]},{text:e.ZJQ,suggestions:[e.mrY,e.MmR,e.qNh,e.x2p]},{text:e.JiV,suggestions:[e.RC8,e.Cjd,e.ffE,e.WRq]},{text:e.DFN,suggestions:[e.wzw,e.MOv,e.aK3,e.xdX]},{text:e.GsF,suggestions:[e.O_x,e._7u,e.ZAZ,e.M$6]}]}}};var n;function a(e,t){if(e.long.tokens.length!==t.length)throw new Error("The length of properties should be equal to the length of tokens in the raw prompt");return{short:e.short,long:{template:e.long.template,placeholders:e.long.tokens.map((e,n)=>{const{decoration:a,canvasControls:i=[]}=t[n];return{...e,canvasControls:i,decoration:a}})}}}!function(e){e.Bold="bold"}(n||(n={}));const i={Newsletter:function(e){return a(t.Newsletter,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"},{id:e[2].id,layout:"img"}]},{canvasControls:[{id:e[3].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"p"}]},{canvasControls:[{id:e[5].id,layout:"img"},{id:e[6].id,layout:"p"}]},{canvasControls:[{id:e[7].id,layout:"img"},{id:e[8].id,layout:"p"}]},{canvasControls:[{id:e[10].id,layout:"p"}]}])},EventAnnouncement:function(e){return a(t.Event,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[2].id,layout:"p"}]},{canvasControls:[{id:e[3].id,layout:"p"},{id:e[4].id,layout:"p"}]},{canvasControls:[{id:e[5].id,layout:"img"},{id:e[6].id,layout:"p"}]}])},StatusUpdate:function(e){return a(t.StatusUpdate,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[2].id,layout:"p"}]},{canvasControls:[{id:e[3].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"img"},{id:e[5].id,layout:"p"},{id:e[6].id,layout:"p"}]},{canvasControls:[{id:e[7].id,layout:"p"},{id:e[8].id,layout:"p"}]}])},Process:function(e){return a(t.Process,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[2].id,layout:"img"},{id:e[3].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"img"},{id:e[5].id,layout:"p"}]},{canvasControls:[{id:e[6].id,layout:"p"}]}])},Topic:function(e){return a(t.Topics,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"},{id:e[2].id,layout:"img"}]},{canvasControls:[{id:e[3].id,layout:"p"},{id:e[5].id,layout:"img"}]},{canvasControls:[{id:e[6].id,layout:"p"}]},{canvasControls:[{id:e[8].id,layout:"p"}]}])},TrainingVideo:function(e){return a(t.Training,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[2].id,layout:"p"}]},{canvasControls:[{id:e[3].id,layout:"p"}]}])},Recap:function(e){return a(t.Recap,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[2].id,layout:"p"}]},{canvasControls:[{id:e[3].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"p"}]}])},MessageVideo:function(e){return a(t.Message,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[2].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"p"}]}])},MeetingNewsletter:function(e){return a(t.MeetingNewletter,[{canvasControls:[],decoration:"bold"},{canvasControls:[]},{canvasControls:[{id:e[1].id,layout:"p"}]},{canvasControls:[{id:e[3].id,layout:"p"}]},{canvasControls:[{id:e[4].id,layout:"p"}]},{canvasControls:[{id:e[6].id,layout:"p"}]}])}};var r,o=ce(718),s=ce(631);!function(e){e[e.Text=0]="Text",e[e.Field=1]="Field",e[e.Config=2]="Config"}(r||(r={}));const c={0:["|","|"],1:["[","]"],2:["(",")"]},d=["{","}"];function l(e){if(!e)return{template:"",tokens:[]};const t=[],n=[];let a=0,i=0;for(;i<e.length;){const r=e[i];let o;switch(r){case c[0][0]:o=u(0,e.slice(i));break;case c[1][0]:o=u(1,e.slice(i));break;case c[2][0]:o=u(2,e.slice(i))}if(o){const{token:e,size:r}=o;t.push(e),n.push("{",a.toString(),"}"),i+=r,a++}else n.push(r),i++}return{template:n.join(""),tokens:t}}function u(e,t){const[n,a]=c[e];if(t[0]!==n)return;const i=t.indexOf(a,1);if(-1===i)return;const r=t.slice(1,i),[o,s]=d,l=i+1;if(t[l]!==o)return{token:{type:e,text:r},size:i-0+1};let u=0,f=l;for(;f<t.length&&(t[f]===o?u++:t[f]===s&&u--,0!==u);)f++;const p=t.slice(l,f+1);try{const t=JSON.parse(p);return t?{token:{type:e,text:r,options:t},size:f-0+1}:{token:{type:e,text:r},size:i-0+1}}catch(t){return{token:{type:e,text:r},size:i-0+1}}}function f(e){return 0===e.tokens.length?e.template:e.template.replace(/\{(\d+)\}/g,(t,n)=>{const a=e.tokens[parseInt(n,10)],[i,r]=c[a.type],o=[i,a.text,r];return a.options&&o.push(JSON.stringify(a.options)),o.join("")})}function p(e){return e.template.replace(/\{(\d+)\}/g,(t,n)=>e.tokens[n].text.trim()||e.tokens[n].placeholder||"")}var m,_;!function(e){e[e.All=0]="All",e[e.Microsoft=1]="Microsoft",e[e.Customer=2]="Customer"}(m||(m={})),function(e){e[e.Page=0]="Page",e[e.NewsPost=1]="NewsPost"}(_||(_={}));const h=[1,0];function b(e,t,n){switch(t){case 1:return e[1][n];case 2:return e[2][n];case 0:return e[1][n].concat(e[2][n])}}function g(e){if(!e.prompt)return null;const t=e.prompt.long;return{template:t.template,tokens:t.placeholders.map(e=>({type:e.decoration?r.Text:r.Field,text:e.decoration?e.text:"",placeholder:e.text,suggestions:e.suggestions?.map(e=>({text:e})),options:{decoration:e.decoration,canvasControls:e.canvasControls}}))}}var v;!function(e){e.PlannerReport="planner-report",e.TeamsMeeting="teams-meeting",e.BizchatHandoff="bizchat-handoff",e.KaHandoff="ka-handoff",e.LoopPage="loop-page",e.AITemplates="ai-templates"}(v||(v={}));const y=JSON.parse('{"w5":"Planner Report","sz":"Planner status report template","TM":"Title area","e3":"Title area description","gT":"Status Report","s3":"Create a planner status report","Ut":"Create a newspost for {0}, featuring sections {1}, {2}, {3}, {4}, {5}, {6} and {7}.","i3":"Create a newspost for {0}, featuring sections {1}, {2}, {3}, {4}, {5}, {6}, {7}, {8}, {9} and {10}.","RM":"Project","GQ":"Status Overview","fm":"Status and Date","O8":"Task Completion Chart","wD":"Summary","Ff":"Timeline Diagram","Ge":"Highlights","iC":"Challenges and Delays","xD":"Goals and Milestone Progress","NI":"Up Next","K0":"AI Notice"}');var S=ce(9676),D=ce(6356);function I(){return S._SPKillSwitch.isActivated("63635c53-45d3-442e-9f68-8fd1e300d3cb")}function x(){return S._SPKillSwitch.isActivated("7fdd9154-d75e-4570-a41a-bba8cdc6e35f")}function C(){return S._SPKillSwitch.isActivated("0b0fa0ac-fa05-4dc1-9a87-3309a4cc9820")}function O(){return S._SPKillSwitch.isActivated("696e5324-3243-464f-8dc3-7ad2c3842504")}function w(){return S._SPKillSwitch.isActivated("1636583b-b0d0-45c9-ad9d-7007f8313a2a")}function E(){return S._SPKillSwitch.isActivated("4b43afdb-e454-42d9-80f4-cab685f927bd")}function A(){return S._SPKillSwitch.isActivated("b4ddd1a0-d5e7-406d-8b25-fdbfb279514f")}function L(){return S._SPKillSwitch.isActivated("383d9c01-d3a3-4191-a6d7-b71483646005")}function k(){return S._SPKillSwitch.isActivated("45648990-9e3b-4693-856b-e288a9ec7fc1")}function M(){return S._SPKillSwitch.isActivated("7e8a6d1b-eb0c-4d89-8379-0855dc57c792")}function P(){return S._SPKillSwitch.isActivated("948b41dc-292c-420f-b629-49a2f6484baa")}const T={Banner:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",Image:"d1d91016-032f-456d-98a4-721247c305e8",Stream:"ac0e47ca-30af-452c-bdbb-510b715d0e46",QuickLinks:"c70391ea-0b10-4ee9-b2b4-006d3fcad0cd",People:"7f718435-ee4d-431c-bdbf-9c4ff326f46e",QuickChart:"91a50c94-865f-4f5c-8b4e-e49659e69772",RTE:"4c74fdc1-070e-40a5-b900-46690c8bede6"},U="8654b779-4886-46d4-8ffb-b5ed960ee986",F="2161a1c6-db61-4731-b97c-3cdb303f7cbb";function H(e,t,n){switch(n.controlType){case s.CanvasControlType.RTE:return!0;case s.CanvasControlType.WebPartZone:return n.webPartId===T.Banner?0===e&&(0,s.hasTitleAreaBannerWebPart)(t):Object.values(T).includes(n.webPartId);default:return!1}}function R(e){switch(e.controlType){case s.CanvasControlType.RTE:return"Text";case s.CanvasControlType.WebPartZone:switch(e.webPartId){case T.Banner:return"Banner";case T.Image:return"Image";case T.Stream:return"Stream";case T.QuickLinks:return"QuickLinks";case T.People:return"People";case T.QuickChart:return"QuickChart";default:return}}}function N(e={zoneId:S.Guid.newGuid().toString(),zoneIndex:0,sectionIndex:1,layoutIndex:1,controlIndex:1,sectionFactor:12}){const{zoneId:t=S.Guid.newGuid().toString(),zoneIndex:n=0,sectionIndex:a=1,controlIndex:i=1,layoutIndex:r=1,sectionFactor:o=12}=e;return{zoneId:t,zoneIndex:n,sectionIndex:a,controlIndex:i,layoutIndex:r,sectionFactor:o}}function B(e,t,n){const{zoneId:a,zoneIndex:i,sectionIndex:r,sectionFactor:o,controlIndex:c,layoutIndex:d}=N(n);return{id:e,controlType:s.CanvasControlType.WebPartZone,position:{layoutIndex:d,zoneIndex:i,zoneId:a,sectionIndex:r,sectionFactor:o,controlIndex:c},webPartId:T.Banner,webPartData:{id:T.Banner,instanceId:e,dataVersion:"1.6",title:t,description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:"https://cdn.hubblecontent.osi.office.net/m365content/publish/fd9689ac-0043-4f9f-9b4f-85faad313c0c/679148156.jpg"},links:{},customMetadata:{imageSource:{width:"3753",height:"2653"}}},properties:{imageSourceType:s.ImageSourceType.sharepointURI,title:t,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!1,authorByline:void 0,layoutType:"FullWidthImage",imgHeight:2653,imgWidth:3753,...!S._SPKillSwitch.isActivated("4349c3fd-cd41-455b-b575-a4d7370f8ee3")&&{encodedImage:"BsCbHJ_M-:I9I@Si"}}}}}function j(e,t,n){const{zoneId:a,zoneIndex:i,sectionIndex:r,controlIndex:o,sectionFactor:s}=N(n);return{position:{layoutIndex:1,zoneIndex:i,zoneId:a,sectionIndex:r,sectionFactor:s,controlIndex:o},webPartData:{id:F,instanceId:e,title:"Divider",description:"Add a line to divide areas on your page.",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.1",properties:t,containsDynamicDataSource:!1},controlType:3,id:e,webPartId:F,reservedHeight:t.weight,reservedWidth:776,addedFromPersistedData:!0}}function V(e,t,n){const{zoneId:a,zoneIndex:i,sectionIndex:r,controlIndex:o,sectionFactor:s}=N(n);return{position:{layoutIndex:1,zoneIndex:i,zoneId:a,sectionIndex:r,sectionFactor:s,controlIndex:o},webPartData:{id:U,instanceId:e,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.0",properties:t,containsDynamicDataSource:!1,title:"Spacer"},controlType:3,id:e,webPartId:U,addedFromPersistedData:!0}}function z(e,t,n){const{zoneId:a,zoneIndex:i,sectionIndex:r,controlIndex:o}=N(n);return{controlType:s.CanvasControlType.RTE,id:e,position:{zoneId:a,zoneIndex:i,sectionIndex:r,controlIndex:o},innerHTML:D.SafeHtml.clean(t)}}function G(e,t,n){const{imageUrl:a}=t,{zoneId:i,zoneIndex:r,sectionIndex:o,controlIndex:c,layoutIndex:d,sectionFactor:l}=N(n);return{webPartId:T.Image,controlType:s.CanvasControlType.WebPartZone,id:e,position:{zoneId:i,zoneIndex:r,sectionIndex:o,controlIndex:c,layoutIndex:d,sectionFactor:l},isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:T.Image,instanceId:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,imageUrl:a,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}}}const K=[{id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",controlType:s.CanvasControlType.WebPartZone,position:{layoutIndex:s.firstLayoutIndex,zoneIndex:1,zoneId:"8b4711fb-5d3a-49e2-be7f-7c41b27f7422",sectionIndex:1,sectionFactor:0,controlIndex:1},webPartId:T.Banner,webPartData:{id:T.Banner,instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",dataVersion:"1.6",title:y.TM,description:y.e3,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:"/_layouts/15/images/sleektemplateimagetile.jpg"},links:{}},properties:{imageSourceType:o.ImageSourceType.sharepointURI,title:y.gT,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!1,authorByline:void 0,layoutType:"FullWidthImage"}}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"c1e3f3d5-8b6d-4b0c-92ce-507c176310cc",sectionIndex:1,sectionFactor:8,controlIndex:1},id:"5fbde23f-6225-45c9-adba-d46355fc0436",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Status Overview:</span></h2><h4 class="headingSpacingAbove headingSpacingBelow">Status: <span style="color:#c95812;">Delayed&nbsp;</span></h4><p>As of February 11, 2025, this project is <strong>delayed</strong>, but significant progress has been made in various areas</p>'},{position:{layoutIndex:1,zoneIndex:2,zoneId:"c1e3f3d5-8b6d-4b0c-92ce-507c176310cc",sectionIndex:2,sectionFactor:4,controlIndex:1},id:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:3,zoneId:"4cd58940-aa20-4eae-b6ef-6ee579f0a064",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"5d214718-a48c-4b89-a254-1a3403900c81",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Project Summary:</span></h2><p>The project aims to develop a comprehensive status report generation system. </p>'},{position:{layoutIndex:1,zoneIndex:4,zoneId:"2b45d010-ca6a-4c0e-925b-a1c577a61d85",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:5,zoneId:"ec73c964-cdd8-4309-b3fe-0a63bed4a6b2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"40472162-0e3a-4715-8fb1-87828e73a7b1",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Highlights</span></h2><h3>Service Dev Design Closure</h3><p><strong>Date:</strong> January 20, 2025</p><p>@John successfully completed the POC setup for status generation</p><ul class="customListStyle"><li>Feasibility proven for major items.</li></ul>'},{position:{layoutIndex:1,zoneIndex:6,zoneId:"a864b2cf-c272-4c20-a727-2cc4442b1d59",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"03a37bd7-e044-42f0-99c7-660a8ead7ada",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Challenges and Delays</span></h2><h3>Capacity Issues with Loop API</h3><p><strong>Issue and Impact:</strong></p><ul class="customListStyle"><li>Encountered capacity issues with the API, affecting the implementation of rich native loop controls.</li></ul>'},{position:{layoutIndex:1,zoneIndex:7,zoneId:"07a75d4b-55df-4834-a585-6a43ffde2b4e",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"51366efd-cc03-4c5e-8adb-9e485dae223f",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemePrimary">Goals and Milestone Progress</span></h2><figure class="table canvasRteResponsiveTable" style="width:100%;"><table class="filledHeaderTableStyleTheme ck-table-resized"><colgroup><col style="width:25.6%;"><col style="width:10.9%;"><col style="width:9.4%;"><col style="width:54.1%;"></colgroup><thead><tr><th>Milestone Progress</th><th>Due Date</th><th>Status</th><th>Comments</th></tr></thead><tbody><tr><td><strong>Service Dev Design Closure</strong></td><td>Jan 11, 2025</td><td><span style="color:#29871f;"><strong>Completed</strong></span></td><td>- Design review completed.</td></tr></tbody></table></figure>'},{position:{layoutIndex:1,zoneIndex:8,zoneId:"ab7446fa-96d3-4e4f-86fe-d6d1e9a457f2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"43d42358-00b5-4103-bf7b-e0759d7431ae",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemeDarkAlt">Next Up</span></h2><figure class="table canvasRteResponsiveTable" style="width:100%;"><table class="borderHeaderTableStyleTheme ck-table-resized"><colgroup><col style="width:33.6%;"><col style="width:12.84%;"><col style="width:15.87%;"><col style="width:37.69%;"></colgroup><thead><tr><th>Work Item</th><th>Owner(s)</th><th>Date Range</th><th>Details</th></tr></thead><tbody><tr><td>[Implementation] Retrieve Additional Fields</td><td>@Ujan Roy</td><td>Jan 29 - Feb 1, 2025</td><td>Start implementation post discussion with @Jeff.</td></tr></tbody></table></figure>'}],W={short:y.s3,long:{template:y.Ut,placeholders:[{text:y.RM,canvasControls:[{id:K[0].id,mode:"inference"}]},{text:y.GQ,canvasControls:[{id:K[1].id,mode:"mapping"},{id:K[2].id,mode:"mapping",sourceContentType:"mermaid"}]},{text:y.wD,canvasControls:[{id:K[3].id,mode:"mapping"}]},{text:y.Ff,canvasControls:[{id:K[4].id,mode:"mapping",sourceContentType:"mermaid"}]},{text:y.Ge,canvasControls:[{id:K[5].id,mode:"mapping"}]},{text:y.iC,canvasControls:[{id:K[6].id,mode:"mapping"}]},{text:y.xD,canvasControls:[{id:K[7].id,mode:"mapping"}]},{text:y.NI,canvasControls:[{id:K[8].id,mode:"mapping"}]}]}},q={id:"74d7f412-bf29-4725-a15a-d662487b583a",metadata:{title:y.w5,description:y.sz,thumbnailUrl:""},canvasContent:K,source:m.Microsoft,category:_.NewsPost,absoluteUrl:"",prompt:W},Q=[{id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",controlType:s.CanvasControlType.WebPartZone,position:{layoutIndex:1,zoneIndex:1,zoneId:"f2f0a0ca-2930-47e0-9f84-277f049915a2",sectionIndex:1,sectionFactor:0,controlIndex:1},webPartId:T.Banner,webPartData:{id:T.Banner,instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",dataVersion:"1.6",title:y.TM,description:y.e3,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:"https://cdn.hubblecontent.osi.office.net/m365content/publish/fd9689ac-0043-4f9f-9b4f-85faad313c0c/679148156.jpg"},links:{},customMetadata:{imageSource:{width:"3753",height:"2653"}}},properties:{imageSourceType:o.ImageSourceType.sharepointURI,title:y.gT,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!1,authorByline:void 0,layoutType:"FullWidthImage",imgHeight:2653,imgWidth:3753}}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:1},id:"1ddc8cf4-49b5-46df-b9b6-76237bf38c19",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",reservedWidth:776,reservedHeight:1,webPartData:{id:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",instanceId:"1ddc8cf4-49b5-46df-b9b6-76237bf38c19",title:"Divider",description:"Add a line to divide areas on your page.",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.2",properties:{minimumLayoutWidth:1,length:100,weight:1},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:2},id:"5fbde23f-6225-45c9-adba-d46355fc0436",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><strong>Status</strong>: <span class="fontColorRed"><strong>At Risk</strong></span></h2><p class="noSpacingAbove spacingBelow" aria-hidden="true" data-text-type="withSpacing">&nbsp;</p><p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Date of Report:</strong> April 16, 2025&nbsp;</span></span></p><p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Reporting Period: </strong>April 9, 2025 - April 16, 2025&nbsp;</span></span></p>'},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:3},id:"e434db2c-9abb-43ea-971f-eb00c74ec049",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",reservedWidth:776,reservedHeight:1,webPartData:{id:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",instanceId:"e434db2c-9abb-43ea-971f-eb00c74ec049",title:"Divider",description:"Add a line to divide areas on your page.",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.2",properties:{minimumLayoutWidth:1,length:100,weight:1},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:4},id:"5955e87a-e3ed-4539-8047-0dc3e655a890",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<p class="noSpacingAbove spacingBelow" data-text-type="withSpacing">The project is currently at risk due to a significant number of overdue tasks and several critical tasks that are still in progress. The primary causes of the delays include dependencies on external teams and pending approvals for key components. Immediate attention is required to address these issues to prevent further delays and ensure the project remains on track.</p>'},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:2,sectionFactor:4,controlIndex:1},id:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"5d214718-a48c-4b89-a254-1a3403900c81",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Project Summary:</span></h2><p>The project aims to develop a comprehensive status report generation system. </p>'},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:2},id:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:2},id:"emptySection",controlType:1,addedFromPersistedData:!0},{position:{layoutIndex:1,zoneIndex:5,zoneId:"ec73c964-cdd8-4309-b3fe-0a63bed4a6b2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"40472162-0e3a-4715-8fb1-87828e73a7b1",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>Highlights</strong></span></h2><h4 class="headingSpacingAbove headingSpacingBelow lineHeight1_0">Code Changes</h4><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt"><strong>Date:</strong></span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt"><strong>Description:</strong> Task completed by @{Someone}.</span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt"><strong>Details:</strong></span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt">PR is merged.</span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt">Label \\\'Public\\\' associated and then deleted.</span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt"><strong>Impact: </strong>This task is critical for the compliance with the new plan grounding.</span></span></p><p class="noSpacingAbove noSpacingBelow lineHeight1_0" aria-hidden="true" data-text-type="noSpacing">&nbsp;</p>'},{position:{layoutIndex:1,zoneIndex:6,zoneId:"a864b2cf-c272-4c20-a727-2cc4442b1d59",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"03a37bd7-e044-42f0-99c7-660a8ead7ada",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>Challenges and Delays</strong></span></h2><h4 class="headingSpacingAbove headingSpacingBelow lineHeight1_0">Onboarding new system</h4><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Issues and Impacts:</strong></span></p><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Issues:</strong> The onboarding process for the system has not yet been completed, which is a critical blocker for enabling the feature in production.</span></p></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Impacts:</strong> This delay could potentially push back the entire project timeline if not resolved promptly.</span></p></li></ul></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Possible Next Steps:</strong></span></p><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Strategies:</strong> Continue discussions with the infra team to expedite the onboarding process. Consider alternative solutions if the delay persists.</span></p></li></ul></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Associated Dates:Due Date:</strong> 2025-03-28</span></p></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>People Responsible:</strong> @John Doe</span></p></li></ul><p class="noSpacingAbove noSpacingBelow lineHeight1_0" style="margin-left:48px;" aria-hidden="true" data-text-type="noSpacing">&nbsp;</p>'},{position:{layoutIndex:1,zoneIndex:7,zoneId:"07a75d4b-55df-4834-a585-6a43ffde2b4e",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"51366efd-cc03-4c5e-8adb-9e485dae223f",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemePrimary"><strong>Goals and Milestone Progress</strong></span></h2><figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:8%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"></colgroup><thead><tr><th></th><th>Milestone</th><th>Due Date</th><th>Status</th><th>Comments</th></tr></thead><tbody><tr><td>1</td><td><strong></strong></td><td></td><td></td><td><p></p></td></tr></tbody></table></figure>'},{position:{layoutIndex:1,zoneIndex:8,zoneId:"ab7446fa-96d3-4e4f-86fe-d6d1e9a457f2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"43d42358-00b5-4103-bf7b-e0759d7431ae",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemePrimary"><strong>Up Next</strong></span></h2><figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:8%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"></colgroup><thead><tr><th></th><th>Work Item</th><th>Owner(s)</th><th>Date Range</th><th>Details</th></tr></thead><tbody><tr><td></td><td><strong></strong></td>1<td></td><td></td><td></td></tr></tbody></table></figure>'},{position:{layoutIndex:1,zoneIndex:9,zoneId:"d02b8b31-897f-4afc-9764-06c71e191df0",sectionIndex:1,sectionFactor:12,controlIndex:1},emphasis:{zoneEmphasis:0},id:"0097251c-7d4e-47aa-b18f-35cfc178d143",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><strong>Prepared by: {Author}</strong></p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing">Status report created with Project Manager Agent</p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">For best results, regularly update the plan and verify content with plan details: </span></span><a href=""><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">{Project Name}</span></span></a>.</p><p class="noSpacingAbove spacingBelow" aria-hidden="true" data-text-type="withSpacing">&nbsp;</p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">AI generated content may be incorrect</span></span></p><p aria-hidden="true">&nbsp;</p>'}],Y=[{id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",controlType:s.CanvasControlType.WebPartZone,position:{layoutIndex:1,zoneIndex:1,zoneId:"f2f0a0ca-2930-47e0-9f84-277f049915a2",sectionIndex:1,sectionFactor:0,controlIndex:1},webPartId:T.Banner,webPartData:{id:T.Banner,instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",dataVersion:"1.6",title:y.TM,description:y.e3,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:"https://cdn.hubblecontent.osi.office.net/m365content/publish/fd9689ac-0043-4f9f-9b4f-85faad313c0c/679148156.jpg"},links:{},customMetadata:{imageSource:{width:"3753",height:"2653"}}},properties:{imageSourceType:o.ImageSourceType.sharepointURI,title:y.gT,textAlignment:"Left",showPublishDate:!1,authors:void 0,showTopicHeader:!1,authorByline:void 0,layoutType:"FullWidthImage",imgHeight:2653,imgWidth:3753}}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:1},id:"1ddc8cf4-49b5-46df-b9b6-76237bf38c19",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",reservedWidth:776,reservedHeight:1,webPartData:{id:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",instanceId:"1ddc8cf4-49b5-46df-b9b6-76237bf38c19",title:"Divider",description:"Add a line to divide areas on your page.",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.2",properties:{minimumLayoutWidth:1,length:100,weight:1},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:2},id:"5fbde23f-6225-45c9-adba-d46355fc0436",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><strong>Status</strong>: <span class="fontColorRed"><strong>At Risk</strong></span></h2><p class="noSpacingAbove spacingBelow" aria-hidden="true" data-text-type="withSpacing">&nbsp;</p><p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Date of Report:</strong> April 16, 2025&nbsp;</span></span></p><p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Reporting Period: </strong>April 9, 2025 - April 16, 2025&nbsp;</span></span></p>'},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:3},id:"e434db2c-9abb-43ea-971f-eb00c74ec049",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",reservedWidth:776,reservedHeight:1,webPartData:{id:"2161a1c6-db61-4731-b97c-3cdb303f7cbb",instanceId:"e434db2c-9abb-43ea-971f-eb00c74ec049",title:"Divider",description:"Add a line to divide areas on your page.",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.2",properties:{minimumLayoutWidth:1,length:100,weight:1},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:1,sectionFactor:8,controlIndex:4},id:"5955e87a-e3ed-4539-8047-0dc3e655a890",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<p class="noSpacingAbove spacingBelow" data-text-type="withSpacing">The project is currently at risk due to a significant number of overdue tasks and several critical tasks that are still in progress. The primary causes of the delays include dependencies on external teams and pending approvals for key components. Immediate attention is required to address these issues to prevent further delays and ensure the project remains on track.</p>'},{position:{layoutIndex:1,zoneIndex:2,zoneId:"8c1f408e-80e2-4104-b578-d42c3de3def9",sectionIndex:2,sectionFactor:4,controlIndex:1},id:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"ff6cf2f8-6c49-45d3-a05f-34c10e37220e",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"5d214718-a48c-4b89-a254-1a3403900c81",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2><span class="fontColorThemePrimary">Project Summary:</span></h2><p>The project aims to develop a comprehensive status report generation system. </p>'},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:2},id:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartId:T.Image,webPartData:{id:T.Image,instanceId:"2bb8789e-d675-41b6-9296-6afc0d0e5ce3",title:"",description:"",audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.11",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",overlayText:"",imgWidth:1600,imgHeight:1068,cropX:0,cropY:40,cropWidth:1600,cropHeight:900,fixAspectRatio:!1,isAspectRatioLockedOnLoad:!0,aspectRatioOnLoad:0,overlayTextStyles:{textColor:"light",isBold:!1,isItalic:!1,textBoxColor:"dark",textBoxOpacity:.54,overlayColor:"light",overlayTransparency:0},alignment:"Center"},containsDynamicDataSource:!1}},{position:{layoutIndex:1,zoneIndex:3,zoneId:"b216d958-4594-4df3-8872-6815046831dc",sectionIndex:1,sectionFactor:12,controlIndex:2},id:"emptySection",controlType:1,addedFromPersistedData:!0},{position:{layoutIndex:1,zoneIndex:5,zoneId:"ec73c964-cdd8-4309-b3fe-0a63bed4a6b2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"40472162-0e3a-4715-8fb1-87828e73a7b1",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>Highlights</strong></span></h2><h4 class="headingSpacingAbove headingSpacingBelow lineHeight1_0">Code Changes</h4><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralPrimaryAlt">Label \\\'Public\\\' associated and then deleted.</span></span></p><li><ul><p class="noSpacingAbove noSpacingBelow lineHeight1_0" aria-hidden="true" data-text-type="noSpacing">&nbsp;</p>'},{position:{layoutIndex:1,zoneIndex:6,zoneId:"a864b2cf-c272-4c20-a727-2cc4442b1d59",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"03a37bd7-e044-42f0-99c7-660a8ead7ada",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>Challenges and Delays</strong></span></h2><h4 class="headingSpacingAbove headingSpacingBelow lineHeight1_0">Onboarding new system</h4><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Issues and Impacts:</strong></span></p><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Issues:</strong> The onboarding process for the system has not yet been completed, which is a critical blocker for enabling the feature in production.</span></p></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Impacts:</strong> This delay could potentially push back the entire project timeline if not resolved promptly.</span></p></li></ul></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Possible Next Steps:</strong></span></p><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Strategies:</strong> Continue discussions with the infra team to expedite the onboarding process. Consider alternative solutions if the delay persists.</span></p></li></ul></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Due Date:</strong> 2025-03-28</span></p></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>People Responsible:</strong> @John Doe</span></p></li></ul><p class="noSpacingAbove noSpacingBelow lineHeight1_0" style="margin-left:48px;" aria-hidden="true" data-text-type="noSpacing">&nbsp;</p>'},{position:{layoutIndex:1,zoneIndex:7,zoneId:"07a75d4b-55df-4834-a585-6a43ffde2b4e",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"51366efd-cc03-4c5e-8adb-9e485dae223f",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemePrimary"><strong>Goals and Milestone Progress</strong></span></h2><figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:8%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"></colgroup><thead><tr><th></th><th>Milestone</th><th>Due Date</th><th>Status</th><th>Comments</th></tr></thead><tbody><tr><td>1</td><td><strong></strong></td><td></td><td></td><td><p></p></td></tr></tbody></table></figure>'},{position:{layoutIndex:1,zoneIndex:8,zoneId:"ab7446fa-96d3-4e4f-86fe-d6d1e9a457f2",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"43d42358-00b5-4103-bf7b-e0759d7431ae",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<h2 class="headingSpacingAbove headingSpacingBelow"><span class="fontColorThemePrimary"><strong>Up Next</strong></span></h2><figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:8%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"><col style="width:23%;"></colgroup><thead><tr><th></th><th>Work Item</th><th>Owner(s)</th><th>Date Range</th><th>Details</th></tr></thead><tbody><tr><td></td><td><strong></strong></td>1<td></td><td></td><td></td></tr></tbody></table></figure>'},{position:{layoutIndex:1,zoneIndex:9,zoneId:"d02b8b31-897f-4afc-9764-06c71e191df0",sectionIndex:1,sectionFactor:12,controlIndex:1},emphasis:{zoneEmphasis:0},id:"0097251c-7d4e-47aa-b18f-35cfc178d143",controlType:s.CanvasControlType.RTE,isFromSectionTemplate:!1,addedFromPersistedData:!0,contentVersion:5,innerHTML:'<p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><strong>Prepared by: {Author}</strong></p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing">Status report created with Project Manager Agent</p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">For best results, regularly update the plan and verify content with plan details: </span></span><a href=""><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">{Project Name}</span></span></a>.</p><p class="noSpacingAbove spacingBelow" aria-hidden="true" data-text-type="withSpacing">&nbsp;</p><p class="noSpacingAbove spacingBelow" data-text-type="withSpacing"><span class="fontSizeMedium"><span class="fontColorNeutralSecondary">AI generated content may be incorrect</span></span></p><p aria-hidden="true">&nbsp;</p>'}],J={short:y.s3,long:{template:y.i3,placeholders:[{text:y.RM,canvasControls:[{id:Q[0].id,mode:"inference"}]},{text:y.fm,canvasControls:[{id:Q[2].id,mode:"mapping"}]},{text:y.GQ,canvasControls:[{id:Q[4].id,mode:"mapping"}]},{text:y.O8,canvasControls:[{id:Q[5].id,mode:"mapping",sourceContentType:"mermaid"}]},{text:y.wD,canvasControls:[{id:Q[6].id,mode:"mapping"}]},{text:y.Ff,canvasControls:[{id:Q[7].id,mode:"mapping",sourceContentType:"mermaid"}]},{text:y.Ge,canvasControls:[{id:Q[9].id,mode:"mapping"}]},{text:y.iC,canvasControls:[{id:Q[10].id,mode:"mapping"}]},{text:y.xD,canvasControls:[{id:Q[11].id,mode:"mapping"}]},{text:y.NI,canvasControls:[{id:Q[12].id,mode:"mapping"}]},{text:y.K0,canvasControls:[{id:Q[13].id,mode:"mapping"}]}]}},X={key:v.PlannerReport,getTemplate:()=>({...q,canvasContent:Y,prompt:J}),getDesigns:()=>[{contentType:"text/html",references:['Space: <p class="noSpacingAbove spacingBelow" aria-hidden="true" data-text-type="withSpacing">&nbsp;</p>','Section Title: <h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>{Section Title}</strong></span></h2>','Table: <figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:50%;"><col style="width:50%;"></colgroup><thead><tr><th></th><th>Header Cell</th><th>Header Cell</th></tr></thead><tbody><tr><td>Body Cell</td><td>Body Cell</td></tr></tbody></table></figure>','Status Indicator: <h3 class="headingSpacingAbove headingSpacingBelow"><strong>Status</strong>: <span class="fontColorRed"><strong>At Risk</strong></span></h3>','Report Metadata: <p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Metadata Field A:</strong>&nbsp;{Metadata Value A}</span></span></p><p class="noSpacingAbove spacingBelow lineHeight1_0" data-text-type="withSpacing"><span class="fontSizeMediumPlus"><span class="fontColorNeutralPrimary"><strong>Metadata Field B:</strong>&nbsp;{Metadata Value B}</span></span></p>','Section: <h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>{Section Title}</strong></span></h2>{Section Content}','Section with multiple items: <h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>{Section Title}</strong></span></h2><h3>{Subsection Title}</h3><ul class="customListStyle"><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Label:</strong> {Label Value}</span></p></li><li class="fontSizeMedium" style="font-size:14px;"><p class="noSpacingAbove noSpacingBelow lineHeight1_0" data-text-type="noSpacing"><span class="fontSizeMedium"><strong>Label:</strong> {Label Value}</span></p></li></ul>','Section with Table: <h2 class="headingSpacingAbove headingSpacingBelow lineHeight2_4"><span class="fontColorThemePrimary"><strong>{Section Title}</strong></span></h2><figure class="table canvasRteResponsiveTable tableLeftAlign" title="Table"><table class="bandedRowTableStyleTheme customCells ck-table-resized"><colgroup><col style="width:50%;"><col style="width:50%;"></colgroup><thead><tr><th></th><th>Header Cell</th><th>Header Cell</th></tr></thead><tbody><tr><td>Body Cell</td><td>Body Cell</td></tr></tbody></table></figure>']}],getAllowedUrlPatterns:e=>{if(!S._SPKillSwitch.isActivated("3ae94292-f18b-4ef8-8ec8-9c88e96dbb60")){const t=[],n=e?.legacyPageContext?.farmSettings?.ExternalService_plannerredirectionurl;return n&&t.push(new RegExp(`^${n}/.*$`)),t}return[/^https:\/\/planner.cloud.microsoft\/.*$/]}};var Z=ce(530);const $=JSON.parse('{"Hn":"Quarterly Strategic Alignment and Operational Review","wD":"Summary","wd":"The Proseware Project Plan Review meeting focused on enhancing the company\\u0027s digital presence and improving customer engagement. Key points discussed included the development of a new website with a modern design, improved navigation, and enhanced functionality, the implementation of a CRM system to manage customer interactions more effectively, and the creation of a mobile application to allow customers to access Proseware\\u0027s services on the go.","C_":"Meeting Notes","hj":"The Proseware project aims to enhance the company\\u0027s digital presence and improve customer engagement.","Yk":"The project involves developing a new website with a modern design, improved navigation, and enhanced functionality.","nZ":"The project is expected to be completed within six months and requires collaboration between marketing, IT, and customer service departments.","xL":"Follow-up Tasks","jn":"Engineering manager to lead the website development team.","Qk":"Engineers to oversee the implementation of the CRM system.","tE":"Product manager to provide regular updates on the project progress.","AF":"Files Shared","Xt":"Meeting Participants","F0":"Banner","S":"Show a banner with title and author information","WI":"Stream","Vc":"Display a single video or multiple videos from a folder in OneDrive or SharePoint.","el":"Quick links","E7":"Show a collection of links to content such as documents, images, videos, and more in a variety of layouts with options for icons, images, and audience targeting.","w0":"People","rv":"Display selected people and their profiles.","jG":"Create a meeting newsletter page.","EX":"Create a {0} page for {1}, featuring sections on {2}, {3} and {4}.","gl":"meeting newsletter","tv":"subject","ZJ":"summary","DF":"meeting notes","Gs":"follow-up tasks"}');var ee=ce(6277);const te=JSON.parse('{"qI":"Workplace setup","R3":"Role guide","Kk":"Flexible work resources","RO":"Cross-discipline training"}');var ne,ae,ie,re;te.qI,te.R3,te.Kk,te.RO,function(e){e.MediaDogfood="hubble.df.officeapps.live.com",e.Dogfood="hubblecontent.df.osi.office.net",e.DogfoodCDN="res-sdf.cdn.office.net",e.MediaMSIT="hubble.msit.officeapps.live.com",e.MSIT="hubblecontent.msit.osi.office.net",e.MSITCDN="cdn.hubblecontent.msit.osi.office.net",e.Public="hubblecontent.osi.office.net",e.PublicCDN="cdn.hubblecontent.osi.office.net",e.MediaProd="hubble.officeapps.live.com",e.USNat="hubblecontent.osi.eaglex.ic.gov",e.USNatCDN="hubblecontent.azureedge.eaglex.ic.gov",e.USSec="hubblecontent.osi.microsoft.scloud",e.USSecCDN="hubblecontent.azureedge.microsoft.scloud"}(ne||(ne={})),function(e){e.Prod="prod",e.USNat="usnat",e.USSec="ussec"}(ae||(ae={})),function(e){e.StockMedia="StockMedia",e.StockMediaCDN="StockMediaCDN",e.BingMedia="BingMedia"}(ie||(ie={})),function(e){e.Dogfood="spdf",e.MSIT="prodbubble",e.Prod="prod",e.USNat="ag08",e.USSec="ag09"}(re||(re={}));var oe=new Map([[se(re.Dogfood,ie.BingMedia),ne.MediaDogfood],[se(re.MSIT,ie.BingMedia),ne.MediaMSIT],[se(re.Prod,ie.BingMedia),ne.MediaProd],[se(re.USNat,ie.BingMedia),ne.USNat],[se(re.USSec,ie.BingMedia),ne.USSec],[se(re.Dogfood,ie.StockMedia),ne.Dogfood],[se(re.MSIT,ie.StockMedia),ne.MSIT],[se(re.Prod,ie.StockMedia),ne.Public],[se(re.USNat,ie.StockMedia),ne.USNat],[se(re.USSec,ie.StockMedia),ne.USSec],[se(re.Dogfood,ie.StockMediaCDN),ne.DogfoodCDN],[se(re.MSIT,ie.StockMediaCDN),ne.MSITCDN],[se(re.Prod,ie.StockMediaCDN),ne.PublicCDN],[se(re.USNat,ie.StockMediaCDN),ne.USNatCDN],[se(re.USSec,ie.StockMediaCDN),ne.USSecCDN]]);function se(e,t){return"".concat(e,"-").concat(t)}const de={key:v.TeamsMeeting,getTemplate:(e,t)=>{const a=(t&&t.length>0?t[0]:void 0)?.hasRecording??!0,i=`https://${function(e,t){var n=function(e){if(e)return Object.values(re).find(function(t){return t===e})}(e.env2)||re.Prod;return oe.get(se(n,t))||ne.Public}(e?.legacyPageContext,ie.StockMediaCDN)}/`,r=((e,t)=>{const n=!S._SPKillSwitch.isActivated("c58a1509-8851-4a88-bce3-65db38e7e0a0"),a=[{position:{layoutIndex:1,zoneIndex:1,zoneId:"43b3a9e0-b5e3-4517-a12f-2cf4426f44aa",sectionIndex:1,sectionFactor:0,controlIndex:1},id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",instanceId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",title:$.F0,description:$.S,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:t+"m365content/publish/1e5d07eb-cc87-4d2e-8578-758dbc3d5974/884671916.jpg"},links:{},customMetadata:{imageSource:{width:n?3015:3619,height:n?1841:2750}}},dataVersion:"1.6",properties:{imageSourceType:2,title:$.Hn,textAlignment:"Left",showPublishDate:!1,showTopicHeader:!1,layoutType:"CutInShape",topicHeader:"",enableGradientEffect:!0,imgHeight:n?1841:2750,imgWidth:n?3015:3619,hasTitleBeenCommitted:!1,isDecorative:!0,authors:void 0,customContentDropSupport:"externallink",authorByline:void 0},containsDynamicDataSource:!1},webPartId:"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788",reservedWidth:1440,reservedHeight:450},{position:{layoutIndex:1,zoneIndex:2,zoneId:"e3be0829-6861-4874-a794-3d89db00144d",sectionIndex:1,sectionFactor:12,controlIndex:1},emphasis:{zoneEmphasis:0},id:"81be7552-858d-4c21-9a9c-45e8d10e476c",controlType:4,isFromSectionTemplate:!1,addedFromPersistedData:!0,innerHTML:`<h3>${$.wD}</h3><p style="margin-left:0px;">${$.wd}</p>`,contentVersion:5}],i={position:{layoutIndex:1,zoneIndex:3,zoneId:"336983dd-a505-42f2-a910-62f205277352",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"7de1abb7-3948-4002-9cc4-127515a95dbd",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"ac0e47ca-30af-452c-bdbb-510b715d0e46",instanceId:"ad971630-3fb2-4672-b322-e5eec9eded16",title:$.WI,description:$.Vc,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{baseUrl:""},componentDependencies:{layoutComponentId:"7a834a65-c7a6-4641-9cb7-e6d2724a5df0"}},dataVersion:"1.2",properties:{query:{contentLocation:1,contentTypes:[3],documentTypes:[11],sortType:6},templateId:2,maxItemsPerPage:6,maxRowsPerPageGrid:2,maxRowsPerPageTheater:1,hideWebPartWhenEmpty:!1,isTitleEnabled:!0,file:"",sourceType:"VIDEO",listSortField:"Created",playlistSortField:"Default",isPlaceholderState:!0,layoutId:"Theater",dataProviderId:"StreamVideo"}},webPartId:"ac0e47ca-30af-452c-bdbb-510b715d0e46",reservedWidth:570,reservedHeight:341},r=[{position:{layoutIndex:1,zoneIndex:e?4:3,zoneId:"b5518dda-1ed5-4124-8945-f219223f97e4",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"1a30dea5-4b76-4fb9-b022-433c77635384",controlType:4,isFromSectionTemplate:!1,addedFromPersistedData:!0,innerHTML:`<h3><span class="fontColorThemePrimary">${$.C_}</span></h3><ul class="customListStyle"><li>${$.hj}</li><li>${$.Yk}</li><li>${$.nZ}</li></ul>`,contentVersion:5},{position:{layoutIndex:1,zoneIndex:e?5:4,zoneId:"8f0debec-9181-4eae-a60a-3251312cc5cf",sectionIndex:1,sectionFactor:12,controlIndex:1},id:"a66746a3-7227-46db-8086-f63cfd68163d",controlType:4,isFromSectionTemplate:!1,addedFromPersistedData:!0,innerHTML:`<h3><span class="fontColorThemePrimary">${$.xL}</span></h3><ul class="customListStyle"><li>${$.jn}</li><li>${$.Qk}</li><li>${$.tE}</li></ul>`,contentVersion:5},{position:{layoutIndex:1,zoneIndex:e?6:5,zoneId:"508fc3f1-447f-42e8-b769-59d4cfd45553",sectionIndex:1,sectionFactor:12,controlIndex:1},emphasis:{zoneEmphasis:2},id:"a187dee3-216b-48d9-9ba8-07127e472d7f",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"c70391ea-0b10-4ee9-b2b4-006d3fcad0cd",instanceId:"a187dee3-216b-48d9-9ba8-07127e472d7f",title:$.el,description:$.E7,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{title:$.AF},imageSources:{},links:{"items[0].sourceItem.url":"https://www.microsoft.com","items[1].sourceItem.url":"https://www.microsoft.com","items[2].sourceItem.url":"https://www.microsoft.com","items[3].sourceItem.url":"https://www.microsoft.com"},componentDependencies:{layoutComponentId:"706e33c8-af37-4e7b-9d22-6e5694d92a6f"}},dataVersion:"2.4",properties:{items:[{id:1,title:`${te.qI}`,thumbnailType:2,fabricReactIcon:{iconName:"education"}},{id:2,title:`${te.R3}`,thumbnailType:2,fabricReactIcon:{iconName:"contact"}},{id:3,title:`${te.Kk}`,thumbnailType:2,fabricReactIcon:{iconName:"commitments"}},{id:4,title:`${te.RO}`,thumbnailType:2,fabricReactIcon:{iconName:"diagnosticdatabartooltip"}}],isMigrated:!0,layoutId:"FilmStrip",shouldShowThumbnail:!0,imageWidth:100,buttonLayoutOptions:{showDescription:!1,buttonTreatment:2,iconPositionType:2,textAlignmentVertical:2,textAlignmentHorizontal:2,linesOfText:2},listLayoutOptions:{showDescription:!1,showIcon:!0},waffleLayoutOptions:{iconSize:1,onlyShowThumbnail:!1},hideWebPartWhenEmpty:!0,dataProviderId:"QuickLinks",iconPicker:"onenotelogoinverse"},containsDynamicDataSource:!1},webPartId:"c70391ea-0b10-4ee9-b2b4-006d3fcad0cd",reservedWidth:1188,reservedHeight:154},{position:{layoutIndex:1,zoneIndex:e?7:6,zoneId:"73750e63-da3b-40d4-8358-48bbd9ae71a6",sectionIndex:1,sectionFactor:12,controlIndex:1},emphasis:{zoneEmphasis:0},id:"650f4856-f564-4793-96e6-acc09f022c58",controlType:3,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"7f718435-ee4d-431c-bdbf-9c4ff326f46e",instanceId:"650f4856-f564-4793-96e6-acc09f022c58",title:$.w0,description:$.rv,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{title:$.Xt,"persons[0].name":"Johanna Lorenz","persons[1].name":"Grady Archie","persons[0].email":"JohannaL@M365x61310646.OnMicrosoft.com","persons[1].email":"GradyA@M365x61310646.OnMicrosoft.com"},imageSources:{},links:{}},dataVersion:"1.5",properties:{layout:1,persons:[{id:"JohannaL@M365x61310646.OnMicrosoft.com",role:"Senior Engineer",aadObjectId:"a985f535-a610-403a-b4b1-d8eee7949046"},{id:"GradyA@M365x61310646.OnMicrosoft.com",role:"Designer",aadObjectId:"007a02d9-ba1a-4184-be26-82837de57560"}]},containsDynamicDataSource:!1},webPartId:"7f718435-ee4d-431c-bdbf-9c4ff326f46e",reservedWidth:1188,reservedHeight:144}];return e?[...a,i,...r]:[...a,...r]})(a,i),o=a?{controlType:14,webPartData:{properties:{zoneBackground:{"336983dd-a505-42f2-a910-62f205277352":{type:"image",imageData:{source:1,fileName:"sectionbackgroundimagelight1.jpg",height:955,width:716,url:"/_layouts/15/images/sectionbackgroundimagelight1.jpg"},overlay:{color:"#FFFFFF",opacity:61},useLightText:!1}}},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{"zoneBackground.336983dd-a505-42f2-a910-62f205277352.imageData.url":"/_layouts/15/images/sectionbackgroundimagelight1.jpg"},links:{}},dataVersion:"1.0"}}:void 0,s={short:$.jG,long:{template:$.EX,placeholders:[{text:$.gl,suggestions:[],canvasControls:[],decoration:n.Bold},{text:$.tv,canvasControls:[]},{text:$.ZJ,canvasControls:[{id:r[1].id,layout:"p"}]},{text:$.DF,canvasControls:[{id:r[a?3:2].id,layout:"p"}]},{text:$.Gs,canvasControls:[{id:r[a?4:3].id,layout:"p"}]}]}};return{id:"46a719e7-f688-421d-b342-c72b638b758a",metadata:{title:Z.OOBPageTemplatesStrings.MeetingNewsletterTemplateTitle,description:Z.OOBPageTemplatesStrings.MeetingNewsletterTemplateDescription,thumbnailUrl:""},canvasContent:r,canvasExtraData:o,source:m.Microsoft,category:_.NewsPost,absoluteUrl:"",prompt:s}}},le={key:v.BizchatHandoff,getTemplate:()=>{}},ue={key:v.KaHandoff,getTemplate:()=>{}},fe={key:v.LoopPage,getTemplate:()=>{}},me={[v.PlannerReport]:X,[v.TeamsMeeting]:de,[v.BizchatHandoff]:le,[v.KaHandoff]:ue,[v.LoopPage]:fe};var _e,he,be,ge,ve,ye;!function(e){e.Casual="Casual",e.Professional="Professional",e.Enthusiastic="Enthusiastic",e.Engaging="Engaging",e.Creative="Creative"}(_e||(_e={})),function(e){e.Concise="Concise",e.Medium="Medium",e.Longer="Longer"}(he||(he={})),function(e){e.KeepWriting="KeepWriting",e.Draft="Draft",e.Rewrite="Rewrite"}(be||(be={})),function(e){e.Usual="Usual",e.High="High"}(ge||(ge={})),function(e){e.EventVideo="ff16acf8-6dd6-4038-b66f-976c500bfbcc",e.MessageVideo="ff16acf8-6dd6-4038-b66f-976c500bfbcd",e.TrainingVideo="ff16acf8-6dd6-4038-b66f-976c500bfbcf",e.BasicNewsletter="1a7b9dc2-a226-4962-a476-c424563bc3f5",e.EventAnnouncement="9c99603b-b29f-449f-b9c7-67f025315e55",e.MeetingNewsletter="86a1453b-bd41-40af-b9cb-cce5a5d3d71a",e.Process="91307b73-9918-4bc8-ae51-f8672d57f73e",e.StatusUpdate="22c6ad4f-feab-4997-93ef-ba26b3f73fe1",e.Topic="ddbe5797-e0d1-4863-b953-91659a701efa"}(ve||(ve={})),function(e){e.AuthoringCopilot="AuthoringCopilot",e.Diagram="Diagram",e.RTERewrite="RTERewrite",e.RTEDraft="RTEDraft",e.Common="Common",e.TeamsHandoff="TeamsHandoff",e.Mapping="Mapping",e.VibeSiteBuilder="VibeSiteBuilder"}(ye||(ye={}));var Se=ce(5959),De=ce.n(Se),Ie=ce(6642),xe=ce(606);const Ce=(0,xe.makeStyles)({root:{display:"flex",width:"100%",height:"100%",flexDirection:"column"},title:{marginBottom:"var(--spacingVerticalM)"},previewContainer:{flex:1,overflow:"hidden",boxShadow:"var(--shadow8)",borderRadius:"var(--borderRadiusMedium)",aspectRatio:"0.6818181818181818"}}),Oe="create-page-with-copilot-customize-prompt-step-back-btn",we="create-page-with-copilot-customize-prompt-create-page-btn",Ee="create-page-with-copilot-free-prompt-back-btn",Ae="free-prompt-editor-prompt-suggestion-menu-trigger",Le=e=>`free-prompt-editor-prompt-suggestion-menu-item-${e}`,ke="free-prompt-editor-prompt-suggestion-menu-refresh-item",Me=e=>`template-gallery-category-tab-${e}`,Pe=e=>`prompt-editor-text-token-${e}`,Te=e=>`prompt-editor-field-token-${e}`,Ue=e=>`prompt-editor-field-token-${e}-input`,Fe=e=>`prompt-editor-field-token-${e}-option`,He=e=>`prompt-editor-config-token-${e}`,Re=(e,t)=>`${e}-menu-trigger-${t}`,Ne=(e,t)=>`${e}-menu-radio-item-${t}`,Be={enableCustomTemplate:!1,enableTemplateWithoutPrompt:!1,enableAADTokenMock:!1};function je(e){const t=s.CanvasContentDeserializer.getSeparatedCanvasData(e.canvasContent||[]),n=De().useMemo(()=>Ie._ClientSideWebPartManagerFactory.create(new Ie._MinimalWebPartHost(e.serviceScope)),[e.serviceScope]),a=De().useRef(null);return De().useEffect(()=>{if(a.current){const e=a.current.querySelector('[data-automation-id="Canvas"]');e&&e.setAttribute("inert","true")}},[]),De().createElement(s.CanvasDependencyContext.Provider,{value:{...s.defaultDependencies,webPartManager:n,qosPrefix:"CopilotCreation.Previewer.Preview",isStaticMode:!0}},De().createElement("div",{style:{transform:`scale(${e.displayWidth?e.displayWidth/1366:1})`,transformOrigin:"top left",width:1366,height:2003.466666666667,overflowX:"clip",overflowY:"auto",...S._SPKillSwitch.isActivated("864f0d0a-3a5e-48c3-8323-422a852a22af")?{}:e.copilotStyles},"data-automation-id":"template-previewer","aria-hidden":"true",ref:a,tabIndex:-1},De().createElement(s.CanvasStub,{serviceScope:e.serviceScope,"data-is-focusable":"false",canvasContent:{controls:t?.canvasContent||[],canvasExtraData:e.canvasExtraData||t?.canvasExtraData},shouldCenterAlign:!0,isPreviewCanvas:!0})))}var Ve,ze=ce(2141),Ge=ce(7806),Ke=ce(280);ce(9825),function(e){e[e.noDefault=0]="noDefault",e[e.vivaHomeDefault=1]="vivaHomeDefault",e[e.spDefault=2]="spDefault"}(Ve||(Ve={}));var We=ce(1717),qe=ce(9930),Qe=ce(4107);const Ye=e=>{if(!ee.Features.isFeatureEnabled({ODB:61852})||!function(e){if(e){var t=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(e);if(t)return 2===parseInt(t[1],10)}return!1}((0,ze.getTheme)().themeSchemaVersion))return(e=>({...(0,Qe.createV9MigrationTheme)(e),vivaConnectionsSoftBackground:e.isInverted?e.palette.themeLight:e.palette.themeLighterAlt,semanticPrimaryButtonText:e.semanticColors.primaryButtonText,semanticPrimaryButtonTextHovered:e.semanticColors.primaryButtonTextHovered,semanticPrimaryButtonBackgroundHovered:e.semanticColors.primaryButtonBackgroundHovered,semanticButtonBackgroundDisabled:e.semanticColors.buttonBackgroundDisabled,semanticPrimaryButtonBackgroundDisabled:e.semanticColors.primaryButtonBackgroundDisabled,semanticButtonTextDisabled:e.semanticColors.buttonTextDisabled,semanticDisabledBackground:e.semanticColors.disabledBackground,semanticButtonTextHovered:e.semanticColors.buttonTextHovered,semanticButtonBackgroundHovered:e.semanticColors.buttonBackgroundHovered,semanticPrimaryButtonBackgroundPressed:e.semanticColors.primaryButtonBackgroundPressed,semanticPrimaryButtonTextPressed:e.semanticColors.primaryButtonTextPressed,semanticDisabledText:e.semanticColors.disabledText,semanticActionLink:e.semanticColors.actionLink,semanticBodyText:e.semanticColors.bodyText,semanticDisabledBodyText:e.semanticColors.disabledBodyText,semanticDisabledBodySubtext:e.semanticColors.disabledBodySubtext,semanticInputBackground:e.semanticColors.inputBackground,semanticInputText:e.semanticColors.inputText,semanticPrimaryButtonTextDisabled:e.semanticColors.primaryButtonTextDisabled,semanticPrimaryButtonBackground:e.semanticColors.primaryButtonBackground,semanticButtonBackground:e.semanticColors.buttonBackground,semanticButtonBorder:e.semanticColors.buttonBorder,semanticButtonBackgroundPressed:e.semanticColors.buttonBackgroundPressed,semanticErrorText:e.semanticColors.errorText,colorNeutralForeground4:e.semanticColors.inputPlaceholderText,...ee.KillSwitch.isActivated("a515b31b-4c80-464e-a28d-3bcab7ecd7c5")?{colorStatusDangerBackground1:e.semanticColors.errorBackground,colorStatusWarningBackground1:e.semanticColors.warningBackground,colorStatusSuccessBackground1:e.semanticColors.successBackground}:{}}))(e);let t=(0,We.createThemeV9_unstable)(e.semanticColors.primaryButtonBackground,e.semanticColors.bodyBackground);const n=e.fontSlots;if(n){const e=(0,Qe.calculateFontVariantNew)(n);t=(0,qe.applyFonts)(t,e)}return{...t,vivaConnectionsSoftBackground:e.isInverted?e.palette.themeLight:e.palette.themeLighterAlt,semanticPrimaryButtonText:t.colorNeutralForegroundOnBrand,semanticPrimaryButtonTextHovered:t.colorNeutralForegroundOnBrand,semanticPrimaryButtonBackgroundHovered:t.colorBrandBackgroundHover,semanticButtonBackgroundDisabled:t.colorNeutralBackgroundDisabled,semanticPrimaryButtonBackgroundDisabled:t.colorNeutralBackgroundDisabled,semanticButtonTextDisabled:t.colorNeutralForegroundDisabled,semanticDisabledBackground:t.colorNeutralBackgroundDisabled,semanticButtonTextHovered:t.colorNeutralForeground1,semanticButtonBackgroundHovered:t.colorNeutralBackground1Hover,semanticPrimaryButtonBackgroundPressed:t.colorBrandBackgroundPressed,semanticPrimaryButtonTextPressed:t.colorNeutralForegroundOnBrand,semanticDisabledText:t.colorNeutralForegroundDisabled,semanticActionLink:t.colorNeutralForeground2,semanticBodyText:t.colorNeutralForeground1,semanticDisabledBodyText:t.colorNeutralForegroundDisabled,semanticDisabledBodySubtext:t.colorNeutralForegroundDisabled,semanticInputBackground:t.colorNeutralBackground1,semanticInputText:t.colorNeutralForeground1,semanticPrimaryButtonTextDisabled:t.colorNeutralForegroundDisabled,semanticPrimaryButtonBackground:t.colorBrandBackground,semanticButtonBackground:t.colorNeutralBackground1,semanticButtonBorder:t.colorNeutralStroke1,semanticButtonBackgroundPressed:t.colorNeutralBackground1Pressed,semanticErrorText:t.colorPaletteRedForeground1}},Je=JSON.parse('{"o":"Create with AI"}'),Xe=Se.createContext(void 0),Ze={},$e=(Xe.Provider,(0,xe.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]})),et=(e,t)=>{const{title:n,primaryFill:a="currentColor",...i}=e,r={...i,title:void 0,fill:a},o=$e(),s=Se.useContext(Xe)?Se.useContext(Xe):Ze;return r.className=(0,xe.mergeClasses)(o.root,(null==t?void 0:t.flipInRtl)&&"rtl"===(null==s?void 0:s.textDirection)&&o.rtl,r.className),n&&(r["aria-label"]=n),r["aria-label"]||r["aria-labelledby"]?r.role="img":r["aria-hidden"]=!0,r},tt=(e,t,n,a)=>{const i="1em"===t?"20":t,r=Se.forwardRef((e,r)=>{const o={...et(e,{flipInRtl:null==a?void 0:a.flipInRtl}),ref:r,width:t,height:t,viewBox:`0 0 ${i} ${i}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof n?Se.createElement("svg",{...o,dangerouslySetInnerHTML:{__html:n}}):Se.createElement("svg",o,...n.map(e=>Se.createElement("path",{d:e,fill:o.fill})))});return r.displayName=e,r},nt=tt("Dismiss12Regular","12",["m2.09 2.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L6 5.29l3.15-3.14a.5.5 0 1 1 .7.7L6.71 6l3.14 3.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L6 6.71 2.85 9.85a.5.5 0 0 1-.7-.7L5.29 6 2.15 2.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"]),at=tt("Dismiss24Regular","24",["m4.4 4.55.07-.08a.75.75 0 0 1 .98-.07l.08.07L12 10.94l6.47-6.47a.75.75 0 1 1 1.06 1.06L13.06 12l6.47 6.47c.27.27.3.68.07.98l-.07.08a.75.75 0 0 1-.98.07l-.08-.07L12 13.06l-6.47 6.47a.75.75 0 0 1-1.06-1.06L10.94 12 4.47 5.53a.75.75 0 0 1-.07-.98l.07-.08-.07.08Z"]),it=tt("DocumentOnePageSparkle20Regular","20",["m14.88.28.35 1.07a2.2 2.2 0 0 0 1.4 1.4l1.07.35h.02a.42.42 0 0 1 0 .8l-1.07.35a2.2 2.2 0 0 0-1.4 1.4l-.35 1.07a.42.42 0 0 1-.8 0l-.35-1.07a2.23 2.23 0 0 0-1.4-1.4l-1.07-.35a.42.42 0 0 1 0-.8l1.07-.35a2.2 2.2 0 0 0 1.38-1.4l.35-1.07a.42.42 0 0 1 .8 0Zm4.9 7.93-.76-.25a1.58 1.58 0 0 1-1-1l-.25-.76a.3.3 0 0 0-.57 0l-.25.77a1.58 1.58 0 0 1-.98 1l-.77.24a.3.3 0 0 0 0 .57l.77.25a1.58 1.58 0 0 1 1 1l.24.77a.3.3 0 0 0 .58 0l.24-.77a1.58 1.58 0 0 1 1-1l.77-.24a.3.3 0 0 0 0-.57h-.02ZM11.43 2H6a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-5.7a.48.48 0 0 0-.12-.17.64.64 0 0 0-.22-.14L15 9.77V16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h4.09a1.42 1.42 0 0 1 .86-.85l.48-.15Zm1.42 4.15A.5.5 0 0 0 12.5 6H7.41a.5.5 0 0 0 .09 1h5.09a.5.5 0 0 0 .26-.85Zm-.26 4.34a.5.5 0 0 0-.09-.99H7.41a.5.5 0 0 0 .09 1h5.09Zm0 3.5a.5.5 0 0 0-.09-.99H7.41a.5.5 0 0 0 .09 1h5.09Z"]);var rt=ce(1723),ot=ce(2207);(0,ce(8424).loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);class st extends Se.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);st._getDedicatedDomNode(t||1).appendChild(n)}}static _getDedicatedDomNode(e){st._alertNode&&document.body.removeChild(st._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),st._alertNode=t,st._alertNode}componentDidMount(){st.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||st.read(this.props.message,this.props.readingMode)}render(){return!1}}var ct=ce(9318);const dt=De().createContext(null);function lt(e){const{logger:t,children:n}=e;return De().createElement(dt.Provider,{value:t},n)}function ut(){const e=De().useContext(dt);if(!e)throw new Error("useLogger must be used within a LoggerProvider");return e}var ft=ce(6794);const pt=(0,xe.makeStyles)({tabList:{padding:"var(--spacingVerticalXS)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12);",borderRadius:"var(--borderRadiusCircular)",backgroundColor:"var(--colorNeutralBackground1)"},tab:{padding:"4px 12px","& .fui-Tab__content":{fontSize:"var(--fontSizeBase300)"}},tabInactive:{backgroundColor:"var(--colorNeutralBackground1)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"},":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"}},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"}}}}),mt=JSON.parse('{"b":"News post","n":"Page"}'),_t={[_.Page]:mt.n,[_.NewsPost]:mt.b};function ht(e){const{selectedCategory:t,onCategoryTabSelect:n}=e,a=pt(),i=(0,Se.useCallback)((e,t)=>{n(t.value)},[n]);return De().createElement(ft.TabList,{className:a.tabList,selectedValue:t,onTabSelect:i,appearance:"filled-circular",size:"small"},h.map(e=>{const n=(0,xe.mergeClasses)(a.tab,e===t?void 0:a.tabInactive);return De().createElement(ft.Tab,{className:n,key:e,value:e,"data-automation-id":Me(e),id:Me(e)},_t[e])}))}const bt=JSON.parse('{"l$":"From all sources","aF":"From Microsoft","KH":"From Customer","qc":"Start with a template","at":"Jump start your page","x$":"Start with a template to create a common SharePoint page quickly with AI.","w$":"Got it","aq":"List of templates"}'),gt="@media screen and (min-width: 772px)",vt="@media screen and (max-width: 772px)",yt="@media screen and (min-width: 480px)",St="@media screen and (max-width: 480px)",Dt="@media screen and (max-height: 359px)",It=(0,xe.makeStyles)({header:{position:"sticky",top:"calc(var(--spacingVerticalXXXL) - 12px)",zIndex:1,display:"flex",margin:"0 var(--spacingHorizontalXXL)",alignItems:"center",justifyContent:"center",padding:"0 0 var(--spacingVerticalXXXL) 0",[Dt]:{position:"static"}},tabList:{padding:"var(--spacingVerticalXS)",boxShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12);",borderRadius:"var(--borderRadiusCircular)",backgroundColor:"var(--colorNeutralBackground1)"},tab:{boxSizing:"border-box",padding:"3px 12px",borderRadius:"var(--borderRadiusCircular)",border:"none","& .fui-Tab__content":{fontSize:"var(--fontSizeBase300)"},"::after":{display:"none"},":hover::before":{display:"none"},":active::before":{display:"none"}},tabActive:{border:"1px solid var(--colorBrandForeground1)",backgroundColor:"var(--colorBrandBackground)","& .fui-Tab__content":{color:"var(--colorNeutralForegroundOnBrand)"},":hover":{backgroundColor:"var(--colorBrandBackgroundHover)","& .fui-Tab__content":{color:"var(--colorNeutralForegroundOnBrand)"}},":active":{backgroundColor:"var(--colorBrandBackgroundPressed)","& .fui-Tab__content":{color:"var(--colorNeutralForegroundOnBrand)"}}},tabInactive:{backgroundColor:"var(--colorNeutralBackground1)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"},":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"}},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)","& .fui-Tab__content":{color:"var(--colorNeutralForeground2)"}}},sourceTitle:{paddingBottom:"var(--spacingVerticalXXL)"}});var xt;!function(e){e.TemplateCard="template-card",e.CloseButton="close-btn"}(xt||(xt={}));const Ct=(0,Se.createContext)(void 0);function Ot({value:e,children:t}){return De().createElement(Ct.Provider,{value:e},t)}var wt=ce(6724),Et=ce(5711),At=ce(5648);const Lt=JSON.parse('{"D":"[{0}]","U":"{0} template"}'),kt=(0,xe.makeStyles)({card:{padding:0,":hover":{backgroundColor:"none",textDecoration:"underline"},":active":{backgroundColor:"none",textDecoration:"underline"}},preview:{margin:0,aspectRatio:"262 / 147",overflow:"hidden"},previewImage:{borderRadius:"var(--borderRadiusMedium)"},prompt:{margin:"var(--spacingVerticalXS) 0 0 0",lineHeight:"var(--lineHeightBase400)",width:"100%",height:"calc(3 * var(--lineHeightBase400))",overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"3"},token:{backgroundColor:"var(--colorBrandBackgroundInvertedPressed)",color:"var(--colorBrandForeground2)",borderRadius:"var(--borderRadiusMedium)"}});function Mt(e){const{template:t,onSelected:a,isSelected:i}=e,r=ut(),s=kt(),c=De().useRef(null);(0,Se.useEffect)(()=>{i&&c.current?.focus()},[i]);const d=(0,Se.useCallback)(()=>{r.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.TemplateCard.Click",stage:"Trigger",payload:{pageTemplateId:t.id}}),a(t)},[r,t,a]),l=De().useCallback(e=>{"Enter"===e.key&&(r.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.TemplateCard.Click",stage:"Trigger",payload:{pageTemplateId:t.id}}),e.preventDefault(),a(t))},[r,t,a]),u=t.prompt;return De().createElement(wt.Card,{onKeyDown:l,onClick:d,"data-automation-id":(f=t.id,`template-gallery-card-${f}`),role:"button",tabIndex:0,appearance:"subtle",ref:c,className:s.card,"aria-label":At.format(Lt.U,t.metadata.title)},De().createElement("div",{className:s.preview},De().createElement(Et.Image,{fit:"cover",src:t.metadata.thumbnailUrl,className:s.previewImage,role:"presentation"})),u?De().createElement(o.RichTextFormatter,{as:"div",className:s.prompt,template:u.long.template,values:u.long.placeholders.map((e,t)=>e.decoration===n.Bold?De().createElement("strong",{key:t},e.text):De().createElement("span",{key:t},S.Text.format(Lt.D,[e.text])))}):null);var f}const Pt=(0,xe.makeStyles)({grid:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",columnGap:"24px",rowGap:"32px","@media screen and (min-width: 772px) and (max-width: 1024px)":{gridTemplateColumns:"1fr 1fr 1fr"},"@media screen and (min-width: 480px) and (max-width: 772px)":{gridTemplateColumns:"1fr 1fr"},"@media screen and (min-width: 360px) and (max-width: 480px)":{gridTemplateColumns:"1fr"},"@media screen and (max-width: 480px)":{gridTemplateColumns:"1fr"}}});function Tt(e){const{templates:t,onTemplateSelected:n}=e,a=Pt(),i=function(){const e=(0,Se.useContext)(Ct);if(!e)throw new Error("useAutoFocus must be used within an AutoFocusContextProvider");return e}().element;return De().createElement("div",{className:a.grid,role:"group","aria-label":bt.aq},t.map(e=>{const t=!!i&&i.element===xt.TemplateCard&&i.templateId===e.id;return De().createElement(Mt,{key:e.id,isSelected:t,template:e,onSelected:n})}))}function Ut(e){const{selection:t,templates:n,onTemplateSelected:a}=e,i=ut(),r=It(),[o]=De().useState(t?.templateSource||m.Microsoft),[s,c]=De().useState(M()?t?.templateCategory||h[0]:void 0!==t?.templateCategory?t.templateCategory:h[0]),d=(0,Se.useMemo)(()=>b(n,o,s),[n,o,s]),[l,u]=De().useState(()=>t?.templateId?t?.templateId:d[0].id),f=(0,Se.useCallback)(e=>{u(e.id),a(e,o,s)},[u,a,o,s]),p=(0,Se.useCallback)(e=>{c(e),i.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.Category.Select",stage:"Trigger",payload:{category:e}})},[i,c]),_=De().createRef(),g="PAGE_AUTHORING_COPILOT_TEMPLATE_FRE_LOCAL_STORAGE_KEY";return(0,Se.useEffect)(()=>{e.serviceScope.whenFinished(()=>{const t=e.serviceScope.consume(ct.CoachmarkUtility.serviceKey);_.current?.firstChild&&t.attachTeachingBubble({targetElement:_.current.firstChild,content:bt.x$,headline:bt.at,localStorageKey:g,hasCloseButton:!0,styles:{primaryButton:{borderRadius:"var(--borderRadiusMedium)"}},calloutProps:{id:g,directionalHint:ze.DirectionalHint.rightTopEdge,dismissOnTargetClick:!0,setInitialFocus:!0,gapSpace:10},primaryButtonProps:{text:bt.w$,ariaLabel:bt.w$,onClick:()=>{t.dismiss(g),i.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Close",stage:"Trigger"})}},onDidMount:()=>{i.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Mount",stage:"Trigger"}),st.read(bt.at,2)},onBeforeDismiss:e=>{i.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Dismiss",stage:"Trigger"})}}).catch(e=>ot._TraceLogger.logError(ot._LogSource.create("TemplateGalleryFRE"),e,"AuthoringCopilotTemplateFRERenderFailed"))})},[]),De().createElement("div",null,De().createElement("div",{className:r.header},De().createElement(ht,{selectedCategory:s,onCategoryTabSelect:p})),De().createElement("div",{role:"tabpanel","aria-labelledby":Me(s)},De().createElement("div",{className:r.sourceTitle,ref:_},De().createElement(rt.Title3,{role:"heading","aria-level":2},bt.qc)),0!==d.length?De().createElement(Tt,{key:s,selectedTemplateId:l,templates:d,onTemplateSelected:f}):null))}m.All,bt.l$,m.Microsoft,bt.aF,m.Customer,bt.KH;var Ft=ce(5864);const Ht=JSON.parse('{"zu":"Create with AI","Bf":"Describe the page you\\u0027d like to create, or start quickly with a template","RZ":"Prompt input box"}'),Rt=(0,xe.makeStyles)({container:{maxWidth:"100%",padding:"0 var(--dialogHorizontalPadding) var(--spacingVerticalXXL) var(--dialogHorizontalPadding)"},header:{display:"flex",justifyContent:"center",paddingBottom:"var(--spacingVerticalXXXL)"},logo:{width:"48px",height:"48px"},title:{marginLeft:"var(--spacingHorizontalL)",lineHeight:"48px"},freePromptTrigger:{display:"flex",justifyContent:"center",paddingBottom:"var(--spacingHorizontalXXXL)"},input:{width:"712px",maxWidth:"100%",borderRadius:"var(--borderRadiusCircular)",padding:"13px 0",fontWeight:"var(--fontWeightRegular)",transition:"box-shadow 0.125s ease-in-out",":after":{display:"none"},"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{backgroundImage:"none"},"@media not screen and (-ms-high-contrast: active), not (forced-colors: active)":{border:"none"}},inputBoxShadowLight:{boxShadow:"0px 24px 32px 0px rgba(199, 222, 239, 0.60), 0px 2px 8px 0px rgba(172, 228, 240, 0.60)"},inputBoxShadowDark:{boxShadow:xe.tokens.shadow16},placeholder:{"&::placeholder":{color:"var(--colorNeutralForeground3)"}}});function Nt(e){const{onCategoryTabListSticky:t,onGotoFreePromptStep:n,...a}=e,i=Rt(),r=(0,ze.useCustomizationSettings)(["theme"]).theme.isInverted,o=ut(),s=De().useRef(null);(0,Se.useEffect)(()=>{if(s.current){const e=s.current,n=1/e.clientHeight,a=new IntersectionObserver(([e])=>{t(e.intersectionRatio<n)},{threshold:[n]});return a.observe(e),()=>{a.unobserve(e),a.disconnect()}}},[t]);const c=(0,Se.useCallback)(()=>{n(),o.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.FreePromptTrigger.Click",stage:"Trigger"})},[n,o]),d=(0,Se.useCallback)(e=>{"Enter"===e.code&&(e.preventDefault(),n(),o.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.TemplateGallery.FreePromptTrigger.Click",stage:"Trigger"}))},[n,o]);return De().createElement("div",{className:i.container,"data-automation-id":"create-page-with-copilot-template-gallery-step"},De().createElement("div",{className:i.header},De().createElement(rt.Title1,{className:i.title,role:"heading","aria-level":1},Ht.zu)),De().createElement("div",{className:i.freePromptTrigger,ref:s},De().createElement("div",{"aria-hidden":!0,id:"copilot-page-creation-input-label",style:{display:"none"}},Ht.RZ),De().createElement(Ft.Input,{"aria-labelledby":"copilot-page-creation-input-label",size:"large",className:(0,xe.mergeClasses)(i.input,r?i.inputBoxShadowDark:i.inputBoxShadowLight),input:{className:i.placeholder},onClick:c,onChange:c,onKeyDown:d,"data-automation-id":"create-page-with-copilot-template-gallery-step-free-prompt-trigger",placeholder:Ht.Bf})),De().createElement(Ut,a))}var Bt=ce(6879),jt=ce(7526),Vt=ce(9843),zt=ce(1395);const Gt=tt("Book16Regular","16",["M6 3a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H6Zm0 1h4v1H6V4Zm5-3H5a2 2 0 0 0-2 2v10c0 1.1.9 2 2 2h7.5a.5.5 0 0 0 0-1H5a1 1 0 0 1-1-1h8.5a.5.5 0 0 0 .5-.5V3a2 2 0 0 0-2-2ZM4 12V3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v9H4Z"]),Kt=tt("AddRegular","1em",["M10 2.5c.28 0 .5.22.5.5v6.5H17a.5.5 0 0 1 0 1h-6.5V17a.5.5 0 0 1-1 0v-6.5H3a.5.5 0 0 1 0-1h6.5V3c0-.28.22-.5.5-.5Z"]),Wt=tt("AddCircleRegular","1em",["M6 10c0-.28.22-.5.5-.5h3v-3a.5.5 0 0 1 1 0v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3A.5.5 0 0 1 6 10Zm4 8a8 8 0 1 0 0-16 8 8 0 0 0 0 16Zm0-1a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"]),qt=tt("ArrowClockwiseRegular","1em",["M4 10a6 6 0 0 1 10.47-4H12.5a.5.5 0 0 0 0 1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-1 0v1.6a7 7 0 1 0 1.98 4.36.5.5 0 1 0-1 .08L16 10a6 6 0 0 1-12 0Z"]),Qt=tt("ArrowUpRegular","1em",["M3.13 9.16a.5.5 0 1 0 .74.68L9.5 3.67V17.5a.5.5 0 1 0 1 0V3.67l5.63 6.17a.5.5 0 0 0 .74-.68l-6.32-6.92a.75.75 0 0 0-1.1 0L3.13 9.16Z"],{flipInRtl:!0}),Yt=tt("BookFilled","1em",["M6 2a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6Zm.75 2.5h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1 0-1.5Z"]),Jt=tt("BookRegular","1em",["M6 5a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v1a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V5Zm1 0v1h6V5H7ZM4 4v12c0 1.1.9 2 2 2h9.5a.5.5 0 0 0 0-1H6a1 1 0 0 1-1-1h10a1 1 0 0 0 1-1V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2Zm10-1a1 1 0 0 1 1 1v11H5V4a1 1 0 0 1 1-1h8Z"]),Xt=tt("BugRegular","1em",["M9 2.5a.5.5 0 0 0-1 0V3c0 .4.12.77.32 1.08A3 3 0 0 0 6 7h-.5A1.5 1.5 0 0 1 4 5.5v-2a.5.5 0 0 0-1 0v2A2.5 2.5 0 0 0 5.5 8H6v1.5H2.5a.5.5 0 0 0 0 1H6V12h-.5A2.5 2.5 0 0 0 3 14.5v2a.5.5 0 0 0 1 0v-2c0-.83.67-1.5 1.5-1.5H6a4 4 0 0 0 8 0h.5c.83 0 1.5.67 1.5 1.5v2a.5.5 0 0 0 1 0v-2a2.5 2.5 0 0 0-2.5-2.5H14v-1.5h3.5a.5.5 0 0 0 0-1H14V8h.5A2.5 2.5 0 0 0 17 5.5v-2a.5.5 0 0 0-1 0v2c0 .83-.67 1.5-1.5 1.5H14a3 3 0 0 0-2.32-2.92A2 2 0 0 0 12 3v-.5a.5.5 0 0 0-1 0V3a1 1 0 1 1-2 0v-.5ZM13 7v6a3 3 0 1 1-6 0V7c0-1.1.9-2 2-2h2a2 2 0 0 1 2 2Z"]),Zt=tt("ArrowRight12Regular","12",["M1.5 6c0-.28.22-.5.5-.5h6.8L6.14 2.85a.5.5 0 1 1 .7-.7l3.5 3.5c.2.2.2.5 0 .7l-3.5 3.5a.5.5 0 0 1-.7-.7L8.79 6.5H2a.5.5 0 0 1-.5-.5Z"]),$t=tt("ArrowRight16Regular","16",["M2.5 7.5a.5.5 0 1 0 0 1h9.7l-4.03 3.63a.5.5 0 1 0 .66.74l5-4.5a.5.5 0 0 0 0-.74l-5-4.5a.5.5 0 0 0-.66.74L12.2 7.5H2.5Z"]),en=tt("Attach16Regular","16",["M2.28 7.97a.5.5 0 0 0 .86.36l4.6-4.6A2.5 2.5 0 0 1 12 5.5a2.5 2.5 0 0 1-.73 1.77l-5.3 5.3a1 1 0 0 1-1.71-.7 1 1 0 0 1 .3-.71l5.3-5.3a.5.5 0 0 0-.7-.7l-5.32 5.29a2 2 0 1 0 2.83 2.83l5.3-5.3A3.49 3.49 0 0 0 9.5 2c-.9 0-1.8.34-2.48 1.02l-4.6 4.6a.5.5 0 0 0-.14.35Z"]);var tn=ce(7301),nn=ce(2737);const an=De().createContext(null);function rn(e){const{children:t}=e,n=De().useMemo(()=>{const{enableAADTokenMock:e}=function(){try{if(!S._SPFlight.isDebugFlightEnabled)return Be;const e=sessionStorage.getItem("authoring-copilot-playwright-config");return e?JSON.parse(e):Be}catch(e){return Be}}();if(e)return{generate:async(e,t,n)=>"mock-token"};const t=new nn.AadTokenProvider(nn._AadTokenProviders.preAuthorizedConfiguration);return{generate:async(e,n,a)=>{const i=await t.getToken(e,a);if(n.aborted){const e=new Error("action is aborted");throw e.name="AbortError",e}return i}}},[]);return De().createElement(an.Provider,{value:n},t)}function on(){const e=De().useContext(an);if(!e)throw new Error("useTokenGenerator must be used within a TokenGeneratorContext.Provider");return e}const sn="https://graph.microsoft.com";var cn=ce(6321);const dn=JSON.parse('{"Rw":"Non-Business","D3":"Public","wz":"General","kP":"Confidential","Ec":"Highly Confidential","$J":"This data is personal and not business related.","S4":"Business data specifically prepared and approved for use. Data is not encrypted and cannot be tracked or revoked.","L8":"Business data which is NOT meant for public consumption. It is intended for use by internal employees, business guests, and external partners.","Eb":"Data is classified and protected. Microsoft Full Time Employees (FTE) and non-employees can view, edit and reply.","wt":"Data is classified and protected. Microsoft Full Time Employees (FTE) can view, edit and reply.","TK":"A sensitive file has been added, please ensure this complies with your organization\\u0027s policy.","hm":"One or more files have sensitivity labels; check your organization\\u0027s guidelines before using.","hp":"Unable to access highly confidential protected files, please remove it and try again.","OT":"Files with high sensitivity labels can\\u0027t be used to create pages. Please remove this file and try again.||Files with high sensitivity labels can\\u0027t be used to create pages. Please remove these files and try again.","EX":"1||2-"}'),ln=tt("ChatRegular","1em",["M10 2a8 8 0 1 1-3.61 15.14l-.12-.07-3.65.92a.5.5 0 0 1-.62-.45v-.08l.01-.08.92-3.64-.07-.12a7.95 7.95 0 0 1-.83-2.9l-.02-.37L2 10a8 8 0 0 1 8-8Zm0 1a7 7 0 0 0-6.1 10.42.5.5 0 0 1 .06.28l-.02.1-.75 3.01 3.02-.75a.5.5 0 0 1 .19-.01l.09.02.09.04A7 7 0 1 0 10 3Zm.5 8a.5.5 0 0 1 .09 1H7.5a.5.5 0 0 1-.09-1h3.09Zm2-3a.5.5 0 0 1 .09 1H7.5a.5.5 0 0 1-.09-1h5.09Z"]),un=tt("ChevronLeftRegular","1em",["M12.35 15.85a.5.5 0 0 1-.7 0L6.16 10.4a.55.55 0 0 1 0-.78l5.49-5.46a.5.5 0 1 1 .7.7L7.2 10l5.16 5.15c.2.2.2.5 0 .7Z"]),fn=tt("DeleteRegular","1em",["M8.5 4h3a1.5 1.5 0 0 0-3 0Zm-1 0a2.5 2.5 0 0 1 5 0h5a.5.5 0 0 1 0 1h-1.05l-1.2 10.34A3 3 0 0 1 12.27 18H7.73a3 3 0 0 1-2.98-2.66L3.55 5H2.5a.5.5 0 0 1 0-1h5ZM5.74 15.23A2 2 0 0 0 7.73 17h4.54a2 2 0 0 0 1.99-1.77L15.44 5H4.56l1.18 10.23ZM8.5 7.5c.28 0 .5.22.5.5v6a.5.5 0 0 1-1 0V8c0-.28.22-.5.5-.5ZM12 8a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V8Z"]),pn=tt("DismissRegular","1em",["m4.09 4.22.06-.07a.5.5 0 0 1 .63-.06l.07.06L10 9.29l5.15-5.14a.5.5 0 0 1 .63-.06l.07.06c.18.17.2.44.06.63l-.06.07L10.71 10l5.14 5.15c.18.17.2.44.06.63l-.06.07a.5.5 0 0 1-.63.06l-.07-.06L10 10.71l-5.15 5.14a.5.5 0 0 1-.63.06l-.07-.06a.5.5 0 0 1-.06-.63l.06-.07L9.29 10 4.15 4.85a.5.5 0 0 1-.06-.63l.06-.07-.06.07Z"]),mn=tt("DocumentOnePageSparkleFilled","1em",["m14.88.28.35 1.07a2.2 2.2 0 0 0 1.4 1.4l1.07.35h.02a.42.42 0 0 1 0 .8l-1.07.35a2.2 2.2 0 0 0-1.4 1.4l-.35 1.07a.42.42 0 0 1-.8 0l-.35-1.07a2.23 2.23 0 0 0-1.4-1.4l-1.07-.35a.42.42 0 0 1 0-.8l1.07-.35a2.2 2.2 0 0 0 1.38-1.4l.35-1.07a.42.42 0 0 1 .8 0Zm4.9 7.93-.76-.25a1.58 1.58 0 0 1-1-1l-.25-.76a.3.3 0 0 0-.57 0l-.25.77a1.58 1.58 0 0 1-.98 1l-.77.24a.3.3 0 0 0 0 .57l.77.25a1.58 1.58 0 0 1 1 1l.24.77a.3.3 0 0 0 .58 0l.24-.77a1.58 1.58 0 0 1 1-1l.77-.24a.3.3 0 0 0 0-.57h-.02ZM6 2h5.43l-.48.15A1.43 1.43 0 0 0 10 3.5a1.41 1.41 0 0 0 .97 1.35l1.06.35c.15.05.3.13.47.29.11.11.2.24.3.47l.05.19A.5.5 0 0 0 12.5 6h-5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 .5-.43l.15.48c.1.25.25.48.52.7.14.1.3.16.45.2a1.3 1.3 0 0 0 .77 1.79l.77.25c.08.03.16.08.22.14.05.05.1.11.12.18V16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4c0-1.1.9-2 2-2Zm1 11.5c0 .28.22.5.5.5h5a.5.5 0 0 0 0-1h-5a.5.5 0 0 0-.5.5Zm5.5-4h-5a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1Z"]),_n=tt("DocumentOnePageSparkleRegular","1em",["m14.88.28.35 1.07a2.2 2.2 0 0 0 1.4 1.4l1.07.35h.02a.42.42 0 0 1 0 .8l-1.07.35a2.2 2.2 0 0 0-1.4 1.4l-.35 1.07a.42.42 0 0 1-.8 0l-.35-1.07a2.23 2.23 0 0 0-1.4-1.4l-1.07-.35a.42.42 0 0 1 0-.8l1.07-.35a2.2 2.2 0 0 0 1.38-1.4l.35-1.07a.42.42 0 0 1 .8 0Zm4.9 7.93-.76-.25a1.58 1.58 0 0 1-1-1l-.25-.76a.3.3 0 0 0-.57 0l-.25.77a1.58 1.58 0 0 1-.98 1l-.77.24a.3.3 0 0 0 0 .57l.77.25a1.58 1.58 0 0 1 1 1l.24.77a.3.3 0 0 0 .58 0l.24-.77a1.58 1.58 0 0 1 1-1l.77-.24a.3.3 0 0 0 0-.57h-.02ZM11.43 2H6a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-5.7a.48.48 0 0 0-.12-.17.64.64 0 0 0-.22-.14L15 9.77V16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h4.09a1.42 1.42 0 0 1 .86-.85l.48-.15Zm1.42 4.15A.5.5 0 0 0 12.5 6H7.41a.5.5 0 0 0 .09 1h5.09a.5.5 0 0 0 .26-.85Zm-.26 4.34a.5.5 0 0 0-.09-.99H7.41a.5.5 0 0 0 .09 1h5.09Zm0 3.5a.5.5 0 0 0-.09-.99H7.41a.5.5 0 0 0 .09 1h5.09Z"]);var hn;!function(e){e[e.None=0]="None",e[e.NonBusiness=1]="NonBusiness",e[e.Public=2]="Public",e[e.General=3]="General",e[e.Confidential=4]="Confidential",e[e.HighlyConfidential=5]="HighlyConfidential"}(hn||(hn={}));const bn={[dn.Rw]:1,[dn.D3]:2,[dn.wz]:3,[dn.kP]:4,[dn.Ec]:5},gn=(dn.Rw,xe.tokens.colorNeutralForegroundDisabled,dn.D3,xe.tokens.colorPaletteGreenBorderActive,dn.wz,xe.tokens.colorPaletteBlueBorderActive,dn.kP,xe.tokens.colorPalettePeachBorderActive,dn.Ec,xe.tokens.colorPaletteRedBorderActive,dn.Rw,dn.$J,dn.D3,dn.S4,dn.wz,dn.L8,dn.kP,dn.Eb,dn.Ec,dn.wt,(0,xe.makeStyles)({sensitivityTooltip:{fontFamily:xe.tokens.fontFamilyBase,padding:"5px 0 0 0"},sensitivityTooltipLarge:{padding:"0",width:"16px",height:"16px"},sensitivityTooltipExtraLarge:{width:"20px",height:"20px"},sensitivityLabelIcon:{top:0,left:0,width:"100%",height:"100%"},sensitivityLabelIconLarge:{transform:"scale(1)"},sensitivityLabelIconExtraLarge:{transform:"scale(1.25)"},sensitiveMessagebar:{borderRadius:"8px",gap:"8px",marginTop:"12px",...O()?{backgroundColor:xe.tokens.colorNeutralBackground3}:{},color:xe.tokens.colorNeutralForeground1,border:`1px solid ${xe.tokens.colorNeutralStroke1}`}}));function vn(e){const{isContainHighlyConfidential:t,highestLevelLabelFileCount:n=1}=e,[a,i]=De().useState(!0),r=De().useCallback(()=>{i(!1)},[i]),o=gn(),s=O()?dn.TK:dn.hm,c=O()?dn.hp:At.getLocalizedCountValue(dn.OT,dn.EX,n)||"";return De().createElement(De().Fragment,null,a&&De().createElement(cn.MessageBar,{layout:"singleline",intent:!O()&&t?"error":"warning",className:o.sensitiveMessagebar,politeness:S._SPKillSwitch.isActivated("98522977-cf75-4962-be64-0f9e5b1f2aa8")?void 0:"assertive"},De().createElement(cn.MessageBarBody,null,t?c:s),De().createElement(cn.MessageBarActions,{containerAction:t?void 0:De().createElement(jt.Button,{"aria-label":"dismiss",appearance:"transparent",icon:De().createElement(pn,null),onClick:r})})))}var yn=ce(1909);ce(6658);const Sn={displayName:"None",id:"",protectionEnabled:!1};function Dn(){const[e,t]=(0,Se.useState)([]),n=on(),a=(e,n)=>{t(t=>t.map(t=>t.id===e&&n?{...t,sensitiveLabel:n}:t))},i=De().useRef({}),r=De().useCallback(async e=>{if(t(t=>t.find(t=>t.id===e.id)?t:[...t,e]),e.type===tn.AttachmentType.File&&!e.sensitiveLabel&&!i.current[e.id])try{i.current[e.id]=new AbortController;const t={driveId:e.sharepointIds.driveId,itemId:e.sharepointIds.listItemUniqueId,generator:n,signal:i.current[e.id].signal},r=await async function(e){const{driveId:t,itemId:n,generator:a,signal:i}=e,r=new AbortController,o=r.signal;try{const e=await a.generate(sn,o);return await async function(e){const{driveId:t,itemId:n,token:a,signal:i}=e;return fetch(`${sn}/v1.0/drives/${t}/items/${n?.replace(/{|}/g,"")}?$select=sensitivityLabel`,{method:"GET",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},signal:i}).then(e=>e.json()).then(e=>{if(e&&e.sensitivityLabel)return e.sensitivityLabel})}({driveId:t,itemId:n,token:e,signal:i})}catch(e){if("AbortError"!==e.name)return}finally{r.abort()}}(t);a(e.id,r||Sn)}catch(t){"AbortError"!==t.name&&a(e.id,Sn)}},[t,n]),o=De().useCallback(e=>{t(t=>{const n=t.filter(t=>t.id!==e.id);return i.current[e.id]&&(i.current[e.id].abort(),delete i.current[e.id]),n})},[t]);(0,Se.useEffect)(()=>{const e=i.current;return()=>{Object.keys(e).forEach(t=>{const n=e[t];n&&(n.abort(),delete e[t])})}},[]);const s=De().useCallback(t=>{const n=bn[t.split(" \\ ")[0]];let a=hn.None,i=0;return e.forEach(e=>{if(e.sensitiveLabel){const t=bn[e.sensitiveLabel?.displayName.split(" \\ ")[0]];t&&(a=Math.max(t,a)),t===hn.HighlyConfidential&&e.sensitiveLabel?.protectionEnabled&&(i+=1)}}),{isSensitiveBarVisible:a>0&&a>n,isHighlySensitiveBarVisible:i>0,highestLevelLabelFileCount:i}},[e]);return{attachments:e,addAttachment:r,removeAttachment:o,checkSensitivity:s}}const In=new Set(["doc","docm","docx","docb","dot","dotm","dotx"]),xn=new Set(["ppt","pptm","pptx","sldx","sldm","pot","potm","potx","pps","ppsm","ppsx"]);function Cn(e){if(1!==e.length||e[0].type!==tn.AttachmentType.File)return!1;const t=e[0].extension;if(!t)return!1;const n=t.toLowerCase();return function(e){if(!e)return!1;const t=e.toLowerCase();return In.has(t)}(n)||function(e){if(!e)return!1;const t=e.toLowerCase();return xn.has(t)}(n)||"loop"===n||"pdf"===n}function On(e){const t=[];for(const n of e)switch(n.type){case tn.AttachmentType.File:t.push(n.extension);break;case tn.AttachmentType.Meeting:t.push("meeting")}const n=t.reduce((e,t)=>(e[t]=(e[t]||0)+1,e),{});return Object.keys(n).map(e=>`${e}: ${n[e]}`).join(", ")}var wn=ce(7408);function En(){return S._SPFlight.isEnabled(60696)}function An(){return S._SPFlight.isEnabled(1192)}function Ln(){return S._SPFlight.isEnabled(61429)&&!Hn()}function kn(e){const t=e.consume(wn.PageContext.serviceKey);return S._SPFlight.isEnabled(1192)&&S._SPFlight.isEnabled(60228)&&S._SPFlight.isEnabled(60161)&&t.site.sitePagesFeatureVersion>=11}function Mn(){return S._SPKillSwitch.isActivated("e9c4ffdd-aaa4-42d4-9488-49de72e6ec17")?S._SPFlight.isEnabled(61791):S._SPFlight.isEnabled(1573)}function Pn(){return S._SPFlight.isEnabled(62550)}function Tn(){return S._SPFlight.isEnabled(1282)}function Un(){return S._SPFlight.isEnabled(62655)}function Fn(){return S._SPFlight.isEnabled(62032)}function Hn(){return S._SPFlight.isEnabled(60316)}const Rn=JSON.parse('{"Ss":"Length","yt":"Concise","r2":"Longer","v0":"Medium","zJ":"Tone of voice","$b":"Professional","$G":"Casual","Q4":"Enthusiastic","hn":"Engaging","tE":"Creative"}'),Nn=tt("NavigationRegular","1em",["M2 4.5c0-.28.22-.5.5-.5h15a.5.5 0 0 1 0 1h-15a.5.5 0 0 1-.5-.5Zm0 5c0-.28.22-.5.5-.5h15a.5.5 0 0 1 0 1h-15a.5.5 0 0 1-.5-.5Zm.5 4.5a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1h-15Z"]);var Bn=ce(1589);function jn(e){const{name:t,value:n,options:a,labels:i,icon:r,tooltip:o,onValueChange:s}=e,c=De().useCallback((e,t)=>{s(t.checkedItems[0])},[s]);return De().createElement(Bt.Menu,{checkedValues:{[t]:[n]},onCheckedValueChange:c},De().createElement(Bt.MenuTrigger,null,De().createElement(Bn.Tooltip,{content:o,relationship:"label"},De().createElement(jt.MenuButton,{"data-automation-id":Re(t,n),icon:r,appearance:"subtle","aria-description":n},i[n]))),De().createElement(Bt.MenuPopover,null,De().createElement(Bt.MenuList,null,De().createElement(Bt.MenuGroup,null,De().createElement(Bt.MenuGroupHeader,null,o),a.map(e=>De().createElement(Bt.MenuItemRadio,{"data-automation-id":Ne(t,e),name:t,key:e,value:e},i[e]))))))}const Vn={[he.Concise]:Rn.yt,[he.Medium]:Rn.v0,[he.Longer]:Rn.r2},zn=[he.Concise,he.Medium,he.Longer];function Gn(e){const{length:t,onLengthChange:n}=e;return De().createElement(jn,{name:"adjust-length",value:t,icon:De().createElement(Nn,null),tooltip:Rn.Ss,options:zn,labels:Vn,onValueChange:n})}const Kn={[_e.Casual]:Rn.$G,[_e.Professional]:Rn.$b,[_e.Enthusiastic]:Rn.Q4,[_e.Engaging]:Rn.hn,[_e.Creative]:Rn.tE},Wn=[_e.Casual,_e.Professional,_e.Enthusiastic,_e.Engaging,_e.Creative];function qn(e){const{tone:t,onToneChange:n}=e;return De().createElement(jn,{name:"adjust-tone",value:t,icon:De().createElement(ln,null),tooltip:Rn.zJ,options:Wn,labels:Kn,onValueChange:n})}var Qn=ce(7781);const Yn=JSON.parse('{"qs":"Attachments","T0":"Remove","c6":"Only up to {0} files can be added currently","Dc":"Add files for better results","aW":"More"}'),Jn=(0,xe.makeStyles)({tagGroup:{flexWrap:"wrap",rowGap:"var(--spacingVerticalS)",width:"100%",[vt]:{flexDirection:"column"}},attachmentTag:{[gt]:{maxWidth:"calc(50% - var(--spacingHorizontalS))"},padding:"0"},attachmentTagShadow:{boxShadow:"var(--shadow2)"},attachmentTagLarge:{height:"40px"},attachmentTagExtraLarge:{height:"40px"},attachmentTagPrimary:{flex:1,minWidth:"0",backgroundColor:"var(--colorNeutralBackground1)",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)"}},attachmentTagPrimaryBorderless:{border:"none"},attachmentTagPrimaryLarge:{paddingLeft:"13px"},attachmentTagPrimaryExtraLarge:{paddingLeft:"12px"},attachmentTagPrimaryText:{maxWidth:"100%",display:"flex",flexDirection:"row",overflow:"hidden",alignItems:"center",paddingBottom:"0"},attachmentTagPrimaryTextLarge:{fontSize:"var(--fontSizeBase300)",fontWeight:"var(--fontWeightSemibold)"},attachmentTagPrimaryTextExtraLarge:{fontSize:"var(--fontSizeBase400)",fontWeight:"var(--fontWeightSemibold)"},attachmentName:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"var(--spacingHorizontalXS)"},attachmentTagSecondary:{backgroundColor:"var(--colorNeutralBackground1)",":hover":{backgroundColor:"var(--colorNeutralBackground1Hover)"},":active":{backgroundColor:"var(--colorNeutralBackground1Pressed)"}},attachmentTagSecondaryBorderless:{borderTop:"none",borderRight:"none",borderBottom:"none"},attachmentTagSecondaryLarge:{fontSize:"12px",paddingRight:"12px"},attachmentTagSecondaryExtraLarge:{fontSize:"16px",paddingRight:"12px"}});var Xn,Zn=ce(5935),$n=ce(8810);!function(e){e[e.Querying=0]="Querying",e[e.Succeed=1]="Succeed",e[e.Failed=2]="Failed"}(Xn||(Xn={}));const ea=JSON.parse('{"UF":"{0} modified at {1}","q$":"Search for documents","xt":"Add references","EJ":"Suggestions","HT":"List of search results","nF":"No suggestions available","ki":"Clear and try a different search","eX":"Searching for files","yj":"Search is complete"}');var ta=ce(3054),na=ce(7675);const aa=(0,xe.makeStyles)({combobox:{width:"380px"},listbox:{height:"300px"},spinner:{alignContent:"center",alignItems:"center",justifyContent:"center",height:"184px"},attachment:{display:"flex",flexDirection:"row",width:"100%",overflow:"hidden",alignItems:"center"},attachmentInfo:{padding:"0 var(--spacingHorizontalS)"},attachmentName:{width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:"var(--fontSizeBase300)",lineHeight:"var(--lineHeightBase300)",height:"var(--lineHeightBase300)"},attachmentActivity:{width:"100%",fontSize:"var(--fontSizeBase100)",lineHeight:"var(--lineHeightBase100)",height:"var(--lineHeightBase100)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"var(--colorNeutralForeground3)"},searchContainer:{display:"flex",flexDirection:"column",padding:"4px 0",width:"440px"},referenceContainer:{display:"flex",flexDirection:"column",padding:"0 12px",gap:"2px"},referenceText:{padding:"8px 0px",fontFamily:"var(--fontFamilyBase)",fontWeight:"var(--fontWeightRegular)",fontSize:"var(--fontSizeBase200)",lineHeight:"var(--lineHeightBase200)"},referenceSearchBox:{padding:"0px 12px"},referenceSearchBoxPlaceholder:{"&::placeholder":{color:"var(--colorNeutralForeground3)"}},suggestionContainer:{display:"flex",flexDirection:"column",padding:"0 4px",gap:"2px"},suggestionItemContainer:{display:"flex",flexDirection:"column",maxHeight:"184px",overflowY:"auto"},suggestionText:{padding:"0 8px",fontFamily:"var(--fontFamilyBase)",fontWeight:"var(--fontWeightSemibold)",fontSize:"var(--fontSizeBase200)",lineHeight:"var(--lineHeightBase200)"},divider:{width:"100%",padding:"9px 0 8px 0"},uploadContainer:{width:"440px",fontWeight:"unset",height:"36px",justifyContent:"left",padding:"0 8px",gap:"2px"},clearContainer:{display:"flex",flexDirection:"column",marginTop:"10px",paddingLeft:"6px",paddingRight:"6px"},text:{marginBottom:"12px",paddingLeft:"10px",fontFamily:"var(--fontFamilyBase)"},clearButton:{backgroundColor:"var(--colorNeutralBackground3)",color:"var(--colorBrandForeground1)",border:"1px",borderRadius:"4px",padding:"10px",justifyContent:"left"}}),ia=De().createContext(void 0),ra=({pageContext:e,serviceScope:t,children:n})=>{const a={pageContext:e,serviceScope:t};return De().createElement(ia.Provider,{value:a},n)},oa=()=>{const e=De().useContext(ia);if(!e)throw new Error("useServiceScope must be used within a ServiceScopeProvider");return e};function sa(e){const t=aa(),{selectedAttachments:n,onSelect:a}=e,[i,r]=De().useState(""),s=De().useCallback((e,t)=>{r(t.value)},[r]),c=De().useCallback(()=>{r("")},[r]),d=De().useMemo(()=>{const e=[];for(const t of n)t.type===tn.AttachmentType.File&&t.sharepointIds.listItemUniqueId&&e.push(t.sharepointIds.listItemUniqueId);return e},[n]),{pageContext:l}=oa(),u=function(e){const{ignoredFileIds:t,queryString:n,endpoint:a}=e,i=on(),[r,o]=De().useState({status:0}),s=De().useRef(null);return(0,Se.useEffect)(()=>{s.current&&s.current.abort();const e=new AbortController,r=e.signal;return s.current=e,(async()=>{try{await async function(e,t){return new Promise((e,n)=>{let a=null;const i=()=>{if(a){clearTimeout(a),a=null;const e=new Error("action is aborted");e.name="AbortError",n(e)}};t.addEventListener("abort",i),a=window.setTimeout(()=>{t.removeEventListener("abort",i),a=null,e()},500)})}(0,r),o({status:0});const e=await i.generate(a||sn,r),s=await async function(e){const{queryString:t,extensions:n,ignoredFileIds:a,token:i,signal:r,endpoint:o}=e,s=["({searchterms})"];if(n.length>0){const e=n.map(e=>`FileExtension:${e}`).join(" OR ");s.push(`(${e})`)}if(a.length>0){const e=a.filter(e=>!!e).map(e=>`NOT(UniqueId:${e})`).join(" AND ");s.push(`(${e})`)}return fetch(`${o||sn}/v1.0/search/query`,{method:"POST",body:JSON.stringify({requests:[{entityTypes:["driveItem"],query:{queryString:t,queryTemplate:s.join(" AND ")},from:0,size:20,fields:["id","name","webUrl","uniqueId","driveId","listId","listItemId","webId","siteId","createdBy","createdDateTime","lastModifiedBy","lastModifiedDateTime"]}]}),headers:{Authorization:`Bearer ${i}`,"Content-Type":"application/json"},signal:r}).then(e=>e.json()).then(e=>0===e.value.length||0===e.value[0].hitsContainers.length||0===e.value[0].hitsContainers[0].total?[]:e.value[0].hitsContainers[0].hits.map(e=>e.resource))}({queryString:n||"*",extensions:["doc","docx","ppt","pptx","pdf","loop"],token:e,signal:r,ignoredFileIds:t,endpoint:a});o({status:1,queryString:n,results:s})}catch(e){"AbortError"!==e.name&&o({status:2,error:e})}})(),()=>{e.abort()}},[o,n,t,i,a]),r}({ignoredFileIds:d,queryString:i,endpoint:l.legacyPageContext.msGraphEndpointUrl}),f=De().useCallback(async(e,t)=>{if(u.status===Xn.Succeed){const e=u.results.find(e=>e.id===t);if(e){const{createdBy:t,createdDateTime:n,lastModifiedBy:i,lastModifiedDateTime:r}=e,o=e.name?.split(".").pop()||"",{fields:s}=e.listItem,{listId:c,listItemId:d,uniqueId:l,siteId:u,webId:f,driveId:p}=s;a({id:e.id,name:e.name||"",extension:o,type:tn.AttachmentType.File,sharepointIds:{driveId:p,listId:c,listItemId:d,listItemUniqueId:l,siteId:u,webId:f,webUrl:e.webUrl},createdBy:t,createdDateTime:n,lastModifiedBy:i,lastModifiedDateTime:r})}}},[u,a]);De().useEffect(()=>{u.status===Xn.Succeed?0===u.results.length?st.read(`${ea.yj} ${ea.nF}`,o.ReadingMode.ReadImmediately):st.read(ea.yj,o.ReadingMode.ReadImmediately):u.status===Xn.Querying&&st.read(ea.eX,o.ReadingMode.ReadImmediately)},[u]);const p=u.status===Xn.Succeed&&0===u.results.length;let m=null;return m=u.status===Xn.Succeed?De().createElement(ca,{items:u.results,handleItemSelected:f}):De().createElement(zt.Spinner,{className:t.spinner}),De().createElement("div",{role:"search",className:t.searchContainer},De().createElement("div",{className:t.referenceContainer},De().createElement("label",{className:t.referenceText},ea.xt),De().createElement(ta.SearchBox,{value:i,className:t.referenceSearchBox,input:{className:t.referenceSearchBoxPlaceholder},placeholder:ea.q$,onChange:s,"data-automation-id":"attachment-picker-search-box"})),De().createElement(Vt.Divider,{className:t.divider}),De().createElement("div",{className:t.suggestionContainer},De().createElement("label",{className:t.suggestionText},i?ea.HT:ea.EJ),De().createElement("div",{className:t.suggestionItemContainer},m)),p&&i&&De().createElement("div",{className:t.clearContainer},De().createElement(rt.Text,{className:t.text},ea.nF),De().createElement(jt.Button,{className:t.clearButton,onClick:c},ea.ki)))}function ca(e){const{items:t,handleItemSelected:n}=e,a=aa(),i=De().useCallback(e=>t=>{n&&"click"===t.type&&n(t,e)},[n]),r=De().useCallback(e=>t=>{n&&"Enter"===t.key&&n(t,e)},[n]);return De().createElement("div",{role:"listbox","aria-label":ea.HT},t.map((e,t)=>{const n=e.name||"",s=n.split(".").pop(),c=o.Icons.getIconUrl(s??""),d=At.format(ea.UF,e.lastModifiedBy?.user?.displayName,(0,$n.getFriendlyDateTimeStringPast)(new Date(e.lastModifiedDateTime||"")));return De().createElement(na.Option,{text:n,key:e.id,value:e.id,checkIcon:null,"data-automation-id":"attachment-picker-search-box-dropdown-option",onClick:i(e.id),onKeyDown:r(e.id),tabIndex:0},De().createElement("div",{className:a.attachment},De().createElement(Et.Image,{src:c,width:24,height:24,role:"presentation"}),De().createElement("div",{className:a.attachmentInfo},De().createElement("div",{className:a.attachmentName},n),De().createElement("div",{className:a.attachmentActivity},d))))}))}const da=(0,xe.makeStyles)({attachmentPicker:{padding:"0"},button:{border:"dashed 1px var(--colorBrandForeground1)",":hover":{border:"dashed 1px var(--colorBrandForeground1)"},":focus":{border:"dashed 1px var(--colorBrandForeground1)"},":active":{border:"dashed 1px var(--colorBrandForeground1)"}},buttonDisabled:{border:"dashed 1px var(--colorNeutralForegroundDisabled)",":hover":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":focus":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"},":active":{border:"dashed 1px var(--colorNeutralForegroundDisabled)"}},buttonLarge:{paddingLeft:"6px",paddingRight:"12px"},buttonExtraLarge:{paddingLeft:"12px",paddingRight:"17px"},icon:{color:"var(--colorBrandForeground1)",":hover":{color:"var(--colorBrandForeground1)"},":focus":{color:"var(--colorBrandForeground1)"},":active":{color:"var(--colorBrandForeground1)"}},iconDisabled:{color:"var(--colorNeutralForegroundDisabled)",":hover":{color:"var(--colorNeutralForegroundDisabled)"},":focus":{color:"var(--colorNeutralForegroundDisabled)"},":active":{color:"var(--colorNeutralForegroundDisabled)"}},popoverSurface:{padding:0}});function la(e){const{size:t="large",disabled:n,disabledMessage:a,label:i,selectedAttachments:r,onAttachmentSelect:o}=e,[s,c]=De().useState(!1),d=De().useCallback((e,t)=>{c(t.open)},[c]),l=De().useCallback(e=>{o(e),c(!1)},[o,c]),u=da(),f="large"===t?20:24,p=De().createElement(jt.Button,{shape:"circular",appearance:"transparent",icon:De().createElement(Wt,{className:n?u.iconDisabled:u.icon,width:f,height:f}),size:"large","data-automation-id":"attachment-picker-button",disabled:n,className:(0,xe.mergeClasses)(n?u.buttonDisabled:u.button,"large"===t?u.buttonLarge:u.buttonExtraLarge)},i);return De().createElement(Zn.Popover,{open:s,onOpenChange:d,positioning:"below-start",trapFocus:!0},De().createElement(Zn.PopoverTrigger,{disableButtonEnhancement:!0},n?De().createElement(Bn.Tooltip,{content:a??"",relationship:"description",withArrow:!0},p):p),De().createElement(Zn.PopoverSurface,{className:u.popoverSurface},De().createElement(sa,{onSelect:l,selectedAttachments:r})))}function ua(e){const{size:t="large",decoration:n="none",attachments:a,onAttachmentSelect:i,onAttachmentRemove:r}=e,s=Se.useCallback((e,t)=>{const n=a.find(e=>e.id===t.value);n&&r(n)},[a,r]),c=Jn(),d=(0,xe.useFocusableGroup)(),l="large"===t?20:24,u=Se.useMemo(()=>a.filter(e=>e.type===tn.AttachmentType.File),[a]);return Se.createElement(Qn.TagGroup,{className:c.tagGroup,onDismiss:s,"aria-label":Yn.qs,role:"group"},u.map(e=>Se.createElement(Qn.InteractionTag,{"data-automation-id":"attachments-list-tag",shape:"circular",appearance:"outline",key:e.id,value:e.id,"data-size":t,className:(0,xe.mergeClasses)(c.attachmentTag,"large"===t?c.attachmentTagLarge:c.attachmentTagExtraLarge),...d,tabIndex:0,as:"div"},Se.createElement(Qn.InteractionTagPrimary,{"data-size":t,hasSecondaryAction:!0,media:Se.createElement(Et.Image,{src:o.Icons.getIconUrl(e.extension),height:l,width:l,role:"presentation"}),className:(0,xe.mergeClasses)(c.attachmentTagPrimary,"none"===n?c.attachmentTagPrimaryBorderless:"","large"===t?c.attachmentTagPrimaryLarge:c.attachmentTagPrimaryExtraLarge),primaryText:{className:(0,xe.mergeClasses)(c.attachmentTagPrimaryText,"large"===t?c.attachmentTagPrimaryTextLarge:c.attachmentTagPrimaryTextExtraLarge)}},Se.createElement(Bn.Tooltip,{content:e.name,relationship:"label"},Se.createElement("span",{className:c.attachmentName},e.name)),Se.createElement(tn.SensitivityLabel,{size:t,sensitivityLabel:e.sensitiveLabel})),Se.createElement(Qn.InteractionTagSecondary,{"data-automation-id":"attachments-list-tag-remove-btn","aria-label":Yn.T0,className:(0,xe.mergeClasses)(c.attachmentTagSecondary,"none"===n?c.attachmentTagSecondaryBorderless:"","large"===t?c.attachmentTagSecondaryLarge:c.attachmentTagSecondaryExtraLarge)}))),Se.createElement(ra,{serviceScope:e.serviceScope,pageContext:e.serviceScope.consume(wn.PageContext.serviceKey)},Se.createElement(la,{size:t,disabled:a.length>=5,disabledMessage:S.Text.format(Yn.c6,5),label:0===a.length?Yn.Dc:Yn.aW,selectedAttachments:a,onAttachmentSelect:i})))}const fa=(0,xe.__styles)({root:{mc9l5x:"fjseox"},visible:{mc9l5x:"f1w7gpdv"}},{d:[".fjseox{display:none;}",".f1w7gpdv{display:inline;}"]}),pa=(e,t)=>{const n=n=>{const{className:a,filled:i,...r}=n,o=fa();return Se.createElement(Se.Fragment,null,Se.createElement(e,Object.assign({},r,{className:(0,xe.mergeClasses)(o.root,i&&o.visible,"fui-Icon-filled",a)})),Se.createElement(t,Object.assign({},r,{className:(0,xe.mergeClasses)(o.root,!i&&o.visible,"fui-Icon-regular",a)})))};return n.displayName="CompoundIcon",n},ma=tt("SparkleFilled","1em",["M7.4 12.8a1.04 1.04 0 0 0 1.59-.51l.45-1.37a2.34 2.34 0 0 1 1.47-1.48l1.4-.45A1.04 1.04 0 0 0 12.25 7l-1.37-.45A2.34 2.34 0 0 1 9.4 5.08L8.95 3.7a1.03 1.03 0 0 0-.82-.68 1.04 1.04 0 0 0-1.15.7l-.46 1.4a2.34 2.34 0 0 1-1.44 1.45L3.7 7a1.04 1.04 0 0 0 .02 1.97l1.37.45a2.33 2.33 0 0 1 1.48 1.48l.46 1.4c.07.2.2.37.38.5Zm6.14 4.05a.8.8 0 0 0 1.22-.4l.25-.76a1.09 1.09 0 0 1 .68-.68l.77-.25a.8.8 0 0 0-.02-1.52l-.77-.25a1.08 1.08 0 0 1-.68-.68l-.25-.77a.8.8 0 0 0-1.52.01l-.24.76a1.1 1.1 0 0 1-.67.68l-.77.25a.8.8 0 0 0 0 1.52l.77.25a1.09 1.09 0 0 1 .68.68l.25.77c.06.16.16.3.3.4Z"]),_a=tt("SparkleRegular","1em",["M7.4 12.8a1.04 1.04 0 0 0 1.59-.51l.45-1.37a2.34 2.34 0 0 1 1.47-1.48l1.4-.45A1.04 1.04 0 0 0 12.25 7l-1.37-.45A2.34 2.34 0 0 1 9.4 5.08L8.95 3.7a1.03 1.03 0 0 0-.82-.68 1.04 1.04 0 0 0-1.15.7l-.46 1.4a2.34 2.34 0 0 1-1.44 1.45L3.7 7a1.04 1.04 0 0 0 .02 1.97l1.37.45a2.33 2.33 0 0 1 1.48 1.48l.46 1.4c.07.2.2.37.38.5Zm.08-7.4.53-1.38.44 1.37a3.33 3.33 0 0 0 2.12 2.12l1.4.53-1.38.45a3.34 3.34 0 0 0-2.11 2.11l-.53 1.38-.45-1.38a3.34 3.34 0 0 0-2.1-2.12L4 7.96 5.4 7.5a3.36 3.36 0 0 0 2.08-2.12Zm6.06 11.45a.8.8 0 0 0 1.22-.4l.25-.76a1.09 1.09 0 0 1 .68-.68l.77-.25a.8.8 0 0 0-.02-1.52l-.77-.25a1.08 1.08 0 0 1-.68-.68l-.25-.77a.8.8 0 0 0-1.52.01l-.24.76a1.1 1.1 0 0 1-.67.68l-.77.25a.8.8 0 0 0 0 1.52l.77.25a1.09 1.09 0 0 1 .68.68l.25.77c.06.16.16.3.3.4Zm-.92-2.8-.18-.05.19-.06a2.09 2.09 0 0 0 1.3-1.32l.06-.18.05.18a2.08 2.08 0 0 0 1.32 1.32l.2.06-.18.06a2.08 2.08 0 0 0-1.32 1.32l-.06.18-.06-.18a2.07 2.07 0 0 0-1.32-1.32Z"]),ha=JSON.parse('{"py":"Creation Mode","nH":"Allow rewording content","Hl":"Suitable for most pages","hq":"Use exact content","uU":"Creates using your source\\u0027s exact words","Rp":"Support only one Word, Loop, or PDF file","nQ":"Create using your exact words","au":"Have Copilot create a page using the exact words in your source document by choosing \\u0022{0}\\u0022.","Ml":"Got it","ad":"Change source file to single Word, Loop, or PDF file to switch creation mode"}'),ba="FIDELITY_MENU_FRE_LOCAL_STORAGE_KEY",ga=pa(ma,_a),va=pa(mn,_n),ya=(0,xe.makeStyles)({menuButton:{minWidth:"unset",padding:"6px"},icon:{margin:0},selected:{color:xe.tokens.colorBrandForeground1},claim:{color:xe.tokens.colorBrandForeground1}});function Sa(e){const t=Se.useRef(null),n=ya();!function(e,t,n){const a=ut();Se.useEffect(()=>{t&&e&&!n&&t.whenFinished(()=>{const n=t.consume(ct.CoachmarkUtility.serviceKey);n.attachTeachingBubble({targetElement:e,content:S.Text.format(ha.au,ha.hq),headline:ha.nQ,localStorageKey:ba,hasCloseButton:!0,styles:{primaryButton:{borderRadius:xe.tokens.borderRadiusMedium},root:{width:"320px"},bodyContent:{padding:xe.tokens.spacingVerticalL},headline:{fontSize:xe.tokens.fontSizeBase400,lineHeight:xe.tokens.lineHeightBase400}},calloutProps:{id:ba,directionalHint:ze.DirectionalHint.bottomCenter,dismissOnTargetClick:!0,setInitialFocus:!0,gapSpace:10},primaryButtonProps:{text:ha.Ml,ariaLabel:ha.Ml,onClick:()=>{n.dismiss(ba),a?.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Close",stage:"Trigger"})}},onDidMount:()=>{a?.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Mount",stage:"Trigger"})},onBeforeDismiss:e=>{a?.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Dismiss",stage:"Trigger"})}}).catch(e=>ot._TraceLogger.logError(ot._LogSource.create("FidelityMenuFRE"),e,"FidelityMenuFRERenderFailed"))})},[n])}(t.current||void 0,e.serviceScope,e.disable);const a=void 0===e.selectedFidelity||e.disable?Se.createElement(ga,null):"Usual"===e.selectedFidelity?Se.createElement(ma,{className:n.selected}):Se.createElement(mn,{className:n.selected}),i=e.disable?ha.ad:void 0===e.selectedFidelity?ha.py:"Usual"===e.selectedFidelity?ha.nH:ha.hq;return Se.createElement(Bt.Menu,{onCheckedValueChange:(t,n)=>{const a=n.checkedItems[0];e.onCheckedValueChange?.(a)},checkedValues:e.selectedFidelity?{[ha.py]:[e.selectedFidelity]}:void 0},Se.createElement(Bt.MenuTrigger,{disableButtonEnhancement:!0},Se.createElement(Bn.Tooltip,{content:i,relationship:"label",withArrow:!0},Se.createElement(jt.MenuButton,{className:n.menuButton,ref:t,appearance:"transparent",size:"medium",icon:a,disabled:e.disable}))),Se.createElement(Bt.MenuPopover,null,Se.createElement(Bt.MenuList,null,Se.createElement(Bt.MenuItemRadio,{icon:Se.createElement(ga,null),name:ha.py,value:"Usual",subText:ha.Hl},ha.nH),Se.createElement(Bt.MenuItemRadio,{icon:Se.createElement(va,null),name:ha.py,value:"High",subText:Se.createElement(Se.Fragment,null,ha.uU,Se.createElement("div",{className:n.claim},Se.createElement("i",null,ha.Rp)))},ha.hq))))}var Da=ce(3117),Ia=ce(4830);const xa=tt("Info12Regular","12",["M5.5 6.5a.5.5 0 0 1 1 0V8a.5.5 0 0 1-1 0V6.5ZM6 3.75a.75.75 0 1 0 0 1.5.75.75 0 0 0 0-1.5ZM1 6a5 5 0 1 1 10 0A5 5 0 0 1 1 6Zm5-4a4 4 0 1 0 0 8 4 4 0 0 0 0-8Z"]),Ca=JSON.parse('{"hb":"Create as a private draft","$V":"This draft will be visible only to you and the people you share it with.","Y2":"Learn more"}'),Oa=(0,xe.makeStyles)({container:{display:"inline-flex"},iconButton:{marginLeft:"-5px"},popoverContent:{maxWidth:"220px"}}),wa=(0,Se.forwardRef)((e,t)=>{const n=De().useRef(null),a=Oa();return De().useImperativeHandle(t,()=>({get checked(){return n.current?.checked??!1}})),De().createElement("div",{className:a.container},De().createElement(Da.Checkbox,{label:Ca.hb,ref:n,defaultChecked:!0}),De().createElement(Zn.Popover,{withArrow:!0},De().createElement(Zn.PopoverTrigger,{disableButtonEnhancement:!0},De().createElement(jt.Button,{icon:De().createElement(xa,null),appearance:"transparent",className:a.iconButton})),De().createElement(Zn.PopoverSurface,null,De().createElement("div",{className:a.popoverContent},De().createElement("div",null,Ca.$V),De().createElement(Ia.Link,{href:"https://go.microsoft.com/fwlink/?linkid=2166615",target:"_blank"},Ca.Y2)))))}),Ea=(0,xe.makeStyles)({editor:{padding:"0",whiteSpace:"pre",wordBreak:"break-word",textWrap:"wrap",outline:"none",fontFamily:xe.typographyStyles.body2.fontFamily,fontSize:xe.typographyStyles.body2.fontSize,lineHeight:xe.typographyStyles.body2.lineHeight},token:{color:"var(--colorNeutralForeground3)"}}),Aa=JSON.parse('{"l":"Enter a topic and other info for your page"}'),La="free-prompt-editor-token";function ka(e){const{prompt:t,onPromptStringChange:n}=e,a=Ea(),i=Se.useRef(null);Se.useEffect(()=>{if(i.current){const e=i.current;e.innerHTML="";const n=t.template.split(/{\d+}/),r=new DocumentFragment;n.map((e,n)=>{const i=document.createElement("span");i.setAttribute("data-template-piece-index",n.toString()),i.textContent=e,r.appendChild(i);const o=t.tokens[n];if(o){const e=document.createElement("span");e.className=`${La} ${a.token}`,e.setAttribute("data-automation-id",(e=>`free-prompt-editor-token-${e}`)(n)),e.setAttribute("data-token-index",n.toString()),e.setAttribute("contenteditable","false"),o.placeholder&&(e.textContent=o.placeholder),r.appendChild(e)}}),e.appendChild(r);const o=document.createRange(),s=window.getSelection();o.setStart(e,1),o.collapse(!0),s?.removeAllRanges(),s?.addRange(o)}},[t,a.token]);const r=Se.useCallback(()=>{if(!i.current)return;const e=i.current,t=e.querySelector('[data-token-index="0"]');t&&e.removeChild(t);const a=e.innerText;n(a)},[n]),o=Se.useCallback(e=>{if(("ArrowLeft"===e.key||"ArrowRight"===e.key||"ArrowUp"===e.key||"ArrowDown"===e.key)&&i.current){const e=i.current;e.querySelectorAll(`.${La}`).forEach(t=>{e.removeChild(t)});const t=e.innerText;n(t)}},[n]),s=Se.useCallback(e=>{if(i.current){const e=i.current;e.querySelectorAll(`.${La}`).forEach(t=>{e.removeChild(t)});const t=e.innerText;n(t)}},[n]),c=Se.useCallback(e=>{e.preventDefault();const t=e.clipboardData.getData("text/plain"),n=window.getSelection();if(!n||0===n.rangeCount)return;const a=n.getRangeAt(0);a.deleteContents();const i=document.createTextNode(t);a.insertNode(i),r()},[r]),d=!!e.disabled;return Se.createElement("div",{ref:i,contentEditable:!d,role:"textbox",tabIndex:d?-1:0,"aria-disabled":d,"data-automation-id":"free-prompt-editor",className:(0,xe.mergeClasses)(a.editor,e.className),"aria-label":Aa.l,onKeyUp:d?void 0:o,onInput:d?void 0:r,onClick:d?void 0:s,onPaste:d||S._SPKillSwitch.isActivated("25f2e78e-a32c-4346-b883-d347a80ee2c1")?void 0:c})}const Ma=JSON.parse('{"SV":"View prompts","E4":"Refresh","zv":"Prompt examples"}'),Pa=(0,xe.makeStyles)({viewPromptsButton:{color:xe.tokens.colorBrandBackground,padding:xe.tokens.spacingVerticalXS,":hover":{color:xe.tokens.colorBrandBackgroundHover},":active":{color:xe.tokens.colorBrandBackgroundPressed}}}),Ta=pa(Yt,Jt);function Ua(e){const{suggestions:t,onSuggestionSelected:n,onRefreshSuggestions:a}=e,[i,r]=Se.useState(!1),s=Pa();return Se.createElement(Bt.Menu,{open:i,onOpenChange:(t,n)=>{r(n.open),e.onSuggestionMenuOpenChanged?.(n.open)}},Se.createElement(Bt.MenuTrigger,null,Pn()?Se.createElement(Bn.Tooltip,{content:Ma.zv,relationship:"label"},Se.createElement(jt.MenuButton,{icon:Se.createElement(Ta,null),"data-automation-id":Ae,appearance:"transparent"})):Se.createElement(jt.Button,{icon:Se.createElement(Jt,null),"data-automation-id":Ae,className:s.viewPromptsButton,appearance:"transparent"},Ma.SV)),Se.createElement(Bt.MenuPopover,null,Se.createElement(Bt.MenuList,null,Se.createElement(Bt.MenuGroup,null,t.map((e,t)=>Se.createElement(Bt.MenuItem,{"data-automation-id":Le(t),persistOnClick:!0,onClick:()=>{n(e)},key:t},Se.createElement(o.RichTextFormatter,{template:e.template,values:e.tokens.map((e,t)=>Se.createElement("span",{key:t},e.placeholder))})))),Se.createElement(Bt.MenuDivider,null),Se.createElement(Bt.MenuGroup,null,Se.createElement(Bt.MenuItem,{"data-automation-id":ke,persistOnClick:!0,icon:Se.createElement(qt,null),onClick:a},Ma.E4)))))}const Fa=JSON.parse('{"B_":"What\\u0027s your page about?","J0":"What\\u0027s your news post about?","q$":"Start from a template","p4":"Create a page about {0}","rV":"Create a news post about {0}","o_":"topic","SV":"View prompts","nf":"Create","E4":"Refresh","as":"Create a page based on document.","X":"Create a news post based on document.","Ut":"Create a {0} based on {1}.","VY":"page","QM":"news post","ik":"document","R6":"meeting","Jw":"Create a team page for {0}, featuring sections on {1}, {2}, {3}, and {4}.","dg":"team name","vB":"team overview","Bm":"current projects","IH":"team members","EJ":"shared documents","A0":"Create a resources page for {0}, featuring sections on {1}, {2}, {3}, and {4}.","M9":"department/project","TS":"policy documents","Xm":"templates","zs":"guidelines","st":"reference materials","oY":"Draft an onboarding page for new employees, featuring sections on {0}, {1}, {2}, and {3}.","Zr":"welcome message","WS":"company culture","oT":"orientation schedule","_S":"key contacts","dL":"Create a training page for {0}, featuring sections on {1}, {2}, {3}, and {4}.","dX":"training topic","zg":"course description","Td":"training materials","W6":"assessment","uL":"instructor information","G6":"Make a knowledge base page for {0}, featuring sections on {1}, {2}, {3}, and {4}.","e$":"topic","dq":"frequently asked questions","ji":"how-to guides","rZ":"troubleshooting tips","Yo":"support contacts","_0":"Create a department homepage for {0}, featuring sections on {1}, {2}, {3}, and {4}.","bx":"department name","I3":"mission statement","D3":"team members","Dr":"ongoing initiatives","JW":"contact information","sy":"Generate a policies page for {0}, featuring sections on {1}, {2}, {3}, and {4}.","CB":"policy topic","AN":"policy overview","nG":"detailed procedures","A_":"compliance requirements","pp":"FAQs","vW":"Create a news post from the file. Using exactly the same structure and section names, respecting the original content without changing the words."}'),Ha=[{template:Fa.Jw,tokens:[{type:r.Field,text:"",placeholder:Fa.dg},{type:r.Field,text:"",placeholder:Fa.vB},{type:r.Field,text:"",placeholder:Fa.Bm},{type:r.Field,text:"",placeholder:Fa.IH},{type:r.Field,text:"",placeholder:Fa.EJ}]},{template:Fa.A0,tokens:[{type:r.Field,text:"",placeholder:Fa.M9},{type:r.Field,text:"",placeholder:Fa.TS},{type:r.Field,text:"",placeholder:Fa.Xm},{type:r.Field,text:"",placeholder:Fa.zs},{type:r.Field,text:"",placeholder:Fa.st}]},{template:Fa.oY,tokens:[{type:r.Field,text:"",placeholder:Fa.Zr},{type:r.Field,text:"",placeholder:Fa.WS},{type:r.Field,text:"",placeholder:Fa.oT},{type:r.Field,text:"",placeholder:Fa._S}]},{template:Fa.dL,tokens:[{type:r.Field,text:"",placeholder:Fa.dX},{type:r.Field,text:"",placeholder:Fa.zg},{type:r.Field,text:"",placeholder:Fa.Td},{type:r.Field,text:"",placeholder:Fa.W6},{type:r.Field,text:"",placeholder:Fa.uL}]},{template:Fa.G6,tokens:[{type:r.Field,text:"",placeholder:Fa.e$},{type:r.Field,text:"",placeholder:Fa.dq},{type:r.Field,text:"",placeholder:Fa.ji},{type:r.Field,text:"",placeholder:Fa.rZ},{type:r.Field,text:"",placeholder:Fa.Yo}]},{template:Fa._0,tokens:[{type:r.Field,text:"",placeholder:Fa.bx},{type:r.Field,text:"",placeholder:Fa.I3},{type:r.Field,text:"",placeholder:Fa.D3},{type:r.Field,text:"",placeholder:Fa.Dr},{type:r.Field,text:"",placeholder:Fa.JW}]},{template:Fa.sy,tokens:[{type:r.Field,text:"",placeholder:Fa.CB},{type:r.Field,text:"",placeholder:Fa.AN},{type:r.Field,text:"",placeholder:Fa.nG},{type:r.Field,text:"",placeholder:Fa.A_},{type:r.Field,text:"",placeholder:Fa.pp}]},{template:Fa.vW,tokens:[]}];function Ra(e,t){return e.sort(()=>Math.random()-.5).slice(0,t)}function Na(e){const[t,n]=Se.useState(Ra(Ha,3));return Se.createElement(Ua,{suggestions:t,onSuggestionSelected:e.onSuggestionSelected,onRefreshSuggestions:()=>{n(Ra(Ha,3)),e.onRefreshSuggestions?.()},onSuggestionMenuOpenChanged:e.onSuggestionMenuOpenChanged})}var Ba;!function(e){e[e.TemplateGallery=0]="TemplateGallery",e[e.FreePrompt=1]="FreePrompt",e[e.CustomizePrompt=2]="CustomizePrompt",e[e.PageBuilder=3]="PageBuilder"}(Ba||(Ba={}));const ja=(0,xe.makeStyles)({container:{boxSizing:"border-box",display:"flex",flexDirection:"column",padding:"0 var(--dialogHorizontalPadding) 0 var(--dialogHorizontalPadding)",minHeight:"718px"},tabListContainer:{position:"absolute",top:"16px",left:"0",right:"0",margin:"0 80px",zIndex:2,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},tabPane:{flex:1,display:"flex",flexDirection:"column",justifyContent:"flex-start",margin:"0 auto",padding:"160px 0 var(--spacingVerticalXXXL) 0",width:"100%",maxWidth:"750px"},header:{display:"flex",flexDirection:"row",alignItems:"center"},title:{marginLeft:"var(--spacingHorizontalL)"},editor:{padding:"var(--spacingVerticalL) var(--spacingHorizontalL)",margin:"var(--spacingVerticalXXXL) 0 var(--spacingVerticalXXL) 0",backgroundColor:"var(--colorNeutralBackground1)",borderRadius:"var(--spacingVerticalL) var(--spacingHorizontalL)"},editorBoxShadowLight:{boxShadow:"0px 32px 64px 0px rgba(160, 132, 236, 0.24), 0px 0px 8px 0px #D9E0FD"},editorBoxShadowDark:{boxShadow:"0px 32px 64px 0px rgba(0, 0, 0, 0.24), 0px 0px 8px 0px rgba(0, 0, 0, 0.2)"},editorContainer:{minHeight:"var(--lineHeightBase300)",maxHeight:"calc(4 * var(--lineHeightBase300))",overflow:"auto"},editorFooter:{display:"flex",flexDirection:"row",alignItems:"flex-end",marginTop:"var(--spacingVerticalXL)",[yt]:{flexDirection:"row",alignItems:"flex-end"},[St]:{flexDirection:"column",alignItems:"flex-start"}},attachments:{flex:1,minWidth:"0"},editorActions:{display:"flex",flexDirection:"row",alignItems:"center",height:"40px",[St]:{width:"100%",justifyContent:"flex-end"}},footer:{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"center",marginTop:"var(--spacingVerticalXXXL)",paddingBottom:"var(--spacingVerticalXXL)"},divider:{margin:"0 var(--spacingHorizontalM)",[St]:{flexGrow:0}},settingsContainer:{display:"flex",justifyContent:"space-between"},adjustActions:{[St]:{display:"flex"}},viewPromptsButton:{color:"var(--colorBrandBackground)",padding:"var(--spacingVerticalXS)",":hover":{color:"var(--colorBrandBackgroundHover)"},":active":{color:"var(--colorBrandBackgroundPressed)"}}}),Va={template:Fa.p4,tokens:[{type:r.Field,text:"",placeholder:Fa.o_}]},za={template:Fa.rV,tokens:[{type:r.Field,text:"",placeholder:Fa.o_}]},Ga={template:Fa.as,tokens:[]},Ka={template:Fa.X,tokens:[]};function Wa(e,t){return{template:Fa.Ut.replace(/\{(\d+)\}/,e===_.Page?Fa.VY:Fa.QM).replace(/\{(\d+)\}/,t===tn.AttachmentType.Meeting?Fa.R6:Fa.ik),tokens:[]}}function qa(e,t){return e.sort(()=>Math.random()-.5).slice(0,t)}function Qa(e){const{selectedTemplate:t,siteSensitiveLabel:n,onGoBack:a,onCreatePage:i,serviceScope:r,defaultPromptText:o,defaultTemplateCategory:s}=e,c=(0,Se.useRef)(!!S._SPKillSwitch.isActivated("e0dcfe9b-abe6-446d-9dfd-ee03f96bad66")||!o),[d,l]=(0,Se.useState)(()=>!x()&&o?{template:o,tokens:[]}:za),[u,f]=(0,Se.useState)(()=>!x()&&o?o:""),p=De().useRef({checked:!1}),m=ut(),h=ja(),b=(0,ze.useCustomizationSettings)(["theme"]).theme.isInverted,[g,v]=(0,Se.useState)(()=>x()||void 0===s?_.NewsPost:s),y=(0,Se.useCallback)(e=>{v(e),e===_.Page?l(Va):l(za),f(""),c.current=!0,m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Category.Select",stage:"Trigger",payload:{category:e}})},[v,l,m]),D=(0,Se.useCallback)(()=>{a(Ba.FreePrompt,t)},[t,a]),{attachments:I,addAttachment:C,removeAttachment:O,checkSensitivity:w}=Dn(),E=(0,Se.useCallback)(e=>{O(e),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Remove",stage:"Trigger"})},[O,m]),A=(0,Se.useCallback)(e=>{C(e),c.current&&(g===_.Page?(l({...Ga}),f(Ga.template)):(l({...Ka}),f(Ka.template)),c.current=!1),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Select",stage:"Trigger"})},[g,C,l,m]),{internalAttachments:L,removeAttachment:k,addAttachment:M,checkSensitivity:P}=(0,tn.useAttachments)({serviceScope:r,multiSelection:!0,defaultAttachments:[]}),T=(0,Se.useCallback)(e=>{k(e),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Remove",stage:"Trigger"})},[k,m]),U=(0,Se.useCallback)(e=>{if(M(e),c.current){const t=Wa(g,e.type);l({...t}),f(t.template),c.current=!1}m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Select",stage:"Trigger"})},[g,l,m,M]),[F,H]=(0,Se.useState)(_e.Professional),[R,N]=(0,Se.useState)(he.Medium),[B,j]=(0,Se.useState)(void 0),[V,z]=(0,Se.useState)(()=>qa(Ha,3)),[G,K]=(0,Se.useState)(!1),W=De().useCallback(e=>{m.log({id:S.Guid.newGuid().toString(),operation:e?"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Open":"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Close",stage:"Trigger"})},[m]),q=De().useCallback((e,t)=>{K(t.open),W(t.open)},[K,W]),Q=De().useCallback(e=>{const t=S.Text.format(e.template,...e.tokens.map(e=>e.placeholder));l({template:t,tokens:[]}),f(t),c.current=!1,K(!1),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Select",stage:"Trigger"})},[l,K,m]),Y=De().useCallback(()=>{m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Refresh",stage:"Trigger"})},[m]),J=De().useCallback(()=>{z(qa(Ha,3)),Y()},[z,Y]),X=De().useCallback(e=>{f(e),c.current=0===e.trim().length,m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.PromptEditor.Edit",stage:"Trigger"})},[f,m]),Z=Cn(En()?L:I),[$,ee]=(0,Se.useState)(!1);let te={isSensitiveBarVisible:!1,isHighlySensitiveBarVisible:!1,highestLevelLabelFileCount:1};n&&(te=En()?P():w(n));const ne=En()?L.some(e=>!e.sensitiveLabel):I.some(e=>!e.sensitiveLabel);return De().createElement("div",{className:h.container,"data-automation-id":"create-page-with-copilot-free-prompt-step"},De().createElement("div",{className:h.tabListContainer},De().createElement(ht,{selectedCategory:g,onCategoryTabSelect:y})),De().createElement("div",{className:h.tabPane,role:"tabpanel","aria-labelledby":Me(g)},De().createElement("div",{className:h.header},De().createElement(rt.Subtitle1,{className:h.title,role:"heading","aria-level":1},g===_.Page?Fa.B_:Fa.J0)),De().createElement("div",{className:(0,xe.mergeClasses)(h.editor,b?h.editorBoxShadowDark:h.editorBoxShadowLight)},De().createElement("div",{className:h.editorContainer},De().createElement(ka,{prompt:d,onPromptStringChange:X})),De().createElement("div",{className:h.editorFooter},En()?De().createElement("div",{className:h.attachments},De().createElement(tn.Attachments,{serviceScope:r,attachments:L,size:"large",decoration:"border",onAttachmentSelect:U,onAttachmentRemove:T,displayTabs:[tn.AttachmentPickerTabs.All,tn.AttachmentPickerTabs.Files,tn.AttachmentPickerTabs.Meetings,...Tn()?[tn.AttachmentPickerTabs.Sites]:[]]})):De().createElement("div",{className:h.attachments},De().createElement(ua,{serviceScope:r,size:"large",decoration:"border",attachments:I,onAttachmentSelect:A,onAttachmentRemove:E})),De().createElement("div",{className:h.editorActions},Pn()?De().createElement(De().Fragment,null,De().createElement(Sa,{selectedFidelity:B,onCheckedValueChange:e=>{j(e)},serviceScope:r,disable:!Z}),De().createElement(Na,{onSuggestionSelected:Q,onRefreshSuggestions:Y,onSuggestionMenuOpenChanged:W})):De().createElement(Bt.Menu,{open:G,onOpenChange:q},De().createElement(Bt.MenuTrigger,null,De().createElement(jt.Button,{icon:De().createElement(Gt,null),"data-automation-id":Ae,className:h.viewPromptsButton,appearance:"transparent"},Fa.SV)),De().createElement(Bt.MenuPopover,null,De().createElement(Bt.MenuList,null,De().createElement(Bt.MenuGroup,null,V.map((e,t)=>{const n=t;return De().createElement(Ya,{key:n,index:t,suggestion:e,onSelect:Q})})),De().createElement(Bt.MenuDivider,null),De().createElement(Bt.MenuGroup,null,De().createElement(Bt.MenuItem,{"data-automation-id":ke,persistOnClick:!0,icon:De().createElement(qt,null),onClick:J},Fa.E4))))),De().createElement(Vt.Divider,{className:h.divider,vertical:!0}),De().createElement(jt.Button,{appearance:$?"subtle":"primary",shape:"circular",size:"small",icon:$?De().createElement(zt.Spinner,{size:"tiny"}):De().createElement($t,null),"data-automation-id":"create-page-with-copilot-free-prompt-create-page-btn","aria-label":Fa.nf,onClick:async()=>{if(!u)return;ee(!0);const e=En()?L:I;m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.FreePrompt.Create.Click",stage:"Trigger",payload:{tone:F,fidelity:B||"Usual",length:R,hasOutline:!1,pageTemplateCategory:g,isPrivateAuthoring:p.current?.checked||!1,attachments:e}}),await i(g,void 0,{template:u,tokens:[]},F,R,void 0,Pn()&&Z?B:void 0,e,p.current?.checked||!1)||ee(!1)},disabled:$||c.current&&0===I.length||te?.isHighlySensitiveBarVisible||ne}))),(te.isSensitiveBarVisible||te.isHighlySensitiveBarVisible)&&De().createElement(vn,{isContainHighlyConfidential:te?.isHighlySensitiveBarVisible,highestLevelLabelFileCount:te?.highestLevelLabelFileCount})),De().createElement("div",{className:kn(r)?h.settingsContainer:void 0},De().createElement("div",{className:h.adjustActions},De().createElement(qn,{tone:F,onToneChange:H}),De().createElement(Gn,{length:R,onLengthChange:N})),kn(r)&&De().createElement(wa,{ref:p}))),De().createElement("div",{className:h.footer},De().createElement(jt.Button,{"data-automation-id":Ee,icon:De().createElement(Qt,null),appearance:"subtle",onClick:D},Fa.q$)))}function Ya(e){const{index:t,suggestion:n,onSelect:a}=e,i=(0,Se.useCallback)(()=>{a(n)},[a,n]);return De().createElement(Bt.MenuItem,{"data-automation-id":Le(t),persistOnClick:!0,onClick:i},De().createElement(o.RichTextFormatter,{template:n.template,values:n.tokens.map((e,t)=>De().createElement("span",{key:t},e.placeholder))}))}const Ja=(0,xe.makeStyles)({editor:{display:"flex",flexDirection:"row",alignItems:"self-start",flexWrap:"wrap",columnGap:"var(--spacingHorizontalS)"}}),Xa="var(--fontSizeBase500)",Za="36px",$a=(0,xe.makeStyles)({textToken:{fontSize:Xa,lineHeight:Za},fieldToken:{position:"relative",maxWidth:"100%",fontSize:Xa,lineHeight:Za},fieldTokenCombobox:{position:"absolute",top:0,left:0,width:"100%",minWidth:"unset",padding:"0",border:"none",borderRadius:"var(--borderRadiusXLarge)",columnGap:0},fieldTokenComboboxInput:{boxSizing:"border-box",fontSize:Xa,lineHeight:Za,width:"100%",padding:"0 calc(var(--spacingHorizontalMNudge) + var(--spacingHorizontalXXS))",borderRadius:"var(--borderRadiusXLarge)",":not(:focus-within)":{border:"none",backgroundColor:"var(--colorBrandBackgroundInvertedSelected)",color:"var(--colorBrandForeground2)"},":not(:focus-within):hover":{border:"none",backgroundColor:"var(--colorBrandBackgroundInvertedPressed)",color:"var(--colorBrandForeground2)"},":not(:focus-within)::placeholder":{color:"var(--colorBrandForeground2)"},":focus-within::placeholder":{color:"var(--colorNeutralForeground3)"}},fieldTokenComboboxOption:{padding:"var(--spacingVerticalS) var(--spacingHorizontalS)"},fieldTokenText:{boxSizing:"border-box",display:"inline-block",padding:"0 var(--spacingHorizontalM)",borderLeft:"2px solid transparent",borderRight:"2px solid transparent",minHeight:"32px",fontFamily:"var(--fontFamilyBase)",fontSize:Xa,fontWeight:"var(--fontWeightRegular)",lineHeight:Za,opacity:0,whiteSpace:"nowrap",maxWidth:"100%",overflow:"hidden",textOverflow:"ellipsis"}}),ei=JSON.parse('{"K":"Suggested"}');function ti(e){const{index:t,token:n,onTokenChange:a,renderTokenOptions:i}=e;switch(n.type){case r.Text:return De().createElement(ni,{index:t,token:n});case r.Field:return De().createElement(ai,{index:t,token:n,onChange:a});case r.Config:return De().createElement(ii,{index:t,token:n,renderOptions:i})}}function ni(e){const{index:t,token:n}=e,a=$a();return De().createElement("span",{"data-automation-id":Pe(t),className:a.textToken},n.text)}function ai(e){const{index:t,token:n,onChange:a}=e,i=$a(),r=(0,Se.useCallback)(e=>{const i=e.target.value||"";a({index:t,token:{...n,text:i}})},[n,t,a]),o=(0,Se.useCallback)((e,i)=>{"keydown"===e.type&&"Tab"===e.code||a({index:t,token:{...n,text:i.optionValue||""}})},[n,t,a]);return De().createElement("span",{className:i.fieldToken,"data-automation-id":Te(t)},De().createElement("span",{className:i.fieldTokenText,"aria-hidden":"true"},n.text||n.placeholder),De().createElement(na.Combobox,{"data-automation-id":Ue(t),className:i.fieldTokenCombobox,input:{className:i.fieldTokenComboboxInput},value:n.text,placeholder:n.placeholder,expandIcon:null,onOptionSelect:o,onInput:r},De().createElement(na.OptionGroup,{label:ei.K},n.suggestions?.map((e,t)=>De().createElement(na.Option,{key:t,value:e.text,checkIcon:null,className:i.fieldTokenComboboxOption,"data-automation-id":Fe(t)},e.text)))))}function ii(e){const{index:t,token:n,renderOptions:a}=e;return a?De().createElement(Zn.Popover,null,De().createElement(Zn.PopoverTrigger,null,De().createElement(Qn.Tag,{"data-automation-id":He(t),as:"button",primaryText:n.text})),De().createElement(Zn.PopoverSurface,null,a(n))):De().createElement(Qn.Tag,{"data-automation-id":He(t),as:"button",primaryText:n.text})}function ri(e){const{prompt:t,onPromptTokenChange:n,renderPromptTokenOptions:a}=e,i=Ja(),r=$a(),o=Se.useMemo(()=>{const e=t.template.split(/{\d+}/),i=[];for(let o=0;o<e.length;o++){const s=Se.createElement("span",{key:o,className:r.textToken},e[o]);i.push(s);const c=t.tokens[o];if(c){const e=`token-${o}`,t=Se.createElement(ti,{key:e,index:o,token:c,onTokenChange:n,renderTokenOptions:a});i.push(t)}}return i},[r.textToken,t,n,a]);return Se.createElement("div",{"data-automation-id":"prompt-editor",className:i.editor},o)}const oi=(0,xe.makeStyles)({container:{boxSizing:"border-box",padding:"26px 0 100px 0",minHeight:"718px"},content:{display:"flex",alignItems:"flex-start",columnGap:"var(--spacingHorizontalXXXL)",[vt]:{flexDirection:"column",padding:`0 ${xe.tokens.spacingHorizontalL}`},[gt]:{flexDirection:"row",padding:"0 var(--dialogHorizontalPadding)"}},header:{display:"flex",alignItems:"center"},logo:{width:"48px",height:"48px"},title:{marginLeft:"var(--spacingHorizontalL)",lineHeight:"48px"},prompt:{flex:1,overflow:"hidden",[vt]:{marginBottom:xe.tokens.spacingVerticalXXL}},editorWrapper:{[gt]:{minHeight:"calc(260px + var(--spacingVerticalXXL) + 32px)"}},editorContainer:{[vt]:{margin:"40px 0 var(--spacingVerticalXXL) 0"},[gt]:{maxHeight:"260px",overflowY:"auto",overflowX:"hidden",margin:"45px 0 var(--spacingVerticalL) 0"}},editor:{boxSizing:"border-box"},attachments:{flex:1,minWidth:"0"},adjustment:{[vt]:{marginTop:xe.tokens.spacingVerticalXXL},[gt]:{marginTop:"var(--spacingVerticalM)"}},preview:{width:"100%",[gt]:{maxWidth:"300px"}},createWrapper:{display:"flex",alignItems:"center"},footer:{boxSizing:"border-box",position:"absolute",bottom:0,zIndex:1,width:"100%",display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",padding:"var(--spacingVerticalXXL) var(--spacingVerticalXXXL) var(--spacingVerticalXXXL) var(--spacingVerticalXXXL)",backgroundColor:"var(--colorNeutralBackground1)"}});var si=ce(529);function ci(e){const{template:t}=e,n=Ce(),[a,i]=De().useState(void 0),r=De().useRef(null);return(0,Se.useEffect)(()=>{if(r.current){i(r.current.clientWidth);const e=()=>{i(r.current?.clientWidth)},t=(0,si.debounce)(e,100);return window.addEventListener("resize",t),()=>{window.removeEventListener("resize",t),t.cancel()}}},[]),De().createElement("div",{className:n.root},De().createElement(rt.Body2,{className:n.title},t.metadata.title),De().createElement("div",{className:n.previewContainer,ref:r,role:"presentation"},De().createElement(je,{canvasContent:t.canvasContent,displayWidth:a,serviceScope:e.serviceScope,canvasExtraData:t.canvasExtraData})))}const di={colorBrandFlair1:"rgba(24, 90, 189, 1)",colorBrandFlair2:"rgba(71, 207, 250, 1)",colorBrandFlair3:"rgba(180, 124, 248, 1)",colorBrandFlair1Transparent:"rgba(24, 90, 189, 0)",colorBrandFlair2Transparent:"rgba(71, 207, 250, 0)",colorBrandFlair3Transparent:"rgba(180, 124, 248, 0)",colorBrandMorseCode1:"#ad5ae1",colorBrandMorseCode2:"#e9618d",colorBrandMorseCode3:"#fd9e5f",colorBrandMorseCode4:"#0e94e1",colorBrandMorseCode5:"#57ab82",colorBrandMorseCode6:"#c6c225",colorBrandMorseCode7:"#669fc2",colorBrandMorseCode8:"#6377e0",colorBrandMorseCode9:"#9b80ec",colorHCFlair1:"Highlight",colorHCFlair2:"HighlightText",colorHCFlair3:"Highlight",colorHCMorseCode1:"CanvasText",colorHCMorseCode2:"CanvasText",colorHCMorseCode3:"CanvasText",colorHCMorseCode4:"CanvasText",colorHCMorseCode5:"CanvasText",colorHCMorseCode6:"CanvasText",colorHCMorseCode7:"CanvasText",colorHCMorseCode8:"CanvasText",colorHCMorseCode9:"CanvasText",borderRadius2XL:"12px",borderRadius3XL:"16px",borderRadius4XL:"24px",borderRadius5XL:"40px",spacingVertical4XL:"40px",spacingVertical5XL:"48px",spacingHorizontal4XL:"40px",spacingHorizontal5XL:"48px",lineHeightBase450:"24px",lineHeightHero850:"48px",fontSizeBase450:"18px"},li=Se.createContext({mode:"canvas"}),ui=e=>{const t=Se.useContext(li).mode;var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:"canvas"},fi=(0,xe.createContext)(void 0),pi=e=>{const t=hi(e=>e.designVersion);var n;return null!==(n=null!=e?e:t)&&void 0!==n?n:"current"},mi={designVersion:"current"},_i=fi.Provider,hi=e=>(0,xe.useContextSelector)(fi,(t=mi)=>e(t)),bi={clip:"rect(0px, 0px, 0px, 0px)",height:"1px",margin:"-1px",width:"1px",position:"absolute",overflow:"hidden",textWrap:"nowrap"};function gi(e,t){return e&&t?{...e,...t}:e||t}const vi=Se.createContext(void 0),yi=()=>{},Si=vi.Provider,Di=e=>{var t,n;return null!==(n=null===(t=Se.useContext(vi))||void 0===t?void 0:t[e])&&void 0!==n?n:yi},Ii=(0,xe.__styles)({root:{De3pzq:"f1k92xex"}},{d:[".f1k92xex{background-color:unset;}"]}),xi={},Ci=Se.forwardRef((e,t)=>{const n=((e,t)=>{const n=(()=>{const{targetDocument:e}=(0,xe.useFluent_unstable)(),t=Se.useRef(void 0),[n,a]=(0,xe.useTimeout)(),i=Se.useRef(null),r=Se.useRef(0),o=Se.useRef([]),[s]=Se.useState(()=>(0,xe.createPriorityQueue)((e,t)=>e.priority!==t.priority?t.priority-e.priority:e.createdAt-t.createdAt)),c=Se.useCallback(()=>{if(t.current)return;const r=()=>{if(i.current)if(e&&s.peek()){const a=e.createElement("span");a.innerText=s.all().filter(e=>e.message.trim().length>0).reduce((e,t)=>e+t.message+". ",""),i.current.innerText="",i.current.appendChild(a),s.clear(),o.current=[],t.current=n(()=>{r()},500)}else i.current.textContent="",a(),t.current=void 0};r()},[a,s,n,e]),d=Se.useMemo(()=>(e,t={})=>{const{alert:n=!1,priority:a=0,batchId:i}=t,d={message:e,createdAt:r.current++,priority:a,batchId:i};if(i){const e=o.current.find(e=>e.batchId===i);e?(s.remove(e.message),e.message=d):o.current=[...o.current,{batchId:i,message:d}]}s.enqueue(d),c()},[s,c]);return Se.useEffect(()=>{if(!i.current&&e)return i.current=e.createElement("div"),i.current.setAttribute("aria-live","assertive"),Object.assign(i.current.style,bi),e.body.append(i.current),()=>{var e;null===(e=i.current)||void 0===e||e.remove(),i.current=null}},[e]),d})(),{announce:a=n,theme:i,themeExtension:r,customStyleHooks:o}=e,s=ui(e.mode),c=pi(e.designVersion),d=Se.useMemo(()=>gi(i,gi(di,r)),[i,r]);return{...(0,xe.useFluentProvider_unstable)({...e,customStyleHooks_unstable:o,theme:d},t),announce:a,mode:s,designVersion:c}})(e,t);(e=>{const t=Ii();e.root.className=(0,xe.mergeClasses)("fai-CopilotProvider",t.root,e.root.className),(0,xe.useFluentProviderStyles_unstable)(e)})(n);const a=function(e){const{mode:t,customStyleHooks_unstable:n=xi}=e,a=Se.useMemo(()=>({announce:e.announce}),[e.announce]),i=Se.useMemo(()=>({mode:t}),[t]),r=Se.useMemo(()=>({designVersion:e.designVersion}),[e.designVersion]);return{...(0,xe.useFluentProviderContextValues_unstable)(e),announce:a,copilotMode:i,customStyleHooks_unstable:n,designVersion:r}}(n);return((e,t)=>((0,xe.assertSlots)(e),(0,xe.jsx)(li.Provider,{value:t.copilotMode,children:(0,xe.jsx)(_i,{value:t.designVersion,children:(0,xe.jsx)(xe.AnnounceProvider_unstable,{value:t.announce,children:(0,xe.jsx)(Si,{value:t.customStyleHooks_unstable,children:(0,xe.renderFluentProvider_unstable)(e,t)})})})})))(n,a)});Ci.displayName="CopilotProvider";var Oi=ce(2323);const wi=()=>"undefined"!=typeof document,Ei=()=>wi()&&"function"==typeof document.mozSetImageElement,Ai=()=>wi()&&"function"==typeof document.getCSSCanvasContext,Li=()=>"undefined"!=typeof window&&window.CSS&&"paintWorklet"in CSS&&"registerProperty"in CSS,ki={};(()=>{if(Li())try{CSS.registerProperty({name:"--fai-flair-angle",syntax:"<number>",inherits:!0,initialValue:String(3*Math.PI/4)}),CSS.registerProperty({name:"--fai-flair-color-1",syntax:"<color>",inherits:!0,initialValue:"transparent"}),CSS.registerProperty({name:"--fai-flair-color-2",syntax:"<color>",inherits:!0,initialValue:"transparent"}),CSS.registerProperty({name:"--fai-flair-color-3",syntax:"<color>",inherits:!0,initialValue:"transparent"}),CSS.registerProperty({name:"--fai-flair-stroke-width",syntax:"<length>",inherits:!0,initialValue:"2px"})}catch(e){}})();const Mi=(0,xe.__styles)({base:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",Bcmaq0h:"fvrkw42"}},{d:[[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".fvrkw42{background-image:paint(flair);}"]}),Pi=(0,xe.__resetStyles)("r1ukfgjy","rztjz4h",{r:[".r1ukfgjy{animation-duration:2000ms,1200ms,1200ms,1200ms;animation-delay:0ms,0ms,200ms,400ms;animation-timing-function:linear,linear,linear,linear;animation-fill-mode:forwards,forwards,forwards,forwards;animation-name:rcttjya,r1yzbrqw,r36b7kh,r1jewrhq;}","@keyframes rcttjya{0%{--fai-flair-angle:2.356194490192345;}100%{--fai-flair-angle:8.63937979737193;}}","@keyframes r1yzbrqw{0%{--fai-flair-color-1:var(--colorBrandFlair1Transparent);}33%{--fai-flair-color-1:var(--colorBrandFlair1);}83%{--fai-flair-color-1:var(--colorBrandFlair1);}100%{--fai-flair-color-1:var(--colorBrandFlair1Transparent);}}","@keyframes r36b7kh{0%{--fai-flair-color-2:var(--colorBrandFlair2Transparent);}33%{--fai-flair-color-2:var(--colorBrandFlair2);}83%{--fai-flair-color-2:var(--colorBrandFlair2);}100%{--fai-flair-color-2:var(--colorBrandFlair2Transparent);}}","@keyframes r1jewrhq{0%{--fai-flair-color-3:var(--colorBrandFlair3Transparent);}33%{--fai-flair-color-3:var(--colorBrandFlair3);}83%{--fai-flair-color-3:var(--colorBrandFlair3);}100%{--fai-flair-color-3:var(--colorBrandFlair3Transparent);}}",".rztjz4h{animation-duration:2000ms,1200ms,1200ms,1200ms;animation-delay:0ms,0ms,200ms,400ms;animation-timing-function:linear,linear,linear,linear;animation-fill-mode:forwards,forwards,forwards,forwards;animation-name:rcttjya,r1yzbrqw,r36b7kh,r1jewrhq;}"],s:["@media (forced-colors: active){.r1ukfgjy{forced-color-adjust:none;background-color:Canvas;color:CanvasText;animation-duration:2000ms,1200ms,1200ms,1200ms;animation-delay:0ms,0ms,200ms,400ms;animation-timing-function:linear,linear,linear,linear;animation-fill-mode:forwards,forwards,forwards,forwards;animation-name:rcttjya,r1ddftj4,r1pad2q1,rtll915;}@keyframes rcttjya{0%{--fai-flair-angle:2.356194490192345;}100%{--fai-flair-angle:8.63937979737193;}}@keyframes r1ddftj4{0%{--fai-flair-color-1:var(--colorBrandFlair3Transparent);}33%{--fai-flair-color-1:var(--colorHCFlair1);}83%{--fai-flair-color-1:var(--colorHCFlair1);}100%{--fai-flair-color-1:var(--colorBrandFlair3Transparent);}}@keyframes r1pad2q1{0%{--fai-flair-color-2:var(--colorBrandFlair3Transparent);}33%{--fai-flair-color-2:var(--colorHCFlair2);}83%{--fai-flair-color-2:var(--colorHCFlair2);}100%{--fai-flair-color-2:var(--colorBrandFlair3Transparent);}}@keyframes rtll915{0%{--fai-flair-color-3:var(--colorBrandFlair3Transparent);}33%{--fai-flair-color-3:var(--colorHCFlair3);}83%{--fai-flair-color-3:var(--colorHCFlair3);}100%{--fai-flair-color-3:var(--colorBrandFlair3Transparent);}}}","@media (forced-colors: active){.rztjz4h{forced-color-adjust:none;background-color:Canvas;color:CanvasText;animation-duration:2000ms,1200ms,1200ms,1200ms;animation-delay:0ms,0ms,200ms,400ms;animation-timing-function:linear,linear,linear,linear;animation-fill-mode:forwards,forwards,forwards,forwards;animation-name:rcttjya,r1ddftj4,r1pad2q1,rtll915;}}"]}),Ti=(e,t,n)=>{const a=e+(t-e)*n;return e>t?Math.max(a,t):Math.min(a,t)},Ui=e=>{var t;const[,n]=null!=(t=e.match(/(\d+)%/))?t:[];return void 0===n?"to"===e?1:0:parseFloat(n)/100},Fi=e=>parseFloat(e.trim().replace(/m?s/,"")),Hi=()=>"linear",Ri=e=>{let t=e.match(/rgba\((\d+),\s?(\d+),\s?(\d+),\s(\d*\.?\d+)\)/);return t?null==t?void 0:t.slice(1,5).map(parseFloat):(t=e.match(/#([0-9a-fA-F]{3,8})/),t?(e=>{let t="#"===e.charAt(0)?e.substring(1):e;const n=t.length;return 8===n||(6===n?t=`${t}ff`:3===n?t=`${t[0]}${t[0]}${t[1]}${t[1]}${t[2]}${t[2]}ff`:4===n&&(t=`${t[0]}${t[0]}${t[1]}${t[1]}${t[2]}${t[2]}${t[3]}${t[3]}`)),(e=>{const t=parseInt(e,16),n=255&t;return[t>>24&255,t>>16&255,t>>8&255,Math.trunc(n/255*100)/100]})(t)})(t[1]):void 0)},Ni=(e,t,n)=>{const a=parseFloat(e);if(!Number.isNaN(a))return a;const i=Ri(e);if(i)return i;const r=e.match(/var\(([-a-zA-Z0-9]+)\)/);if(!r)return void console.error("Could not parse value",e,"key",t);const[,o]=r,s=n.getPropertyValue(o);return s||console.error("Could not parse value",e,"varName",o),Ri(s)},Bi={linear:(e,t,n,a,i=0)=>{const r=i+a;return n<=i?e:n>=r?t:"number"==typeof e?Ti(e,t,n/r):e.map((e,a)=>Ti(e,t[a],n/r))}},ji=e=>"number"==typeof e?String(e):(([e,t,n,a])=>`rgba(${e}, ${t}, ${n}, ${a})`)(e),Vi=e=>{const t=document.createElement("canvas");t.id=e;const n=t.getContext("2d");return n?(n.canvas.style.position="absolute",n.canvas.style.top="-99999px",n.canvas.style.left="-99999px",n):(console.error("Unable to create moz-element rendering context"),null)},zi=(e,t)=>{t.isConnected||e.appendChild(t)},Gi=(e,t,n,a,i)=>{if(!t){const t=((e,t,n)=>{var a;const i=null!=(a=null==document.getCSSCanvasContext?void 0:document.getCSSCanvasContext.call(document,"2d",e,t,n))?a:null;return i?(i.canvas.style.position="absolute",i):null})(n,a,i);return t?(zi(e,t.canvas),t):null}const r=t.canvas;return r.width=a,r.height=i,t},Ki={id:"",canvas:null,play:()=>{},cleanup:()=>{},stop:()=>{}};let Wi=0;const qi=(e,t,n)=>{var a;if(!wi())return Ki;const i={target:e,ctx:null,mode:"to-data-url",id:"houdini-fallback-"+ ++Wi,wrapper:null,running:!1};if(i.wrapper||(i.wrapper=((e,t="foo")=>{const n=(e=>{let t=document.getElementById(e);return t||(t=document.createElement("div"),t.id=e,t.style.position="fixed",t.style.overflow="hidden",t.style.width="1px",t.style.height="1px",t.style.left="0",t.style.top="0",t.style.opacity="0",t.style.contain="strict",t.style.userSelect="none",t.tabIndex=-1),t})(t);return n.isConnected||e.appendChild(n),n})(document.body)),Ei()){const e=Vi(i.id);if(!e)return Ki;i.ctx=e,i.mode="moz-element",zi(i.wrapper,i.ctx.canvas)}else if(Ai())i.mode="webkit-canvas";else{const e=(r=i.id,Vi(r));if(!e)return Ki;i.ctx=e,i.mode="to-data-url",zi(i.wrapper,i.ctx.canvas)}var r;const o=((e,t,n)=>{const a=new Map,i=getComputedStyle(e.target),r={width:0,height:0},o=new ResizeObserver(t=>{for(const n of t)if(n.target===e.target){if(Array.isArray(n.borderBoxSize))r.width=n.borderBoxSize[0].inlineSize,r.height=n.borderBoxSize[0].blockSize;else{const{width:e,height:t}=n.target.getBoundingClientRect();r.width=e,r.height=t}e.ctx=Gi(e.wrapper,e.ctx,e.id,r.width,r.height)}});return(s,c)=>{e.running=!0,o.observe(e.target),(e=>{const{onComplete:t,isStopped:n,onUpdate:a,...i}=e,r=(({animations:e,delay:t,duration:n,timingFunction:a,iterationCount:i=[1],target:r})=>{const o=i,s=n.split(",").map(Fi),c=t.split(",").map(Fi),d=a.split(",").map(Hi),l=[];let u=0;const f=getComputedStyle(r);for(let t=0;t<e.length;t++){const n=e[t],a=Object.entries(n);if(a.length<2)return void console.error("Animation must have at least 2 steps");var p;const i=null!=(p=o[t])?p:1;var m;const r=null!=(m=c[t])?m:0;var _;const I=null!=(_=s[t])?_:0,x=r+I;var h;x>u&&(u=x);const C=null!=(h=d[t])?h:"linear",O={currentValues:{},keyframes:[]};l.push(O);for(let e=1;e<a.length;e++){const t=e-1,[n,o]=a[t],[s,c]=a[e],d=Ui(n),l=Ui(s),p=I*d+r,m=Math.min(I*l+r,u),_={},h={};for(const e of Object.keys(o)){var b,g,v,y;const t=Ni(o[e],e,f);if(void 0===t)return;null!=(b=O.currentValues)[g=e]||(b[g]=t),null!=(v=_)[y=e]||(v[y]=t)}for(const e of Object.keys(c)){var S,D;const t=Ni(c[e],e,f);if(void 0===t)return;null!=(S=h)[D=e]||(S[D]=t)}O.keyframes.push({iterationCount:i,startTime:p,endTime:m,duration:m-p,ease:Bi[C],startValues:_,endValues:h})}}return{anims:l,overallDuration:u}})(i);if(!r)return void console.error("Unable to create keyframe animation.");const{anims:o,overallDuration:s}=r;((e,t,n,a,i)=>{let r=performance.now();const o=new Map;let s=1;const c=(d=performance.now())=>{const l=d-r;o.clear();const u=e=>{for(const[t,n]of Object.entries(e.keyframes[0].startValues))o.set(t,ji(n))},f=e=>{for(const[t,n]of Object.entries(e.keyframes[e.keyframes.length-1].endValues))o.set(t,ji(n))},p=e=>{const t=e.keyframes.find(e=>l>=e.startTime&&l<=e.endTime);if(t)for(const n of Object.keys(t.startValues)){const a=t.startValues[n],i=t.endValues[n],r=t.ease(a,i,l-t.startTime,t.duration);e.currentValues[n]=r,o.set(n,ji(r))}else console.error("Could not find animData for currentDuration",l)};for(const t of e)s>t.keyframes[0].iterationCount?f(t):l<=t.keyframes[0].startTime?u(t):l>=t.keyframes[t.keyframes.length-1].endTime?f(t):p(t);if(i()){for(const t of e)u(t);n(o)}else l>=t&&e.some(e=>e.keyframes.some(e=>s<e.iterationCount))?(s++,r=performance.now(),requestAnimationFrame(c)):l>=t?n(o):requestAnimationFrame(c);a(o)};c()})(o,s,t,a,n)})({...n,target:e.target,isStopped:()=>!e.running,onUpdate:n=>{var o;const s=null!=(o=t.constructor.inputProperties)?o:[];for(const e of s)a.set(e,i.getPropertyValue(e));if(e.ctx){for(const[e,t]of n.entries())a.set(e,t);if(t.paint(e.ctx,r,a),Ei())e.target.style.backgroundImage=`-moz-element(#${e.id})`;else if(Ai())e.target.style.backgroundImage=`-webkit-canvas(#${e.id})`;else{const t=`url(${e.ctx.canvas.toDataURL("image/png")})`;e.target.style.backgroundImage=t}null==c||c(n)}},onComplete:t=>{e.running=!1,o.unobserve(e.target),s(t)}})}})(i,t,n);var s;return{id:i.id,canvas:null!=(s=null==(a=i.ctx)?void 0:a.canvas)?s:null,play:o,cleanup:()=>{var e,t;null==(e=i.ctx)||e.canvas.remove(),0===(null==(t=i.wrapper)?void 0:t.childElementCount)&&i.wrapper.remove()},stop:()=>{i.running=!1}}},Qi=[0,0,0,0];class Yi{static get inputProperties(){return["--fai-flair-angle","--fai-flair-color-1","--fai-flair-color-2","--fai-flair-color-3","--fai-flair-stroke-width","border-top-left-radius","border-top-right-radius","border-bottom-right-radius","border-bottom-left-radius"]}paint(e,t,n){const a=parseFloat(String(n.get("--fai-flair-angle"))),{width:i,height:r}=t,o=i/2,s=r/2,c=Math.sqrt(o*o+s*s),d=Math.cos(a)*c,l=Math.sin(a)*c,u=o-d,f=s-l,p=o+d,m=s+l,_=e.createLinearGradient(u,f,p,m);_.addColorStop(0,String(n.get("--fai-flair-color-1"))),_.addColorStop(.5,String(n.get("--fai-flair-color-2"))),_.addColorStop(1,String(n.get("--fai-flair-color-3"))),e.clearRect(0,0,i,r),e.fillStyle=_,e.fillRect(0,0,i,r);const h=e.globalCompositeOperation;e.globalCompositeOperation="destination-out";const b=parseFloat(String(n.get("--fai-flair-stroke-width"))),g={top:b,right:b,bottom:b,left:b},v=[Math.max(parseFloat(String(n.get("border-top-left-radius")))-b,0),Math.max(parseFloat(String(n.get("border-top-right-radius")))-b,0),Math.max(parseFloat(String(n.get("border-bottom-right-radius")))-b,0),Math.max(parseFloat(String(n.get("border-bottom-left-radius")))-b,0)];e.fillStyle="blue",e.beginPath(),e.roundRect?e.roundRect(g.left,g.top,i-2*g.right,r-2*g.bottom,v):((e,t,n,a,i,r)=>{let o=Qi;Array.isArray(r)?4===r.length?o=r:1===r.length?o=new Array(4).fill(r[0]):2===r.length?o=[r[0],r[1],r[0],r[1]]:3===r.length&&(o=[r[0],r[1],r[2],r[1]]):"number"==typeof r&&(o=new Array(4).fill(r)),e.moveTo(t+o[0],n),e.arcTo(t+a,n,t+a,n+i,o[1]),e.arcTo(t+a,n+i,t,n+i,o[2]),e.arcTo(t,n+i,t,n,o[3]),e.arcTo(t,n,t+a,n,o[0]),e.closePath()})(e,g.left,g.top,i-2*g.right,r-2*g.bottom,v),e.fill(),e.globalCompositeOperation=h}}try{registerPaint("flair",Yi)}catch(e){}const Ji=(0,xe.createLightTheme)({10:"#061724",20:"#082338",30:"#0a2e4a",40:"#0c3b5e",50:"#0e4775",60:"#0f548c",70:"#115ea3",80:"#0f6cbd",90:"#2886de",100:"#479ef5",110:"#62abf5",120:"#77b7f7",130:"#96c6fa",140:"#b4d6fa",150:"#cfe4fa",160:"#ebf3fc"}),Xi=(0,xe.themeToTokensObject)({...Ji,colorBrandFlair1:"rgba(24, 90, 189, 1)",colorBrandFlair2:"rgba(71, 207, 250, 1)",colorBrandFlair3:"rgba(180, 124, 248, 1)",colorBrandFlair1Transparent:"rgba(24, 90, 189, 0)",colorBrandFlair2Transparent:"rgba(71, 207, 250, 0)",colorBrandFlair3Transparent:"rgba(180, 124, 248, 0)",colorBrandMorseCode1:"#ad5ae1",colorBrandMorseCode2:"#e9618d",colorBrandMorseCode3:"#fd9e5f",colorBrandMorseCode4:"#0e94e1",colorBrandMorseCode5:"#57ab82",colorBrandMorseCode6:"#c6c225",colorBrandMorseCode7:"#669fc2",colorBrandMorseCode8:"#6377e0",colorBrandMorseCode9:"#9b80ec",colorHCFlair1:"Highlight",colorHCFlair2:"HighlightText",colorHCFlair3:"Highlight",colorHCMorseCode1:"CanvasText",colorHCMorseCode2:"CanvasText",colorHCMorseCode3:"CanvasText",colorHCMorseCode4:"CanvasText",colorHCMorseCode5:"CanvasText",colorHCMorseCode6:"CanvasText",colorHCMorseCode7:"CanvasText",colorHCMorseCode8:"CanvasText",colorHCMorseCode9:"CanvasText",borderRadius2XL:"12px",borderRadius3XL:"16px",borderRadius4XL:"24px",borderRadius5XL:"40px",spacingVertical4XL:"40px",spacingVertical5XL:"48px",spacingHorizontal4XL:"40px",spacingHorizontal5XL:"48px",lineHeightBase450:"24px",lineHeightHero850:"48px",fontSizeBase450:"18px",shadowFlair1:"0 10px 12px 0 rgba(0, 30, 68, 0.04), 0 2px 8px 0 rgba(0, 30, 68, 0.06)",shadowFlair2:"0 12px 14px 0 rgba(0, 30, 68, 0.05), 0 6px 8px 0 rgba(0, 30, 68, 0.04), 0 1px 4px 0 rgba(0, 30, 68, 0.06)",shadowFlair3:"0 20px 16px 0 rgba(0, 30, 68, 0.05), 0 10px 12px 0 rgba(0, 30, 68, 0.04), 0 2px 8px 0 rgba(0, 30, 68, 0.06)"}),Zi=3*Math.PI/4,$i={startAngle:String(Zi),endAngle:String(Zi+2*Math.PI),color1Transparent:Xi.colorBrandFlair1Transparent,color2Transparent:Xi.colorBrandFlair2Transparent,color3Transparent:Xi.colorBrandFlair3Transparent,color1Opaque:Xi.colorBrandFlair1,color2Opaque:Xi.colorBrandFlair2,color3Opaque:Xi.colorBrandFlair3,color1HC:Xi.colorHCFlair1,color2HC:Xi.colorHCFlair2,color3HC:Xi.colorHCFlair3,backgroundImage:"paint(flair)",flairAnimationDuration:"2000ms, 1200ms, 1200ms, 1200ms",flairAnimationDelay:"0ms, 0ms, 200ms, 400ms",flairAnimationTimingFunction:"linear, linear, linear, linear",flairColorStop1:"0%",flairColorStop2:"33%",flairColorStop3:"83%",flairColorStop4:"100%"},er={angleAnimation:{"0%":{"--fai-flair-angle":$i.startAngle},"100%":{"--fai-flair-angle":$i.endAngle}},color1Animation:{[$i.flairColorStop1]:{"--fai-flair-color-1":$i.color1Transparent},[$i.flairColorStop2]:{"--fai-flair-color-1":$i.color1Opaque},[$i.flairColorStop3]:{"--fai-flair-color-1":$i.color1Opaque},[$i.flairColorStop4]:{"--fai-flair-color-1":$i.color1Transparent}},color2Animation:{[$i.flairColorStop1]:{"--fai-flair-color-2":$i.color2Transparent},[$i.flairColorStop2]:{"--fai-flair-color-2":$i.color2Opaque},[$i.flairColorStop3]:{"--fai-flair-color-2":$i.color2Opaque},[$i.flairColorStop4]:{"--fai-flair-color-2":$i.color2Transparent}},color3Animation:{[$i.flairColorStop1]:{"--fai-flair-color-3":$i.color3Transparent},[$i.flairColorStop2]:{"--fai-flair-color-3":$i.color3Opaque},[$i.flairColorStop3]:{"--fai-flair-color-3":$i.color3Opaque},[$i.flairColorStop4]:{"--fai-flair-color-3":$i.color3Transparent}},colorHC1Animation:{[$i.flairColorStop1]:{"--fai-flair-color-1":$i.color3Transparent},[$i.flairColorStop2]:{"--fai-flair-color-1":$i.color1HC},[$i.flairColorStop3]:{"--fai-flair-color-1":$i.color1HC},[$i.flairColorStop4]:{"--fai-flair-color-1":$i.color3Transparent}},colorHC2Animation:{[$i.flairColorStop1]:{"--fai-flair-color-2":$i.color3Transparent},[$i.flairColorStop2]:{"--fai-flair-color-2":$i.color2HC},[$i.flairColorStop3]:{"--fai-flair-color-2":$i.color2HC},[$i.flairColorStop4]:{"--fai-flair-color-2":$i.color3Transparent}},colorHC3Animation:{[$i.flairColorStop1]:{"--fai-flair-color-3":$i.color3Transparent},[$i.flairColorStop2]:{"--fai-flair-color-3":$i.color3HC},[$i.flairColorStop3]:{"--fai-flair-color-3":$i.color3HC},[$i.flairColorStop4]:{"--fai-flair-color-3":$i.color3Transparent}}},tr=(0,xe.__styles)({base:{Em4edj:"f13vsbc6",Bjfw52h:"fam6ru7",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",Bcmaq0h:"feli345"}},{d:[".f13vsbc6{--fai-flair-stroke-width:var(--strokeWidthThick);}",".fam6ru7{--fai-flair-background-image:none;}",[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".feli345{background-image:var(--fai-flair-background-image);}"]}),nr=()=>{},ar=Li()?({baseUrl:e="https://res-1.cdn.office.net/files/fabric-cdn-prod_20240228.001/assets/animations/flair/",fileName:t="flair.min.js"}={})=>{Se.useEffect(()=>{const n=`${e}${t}`;ki[n]||((e,t)=>{if(Li()){const n=`${e}${t}`;return CSS.paintWorklet.addModule(n)}return Promise.resolve()})(e,t).then(()=>{ki[n]=!0}).catch(e=>{ki[n]=!1})},[e,t]);const n=Pi(),a=Mi(),i=Se.useRef(null),r={rest:"",play:n},[o,s]=Se.useState("rest");return{className:(0,xe.mergeClasses)(a.base,r[o],o),play:()=>{if("rest"===o&&i.current){var e,t,n;s("play");let a=0;const r=()=>{a++},o=()=>{var e,t,n;a--,a<=0&&(s("rest"),null===(e=i.current)||void 0===e||e.removeEventListener("animationstart",r),null===(t=i.current)||void 0===t||t.removeEventListener("animationend",o),null===(n=i.current)||void 0===n||n.removeEventListener("animationcancel",c))},c=()=>{var e,t,n;s("rest"),null===(e=i.current)||void 0===e||e.removeEventListener("animationstart",r),null===(t=i.current)||void 0===t||t.removeEventListener("animationend",o),null===(n=i.current)||void 0===n||n.removeEventListener("animationcancel",c)};null===(e=i.current)||void 0===e||e.addEventListener("animationstart",r),null===(t=i.current)||void 0===t||t.addEventListener("animationend",o),null===(n=i.current)||void 0===n||n.addEventListener("animationcancel",c)}},targetRef:i}}:()=>{const e=tr(),t=Se.useRef("rest"),n=Se.useCallback(()=>(0,xe.mergeClasses)(e.base,"fallback-flair",t.current),[e.base]),a=Se.useCallback(e=>{const i={className:n(),targetRef:a};if(e){const{play:a}=qi(e,new Yi,{animations:[er.angleAnimation,er.color1Animation,er.color2Animation,er.color3Animation],delay:$i.flairAnimationDelay,duration:$i.flairAnimationDuration,timingFunction:$i.flairAnimationTimingFunction}),o=()=>{t.current="rest",r({...i,className:n()})};i.play=()=>{"rest"===t.current&&(t.current="play",r({...i,className:n()}),a(o,()=>!0))}}else i.style={},i.play=nr;r({...i,className:n()})},[n]),[i,r]=Se.useState({className:n(),play:nr,targetRef:a});return i},ir=(0,xe.__styles)({root:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1kijzfu",mc9l5x:"f22iagw",Beiy3e4:"f1vx9l62",qhf8xq:"f10pi13n",Bj3rh1h:"f11zp4z2",De3pzq:"fxugw4r",B7ck84d:"f1ewtqcl",E5pizo:"f1whvlc6",Bw0xxkn:0,oeaueh:0,Bpd4iqm:0,Befb4lg:"f1iepc6i"},sidecar:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"fdgaxb"},canvas:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f6lrzt8"},progressRoot:{B68tc82:"f1p9o1ba",Bmxbyg5:"f1sil6mw",Bpg54ce:"f1a3p1vp",a9b677:"f14z66ap",qhf8xq:"f1euv43f",B5kzvoi:"f1yab3r1",oyh7mz:["f1vgc2s3","f1e31b4d"],j35jbq:["f1e31b4d","f1vgc2s3"],Bqenvij:"fniina8",Beyfa6y:["frrelxk","f1ldthgs"],Bbmb7ep:["f1ldthgs","frrelxk"],Bgl5zvf:"f5aapo6",Bn62ygk:0,Cwk7ip:0,B3o57yi:0,Bmy1vo4:0,Bkqvd7p:0,Bi2q7bf:"fxqei6h"},progressIsLoading:{Bqenvij:"f1x82gua"},bar:{Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"fokr779"},regularProgressBarStyles:{Bqenvij:"f1l02sjl",Bcmaq0h:"ffso0f9"},indeterminateProgressBarStyles:{vin17d:"f1a27w2r",Bqenvij:"f1l02sjl",De3pzq:"f1c21dwh",Bcmaq0h:"fc9jjzv",jpy9cc:"f3z2g5w",Bqo2lbl:"fz5izi4",I82g5a:"f1uj6jbf",B6plc1d:"fv40pdu"},indeterminateBarNotIsLoading:{Bh6m77q:"f1yav1uu"}},{d:[[".f1kijzfu{border-radius:var(--borderRadiusXLarge);}",{p:-1}],".f22iagw{display:flex;}",".f1vx9l62{flex-direction:column;}",".f10pi13n{position:relative;}",".f11zp4z2{z-index:0;}",".fxugw4r{background-color:var(--colorNeutralBackground1);}",".f1ewtqcl{box-sizing:border-box;}",".f1whvlc6{box-shadow:var(--shadow4);}",[".f1iepc6i{outline:1px solid var(--colorTransparentStroke);}",{p:-1}],[".fdgaxb{padding:var(--spacingVerticalM) var(--spacingHorizontalL);}",{p:-1}],[".f6lrzt8{padding:var(--spacingVerticalL) var(--spacingVerticalXL);}",{p:-1}],[".f1a3p1vp{overflow:hidden;}",{p:-1}],".f14z66ap{width:auto;}",".f1p9o1ba{overflow-x:hidden;}",".f1sil6mw{overflow-y:hidden;}",".f1euv43f{position:absolute;}",".f1yab3r1{bottom:0;}",".f1vgc2s3{left:0;}",".f1e31b4d{right:0;}",".fniina8{height:0;}",".frrelxk{border-bottom-left-radius:var(--borderRadiusLarge);}",".f1ldthgs{border-bottom-right-radius:var(--borderRadiusLarge);}",".f5aapo6{clip-path:polygon(0px 4px, 100% 4px, 100% 8px, 0px 8px);}",[".fxqei6h{transition:height var(--durationSlow) var(--curveDecelerateMin);}",{p:-1}],".f1x82gua{height:8px;}",[".fokr779{border-radius:0;}",{p:-1}],".f1l02sjl{height:100%;}",".ffso0f9{background-image:linear-gradient(90deg, var(--colorBrandFlair1) 35%, var(--colorBrandFlair2) 70%, var(--colorBrandFlair3) 92%);}",".f1a27w2r{animation-duration:3s;}",".f1c21dwh{background-color:var(--colorTransparentBackground);}",".fc9jjzv{background-image:linear-gradient(90deg, rgba(0,0,0,0) 0%, var(--colorBrandFlair1) 35%, var(--colorBrandFlair2) 70%, var(--colorBrandFlair3) 92%,  rgba(0,0,0,0));}",".f1yav1uu{animation-play-state:paused;}"],m:[["@media screen and (prefers-reduced-motion: reduce){.f3z2g5w{max-width:100%;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.fz5izi4{animation-iteration-count:infinite;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.f1uj6jbf{animation-name:ftc26vs;}}",{m:"screen and (prefers-reduced-motion: reduce)"}],["@media screen and (prefers-reduced-motion: reduce){.fv40pdu{animation-duration:3s;}}",{m:"screen and (prefers-reduced-motion: reduce)"}]],k:["@keyframes ftc26vs{0%{opacity:.2;}50%{opacity:1;}100%{opacity:.2;}}"]}),rr=(0,xe.__styles)({root:{Byoj8tv:0,uwmqm3:0,z189sj:0,z8tnut:0,B0ocmuz:"f1hgi6q7",Beyfa6y:0,Bbmb7ep:0,Btl43ni:0,B7oj6ja:0,Dimara:"f1pwvjsv"},progressRoot:{Beyfa6y:["f1tlku5q","f1vtdrap"],Bbmb7ep:["f1vtdrap","f1tlku5q"],j35jbq:["fvwj8x0","facy6yv"],oyh7mz:["facy6yv","fvwj8x0"]}},{d:[[".f1hgi6q7{padding:var(--spacingVerticalXXL) var(--spacingHorizontalXXL);}",{p:-1}],[".f1pwvjsv{border-radius:var(--borderRadius4XL);}",{p:-1}],".f1tlku5q{border-bottom-left-radius:var(--borderRadius4XL);}",".f1vtdrap{border-bottom-right-radius:var(--borderRadius4XL);}",".fvwj8x0{right:10px;}",".facy6yv{left:10px;}"]}),or=Se.forwardRef((e,t)=>{const n=((e,t)=>{const{play:n,targetRef:a,...i}=ar(),r=pi(e.designVersion);var o;const s={flairClassName:i.className,designVersion:r,isLoading:null!==(o=e.isLoading)&&void 0!==o&&o,mode:ui(e.mode),components:{root:"div",progress:Oi.ProgressBar},root:xe.slot.always({...(0,xe.getIntrinsicElementProps)("div",{ref:(0,xe.useMergedRefs)(a,t),...e}),style:{...i.style,...e.style}},{elementType:"div"}),progress:xe.slot.optional(e.progress,{defaultProps:{shape:"square",thickness:"large","aria-label":"Loading"},elementType:Oi.ProgressBar,renderByDefault:!1})},c=(0,xe.usePrevious)(s.isLoading);return Se.useEffect(()=>{!s.isLoading&&c&&n()},[s.isLoading,c,n]),s})(e,t);return(e=>{const{flairClassName:t,designVersion:n}=e,a=ir(),i=rr();if(e.root.className=(0,xe.mergeClasses)("fai-OutputCard",a.root,a[e.mode],t,"next"===n&&i.root,e.root.className),e.progress){e.progress.className=(0,xe.mergeClasses)("fai-OutputCard__progress",a.progressRoot,e.isLoading&&a.progressIsLoading,"next"===n&&i.progressRoot,e.progress.className);const t=xe.slot.optional(e.progress.bar,{elementType:"div",renderByDefault:!0});t&&(void 0===e.progress.value?t.className=(0,xe.mergeClasses)(a.bar,a.indeterminateProgressBarStyles,!e.isLoading&&a.indeterminateBarNotIsLoading,t.className):t.className=(0,xe.mergeClasses)(a.regularProgressBarStyles,a.bar,t.className),e.progress.bar=t)}})(n),Di("useOutputCardStyles")(n),(e=>((0,xe.assertSlots)(e),(0,xe.jsxs)(e.root,{children:[e.root.children," ",e.progress&&(0,xe.jsx)(e.progress,{})]})))(n)});or.displayName="OutputCard";const sr=(0,xe.makeStyles)({copilotProvider:{display:"flex",justifyContent:"center",position:"sticky",top:"20px"},card:{padding:"8px",boxSizing:"content-box",width:"648px",gap:xe.tokens.spacingVerticalSNudge},finishedBorder:{backgroundImage:"linear-gradient(to right, rgb(61, 145, 255), rgb(108, 235, 226), rgb(146, 112, 255))",borderRadius:xe.tokens.borderRadiusXLarge,boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12)",...xe.shorthands.padding(xe.tokens.spacingVerticalXXS)}});function cr(e){const{isLoading:t,children:n,isBorderClass:a,progressValue:i}=e,r=sr(),o=(0,ze.css)({[r.finishedBorder]:a&&!t});return De().createElement(Ci,{className:r.copilotProvider},De().createElement("div",{className:o},De().createElement(or,{className:r.card,progress:{value:i||void 0},isLoading:t},n)))}const dr=JSON.parse('{"o":"Generating the page prompt..."}'),lr=(0,xe.makeStyles)({root:{padding:"0",width:"fit-content",backgroundColor:"transparent"}});function ur(){const[e]=De().useState(()=>new AbortController);return De().useEffect(()=>()=>{e.abort()},[e]),e.signal}async function fr(e,t,n,a,i){const{mode:r="inference",scenario:c,category:d,prompt:l,template:u,attachments:f,length:p,tone:m,language:h,fidelity:b,handoffOption:g}=a;t.endsWith("/")||(t+="/");const v={},y=[];for(const e of f){const t=S.Guid.newGuid().toString();switch(e.type){case tn.AttachmentType.File:v[t]=e.sharepointIds,y.push({id:t,fileName:e.name,attachmentType:e.type});break;case tn.AttachmentType.Meeting:y.push({id:e.id,fileName:e.name,attachmentType:e.type,hasRecording:e.hasRecording});break;case tn.AttachmentType.MeetingSeries:break;case tn.AttachmentType.Markdown:y.push({id:e.id,fileName:e.name,attachmentType:e.type,content:e.content})}}const D=l?{version:"1.0",mode:r,prompt:l,scenario:c,template:u?{source:u.source,uniqueId:u.id,absoluteUrl:u.absoluteUrl}:void 0,length:p,tone:m,language:h,fidelity:b,attachments:y,attachmentsNew:f,handoffOption:g}:void 0,I={controlType:s.CanvasControlType.CanvasExtraData,webPartData:{properties:{...A()||"ai-templates"!==a.scenario?{}:{aiContextStore:u?.canvasExtraData?.webPartData?.properties.aiContextStore},pagePrompt:D?JSON.stringify(D):void 0,links:v},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{}},dataVersion:"1.0"}},x=a?.title;return async function(e,t,n,a){t.endsWith("/")||(t+="/");const i=e.consume(yn.AadHttpClientFactory.serviceKey),r=await i._getStandardClient(new URL(t).origin),s=await r.post(`${t}_api/sitepages/pages`,yn.AadHttpClient.configurations.v1,{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json",Accept:"application/json"},signal:a});if(!s.ok){const e=s.headers.get("SPRequestGuid")??void 0,t=`Failed to create page. Error: ${s.statusText} CorrelationId: ${e}`;throw new o.PagesApiError({httpStatus:s.status,message:t,correlationId:e})}return s.json()}(e,t,{CanvasContent1:JSON.stringify([I]),Title:x,SitePageFlags:mr(pr({isPrivateAuthoring:a?.isPrivateAuthoring,isVideoPage:!!u?.id&&(C=u?.id,"ff16acf8-6dd6-4038-b66f-976c500bfbcc"===C||"ff16acf8-6dd6-4038-b66f-976c500bfbcd"===C||"ff16acf8-6dd6-4038-b66f-976c500bfbce"===C||"ff16acf8-6dd6-4038-b66f-976c500bfbcf"===C)})),PromotedState:d===_.NewsPost?1:0,PageLayoutType:"Article",...n},i);var C}function pr(e){const t=["IsFromAuthoringCopilot"];return e.isPrivateAuthoring&&t.push("PrivateAuthoring"),e.isVideoPage&&t.push("VideoPage"),t}function mr(e){if(Array.isArray(e)&&e?.length>0)return`;#${e.join(";#")};#`}function _r(e){let t=!1;return e instanceof o.PagesApiError&&e.httpStatus&&(403===e.httpStatus||429===e.httpStatus||507===e.httpStatus)&&(t=!0),t}var hr=ce(6557);const br=tt("SquareDismiss20Regular","20",["M6 3a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h3.6c-.16-.32-.3-.65-.4-1H6a2 2 0 0 1-2-2V6c0-1.1.9-2 2-2h8a2 2 0 0 1 2 2v3.2c.35.1.68.24 1 .4V6a3 3 0 0 0-3-3H6Zm8.5 16a4.5 4.5 0 1 0 0-9 4.5 4.5 0 0 0 0 9Zm1.85-6.35c.2.2.2.5 0 .7l-1.14 1.15 1.14 1.15a.5.5 0 0 1-.7.7l-1.15-1.14-1.15 1.14a.5.5 0 0 1-.7-.7l1.14-1.15-1.14-1.15a.5.5 0 0 1 .7-.7l1.15 1.14 1.15-1.14c.2-.2.5-.2.7 0Z"]),gr=ce.p+"odm_ic_fluent_copilot_20_color_32f3324f.svg",vr=(0,xe.makeStyles)({content:{display:"flex",flexDirection:"row",alignItems:"center"},info:{flexGrow:1,display:"flex",flexDirection:"row",alignItems:"center"},logo:{marginRight:"6px"}}),yr=JSON.parse('{"se":"Stop","mk":"ESC"}');function Sr(e){const{label:t,onStop:n,showLogo:a}=e,i=vr();return De().createElement("div",{className:i.content},De().createElement("div",{className:i.info},a&&De().createElement(Et.Image,{src:gr,className:i.logo,role:"presentation"}),De().createElement(rt.Text,null,t)),De().createElement(jt.Button,{"data-automation-id":"copilot-progress-indicator-stop-btn",icon:De().createElement(br,null),appearance:"transparent",size:"small",onClick:n,autoFocus:!0},yr.se),De().createElement(hr.Badge,{appearance:"outline",color:"informative",shape:"rounded",size:"small"},yr.mk))}var Dr;function Ir(e){const{serviceScope:t,template:n,onFinish:a,onError:i,onStop:r}=e,o=ur();(0,Se.useEffect)(()=>{(async()=>{try{let e=n.canvasContent;if(!e){if(n.source===m.Microsoft)return void i(new Error("NoCanvasContent"));const a=await function(e,t){return e.consume(nn.SPHttpClient.serviceKey).get(`${t}?as=json`,nn.SPHttpClient.configurations.v1).then(e=>{if(!e.ok)throw new Error(`Failed to fetch page. Error: ${e.statusText}`);return e.json()})}(t,n.absoluteUrl);if(o.aborted)return;e=JSON.parse(a.page.Content.CanvasContent1)}}catch(e){i(e)}})()},[n,o,t,a,i]);const s=lr();return De().createElement(Zn.Popover,{open:!0,inline:!0,onOpenChange:r},De().createElement(Zn.PopoverSurface,{className:s.root,"data-automation-id":"copilot-template-analyzer"},De().createElement(cr,{isLoading:!0},De().createElement(Sr,{label:dr.o,onStop:r}))))}!function(e){e.NoCanvasContent="NoCanvasContent",e.PageAnalyzeFailed="PageAnalyzeFailed",e.NoCopilotResponse="NoCopilotResponse",e.InvalidCopilotResponse="InvalidCopilotResponse"}(Dr||(Dr={}));const xr=JSON.parse('{"zu":"Customize with AI","eU":"Customize your page","Eb":"Customize your news post","lc":"Back","fv":"Create","T_":"{0} file has been removed","bZ":"{0} dialog"}');function Cr(e){const{serviceScope:t,selectedTemplate:n,siteSensitiveLabel:a,onGoBack:i,onCreatePage:r}=e,s=ut(),c=De().useRef({checked:!1}),[d,l]=(0,Se.useState)(()=>n.prompt?g(n):null),u=oi(),f=(0,Se.useCallback)(e=>{const{index:t,token:n}=e;l(e=>e?{template:e.template,tokens:e.tokens.map((e,a)=>a===t?n:e)}:null),s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.PromptEditor.Edit",stage:"Trigger"})},[l,s]),p=(0,Se.useCallback)(()=>{i(Ba.CustomizePrompt,n)},[n,i]),{attachments:m,addAttachment:h,removeAttachment:b,checkSensitivity:v}=Dn(),y=(0,Se.useCallback)(e=>{b(e),s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Remove",stage:"Trigger"}),st.read(S.Text.format(xr.T_,e.name),o.ReadingMode.ReadImmediately)},[b,s]),D=(0,Se.useCallback)(e=>{h(e),s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Select",stage:"Trigger"})},[h,s]),{internalAttachments:I,removeAttachment:x,addAttachment:C,checkSensitivity:O}=(0,tn.useAttachments)({serviceScope:t,multiSelection:!0,defaultAttachments:[]}),w=(0,Se.useCallback)(e=>{C(e),s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Select",stage:"Trigger"})},[C,s]),E=(0,Se.useCallback)(e=>{x(e),s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Remove",stage:"Trigger"}),st.read(S.Text.format(xr.T_,e.name),o.ReadingMode.ReadImmediately)},[x,s]),[A,L]=(0,Se.useState)(_e.Professional),[k,M]=(0,Se.useState)(he.Medium),[P,T]=(0,Se.useState)(!1);let U={isSensitiveBarVisible:!1,isHighlySensitiveBarVisible:!1,highestLevelLabelFileCount:1};a&&(U=En()?O():v(a));const F=En()?I.some(e=>!e.sensitiveLabel):m.some(e=>!e.sensitiveLabel),H=d?De().createElement("div",null,De().createElement("div",{className:u.editorWrapper},De().createElement("div",{className:u.editorContainer},De().createElement("div",{className:u.editor},De().createElement(ri,{prompt:d,onPromptTokenChange:f}))),En()?De().createElement("div",{className:u.attachments},De().createElement(tn.Attachments,{size:"extra-large",decoration:"border",serviceScope:t,attachments:I,onAttachmentSelect:w,onAttachmentRemove:E,displayTabs:[tn.AttachmentPickerTabs.All,tn.AttachmentPickerTabs.Files,tn.AttachmentPickerTabs.Meetings,...Tn()?[tn.AttachmentPickerTabs.Sites]:[]]})):De().createElement("div",{className:u.attachments},De().createElement(ua,{size:"extra-large",decoration:"border",attachments:m,onAttachmentSelect:D,onAttachmentRemove:y,serviceScope:t})),(U.isSensitiveBarVisible||U.isHighlySensitiveBarVisible)&&De().createElement(vn,{isContainHighlyConfidential:U.isHighlySensitiveBarVisible,highestLevelLabelFileCount:U.highestLevelLabelFileCount})),De().createElement("div",{className:u.adjustment},De().createElement(qn,{tone:A,onToneChange:L}),De().createElement(Gn,{length:k,onLengthChange:M}))):De().createElement(Ir,{serviceScope:t,template:n,onFinish:l,onError:e=>{i(Ba.CustomizePrompt,n)},onStop:()=>{i(Ba.CustomizePrompt,n)}});let R=xr.zu;switch(n.category){case _.Page:R=xr.eU;break;case _.NewsPost:R=xr.Eb}return(0,Se.useEffect)(()=>{st.read(S.Text.format(xr.bZ,R),o.ReadingMode.ReadImmediately)},[R]),De().createElement("div",{className:u.container,"data-automation-id":"create-page-with-copilot-customize-prompt-step"},De().createElement("div",{className:u.content},De().createElement("div",{className:u.prompt},De().createElement("div",{className:u.header},De().createElement(rt.Title1,{className:u.title,role:"heading","aria-level":1},R)),H),De().createElement("div",{className:u.preview},De().createElement(ci,{template:n,serviceScope:t}))),De().createElement("div",{className:u.footer},De().createElement(jt.Button,{"data-automation-id":Oe,appearance:"subtle",icon:De().createElement(un,null),onClick:p},xr.lc),De().createElement("div",{className:u.createWrapper},kn(t)&&De().createElement(wa,{ref:c}),De().createElement(jt.Button,{appearance:"primary","data-automation-id":we,disabledFocusable:!d||P,onClick:async()=>{if(!d)return;T(!0);const e=En()?I:m;s.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.CustomizePrompt.Create.Click",stage:"Trigger",payload:{pageTemplateId:n.id,pageTemplateCategory:n.category,tone:A,hasOutline:!1,length:k,isPrivateAuthoring:c.current?.checked||!1,attachments:e}}),await r(n.category,n,d,A,k,void 0,void 0,e,c.current?.checked||!1)||T(!1)},disabled:U.isHighlySensitiveBarVisible||F},P?De().createElement(zt.Spinner,{size:"tiny"}):xr.fv))))}const Or=ce.p+"odm_spui_background_gradient_copilot_light__lg_bca45df9.svg",wr=ce.p+"odm_spui_background_gradient_copilot_dark__lg_85f0457c.svg",Er=(0,xe.makeStyles)({wizard:{minHeight:"790px"},builderWizard:{display:"flex",height:"100%",flexDirection:"column"},builderResponsive:{"@media screen and (max-height: 790px)":{minHeight:"unset"},"@media screen and (max-height: 600px)":{height:"unset",gap:"var(--spacingVerticalXXL)"}},dialogHeader:{position:"sticky",top:0,zIndex:1,padding:"var(--spacingVerticalXL) 0",display:"flex",flexDirection:"row",justifyContent:"flex-end",backgroundSize:"100%",backgroundRepeat:"no-repeat",overflow:"hidden",[Dt]:{position:"relative"}},builderDialogHeader:{flex:"none"},dialogHeaderNormal:{backgroundColor:xe.tokens.colorNeutralBackground1,borderBottom:"1px solid var(--colorNeutralStroke1)",justifyContent:"space-between"},dialogHeaderContent:{display:"flex",alignItems:"center",gap:"8px",padding:"0 32px"},dialogHeaderBackgroundLight:{backgroundImage:`url(${Or})`,backgroundColor:xe.tokens.colorNeutralBackground1,"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{backgroundImage:"none"}},dialogHeaderBackgroundDark:{backgroundImage:`url(${wr})`,backgroundColor:xe.tokens.colorNeutralBackground1,"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{backgroundImage:"none"}},wizardBackgroundCover:{position:"absolute",zIndex:-1,top:"0",left:"0",width:"100%",height:"790px"},wizardTransparentBackgroundCoverLight:{backgroundColor:"rgba(255, 255, 255, 0.5)"},wizardTransparentBackgroundCoverDark:{backgroundColor:"rgba(24, 37, 52, 0.8)"},wizardLinearGradientBackgroundCoverLight:{backgroundImage:"linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 1) 50%)"},wizardLinearGradientBackgroundCoverDark:{backgroundImage:"linear-gradient(180deg, rgba(24, 37, 52, 0) 0%, rgba(24, 37, 52, 0.8) 50%)"},dialogActionButton:{margin:"0 var(--spacingHorizontalXXL)"}});function Ar(e){const{templates:t,selection:n,defaultTemplateCategory:a}=e,i=b(t,m.Microsoft,M()?_.Page:a??_.NewsPost)[0];if(!x()&&void 0!==e.defaultPromptText&&void 0!==e.defaultTemplateCategory)return{step:Ln()?Ba.PageBuilder:Ba.FreePrompt,data:{selection:{templateId:i.id,templateSource:m.All,templateCategory:M()?_.Page:a??_.NewsPost},templates:t,defaultPromptText:e.defaultPromptText,defaultTemplateCategory:e.defaultTemplateCategory},referrer:Ba.TemplateGallery};if(n){const e=function(e,t){return b(e,t.templateSource,t.templateCategory).find(e=>e.id===t.templateId)}(t,n);if(!e){const e={templateId:i.id,templateSource:m.All,templateCategory:M()?_.Page:a??_.NewsPost};return{step:Ba.TemplateGallery,data:{selection:e,templates:t}}}return!e.prompt&&e.useFreePrompt?{step:Ba.FreePrompt,data:{selection:n,selectedTemplate:e,templates:t},referrer:Ba.TemplateGallery}:{step:Ba.CustomizePrompt,data:{selection:n,selectedTemplate:e,templates:t},referrer:Ba.TemplateGallery}}{const e={templateId:i.id,templateSource:m.All,templateCategory:M()?_.Page:a??_.NewsPost};return{step:Ba.TemplateGallery,data:{selection:e,templates:t}}}}function Lr(e,t){switch(t.type){case"template-select":{const{selectedTemplate:n,templateSource:a,templateCategory:i}=t.params,r={templateId:n.id,templateSource:a,templateCategory:i};return Ar({templates:e.data.templates,selection:r})}case"go-to-template-gallery-step":return{step:Ba.TemplateGallery,data:{selection:e.data.selection,templates:e.data.templates},referrer:t.referrer};case"go-to-free-prompt-step":return{step:Ba.FreePrompt,data:{selection:e.data.selection,templates:e.data.templates},referrer:t.referrer};case"go-to-page-builder-step":return{step:Ba.PageBuilder,data:{selection:e.data.selection,templates:e.data.templates},referrer:t.referrer};default:return e}}const kr=JSON.parse('{"Y":"Close","c":"Copilot"}');var Mr=ce(7793),Pr=ce(152);const Tr="hoverAction",Ur=(0,xe.makeStyles)({root:{borderRadius:"var(--spacingVerticalM) var(--spacingHorizontalM)",backgroundColor:"var(--colorNeutralBackground1)",minHeight:"450px",padding:"var(--spacingVerticalXXL) 48px",display:"flex",gap:"48px",boxShadow:xe.tokens.shadow4,[vt]:{flexDirection:"column",gap:xe.tokens.spacingHorizontalXXXL,padding:xe.tokens.spacingVerticalM}},icon:{width:"24px",height:"24px"},draftContainer:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"flex-start",gap:xe.tokens.spacingVerticalXXL,[vt]:{order:2}},title:{padding:"8px 0"},header:{display:"flex",alignItems:"center",gap:xe.tokens.spacingHorizontalS},headline:{[vt]:{marginLeft:xe.tokens.spacingHorizontalXXXL}},list:{width:"100%"},listItem:{paddingBottom:xe.tokens.spacingVerticalXS},outlineItem:{marginLeft:"-36px",padding:xe.tokens.spacingHorizontalM,display:"flex",alignItems:"center",gap:xe.tokens.spacingVerticalS,borderRadius:xe.tokens.borderRadiusXLarge,":hover .hoverAction":{visibility:"visible"},":hover":{backgroundColor:xe.tokens.colorNeutralBackground3},[vt]:{margin:"unset"}},outlineItemContent:{flexGrow:1},contentList:{paddingInlineStart:"24px",marginBottom:0,marginTop:xe.tokens.spacingVerticalS},divider:{height:"2px",border:"unset",width:"96%",position:"absolute",zIndex:-1,top:"calc(50% - 1px)",left:"2%",backgroundImage:"linear-gradient(to right, rgb(61, 145, 255), rgb(108, 235, 226), rgb(146, 112, 255))",visibility:"hidden"},dragButton:{visibility:"hidden",margin:"-4px",":hover":{cursor:"grab"},":active":{cursor:"grabbing"},":disabled":{cursor:"not-allowed"},":disabled:hover":{cursor:"not-allowed"}},deleteButton:{marginLeft:"auto",marginRight:0,visibility:"hidden",alignSelf:"flex-start",margin:"-4px"},outlineItemHeader:{display:"flex",justifyContent:"space-between",alignItems:"center"},addButton:{display:"flex",margin:"0 auto",visibility:"hidden"},addButtonWrapper:{margin:"-12px",zIndex:1,position:"relative",":hover .hoverAction":{visibility:"visible",backgroundColor:"#468DEC",boxShadow:xe.tokens.shadow8}},statusBar:{width:"100%",[vt]:{margin:`0 ${xe.tokens.spacingHorizontalXXXL}`,width:`calc(100% - ${xe.tokens.spacingHorizontalXXXL})`}},outlineError:{marginTop:"-24px"},errorMessage:{marginTop:xe.tokens.spacingVerticalS},debugButton:{position:"absolute",right:0,bottom:0}}),Fr=(0,xe.makeStyles)({card:{padding:"6px 8px 10px"}});function Hr(e){const{isLoading:t,children:n,progressValue:a}=e,i=Fr();return De().createElement(Ci,{className:e.className},De().createElement(or,{className:i.card,progress:{value:a||void 0},isLoading:t},n))}const Rr=tt("ReOrderDotsVertical16Regular","16",["M6 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm0 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm3-7a1 1 0 1 0 0-2 1 1 0 0 0 0 2Zm1 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0Zm-1 5a1 1 0 1 0 0-2 1 1 0 0 0 0 2Z"]),Nr=tt("Delete16Regular","16",["M7 3h2a1 1 0 0 0-2 0ZM6 3a2 2 0 1 1 4 0h4a.5.5 0 0 1 0 1h-.56l-1.2 8.84A2.5 2.5 0 0 1 9.74 15h-3.5a2.5 2.5 0 0 1-2.48-2.16L2.57 4H2a.5.5 0 0 1 0-1h4Zm1 3.5a.5.5 0 0 0-1 0v5a.5.5 0 0 0 1 0v-5ZM9.5 6c.28 0 .5.22.5.5v5a.5.5 0 0 1-1 0v-5c0-.28.22-.5.5-.5Zm-4.74 6.7c.1.75.74 1.3 1.49 1.3h3.5a1.5 1.5 0 0 0 1.5-1.3L12.42 4H3.57l1.19 8.7Z"]),Br=tt("Add16Regular","16",["M8 2c.28 0 .5.22.5.5v5h5a.5.5 0 0 1 0 1h-5v5a.5.5 0 0 1-1 0v-5h-5a.5.5 0 0 1 0-1h5v-5c0-.28.22-.5.5-.5Z"]);var jr=ce(4458);const Vr=JSON.parse('{"u1":"Describe the topic to add","sR":"Close prompt","ku":"Submit","YY":"Add a section about","Lx":"Copilot will create a new section using your page, section details and sources you\\u0027ve added"}'),zr=(0,xe.makeStyles)({root:{...xe.shorthands.padding(xe.tokens.spacingVerticalM,xe.tokens.spacingVerticalNone,xe.tokens.spacingHorizontalXXL)},label:{color:xe.tokens.colorNeutralForeground2,backgroundColor:xe.tokens.colorNeutralShadowKeyLighter,padding:"2px 8px",borderRadius:xe.tokens.borderRadiusMedium},inputTitle:{display:"flex",justifyContent:"space-between"},input:{display:"flex","& input":{paddingLeft:xe.tokens.spacingHorizontalXS}},submitButton:{width:"20px",height:"20px",maxWidth:"20px",maxHeight:"20px",minWidth:"20px",minHeight:"20px",padding:"2px",display:"flex",alignItems:"center",justifyContent:"center"},finishedBorder:{backgroundImage:"linear-gradient(to right, rgb(61, 145, 255), rgb(108, 235, 226), rgb(146, 112, 255))",borderRadius:xe.tokens.borderRadiusXLarge,boxShadow:"0px 4px 8px 0px rgba(0, 0, 0, 0.14), 0px 0px 2px 0px rgba(0, 0, 0, 0.12)",...xe.shorthands.padding(xe.tokens.spacingVerticalXXS)},inputContainer:{...xe.shorthands.padding(xe.tokens.spacingVerticalS)}});function Gr(e){const{onCancel:t}=e,n=zr(),[a,i]=Se.useState("");return Se.createElement("div",{className:n.root},Se.createElement("div",{className:n.inputTitle},Se.createElement("div",null,Se.createElement(jr.Label,{size:"small"},Vr.u1),Se.createElement(Bn.Tooltip,{content:Vr.Lx,relationship:"label"},Se.createElement(jt.Button,{icon:Se.createElement(xa,null),appearance:"transparent",size:"small"}))),Se.createElement(jt.Button,{appearance:"transparent",size:"small",icon:Se.createElement(nt,null),onClick:e=>{t?.()}},Vr.sR)),Se.createElement("div",{className:n.finishedBorder},Se.createElement(or,{className:n.inputContainer},Se.createElement(Ft.Input,{contentBefore:Se.createElement(rt.Caption1Strong,{className:n.label},Vr.YY),contentAfter:Se.createElement(Bn.Tooltip,{content:Vr.ku,relationship:"label"},Se.createElement(jt.Button,{shape:"circular",icon:Se.createElement(Zt,null),appearance:"primary",size:"small",disabled:!a,onClick:t=>{e.onSubmit?.(a)},className:n.submitButton})),value:a,onChange:(e,t)=>{i(t.value)},className:n.input,onBlur:e=>{a||t?.()}}))))}const Kr=Se.createContext(void 0);var Wr,qr,Qr,Yr,Jr,Xr;!function(e){e.File="File",e.Folder="Folder",e.GptDefinition="GptDefinition",e.DocumentLibrary="DocumentLibrary",e.Site="Site",e.WorkingSet="WorkingSet",e.Meeting="Meeting",e.List="List"}(Wr||(Wr={})),function(e){e.User="User",e.System="System"}(qr||(qr={})),function(e){e.None="None",e.File="File",e.People="PeopleInferenceAnswer",e.Chat="Chat",e.Topic="Topic",e.Message="Message",e.Event="Event"}(Qr||(Qr={})),function(e){e.People="People",e.File="File",e.Topic="Topic",e.Event="Event",e.Message="Message",e.Chat="Chat",e.FileUrl="FileUrl"}(Yr||(Yr={})),function(e){e.UserAnnotated="UserAnnotated",e.ClientAnnotated="ClientAnnotated",e.SystemAnnotated="SystemAnnotated"}(Jr||(Jr={})),function(e){e.People="People",e.File="File",e.Topic="Topic",e.Event="Event",e.Message="Message",e.Chat="Chat",e.External="External",e.LocalFile="LocalFile",e.FileUrl="FileUrl",e.Folder="Folder",e.Site="Site",e.Workspace="Workspace",e.Page="Page",e.FileWithImage="FileWithImage"}(Xr||(Xr={}));const Zr="CopilotCreation",$r="----",eo="https://devui.sdf-devui.substrate-turing-enterprisedevui.eastus-sdf.cosmic-ppe.office.net/?variants=UseIc3ForConversationStorage&sourceConversationId=";function to(e,t,n){const a=t?.map(e=>"- "+e).join("; "),i=n?`, write in language: ${n}`:void 0;return t?.length?`Section topic: ${e}, Outline of the section: ${a}${i}`:e}function no(e,t,n){let a="";return t&&n&&(a=`Given the draft title as ${t}, rewrite it in language: ${n}`),`${e}${a}`}const ao="<<<<>>>>",io={sectionTopics:["<section topic 1>","<section topic 2>"]};function ro(e){const t=(0,Z.getBlankTitleWebpart)({...e&&{title:e},layoutType:"CutInShape"});return{id:t.instanceId,controlType:s.CanvasControlType.WebPartZone,webPartId:t.id,position:{zoneIndex:1,sectionIndex:1,controlIndex:1,layoutIndex:s.firstLayoutIndex,sectionFactor:0,zoneId:S.Guid.newGuid().toString()},webPartData:{...t,dataVersion:"1.5",title:s.BANNER_WEB_PART_STRINGS.title,description:s.BANNER_WEB_PART_STRINGS.description}}}function oo(e,t){try{let n=e;if(t){const e=new RegExp(t+"(.*?)"+t);n=n.match(e)?.[1]||n}return JSON.parse(function(e){const t=e.indexOf("{"),n=e.lastIndexOf("}")+1;return e.substring(t,n)}(n))}catch(e){return}}function so(e){if(!A()&&e)return t=>{const n=e.webPartData.properties.aiContextStore?.[t];return n?.userPrompt}}const co=(e,t=[])=>{let n=e.replace(/\[(\d+)\]\((https?:\/\/[^\)]+)\)/g,S._SPKillSwitch.isActivated("23a8ef9b-1c6d-4aef-b704-b9c8dddc44c7")?'<a href="$2">[$1]</a>':"").replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/^[\s\S]*?----|----[\s\S]*$/g,"");return I()||(n=n.replace(/<span\s+data-link-text="([^"]+)">([^<]+)<\/span>/,(e,n,a)=>{for(const e of t)if(e.test(a))return`<a href="${a}">${n}</a>`;return a})),D.SafeHtml.clean(n)},lo=e=>{const t=e.replaceAll("</p><p",'</p><p><br data-cke-filler="true"></p><p');return co(t)},uo=JSON.parse('{"jk":"\\u0022Changing the world begins with a single act of kindness. Let\\u0027s give with love, serve with humility, and inspire others to join us on the journey of making a difference.\\u0022","xT":"Speaker","Xt":"Meeting Participants","F4":"Meeting Recording","w0":"People","rv":"Display selected people and their profiles.","WI":"Stream","Vc":"Display a single video or multiple videos from a folder in OneDrive or SharePoint."}'),fo=["ac0e47ca-30af-452c-bdbb-510b715d0e46","c70391ea-0b10-4ee9-b2b4-006d3fcad0cd","7f718435-ee4d-431c-bdbf-9c4ff326f46e","cbe7b0a9-3504-44dd-a3a3-0e5cacd07788"];function po(e){return fo.includes(e.webPartId)}function mo(e,t,n){(function(e){return"ac0e47ca-30af-452c-bdbb-510b715d0e46"===e.webPartId})(e)&&(t.properties.webId=n.web.id,t.properties.siteId=n.site.id,t.properties.webAbsoluteUrl=n.legacyPageContext.webAbsoluteUrl)}function _o(e){return e.some(e=>e.attachmentType===tn.AttachmentType.Meeting)}function ho(e){return e.some(e=>e.attachmentType===tn.AttachmentType.Meeting&&e.hasRecording)}async function bo(t,n,a,i,r){if(function(e){return"cbe7b0a9-3504-44dd-a3a3-0e5cacd07788"===e.webPartId}(t)){const o=await async function(t,n,a,i,r){try{const o=r.webPartData.properties.title||uo.jk,s=r.webPartData.properties.authors[0].name||uo.xT;let c=await wo(t,a,n,e.Say,i,he.Concise,"Usual",`<blockquote>${o} - ${s}</blockquote>`,()=>{});if(c){L()||(c=c.replace(/[']/g,'"'));const e=go((new DOMParser).parseFromString(co(c),"text/html").body);if(e)return function(e){const t=e.match(/(\"[^"]+\")\s*-\s*(.+)/);return t&&3===t.length?{title:t[1],author:t[2]}:L()?void 0:{title:e,author:""}}(e)}return}catch(e){return}}(n,a,i,r,t),s=t.webPartData;return o&&(s.properties={...s.properties,title:o.title,authorByline:[o.author],authors:[{id:o.author,upn:o.author,email:o.author,name:o.author}]}),s}{const e=[{sectionId:"",controls:[{controlId:t.id,manifestId:t.webPartId,webPartDataTemplateJson:JSON.stringify(t.webPartData)}]}],i=await n.generateWebPartContent({pagePrompt:"",sections:e,dataSources:a,scenarioFunc:"MeetingSeriesNewsPostHandler.getMeetingInfoWebParts"}),r=JSON.parse(i);return r&&r.length>0?r[0]:void 0}}function go(e){if(e.textContent?.match(/\"[^"]+\"/g))return e.textContent.trim();for(const t of Array.from(e.children)){const e=go(t);if(e)return e}}function vo(e,t,n){return[{position:{zoneIndex:n,zoneId:e,sectionIndex:1,controlIndex:1},id:t,controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"ac0e47ca-30af-452c-bdbb-510b715d0e46",instanceId:t,title:uo.WI,description:uo.Vc,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{},links:{baseUrl:""},componentDependencies:{layoutComponentId:"7a834a65-c7a6-4641-9cb7-e6d2724a5df0"}},dataVersion:"1.2",properties:{query:{contentLocation:1,contentTypes:[3],documentTypes:[11],sortType:6},templateId:2,maxItemsPerPage:6,maxRowsPerPageGrid:2,maxRowsPerPageTheater:1,hideWebPartWhenEmpty:!1,isTitleEnabled:!0,file:"",sourceType:"VIDEO",listSortField:"Created",playlistSortField:"Default",isPlaceholderState:!0,layoutId:"Theater",dataProviderId:"StreamVideo"}},webPartId:"ac0e47ca-30af-452c-bdbb-510b715d0e46",reservedWidth:570,reservedHeight:341}]}function yo(e,t,n){return[{position:{zoneIndex:n,zoneId:e,sectionIndex:1,controlIndex:1},emphasis:{zoneEmphasis:3},id:t,controlType:s.CanvasControlType.WebPartZone,isFromSectionTemplate:!1,addedFromPersistedData:!0,webPartData:{id:"7f718435-ee4d-431c-bdbf-9c4ff326f46e",instanceId:t,title:uo.w0,description:uo.rv,audiences:[],serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{title:uo.Xt},imageSources:{},links:{}},dataVersion:"1.5",properties:{layout:1,persons:[]},containsDynamicDataSource:!1},webPartId:"7f718435-ee4d-431c-bdbf-9c4ff326f46e",reservedWidth:1188,reservedHeight:144}]}function So(e,t){return{type:r.Field,text:t,options:{canvasControls:[{id:e,layout:"webpart"}]}}}const Do=e=>!e||void 0===e||""===e;function Io(e,t,n,a){if(Do(e)||Do(t)||Do(n)||Do(a))return;const i=((e,t,n)=>{let a=btoa(e+","+t+","+n);return a=((e,t)=>{let n=e.length;for(;n>0&&"="===e[n-1];)--n;return n<e.length?e.substring(0,n):e})(a),a=a.replace("+","-").replace("/","_"),a})(t,n,a);return`SPO_${i}_${e}`}function xo(e){const t=[];for(const n of e)switch(n.type){case tn.AttachmentType.File:const e=Io(n.sharepointIds.listItemUniqueId||"",n.sharepointIds.siteId||"",n.sharepointIds.webId,n.sharepointIds.listId||"");if(!e)throw new Error("computeVroomId failure");t.push({messageAnnotationType:Yr.File,id:e,text:n.name});break;case tn.AttachmentType.Meeting:t.push({messageAnnotationType:Yr.Event,id:n.id,text:n.name});break;case tn.AttachmentType.MeetingSeries:break;case tn.AttachmentType.Page:t.push({messageAnnotationType:Yr.File,id:n.id,text:n.name});break;case tn.AttachmentType.Site:t.push({messageAnnotationType:"Site",id:n.url,text:n.url})}return t}async function Co(e,t,n,a="Usual"){try{const i=[{sectionId:"",controls:[{controlId:"",controlType:"title",controlPrompt:"",templateHTML:""}]}],r=oo(await e.draftSections(t,n,i,void 0,void 0,void 0,a),$r)?.title;return r}catch(e){return}}async function Oo(e,t,n,a){const i=await e.generateSubtopics(t,n,a);if(i)return oo(i,$r)}async function wo(e,t,n,a,i,r,o,s,c,d){const l=[{sectionId:"",controls:[{controlId:"",controlType:"text",controlPrompt:a,templateHTML:s}]}];return await e.draftSections(t,n,l,c,i,r,o,d)}const Eo=JSON.parse('{"PW":"Generating your page outline...","Lx":"Review your page outline","i6":"Generating page title...","Kv":"Adding Outline...","Hs":"dismiss","o4":"Add new section","MG":"Delete section","g0":"Reorder section"}');function Ao(e){const{onSubmitItem:t,index:n}=e,[a,i]=Se.useState(!1),r=Ur(),o=(()=>{const e=Se.useContext(Kr);if(!e)throw new Error("useOutlineContext value is not provided");return e})(),[s,c]=Se.useState(""),[d,l]=Se.useState(!1),u=function(e,t){return e.length||0!==t?!e||!e.length||t<0||t>e.length?"":0===t?ao+JSON.stringify(e,null,2):t===e.length?JSON.stringify(e,null,2)+ao:JSON.stringify(e.slice(0,t),null,2)+ao+JSON.stringify(e.slice(t),null,2):ao}(o.content?.sections||[],n),{status:f,content:p,abortController:m,trigger:_,error:h}=function(e,t,n,a){const[i,r]=Se.useState(void 0),[o,s]=Se.useState(void 0),[c,d]=Se.useState("NotStarted"),l=Se.useRef(void 0),u=Se.useCallback(()=>{r(void 0),d("Triggered")},[d]),f=ut();return Se.useEffect(()=>{if(void 0===l.current&&"Triggered"===c){const i=S.Guid.newGuid().toString();f.log({id:i,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"Start"}),l.current=new AbortController,l.current?.signal.addEventListener("abort",function e(){l.current?.signal.removeEventListener("abort",e),l.current=void 0,d("Aborted"),f.log({id:i,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"End",payload:{result:"ExpectedFailure",resultCode:"Aborted"}})}),async function(i,o){try{if(!e||!a)throw new Error("Agent is not available");{const c=xo(t);d("InProgress"),a.addOutlineSection({prompt:e,resources:c,context:n},{abortSignal:i.signal,onFinal:e=>{i.signal.aborted||(s(e),d("Completed"),f.log({id:o,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"End",payload:{result:"Success"}}))},onError:e=>{i.signal.aborted||(r(e),d("Completed"),f.log({id:o,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"End",payload:{result:"UnexpectedFailure",resultCode:"AugloopError",error:e,extraData:{attachmentCount:t.length,attachmentInfo:On(t)}}}))}})}}catch(e){r(e),d("Completed"),f.log({id:o,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"End",payload:{result:"UnexpectedFailure",resultCode:"AugloopError",error:e,extraData:{attachmentCount:t.length,attachmentInfo:On(t)}}})}}(l.current,i)}return()=>{"Completed"===c&&l.current&&(l.current=void 0)}},[e,t,a,n,c,f]),Se.useEffect(()=>()=>{l.current&&(l.current.abort(),l.current=void 0)},[]),{trigger:u,status:c,content:o,abortController:l.current,error:i}}(s,o.attachments||[],u,o.client),[b,g]=Se.useState(!0);return Se.useEffect(()=>{"Completed"===f&&p&&(t(p),l(!1))},[f]),Se.createElement(Se.Fragment,null,(!h||!b)&&Se.createElement("div",{className:a||d?r.headline:r.addButtonWrapper},!a&&!d&&Se.createElement(Se.Fragment,null,Se.createElement("div",{className:(0,xe.mergeClasses)(r.divider,Tr)}),Se.createElement(Bn.Tooltip,{content:Eo.o4,relationship:"label"},Se.createElement(jt.Button,{shape:"circular",size:"small",icon:Se.createElement(Br,null),className:(0,xe.mergeClasses)(r.addButton,Tr),appearance:"primary",onClick:t=>{i(!0),e.onAdderExpanded?.(!0)}}))),a&&Se.createElement(Gr,{onCancel:()=>{i(!1),e.onAdderExpanded?.(!1)},onSubmit:t=>{e.onStartGenerating(),g(!0),c(t),i(!1),l(!0),_()}}),d&&Se.createElement(Hr,{isLoading:!0},Se.createElement(Sr,{label:Eo.Kv,onStop:()=>{m?.abort(),l(!1),e.onStopGenerating()},showLogo:!1}))),h&&b&&Se.createElement(cn.MessageBar,{intent:"error",className:(0,xe.mergeClasses)(r.headline,d&&r.errorMessage)},Se.createElement(cn.MessageBarBody,null,h.message),Se.createElement(cn.MessageBarActions,{containerAction:Se.createElement(jt.Button,{icon:Se.createElement(pn,null),"aria-label":Eo.Hs,appearance:"transparent",onClick:()=>{g(!1)}})})))}function Lo(e){const t=Ur(),[n,a]=Se.useState(-1),i=t=>()=>{e.onStartGenerating(t),a(t)},r=()=>{e.onStopGenerating(),a(-1)},o=t=>n=>{a(n?t:-1),e.onAdderExpanded?.(n)};return Se.createElement(Se.Fragment,null,Se.createElement("div",{key:e.index,role:"listitem"},0===e.index&&(!e.disableEdit||0===n)&&Se.createElement(Ao,{index:0,onSubmitItem:t=>{e.onAddItem?.(0,t)},onStartGenerating:i(0),onStopGenerating:r,onAdderExpanded:o(0)}),Se.createElement("div",{"data-drag-tag":Mr.GridLayoutConstants.DRAG_LEAF_TAG,className:t.outlineItem},Se.createElement(Bn.Tooltip,{content:Eo.g0,relationship:"label"},Se.createElement(jt.Button,{disabled:e.disableEdit,appearance:"transparent",icon:Se.createElement(Rr,null),className:(0,xe.mergeClasses)(t.dragButton,Tr),"data-drag-handle":Mr.GridLayoutConstants.DRAG_HANDLE_TAG,size:"small"})),Se.createElement("div",{className:t.outlineItemContent},Se.createElement("div",{className:t.outlineItemHeader},Se.createElement(rt.Subtitle2,null,e.item.title),Se.createElement(Bn.Tooltip,{content:Eo.MG,relationship:"label"},Se.createElement(jt.Button,{disabled:e.disableEdit,appearance:"transparent",icon:Se.createElement(Nr,null),className:(0,xe.mergeClasses)(t.deleteButton,Tr),onClick:t=>{e.onDeleteItem?.(e.index)}}))),Se.createElement("ul",{className:t.contentList},e.item.content.map((e,t)=>Se.createElement("li",{key:t},Se.createElement(rt.Body1,null,e)))))),(!e.disableEdit||n===e.index+1)&&Se.createElement(Ao,{index:e.index+1,onSubmitItem:t=>{e.onAddItem?.(e.index+1,t)},onStartGenerating:i(e.index+1),onStopGenerating:r,onAdderExpanded:o(e.index+1)})))}const ko=(0,xe.makeStyles)({select:{minWidth:"190px",[gt]:{margin:`${xe.tokens.spacingVerticalS} 0 ${xe.tokens.spacingVerticalL}`}},label:{display:"block"}});function Mo(e){const t=(0,xe.useId)(),n=ko();return Se.createElement("div",null,!e.useTooltip&&Se.createElement(jr.Label,{htmlFor:t,className:n.label},e.label),Se.createElement(Po,{useTooltip:e.useTooltip,content:e.label},Se.createElement(na.Dropdown,{id:t,onOptionSelect:(t,n)=>e.onChange?.(n.optionText),defaultValue:e.defaultValue,defaultSelectedOptions:e.defaultValue?[e.defaultValue]:void 0,appearance:"filled-darker",root:{className:n.select}},e.options.map(e=>Se.createElement(na.Option,{value:e.value,key:e.key,text:e.value},e.value)))))}function Po(e){return e.useTooltip?Se.createElement(Bn.Tooltip,{content:e.content,relationship:"label"},e.children):Se.createElement(Se.Fragment,null,e.children)}const To=JSON.parse('{"Arabic":"Arabic","Azerbaijani":"Azerbaijani (Latin)","Bosnian":"Bosnian","Bulgarian":"Bulgarian","Catalan":"Catalan","Czech":"Czech","Welsh":"Welsh","Danish":"Danish","German":"German","Greek":"Greek","English":"English","Spanish":"Spanish","Estonian":"Estonian","Basque":"Basque","Finnish":"Finnish","French":"French","Irish":"Irish","Galician":"Galician","Hebrew":"Hebrew","Hindi":"Hindi","Croatian":"Croatian","Hungarian":"Hungarian","Indonesian":"Indonesian","Italian":"Italian","Japanese":"Japanese","Kazakh":"Kazakh","Korean":"Korean","Lithuanian":"Lithuanian","Latvian":"Latvian","Macedonian":"Macedonian","Malay":"Malay","Norwegian":"Norwegian","Dutch":"Dutch","Polish":"Polish","Dari":"Dari","Portuguese":"Portuguese","PortugueseBR":"Portuguese (Brazil)","PortuguesePT":"Portuguese (Portugal)","Romanian":"Romanian","Russian":"Russian","Slovak":"Slovak","Slovene":"Slovene","SerbianCRS":"Serbian (Cyrillic)","SerbianLCS":"Serbian (Latin)","Swedish":"Swedish","Thai":"Thai","Turkish":"Turkish","Ukrainian":"Ukrainian","Vietnamese":"Vietnamese","ChineseCN":"Chinese (Simplified)","ChineseTW":"Chinese (Traditional)"}');var Uo=To?{"ar-sa":{resource:To.Arabic,name:"",code:1025},"az-latn-az":{resource:To.Azerbaijani,name:" ",code:1068},"bg-bg":{resource:To.Bulgarian,name:" ",code:1026},"bs-latn-ba":{resource:To.Bosnian,name:"Bosanski",code:5146},"ca-es":{resource:To.Catalan,name:"Catal",code:1027},"cs-cz":{resource:To.Czech,name:"esk Jazyk",code:1029},"cy-gb":{resource:To.Welsh,name:"Cymraeg",code:1106},"da-dk":{resource:To.Danish,name:"Dansk",code:1030},"de-de":{resource:To.German,name:"Deutsche",code:1031},"el-gr":{resource:To.Greek,name:"",code:1032},"en-us":{resource:To.English,name:"English",code:1033},"es-es":{resource:To.Spanish,name:"Espaol",code:3082},"et-ee":{resource:To.Estonian,name:"Eesti",code:1061},"eu-es":{resource:To.Basque,name:"Euskara",code:1069},"fi-fi":{resource:To.Finnish,name:"Suomi",code:1035},"fr-fr":{resource:To.French,name:"Franais",code:1036},"ga-ie":{resource:To.Irish,name:"Gaeilge",code:2108},"gl-es":{resource:To.Galician,name:"Galego",code:1110},"he-il":{resource:To.Hebrew,name:"",code:1037},"hi-in":{resource:To.Hindi,name:"",code:1081},"hr-hr":{resource:To.Croatian,name:"Hrvatski",code:1050},"hu-hu":{resource:To.Hungarian,name:"Magyar",code:1038},"id-id":{resource:To.Indonesian,name:"Bahasa Indonesia",code:1057},"it-it":{resource:To.Italian,name:"Italiano",code:1040},"ja-jp":{resource:To.Japanese,name:"",code:1041},"kk-kz":{resource:To.Kazakh,name:" T",code:1087},"ko-kr":{resource:To.Korean,name:", ",code:1042},"lt-lt":{resource:To.Lithuanian,name:"Lietuvi",code:1063},"lv-lv":{resource:To.Latvian,name:"Latvieu",code:1062},"mk-mk":{resource:To.Macedonian,name:"M",code:1071},"ms-my":{resource:To.Malay,name:"Bahasa Melayu",code:1086},"nb-no":{resource:To.Norwegian,name:"Norsk",code:1044},"nl-nl":{resource:To.Dutch,name:"Nederlands",code:1043},"pl-pl":{resource:To.Polish,name:"Polski",code:1045},"prs-af":{resource:To.Dari,name:"",code:1164},"pt-br":{resource:To.PortugueseBR,name:"Portugus Brasil",code:1046},"pt-pt":{resource:To.PortuguesePT,name:"Portugus",code:2070},"ro-ro":{resource:To.Romanian,name:"Romn",code:1048},"ru-ru":{resource:To.Russian,name:"",code:1049},"sk-sk":{resource:To.Slovak,name:"Slovenina",code:1051},"sl-si":{resource:To.Slovene,name:"Slovenina",code:1060},"sr-cyrl-rs":{resource:To.SerbianCRS,name:"",code:10266},"sr-latn-cs":{resource:To.SerbianLCS,name:"Srpski",code:2074},"sr-latn-rs":{resource:To.SerbianLCS,name:"Srpski",code:9242},"sv-se":{resource:To.Swedish,name:"Svenska",code:1053},"th-th":{resource:To.Thai,name:"",code:1054},"tr-tr":{resource:To.Turkish,name:"Trke",code:1055},"uk-ua":{resource:To.Ukrainian,name:"",code:1058},"vi-vn":{resource:To.Vietnamese,name:"Ting Vit Nam",code:1066},"zh-cn":{resource:To.ChineseCN,name:"",code:2052},"zh-tw":{resource:To.ChineseTW,name:"",code:1028}}:{},Fo=To?{pt:To.Portuguese}:{},Ho=To?{1025:{resource:To.Arabic,languageCode:"ar-sa"},1068:{resource:To.Azerbaijani,languageCode:"az-latn-az"},1026:{resource:To.Bulgarian,languageCode:"bg-bg"},5146:{resource:To.Bosnian,languageCode:"bs-latn-ba"},1027:{resource:To.Catalan,languageCode:"ca-es"},1029:{resource:To.Czech,languageCode:"cs-cz"},1106:{resource:To.Welsh,languageCode:"cy-gb"},1030:{resource:To.Danish,languageCode:"da-dk"},1031:{resource:To.German,languageCode:"de-de"},1032:{resource:To.Greek,languageCode:"el-gr"},1033:{resource:To.English,languageCode:"en-us"},3082:{resource:To.Spanish,languageCode:"es-es"},1061:{resource:To.Estonian,languageCode:"et-ee"},1069:{resource:To.Basque,languageCode:"eu-es"},1035:{resource:To.Finnish,languageCode:"fi-fi"},1036:{resource:To.French,languageCode:"fr-fr"},2108:{resource:To.Irish,languageCode:"ga-ie"},1110:{resource:To.Galician,languageCode:"gl-es"},1037:{resource:To.Hebrew,languageCode:"he-il"},1081:{resource:To.Hindi,languageCode:"hi-in"},1050:{resource:To.Croatian,languageCode:"hr-hr"},1038:{resource:To.Hungarian,languageCode:"hu-hu"},1057:{resource:To.Indonesian,languageCode:"id-id"},1040:{resource:To.Italian,languageCode:"it-it"},1041:{resource:To.Japanese,languageCode:"ja-jp"},1087:{resource:To.Kazakh,languageCode:"kk-kz"},1042:{resource:To.Korean,languageCode:"ko-kr"},1063:{resource:To.Lithuanian,languageCode:"lt-lt"},1062:{resource:To.Latvian,languageCode:"lv-lv"},1071:{resource:To.Macedonian,languageCode:"mk-mk"},1086:{resource:To.Malay,languageCode:"ms-my"},1044:{resource:To.Norwegian,languageCode:"nb-no"},1043:{resource:To.Dutch,languageCode:"nl-nl"},1045:{resource:To.Polish,languageCode:"pl-pl"},1164:{resource:To.Dari,languageCode:"prs-af"},1046:{resource:To.PortugueseBR,languageCode:"pt-br"},2070:{resource:To.PortuguesePT,languageCode:"pt-pt"},1048:{resource:To.Romanian,languageCode:"ro-ro"},1049:{resource:To.Russian,languageCode:"ru-ru"},1051:{resource:To.Slovak,languageCode:"sk-sk"},1060:{resource:To.Slovene,languageCode:"sl-si"},10266:{resource:To.SerbianCRS,languageCode:"sr-cyrl-rs"},2074:{resource:To.SerbianLCS,languageCode:"sr-latn-cs"},9242:{resource:To.SerbianLCS,languageCode:"sr-latn-rs"},1053:{resource:To.Swedish,languageCode:"sv-se"},1054:{resource:To.Thai,languageCode:"th-th"},1055:{resource:To.Turkish,languageCode:"tr-tr"},1058:{resource:To.Ukrainian,languageCode:"uk-ua"},1066:{resource:To.Vietnamese,languageCode:"vi-vn"},2052:{resource:To.ChineseCN,languageCode:"zh-cn"},1028:{resource:To.ChineseTW,languageCode:"zh-tw"}}:{},Ro=function(){function e(){}return e.getName=function(t){var n=e._getLanguageName(t);return n&&n.name||""},e.getLocalizedName=function(t){var n=e._getLanguageName(t);return n&&n.resource||""},e.getCode=function(t){var n=e._getLanguageName(t);return n&&n.code},e.getLanguageByCode=function(e){var t;return(null===(t=Ho[e])||void 0===t?void 0:t.languageCode)||""},e.getLanguagesByPrefix=function(e){if(!e)return[];var t=[];return Object.keys(Uo).forEach(function(n){n.startsWith(e.toLowerCase())&&t.push(Ho[Uo[n].code])}),t},e.getResourceByCode=function(e){var t;return(null===(t=Ho[e])||void 0===t?void 0:t.resource)||""},e.getSharePointLanguageNames=function(){return Uo},e.getSharePointLanguageKeys=function(){return Object.keys(Uo)},e.getLocalizedNameWithoutLocale=function(e){return Fo[e.toLowerCase()]||""},e.getInstalledLanguages=function(e,t){var n=2074,a=9242,i=[];t===a?i.push(n):t===n||e.indexOf(n)>-1&&-1===e.indexOf(a)?i.push(a):i.push(n);var r=(0,Ke.__assign)({},Ho);return i.forEach(function(e){delete r[e]}),r},e.getLanguagesByCode=function(){return Ho},e._getLanguageName=function(e){var t=e.toLowerCase();return Uo[t]},e}();const No=JSON.parse('{"eT":"Length","A8":"Concise","fQ":"Longer","hF":"Medium","fL":"Tone","l0":"Professional","m3":"Casual","zr":"Enthusiastic","P5":"Engaging","FW":"Creative","Vb":"Page language"}'),Bo=[1068,5146,1069,2108,1110,1081,1087,1071,1164,2074],jo=Object.values(Ro.getSharePointLanguageNames()).filter(e=>-1===Bo.indexOf(e.code)).map(e=>({key:e.name,value:e.resource})),Vo=Ro.getLocalizedName("en-us"),zo=[{key:he.Concise,value:No.A8},{key:he.Medium,value:No.hF},{key:he.Longer,value:No.fQ}],Go=[{key:_e.Creative,value:No.FW},{key:_e.Professional,value:No.l0},{key:_e.Casual,value:No.m3},{key:_e.Engaging,value:No.P5},{key:_e.Enthusiastic,value:No.zr}],Ko={tone:_e.Professional,length:he.Medium,language:Vo},Wo=(0,xe.makeStyles)({root:{[vt]:{display:"flex",gap:xe.tokens.spacingVerticalM,flexWrap:"wrap"},paddingTop:xe.tokens.spacingVerticalM}});function qo(e){const t=Se.useRef(e.defaultSetting||Ko),n=e.defaultSetting||Ko,a=Wo(),[i,r]=Se.useState(window.innerWidth<=772);return Se.useEffect(()=>{let e=window.innerWidth<=772;const t=new ResizeObserver((0,si.debounce)(()=>{const t=window.innerWidth<=772;t!==e&&(e=t,r(t))},200));return t.observe(document.body),()=>{t.disconnect()}},[]),Se.createElement("div",{className:a.root},Se.createElement(Mo,{label:No.fL,options:Go,defaultValue:n.tone,useTooltip:i,onChange:n=>{t.current.tone=n,e.onChangeSettings(t.current)}}),Se.createElement(Mo,{label:No.eT,options:zo,defaultValue:n.length,useTooltip:i,onChange:n=>{t.current.length=n,e.onChangeSettings(t.current)}}),Se.createElement(Mo,{label:No.Vb,defaultValue:n.language,options:jo,useTooltip:i,onChange:n=>{t.current.language=n,e.onChangeSettings(t.current)}}))}const Qo="copilotPageGenerationConversationId";function Yo(e){window.sessionStorage.setItem("copilotPageGenerationUserPrompt",e),window.sessionStorage.setItem(Qo,""),window.sessionStorage.setItem("copilotPageGenerationStartTime",Date.now().toString())}function Jo(e){window.sessionStorage.setItem(Qo,e),window.sessionStorage.setItem("copilotPageGenerationEndTime",Date.now().toString())}function Xo(){try{return!!S._SPFlight.isDebugFlightEnabled&&(S._SPFlight.isEnabled(61044)||"true"===window.sessionStorage.getItem("sp-authoring-copilot-monitoring"))}catch(e){return!1}}function Zo(e){const t=Ur(),[n,a]=Se.useState([]),[i,r]=Se.useState(!0),[o,s]=Se.useState(!0),c=(0,Pr.usePageBuilderClient)(e.pageContext.legacyPageContext),{title:d,content:l,statusMessage:u,abortController:f,stage:p,error:m}=function(e,t,n,a,i){const[r,o]=Se.useState(void 0),[s,c]=Se.useState([]),[d,l]=Se.useState(void 0),[u,f]=Se.useState("NotStarted"),[p,m]=Se.useState(),_=Se.useRef(void 0),h=ut();return Se.useEffect(()=>{if(void 0===_.current){const e=S.Guid.newGuid().toString();h.log({id:e,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Generate",stage:"Start"}),_.current=new AbortController,_.current?.signal.addEventListener("abort",function n(){_.current?.signal.removeEventListener("abort",n),_.current=void 0,l(void 0),f("Aborted"),h.log({id:e,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Generate",stage:"End",payload:{result:"ExpectedFailure",resultCode:"Aborted",extraData:{attachmentCount:t.length,attachmentInfo:On(t)}}})}),async function(e,r){try{if(!i)throw new Error("Client is not available");{l(Eo.i6),f("InProgress");const s=xo(t);if(function(){const e="true"===new URLSearchParams(window.location.search).get("mockData");return S._SPFlight.isDebugFlightEnabled&&e}()){o("BotSpeak"),l(Eo.Kv);const e=await(await ce.e(794).then(ce.bind(ce,1004))).mockOutline;c(e),l(void 0),f("Completed")}else{const d=n=>{e?.signal.aborted||(m(n),l(void 0),f("Completed"),h.log({id:r,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Generate",stage:"End",payload:{result:"UnexpectedFailure",resultCode:"AugloopError",error:n,extraData:{attachmentCount:t.length,attachmentInfo:On(t),conversationId:i.conversationId}}}))},u=t=>{e?.signal.aborted||(t.key===Pr.pageTitlePropertyName?(o(t.value),l(Eo.Kv)):c(e=>{const n=[...e];return n[t.key]=t.value,n}))},p=t=>{e?.signal.aborted||(o(t[Pr.pageTitlePropertyName]),c(t.pageOutline),l(void 0),f("Completed"),h.log({id:r,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Generate",stage:"End",payload:{result:"Success"}}))};i.generateOutline({prompt:n,resources:s,authoringOptions:{fidelity:a}},{abortSignal:e.signal,onError:d,onStreaming:u,onFinal:p})}}}catch(e){m(e),l(void 0),f("Completed"),h.log({id:r,operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Generate",stage:"End",payload:{result:"UnexpectedFailure",resultCode:"AugloopError",error:e,extraData:{attachmentCount:t.length,attachmentInfo:On(t)}}})}}(_.current,e)}return()=>{_.current&&!_.current.signal.aborted&&(_.current.abort(),_.current=void 0)}},[e,t,n,i,h]),Se.useEffect(()=>()=>{_.current&&!_.current.signal.aborted&&(_.current.abort(),_.current=void 0)},[]),{statusMessage:d,stage:u,title:r,content:s,error:p,abortController:_.current}}(e.pageContext,e.attachments,e.prompt,e.fidelity,c),_=ut(),h=Se.useRef("");Se.useEffect(()=>{a(l),"Completed"!==p&&"Aborted"!==p||(r(!1),e.onOutlineUpdated({title:d??"",sections:l??[]}),h.current=c?.conversationId)},[d,p,l]);const b=t=>{const i=[...n];i.splice(t,1),a(i),e.onOutlineUpdated({title:d??"",sections:i}),_.log({id:h.current||S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Delete",stage:"Trigger"})},g=(t,i)=>{const o=Array.from(n);o.splice(t,0,i),a(o),r(!1),e.onOutlineUpdated({title:d??"",sections:o}),_.log({id:h.current||S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add",stage:"Trigger"})},v=e=>{r(e)},y=Se.createElement(it,null);return Se.createElement(Se.Fragment,null,Xo()&&Se.createElement(jt.Button,{icon:Se.createElement(Xt,null),className:t.debugButton,onClick:()=>{h.current&&window.open(`${eo}${h.current}`,"_blank","noopener,noreferrer")}}),Se.createElement(Kr.Provider,{value:{client:c,content:{title:d||"",sections:n}}},Se.createElement("div",{className:t.root},Se.createElement("div",{className:t.draftContainer},Se.createElement("div",{className:(0,xe.mergeClasses)(t.header,t.headline)},y,Se.createElement(rt.Subtitle2,{role:"heading","aria-level":2,className:t.title},"InProgress"===p?Eo.PW:Eo.Lx)),!!d&&Se.createElement(rt.Title3,{role:"heading","aria-level":3,className:t.headline},d),0===n.length&&!!d&&"NotStarted"!==p&&Se.createElement("div",{role:"list",className:t.list},Se.createElement("div",{role:"listitem",className:t.listItem},Se.createElement(Ao,{index:0,onSubmitItem:e=>{g(0,e)},onStartGenerating:()=>{r(!0),e.onGenerateSectionStarted()},onStopGenerating:()=>{r(!1),e.onStopGenerating()}}))),0!==n.length&&Se.createElement(Mr.SortableList,{onReorderItem:(t,i)=>{if(void 0===t||void 0===i||t<0||i<0||t>=n.length||i>=n.length)return;if(t===i)return;const r=[...n],[o]=r.splice(t,1);r.splice(i,0,o),a(r),e.onOutlineUpdated({title:d??"",sections:r}),_.log({id:h.current||S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Reorder",stage:"Trigger"})},displayMode:S.DisplayMode.Edit,className:t.list},n.map((t,n)=>Se.createElement(Lo,{item:t,index:n,onDeleteItem:b,onAddItem:g,key:n,disableEdit:i,onStartGenerating:()=>{r(!0),e.onGenerateSectionStarted()},onStopGenerating:()=>{r(!1),e.onStopGenerating()},onAdderExpanded:v}))),u&&Se.createElement(Hr,{isLoading:!0,className:t.statusBar},Se.createElement(Sr,{label:u,onStop:()=>{f?.abort()},showLogo:!1})),o&&m&&Se.createElement(cn.MessageBar,{intent:"error",className:(0,xe.mergeClasses)(t.statusBar,n.length>0&&t.outlineError)},Se.createElement(cn.MessageBarBody,null,m.message),Se.createElement(cn.MessageBarActions,{containerAction:Se.createElement(jt.Button,{icon:Se.createElement(pn,null),"aria-label":Eo.Hs,appearance:"transparent",onClick:()=>{s(!1)}})}))),Se.createElement(qo,{onChangeSettings:e.onSettingsChanged,defaultSetting:e.defaultSettings}))))}const $o=tt("EditRegular","1em",["M17.18 2.93a2.97 2.97 0 0 0-4.26-.06l-9.37 9.38c-.33.33-.56.74-.66 1.2l-.88 3.94a.5.5 0 0 0 .6.6l3.93-.87c.46-.1.9-.34 1.23-.68l9.36-9.36a2.97 2.97 0 0 0 .05-4.15Zm-3.55.65a1.97 1.97 0 1 1 2.8 2.8l-.68.66-2.8-2.79.68-.67Zm-1.38 1.38 2.8 2.8-7.99 7.97c-.2.2-.46.35-.74.41l-3.16.7.7-3.18c.07-.27.2-.51.4-.7l8-8Z"]),es=tt("FlagRegular","1em",["M5 13h11.5a.5.5 0 0 0 .42-.78L14.1 8l2.82-4.22A.5.5 0 0 0 16.5 3h-12a.5.5 0 0 0-.5.5v14a.5.5 0 0 0 1 0V13Zm0-1V4h10.57l-2.49 3.72a.5.5 0 0 0 0 .56L15.57 12H5Z"]),ts=(0,xe.makeStyles)({editor:{padding:"var(--spacingVerticalL) var(--spacingHorizontalL)",backgroundColor:"var(--colorNeutralBackground1)",borderRadius:"var(--spacingVerticalXL) var(--spacingHorizontalXL)"},editorBoxShadowLight:{boxShadow:"0px 24px 32px 0px rgba(199, 222, 239, 0.60), 0px 2px 8px 0px rgba(172, 228, 240, 0.60)"},editorBoxShadowDark:{boxShadow:"0px 32px 64px 0px rgba(0, 0, 0, 0.24), 0px 0px 8px 0px rgba(0, 0, 0, 0.2)"},editorContainer:{display:"flex",alignItems:"center",gap:"4px",minHeight:"var(--lineHeightBase300)",maxHeight:"calc(4 * var(--lineHeightBase300))",overflow:"auto"},promptInput:{...!S._SPKillSwitch.isActivated("2f8e4d91-3c7b-4a29-9e2f-6b5c8d4f7e9a")&&{maxHeight:"calc(4 * var(--lineHeightBase300))"},flexGrow:1},editorFooter:{display:"flex",flexDirection:"row",alignItems:"flex-end",marginTop:"var(--spacingVerticalXL)",[yt]:{flexDirection:"row",alignItems:"flex-end"},[St]:{flexDirection:"column",alignItems:"flex-start"}},attachments:{flex:1,minWidth:"0"},messageBar:{marginTop:xe.tokens.spacingVerticalS,border:"unset",background:"transparent"},viewContent:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},viewEditBoxContainer:{display:"flex",alignContent:"center",maxWidth:"calc(100% - 36px)"},viewEditBox:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},attachmentsTag:{verticalAlign:"middle",marginLeft:xe.tokens.spacingVerticalL,color:xe.tokens.colorNeutralForeground2,backgroundColor:xe.tokens.colorNeutralBackground3},editorActions:{display:"flex",flexDirection:"row",alignItems:"center",gap:xe.tokens.spacingVerticalS,height:"40px",[St]:{width:"100%",justifyContent:"flex-end"}},submitButton:{margin:xe.tokens.spacingVerticalS},divider:{[St]:{flexGrow:0}}}),ns=JSON.parse('{"am":"Submit","t3":"Editing your prompt will generate a new outline.","tG":"Cancel editing","bx":"Edit prompt"}'),as=(0,xe.makeStyles)({attachment:{display:"flex",alignItems:"center"},attachmentName:{marginLeft:"4px"},surface:{padding:"2px"},groupLabel:{fontSize:xe.tokens.fontSizeBase200,fontWeight:xe.tokens.fontWeightBold,lineHeight:xe.tokens.lineHeightBase200,padding:xe.tokens.spacingVerticalS,color:xe.tokens.colorNeutralForeground3}});function is(e){const t=as();return Se.createElement(Zn.Popover,{onOpenChange:(t,n)=>{e.onOpenChange?.(n.open)},positioning:"below-start",closeOnScroll:!0},Se.createElement(Zn.PopoverTrigger,{disableButtonEnhancement:!0},Se.createElement(Qn.InteractionTag,{size:"small",className:e.className},Se.createElement(Qn.InteractionTagPrimary,{icon:Se.createElement(en,null)},e.attachments.length))),Se.createElement(Zn.PopoverSurface,{className:t.surface},Se.createElement("div",{role:"group","aria-label":Yn.qs},Se.createElement("div",{className:t.groupLabel},Yn.qs),e.attachments.map(n=>{const a=n.name||"";return Se.createElement(na.Option,{text:n.name,key:n.id,value:n.id,checkIcon:null,onClick:()=>{e.onAttachmentClick?.(n)}},Se.createElement("div",{className:t.attachment},Se.createElement(tn.AttachmentsIcon,{size:tn.AttachmentIconSize.Large,attachment:n}),Se.createElement("div",{className:t.attachmentName},Se.createElement(rt.Body1,null,a))))}))))}const rs=e=>({template:e===_.Page?Fa.p4:Fa.rV,tokens:[{type:r.Field,text:"",placeholder:Fa.o_}]});function os(e){const{selectedCategory:t,defaultPromptText:n,forwardedRef:a}=e,i=ts(),[r,o]=Se.useState(rs(t)),[s,c]=Se.useState(""),d=Se.useRef(!0),[l,u]=Se.useState("Edit"),{theme:f}=(0,ze.useCustomizationSettings)(["theme"]),p=f.isInverted,m=ut(),{internalAttachments:_,removeAttachment:h,addAttachment:b,checkSensitivity:g,loadingAttachmentCount:v,setAttachments:y}=(0,tn.useAttachments)({serviceScope:e.serviceScope,multiSelection:!0,defaultAttachments:[]}),[D,I]=Se.useState({isSensitiveBarVisible:!1,isHighlySensitiveBarVisible:!1}),{backup:C,restore:O}=function(){const e=De().useRef(void 0);return{backup:De().useCallback(t=>{e.current={prompt:t.prompt,promptString:t.promptString,attachments:[...t.attachments]}},[]),restore:De().useCallback(()=>{const t=e.current;return e.current=void 0,t},[]),hasBackup:De().useCallback(()=>void 0!==e.current,[]),clearBackup:De().useCallback(()=>{e.current=void 0},[])}}();Se.useEffect(()=>{o(rs(t)),d.current=!0},[t]),Se.useEffect(()=>{!x()&&n&&(o({template:n,tokens:[]}),c(n),d.current=!1)},[n]),Se.useEffect(()=>{if(e.siteSensitiveLabel&&0===v){const t=g();I(t),e.onSensitivityLabelChange?.(t)}},[_,e.siteSensitiveLabel,v]);const w=Se.useCallback(e=>{c(e),d.current=!e.trim(),d.current&&m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.FreePromptEditor.Edit",stage:"Trigger"})},[m]),E=Se.useCallback(e=>{let t="";switch(e.type){case tn.AttachmentType.File:t="File";const n=e;window.open(n.sharepointIds.webUrl,"_blank");break;case tn.AttachmentType.Page:t="Page";const a=e;window.open(a.url,"_blank");break;case tn.AttachmentType.Site:t="Site";const i=e;window.open(i.url,"_blank")}m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.AttachmentsTag.Click",stage:"Trigger",payload:{attachmentInfo:t}})},[m]);return Se.createElement(Se.Fragment,null,Se.createElement("div",{className:(0,xe.mergeClasses)(i.editor,p?i.editorBoxShadowDark:i.editorBoxShadowLight,e.className),ref:a},(!e.enableViewMode||"Edit"===l)&&Se.createElement(Se.Fragment,null,Se.createElement("div",{className:i.editorContainer},Se.createElement(ka,{prompt:r,onPromptStringChange:w,className:i.promptInput})),Se.createElement("div",{className:i.editorFooter},Se.createElement("div",{className:i.attachments},Se.createElement(tn.Attachments,{serviceScope:e.serviceScope,attachments:_,size:"large",decoration:"border",onAttachmentSelect:e=>{if(b(e),d.current){const n=Wa(t,e.type);o({...n}),c(n.template),d.current=!1}m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.Attachment.Select",stage:"Trigger"})},onAttachmentRemove:e=>{h(e),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.Attachment.Remove",stage:"Trigger"})},displayTabs:[tn.AttachmentPickerTabs.All,tn.AttachmentPickerTabs.Files,tn.AttachmentPickerTabs.Meetings,...Tn()?[tn.AttachmentPickerTabs.Sites]:[]]})),Se.createElement("div",{className:i.editorActions},Pn()&&Se.createElement(Sa,{onCheckedValueChange:e.onFidelityOptionChange,selectedFidelity:e.selectedFidelity,serviceScope:e.serviceScope,disable:!Cn(_)}),Se.createElement(Na,{onSuggestionSelected:e=>{const t=S.Text.format(e.template,...e.tokens.map(e=>e.placeholder)),n={template:t,tokens:[]};c(t),o(n),d.current=!1,m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Select",stage:"Trigger"})},onRefreshSuggestions:()=>{m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Refresh",stage:"Trigger"})},onSuggestionMenuOpenChanged:e=>{m.log({id:S.Guid.newGuid().toString(),operation:e?"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Open":"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Close",stage:"Trigger"})}}),Se.createElement(Vt.Divider,{className:i.divider,vertical:!0}),Se.createElement(Bn.Tooltip,{content:ns.am,relationship:"label"},Se.createElement(jt.Button,{appearance:"primary",shape:"circular",size:"small",icon:Se.createElement($t,null),"aria-label":ns.am,className:i.submitButton,onClick:t=>{e.onUpdateAttachments?.(_),e.onSubmit(s),u("View")},disabled:!s&&0===_.length||0!==v||D.isHighlySensitiveBarVisible}))))),e.enableViewMode&&"View"===l&&Se.createElement(Se.Fragment,null,Se.createElement("div",{className:i.viewContent},Se.createElement("div",{className:i.viewEditBoxContainer},Se.createElement(rt.Body2,{className:i.viewEditBox},s),Boolean(_.length)&&Se.createElement(is,{attachments:_,className:i.attachmentsTag,onAttachmentClick:S._SPKillSwitch.isActivated("b8c0f6d2-1a3e-4f5c-9b7d-8f0e1c2d3e4f")?void 0:E})),Se.createElement(Bn.Tooltip,{content:ns.bx,relationship:"label"},Se.createElement(jt.Button,{appearance:"transparent",icon:Se.createElement($o,null),size:"small",onClick:()=>{C({prompt:r,promptString:s,attachments:_}),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.EditButton.Click",stage:"Trigger"}),u("Edit"),o({template:s,tokens:[]})}})))),D.isSensitiveBarVisible&&(!e.enableViewMode||"Edit"===l)&&Se.createElement(vn,{isContainHighlyConfidential:D.isHighlySensitiveBarVisible,highestLevelLabelFileCount:D.highestLevelLabelFileCount})),e.enableViewMode&&"Edit"===l&&Se.createElement(cn.MessageBar,{className:i.messageBar,layout:"singleline"},Se.createElement(cn.MessageBarBody,null,ns.t3),Se.createElement(cn.MessageBarActions,null,Se.createElement(jt.Button,{onClick:()=>{const e=O();e&&(o(e.prompt),c(e.promptString),y(e.attachments),d.current=!e.promptString.trim()),m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PromptEditorBox.CancelButton.Click",stage:"Trigger"}),u("View")}},ns.tG))))}const ss=JSON.parse('{"FI":"What\\u0027s your page about?","lc":"Back","fv":"Create","q$":"Start from a template"}'),cs=(0,xe.makeStyles)({root:{flex:"auto",overflowY:"auto",scrollbarWidth:"thin"},tabListContainer:{position:"absolute",top:"16px",left:"0",right:"0",margin:"0 80px",zIndex:2,display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},content:{display:"flex",flexDirection:"column",justifyContent:"center",gap:xe.tokens.spacingVerticalXL,"[data-show-outline='false']":{alignItems:"center",height:"100%",padding:`0 ${xe.tokens.spacingVerticalL}`},"[data-show-outline='true']":{padding:"0 100px 48px","@media screen and (max-width: 1024px)":{padding:`0 ${xe.tokens.spacingVerticalL} 20px`}}},editorWrapper:{width:"100%",":global([data-show-outline='false'])":{maxWidth:"750px",marginBottom:"25px"}},outlineEditor:{borderRadius:"var(--spacingVerticalM) var(--spacingHorizontalM)",boxShadow:xe.tokens.shadow4},headingContainer:{display:"flex",alignItems:"center",gap:xe.tokens.spacingHorizontalL,marginBottom:xe.tokens.spacingVerticalXXXL},footer:{boxSizing:"border-box",flex:"none",width:"100%",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",padding:"var(--spacingVerticalXXL) var(--spacingVerticalXXXL) var(--spacingVerticalXXXL) var(--spacingVerticalXXXL)"},footerBorder:{borderTop:`1px solid ${xe.tokens.colorNeutralStroke1}`,backgroundColor:xe.tokens.colorNeutralBackground1,justifyContent:"space-between"},createWrapper:{display:"flex",alignItems:"center"}});function ds(e){const{serviceScope:t,selectedTemplate:n,defaultPromptText:a,defaultTemplateCategory:i,onGoBack:r}=e,[o,s]=Se.useState(!1),[c,d]=Se.useState(!1),l=cs(),u=Se.useRef({checked:!1}),[f,p]=Se.useState(!0),[m,h]=Se.useState(!1),[b,g]=Se.useState(0),[v,y]=Se.useState(void 0),D=Se.useRef(""),I=Se.useRef([]),C=Se.useRef(),O=Se.useRef(Ko),[w,E]=Se.useState(()=>x()||void 0===i?n?.category||_.NewsPost:i),A=Se.useRef(null),L=Se.useRef(null),k=!D.current||m||f||!C.current?.sections.length,M=ut();Se.useEffect(()=>{if(!o||!A.current||!L.current)return;const t=A.current,n={root:L.current,rootMargin:"0px",threshold:[1]},a=new IntersectionObserver(t=>{const[n]=t,a=1===n.intersectionRatio;e.onShowNormalHeader(!a)},n);return a.observe(t),()=>{a.unobserve(t),a.disconnect()}},[o]);const P=Se.useCallback(e=>{E(e),M.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.Category.Select",stage:"Trigger",payload:{category:e}})},[M]);return Se.createElement(Se.Fragment,null,Se.createElement("div",{className:l.root,ref:L},!o&&Se.createElement("div",{className:l.tabListContainer},Se.createElement(ht,{selectedCategory:w,onCategoryTabSelect:P})),Se.createElement("div",{className:l.content,"data-show-outline":o},Se.createElement("div",{className:l.editorWrapper},!o&&Se.createElement("div",{className:l.headingContainer},Se.createElement(rt.Subtitle1,{role:"heading","aria-level":1},ss.FI)),Se.createElement(os,{className:o?l.outlineEditor:void 0,selectedCategory:w,selectedFidelity:v,serviceScope:e.serviceScope,siteSensitiveLabel:e.siteSensitiveLabel,forwardedRef:A,enableViewMode:o,onSubmit:e=>{M.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.PromptEditor.Submit",stage:"Trigger",payload:{attachments:I.current,pageTemplateCategory:w,fidelity:Pn()&&Cn(I.current)?v||"Usual":void 0,regenerationCount:b}}),D.current=e,C.current=void 0,h(!0),g(e=>e+1),s(!0)},onSensitivityLabelChange:e=>{p(e.isHighlySensitiveBarVisible),h(!1)},onUpdateAttachments:e=>{I.current=e},onFidelityOptionChange:e=>{y(e)},defaultPromptText:x()?void 0:a})),o&&Se.createElement(Zo,{key:b,prompt:D.current,fidelity:v,attachments:I.current,defaultSettings:O.current,pageContext:e.serviceScope.consume(wn.PageContext.serviceKey),onOutlineUpdated:e=>{h(!1),C.current=e},onSettingsChanged:e=>{O.current=e},onStopGenerating:e=>{h(!1),e&&(C.current=e)},onGenerateSectionStarted:()=>{h(!0)}}))),o?Se.createElement("div",{className:(0,xe.mergeClasses)(l.footer,l.footerBorder)},Se.createElement(jt.Button,{"data-automation-id":Oe,appearance:"subtle",icon:Se.createElement(un,null),disabled:m,onClick:()=>{s(!1),e.onShowNormalHeader(!1)}},ss.lc),Se.createElement("div",{className:l.createWrapper},kn(t)&&Se.createElement(wa,{ref:u}),Se.createElement(jt.Button,{appearance:"primary","data-automation-id":we,disabled:k,onClick:async()=>{d(!0);const t=Pn()&&Cn(I.current)?v||"Usual":void 0;M.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.Create.Click",stage:"Trigger",payload:{hasOutline:!0,tone:O.current.tone,length:O.current.length,language:O.current.language,fidelity:t,pageTemplateCategory:w,isPrivateAuthoring:u.current?.checked||!1,attachments:I.current,regenerationCount:b}}),await e.onCreatePage(w,void 0,{template:D.current,tokens:[],outline:C.current},O.current.tone,O.current.length,O.current.language,t,I.current,u.current?.checked||!1)}},c?Se.createElement(zt.Spinner,{size:"tiny"}):ss.fv))):Se.createElement("div",{className:l.footer},Se.createElement(jt.Button,{"data-automation-id":Ee,icon:Se.createElement(Qt,null),appearance:"subtle",onClick:()=>{r(Ba.FreePrompt,n),M.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.PageBuilder.GoBack.Click",stage:"Trigger"})}},ss.q$)))}function ls(e,t=[],n=!1){const a=new URLSearchParams(window.location.search);for(const e of t)a.delete(e);if(S._SPFlight.isDebugFlightEnabled)return a.set("Mode","Edit"),a.set(Zr,"true"),`${e}?${a.toString()}`;{const t=a.get("alTest")||void 0;return`${e}?Mode=Edit&${n?"":`${Zr}=true`}${t?`&alTest=${t}`:""}`}}function us(e){const{serviceScope:t,siteUrl:n,onStepChange:a,siteSensitiveLabel:i,pageCreationOptions:r,onPageCreate:s,closeDialog:c,...d}=e,[l,u]=(f=d,(0,Se.useReducer)(Lr,f,Ar));var f;const p=Er(),m=ut(),_=De().useRef(null),h=(0,Se.useCallback)((e,t,n)=>{u({type:"template-select",params:{selectedTemplate:e,templateSource:t,templateCategory:n},referrer:l.step})},[u,l.step]),b=(0,Se.useCallback)(()=>{Ln()?u({type:"go-to-page-builder-step",referrer:l.step}):u({type:"go-to-free-prompt-step",referrer:l.step})},[u,l.step]),g=(0,Se.useCallback)(()=>{u({type:"go-to-template-gallery-step",referrer:l.step})},[u,l.step]),v=ur(),y=(0,Se.useCallback)(async(e,a,i,d,l,u,f,p,_)=>{const h=S.Guid.newGuid().toString();try{m.log({id:h,operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.CreatePage",stage:"Start"}),s(i,a,_);const o=await fr(t,n,r,{category:e,template:a,prompt:i,tone:d,length:l,language:u,fidelity:f,attachments:p,isPrivateAuthoring:_},v);m.log({id:h,operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.CreatePage",stage:"End",payload:{result:"Success"}});const b=ls(o.AbsoluteUrl);return S._SPKillSwitch.isActivated("95fb2c98-0b58-48ed-9e07-3637f7f39d11")?window.location.href=b:(window.postMessage(`router://${b}`,window.location.origin),c()),!0}catch(e){if(e instanceof Error&&"AbortError"===e.name)return!1;if(S._SPKillSwitch.isActivated("bc0cd928-1e95-422b-8eb0-3d2d0d3d7bd8"))m.log({id:h,operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.CreatePage",stage:"End",payload:{result:"UnexpectedFailure",error:e,...e instanceof o.PagesApiError&&{extraData:{spPagesApiCorrelationId:e.correlationId}}}});else{const t=_r(e);m.log({id:h,operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.CreatePage",stage:"End",payload:{result:t?"ExpectedFailure":"UnexpectedFailure",error:e,...e instanceof o.PagesApiError&&{resultCode:e.code||e.httpStatus?.toString(),extraData:{spPagesApiCorrelationId:e.correlationId}}}})}return!1}},[t,n,v,r,m,s,c]),D=De().useMemo(()=>l.step===Ba.TemplateGallery&&l.referrer===Ba.CustomizePrompt&&l.data.selection.templateId?{element:{element:xt.TemplateCard,templateId:l.data.selection.templateId}}:l.step===Ba.FreePrompt?void 0:{element:{element:xt.CloseButton}},[l.data.selection.templateId,l.referrer,l.step]);(0,Se.useEffect)(()=>{a(l.step),D&&D.element&&D.element.element===xt.CloseButton&&_.current?.focus()},[a,l.step,_,l.referrer,l.data.selection.templateId,D]);const[I,x]=De().useState(!1),C=(0,ze.useCustomizationSettings)(["theme"]).theme.isInverted,[O,w]=De().useState(!1);let E=!1;switch(l.step){case Ba.FreePrompt:case Ba.CustomizePrompt:E=!0;break;case Ba.TemplateGallery:E=I;break;case Ba.PageBuilder:E=!1}const A=(0,xe.mergeClasses)(p.dialogHeader,l.step===Ba.PageBuilder&&p.builderDialogHeader,O&&p.dialogHeaderNormal,E?C?p.dialogHeaderBackgroundDark:p.dialogHeaderBackgroundLight:void 0),L=p.wizardBackgroundCover;let k;switch(l.step){case Ba.TemplateGallery:k=De().createElement(Nt,{...l.data,serviceScope:t,onTemplateSelected:h,onGotoFreePromptStep:b,onCategoryTabListSticky:x});break;case Ba.FreePrompt:k=De().createElement(Qa,{...l.data,siteSensitiveLabel:i,onGoBack:g,onCreatePage:y,serviceScope:t});break;case Ba.CustomizePrompt:k=De().createElement(Cr,{...l.data,serviceScope:t,siteSensitiveLabel:i,onGoBack:g,onCreatePage:y});break;case Ba.PageBuilder:k=De().createElement(ds,{...l.data,serviceScope:t,siteSensitiveLabel:i,onGoBack:g,onCreatePage:y,onShowNormalHeader:w})}return De().createElement(tn.SensitivityLabelsContextProvider,{serviceScope:t},De().createElement(Ot,{value:D},De().createElement("div",{className:(0,xe.mergeClasses)(p.wizard,l.step===Ba.PageBuilder&&p.builderWizard,l.step===Ba.PageBuilder&&p.builderResponsive),"data-automation-id":"create-page-with-copilot-wizard"},De().createElement("div",{className:L}),De().createElement("div",{className:A},E?De().createElement("div",{className:L}):null,O&&De().createElement("div",{className:p.dialogHeaderContent},De().createElement(rt.Subtitle1,{role:"heading","aria-level":1},kr.c)),De().createElement(jt.Button,{className:p.dialogActionButton,"data-automation-id":"create-page-with-copilot-dialog-close-btn",appearance:"subtle","aria-label":kr.Y,icon:De().createElement(at,null),onClick:e.closeDialog,ref:_})),k)))}const fs=(0,xe.makeStyles)({dialogSurface:{padding:"0",border:"none",width:"calc(100% - 32px)",maxWidth:"1200px",height:"100%",maxHeight:"790px",overflow:"hidden",backgroundSize:"100%",backgroundRepeat:"no-repeat","--dialogHorizontalPadding":"40px",[vt]:{"--dialogHorizontalPadding":"16px",width:"100%"},[Dt]:{paddingRight:"0",overflowY:"hidden"}},dialogBody:{gap:"0",padding:"0",height:"100%",maxHeight:"100vh"},dialogContent:{overflow:"auto",margin:0,padding:0,"[data-stable-scrollbar-guttter]":{scrollbarGutter:"stable"}},dialogBackgroundLight:{backgroundImage:`url(${Or})`,"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{backgroundImage:"none"}},dialogBackgroundDark:{backgroundImage:`url(${wr})`,"@media screen and (-ms-high-contrast: active), (forced-colors: active)":{backgroundImage:"none"}}});var ps=ce(5494);const ms=()=>{const[e,t]=De().useState(Pr.CopilotClientType.CommonGenerator),[n,a]=De().useState({}),[i,r]=De().useState("");De().useEffect(()=>{a((0,Pr.getFlightMap)(e))},[e]),De().useEffect(()=>{(0,Pr.overrideFlights)(e,Object.entries(n).map(([e,t])=>`${e}:${t}`))},[e,n]);const o=De().useCallback((e,n)=>{t(n.value)},[]),s=De().useCallback((e,t)=>{a(n=>({...n,[e]:t}))},[]),c=De().useCallback(e=>{r(e.target.value)},[]),d=De().useCallback(()=>{i&&(a(e=>({...e,[i]:!0})),r(""))},[i]);return De().createElement("div",null,De().createElement(ft.TabList,{selectedValue:e,onTabSelect:o},Object.values(Pr.CopilotClientType).map(e=>De().createElement(ft.Tab,{key:e,value:e},e))),De().createElement("div",null,Object.entries(n).map(([e,t])=>De().createElement("div",{key:e},De().createElement(ps.Switch,{checked:t,onChange:(t,n)=>s(e,n.checked),label:e}))),De().createElement(Ft.Input,{onChange:c,value:i,contentAfter:De().createElement(jt.Button,{onClick:d,appearance:"transparent",icon:De().createElement(Kt,null)})})))},_s=()=>De().createElement(Zn.Popover,{positioning:{position:"below",align:"start"}},De().createElement(Zn.PopoverTrigger,{disableButtonEnhancement:!0},De().createElement(jt.Button,{icon:De().createElement(es,null),style:{position:"absolute",zIndex:"10"}})),De().createElement(Zn.PopoverSurface,null,De().createElement(ms,null))),hs=(0,xe.createLightTheme)({10:"#001012",20:"#001d20",30:"#002b2e",40:"#003a3e",50:"#004a4d",60:"#00595d",70:"#00686d",80:"#03787c",90:"#268a8e",100:"#3d9c9f",110:"#51aeb2",120:"#65c1c4",130:"#78d4d7",140:"#8be7eb",150:"#9ffbfe",160:"#d6ffff"});function bs(e){const{isOpen:t,pageContext:n,serviceScope:a,siteUrl:i,onDismiss:r,templates:o,selection:s,pageCreationOptions:c,defaultPromptText:d,defaultTemplateCategory:l,onPageCreate:u}=e,f=fs(),p=(0,ze.useCustomizationSettings)(["theme"]).theme,m=ut();(0,Se.useEffect)(()=>{m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.Open",stage:"Trigger"})},[m]);const _=De().useCallback((e,t)=>{t.open||"backdropClick"===t.type||(m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.Close",stage:"Trigger"}),r())},[r,m]),h=De().useCallback(()=>{m.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.Close",stage:"Trigger"}),r()},[r,m]),b=De().useRef(null),g=(0,Se.useCallback)(e=>{b.current&&(b.current.toggleAttribute("data-stable-scrollbar-guttter",e===Ba.TemplateGallery),b.current.scrollTo({top:0,left:0}))},[]);return De().createElement(xe.FluentProvider,{applyStylesToPortals:!0,theme:S._SPFlight.isEnabled(62668)?hs:Ye(p),dir:document.dir||"ltr"},De().createElement(Ge.Dialog,{open:t,onOpenChange:_},De().createElement(Ge.DialogSurface,{className:(0,xe.mergeClasses)(f.dialogSurface,p.isInverted?f.dialogBackgroundDark:f.dialogBackgroundLight),"aria-label":Je.o,"aria-describedby":void 0},De().createElement(Ge.DialogBody,{className:f.dialogBody},De().createElement(Ge.DialogContent,{className:f.dialogContent,ref:b},De().createElement(rn,null,(0,Pr.isAlFlightDebugEnabled)()&&De().createElement(_s,null),De().createElement(us,{siteUrl:i,serviceScope:a,templates:o,selection:s,siteSensitiveLabel:n.legacyPageContext.sensitivityLabelName,onStepChange:g,pageCreationOptions:c,closeDialog:h,defaultPromptText:x()?void 0:d,defaultTemplateCategory:x()?void 0:l,onPageCreate:u})))))))}async function gs(e){const{serviceScope:t,siteUrl:n,pageCreationOptions:a,defaultPromptText:i,pageCategory:r,title:o,isBlankPage:s}=e,c=new AbortController,d=ls((await fr(t,n,a,{category:r||_.Page,template:void 0,title:o,prompt:s?void 0:l(i),tone:_e.Professional,length:he.Medium,language:void 0,fidelity:void 0,attachments:[],isPrivateAuthoring:!0,scenario:v.KaHandoff},c.signal)).AbsoluteUrl,[],s);return window.postMessage(`router://${d}`,window.location.origin),d}var vs,ys;(0,ze.createTheme)({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}}),(0,xe.createDarkTheme)({10:"#001012",20:"#002527",30:"#003b3e",40:"#005357",50:"#006b6e",60:"#1c8386",70:"#3d9c9f",80:"#4ba8ab",90:"#58b5b7",100:"#65c1c4",110:"#72ced0",120:"#7fdadd",130:"#8be7ea",140:"#98f4f7",150:"#a5ffff",160:"#d6ffff"}),(0,ze.createTheme)({palette:{themePrimary:"#3d9c9f",themeLighterAlt:"#020606",themeLighter:"#0a1919",themeLight:"#122e2f",themeTertiary:"#245d5f",themeSecondary:"#35888b",themeDarkAlt:"#4aa5a8",themeDark:"#60b3b5",themeDarker:"#83c6c9"}}),(0,xe.makeStyles)({root:{lineHeight:"unset"}}),function(e){e.Setup="Setup",e.BadRequest="BadRequest",e.PageReasoning="PageReasoning",e.SectionReasoning="SectionReasoning",e.ContentGeneration="ContentGeneration",e.TooManyFailure="TooManyFailure",e.Unknown="Unknown",e.GetMeetingInstanceError="GetMeetingInstanceError",e.OnlineMeetingsError="OnlineMeetingsError",e.ListAiInsightsError="ListAiInsightsError",e.GetAiInsightError="GetAiInsightError",e.FilterAiInsightError="FilterAiInsightError",e.InvalidPayload="InvalidPayload"}(vs||(vs={})),function(e){e.Timeout="Timeout",e.InvalidResponse="InvalidResponse",e.OffensiveContent="OffensiveContent",e.SydneyError="SydneyError"}(ys||(ys={}));class Ss extends Error{constructor(e,t,n){super(n),this.code=e,this.innerError=t,Object.setPrototypeOf(this,Ss.prototype)}}var Ds=ce(2657);const Is=e=>{switch(e){case T.Banner:return"Banner";case T.RTE:return"Text";case T.Image:return"Image";case T.Stream:return"Stream";case T.QuickLinks:return"QuickLinks";case T.People:return"People";default:return e}};class xs{log(e){this._loggers.forEach(t=>{try{t.log(e)}catch(e){}})}constructor(e){this._loggers=[],this._loggers=e}}function Cs(e){return e?e.endTime-e.startTime:0}function Os(e){return!(!e||!e.startTime&&0!==e.startTime||!e.endTime&&0!==e.endTime||!(e.endTime>e.startTime))}var ws,Es=function(e){var t=e.controlId,n=e.startTime,a=e.endTime,i=e.ignoreForEUPL,r=e.needFlatten,o=e.renderTimeCalculator,s=void 0===o?Cs:o,c=e.renderTimeRequiredDataChecker,d=void 0===c?Os:c;this.controlId=t,this.startTime=n,this.endTime=a,this.renderTimeCalculator=s,this.renderTimeRequiredDataChecker=d,this.ignoreForEUPL=void 0===i||i,this.needFlatten=void 0!==r&&r};!function(e){e.Template="Template",e.FreePrompt="FreePrompt"}(ws||(ws={}));class As{log(e){switch(e.operation){case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle":case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageReasoning":case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl":case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.SectionReasoning":const t=e.operation.split(".").slice(-1)[0],{timeStamp:n,length:a,pageType:i,conversationId:r,webPartType:o}=e.payload;if("Start"===e.stage)this._scenarioStartTime.set(e.id,n);else if("End"===e.stage){if(!this._scenarioStartTime.has(e.id)||"Success"!==e.payload.result)return;const s=ee.RUMOneLogger.getRUMOneLogger({name:`AuthoringCopilot.${t}`});s.isRunning()||s.resetLogger();const c={startTime:this._scenarioStartTime.get(e.id)??n,endTime:n};c.length={data:a??"",needFlatten:!1},c.pageType={data:i??"",needFlatten:!1},c.conversationId={data:r??"",needFlatten:!1},o&&(c.webPartType={data:o,needFlatten:!1}),"GeneratePageControl"===t&&(c.firstChunkReturned=this._firstChunkReturned.get(e.id)??0,c.firstChunkTime=this._calculateFirstChunkTime(this._scenarioStartTime.get(e.id),this._firstChunkReturned.get(e.id))),s.addExpectedControl(`AuthoringCopilot.${t}`),s.writeScenarioId(`AuthoringCopilot.${t}`),s.writeEUPLBreakdown(JSON.stringify(c)),s.writeControlPerformanceData(new Es({controlId:`AuthoringCopilot.${t}`,startTime:this._scenarioStartTime.get(e.id)??n,endTime:n})),this._scenarioStartTime.delete(e.id)}break;case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageControlStreaming":const{controlId:s}=e.payload;s&&!this._firstChunkReturned.has(s)&&this._firstChunkReturned.set(s,e.payload.timeStamp)}}_calculateFirstChunkTime(e,t){return e&&t?Math.max(0,t-e):0}constructor(){this._scenarioStartTime=new Map,this._firstChunkReturned=new Map}}var Ls=ce(303);const ks=[T.Banner,T.People,T.QuickLinks,T.Image,T.Stream],Ms=["gcc","gcch","dod","ag08","ag09","deu","chn"];function Ps(e){return(0,s.isWebPart)(e)&&ks.includes(e.webPartId)?[!0,{manifestId:e.webPartId}]:(0,s.isRte)(e)?[!0,{manifestId:T.RTE}]:[!1]}function Ts(e,t){if(A())return!1;if(!S._SPKillSwitch.isActivated("67281f40-9637-4e11-9be1-041f33d41ce2")&&Ms.includes(t.pageContext.legacyPageContext.cloudType?.toLowerCase()||"prod")&&(0,s.isWebPart)(e)&&e.webPartId===T.Image)return!0;if("ai-templates"===t.pagePrompt.scenario){const n=so(t.canvasExtraData)?.(e.id);return!n}return!1}const Us="PageCreationStoppedByCaller";class Fs{dispose(){this._controlGenerationTasks.forEach(e=>{e.finished||e.rejectCallback(Us)}),this._controlGenerationTasks=[]}get node(){return this._node}getControlGenerationTaskById(e){const t=this._controlGenerationTasks.findIndex(t=>t.id===e);return-1===t?{task:void 0,index:t}:{task:this._controlGenerationTasks[t],index:t}}getControlGenerationTaskByIndex(e){return this._controlGenerationTasks[e]}get resources(){return w()?function(e,t){const n=[];for(const a of e)switch(a.attachmentType){case tn.AttachmentType.File:const e=t?.[a.id];if(!e)continue;const i=Io(e.listItemUniqueId||"",e.siteId||"",e.webId,e.listId||"");if(!i)continue;n.push({messageAnnotationType:Yr.File,id:i,text:a.fileName});break;case tn.AttachmentType.Meeting:n.push({messageAnnotationType:Yr.Event,id:a.id,text:a.fileName});case tn.AttachmentType.MeetingSeries:}return n}(this._props.pagePrompt.attachments,this._props.links):xo(this._props.pagePrompt.attachmentsNew??[])}_getUserPrompt(){const{prompt:e}=this._props.pagePrompt;return p(e)}_prepareControl(e,t,n,a,i,r){let o,s;const c=new Promise((e,t)=>{o=e,s=t});this._controlGenerationTasks.push({id:e,promise:c,resolveCallback:o,rejectCallback:s,displayToken:a,progress:i,finished:!1}),r.children.push({scenarioId:t,id:e,aiContext:n})}_prepareNode(){const e=this._props.zones.map(e=>e.map(e=>structuredClone(e)));for(let t=0;t<e.length;t++){const n=e[t];for(let a=0;a<n.length;a++){const i=n[a],[r,o]=Ps(i);if(!r||Ts(i,this._props))continue;const[c,d]=this._isGroupedControl(i),l=this._node,u=this._findTargetToken(i.id),f=0===t&&(0,s.isWebPart)(i)&&i.webPartId===T.Banner,p=this._getControlAIContext(i,f);c&&(p.prompt=d.prompt),this._prepareControl(i.id,o.manifestId,p,u?.text.trim()||u?.placeholder?.trim()||"",{zoneIndex:t,totalZonesCount:e.length,totalControlsCount:n.length,controlIndex:a,controlState:"NotStarted"},l)}}}_isGroupedControl(e){const t=this._findTargetToken(e.id);if(t?.options&&t.options.canvasControls&&t.options.canvasControls.length>1){const n=t.options.canvasControls.findIndex(t=>t.id===e.id);return[!0,{index:n,prompt:`Paragraph ${n+1} of ${t.text.trim()||t.placeholder?.trim()}`}]}return[!1]}_findTargetToken(e){const t=this._props.pagePrompt.prompt.tokens.findIndex(t=>t.options?.canvasControls.some(t=>t.id===e));return this._props.pagePrompt.prompt.tokens[t]}_getControlAIContext(e,t){let n=this._props.getControlPrompt?.(e.id);if(!n){const a=this._findTargetToken(e.id);a?n=a.text.trim()||a.placeholder?.trim():(0,s.isRte)(e)||t||e.webPartId===T.Banner&&(n="Quote someone's sentence from the transcript to be used as a title.")}if((0,s.isRte)(e)){let t=e.innerHTML||"";return t=t.replace(/>([^<]*)</g,"><"),{prompt:"",topic:n,example:t}}return{prompt:n||""}}constructor(e){this._controlGenerationTasks=[],this._props=e,Xo()&&Yo(this._getUserPrompt()),this._node={aiContext:{prompt:this._getUserPrompt()},children:[]},this._prepareNode()}}class Hs{async stop(){this._stopped=!0,this._pageCreateTask.dispose()}async start(){const{zones:e,onGenerateZoneBegin:t,onGenerateZoneEnd:n,onGeneratePageTitleBegin:a,onGeneratePageTitleEnd:i,onGenerateControlSkip:r,onGenerateControlBegin:o,onGenerateControlUpdate:c,onGenerateControlEnd:d,onStart:l,onFinish:u,onError:f,onDiagnosticData:p,pageContext:m,logger:_}=this._props;E()||l(S.Guid.newGuid().toString(),void 0===this._props.pagePrompt.template?"freePrompt":"template");let h,b=!1;const g=S.Guid.newGuid().toString();if((0,Ds.injectPostProcessor)(Ds.InjectionAllowedPostProcess.ImageDescriptionToUrl,async e=>{const t=await this._agent.generateImageSuggestionWithoutTranslation(e);if(t)return t}),!S._SPKillSwitch.isActivated("de4a4b45-f5fe-43f7-8916-fa71e906a28e")){let e;(0,Ds.injectPostProcessor)(Ds.InjectionAllowedPostProcess.SanitizePeopleInfo,async t=>{e||(e=new Ls.PeopleDataProvider(this._props.serviceScope,"AuthoringCopilot"));const n=await e.getPeopleInfo(t);return n.email&&n.role?{name:n.name,email:n.email,role:n.role}:void 0})}const v=e.map(e=>e.map(e=>structuredClone(e)));this._client=new Pr.SPPageGenerationClient(m.legacyPageContext,(t,n)=>{try{if(this._stopped)return;const a=t.split(".")[0],{task:i,index:r}=this._pageCreateTask.getControlGenerationTaskById(a);if(i&&!i.finished&&(0===r||this._pageCreateTask.getControlGenerationTaskByIndex(r-1).finished)&&t.endsWith(".html")){_.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageControlStreaming",stage:"Trigger",payload:{controlId:a,timeStamp:Date.now(),isFirstChunk:!b,webPartType:"Text"}}),k()||b||_.log({id:`${g}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.FirstChunk",stage:"End",payload:{result:"Success"}}),b=!0;const t=e[i.progress.zoneIndex][i.progress.controlIndex],r=C()?co(n):lo(n);(0,s.isRte)(t)&&(t.innerHTML=r),c({control:t,innerHTML:r},{...i.progress,controlState:"InProgress"}),t.innerHTML=r}}catch(e){}},(e,t)=>{if(this._stopped)return;const{task:n}=this._pageCreateTask.getControlGenerationTaskById(e.split(".")[0]);n&&n.resolveCallback(t)},e=>{h!==e&&(p({conversationId:e}),Xo()&&Jo(e)),h=e}),k()||_.log({id:`${g}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.FirstChunk",stage:"Start"}),this._client.generatePage(this._pageCreateTask.node,{serviceType:this._props.serviceType??"AuthoringCopilot",authoringOptions:{length:this._props.pagePrompt.length,tone:this._props.pagePrompt.tone},conversationModeBatchedControlNumber:2,templateId:this._props.pagePrompt.template?.uniqueId,handoffOption:this._props.pagePrompt.handoffOption},this._pageCreateTask.resources).catch(e=>{if(S._SPKillSwitch.isActivated("0d364b0d-b500-47f0-8edd-7914d4eea7aa"))f(new Ss(vs.Unknown,e));else{let t="Unknown",n="";"string"==typeof e?t=e:!(0,Pr.isThrowPageGenerationErrorKSActivated)()&&e instanceof Pr.PageCreationError&&(n=e.message,t=e.errorCode);const a=t in vs?vs[t]:vs.Unknown;f(new Ss(a,void 0,n))}});try{const e=v.length;let c;for(let l=0;l<v.length;l++){const u=v[l],f=u.length;if(t(u,{zoneIndex:l,totalZonesCount:e,totalControlsCount:f,controlIndex:0,controlState:"NotStarted"}),0===l&&(0,s.hasTitleAreaBannerWebPart)(u)){o(u[0],"",{zoneIndex:l,totalZonesCount:e,totalControlsCount:f,controlIndex:0,controlState:"Started"}),a();const t=u[0];_.log({id:t.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle",stage:"Start",payload:{timeStamp:Date.now()}});try{c=(await(this._pageCreateTask.getControlGenerationTaskById(t.id)?.task?.promise)).title}catch(e){if(e===Us)return void _.log({id:t.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle",stage:"End",payload:{result:"ExpectedFailure",error:new Error(e),timeStamp:Date.now(),conversationId:h}})}c&&(t.webPartData.properties.title=c),_.log({id:t.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle",stage:"End",payload:{result:"Success",timeStamp:Date.now(),conversationId:h}}),i(c||"place"),d(t),n(u,{zoneIndex:l,totalZonesCount:e,totalControlsCount:f,controlIndex:0,controlState:"Completed"})}else{for(let t=0;t<u.length;t++){if(this._stopped)return;const n=u[t],[a,i]=Ps(n);if(!a||Ts(n,this._props)){r(n);continue}const{task:c}=this._pageCreateTask.getControlGenerationTaskById(n.id);if(c){let a;o(n,c.displayToken,{zoneIndex:l,totalZonesCount:e,totalControlsCount:f,controlIndex:t,controlState:"Started"}),(0,s.isRte)(n)&&(n.innerHTML=""),_.log({id:n.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"Start",payload:{timeStamp:Date.now(),webPartType:Is(i.manifestId)}});try{a=await c.promise}catch(e){if(e===Us)return void _.log({id:n.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"ExpectedFailure",error:new Error(e),timeStamp:Date.now(),length:this._props.pagePrompt.length,pageType:ws.Template,conversationId:h,webPartType:Is(i.manifestId)}})}if((0,s.isRte)(n))n.innerHTML=C()?co(a.html):lo(a.html);else{const e=(0,Ds.getRelay)(i.manifestId);if(e){let t;t=i.manifestId===T.Image?new e({postProcessConfig:{aspectRatioOnLoad:n.webPartData.properties.aspectRatioOnLoad||n.webPartData.properties.cropWidth/(n.webPartData.properties.cropHeight||1)||n.webPartData.properties.imgWidth/n.webPartData.properties.imgHeight}}):new e;let r=n.webPartData;i.manifestId===T.Stream&&(r=void 0),n.webPartData=r?await t.postProcessWithBaseWebPartData(n.webPartData,a):await t.postProcessor(a)}}_.log({id:n.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"Success",timeStamp:Date.now(),length:this._props.pagePrompt.length,pageType:ws.Template,conversationId:h,webPartType:Is(i.manifestId)}}),d(n),c.finished=!0}}n(u,{zoneIndex:l,totalZonesCount:e,totalControlsCount:f,controlIndex:u.length-1,controlState:"Completed"})}}u()}catch(e){f(e instanceof Ss?e:new Ss(vs.Unknown,e))}}constructor(e){this._stopped=!1,this._props=e,this._agent=new Pr.PageAuthoringCopilotClient(this._props.pageContext.legacyPageContext),this._pageCreateTask=new Fs(this._props)}}var Rs;!function(e){e.Fixed="fixed",e.Fluid="fluid"}(Rs||(Rs={}));var Ns,Bs,js=ce(2560);function Vs(e,t){const n=[],a=S.Guid.newGuid().toString(),i=t+1;for(let t=0;t<e.columns.length;t++){const r=e.columns[t],o=r.positioning===Rs.Fixed,s=o?r.height:void 0;for(let c=0;c<r.cells.length;c++){const d=r.cells[c],l=S.Guid.newGuid().toString(),u=t+1,f=c+1,p=d.region?{lg:d.region}:void 0,m={zoneId:a,zoneIndex:i,sectionIndex:u,controlIndex:f,sectionFactor:o?100:12/e.columns.length,layoutIndex:1};switch(d.contentType){case"text/html":const e=z(l,"",m);e.flexibleLayoutPosition=p,e.zoneHeight=s,n.push(e);break;case"text/vnd.ms-page-title":n.push(B(l,"",{...m,sectionFactor:0}));break;case"text/vnd.mermaid":case"image/png":case"image/jpeg":case"image/webp":const t=G(l,{imageUrl:""},m);t.flexibleLayoutPosition=p,t.zoneHeight=s,n.push(t);break;case"text/vnd.spacer":const a=V(l,oo(d.content||"")||{height:1},m);a.flexibleLayoutPosition=p,a.zoneHeight=s,n.push(a);break;case"text/vnd.divider":const i=j(l,oo(d.content||"")||{length:100,weight:1},m);i.flexibleLayoutPosition=p,i.zoneHeight=s,n.push(i);break;default:if(d.contentType.startsWith("text/vnd.ms-placeholder-")){const e=d.contentType.replace("text/vnd.ms-placeholder-","");n.push({id:l,controlType:js.CanvasControlType.WebPartZone,webPartId:e,webPartData:{id:l,instanceId:l,title:"",dataVersion:"1.0",properties:{title:d.content||"",designId:S.Guid.newGuid().toString(),designName:""}},position:m,flexibleLayoutPosition:p,zoneHeight:s})}}}}return n}function zs(e){return"d1d91016-032f-456d-98a4-721247c305e8"===e.webPartId}function Gs(e,t){if(!t)return e;const n=e.webPartData.properties.aspectRatioOnLoad,a=e.webPartData.properties.cropX/e.webPartData.properties.cropY,i=e.webPartData.properties.imgWidth/e.webPartData.properties.imgHeight,r=function(e,t){if(isNaN(e))return;const n=t.width/t.height;let a,i,r,o;return Math.abs(n-e)<1e-4?(a=0,i=0,r=t.width,o=t.height):n>e?(r=Math.floor(t.height*e),o=t.height,a=Math.floor((t.width-r)/2),i=0):(r=t.width,o=Math.floor(t.width/e),a=0,i=Math.floor((t.height-o)/2)),{cropX:a,cropY:i,cropWidth:r,cropHeight:o}}(n||a||i,t),s={...e};return s.webPartData.properties={...e.webPartData.properties,imageSourceType:o.ImageSourceType.HubbleStockURI,altText:t.description,imgWidth:t.width,imgHeight:t.height,contentProvider:t.contentProvider,insertionISOTimestamp:(0,o.getTimestampForGettyContent)(t.contentProvider),stockMediaId:t.id,...r},s.webPartData.serverProcessedContent={...e.webPartData.serverProcessedContent,imageSources:{imageSource:t.url}},s}!function(e){e.Content="Content",e.Template="Template"}(Ns||(Ns={})),function(e){e.Json="application/json",e.Markdown="text/markdown"}(Bs||(Bs={}));var Ks=ce(6915);async function Ws(e,t){Ks.N.initialize({startOnLoad:!1});try{if(!t)return;if(!1===await Ks.N.parse(t,{suppressErrors:!0}))return;const{svg:n}=await Ks.N.render(e,t),a=await function(e){return new Promise((t,n)=>{const a=(new DOMParser).parseFromString(e,"image/svg+xml").documentElement.getAttribute("viewBox");if(!a)return void n(new Error("No viewBox attribute found"));const i=a.split(" ").map(Number),r=new Image,o=new Blob([e],{type:"image/svg+xml"});r.src=URL.createObjectURL(o),r.width=i[2],r.height=i[3],r.onload=()=>{t(r),URL.revokeObjectURL(r.src)},r.onerror=n})}(n),i=a.width,r=a.height,o=new OffscreenCanvas(i+20,r+20),s=o.getContext("2d");if(!s)return;return s.fillStyle="white",s.fillRect(0,0,i+20,r+20),s.drawImage(a,10,10,i,r),{width:i,height:r,blob:await o.convertToBlob({type:"image/png"})}}catch(e){return}}var qs=ce(8919);async function Qs(e,t,n){const{SPFileHandler:a}=await qs.EditModeUtilitiesLoader.GetUtilities(),i=new a({serviceScope:e,qosPrefix:"AuthoringCopilot"});return{url:(await i.uploadLocalFile(n,t)).serverRelativeUrl}}async function Ys(e){const t=await function(e){return new Promise(t=>{const n=new Image;n.onload=()=>t(n),n.onerror=e=>t(void 0),n.src=e})}(e);if(!t)return;const n=e.match(/^data:(.+?\/.+?);/),a=n?n[1].split("/")[1]:void 0;if(!a)return;const i=await async function(e,t=0,n){const a=e.width,i=e.height,r=new OffscreenCanvas(a+2*t,i+2*t),o=r.getContext("2d");if(o)return n&&(o.fillStyle=n,o.fillRect(0,0,a+2*t,i+2*t)),o.drawImage(e,t,t,a,i),{width:a,height:i,blob:await r.convertToBlob({type:"image/png"})}}(t,0);if(!i)return;const{width:r,height:o,blob:s}=i;return{width:r,height:o,extension:a,blob:s}}function Js(e){const{pageContext:t,pagePrompt:n,onGeneratePageTitleBegin:a,onGeneratePageTitleEnd:i,onLayoutPageBegin:r,onLayoutPageEnd:o,onGenerateZoneBegin:c,onGenerateZoneEnd:d,onGenerateControlSkip:l,onGenerateControlBegin:u,onGenerateControlUpdate:f,onGenerateControlEnd:p,onStart:m,onError:_,onFinish:h}=e,{serviceScope:b}=oa(),g=on(),y=ur(),x=(0,Pr.useAuthoringCopilotClient)(t.legacyPageContext,!0),C=ut(),O=(0,xe.useId)("mermaid-host-");return(0,Se.useEffect)(()=>{(async()=>{let e;const{scenario:a,attachmentsNew:i}=n;Xo()&&Yo(""),E()||m(S.Guid.newGuid().toString(),"mapping");let g=[],w=[];if(a===v.PlannerReport){const e=me[a];e?.getDesigns&&(g=e?.getDesigns()),I()||e?.getAllowedUrlPatterns&&(w=e?.getAllowedUrlPatterns(t))}const A=xo(i||[]);try{const t=S.Guid.newGuid().toString();C.log({id:t,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.PageReasoning",stage:"Start",payload:{timeStamp:Date.now()}}),r();const n=Ns.Content,a=await x.generateDocumentStructure({preference:n,instruction:"",sources:A,outputFormat:Bs.Json},{abortSignal:y}),i=await a.wait();if(!i)return void _(new Ss(vs.PageReasoning));e=i.conversationId;const m=i.value;o([],m.name),C.log({id:t,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.PageReasoning",stage:"End",payload:{result:"Success",timeStamp:Date.now(),conversationId:e}});let v=0;const E=m.rows.length;for(let t=0;t<m.rows.length;t++){const n=Vs(m.rows[t],t),a=t,i=m.rows[t],r=n.length;let o=!1;const h=S.Guid.newGuid().toString();let L;if(C.log({id:`${h}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.FirstChunk",stage:"Start"}),c(n,{totalZonesCount:E,zoneIndex:a,totalControlsCount:r,controlIndex:0,controlState:"Started"}),0===t&&(0,s.hasTitleAreaBannerWebPart)(n)){L=new Pr.StreamingGenerator(y);const n=L.getStreaming("0.0.0"),a=0,i=0;n.end({conversationId:e,value:{name:"0.0.0",contentType:"text/vnd.ms-page-title",lines:[m.rows[t].columns[a].cells[i].content||""],isComplete:!0}}),L.end()}else{const n=[];for(let e=0;e<i.columns.length;e++){const a=i.columns[e];for(let i=0;i<a.cells.length;i++){const r=a.cells[i];"text/vnd.spacer"!==r.contentType&&"text/vnd.divider"!==r.contentType&&n.push({rowIndex:t,columnIndex:e,cellIndex:i})}}L=await x.generateDocumentContent({conversationId:e,document:m,cellLocations:n,sources:A,designs:g},{abortSignal:y})}for(let s=0;s<n.length;s++){const c=n[s];if(y.aborted)return;if(!H(a,n,c)){l(c);continue}if(!c.position.sectionIndex||!c.position.controlIndex)continue;const d=c.id,g=c.position.sectionIndex-1,x=c.position.controlIndex-1,A=`${t}.${g}.${x}`,k=i.columns[g],M=k.cells[x],P=M.title||k.title||i.title||"";u(c,P,{totalZonesCount:E,zoneIndex:a,totalControlsCount:r,controlIndex:s,controlState:"Started"});const U=R(c);C.log({id:d,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.GeneratePageControl",stage:"Start",payload:{timeStamp:Date.now(),webPartType:U}});let F={result:"Success"};try{const e=L.getStreaming(A);switch(c.controlType){case js.CanvasControlType.RTE:{for await(const t of e.pull()){if(y.aborted)return void C.log({id:`${h}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.FirstChunk",stage:"End",payload:{result:"ExpectedFailure",error:new Error("Stop generation from mapping page generator")}});C.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.PageControlStreaming",stage:"Trigger",payload:{controlId:d,timeStamp:Date.now(),isFirstChunk:!o,webPartType:U}}),o||C.log({id:`${h}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.FirstChunk",stage:"End",payload:{result:"Success"}}),o=!0;const e=t.value,n=I()?D.SafeHtml.clean(e.lines.join("\n")):co(e.lines.join("\n"),w);f({control:c,innerHTML:n},{zoneIndex:a,totalZonesCount:E,totalControlsCount:r,controlIndex:s,controlState:"InProgress"})}const t=await e.wait();if(t){const e=t.value;c.innerHTML=I()?D.SafeHtml.clean(e.lines.join("\n")):co(e.lines.join("\n"),w)}else F={result:"UnexpectedFailure",error:new Error("No response")}}break;case js.CanvasControlType.WebPartZone:switch(c.webPartId){case T.Banner:{const t=await e.wait();c.webPartData.properties.title=t?.value.lines[0]||m.name}break;case T.Image:const t=await e.wait();if(t){const e=t.value;if("text/vnd.mermaid"===M.contentType){const t=e.lines.join("\n");if(t){const e=await Ws(O,t);if(e){const t=await Qs(b,`${Date.now()}.png`,e.blob);t&&(c.webPartData.properties.imageUrl=t.url,c.webPartData.properties.imgWidth=e.width,c.webPartData.properties.imgHeight=e.height,Gs(c,{url:t.url,width:e.width,height:e.height}))}}}else{const t=e.lines.join("\n").trim(),n=await Ys(t);if(n){const{blob:e,extension:t}=n,a=await Qs(b,`${Date.now()}.${t}`,e);a?.url&&(c.webPartData.properties.imageUrl=a.url,c.webPartData.properties.imgWidth=n.width,c.webPartData.properties.imgHeight=n.height,Gs(c,{url:a.url,width:n.width,height:n.height}))}}}else F={result:"UnexpectedFailure",error:new Error("No response")}}}}catch(e){v++}switch(F.result){case"Success":C.log({id:d,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.GeneratePageControl",stage:"End",payload:{result:"Success",timeStamp:Date.now(),pageType:ws.Template,conversationId:e,webPartType:U}});break;case"UnexpectedFailure":v++,C.log({id:d,operation:"AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.GeneratePageControl",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),conversationId:e,webPartType:U,resultCode:F.error instanceof Pr.AuthoringCopilotError?F.error.code:void 0,error:F.error}})}if(y.aborted)return;if(v>=2)return void _(new Ss(vs.TooManyFailure));p(c)}d(n,{totalZonesCount:E,zoneIndex:a,totalControlsCount:r,controlIndex:n.length-1,controlState:"Completed"}),await L.wait()}h()}catch(e){if(y.aborted)return;_(e instanceof Ss?e:new Ss(vs.Unknown,e))}finally{Xo()&&Jo(e??"")}})()},[b,O,C,t,g,y,n,x,a,i,r,o,c,d,l,u,f,p,m,_,h]),De().createElement("div",null,De().createElement("div",{id:O,"aria-hidden":!0,hidden:!0}))}const Xs={paragraph:{textPlaceholderType:"paragraph",fontSize:18,fontSizeClass:"fontSizeLarge",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading1:{textPlaceholderType:"heading",fontSize:42,fontSizeClass:"fontSizeSuper",isBold:!0,isItalic:!0,isUnderline:!1,textAlignment:"left"},heading2:{textPlaceholderType:"heading",fontSize:28,fontSizeClass:"fontSizeXxLarge",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading3:{textPlaceholderType:"subHeading",fontSize:18,isBold:!0,isItalic:!1,isUnderline:!1,textAlignment:"left",fontColor:"fontColorThemePrimary"},blockQuote:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},pre:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},image:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},table:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableRow:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableCell:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumnGroup:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumn:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"}},Zs={...Xs,heading1:{...Xs.heading1,isItalic:!1,fontColor:"fontColorThemePrimary"},heading2:{...Xs.heading2,fontColor:"fontColorThemePrimary"},blockQuote:{...Xs.blockQuote,class:"quoteIcon"},table:{...Xs.table,class:"bandedRowColumnTableStyleTheme"}},$s={paragraph:{textPlaceholderType:"paragraph",fontSize:18,fontSizeClass:"fontSizeLarge",fontColor:"fontColorNeutralPrimaryAlt",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading1:{textPlaceholderType:"heading",fontSize:56,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left",fontColor:"fontColorThemePrimary"},heading2:{textPlaceholderType:"heading",fontSize:32,fontSizeClass:"fontSizeXxxLarge",fontColor:"fontColorNeutralPrimaryAlt",isBold:!0,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading3:{textPlaceholderType:"subHeading",fontSize:24,fontSizeClass:"fontSizeXLargePlus",fontColor:"fontColorNeutralPrimaryAlt",isBold:!1,isItalic:!0,isUnderline:!1,textAlignment:"left"},blockQuote:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},pre:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},image:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},table:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableRow:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableCell:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumnGroup:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumn:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"}},ec={...$s,heading2:{...$s.heading2,fontColor:"fontColorThemePrimary"},heading3:{...$s.heading3,isItalic:!1,fontColor:"fontColorThemePrimary"},blockQuote:{...$s.blockQuote,class:"quoteLeft"},table:{...$s.table,class:"bandedRowColumnTableStyleTheme"}},tc={paragraph:{textPlaceholderType:"paragraph",fontSize:18,fontSizeClass:"fontSizeLarge",fontColor:"fontColorNeutralPrimaryAlt",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading1:{textPlaceholderType:"heading",fontSize:42,fontSizeClass:"fontSizeSuper",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading2:{textPlaceholderType:"heading",fontSize:28,fontSizeClass:"fontSizeXxLarge",fontColor:"fontColorNeutralSecondary",isBold:!1,isItalic:!0,isUnderline:!1,textAlignment:"left"},heading3:{textPlaceholderType:"subHeading",fontSize:20,fontSizeClass:"fontSizeXLarge",fontColor:"fontColorNeutralPrimaryAlt",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},blockQuote:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},pre:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},image:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},table:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableRow:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableCell:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumnGroup:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumn:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"}},nc={...tc,heading1:{...tc.heading1,fontColor:"fontColorThemePrimary"},heading2:{...tc.heading2,isItalic:!1},heading3:{...tc.heading3,fontColor:"fontColorThemePrimary"},blockQuote:{...tc.blockQuote,class:"quoteIcon"},table:{...tc.table,class:"bandedRowColumnTableStyleTheme"}},ac={paragraph:{textPlaceholderType:"paragraph",fontSize:18,fontSizeClass:"fontSizeLarge",fontColor:"fontColorNeutralSecondary",isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},heading1:{textPlaceholderType:"heading",fontSize:48,isBold:!0,isItalic:!1,isUnderline:!1,textAlignment:"left",fontColor:"fontColorThemePrimary"},heading2:{textPlaceholderType:"heading",fontSize:24,fontSizeClass:"fontSizeXLargePlus",isBold:!1,isItalic:!0,isUnderline:!1,textAlignment:"left"},heading3:{textPlaceholderType:"subHeading",fontSize:18,fontSizeClass:"fontSizeLarge",fontColor:"fontColorThemePrimary",isBold:!1,isItalic:!1,isUnderline:!0,textAlignment:"left"},blockQuote:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},pre:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},image:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},table:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableRow:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableCell:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumnGroup:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"},tableColumn:{textPlaceholderType:"paragraph",fontSize:18,isBold:!1,isItalic:!1,isUnderline:!1,textAlignment:"left"}},ic={...ac,heading2:{...ac.heading2,isItalic:!1,fontColor:"fontColorThemePrimary"},blockQuote:{...ac.blockQuote,class:"quoteLeft"},table:{...ac.table,class:"bandedRowColumnTableStyleTheme"}};var rc=ce(6567);const oc=[Zs,ec,nc,ic],sc=()=>{const e=(0,si.random)(oc.length-1);return oc[e]};async function cc(e,t,n){if(!e||0===e.length)return e;const a=new rc.RteDtoStyler(t),i=n??sc();try{return await Promise.all(e.map(async e=>{if(e.controlType===s.CanvasControlType.RTE){const t=await a.performStyleChange(i,e.innerHTML||"",!e.innerHTML);return{...e,innerHTML:t}}return e}))}catch(t){return e}}var dc=ce(9170);const lc="1fdd612d-8dda-47de-8dc1-23f90527cc92",uc=/<img[^>]+src=["']([^"']+)["'][^>]*>/gi;function fc(e,t=1,n=1){return{controlType:s.CanvasControlType.RTE,id:S.Guid.newGuid().toString(),position:{zoneId:S.Guid.newGuid().toString(),zoneIndex:t,sectionIndex:1,controlIndex:n},innerHTML:co(e)}}function pc(e,t=1,n=1){let a,i=n,r=0;const o=S.Guid.newGuid().toString(),c=[],d=[];for(uc.lastIndex=0;null!==(a=uc.exec(e));)d.push({index:a.index,match:a[0],src:a[1]});for(let n=0;n<d.length;n++){const a=d[n],l=e.substring(r,a.index);if(l.trim()){const e={controlType:s.CanvasControlType.RTE,id:S.Guid.newGuid().toString(),position:{zoneId:o,zoneIndex:t,sectionIndex:1,controlIndex:i++},innerHTML:co(l.trim())};c.push(e)}const u=_c(a.src,t,o,i++);c.push(u),r=a.index+a.match.length}const l=e.substring(r);if(l.trim()){const e={controlType:s.CanvasControlType.RTE,id:S.Guid.newGuid().toString(),position:{zoneId:o,zoneIndex:t,sectionIndex:1,controlIndex:i++},innerHTML:co(l.trim())};c.push(e)}return c}function mc(e,t=1,n=1){const a=S.Guid.newGuid().toString();return{controlType:s.CanvasControlType.WebPartZone,id:a,webPartId:lc,position:{zoneId:S.Guid.newGuid().toString(),zoneIndex:t,sectionIndex:1,controlIndex:n},webPartData:{id:lc,instanceId:a,properties:{chartCode:e},title:"ChartWidgetWebPart",dataVersion:"*"}}}function _c(e,t,n,a){return{id:S.Guid.newGuid().toString(),controlType:s.CanvasControlType.WebPartZone,webPartId:"d1d91016-032f-456d-98a4-721247c305e8",position:{zoneId:n,zoneIndex:t,sectionIndex:1,controlIndex:a},webPartData:{id:"d1d91016-032f-456d-98a4-721247c305e8",instanceId:S.Guid.newGuid().toString(),title:"Image",description:"Add an image, picture or photo to your page including text overlays and ability to crop and resize images.",audiences:[],hideOn:{mobile:!1},serverProcessedContent:{htmlStrings:{},searchablePlainTexts:{},imageSources:{imageSource:e},links:{},customMetadata:{}},dataVersion:"1.13",properties:{imageSourceType:2,captionText:"",altText:"",linkUrl:"",minimumLayoutWidth:1,customContentDropSupport:"externallink",resizeCoefficient:1,alignment:"Center",fixAspectRatio:!1,isOverlayTextEnabled:!0},containsDynamicDataSource:!1}}}var hc=ce(1181);async function bc(e,t,n,a,i=""){const r=function(e,t="image/png"){try{const n=e.replace(/^data:image\/\w+;base64,/,""),a=atob(n),i=new Uint8Array(a.length);for(let e=0;e<a.length;e++)i[e]=a.charCodeAt(e);return new Blob([i],{type:t})}catch{return null}}(e,"image/png");if(!r)return null;try{const e=new hc.SPFileHandler({serviceScope:a,qosPrefix:i});return(await e.uploadLocalFile(r,t,void 0,!1,n,!1,void 0)).serverRelativeUrl??null}catch{return null}}const gc=/!\[([^\]]*)\]\(data:image\/([a-z0-9]+);base64,([^)]+)\)/gi;function vc(e){const{pageContext:t,pagePrompt:n,onAddZones:a,onStart:i,onFinish:r,onError:o,onGeneratePageTitleEnd:s,serviceScope:c}=e,d=(0,Se.useMemo)(()=>new Pr.MarkdownPageCopilotClient(t.legacyPageContext),[t]),l=ur(),u=ut();return(0,Se.useEffect)(()=>{const{scenario:e,attachmentsNew:f}=n;(async()=>{let p="",m="";switch(e){case"bizchat-handoff":case"loop-page":S._SPKillSwitch.isActivated("862ab340-3d53-47a8-b264-fb606c0eda0d")||i(S.Guid.newGuid().toString(),"mapping");const e=f?.find(e=>e.type===tn.AttachmentType.MessageKey);p=e?e.id:"",m=e?e.name:"Page";break;default:return}try{let e=await d.getPageMarkdown(l,p);if(!P()){const n=t.listItem?.id??void 0;try{u.log({id:`${n}_ProcessMarkdownImages`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.BizChatPageGenerator.ProcessMarkdownImages",stage:"Start",payload:{timeStamp:Date.now()}});const{markdown:t,imageCount:a}=await async function(e,t,n){const a=[];let i;for(;null!==(i=gc.exec(e));){const[e,t,n,r]=i,o=S.Guid.newGuid().toString(),s=o.substring(o.length-8);a.push({fullMatch:e,alt:t,format:n,data:`data:image/${n};base64,${r}`,guid:s})}const r=new Map;for(const e of a){const a=`loop-image-${e.guid}.png`,i=await bc(e.data,a,t,n,"BizChatPageGenerator");i&&r.set(e.fullMatch,`![${e.alt}](${i})`)}for(const[t,n]of r.entries())e=e.replace(t,n);return{markdown:e,imageCount:a.length}}(e??"",n,c);u.log({id:`${n}_ProcessMarkdownImages`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.BizChatPageGenerator.ProcessMarkdownImages",stage:"End",payload:{result:"Success",timeStamp:Date.now(),extraData:{imageExtractedCount:a}}}),e=t}catch(e){u.log({id:`${n}_ProcessMarkdownImages`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.BizChatPageGenerator.ProcessMarkdownImages",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),error:e}})}}const i=S._SPKillSwitch.isActivated("a3fca41d-607b-4a6b-9e96-413767778c04")?function(e,t){const n=dc.MarkdownHelper.render(e);let a;return a=P()?n.split(/<hr\s*\/?>/i).map(e=>e.trim()).filter(Boolean).map((e,t)=>fc(e,t+1)):n.split(/<hr\s*\/?>/i).map(e=>e.trim()).filter(Boolean).map((e,t)=>pc(e,t+1)).flat(),[B(S.Guid.newGuid().toString(),t,{sectionFactor:0}),...a]}(e??"",m):function(e,t){const n=dc.MarkdownHelper.render(e).split(/<hr\s*\/?>/i).map(e=>e.trim()).filter(Boolean),a=[];for(const[e,t]of n.entries()){const n=/<p>!\[([^\]]*)\]\((\{&quot;.*?\})\)<\/p>/g;let i,r=1,o=0;for(;null!==(i=n.exec(t));){const s=t.substring(o,i.index);if(s.trim())if(P())a.push(fc(s.trim(),e+1,r++));else{const t=pc(s.trim(),e+1,r++);a.push(...t)}const c=i[2],d=$n.HtmlEncoding.decode(c);try{const t=JSON.parse(d);a.push(mc(t,e+1,r++))}catch(t){if(P())a.push(fc(i[0],e+1,r++));else{const t=pc(i[0],e+1,r++);a.push(...t)}}o=n.lastIndex}const s=t.substring(o);if(s.trim())if(P())a.push(fc(s.trim(),e+1,r++));else{const t=pc(s.trim(),e+1,r++);a.push(...t)}}return[B(S.Guid.newGuid().toString(),t,{sectionFactor:0}),...a]}(e??"",m);if(S._SPKillSwitch.isActivated("8e3ed938-054c-48d3-a20f-63e35aa50b04")||n.scenario===v.LoopPage)a(i);else{const e=cc(i,c);a(await e)}s(m),d.removePageMarkdownContent(p),r()}catch(e){if(l.aborted)return;o(e instanceof Ss?e:new Ss(vs.Unknown,e))}})()},[l,d,a,i,r,n,o,s,c,t.listItem,u]),De().createElement(De().Fragment,null)}const yc=ot._LogSource.create("AuthoringCopilot");class Sc{log(e){const{id:t,operation:n,stage:a,...i}=e;ot._TraceLogger.logVerbose(yc,`${n}.${a}.${t} ${JSON.stringify(i)}`)}}function Dc(e){const{pagePrompt:t,zones:n,links:a,onLayoutPageBegin:i,onLayoutPageEnd:o,onGenerateZoneBegin:c,onGenerateZoneEnd:d,onGeneratePageTitleBegin:l,onGeneratePageTitleEnd:u,onReasoningZoneBegin:f,onReasoningZoneEnd:m,onGenerateControlSkip:_,onGenerateControlBegin:h,onGenerateControlUpdate:b,onGenerateControlEnd:g,onStart:v,onFinish:y,onError:D,pageContext:I,onDiagnosticData:x}=e,C=(0,Pr.useAuthoringCopilot)(I.legacyPageContext,(O=t.attachmentsNew||[]).some(e=>e.type===tn.AttachmentType.Meeting)&&!O.some(e=>e.type===tn.AttachmentType.Page||e.type===tn.AttachmentType.Site));var O;const A=ur(),L=ut();return(0,Se.useEffect)(()=>{if(!C)return;const{prompt:e,attachments:O,attachmentsNew:k,template:M,length:P,tone:T,language:U,fidelity:F="Usual"}=t,H=p(e);Xo()&&Yo(H);const R=w()?function(e,t){const n=[],a=[];e.sort((e,t)=>e.attachmentType===tn.AttachmentType.Meeting&&t.attachmentType===tn.AttachmentType.Meeting?(e.hasRecording?0:1)-(t.hasRecording?0:1):0);for(const i of e)switch(i.attachmentType){case tn.AttachmentType.File:if(t?.hasOwnProperty(i.id)){const e=t?.[i.id];n.push({type:Wr.File,webId:e.webId,listId:e.listId,siteId:e.siteId,uniqueId:e.listItemUniqueId,fileName:i.fileName})}break;case tn.AttachmentType.Meeting:a.push({QueryAnnotationType:Yr.Event,id:i.id,text:i.fileName});case tn.AttachmentType.MeetingSeries:}return{dataSources:{files:n,queryAnnotations:a}}}(O,a):function(e){const t=[],n=[];e.sort((e,t)=>e.type===tn.AttachmentType.Meeting&&t.type===tn.AttachmentType.Meeting?(e.hasRecording?0:1)-(t.hasRecording?0:1):0);for(const a of e)switch(a.type){case tn.AttachmentType.File:t.push({type:Wr.File,webId:a.sharepointIds.webId,listId:a.sharepointIds.listId,siteId:a.sharepointIds.siteId,uniqueId:a.sharepointIds.listItemUniqueId,fileName:a.name});break;case tn.AttachmentType.Meeting:n.push({QueryAnnotationType:Yr.Event,id:a.id,text:a.name});case tn.AttachmentType.MeetingSeries:}return{dataSources:{files:t,queryAnnotations:n}}}(k||[]);return(async()=>{E()||v(S.Guid.newGuid().toString(),M?"template":"freePrompt");const a=n.map(e=>e.map(e=>structuredClone(e))),p=e.tokens,x=!M;if(x){let t;if(i(),e.outline)t=function(e,t){if(!e.outline)return;const n=[],a=[];let i=1;if(n.push([ro(e.outline.title)]),i++,ho(t)){const e=S.Guid.newGuid().toString(),t=S.Guid.newGuid().toString();n.push(vo(e,t,i)),a.push(So(t,uo.F4)),i++}for(const t of e.outline.sections){const e=S.Guid.newGuid().toString(),o=S.Guid.newGuid().toString(),c=[{controlType:s.CanvasControlType.RTE,id:o,position:{zoneId:e,zoneIndex:i,sectionIndex:1,controlIndex:1},innerHTML:`<h2><span class="fontColorThemePrimary">${t.title}</span></h2>`}];n.push(c),a.push({type:r.Field,text:t.title,outline:t.content,options:{canvasControls:[{id:o,layout:"p"}]}}),i++}if(_o(t)){const e=S.Guid.newGuid().toString(),t=S.Guid.newGuid().toString();n.push(yo(e,t,i)),a.push(So(t,uo.Xt)),i++}return{targetZones:n,targetTokens:a}}(e,O);else{const n=S.Guid.newGuid().toString();try{L.log({id:n,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageReasoning",stage:"Start",payload:{timeStamp:Date.now()}}),t=await async function(e,t,n,a,i="Usual"){const o=[],c=[];let d=1;const l=ro();var u;o.push([l]),d++;const f=oo(S._SPKillSwitch.isActivated("8ca37d1a-616b-4dec-846a-215d49e3ddbf")?await e.generatePageSkeleton((u=t.template,`Given the following user prompt and any provided documents, generate a list of sections to be included in the page/newsletter.\n\nuser prompt: ${u}\n\nThe response should be in the following format eclosed with the delimiter ${$r}:\n${$r}${JSON.stringify(io,null,2)}${$r}\n\n**Requirements:**\n1. Each section topic should be unique.\n2. The section topic should be plain text without any HTML tags.\n3. The number of sections should be between 1 and 7 if not explicitly specified.\n4. Respect the provided user prompt for the sections.\n`),n,{fidelity:i}):await e.generatePageSkeleton(t.template,n,{fidelity:i}),$r)?.sectionTopics;if(f&&Array.isArray(f)){if(ho(a)){const e=S.Guid.newGuid().toString(),t=S.Guid.newGuid().toString();o.push(vo(e,t,d)),c.push(So(t,uo.F4)),d++}for(const e of f){const t=S.Guid.newGuid().toString(),n=S.Guid.newGuid().toString(),a=[{controlType:s.CanvasControlType.RTE,id:n,position:{zoneId:t,zoneIndex:d,sectionIndex:1,controlIndex:1},innerHTML:`<h3><span class="fontColorThemePrimary">${e}</span></h3>`}];o.push(a),c.push({type:r.Field,text:e,options:{canvasControls:[{id:n,layout:"p"}]}}),d++}if(_o(a)){const e=S.Guid.newGuid().toString(),t=S.Guid.newGuid().toString();o.push(yo(e,t,d)),c.push(So(t,uo.Xt)),d++}return{targetZones:o,targetTokens:c}}}(C,e,R,O,F),L.log({id:n,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageReasoning",stage:"End",payload:{result:"Success",timeStamp:Date.now(),conversationId:C.getConversationId()}})}catch(e){if(L.log({id:n,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageReasoning",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),conversationId:C.getConversationId(),resultCode:e instanceof Pr.AuthoringCopilotError?e.code:void 0,error:e}}),A.aborted)return;return void D(new Ss(vs.PageReasoning,e))}if(A.aborted)return}if(!t)return void D(new Ss(vs.PageReasoning));a.push(...t.targetZones),p.push(...t.targetTokens),o(a)}try{let n=0;const i=new Map,r=a.length;let o;for(let v=0;v<a.length;v++){const y=a[v],w=y.length;if(c(y,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:0,controlState:"NotStarted"}),0===v&&(0,s.hasTitleAreaBannerWebPart)(y)){h(y[0],"",{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:0,controlState:"Started"}),l();const t=y[0];if(L.log({id:t.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle",stage:"Start",payload:{timeStamp:Date.now()}}),o=await Co(C,no(H,e.outline?.title,U),R,F),L.log({id:t.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageTitle",stage:"End",payload:{result:"Success",timeStamp:Date.now(),conversationId:C.getConversationId()}}),A.aborted)return;o&&(t.webPartData.properties.title=o),u(t.webPartData.properties.title),g(t),d(y,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:0,controlState:"Completed"})}else{for(let e=0;e<y.length;e++){let c=y[e];if(!((0,s.isRte)(c)||An()&&zs(c)||En()&&po(c)&&_o(O))){_(c);continue}const d=p.findIndex(e=>e.options?.canvasControls.some(e=>e.id===c.id)),l=o||"Abstract";if(-1===d){if(An()&&(0,s.isWebPart)(c)&&zs(c)){h(c,l,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"Started"});const t=await C.generateImageSuggestion(l),n=Gs(c,t);if(A.aborted)return;g(n)}else if(En()&&(0,s.isWebPart)(c)&&po(c)&&_o(O)){h(c,"",{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"Started"});const t=await bo(c,C,R,H,T);if(A.aborted)return;t&&(mo(c,t,I),c.webPartData=t),g(c)}else _(c);ot._TraceLogger.logError(yc,new Error(`No token found for the control ${c.id}`));continue}const u=p[d],E=u.text.trim()||u.placeholder?.trim();if(!E){if(An()&&(0,s.isWebPart)(c)&&zs(c)){h(c,l,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"Started"});try{L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"Start",payload:{timeStamp:Date.now(),webPartType:"Image"}});const e=await C.generateImageSuggestion(l);c=Gs(c,e),L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"Success",timeStamp:Date.now(),pageType:x?ws.FreePrompt:ws.Template,conversationId:C.getConversationId(),webPartType:"Image"}})}catch(e){L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),conversationId:C.getConversationId(),webPartType:"Image",resultCode:`${Pr.AuthoringCopilotErrorDomain.Default}.ImageGeneration`,error:e}})}if(A.aborted)return;g(c)}else _(c);ot._TraceLogger.logError(yc,new Error(`No token found for the control ${c.id}`));continue}const k=u.options?.canvasControls.filter(e=>a.some(t=>t.some(t=>t.id===e.id&&t.controlType===s.CanvasControlType.RTE)));let N=i.get(d);if(!N){if(1===k.length)N={index:0,subTopics:[E]};else{let t;f(E,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"NotStarted"});try{L.log({id:`${c.id}_SectionReasoning`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.SectionReasoning",stage:"Start",payload:{timeStamp:Date.now()}}),t=await Oo(C,E,k.length,R),L.log({id:`${c.id}_SectionReasoning`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.SectionReasoning",stage:"End",payload:{result:"Success",timeStamp:Date.now(),conversationId:C.getConversationId()}})}catch(e){if(L.log({id:`${c.id}_SectionReasoning`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.SectionReasoning",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),conversationId:C.getConversationId(),resultCode:e instanceof Pr.AuthoringCopilotError?e.code:void 0,error:e}}),A.aborted)return;return void D(new Ss(vs.SectionReasoning,e))}if(A.aborted)return;if(!t)return void D(new Ss(vs.SectionReasoning));N={index:0,subTopics:t.subTopics},m(E,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"NotStarted"})}i.set(d,N)}const B=N.subTopics[N.index];if(h(c,B,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"Started"}),(0,s.isWebPart)(c)){if(zs(c))try{L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"Start",payload:{timeStamp:Date.now(),webPartType:"Image"}});const e=await C.generateImageSuggestion(B);if(c=Gs(c,e),L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"Success",timeStamp:Date.now(),pageType:x?ws.FreePrompt:ws.Template,conversationId:C.getConversationId(),webPartType:"Image"}}),A.aborted)return}catch(e){L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),pageType:x?ws.FreePrompt:ws.Template,conversationId:C.getConversationId(),webPartType:"Image",resultCode:`${Pr.AuthoringCopilotErrorDomain.Default}.ImageGeneration`,error:e}})}else if(po(c)){const e=await bo(c,C,R,H,T);if(A.aborted)return;e&&(mo(c,e,I),c.webPartData=e)}}else{let a;try{L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"Start",payload:{timeStamp:Date.now(),webPartType:"Text"}}),L.log({id:`${c.id}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.FirstChunk",stage:"Start"});const n=c.innerHTML||"";c.innerHTML="";let i=!1;const o=t=>{if(A.aborted)return;if(document.hidden)return;L.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageControlStreaming",stage:"Trigger",payload:{controlId:c.id,timeStamp:Date.now(),isFirstChunk:!i,webPartType:"Text"}}),i||L.log({id:`${c.id}_FirstChunk`,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.FirstChunk",stage:"End",payload:{result:"Success"}}),i=!0;const n=co(t);try{b({control:c,innerHTML:n},{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:e,controlState:"InProgress"}),c.innerHTML=n}catch(e){}};a=await wo(C,H,R,t.prompt.outline?to(u.text,u.outline,U):B,T,P,F||"Usual",n,o,S._SPKillSwitch.isActivated("16f58ed3-6ab9-4a5a-92df-6a84878b17b6")?void 0:M?.uniqueId),L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"Success",timeStamp:Date.now(),length:P,pageType:x?ws.FreePrompt:ws.Template,conversationId:C.getConversationId(),webPartType:"Text"}})}catch(e){if(L.log({id:c.id,operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl",stage:"End",payload:{result:"UnexpectedFailure",timeStamp:Date.now(),conversationId:C.getConversationId(),webPartType:"Text",resultCode:e instanceof Pr.AuthoringCopilotError?e.code:void 0,error:e}}),A.aborted)return;if(n+=1,n>=2)return void D(new Ss(vs.TooManyFailure,e));g(c);continue}if(A.aborted)return;if(a)c.innerHTML=co(a);else if(n+=1,n>=2)return void D(new Ss(vs.TooManyFailure));N.index<N.subTopics.length-1&&(N.index+=1)}g(c)}d(y,{zoneIndex:v,totalZonesCount:r,totalControlsCount:w,controlIndex:y.length-1,controlState:"Completed"})}}y()}catch(e){if(A.aborted)return;D(e instanceof Ss?e:new Ss(vs.Unknown,e))}finally{Xo()&&Jo(C.getConversationId()??"")}})(),()=>{x(C.getDiagnosticData())}},[n,a,A,t,L,i,o,f,m,_,h,g,c,d,l,u,b,D,v,y,C,I,x]),De().createElement(De().Fragment,null)}var Ic,xc,Cc,Oc,wc,Ec,Ac;!function(e){e.Section="Section",e.Control="Control",e.BetweenSections="BetweenSections",e.BetweenControls="BetweenControls"}(Ic||(Ic={})),function(e){e.Regular="Regular",e.Vertical="Vertical"}(xc||(xc={})),function(e){e.BizChat="BizChat",e.KnowledgeAgent="KnowledgeAgent"}(Cc||(Cc={})),function(e){e.Control="Control",e.Section="Section",e.MultiSections="MultiSections",e.RegularLayout="RegularLayout",e.Canvas="Canvas"}(Oc||(Oc={})),function(e){e.RTE="RTE",e.Control="Control",e.Section="Section"}(wc||(wc={})),function(e){e.SmartSection="SmartSection",e.FreePromptGeneration="FreePromptGeneration",e.SitePageGeneration="SitePageGeneration",e.TemplateGeneration="TemplateGeneration",e.BizchatHandoff="BizchatHandoff"}(Ec||(Ec={})),function(e){e.GPT5="GPT5",e.GPT4_1="GPT4_1"}(Ac||(Ac={}));var Lc=ce(6384);function kc(e){let t;const n=ut(),{pagePrompt:a}=e;let i="inference";Mn()&&(i=a?.mode??"inference");let r=ye.AuthoringCopilot;"teams-meeting"===a.scenario&&(r=ye.TeamsHandoff);const o="inference"===i&&!a.template,s="inference"===i&&a.template,c=o&&Hn()||a.scenario===v.BizchatHandoff&&S._SPFlight.isEnabled(1590);switch(i){case"mapping":t=a.scenario===v.BizchatHandoff||a.scenario===v.LoopPage?a.scenario===v.BizchatHandoff&&Un()||a.scenario===v.LoopPage&&Fn()?De().createElement(rn,null,De().createElement(vc,e)):De().createElement(De().Fragment,null):De().createElement(rn,null,De().createElement(Js,e));break;case"inference":t=De().createElement(Dc,e)}return De().useEffect(()=>{n.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.PageGenerator.Generator.Started",stage:"Trigger"});const t=new AbortController;let a;if(s){let t=e;!A()&&e.canvasExtraData?.webPartData?.properties?.aiContextStore&&(t={...e,getControlPrompt:so(e.canvasExtraData)}),a=new Hs({...t,logger:n,serviceType:r}),a.start()}else c&&async function(e,t){const{pagePrompt:n,onUpdateZone:a,onStart:i,onFinish:r,serviceScope:o,onError:s}=e,{scenario:c,attachmentsNew:d}=n,l=p(n.prompt),u=new Lc.AIPropertiesWorkflowExecutor({serviceScope:o}),f=sc();i(S.Guid.newGuid().toString(),"freePrompt");const m={level:Oc.Canvas,pageContextAround:void 0,userPrompt:l,attachments:xo(d??[]),streaming:[wc.RTE,wc.Section,wc.Control],language:n.language,sitePath:(0,Lc.getSitePath)(o),serviceConfig:(0,Lc.getAIPropertiesServiceConfigString)({serviceType:Ec.FreePromptGeneration,length:n.length,tone:n.tone})};if(c===v.BizchatHandoff){const e=n.attachmentsNew?.find(e=>e.type===tn.AttachmentType.MessageKey);if(!e)throw new Ss(vs.InvalidPayload,void 0,"Missing messageKey for Bizchat Handoff");m.userPrompt="Turn the content into a visually appealing sharepoint page while preserving all the text and emoji",m.attachments=[],m.serviceConfig=(0,Lc.getAIPropertiesServiceConfigString)({serviceType:Ec.BizchatHandoff,messageKey:e.id})}try{await u.createAIProperties({featureInstanceId:"copilot-page-generator",featureName:Lc.AIPropertiesFeatureName.FreePromptGeneration,abortSignal:t,request:m,dataReadyCallback:async e=>{r()},streamingCallbacks:{onUpdateSection:async(e,t)=>{let n=e;if(!S._SPKillSwitch.isActivated("18819cbd-f7b9-42ac-a596-fdea8c6677a7")){const t=await cc(e,o,f);n=e.map((e,n)=>{const a=e.position;return{...e,...t[n],position:a}})}a(n,t)}}})}catch(e){e instanceof Lc.AIPropertiesWorkflowError?s(new Ss(vs.ContentGeneration,void 0,e.errorCode)):s(new Ss(vs.Unknown,void 0,e?.message||e))}}(e,t.signal);return()=>{a?.stop(),t.abort()}},[]),c||s?De().createElement(De().Fragment,null):t}const Mc=(0,xe.makeStyles)({finishedBar:{display:"flex",alignItems:"center",justifyContent:"space-between"},buttons:{display:"flex",alignItems:"center",gap:xe.tokens.spacingHorizontalXS},keepButton:{"& span":{lineHeight:"20px",fontSize:xe.tokens.fontSizeBase300,fontWeight:xe.tokens.fontWeightSemibold}},deleteButton:{width:"32px",height:"32px"},feedback:{display:"flex",alignItems:"center",gap:xe.tokens.spacingHorizontalL,whiteSpace:"nowrap"},feedbackButtons:{display:"flex",gap:xe.tokens.spacingHorizontalSNudge,"& button":{maxWidth:"24px",minWidth:"24px",...xe.shorthands.padding(xe.tokens.spacingHorizontalNone)}},errorStateContainer:{borderRadius:"4px",border:"1px 0 0 0"},errorStateText:{fontFamily:"var(--fontFamilyBase)",fontSize:"var(--fontSizeBase200)",fontWeight:"var(--fontWeightRegular)",lineHeight:"var(--lineHeightBase200)",textAlign:"left",wordWrap:"break-word",whiteSpace:"normal"},errorStateMessageButton:{padding:"0px",height:"24px",width:"56px"}}),Pc=tt("ThumbDislike16Filled","16",["M13.1 4.62a3.5 3.5 0 0 0-4.38-2.73L3.77 3.27a2 2 0 0 0-1.43 1.56l-.23 1.2c-.16.87.46 1.64 1.16 1.93.25.1.55.25.85.46a8.22 8.22 0 0 1 3.02 3.92l.28.7c.14.38.28.73.41 1 .11.23.25.46.42.63.19.19.44.33.75.33.36 0 .67-.12.91-.34.24-.2.4-.48.5-.76.22-.55.29-1.25.3-1.9a14.73 14.73 0 0 0-.13-2h.51a2.5 2.5 0 0 0 2.46-2.96l-.46-2.42Z"]),Tc=tt("ThumbDislike16Regular","16",["m10.58 10 .05.45a11 11 0 0 1-.02 2.68c-.07.44-.2.88-.44 1.23-.25.38-.64.64-1.17.64-.52 0-.83-.37-1.02-.7-.2-.31-.36-.75-.54-1.2l-.01-.03c-.55-1.4-1.3-3.31-3.3-4.65-.31-.2-.6-.36-.86-.46-.7-.3-1.32-1.06-1.16-1.94l.23-1.2a2 2 0 0 1 1.43-1.55l4.95-1.38a3.5 3.5 0 0 1 4.37 2.73l.46 2.42A2.5 2.5 0 0 1 11.09 10h-.51Zm1.53-5.2a2.5 2.5 0 0 0-3.13-1.94L4.03 4.23a1 1 0 0 0-.71.78l-.22 1.2c-.06.28.16.66.55.82.31.13.66.31 1.03.55 2.28 1.53 3.13 3.7 3.67 5.11l.01.02c.2.5.33.85.47 1.08A.73.73 0 0 0 9 14c.14 0 .25-.05.35-.2.12-.18.22-.46.28-.83a10.06 10.06 0 0 0-.08-3.12l-.03-.2-.01-.05V9.6A.5.5 0 0 1 10 9h1.09a1.5 1.5 0 0 0 1.47-1.78l-.45-2.42Z"]),Uc=tt("ThumbDislike20Filled","20",["M12.48 18.3c-.8.83-2.09.38-2.43-.6-.28-.8-.64-1.77-1-2.48C8 13.1 7.38 11.9 5.67 10.37c-.23-.2-.52-.36-.84-.49-1.13-.44-2.2-1.61-1.91-3l.35-1.77a2.5 2.5 0 0 1 1.8-1.92l5.6-1.53a4.5 4.5 0 0 1 5.6 3.54l.69 3.76A3 3 0 0 1 14 12.5h-.89l.01.05c.08.41.18.97.24 1.58.07.62.1 1.29.05 1.92a3.68 3.68 0 0 1-.5 1.73c-.11.16-.27.35-.44.52Z"]),Fc=tt("ThumbDislike20Regular","20",["M10.05 17.7c.34.98 1.63 1.43 2.43.6.17-.17.33-.36.44-.52.32-.48.45-1.12.5-1.73.05-.63.02-1.3-.05-1.92-.06-.6-.16-1.17-.24-1.58v-.05H14a3 3 0 0 0 2.95-3.54l-.69-3.76a4.5 4.5 0 0 0-5.6-3.54L5.06 3.2c-.92.25-1.62 1-1.8 1.92l-.35 1.77c-.28 1.39.78 2.56 1.9 3 .33.13.62.3.85.5 1.7 1.5 2.32 2.72 3.38 4.84.36.71.72 1.68 1 2.49Zm1.97-5.58v.04a14.2 14.2 0 0 1 .36 2.08c.06.58.09 1.18.04 1.73-.04.55-.15.98-.33 1.25-.06.1-.18.22-.33.39-.2.2-.63.16-.76-.23-.29-.82-.67-1.83-1.05-2.6-1.07-2.14-1.76-3.5-3.62-5.15-.34-.3-.74-.52-1.13-.68-.88-.34-1.45-1.14-1.3-1.87l.35-1.77c.11-.56.53-1 1.08-1.15l5.6-1.53a3.5 3.5 0 0 1 4.36 2.75l.68 3.76a2 2 0 0 1-1.96 2.36h-1.5a.5.5 0 0 0-.5.62Z"]),Hc=tt("ThumbLike16Filled","16",["M9.58 1.05c-.75-.2-1.34.35-1.55.87-.24.6-.45 1.02-.7 1.53-.16.3-.33.65-.53 1.09-.48 1-.95 1.65-1.3 2.04a4.06 4.06 0 0 1-.5.49h-.02L3.11 8.19a2 2 0 0 0-.86 2.43l.52 1.38a2 2 0 0 0 1.28 1.2l5.35 1.69a2.5 2.5 0 0 0 3.15-1.68l1.36-4.65A2 2 0 0 0 12 6h-1.38l.2-.74c.13-.56.24-1.2.23-1.74-.01-.5-.06-1.02-.27-1.46-.22-.48-.6-.83-1.19-1Zm-4.6 6.03Z"]),Rc=tt("ThumbLike16Regular","16",["M8.03 1.92c.21-.52.8-1.08 1.55-.87.6.17.97.52 1.2 1 .2.44.25.96.26 1.46a7.5 7.5 0 0 1-.24 1.74c-.06.26-.12.51-.19.74h1.38a2 2 0 0 1 1.92 2.56l-1.36 4.65a2.5 2.5 0 0 1-3.15 1.68L4.05 13.2A2 2 0 0 1 2.77 12l-.52-1.4a2 2 0 0 1 .86-2.42l1.87-1.1.02-.01.1-.09c.1-.07.23-.2.4-.4.35-.39.82-1.03 1.3-2.04.2-.44.37-.78.53-1.1.25-.5.46-.92.7-1.52Zm-2.51 6-.02.01-1.88 1.11a1 1 0 0 0-.43 1.22l.52 1.38a1 1 0 0 0 .64.6l5.35 1.68c.8.26 1.65-.2 1.89-1l1.36-4.65A1 1 0 0 0 12 6.99H9.93a.5.5 0 0 1-.48-.67c.1-.28.26-.77.38-1.3.13-.54.22-1.08.2-1.5 0-.46-.05-.8-.16-1.05a.78.78 0 0 0-.56-.45c-.04-.02-.1-.01-.16.03a.54.54 0 0 0-.19.25c-.25.63-.5 1.11-.76 1.65-.16.3-.32.63-.5 1.01a9.52 9.52 0 0 1-1.45 2.28 5.06 5.06 0 0 1-.7.66l-.02.01-.01.01Zm-.54-.84Z"]),Nc=tt("ThumbLike20Filled","20",["M12.48 1.7c-.8-.83-2.09-.38-2.43.6-.28.8-.64 1.77-1 2.48C8 6.9 7.38 8.1 5.67 9.63c-.23.2-.52.36-.84.49-1.13.44-2.2 1.61-1.91 3l.35 1.77a2.5 2.5 0 0 0 1.8 1.92l5.6 1.52a4.5 4.5 0 0 0 5.6-3.53l.69-3.76A3 3 0 0 0 14 7.5h-.89l.01-.05c.08-.41.18-.97.24-1.59.07-.6.1-1.28.05-1.9a3.68 3.68 0 0 0-.5-1.74 4.16 4.16 0 0 0-.44-.52Z"]),Bc=tt("ThumbLike20Regular","20",["M10.05 2.3c.34-.98 1.63-1.43 2.43-.6.17.17.33.36.44.52.32.48.45 1.12.5 1.73.05.63.02 1.3-.05 1.91-.06.62-.16 1.18-.24 1.59v.05H14a3 3 0 0 1 2.95 3.54l-.69 3.76a4.5 4.5 0 0 1-5.6 3.53l-5.6-1.52a2.5 2.5 0 0 1-1.8-1.92l-.35-1.77c-.28-1.39.78-2.56 1.9-3 .33-.13.62-.3.85-.5 1.7-1.5 2.32-2.72 3.38-4.84.36-.71.72-1.68 1-2.49Zm1.97 5.58v-.04a13.7 13.7 0 0 0 .13-.58c.08-.4.17-.93.23-1.5.06-.58.09-1.18.04-1.73a2.73 2.73 0 0 0-.33-1.25 3.26 3.26 0 0 0-.33-.39c-.2-.2-.63-.16-.76.23-.29.82-.67 1.83-1.05 2.6-1.07 2.14-1.76 3.5-3.62 5.15-.34.3-.74.52-1.13.68-.88.34-1.45 1.14-1.3 1.87l.35 1.77c.11.56.53 1 1.08 1.15l5.6 1.53c1.98.54 4-.73 4.36-2.75l.68-3.76a2 2 0 0 0-1.96-2.36h-1.5a.5.5 0 0 1-.5-.62Z"]),jc=pa(Hc,Rc),Vc=pa(Nc,Bc),zc=pa(Pc,Tc),Gc=pa(Uc,Fc),Kc=(0,xe.__styles)({root:{mc9l5x:"f22iagw"},selected:{sj55zd:"f1qj7y59",D0sxk3:"fxoiby5",t6yez3:"f15q0o9g"},disabledSelected:{Bk3fhr4:"ft1hn21",Bmfj8id:"fuxngvv",em6i61:"f1dfjoow",vm6p8p:"f1j98vj9"}},{d:[".f22iagw{display:flex;}",".f1qj7y59{color:var(--colorNeutralForeground2BrandSelected);}",".fxoiby5 .fui-Icon-filled{display:inline;}",".f15q0o9g .fui-Icon-regular{display:none;}"],h:[".ft1hn21:hover .fui-Icon-filled{display:inline;}",".fuxngvv:hover .fui-Icon-regular{display:none;}",".f1dfjoow:hover:active .fui-Icon-filled{display:inline;}",".f1j98vj9:hover:active .fui-Icon-regular{display:none;}"]}),Wc=Se.forwardRef((e,t)=>{const n=((e,t)=>{const n=ui(e.mode),a="sidecar"===n?jc:Vc,i="sidecar"===n?zc:Gc,r="sidecar"===n?"small":"medium";return{mode:n,disabled:e.disabled||!1,selected:e.selected,components:{root:"div",positiveFeedbackButton:jt.Button,positiveFeedbackTooltip:Bn.Tooltip,negativeFeedbackButton:jt.Button,negativeFeedbackTooltip:Bn.Tooltip},root:xe.slot.always((0,xe.getIntrinsicElementProps)("div",{ref:t,...e}),{elementType:"div"}),positiveFeedbackButton:xe.slot.optional(e.positiveFeedbackButton,{defaultProps:{icon:Se.createElement(a,null),size:r,disabled:e.disabled,appearance:"transparent"},elementType:jt.Button,renderByDefault:!0}),positiveFeedbackTooltip:xe.slot.optional(e.positiveFeedbackTooltip,{defaultProps:{relationship:"label",content:"Like",withArrow:!0},elementType:Bn.Tooltip,renderByDefault:!0}),negativeFeedbackButton:xe.slot.optional(e.negativeFeedbackButton,{defaultProps:{icon:Se.createElement(i,null),size:r,disabled:e.disabled,appearance:"transparent"},elementType:jt.Button,renderByDefault:!0}),negativeFeedbackTooltip:xe.slot.optional(e.negativeFeedbackTooltip,{defaultProps:{relationship:"label",content:"Dislike",withArrow:!0},elementType:Bn.Tooltip,renderByDefault:!0})}})(e,t);return(e=>{const t=Kc();e.root.className=(0,xe.mergeClasses)("fai-FeedbackButtons",t.root,e.root.className),e.positiveFeedbackButton&&(e.positiveFeedbackButton.className=(0,xe.mergeClasses)("fai-FeedbackButtons__positiveFeedbackButton","positive"===e.selected&&t.selected,"positive"===e.selected&&e.disabled&&t.disabledSelected,e.positiveFeedbackButton.className)),e.negativeFeedbackButton&&(e.negativeFeedbackButton.className=(0,xe.mergeClasses)("fai-FeedbackButtons__negativeFeedbackButton","negative"===e.selected&&t.selected,"negative"===e.selected&&e.disabled&&t.disabledSelected,e.negativeFeedbackButton.className))})(n),Di("useFeedbackButtonsStyles")(n),(e=>((0,xe.assertSlots)(e),(0,xe.jsxs)(e.root,{children:[e.positiveFeedbackButton&&e.positiveFeedbackTooltip&&(0,xe.jsx)(e.positiveFeedbackTooltip,{children:(0,xe.jsx)(e.positiveFeedbackButton,{})}),e.positiveFeedbackButton&&!e.positiveFeedbackTooltip&&(0,xe.jsx)(e.positiveFeedbackButton,{}),e.negativeFeedbackButton&&e.negativeFeedbackTooltip&&(0,xe.jsx)(e.negativeFeedbackTooltip,{children:(0,xe.jsx)(e.negativeFeedbackButton,{})}),e.negativeFeedbackButton&&!e.negativeFeedbackTooltip&&(0,xe.jsx)(e.negativeFeedbackButton,{})]})))(n)});Wc.displayName="FeedbackButtons";const qc=tt("Checkmark20Regular","20",["M3.37 10.17a.5.5 0 0 0-.74.66l4 4.5c.19.22.52.23.72.02l10.5-10.5a.5.5 0 0 0-.7-.7L7.02 14.27l-3.65-4.1Z"]);var Qc=ce(3048);const Yc=JSON.parse('{"RW":"AI-generated content may be incorrect","gR":"Keep it","Qu":"Discard it","zz":"Dismiss"}'),Jc=e=>{const t=Mc(),[n,a]=De().useState(!0),i=De().useCallback(()=>{a(!1)},[]);return De().createElement(De().Fragment,null,n&&""!==e.errorStateMessage&&De().createElement(cn.MessageBar,{layout:"singleline",intent:"warning",className:t.errorStateContainer},De().createElement(cn.MessageBarBody,{className:t.errorStateText},e.errorStateMessage),De().createElement(cn.MessageBarActions,null,De().createElement(jt.Button,{className:t.errorStateMessageButton,onClick:i},Yc.zz))))},Xc=ot._LogSource.create("CopilotFinishedBar");function Zc(e){const{pagePrompt:t,errorStateMessage:n,onKeep:a,onDelete:i,diagnosticData:r}=e,o=ut(),s=p(t.prompt),{pageContext:c,serviceScope:d}=oa(),l=Mc(),[u,f]=De().useState(void 0),m=t?.template?.uniqueId||S.Guid.newGuid().toString(),_=De().useMemo(()=>({appName:"SharePointAuthoringCopilot",scenario:$c(t),feature:"PageAuthoringCopilot"}),[t]),{canDisplay:h}=(0,Qc.useCanDisplayFeedback)({serviceScope:d,overrideOptions:_}),b=(n,a)=>{if(ot._TraceLogger.logVerbose(Xc,`Page Copilot feedback logged: ${n?"positive":"negative"}, correlationId: ${a}`),!u||u!==(n?"positive":"negative")){const e=c.legacyPageContext.aadSessionId,i=c.legacyPageContext.siteId;Qc.PagesCopilotFeedback.getInstance(d,e,_).logCopilotUserFeedback({message:{id:a,plainText:"",prompt:s},positive:n,conversationId:r?.conversationId,userQueryIds:JSON.stringify(r?.userQueryIds),siteId:i},function(e,t){return{onDismiss(n){e.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Dismiss",stage:"Trigger",payload:{...t,isFeedbackSent:n}})},onSuccess(){e.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Success",stage:"Trigger",payload:t})},onError(){e.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Error",stage:"Trigger",payload:t})}}}(o,{feedbackIsPositive:n,pageTemplateId:t.template?.uniqueId}))}f(n?"positive"===u?void 0:"positive":"negative"===u?void 0:"negative"),o.log({id:S.Guid.newGuid().toString(),operation:n?"AuthoringCopilot.Page.Generation.FinshedBar.ThumbsUp.Click":"AuthoringCopilot.Page.Generation.FinshedBar.ThumbsDown.Click",stage:"Trigger",payload:{stopReason:e.generatorState}})},g=De().useCallback(()=>{o.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.KeepIt.Click",stage:"Trigger",payload:{stopReason:e.generatorState}}),a()},[a,o,e.generatorState]),v=De().useCallback(()=>{o.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.Discard.Click",stage:"Trigger",payload:{stopReason:e.generatorState}}),i()},[i,o,e.generatorState]);De().useEffect(()=>(o.log({id:S.Guid.newGuid().toString(),operation:"AuthoringCopilot.Page.Generation.FinshedBar.Dialog.Mount",stage:"Trigger",payload:{pageTemplateId:t.template?.uniqueId,isSuccess:!e.errorStateMessage}}),()=>{Qc.PagesCopilotFeedback.getInstance(d,void 0).dispose()}),[]);const y=h?De().createElement("div",{className:l.feedbackButtons},De().createElement(Wc,{"aria-label":Yc.RW,selected:u,positiveFeedbackButton:{onClick:()=>{b(!0,m)}},negativeFeedbackButton:{onClick:()=>{b(!1,m)}}})):De().createElement(De().Fragment,null);return De().createElement(De().Fragment,null,De().createElement(Jc,{errorStateMessage:n}),De().createElement("div",{className:l.finishedBar},De().createElement("div",{className:l.buttons},De().createElement(jt.Button,{className:l.keepButton,appearance:"primary",icon:De().createElement(qc,null),onClick:g,autoFocus:!0},Yc.gR),De().createElement(Bn.Tooltip,{content:Yc.Qu,relationship:"label",withArrow:!0},De().createElement(jt.Button,{className:l.deleteButton,icon:De().createElement(fn,null),onClick:v}))),De().createElement("div",{className:l.feedback},De().createElement(rt.Text,{size:200},Yc.RW),y)))}function $c(e){return e.scenario??(e.template?"CustomizeTemplate":"FreePrompt")}class ed{log(e){switch(e.stage){case"Start":{let t=e.operation;(!S._SPKillSwitch.isActivated("69e713f0-2145-4a4b-bc67-250f8abb2185")&&"AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePage"===e.operation||!S._SPKillSwitch.isActivated("ab61c098-9f76-40e4-b382-d6feaffa641a")&&"AuthoringCopilot.Page.Generation.PageGenerator.Generator.FirstChunk"===e.operation&&"teams-meeting"===this._commonParams.scenario)&&(t+=this._getScenarioName());const n=new ot._QosMonitor(t);this._qosMonitor.set(e.id,n)}break;case"End":const t=this._qosMonitor.get(e.id);if(t){switch(e.payload.result){case"Success":t.writeSuccess(this.getExtraData(e.payload.extraData));break;case"ExpectedFailure":t.writeExpectedFailure(e.payload.resultCode,e.payload.error,this.getExtraData(e.payload.extraData));break;case"UnexpectedFailure":t.writeUnexpectedFailure(e.payload.resultCode,e.payload.error,this.getExtraData(e.payload.extraData))}this._qosMonitor.delete(e.id)}}}getExtraData(e){let t={...this._commonParams};return e&&(t={...t,...e}),t}_getScenarioName(){switch(this._commonParams.scenario){case"teams-meeting":return"ForTeamsMeeting";case"planner-report":return"WithMapping";case"bizchat-handoff":return"WithBizChatHandoff";case"loop-page":return"WithLoopHandoff";default:return this._commonParams.templateId?"WithTemplate":"WithFreePrompt"}}constructor(e={}){this._qosMonitor=new Map,this._commonParams=e}}class td{log(e){const t=this._commonParams;switch(e.operation){case"AuthoringCopilot.Page.Creation.WizardDialog.Host.Mount":case"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.Open":case"AuthoringCopilot.Page.Creation.WizardDialog.Dialog.Close":case"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Mount":case"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Close":case"AuthoringCopilot.Page.Creation.TemplateGallery.FRE.Dismiss":case"AuthoringCopilot.Page.Creation.TemplateGallery.FreePromptTrigger.Click":case"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Mount":case"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Dismiss":case"AuthoringCopilot.Page.Creation.HighFidelityMenu.FRE.Close":case"AuthoringCopilot.Page.Creation.PromptEditorBox.FreePromptEditor.Edit":case"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Select":case"AuthoringCopilot.Page.Creation.CustomizePrompt.Attachment.Remove":case"AuthoringCopilot.Page.Creation.CustomizePrompt.PromptEditor.Edit":case"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Select":case"AuthoringCopilot.Page.Creation.FreePrompt.Attachment.Remove":case"AuthoringCopilot.Page.Creation.PromptEditorBox.Attachment.Select":case"AuthoringCopilot.Page.Creation.PromptEditorBox.Attachment.Remove":case"AuthoringCopilot.Page.Creation.FreePrompt.PromptEditor.Edit":case"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Close":case"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Open":case"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Refresh":case"AuthoringCopilot.Page.Creation.FreePrompt.PromptSuggestion.Select":case"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Open":case"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Select":case"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Close":case"AuthoringCopilot.Page.Creation.PromptEditorBox.PromptSuggestion.Refresh":case"AuthoringCopilot.Page.Creation.PromptEditorBox.EditButton.Click":case"AuthoringCopilot.Page.Creation.PromptEditorBox.CancelButton.Click":case"AuthoringCopilot.Page.HandOff.CopilotAuthoring.TeamsHandoff.Render":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation)});break;case"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Add":case"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Delete":case"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Reorder":case"AuthoringCopilot.Page.Creation.PageBuilder.Outline.Stop":case"AuthoringCopilot.Page.Creation.PageBuilder.OutlineAdder.Stop":case"AuthoringCopilot.Page.Creation.PageBuilder.GoBack.Click":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{actionId:e.id}});break;case"AuthoringCopilot.Page.Creation.TemplateGallery.TemplateCard.Click":case"AuthoringCopilot.Page.Generation.InProgress.Stop.Click":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,pageTemplateId:e.payload.pageTemplateId}});break;case"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Error":case"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Success":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,pageTemplateId:e.payload.pageTemplateId,feedbackIsPositive:e.payload.feedbackIsPositive}});break;case"AuthoringCopilot.Page.Generation.FinshedBar.ThumbsUp.Click":case"AuthoringCopilot.Page.Generation.FinshedBar.ThumbsDown.Click":case"AuthoringCopilot.Page.Generation.FinshedBar.KeepIt.Click":case"AuthoringCopilot.Page.Generation.FinshedBar.Discard.Click":let n=[],a={};this._defaultPayload&&({attachments:n=[],...a}=this._defaultPayload),ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,...a,stopReason:e.payload.stopReason,attachmentCount:n.length,attachmentInfo:On(n??[]),actionId:this._actionId}});break;case"AuthoringCopilot.Page.Generation.FinshedBar.Dialog.Mount":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,pageTemplateId:e.payload.pageTemplateId,isSuccess:e.payload.isSuccess,actionId:this._actionId,...this._defaultExtraData}});break;case"AuthoringCopilot.Page.Creation.TemplateGallery.Category.Select":case"AuthoringCopilot.Page.Creation.FreePrompt.Category.Select":case"AuthoringCopilot.Page.Creation.PageBuilder.Category.Select":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{pageTemplateCategory:e.payload.category}});break;case"AuthoringCopilot.Page.Creation.CustomizePrompt.Create.Click":case"AuthoringCopilot.Page.Creation.FreePrompt.Create.Click":case"AuthoringCopilot.Page.Creation.PageBuilder.Create.Click":case"AuthoringCopilot.Page.HandOff.CopilotAuthoring.Create.Click":case"AuthoringCopilot.Page.HandOff.SiteSelectionAuthoring.AutoCreate.Click":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{pageTemplateId:e.payload.pageTemplateId,isPrivateAuthoring:e.payload.isPrivateAuthoring,pageTemplateCategory:e.payload.pageTemplateCategory,tone:e.payload.tone,length:e.payload.length,attachmentInfo:On(e.payload.attachments),attachmentCount:e.payload.attachments.length,language:e.payload.language||"",fidelity:e.payload.fidelity||"",hasOutline:e.payload.hasOutline,..."regenerationCount"in e.payload&&void 0!==e.payload.regenerationCount&&{regenerationCount:e.payload.regenerationCount}}});break;case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.Started":this._actionId=S.Guid.newGuid().toString(),ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...this._defaultExtraData,actionId:this._actionId}});break;case"AuthoringCopilot.Page.Generation.PageGenerator.Generator.Finished":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,generationStatus:e.payload.generationStatus,...this._defaultExtraData,actionId:this._actionId}});break;case"AuthoringCopilot.Page.Generation.FinshedBar.OCV.Dismiss":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{...t,pageTemplateId:e.payload.pageTemplateId,isFeedbackSent:e.payload.isFeedbackSent,feedbackIsPositive:e.payload.feedbackIsPositive}});break;case"AuthoringCopilot.Page.Creation.PageBuilder.PromptEditor.Submit":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{pageTemplateCategory:e.payload.pageTemplateCategory,fidelity:e.payload.fidelity||"",attachmentInfo:On(e.payload.attachments),attachmentCount:e.payload.attachments.length,regenerationCount:e.payload.regenerationCount}});break;case"AuthoringCopilot.Page.Creation.PromptEditorBox.AttachmentsTag.Click":ot._EngagementLogger.log({name:this._buildEngagementEventName(e.operation),extraData:{attachmentInfo:e.payload.attachmentInfo}})}}_buildEngagementEventName(e){const[t,n,a,i,r,o]=e.split(".");return`${t}${n}${a}.${i}${r}.${o}`}constructor(e={},t){this._defaultExtraData=void 0,this._actionId="00000000-0000-0000-0000-000000000000",this._commonParams=e,this._defaultPayload=t,t&&(this._defaultExtraData={pageTemplateId:t?.pageTemplateId,isPrivateAuthoring:t?.isPrivateAuthoring,pageTemplateCategory:t?.pageTemplateCategory,tone:t?.tone,length:t?.length,attachmentInfo:On(t?.attachments),attachmentCount:t?.attachments.length,language:t?.language||"",fidelity:t?.fidelity||"",hasOutline:t?.hasOutline})}}class nd{log(e){if(S._SPFlight.isDebugFlightEnabled){const t=`${e.operation}.${e.stage}.${e.id}`;switch(window.performance.mark(t),e.stage){case"End":{const t=`${e.operation}.Start.${e.id}`,n=`${e.operation}.End.${e.id}`;window.performance.measure(`${e.operation}.Total.${e.id}`,t,n)}break;case"Trigger":if("AuthoringCopilot.Page.Generation.PageGenerator.Generator.PageControlStreaming"===e.operation&&e.payload.isFirstChunk){const t=`AuthoringCopilot.Page.Generation.PageGenerator.Generator.GeneratePageControl.Start.${e.payload.controlId}`,n=`${e.operation}.Trigger.${e.id}`;window.performance.measure(`${e.operation}.FirstChunk.${e.payload.controlId}`,t,n)}else if("AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.PageControlStreaming"===e.operation&&e.payload.isFirstChunk){const t=`AuthoringCopilot.Page.Generation.PageGenerator.MappingPageGenerator.GeneratePageControl.Start.${e.payload.controlId}`,n=`${e.operation}.Trigger.${e.id}`;window.performance.measure(`${e.operation}.FirstChunk.${e.payload.controlId}`,t,n)}}}}}class ad{constructor(e){ad.assign(ad,this,e)}static getTypeName(){return"AugLoop_Core_SchemaObject"}static getBaseTypes(){return[]}static getTypeNameFor(e){return e&&e.H_?e.H_.T_:void 0}static getBaseTypesFor(e){return e&&e.H_&&e.H_.B_&&Array.isArray(e.H_.B_)?e.H_.B_:[]}static getAllTypesFor(e){const t=ad.getTypeNameFor(e);return t?[t,...ad.getBaseTypesFor(e)]:[]}static matchesTypesFor(e,t){if(!Array.isArray(t)||0===t.length)return!0;const n=ad.getTypeNameFor(e),a=ad.getBaseTypesFor(e);for(const e of t){if(e===n)return!0;if(a.indexOf(e)>=0)return!0}return!1}static assign(e,t,n){if(n)for(const e of Object.keys(n))t[e]=n[e];return t.H_=e.H_,t}}ad.H_={T_:ad.getTypeName(),B_:ad.getBaseTypes()};class id{constructor(e){ad.assign(id,this,e)}static getTypeName(){return"AugLoop_Core_ItemDelta"}static getBaseTypes(){return[]}static typeGuard(e){return ad.matchesTypesFor(e,[id.getTypeName()])}}id.H_={T_:id.getTypeName(),B_:id.getBaseTypes()};class rd{constructor(e){ad.assign(rd,this,e)}static getTypeName(){return"AugLoop_Core_ItemChangesDelta"}static getBaseTypes(){return["AugLoop_Core_ItemDelta"]}static typeGuard(e){return ad.matchesTypesFor(e,[rd.getTypeName()])}}rd.H_={T_:rd.getTypeName(),B_:rd.getBaseTypes()};class od{constructor(e){ad.assign(od,this,e)}static getTypeName(){return"AugLoop_Core_Operation"}static getBaseTypes(){return[]}static typeGuard(e){return ad.matchesTypesFor(e,[od.getTypeName()])}}od.H_={T_:od.getTypeName(),B_:od.getBaseTypes()};class sd{constructor(e){ad.assign(sd,this,e)}static getTypeName(){return"AugLoop_Core_OperationWithSiblingContext"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[sd.getTypeName()])}}sd.H_={T_:sd.getTypeName(),B_:sd.getBaseTypes()};class cd{constructor(e){ad.assign(cd,this,e)}static getTypeName(){return"AugLoop_Core_AddOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[cd.getTypeName()])}}cd.H_={T_:cd.getTypeName(),B_:cd.getBaseTypes()};class dd{constructor(e){ad.assign(dd,this,e)}static getTypeName(){return"AugLoop_Core_MoveOperation"}static getBaseTypes(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[dd.getTypeName()])}}dd.H_={T_:dd.getTypeName(),B_:dd.getBaseTypes()};class ld{constructor(e){ad.assign(ld,this,e)}static getTypeName(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[ld.getTypeName()])}}ld.H_={T_:ld.getTypeName(),B_:ld.getBaseTypes()};class ud{constructor(e){ad.assign(ud,this,e)}static getTypeName(){return"AugLoop_Core_UpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[ud.getTypeName()])}}ud.H_={T_:ud.getTypeName(),B_:ud.getBaseTypes()};class fd{constructor(e){ad.assign(fd,this,e)}static getTypeName(){return"AugLoop_Core_DeleteOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[fd.getTypeName()])}}fd.H_={T_:fd.getTypeName(),B_:fd.getBaseTypes()};class pd{constructor(e){ad.assign(pd,this,e)}static getTypeName(){return"AugLoop_Core_PurgeOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[pd.getTypeName()])}}pd.H_={T_:pd.getTypeName(),B_:pd.getBaseTypes()};class md{constructor(e){ad.assign(md,this,e)}static getTypeName(){return"AugLoop_Core_PurgeSubtreeExceptTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[md.getTypeName()])}}md.H_={T_:md.getTypeName(),B_:md.getBaseTypes()};class _d{constructor(e){ad.assign(_d,this,e)}static getTypeName(){return"AugLoop_Core_PurgeByTypesOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[_d.getTypeName()])}}_d.H_={T_:_d.getTypeName(),B_:_d.getBaseTypes()};class hd{constructor(e){ad.assign(hd,this,e)}static getTypeName(){return"AugLoop_Core_FocusOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[hd.getTypeName()])}}hd.H_={T_:hd.getTypeName(),B_:hd.getBaseTypes()};class bd{constructor(e){ad.assign(bd,this,e)}static getTypeName(){return"AugLoop_Core_VisibilityOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[bd.getTypeName()])}}bd.H_={T_:bd.getTypeName(),B_:bd.getBaseTypes()};class gd{constructor(e){ad.assign(gd,this,e)}static getTypeName(){return"AugLoop_Core_DeltaUpdateOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[gd.getTypeName()])}}gd.H_={T_:gd.getTypeName(),B_:gd.getBaseTypes()};class vd{constructor(e){ad.assign(vd,this,e)}static getTypeName(){return"AugLoop_Core_MicroSyncOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[vd.getTypeName()])}}vd.H_={T_:vd.getTypeName(),B_:vd.getBaseTypes()};class yd{constructor(e){ad.assign(yd,this,e)}static getTypeName(){return"AugLoop_Signals_SignalOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[yd.getTypeName()])}}yd.H_={T_:yd.getTypeName(),B_:yd.getBaseTypes()};class Sd{constructor(e){ad.assign(Sd,this,e)}static getTypeName(){return"AugLoop_Core_CancelSignalTriggeredWorkflowExecutionOperation"}static getBaseTypes(){return["AugLoop_Core_Operation"]}static typeGuard(e){return ad.matchesTypesFor(e,[Sd.getTypeName()])}}Sd.H_={T_:Sd.getTypeName(),B_:Sd.getBaseTypes()};class Dd{constructor(e){ad.assign(Dd,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderBaseSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ad.matchesTypesFor(e,[Dd.getTypeName()])}}Dd.H_={T_:Dd.getTypeName(),B_:Dd.getBaseTypes()};class Id{constructor(e){ad.assign(Id,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderMessageSignal"}static getBaseTypes(){return["AugLoop_VibeSiteBuilder_SiteBuilderBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return ad.matchesTypesFor(e,[Id.getTypeName()])}}Id.H_={T_:Id.getTypeName(),B_:Id.getBaseTypes()};class xd{constructor(e){ad.assign(xd,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderClientToolExecutionResultSignal"}static getBaseTypes(){return["AugLoop_VibeSiteBuilder_SiteBuilderBaseSignal","AugLoop_Signals_Signal"]}static typeGuard(e){return ad.matchesTypesFor(e,[xd.getTypeName()])}}xd.H_={T_:xd.getTypeName(),B_:xd.getBaseTypes()};class Cd{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ad.assign(Cd,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderReplyMessageAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ad.matchesTypesFor(e,[Cd.getTypeName()])}}Cd.H_={T_:Cd.getTypeName(),B_:Cd.getBaseTypes()};class Od{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ad.assign(Od,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderToolsExecuteAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ad.matchesTypesFor(e,[Od.getTypeName()])}}Od.H_={T_:Od.getTypeName(),B_:Od.getBaseTypes()};class wd{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ad.assign(wd,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderFollowUpSuggestionAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ad.matchesTypesFor(e,[wd.getTypeName()])}}wd.H_={T_:wd.getTypeName(),B_:wd.getBaseTypes()};class Ed{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ad.assign(Ed,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_SiteBuilderBlueprintAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ad.matchesTypesFor(e,[Ed.getTypeName()])}}Ed.H_={T_:Ed.getTypeName(),B_:Ed.getBaseTypes()};class Ad{constructor(e){ad.assign(Ad,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_DesignSPPageSignal"}static getBaseTypes(){return["AugLoop_Signals_Signal"]}static typeGuard(e){return ad.matchesTypesFor(e,[Ad.getTypeName()])}}Ad.H_={T_:Ad.getTypeName(),B_:Ad.getBaseTypes()};class Ld{get metadata(){return this.M_}set metadata(e){this.M_=e}constructor(e){ad.assign(Ld,this,e)}static getTypeName(){return"AugLoop_VibeSiteBuilder_DesignSPPageAnnotation"}static getBaseTypes(){return["AugLoop_Core_Annotation"]}static typeGuard(e){return ad.matchesTypesFor(e,[Ld.getTypeName()])}}Ld.H_={T_:Ld.getTypeName(),B_:Ld.getBaseTypes()};const kd=Object.values(Ds.WEB_PART_ID_MAP);function Md(e){return(0,s.isWebPart)(e)&&kd.includes(e.webPartId)?[!0,{manifestId:e.webPartId}]:(0,s.isRte)(e)?[!0,{manifestId:Ds.WEB_PART_ID_MAP.TextWebPart}]:[!1]}function Pd(e,t){for(const n of e.children){if("id"in n&&n.id===t)return n.relayContent;if("children"in n){const e=Pd(n,t);if(void 0!==e)return e}}}class Td{dispose(){this._session?.dispose()}async designPageLayout(e,t,n){const a=new ot._QosMonitor("SPDesignPageClient.DesignPage"),i=new cd({parentPath:["session"],items:[{id:S.Guid.newGuid().toString(),body:new Ad({prompt:e,resources:t||[],conversationId:n||""})}]});return new Promise((e,t)=>{this._session?.submit(i,i=>{try{if(Ld.typeGuard(i)){const t=JSON.parse(i.data);a.writeSuccess(),n=i.conversationId,e({data:t,conversationId:n,canvasContent:(0,Ds.toCanvasContent)(t)})}}catch(e){a.writeUnexpectedFailure("DesignPageAnnotationError",void 0,{conversationId:n,routingSessionKey:this._session?.routingSessionKey}),t("annotation type error")}}).catch(e=>{a.writeUnexpectedFailure("DesignPageSubmitError",void 0,{conversationId:n,routingSessionKey:this._session?.routingSessionKey}),t("submit operation error")})})}async createPageByCopilot(e,t,n,a){const i=new ot._QosMonitor("SPDesignPageClient.CreatePageByCopilot");try{const r=await this.designPageLayout(e,t,a),o=r.canvasContent,c=function(e,t){const n=[],a=e.controls;for(let t=0;t<a.length;t++){const i=a[t],[r,o]=Md(i);if(!r)continue;const s=e.canvasExtraData?.webPartData?.properties?.aiContextStore?.[i.id].userPrompt;s&&n.push({id:i.id,scenarioId:o.manifestId,aiContext:{prompt:s}})}return{aiContext:{prompt:t},children:n}}(o,n||e),d=new Pr.SPPageGenerationClient(this._context,()=>{},()=>{},()=>{}),l=await d.generatePage(c,{conversationModeBatchedControlNumber:5,serviceType:Pr.PageGenerationServiceType.AuthoringCopilot},t);a=r.conversationId;for(let e=0;e<o.controls.length;e++){const t=o.controls[e],[n,a]=Md(t);if(!n)continue;const i=Pd(l,t.id);if(i)if((0,s.isRte)(t))t.innerHTML=lo(i.html);else if((0,s.isWebPart)(t)){const e=(0,Ds.getRelay)(a.manifestId);if(e){let n;n=a.manifestId===Ds.WEB_PART_ID_MAP.ImageWebPart?new e({postProcessConfig:{aspectRatioOnLoad:t.webPartData.properties.aspectRatioOnLoad||t.webPartData.properties.cropWidth/(t.webPartData.properties.cropHeight||1)||t.webPartData.properties.imgWidth/(t.webPartData.properties.imgHeight||1)||void 0}}):new e;let r=t.webPartData;a.manifestId===Ds.WEB_PART_ID_MAP.StreamWebPart&&(r=void 0),t.webPartData=r?await n.postProcessWithBaseWebPartData(t.webPartData,i):await n.postProcessor(i)}}}return i.writeSuccess(),o}catch(e){throw i.writeUnexpectedFailure("CreatePageByCopilotError",void 0,{conversationId:a,routingSessionKey:this._session?.routingSessionKey}),e}}constructor(e){this._context=e.consume(wn.PageContext.serviceKey).legacyPageContext,this._serviceScope=e,this._session=new Pr.AugloopSession(this._context,{appName:"SharepointAuthoringCopilot",aadSessionId:this._context.aadSessionId||"",flights:"enableFluxV3:true"},[Ld.getTypeName()]);const t=new Pr.PageAuthoringCopilotClient(this._context);let n;(0,Ds.injectPostProcessor)(Ds.InjectionAllowedPostProcess.ImageDescriptionToUrl,async e=>{const n=await t.generateImageSuggestionWithoutTranslation(e);if(n)return n}),(0,Ds.injectPostProcessor)(Ds.InjectionAllowedPostProcess.SanitizePeopleInfo,async e=>{n||(n=new Ls.PeopleDataProvider(this._serviceScope,"AuthoringCopilot"));const t=await n.getPeopleInfo(e);return t.email&&t.role?{name:t.name,email:t.email,role:t.role}:void 0})}}var Ud=ce(1853);class Fd{async createPageByCopilot(e,t,n){const a=await Lc.ManifestClient.getInstance(this._serviceScope).getWebPartManifestsForAIProperties();let i;if(n){const e=(0,Ud.getAIPropertiesFromCanvasContent)(n,a).canvas;i=JSON.stringify(e)}return new Promise((n,r)=>{new Lc.AIPropertiesWorkflowExecutor({serviceScope:this._serviceScope}).createAIProperties({featureInstanceId:"vibe-site-builder-page-generation",featureName:Lc.AIPropertiesFeatureName.FreePromptGeneration,request:{level:Oc.Canvas,pageContextAround:{},contentToRewrite:i,userPrompt:e,attachments:t??[],sitePath:(0,Lc.getSitePath)(this._serviceScope),serviceConfig:JSON.stringify({serviceType:"SitePageGeneration"})},dataReadyCallback:async e=>{const t=(0,Lc.fromAICanvasResultToRaw)(e.aiPropertiesResult,a),i=await(0,Lc.fromAICanvasRawDataToCanvasContentAsync)(t);n(i)}}).catch(e=>{r(e)})})}constructor(e){this._serviceScope=e}}})(),pe})())})();