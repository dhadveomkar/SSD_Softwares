define("8ac0c53c-e8d0-4e3e-87d0-7449eb0d4027_1.1.100",["react","@ms/office-ui-fabric-react-bundle","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@msinternal/odsp-utilities-bundle","@microsoft/load-themed-styles","@msinternal/sp-fluentui-migration-choicegroup-bundle","@msinternal/sp-fluentui-v9-react-tooltip-bundle","@msinternal/sp-fluentui-v9-react-button-bundle","@msinternal/sp-fluentui-v9-utilities-bundle","@msinternal/swc-helpers-bundle","@msinternal/sharepoint-ui-tokens-bundle"],(e,t,n,a,i,r,o,s,c,d,l,u)=>(()=>{"use strict";var f={424:e=>{e.exports=r},676:e=>{e.exports=n},207:e=>{e.exports=a},141:e=>{e.exports=t},810:e=>{e.exports=i},930:e=>{e.exports=u},522:e=>{e.exports=o},526:e=>{e.exports=c},589:e=>{e.exports=s},606:e=>{e.exports=d},592:e=>{e.exports=l},959:t=>{t.exports=e}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={exports:{}};return f[e](n,n.exports,m),n.exports}m.d=(e,t)=>{for(var n in t)m.o(t,n)&&!m.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var _={};return(()=>{m.r(_),m.d(_,{CAROUSEL_CONSTANTS:()=>$,Carousel:()=>oe,CarouselLayout:()=>Z,CarouselLayoutLoader:()=>se,getItemWidth:()=>ie});var e=m(592),t=m(959),n=m(141),a=m(676),i=m(207),r=m(810),o=m(424);(0,o.loadStyles)([{rawString:".ms-odsp-screenReaderAlert{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}"}]);class s extends t.PureComponent{static read(e,t){if(e){const n=document.createTextNode(e);s._getDedicatedDomNode(t||1).appendChild(n)}}static _getDedicatedDomNode(e){s._alertNode&&document.body.removeChild(s._alertNode);const t=document.createElement("div");switch(t.setAttribute("data-automation-id","screen-reader-alert-static"),t.classList.add("ms-odsp-screenReaderAlert"),e){case 1:t.setAttribute("aria-live","polite");break;case 2:t.setAttribute("role","alert"),t.setAttribute("aria-live","assertive")}return document.body.appendChild(t),s._alertNode=t,s._alertNode}componentDidMount(){s.read(this.props.message,this.props.readingMode)}componentDidUpdate(e){e.message===this.props.message&&e.indicator===this.props.indicator||s.read(this.props.message,this.props.readingMode)}render(){return!1}}var c=m(589),d=m(526);const l=t.createContext(void 0),u={};l.Provider;var f=m(606);const p=(0,f.__styles)({root:{mc9l5x:"f1w7gpdv",Bg96gwp:"fez10in",ycbfsm:"fg4l7m0"},rtl:{Bz10aip:"f13rod7r"}},{d:[".f1w7gpdv{display:inline;}",".fez10in{line-height:0;}",".f13rod7r{-webkit-transform:scaleX(-1);-moz-transform:scaleX(-1);-ms-transform:scaleX(-1);transform:scaleX(-1);}"],t:["@media (forced-colors: active){.fg4l7m0{forced-color-adjust:auto;}}"]}),h=(e,n)=>{const{title:a,primaryFill:i="currentColor",...r}=e,o={...r,title:void 0,fill:i},s=p(),c=t.useContext(l)?t.useContext(l):u;return o.className=(0,f.mergeClasses)(s.root,(null==n?void 0:n.flipInRtl)&&"rtl"===(null==c?void 0:c.textDirection)&&s.rtl,o.className),a&&(o["aria-label"]=a),o["aria-label"]||o["aria-labelledby"]?o.role="img":o["aria-hidden"]=!0,o},b=(e,n,a,i)=>{const r="1em"===n?"20":n,o=t.forwardRef((e,o)=>{const s={...h(e,{flipInRtl:null==i?void 0:i.flipInRtl}),ref:o,width:n,height:n,viewBox:`0 0 ${r} ${r}`,xmlns:"http://www.w3.org/2000/svg"};return"string"==typeof a?t.createElement("svg",{...s,dangerouslySetInnerHTML:{__html:a}}):t.createElement("svg",s,...a.map(e=>t.createElement("path",{d:e,fill:s.fill})))});return o.displayName=e,o},g=b("PauseCircleRegular","1em",["M10 2a8 8 0 1 1 0 16 8 8 0 0 1 0-16Zm0 1a7 7 0 1 0 0 14 7 7 0 0 0 0-14ZM8.5 6.5c.28 0 .5.22.5.5v6a.5.5 0 0 1-1 0V7c0-.28.22-.5.5-.5Zm3 0c.28 0 .5.22.5.5v6a.5.5 0 0 1-1 0V7c0-.28.22-.5.5-.5Z"]),v=b("PlayCircleRegular","1em",["M9.13 7.18A.75.75 0 0 0 8 7.83v4.34c0 .57.63.94 1.13.65l4.12-2.39a.5.5 0 0 0 0-.86L9.13 7.18ZM2 10a8 8 0 1 1 16 0 8 8 0 0 1-16 0Zm8-7a7 7 0 1 0 0 14 7 7 0 0 0 0-14Z"]);function y(){return a._SPKillSwitch.isActivated("6078875c-7741-4b4a-b493-c5f41d031db6")}function S(){return a._SPKillSwitch.isActivated("ebb0d81c-9278-4eac-9578-042b3df18269")}function D(){return a._SPKillSwitch.isActivated("e849a113-7ee1-425e-b102-ade0ada538d5")}function I(){return a._SPKillSwitch.isActivated("0f38f30d-23b2-4733-8c69-a4934752c634")}function x(){return a._SPKillSwitch.isActivated("12568db2-652e-4ec3-85bd-14630634707c")}function C(){return a._SPKillSwitch.isActivated("568b7ae1-4bcf-468d-b171-883945d19f5c")}function O(){return a._SPKillSwitch.isActivated("5380be73-e574-4d02-b8ce-dd291e35ad08")}function w(){return a._SPKillSwitch.isActivated("6276bef1-578e-4daf-bbd8-88a8d33dfe16")}function E(){return a._SPKillSwitch.isActivated("09957c4a-b6b4-4699-ae2f-67f520045269")}function A(){return a._SPKillSwitch.isActivated("6380d0a8-3758-4c34-904c-28a97d038a6c")}const L={carouselDotSelected:`carouselDotSelected-${Math.random().toString().substr(2,5)}`};o.loadStyles('.c_Zp8sF_fgCY4{position:relative}.c_Zp8sF_fgCY4:hover .c_V_hFe_fgCY4{opacity:1}.c_Zp8sF_fgCY4 .c_V_hFe_fgCY4{font-size:28px;height:36px;opacity:0;outline:0;position:absolute;top:calc(50% - 18px);width:36px;z-index:1}.c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.a_YDOwR_fgCY4{opacity:.65}.c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.a_YDOwR_fgCY4:hover{opacity:1}[dir=ltr] .c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.l_O1kVC_fgCY4{left:2px}[dir=ltr] .c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.r_0L3ry_fgCY4,[dir=rtl] .c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.l_O1kVC_fgCY4{right:2px}[dir=rtl] .c_Zp8sF_fgCY4 .c_V_hFe_fgCY4.r_0L3ry_fgCY4{left:2px}.c_Zp8sF_fgCY4 .c_V_hFe_fgCY4 .c_-TPlu_fgCY4{background:"[theme:neutralDark, default: #201f1e]";color:"[theme:white, default: #ffffff]";cursor:pointer;opacity:.65;padding:4px}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4{overflow:hidden;width:100%}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4{display:flex;touch-action:pan-y}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.t_b4mja_fgCY4{transition:transform .5s ease}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.t_5NtXu_fgCY4{transition:transform}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.r_XFym3_fgCY4{transform:translateX(0)}[dir=ltr] .c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.n_dRMiw_fgCY4{transform:translateX(-100%)}[dir=rtl] .c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.n_dRMiw_fgCY4{transform:translateX(100%)}[dir=ltr] .c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.p_xQ0kF_fgCY4{transform:translateX(-200%)}[dir=rtl] .c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4.p_xQ0kF_fgCY4{transform:translateX(200%)}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4 .c_6XWdI_fgCY4{flex:1 0 100%}.c_Zp8sF_fgCY4 .c_EnWZG_fgCY4 .c_NfCHY_fgCY4 .c_6XWdI_fgCY4.u_r5Hhu_fgCY4{width:100%}.c_lraN3_fgCY4{align-items:center;display:flex;height:8px;justify-content:space-between;position:relative}[dir=ltr] .c_lraN3_fgCY4{left:50%}[dir=rtl] .c_lraN3_fgCY4{right:50%}[dir=ltr] .c_lraN3_fgCY4{transform:translateX(-50%)}[dir=rtl] .c_lraN3_fgCY4{transform:translateX(50%)}.c_lraN3_fgCY4.u_r5Hhu_fgCY4{padding-top:16px}.c_lraN3_fgCY4 .c_nQ1B0_fgCY4{background-color:"[theme:themePrimary, default: #0078d4]";border:2px solid;border-radius:4px;cursor:pointer;display:inline-block;height:4px;opacity:.5;opacity:.25;outline:0;width:4px}.c_lraN3_fgCY4 .c_nQ1B0_fgCY4.s__7dks_fgCY4{border:3px solid "[theme:white, default: #ffffff]";opacity:.75;outline:2px solid;outline-color:"[theme:themePrimary, default: #0078d4]"}.c_lraN3_fgCY4 .c_nQ1B0_fgCY4:hover{opacity:1}.c_lraN3_fgCY4 .c_Yld1K_fgCY4{background-color:"[theme:themePrimary, default: #0078d4]";border:2px solid;border-radius:4px;cursor:pointer;display:inline-block;height:4px;opacity:.5;outline:0;width:4px}.c_lraN3_fgCY4 .c_Yld1K_fgCY4.s__7dks_fgCY4{border:3px solid "[theme:white, default: #ffffff]";opacity:.75;outline:2px solid;outline-color:"[theme:themePrimary, default: #0078d4]"}.c_lraN3_fgCY4 .c_Yld1K_fgCY4:hover{opacity:1}.c_vEefc_fgCY4{display:inline}.c_vZOOP_fgCY4{column-gap:1em;display:inline-flex;flex-direction:row;flex-wrap:nowrap}.c_gBNtY_fgCY4{margin:6px}.c_YlwMM_fgCY4{display:flex;height:8px;justify-content:center;position:relative}.c_YlwMM_fgCY4.u_r5Hhu_fgCY4{padding-top:16px}.c_YlwMM_fgCY4.e_gaaHw_fgCY4{padding-bottom:16px}.c_1PXje_fgCY4 div[class*=fui-Radio__indicator]{margin:unset}.c_qm5Aj_fgCY4{align-items:center;cursor:pointer;display:flex;z-index:1}.c_qm5Aj_fgCY4.f_S78v7_fgCY4{font-size:21px}.c_qm5Aj_fgCY4:not(.f_S78v7_fgCY4){font-size:28px}.c_FlJH4_fgCY4{cursor:pointer;padding:4px}.c_qVmcG_fgCY4{align-items:center;cursor:pointer;display:flex;z-index:1}.c_qVmcG_fgCY4.f_S78v7_fgCY4{font-size:21px}.c_qVmcG_fgCY4:not(.f_S78v7_fgCY4){font-size:28px;margin-top:8px}.c_ElDoM_fgCY4{align-items:center;display:flex;justify-content:center;margin-top:.5rem}',!0);const k="c_V_hFe_fgCY4",M="a_YDOwR_fgCY4",P="c_-TPlu_fgCY4",T="c_EnWZG_fgCY4",U="c_6XWdI_fgCY4",F="u_r5Hhu_fgCY4",H="c_vZOOP_fgCY4",R="c_gBNtY_fgCY4",N="c_qm5Aj_fgCY4",B="f_S78v7_fgCY4",j="c_FlJH4_fgCY4",V="c_qVmcG_fgCY4",z="c_ElDoM_fgCY4",G=JSON.parse('{"NX":"Use Enter key to access links on items. Use left and right arrow keys to navigate between items in the carousel.","de":"Use Enter key to access links on items.","z":"There are {0} items in the carousel layout. {1} {2}","EF":"Next","WA":"Previous","QN":"{0} of {1} {2} {3}","XT":"{0} of {1}","hw":"{0} of {1} {2}","ko":"Slide {0} of {1}","bC":"Carousel Dot {0} of {1}","fX":"{0} Carousel Dot","QK":"Play","O7":"Pause"}');var K=m(522);const W="ArrowDown",q="ArrowLeft",Q="ArrowRight",Y="ArrowUp";var J;function X(e){return w()?e.keyCode===n.KeyCodes.up||e.keyCode===n.KeyCodes.down:e.key===Y||e.key===W}!function(e){e[e.Initial=0]="Initial",e[e.Next=1]="Next",e[e.Previous=2]="Previous"}(J||(J={}));class Z extends t.Component{static _isLeftKey(e){return e===q&&!Z._isRTL||e===Q&&Z._isRTL}static _isRightKey(e){return e===Q&&!Z._isRTL||e===q&&Z._isRTL}static _isLeftKeyLegacy(e){return e===n.KeyCodes.left&&!Z._isRTL||e===n.KeyCodes.right&&Z._isRTL}static _isRightKeyLegacy(e){return e===n.KeyCodes.right&&!Z._isRTL||e===n.KeyCodes.left&&Z._isRTL}get _classNames(){return{carouselOuterContainer:[{selectors:{"&:focus":{outline:"2px solid",outlineColor:(e={variantTheme:this.props.theme,carouselItemsCount:this._carouselItemsCount}).variantTheme&&e.variantTheme.semanticColors.focusBorder,outlineOffset:a._SPKillSwitch.isActivated("87fc0ba7-c6b9-46c7-b274-a80af9245783")?"0":"4px"}}}],carouselDotsContainer:[{width:8*e.carouselItemsCount+24*(e.carouselItemsCount-1)}],carouselDotContainer:[{outline:0,selectors:{[`&:focus, .${L.carouselDotSelected}:focus`]:{outline:"0 !important"},[`&:focus .${L.carouselDotSelected}`]:{outline:"2px solid",outlineColor:e.variantTheme&&e.variantTheme.semanticColors.focusBorder}}}],carouselDotSelected:[L.carouselDotSelected],carouselArrowButton:[{color:e.variantTheme&&e.variantTheme.semanticColors.bodyText}]};var e}moveToPrevSlide(){this._prevClickHandler()}moveToNextSlide(){this._nextClickHandler()}render(){const e=(0,n.mergeStyles)("c_Zp8sF_fgCY4",this._classNames.carouselOuterContainer);"function"!=typeof window.matchMedia||S()||(this._isReducedMotionOn=window.matchMedia("(prefers-reduced-motion: reduce)").matches);const i=t.createElement("div",{"data-automation-id":"SP-carouselDotsContainer",className:(0,n.mergeStyles)("c_YlwMM_fgCY4",this.props.renderDots&&F,this.props.edit&&"e_gaaHw_fgCY4",!a._SPKillSwitch.isActivated("b8c5610c-3586-430d-a794-b37b2be543db")&&"c_1PXje_fgCY4"),role:A()?"radiogroup":void 0},this._getCarouselNav());return t.createElement(t.Fragment,null,t.createElement("div",{"aria-label":this._carouselOuterContainerAriaLabel,tabIndex:this.props.disableSwipeFeature?void 0:0,className:e,role:a._SPKillSwitch.isActivated("eb6b8b3c-f7eb-4da0-9543-58a5eb919f81")?"presentation":"group",ref:e=>{this._carouselRef=e,this._carouselRef?.addEventListener("keydown",this._handleKey)},"data-automation-id":this.props.dataAutomationId||"carouselOuterContainer"},this._carouselItemsCount>1&&!this.props.hideChevron&&t.createElement("div",{"aria-hidden":!this.props.alwaysShowArrowButton||void 0,"data-automation-id":"SP-carouselArrowLeft",className:(0,n.mergeStyles)(k,"l_O1kVC_fgCY4",this.props.alwaysShowArrowButton&&M),role:this.props.alwaysShowArrowButton?"button":void 0,tabIndex:this.props.alwaysShowArrowButton?0:void 0,onMouseDown:this._handleArrowButtonMouseDown},t.createElement(n.Icon,{className:P,ariaLabel:Z._isRTL?G.EF:G.WA,iconName:Z._isRTL?"ChevronRight":"ChevronLeft",title:Z._isRTL?G.EF:G.WA,onClick:Z._isRTL?this._nextClickHandler:this._prevClickHandler})),t.createElement(n.FocusZone,{className:!a._SPKillSwitch.isActivated("1a5135fa-e6f0-4632-9a2d-f294f6837055")&&this.props.customClass?(0,n.mergeStyles)(T,this.props.customClass):T,direction:n.FocusZoneDirection.horizontal,isCircularNavigation:!0,isInnerZoneKeystroke:X},t.createElement("div",{ref:this._carouselItemContainer,"data-automation-id":"SP-carouselItemsContainer",className:(0,n.mergeStyles)("c_NfCHY_fgCY4",!this.state.reordering&&(!S()&&this._isReducedMotionOn&&!this.props.removeReduceMotionOption||0===this.state.direction?"t_5NtXu_fgCY4":"t_b4mja_fgCY4"),this._getTransformCssClassName()),role:"list","aria-label":this.props.title,onTouchStart:this.props.disableSwipeFeature?void 0:this._onTouchStart,onTouchMove:this.props.disableSwipeFeature?void 0:this._onTouchMove,onMouseDown:this.props.disableSwipeFeature?void 0:this._onMouseDown,onMouseUp:this.props.disableSwipeFeature?void 0:this._onMouseUp,onTransitionEnd:this._handleTransitionEnd},this._getCarouselItems())),this._carouselItemsCount>1&&!this.props.hideChevron&&t.createElement("div",{"data-automation-id":"SP-carouselArrowRight","aria-hidden":!this.props.alwaysShowArrowButton||void 0,className:(0,n.mergeStyles)(k,"r_0L3ry_fgCY4",this.props.alwaysShowArrowButton&&M),role:this.props.alwaysShowArrowButton?"button":void 0,tabIndex:this.props.alwaysShowArrowButton?0:void 0,onMouseDown:this._handleArrowButtonMouseDown},t.createElement(n.Icon,{className:P,iconName:Z._isRTL?"ChevronLeft":"ChevronRight",ariaLabel:Z._isRTL?G.WA:G.EF,title:Z._isRTL?G.WA:G.EF,onClick:Z._isRTL?this._prevClickHandler:this._nextClickHandler}))),this._carouselItemsCount>1&&(A()?t.createElement(n.FocusZone,{isCircularNavigation:!0,direction:n.FocusZoneDirection.horizontal},i):i))}componentDidMount(){this._startAutoPlayTask(),this.props.componentRef&&(this.props.componentRef.current=this)}componentDidUpdate(e){e.autoplaySpeed!==this.props.autoplaySpeed&&(this._async.clearInterval(this._autoPlayIntervalId),this._startAutoPlayTask())}componentWillUnmount(){this._async.dispose(),this.props.componentRef&&(this.props.componentRef.current=null)}_startAutoPlayTask(){this._showPlayPauseButton&&this.setState({isPlaying:!0}),this.props.autoplaySpeed&&0!==this.props.autoplaySpeed&&(this._autoPlayIntervalId=this._async.setInterval(()=>{const e=(this.state.position+1)%this._carouselItemsCount;this._slide(e,1),0===e&&this.props.stopAutoplayAfterFirstRun&&this._stopAutoplay()},this.props.autoplaySpeed||Z._defatulAutoplaySpeed))}get _carouselItemsCount(){return this.props.carouselSlideCount||t.Children.count(this.props.children)}_getTransformCssClassName(){if(this._carouselItemsCount>1){if(!this.state.reordering)return"n_dRMiw_fgCY4";if(2===this.state.direction)return"p_xQ0kF_fgCY4"}return"r_XFym3_fgCY4"}_getCarouselItems(){const e=[];for(let t=0;t<this._carouselItemsCount;t++)e.push(this._getCarouselItem(t,0,!1));if(2===e.length)for(let t=2;t<this._carouselItemsCount+2;t++)e.push(this._getCarouselItem(t,2,!0));return e}_getCarouselItem(e,a,i){const r=this._getCarouselItemOrder(e);return 1===r||this._rendered.has(e-a)||1===this.props.carouselSlideCount?(this._rendered.add(e-a),t.createElement("div",{"data-automation-id":i?"SP-carouselItem-duplicate":"SP-carouselItem",key:e,className:(0,n.mergeStyles)(U,this.props.renderDots&&F),role:"listitem","aria-hidden":!y()&&i||void 0,style:{order:r},ref:e=>{1!==r&&1!==this._carouselItemsCount||(this._activeCarouselItem=e)}},this._getCarouselChild(e-a,i))):t.createElement("div",{"data-automation-id":i?"SP-carouselItem-duplicate":"SP-carouselItem",key:e,className:(0,n.mergeStyles)(U,this.props.renderDots&&F),role:"listitem","aria-hidden":!y()&&i||void 0,style:{order:r}})}_getCarouselChild(e,t){if(this.props.renderCarouselSlide)return I()?this.props.renderCarouselSlide(e,t):this.props.renderCarouselSlide(e,t,this.state.position);let n;return e<this._carouselItemsCount&&this.props.children&&(n=this.props.children[e]),n}_getCarouselNav(){const{position:e}=this.state,{renderDots:i}=this.props;if(i){const a=i(e+1,this._carouselItemsCount);if(a)return D()||!this.props.showBottomChevron?[a]:t.createElement("div",{className:z},this._getPlayPauseButton(),this._getLeftChevron(!1),t.createElement("div",{className:(0,n.css)(H,A()?"":R),"data-automation-id":"item-count"},a),this._getRightChevron(!1))}const r=[];for(let e=0;e<this._carouselItemsCount;e++)r.push({key:`${e}`,text:"",styles:{choiceFieldWrapper:{paddingLeft:"5px"}},ariaLabel:a._SPKillSwitch.isActivated("74c4891b-198a-4caf-a677-a684181940b1")?a.Text.format(G.bC,e+1,this._carouselItemsCount):a.Text.format(G.fX,this.props.webPartAlias?this.props.webPartAlias:"")});const o={label:"c_vEefc_fgCY4",flexContainer:H};return D()||!this.props.showBottomChevron?A()?t.createElement(K.ChoiceGroup,{selectedKey:String(e),options:r,onChange:this._handleChange,styles:o}):t.createElement(t.Fragment,null,this._getPlayPauseButton(),t.createElement(n.FocusZone,{isCircularNavigation:!0,direction:n.FocusZoneDirection.horizontal},t.createElement(K.ChoiceGroup,{selectedKey:String(e),options:r,onChange:this._handleChange,styles:o,disabled:!this.props.dotsClickable}))):t.createElement("div",{className:z},this._getPlayPauseButton(),this._getLeftChevron(!0),A()?t.createElement(K.ChoiceGroup,{selectedKey:String(e),options:r,onChange:this._handleChange,styles:o}):t.createElement(n.FocusZone,{isCircularNavigation:!0,direction:n.FocusZoneDirection.horizontal},t.createElement(K.ChoiceGroup,{selectedKey:String(e),options:r,onChange:this._handleChange,styles:(0,n.mergeStyleSets)(o,!A()&&{flexContainer:R}),disabled:!this.props.dotsClickable})),this._getRightChevron(!0))}_slide(e,t,n){this.setState({direction:t,reordering:!0,position:e}),this._async.setTimeout(()=>{this.setState({reordering:!1}),n&&this._async.setTimeout(()=>{const a=1===t?e+1:e-1;this._slide(a%this._carouselItemsCount,t,n-1)},Z._defaultTimeoutDelay)},Z._defaultTimeoutDelay)}_isFocusInFirstOrLastItemOfCurrentSlide(e){if(this._activeCarouselItem){const t=this._activeCarouselItem.querySelectorAll(".carouselItemWrapper"),n="first"===e?0:t.length-1;return 0===t.length||t[n].contains(document.activeElement)}return!1}get _carouselOuterContainerAriaLabel(){const e=this._carouselItemsCount>1?G.NX:G.de;return this.props.edit?a.Text.format(G.z,this.props.carouselTotalItemCount,this.props.strings&&this.props.strings.containerAriaLabelEditMode||"",e):a.Text.format(G.z,this.props.carouselTotalItemCount,this.props.strings&&this.props.strings.containerAriaLabelReadMode||"",e)}_getLeftChevron(e){return t.createElement("div",{"data-is-focusable":!0,tabIndex:0,"data-automation-id":"SP-carouselArrowLeft",className:(0,n.css)(e?V:N,A()?"":B),role:"button",onClick:this._prevClickHandler,onKeyDown:this._handleKeyDown(!0)},t.createElement(n.Icon,{className:(0,n.mergeStyles)(j,A()?"":this._classNames.carouselArrowButton),ariaLabel:G.WA,iconName:"ChevronLeft",title:G.WA}))}_getRightChevron(e){return t.createElement("div",{"data-is-focusable":!0,tabIndex:0,"data-automation-id":"SP-carouselArrowRight",className:(0,n.css)(e?V:N,A()?"":B),role:"button",onClick:this._nextClickHandler,onKeyDown:this._handleKeyDown(!1)},t.createElement(n.Icon,{className:(0,n.mergeStyles)(j,A()?"":this._classNames.carouselArrowButton),ariaLabel:G.EF,iconName:"ChevronRight",title:G.EF}))}get _showPlayPauseButton(){return!A()&&!!this.props.autoplaySpeed&&!this.props.stopAutoplayAfterFirstRun}_getPlayPauseButton(){return this._showPlayPauseButton?t.createElement(c.Tooltip,{content:this.state.isPlaying?G.O7:G.QK,relationship:"label"},t.createElement(d.Button,{icon:this.state.isPlaying?t.createElement(g,null):t.createElement(v,null),onClick:()=>{this.state.isPlaying?this._stopAutoplay():this._startAutoPlayTask()}})):t.createElement(t.Fragment,null)}constructor(e){super(e),this._autoPlayIntervalId=-1,this._rendered=new Set,this._isReducedMotionOn=!1,this._async=new n.Async,this._carouselItemContainer=t.createRef(),this._stopAutoplay=()=>{this._showPlayPauseButton&&this.setState({isPlaying:!1}),this._async.clearInterval(this._autoPlayIntervalId),this._autoPlayIntervalId=-1},this._slidingDotClickHandler=(e,t)=>{if(this.state.position===t)return;this._stopAutoplay();const n=this.state.position>t?2:1,a=1===n?this.state.position+1:this.state.position-1;this._slide(a,n,Math.abs(this.state.position-t)-1)},this._nextClickHandler=()=>{this._stopAutoplay();const e=(this.state.position+1)%this._carouselItemsCount,t=(this.state.position+2)%this._carouselItemsCount||this._carouselItemsCount;this.props.disableSlideChangeAlert?E()||s.read(a.Text.format(G.ko,t,this._carouselItemsCount),2):!C()||("news"===this.props?.scenario||!O())&&this.props?.items&&this.props?.items[e]?.title?s.read(a.Text.format(C()?G.hw:G.QN,t,this._carouselItemsCount,this.props.items?.[e]?.title,this.props.items?.[e]?.altText),2):s.read(a.Text.format(G.XT,t,this._carouselItemsCount),2),this._slide(e,1),this.props.onNext&&this.props.onNext()},this._prevClickHandler=()=>{this._stopAutoplay();const e=(this.state.position-1+this._carouselItemsCount)%this._carouselItemsCount,t=this.state.position%this._carouselItemsCount||this._carouselItemsCount;this.props.disableSlideChangeAlert?E()||s.read(a.Text.format(G.ko,t,this._carouselItemsCount),2):!C()||("news"===this.props?.scenario||!O())&&this.props?.items&&this.props?.items[e]?.title?s.read(a.Text.format(C()?G.hw:G.QN,t,this._carouselItemsCount,this.props.items?.[e]?.title,this.props.items?.[e]?.altText),2):s.read(a.Text.format(G.XT,t,this._carouselItemsCount),2),this._slide(e,2),this.props.onPrevious&&this.props.onPrevious()},this._getCarouselItemOrder=e=>{const t=2===this._carouselItemsCount?4:this._carouselItemsCount;return(e+t-this.state.position+1)%t},this._onTouchStart=e=>{e.preventDefault(),e.touches.length>=1&&(this._xPos=e.touches[0].clientX,this._yPos=e.touches[0].clientY)},this._onTouchMove=e=>{e.preventDefault(),e.touches.length>=1&&this._handleSwipeEvent(e.touches[0].clientX,e.touches[0].clientY,!1)},this._onMouseDown=e=>{this._xPos=e.clientX,this._yPos=e.clientY},this._onMouseUp=e=>{e.preventDefault(),this._handleSwipeEvent(e.clientX,e.clientY,!0)},this._handleSwipeEvent=(e,t,n)=>{if(this._xPos&&this._yPos){const a=this._xPos-e,i=this._yPos-t;Math.abs(a)>Math.abs(i)&&(!n||n&&Math.abs(a)>Z._minXDiffForSwipeGesture)&&(a<0&&!Z._isRTL||a>0&&Z._isRTL?this._prevClickHandler():this._nextClickHandler()),this._xPos=void 0,this._yPos=void 0}},this._handleKey=e=>{if(w()?Z._isRightKeyLegacy(e.keyCode):Z._isRightKey(e.key))(e.target===this._carouselRef||this._isFocusInFirstOrLastItemOfCurrentSlide("last"))&&(this._nextClickHandler(),e.stopPropagation());else if(w()?Z._isLeftKeyLegacy(e.keyCode):Z._isLeftKey(e.key))(e.target===this._carouselRef||this._isFocusInFirstOrLastItemOfCurrentSlide("first"))&&(this._prevClickHandler(),e.stopPropagation());else if(this._carouselRef===e.target&&this._activeCarouselItem&&!e.shiftKey&&(w()?e.keyCode===n.KeyCodes.enter||e.keyCode===n.KeyCodes.tab||!x()&&e.keyCode===n.KeyCodes.space:"Enter"===e.key||"Tab"===e.key||!x()&&" "===e.key)){if(w()?e.keyCode===n.KeyCodes.tab:"Tab"===e.key)return;!x()&&this.props.onClickItem&&this.props.onClickItem(this.state.position,e),e.stopPropagation(),this._focusInsideActiveItem()}else w()||!this.props.edit||e.key!==Y&&e.key!==W||!this._activeCarouselItem||this._isFocusInFirstOrLastItemOfCurrentSlide("first")||(0,n.getFirstFocusable)(this._activeCarouselItem,this._activeCarouselItem,!0)?.focus()},this._handleChange=(e,t)=>{e&&t&&this._slidingDotClickHandler(e,Number(t.key))},this._handleTransitionEnd=e=>{const t=document.activeElement!==this._carouselRef&&!!this._carouselRef?.contains(document.activeElement);e.target===this._carouselItemContainer.current&&"transform"===e.propertyName&&t&&this._focusInsideActiveItem()},this._focusInsideActiveItem=()=>{let e;this._activeCarouselItem&&(e=(0,n.getFirstFocusable)(this._activeCarouselItem,this._activeCarouselItem,!0)),e&&!e.hasAttribute("tabindex")&&e.hasAttribute("data-is-focusable")&&e.setAttribute("tabindex","-1"),e?.focus()},this._handleArrowButtonMouseDown=e=>{e.preventDefault()},this._handleKeyDown=e=>t=>{"Enter"!==t.key&&"Space"!==t.key||(e?this._prevClickHandler():this._nextClickHandler())},this.state={direction:0,position:0,reordering:!1,isPlaying:this._showPlayPauseButton}}}Z._defaultTimeoutDelay=50,Z._defatulAutoplaySpeed=5e3,Z._minXDiffForSwipeGesture=50,Z._isRTL=(0,n.getRTL)(),Z=(0,e._ts_decorate)([(0,n.customizable)("CarouselLayout",["theme"])],Z);const $={ITEM_MARGIN:20,ITEM_MIN_WIDTH:212,ITEM_MAX_WIDTH:286,MAX_ITEM_COUNT_PER_ROW:4,CLASSICPAGE_CAROUSEL_MAX_WIDTH:828,TILE_NON_PREVIEW_HEIGHT:140,MAX_SLIDES_COUNT_OLD:8,MAX_SLIDES_COUNT:5};var ee=m(930);const te=(0,n.classNamesFunction)(),ne=e=>{const{variantTheme:t}=e,i=(0,n.getTheme)(),r=a._SPKillSwitch.isActivated("d55c11e0-f45e-4237-b5be-81d73ddbc955")?ee.typographyStyles.body1:ee.typographyStyles.custom.body1;return t?{currentActiveItem:{color:t.semanticColors.bodyText,...i.fonts.medium,...r}}:{currentActiveItem:void 0,...r}};o.loadStyles("@keyframes f_e3qlo_fgCY4{0%{animation-timing-function:cubic-bezier(.1,.25,.75,.9);opacity:0}to{opacity:1}}.c_Iiuae_fgCY4{position:relative;text-align:center}[dir=ltr] .c_Iiuae_fgCY4{left:50%}[dir=rtl] .c_Iiuae_fgCY4{right:50%}[dir=ltr] .c_Iiuae_fgCY4{transform:translateX(-50%)}[dir=rtl] .c_Iiuae_fgCY4{transform:translateX(50%)}.c_Iiuae_fgCY4:not(.f_oSuLF_fgCY4){font-size:17px;font-weight:300}.s_FPEsT_fgCY4{border:0;height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;text-indent:-9999px;width:1px}.l_7UOFA_fgCY4{display:flex;justify-content:space-between}.l_7UOFA_fgCY4.u_aWSYt_fgCY4{justify-content:flex-start}[dir=ltr] .l_7UOFA_fgCY4.u_aWSYt_fgCY4 .carouselItemWrapper{margin-right:20px}[dir=rtl] .l_7UOFA_fgCY4.u_aWSYt_fgCY4 .carouselItemWrapper{margin-left:20px}.l_7UOFA_fgCY4.o_0IjWw_fgCY4{justify-content:center}",!0);const ae=JSON.parse('{"W":"{0} of {1}"}');function ie(e,t){return t<1?$.ITEM_MIN_WIDTH:Math.min(Math.floor(((e||0)+$.ITEM_MARGIN)/t-$.ITEM_MARGIN),$.ITEM_MAX_WIDTH)}function re(e,t){return Math.floor((e+$.ITEM_MARGIN)/(t+$.ITEM_MARGIN))||1}class oe extends n.BaseComponent{get _classNames(){return Boolean(this.props.theme)&&te(ne,{variantTheme:this.props.theme})}render(){const{stopAutoplayAfterFirstRun:e,theme:n}=this.props;return t.createElement(Z,{autoplaySpeed:this._autoplaySpeed,edit:this.props.edit,renderDots:this._renderCounter,strings:this.props.strings,stopAutoplayAfterFirstRun:e,theme:n,renderCarouselSlide:this._renderCarouselSlide,carouselSlideCount:this._getCarouselSlideCount(),webPartAlias:this.props.webPartTag?this._webPartAlias:void 0,carouselTotalItemCount:this.state.itemCount,disableSlideChangeAlert:!!this.props.settings.filmStrip,removeReduceMotionOption:this.props.settings.removeReduceMotionOption,onNext:this.props.onNext,onPrevious:this.props.onPrevious,items:this.props.items,scenario:this.props.scenario,onClickItem:this.props.onClickItem,title:this.props.title,alwaysShowArrowButton:this.props.settings.alwaysShowArrowButton,showBottomChevron:this.props.settings.showBottomChevron,dotsClickable:this.props.settings.dotsClickable??!0,hideChevron:this.props.settings.hideChevronNearItems})}get _webPartAlias(){return this.props.webPartTag?this.props.webPartTag.split(".")[1]:""}get _autoplaySpeed(){const{autoplay:e}=this.props.settings;let t=e?this.props.settings.autoplaySpeed||5:0;return e&&(t>=2&&t<=10?t*=1e3:i._TraceLogger.logError(oe._logSource,new Error(`InvalidAutoplaySpeed ${t}`),"InitialSliderAutoplay")),t}get _sliderMaxWidth(){return a.Environment&&a.Environment.type===a.EnvironmentType.ClassicSharePoint?$.CLASSICPAGE_CAROUSEL_MAX_WIDTH:this.props.width}constructor(e){super(e),this._getCarouselSlideCount=()=>{const{items:e}=this.props,t=e.length,n=this._getVisibleItemCountPerSlide();let a=t;const{dots:i,filmStrip:r}=this.props.settings;return(i||r)&&(a=Math.ceil(t/n)),a},this._renderCarouselSlide=(e,a,i)=>{const{items:r}=this.props,o=this._getVisibleItemCountPerSlide(),{filmStrip:s}=this.props.settings;if(s){const i=r.slice(e*o,(e+1)*o);return t.createElement("div",{className:(0,n.css)("l_7UOFA_fgCY4",{u_aWSYt_fgCY4:i.length<o,o_0IjWw_fgCY4:1===i.length&&1===o}),role:y()?void 0:"list","data-automation-id":"liteFilmStripContainer"},i.map((t,n)=>this._onRenderItem(t,n,e,a)))}return I()?this._onRenderItem(r[e],e,0,a):this._onRenderItem(r[e],e,0,a,i)},this._renderCounter=(e,i)=>{const{items:o}=this.props,s=o.length,c=this._getVisibleItemCountPerSlide(),d=s>c;let l=!1,u=s;const{dots:f,filmStrip:p,keyboardNav:m}=this.props.settings;(f||p)&&(u=Math.ceil(s/c),l=u<=(a._SPKillSwitch.isActivated("03d7c1f2-a927-4bd9-a029-07faf789b863")?$.MAX_SLIDES_COUNT_OLD:$.MAX_SLIDES_COUNT)),m&&!f&&(l=!1);const _=(0,n.css)("c_Iiuae_fgCY4",this._classNames&&this._classNames.currentActiveItem,"f_oSuLF_fgCY4");return d&&!l&&t.createElement("div",{className:_,"data-automation-id":"item-count"},r.StringHelper.format(ae.W,e,i))},this._onRenderItem=(e,n,a,i,r)=>t.createElement("div",{key:n,className:"carouselItemWrapper"},this.props.onRenderItem(e,n,this._sliderMaxWidth,this._getVisibleItemCountPerSlide(),a,i,r)),this._getVisibleItemCountPerSlide=()=>{if(!a._SPKillSwitch.isActivated("6af0d951-31b5-40bc-ae33-d4a0ccfa0cee"))return this.props.settings.filmStrip&&this.props.width?this.props.itemWidth?re(this.props.width,this.props.itemWidth):function(e){const t=re(e,$.ITEM_MIN_WIDTH),n=re(e,$.ITEM_MAX_WIDTH);return n>$.MAX_ITEM_COUNT_PER_ROW?n:Math.min($.MAX_ITEM_COUNT_PER_ROW,t)}(this.props.width):1;if(this.props.settings.filmStrip&&this.props.width){let e=Math.floor((this.props.width+$.ITEM_MARGIN)/($.ITEM_MIN_WIDTH+$.ITEM_MARGIN))||1;const t=Math.floor((this.props.width+$.ITEM_MARGIN)/($.ITEM_MAX_WIDTH+$.ITEM_MARGIN))||1;return e=t>$.MAX_ITEM_COUNT_PER_ROW?t:Math.min($.MAX_ITEM_COUNT_PER_ROW,e),e}return 1},this.state={itemCount:e.items.length||0}}}oe.defaultProps={items:[],settings:{},edit:void 0,width:void 0,onRenderItem:()=>{},stopAutoplayAfterFirstRun:!0},oe._logSource=i._LogSource.create("sp-carousel-layout"),oe=(0,e._ts_decorate)([(0,n.customizable)("Carousel",["theme"])],oe);class se{static loadCarousel(){return Promise.resolve(oe)}}})(),_})());