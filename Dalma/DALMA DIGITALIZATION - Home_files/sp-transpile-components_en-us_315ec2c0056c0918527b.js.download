/*! For license information please see sp-transpile-components_en-us_5f6e9cc4cd157cc92005.js.LICENSE.txt */
(()=>{var e=document.currentScript;define("562e7236-4406-4276-a3dc-49a0f5f64ae9_0.1.0",["@microsoft/sp-lodash-subset","@msinternal/sp-renderable-components-base","@microsoft/sp-core-library","@microsoft/sp-image-helper","@msinternal/sp-component-utilities","@microsoft/sp-diagnostics","@msinternal/odsp-core-bundle","@msinternal/odsp-utilities-bundle","tslib"],(t,n,a,i,r,o,s,c,d)=>(()=>{var l,u={18:function(e){e.exports=function(){"use strict";const{entries:e,setPrototypeOf:t,isFrozen:n,getPrototypeOf:a,getOwnPropertyDescriptor:i}=Object;let{freeze:r,seal:o,create:s}=Object,{apply:c,construct:d}="undefined"!=typeof Reflect&&Reflect;r||(r=function(e){return e}),o||(o=function(e){return e}),c||(c=function(e,t,n){return e.apply(t,n)}),d||(d=function(e,t){return new e(...t)});const l=x(Array.prototype.forEach),u=x(Array.prototype.pop),f=x(Array.prototype.push),p=x(String.prototype.toLowerCase),m=x(String.prototype.toString),_=x(String.prototype.match),h=x(String.prototype.replace),b=x(String.prototype.indexOf),g=x(String.prototype.trim),v=x(Object.prototype.hasOwnProperty),y=x(RegExp.prototype.test),S=(D=TypeError,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return d(D,t)});var D;function I(e){return"number"==typeof e&&isNaN(e)}function x(e){return function(t){for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return c(e,t,a)}}function C(e,a){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:p;t&&t(e,null);let r=a.length;for(;r--;){let t=a[r];if("string"==typeof t){const e=i(t);e!==t&&(n(a)||(a[r]=e),t=e)}e[t]=!0}return e}function O(e){for(let t=0;t<e.length;t++)v(e,t)||(e[t]=null);return e}function w(t){const n=s(null);for(const[a,i]of e(t))v(t,a)&&(Array.isArray(i)?n[a]=O(i):i&&"object"==typeof i&&i.constructor===Object?n[a]=w(i):n[a]=i);return n}function E(e,t){for(;null!==e;){const n=i(e,t);if(n){if(n.get)return x(n.get);if("function"==typeof n.value)return x(n.value)}e=a(e)}return function(){return null}}const A=r(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),L=r(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),k=r(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),M=r(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),P=r(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),T=r(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),U=r(["#text"]),F=r(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),H=r(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),R=r(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),N=r(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),B=o(/\{\{[\w\W]*|[\w\W]*\}\}/gm),j=o(/<%[\w\W]*|[\w\W]*%>/gm),V=o(/\${[\w\W]*}/gm),z=o(/^data-[\-\w.\u00B7-\uFFFF]/),G=o(/^aria-[\-\w]+$/),K=o(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),W=o(/^(?:\w+script|data):/i),q=o(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Q=o(/^html$/i),Y=o(/^[a-z][.\w]*(-[.\w]+)+$/i);var J=Object.freeze({__proto__:null,MUSTACHE_EXPR:B,ERB_EXPR:j,TMPLIT_EXPR:V,DATA_ATTR:z,ARIA_ATTR:G,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:W,ATTR_WHITESPACE:q,DOCTYPE_NAME:Q,CUSTOM_ELEMENT:Y});const X=function(){return"undefined"==typeof window?null:window},Z=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let n=null;const a="data-tt-policy-suffix";t&&t.hasAttribute(a)&&(n=t.getAttribute(a));const i="dompurify"+(n?"#"+n:"");try{return e.createPolicy(i,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+i+" could not be created."),null}};return function t(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:X();const a=e=>t(e);if(a.version="3.1.4",a.removed=[],!n||!n.document||9!==n.document.nodeType)return a.isSupported=!1,a;let{document:i}=n;const o=i,c=o.currentScript,{DocumentFragment:d,HTMLTemplateElement:D,Node:x,Element:O,NodeFilter:B,NamedNodeMap:j=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:V,DOMParser:z,trustedTypes:G}=n,W=O.prototype,q=E(W,"cloneNode"),Y=E(W,"nextSibling"),$=E(W,"childNodes"),ee=E(W,"parentNode");if("function"==typeof D){const e=i.createElement("template");e.content&&e.content.ownerDocument&&(i=e.content.ownerDocument)}let te,ne="";const{implementation:ae,createNodeIterator:ie,createDocumentFragment:re,getElementsByTagName:oe}=i,{importNode:se}=o;let ce={};a.isSupported="function"==typeof e&&"function"==typeof ee&&ae&&void 0!==ae.createHTMLDocument;const{MUSTACHE_EXPR:de,ERB_EXPR:le,TMPLIT_EXPR:ue,DATA_ATTR:fe,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:me,ATTR_WHITESPACE:_e,CUSTOM_ELEMENT:he}=J;let{IS_ALLOWED_URI:be}=J,ge=null;const ve=C({},[...A,...L,...k,...P,...U]);let ye=null;const Se=C({},[...F,...H,...R,...N]);let De=Object.seal(s(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ie=null,xe=null,Ce=!0,Oe=!0,we=!1,Ee=!0,Ae=!1,Le=!0,ke=!1,Me=!1,Pe=!1,Te=!1,Ue=!1,Fe=!1,He=!0,Re=!1;const Ne="user-content-";let Be=!0,je=!1,Ve={},ze=null;const Ge=C({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ke=null;const We=C({},["audio","video","img","source","image","track"]);let qe=null;const Qe=C({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ye="http://www.w3.org/1998/Math/MathML",Je="http://www.w3.org/2000/svg",Xe="http://www.w3.org/1999/xhtml";let Ze=Xe,$e=!1,et=null;const tt=C({},[Ye,Je,Xe],m);let nt=null;const at=["application/xhtml+xml","text/html"],it="text/html";let rt=null,ot=null;const st=255,ct=i.createElement("form"),dt=function(e){return e instanceof RegExp||e instanceof Function},lt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ot||ot!==e){if(e&&"object"==typeof e||(e={}),e=w(e),nt=-1===at.indexOf(e.PARSER_MEDIA_TYPE)?it:e.PARSER_MEDIA_TYPE,rt="application/xhtml+xml"===nt?m:p,ge=v(e,"ALLOWED_TAGS")?C({},e.ALLOWED_TAGS,rt):ve,ye=v(e,"ALLOWED_ATTR")?C({},e.ALLOWED_ATTR,rt):Se,et=v(e,"ALLOWED_NAMESPACES")?C({},e.ALLOWED_NAMESPACES,m):tt,qe=v(e,"ADD_URI_SAFE_ATTR")?C(w(Qe),e.ADD_URI_SAFE_ATTR,rt):Qe,Ke=v(e,"ADD_DATA_URI_TAGS")?C(w(We),e.ADD_DATA_URI_TAGS,rt):We,ze=v(e,"FORBID_CONTENTS")?C({},e.FORBID_CONTENTS,rt):Ge,Ie=v(e,"FORBID_TAGS")?C({},e.FORBID_TAGS,rt):{},xe=v(e,"FORBID_ATTR")?C({},e.FORBID_ATTR,rt):{},Ve=!!v(e,"USE_PROFILES")&&e.USE_PROFILES,Ce=!1!==e.ALLOW_ARIA_ATTR,Oe=!1!==e.ALLOW_DATA_ATTR,we=e.ALLOW_UNKNOWN_PROTOCOLS||!1,Ee=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,Ae=e.SAFE_FOR_TEMPLATES||!1,Le=!1!==e.SAFE_FOR_XML,ke=e.WHOLE_DOCUMENT||!1,Te=e.RETURN_DOM||!1,Ue=e.RETURN_DOM_FRAGMENT||!1,Fe=e.RETURN_TRUSTED_TYPE||!1,Pe=e.FORCE_BODY||!1,He=!1!==e.SANITIZE_DOM,Re=e.SANITIZE_NAMED_PROPS||!1,Be=!1!==e.KEEP_CONTENT,je=e.IN_PLACE||!1,be=e.ALLOWED_URI_REGEXP||K,Ze=e.NAMESPACE||Xe,De=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(De.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&dt(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(De.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(De.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ae&&(Oe=!1),Ue&&(Te=!0),Ve&&(ge=C({},U),ye=[],!0===Ve.html&&(C(ge,A),C(ye,F)),!0===Ve.svg&&(C(ge,L),C(ye,H),C(ye,N)),!0===Ve.svgFilters&&(C(ge,k),C(ye,H),C(ye,N)),!0===Ve.mathMl&&(C(ge,P),C(ye,R),C(ye,N))),e.ADD_TAGS&&(ge===ve&&(ge=w(ge)),C(ge,e.ADD_TAGS,rt)),e.ADD_ATTR&&(ye===Se&&(ye=w(ye)),C(ye,e.ADD_ATTR,rt)),e.ADD_URI_SAFE_ATTR&&C(qe,e.ADD_URI_SAFE_ATTR,rt),e.FORBID_CONTENTS&&(ze===Ge&&(ze=w(ze)),C(ze,e.FORBID_CONTENTS,rt)),Be&&(ge["#text"]=!0),ke&&C(ge,["html","head","body"]),ge.table&&(C(ge,["tbody"]),delete Ie.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw S('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');te=e.TRUSTED_TYPES_POLICY,ne=te.createHTML("")}else void 0===te&&(te=Z(G,c)),null!==te&&"string"==typeof ne&&(ne=te.createHTML(""));r&&r(e),ot=e}},ut=C({},["mi","mo","mn","ms","mtext"]),ft=C({},["foreignobject","annotation-xml"]),pt=C({},["title","style","font","a","script"]),mt=C({},[...L,...k,...M]),_t=C({},[...P,...T]),ht=function(e){let t=ee(e);t&&t.tagName||(t={namespaceURI:Ze,tagName:"template"});const n=p(e.tagName),a=p(t.tagName);return!!et[e.namespaceURI]&&(e.namespaceURI===Je?t.namespaceURI===Xe?"svg"===n:t.namespaceURI===Ye?"svg"===n&&("annotation-xml"===a||ut[a]):Boolean(mt[n]):e.namespaceURI===Ye?t.namespaceURI===Xe?"math"===n:t.namespaceURI===Je?"math"===n&&ft[a]:Boolean(_t[n]):e.namespaceURI===Xe?!(t.namespaceURI===Je&&!ft[a])&&!(t.namespaceURI===Ye&&!ut[a])&&!_t[n]&&(pt[n]||!mt[n]):!("application/xhtml+xml"!==nt||!et[e.namespaceURI]))},bt=function(e){f(a.removed,{element:e});try{e.parentNode.removeChild(e)}catch(t){e.remove()}},gt=function(e,t){try{f(a.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){f(a.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e&&!ye[e])if(Te||Ue)try{bt(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},vt=function(e){let t=null,n=null;if(Pe)e="<remove></remove>"+e;else{const t=_(e,/^[\r\n\t ]+/);n=t&&t[0]}"application/xhtml+xml"===nt&&Ze===Xe&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");const a=te?te.createHTML(e):e;if(Ze===Xe)try{t=(new z).parseFromString(a,nt)}catch(e){}if(!t||!t.documentElement){t=ae.createDocument(Ze,"template",null);try{t.documentElement.innerHTML=$e?ne:a}catch(e){}}const r=t.body||t.documentElement;return e&&n&&r.insertBefore(i.createTextNode(n),r.childNodes[0]||null),Ze===Xe?oe.call(t,ke?"html":"body")[0]:ke?t.documentElement:r},yt=function(e){return ie.call(e.ownerDocument||e,e,B.SHOW_ELEMENT|B.SHOW_COMMENT|B.SHOW_TEXT|B.SHOW_PROCESSING_INSTRUCTION|B.SHOW_CDATA_SECTION,null)},St=function(e){return e instanceof V&&(void 0!==e.__depth&&"number"!=typeof e.__depth||void 0!==e.__removalCount&&"number"!=typeof e.__removalCount||"string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof j)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},Dt=function(e){return"function"==typeof x&&e instanceof x},It=function(e,t,n){ce[e]&&l(ce[e],e=>{e.call(a,t,n,ot)})},xt=function(e){let t=null;if(It("beforeSanitizeElements",e,null),St(e))return bt(e),!0;const n=rt(e.nodeName);if(It("uponSanitizeElement",e,{tagName:n,allowedTags:ge}),e.hasChildNodes()&&!Dt(e.firstElementChild)&&y(/<[/\w]/g,e.innerHTML)&&y(/<[/\w]/g,e.textContent))return bt(e),!0;if(7===e.nodeType)return bt(e),!0;if(Le&&8===e.nodeType&&y(/<[/\w]/g,e.data))return bt(e),!0;if(!ge[n]||Ie[n]){if(!Ie[n]&&Ot(n)){if(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n))return!1;if(De.tagNameCheck instanceof Function&&De.tagNameCheck(n))return!1}if(Be&&!ze[n]){const t=ee(e)||e.parentNode,n=$(e)||e.childNodes;if(n&&t)for(let a=n.length-1;a>=0;--a){const i=q(n[a],!0);i.__removalCount=(e.__removalCount||0)+1,t.insertBefore(i,Y(e))}}return bt(e),!0}return e instanceof O&&!ht(e)?(bt(e),!0):"noscript"!==n&&"noembed"!==n&&"noframes"!==n||!y(/<\/no(script|embed|frames)/i,e.innerHTML)?(Ae&&3===e.nodeType&&(t=e.textContent,l([de,le,ue],e=>{t=h(t,e," ")}),e.textContent!==t&&(f(a.removed,{element:e.cloneNode()}),e.textContent=t)),It("afterSanitizeElements",e,null),!1):(bt(e),!0)},Ct=function(e,t,n){if(He&&("id"===t||"name"===t)&&(n in i||n in ct||"__depth"===n||"__removalCount"===n))return!1;if(Oe&&!xe[t]&&y(fe,t));else if(Ce&&y(pe,t));else if(!ye[t]||xe[t]){if(!(Ot(e)&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,e)||De.tagNameCheck instanceof Function&&De.tagNameCheck(e))&&(De.attributeNameCheck instanceof RegExp&&y(De.attributeNameCheck,t)||De.attributeNameCheck instanceof Function&&De.attributeNameCheck(t))||"is"===t&&De.allowCustomizedBuiltInElements&&(De.tagNameCheck instanceof RegExp&&y(De.tagNameCheck,n)||De.tagNameCheck instanceof Function&&De.tagNameCheck(n))))return!1}else if(qe[t]);else if(y(be,h(n,_e,"")));else if("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==b(n,"data:")||!Ke[e])if(we&&!y(me,h(n,_e,"")));else if(n)return!1;return!0},Ot=function(e){return"annotation-xml"!==e&&_(e,he)},wt=function(e){It("beforeSanitizeAttributes",e,null);const{attributes:t}=e;if(!t)return;const n={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye};let i=t.length;for(;i--;){const r=t[i],{name:o,namespaceURI:s,value:c}=r,d=rt(o);let f="value"===o?c:g(c);if(n.attrName=d,n.attrValue=f,n.keepAttr=!0,n.forceKeepAttr=void 0,It("uponSanitizeAttribute",e,n),f=n.attrValue,n.forceKeepAttr)continue;if(gt(o,e),!n.keepAttr)continue;if(!Ee&&y(/\/>/i,f)){gt(o,e);continue}if(Le&&y(/((--!?|])>)|<\/(style|title)/i,f)){gt(o,e);continue}Ae&&l([de,le,ue],e=>{f=h(f,e," ")});const p=rt(e.nodeName);if(Ct(p,d,f)){if(!Re||"id"!==d&&"name"!==d||(gt(o,e),f=Ne+f),te&&"object"==typeof G&&"function"==typeof G.getAttributeType)if(s);else switch(G.getAttributeType(p,d)){case"TrustedHTML":f=te.createHTML(f);break;case"TrustedScriptURL":f=te.createScriptURL(f)}try{s?e.setAttributeNS(s,o,f):e.setAttribute(o,f),St(e)?bt(e):u(a.removed)}catch(e){}}}It("afterSanitizeAttributes",e,null)},Et=function e(t){let n=null;const a=yt(t);for(It("beforeSanitizeShadowDOM",t,null);n=a.nextNode();){if(It("uponSanitizeShadowNode",n,null),xt(n))continue;const t=ee(n);1===n.nodeType&&(t&&t.__depth?n.__depth=(n.__removalCount||0)+t.__depth+1:n.__depth=1),(n.__depth>=st||n.__depth<0||I(n.__depth))&&bt(n),n.content instanceof d&&(n.content.__depth=n.__depth,e(n.content)),wt(n)}It("afterSanitizeShadowDOM",t,null)};return a.sanitize=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,i=null,r=null,s=null;if($e=!e,$e&&(e="\x3c!--\x3e"),"string"!=typeof e&&!Dt(e)){if("function"!=typeof e.toString)throw S("toString is not a function");if("string"!=typeof(e=e.toString()))throw S("dirty is not a string, aborting")}if(!a.isSupported)return e;if(Me||lt(t),a.removed=[],"string"==typeof e&&(je=!1),je){if(e.nodeName){const t=rt(e.nodeName);if(!ge[t]||Ie[t])throw S("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof x)n=vt("\x3c!----\x3e"),i=n.ownerDocument.importNode(e,!0),1===i.nodeType&&"BODY"===i.nodeName||"HTML"===i.nodeName?n=i:n.appendChild(i);else{if(!Te&&!Ae&&!ke&&-1===e.indexOf("<"))return te&&Fe?te.createHTML(e):e;if(n=vt(e),!n)return Te?null:Fe?ne:""}n&&Pe&&bt(n.firstChild);const c=yt(je?e:n);for(;r=c.nextNode();){if(xt(r))continue;const e=ee(r);1===r.nodeType&&(e&&e.__depth?r.__depth=(r.__removalCount||0)+e.__depth+1:r.__depth=1),(r.__depth>=st||r.__depth<0||I(r.__depth))&&bt(r),r.content instanceof d&&(r.content.__depth=r.__depth,Et(r.content)),wt(r)}if(je)return e;if(Te){if(Ue)for(s=re.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return(ye.shadowroot||ye.shadowrootmode)&&(s=se.call(o,s,!0)),s}let u=ke?n.outerHTML:n.innerHTML;return ke&&ge["!doctype"]&&n.ownerDocument&&n.ownerDocument.doctype&&n.ownerDocument.doctype.name&&y(Q,n.ownerDocument.doctype.name)&&(u="<!DOCTYPE "+n.ownerDocument.doctype.name+">\n"+u),Ae&&l([de,le,ue],e=>{u=h(u,e," ")}),te&&Fe?te.createHTML(u):u},a.setConfig=function(){lt(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),Me=!0},a.clearConfig=function(){ot=null,Me=!1},a.isValidAttribute=function(e,t,n){ot||lt({});const a=rt(e),i=rt(t);return Ct(a,i,n)},a.addHook=function(e,t){"function"==typeof t&&(ce[e]=ce[e]||[],f(ce[e],t))},a.removeHook=function(e){if(ce[e])return u(ce[e])},a.removeHooks=function(e){ce[e]&&(ce[e]=[])},a.removeAllHooks=function(){ce={}},a}()}()}
,676:e=>{"use strict";e.exports=a},207:e=>{"use strict";e.exports=o},949:e=>{"use strict";e.exports=i},529:e=>{"use strict";e.exports=t},277:e=>{"use strict";e.exports=s},810:e=>{"use strict";e.exports=c},718:e=>{"use strict";e.exports=r},159:e=>{"use strict";e.exports=n},280:e=>{"use strict";e.exports=d}},f={};function p(e){var t=f[e];if(void 0!==t)return t.exports;var n=f[e]={exports:{}};return u[e].call(n.exports,n,n.exports,p),n.exports}p.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return p.d(t,{a:t}),t},p.d=(e,t)=>{for(var n in t)p.o(t,n)&&!p.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},p.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),p.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l=e?e.src:"",p.p=l.slice(0,l.lastIndexOf("/")+1);var m={};return(()=>{"use strict";var e;p.r(m),p.d(m,{COMPONENT_ID_ATTRIBUTE:()=>l,CROP_HEIGHT_ATTRIBUTE:()=>f,CROP_WIDTH_ATTRIBUTE:()=>u,DistributionType:()=>e,EngageAttachmentType:()=>a,FONT_FAMILY_REGULAR:()=>te,FONT_REGULAR:()=>ee,TranspileProductSource:()=>n,WebpartRenderBuilder:()=>Ba,analyzeDocument:()=>Xa,analyzeHtmlString:()=>Ja,compareHtml:()=>ja,distributionTypeString:()=>t,getFontFamily:()=>le,getFontName:()=>ue,logIssuesToTraceLog:()=>Qa,logQosEvent:()=>fn,logQosEventNorequestValidation:()=>un,processEngageHtml:()=>Mt,processLink:()=>nt,purifyTranspiledHtml:()=>ut,sanitizeFontName:()=>fe,updateQosEvent:()=>mn}),function(e){e[e.Email=1]="Email",e[e.Teams=2]="Teams",e[e.VivaEngage=3]="VivaEngage",e[e.Web=4]="Web"}(e||(e={}));const t={1:"Email",2:"Teams",3:"VivaEngage",4:"Web"};var n,a;!function(e){e.Amplify="Amplify",e.SPOSites="SPO Sites"}(n||(n={})),function(e){e.Image="Image",e.WebLink="WebLink"}(a||(a={}));var i=p(529),r=p(159);const o="OWAAutoLink",s="data-scenario-source";var c;!function(e){e[e.UNIVERSAL_PADDING=20]="UNIVERSAL_PADDING",e[e.TABLE_FULL_WIDTH=740]="TABLE_FULL_WIDTH",e[e.SIDE_PADDING=20]="SIDE_PADDING",e[e.TABLE_RENDER_WIDTH=700]="TABLE_RENDER_WIDTH",e[e.CORNER_ROUND=4]="CORNER_ROUND",e[e.CORNER_CIRCLE=50]="CORNER_CIRCLE",e[e.ICON_SIZE=20]="ICON_SIZE",e[e.IMAGE_HEIGHT_RATIO=.5625]="IMAGE_HEIGHT_RATIO",e[e.MAX_TITLE_CHAR_CARD=90]="MAX_TITLE_CHAR_CARD",e[e.PADDING_HEIGHT_WITH_COLOR=32]="PADDING_HEIGHT_WITH_COLOR",e[e.PADDING_HEIGHT_WITHOUT_COLOR=16]="PADDING_HEIGHT_WITHOUT_COLOR",e[e.ICON_SIZE_SMALL=20]="ICON_SIZE_SMALL",e[e.ICON_SIZE_MEDIUM=64]="ICON_SIZE_MEDIUM",e[e.ICON_PADDING=2]="ICON_PADDING",e[e.THUMBNAIL_WIDTH_SMALL=36]="THUMBNAIL_WIDTH_SMALL",e[e.THUMBNAIL_WIDTH_MEDIUM=252]="THUMBNAIL_WIDTH_MEDIUM",e[e.THUMBNAIL_HEIGHT_MEDIUM=142]="THUMBNAIL_HEIGHT_MEDIUM",e[e.THUMBNAIL_MSO_WIDTH_MEDIUM=316]="THUMBNAIL_MSO_WIDTH_MEDIUM",e[e.THUMBNAIL_MSO_HEIGHT_MEDIUM=178]="THUMBNAIL_MSO_HEIGHT_MEDIUM",e[e.PADDING_PERSONA_TABLE_EXTRA_SMALL=6]="PADDING_PERSONA_TABLE_EXTRA_SMALL",e[e.PADDING_PERSONA_TABLE_SMALL=12]="PADDING_PERSONA_TABLE_SMALL",e[e.PERSONA_GAP=10]="PERSONA_GAP",e[e.COL_SPACING_CARD=16]="COL_SPACING_CARD",e[e.MARGIN_ROW_NS=10]="MARGIN_ROW_NS"}(c||(c={}));const d=new RegExp(/^https:\/\/[a-zA-Z0-9-]+\.sharepoint(-df)?\.com\/:v:\/[a-z]+\/([%\w-._]+\/)*(.+?\.(3g2|3gp|3gpp|asf|avi|m2ts|m4v|mkv|mov|mp4|mp4v|mts|ts|webm|wmv|3G2|3GP|3GPP|ASF|AVI|M2TS|M4V|MKV|MOV|MP4|MP4V|MTS|TS|WEBM|WMV)|[A-Za-z0-9_-]{1,})(\?.+)?$/),l="data-component-id",u="data-crop-width",f="data-crop-height";var _,h=p(676);function b(){return h._SPKillSwitch.isActivated("cf386800-8b1a-4aab-a476-9aa0f4217a01")}function g(){return h._SPKillSwitch.isActivated("0253b245-1fa4-48c8-82a1-ef50ccaa1293")}function v(){return h._SPKillSwitch.isActivated("d58004eb-6539-4c8e-b1f0-6b4bf62d9553")}function y(){return h._SPKillSwitch.isActivated("7e82d12a-e80f-4e46-a780-72d5d85e4f74")}function S(){return h._SPKillSwitch.isActivated("ccb69e83-0f18-49d0-a08b-f28365819d75")}function D(){return h._SPKillSwitch.isActivated("408f81a3-5096-449d-9aec-47bda9291ca2")}function I(){return h._SPKillSwitch.isActivated("d8bd2251-1f61-4a56-8090-8d26e9027c9e")}function x(){return h._SPKillSwitch.isActivated("632f0697-d80c-4240-a505-c1e745b6bdf6")}function C(){return h._SPKillSwitch.isActivated("7c3ed176-f124-4e14-8520-c92fcdfda97d")}function O(){return h._SPKillSwitch.isActivated("0e3646ba-1a0c-4162-8259-5d720a5d0ff4")}function w(){return h._SPKillSwitch.isActivated("7783a2d6-84a5-48b3-8780-54ae35b75dff")}function E(){return h._SPKillSwitch.isActivated("2e9ed34f-9e2f-4f69-b1b7-ed4655e92a83")}function A(){return h._SPKillSwitch.isActivated("ef92e25e-1635-4da3-9b8d-3ceb6b0310db")}function L(){return h._SPKillSwitch.isActivated("80ab7c92-7c0c-4f53-91f0-4adeca07509a")}function k(){return h._SPKillSwitch.isActivated("5234b4f0-fa1d-442c-aeab-cfa834a3a524")}function M(){return h._SPKillSwitch.isActivated("3f50e299-9470-4308-b334-829651455b36")}function P(){return h._SPKillSwitch.isActivated("787a27c1-6627-45e3-9b9a-8b080e4f6425")}function T(){return h._SPKillSwitch.isActivated("eb00cf38-294d-46db-ae30-9073d44ac6a2")}function U(){return h._SPKillSwitch.isActivated("75679e08-a023-402f-83cd-6470c8803633")}function F(){return h._SPKillSwitch.isActivated("7575a085-293c-4d43-a695-9a574936afa3")}function H(){return h._SPKillSwitch.isActivated("235b38ad-958e-416f-94cb-09c8a45cd221")}function R(){return h._SPKillSwitch.isActivated("c08bd636-3782-4a3b-9261-ccbcc92b8902")}function N(){return h._SPKillSwitch.isActivated("fd6ec24d-cba7-42f3-8e61-7e9d58045078")}function B(){return h._SPKillSwitch.isActivated("03f08395-f382-421a-b218-f62d23421fef")}function j(){return h._SPKillSwitch.isActivated("03e68aa3-cb28-4fa0-a612-ee93d1f65695")}function V(){return h._SPKillSwitch.isActivated("3aff5b38-bfcf-4604-bed4-9e570a64fefe")}function z(){return h._SPKillSwitch.isActivated("77f5760b-8e5c-4d97-9cd8-85b59d97bf1f")}function G(){return h._SPKillSwitch.isActivated("ab72f95c-adf9-4934-87d1-ea3869b6ec23")}function K(){return h._SPKillSwitch.isActivated("a07f82a4-427f-4917-80c1-ea13b4e1216d")}function W(){return h._SPKillSwitch.isActivated("992b35ec-3096-414f-a75e-9067332e6a60")}function q(){return h._SPKillSwitch.isActivated("9a8a4a11-afdd-4752-a4ff-aa7ff9181922")}function Q(){return h._SPKillSwitch.isActivated("8fe77794-7602-4436-b82a-aaf3b7beaf9b")}function Y(){return h._SPKillSwitch.isActivated("2054ee98-fd10-4e72-86ad-aff68a495671")}function J(){return h._SPKillSwitch.isActivated("95d8fca1-4189-4343-88ff-f847e48c9597")}function X(){return h._SPKillSwitch.isActivated("d94a8220-e6d5-4771-b24e-f593c3aff68b")}function Z(){return h._SPKillSwitch.isActivated("e5bec2c8-5139-4c59-8bbe-109c8b5552ee")}function $(){return h._SPKillSwitch.isActivated("c3a77c0b-ebf0-45cf-918c-9c81b8fa4ffd")}!function(e){e.FALLBACK_THUMB_ATT="backupThumbnailSrc"}(_||(_={}));const ee="'Segoe UI','Segoe UI Web (West European)', 'Segoe UI', -apple-system, BlinkMacSystemFont, Roboto, 'Helvetica Neue', sans-serif;",te=`font-family:${ee}`;function ne(e){return!h._SPKillSwitch.isActivated("c98522ef-407d-4be3-a47c-405437ed76d4")&&!!e}function ae(){return h._SPFlight.isEnabled(62368)}function ie(){return!z()&&h._SPFlight.isEnabled(1973)&&h._SPFlight.isEnabled(60847)}function re(){return!h._SPKillSwitch.isActivated("639ef9db-98be-4637-a5af-af372f50bffb")&&!h._SPKillSwitch.isActivated("b10afe46-4928-4f93-827c-bde0a05c5a03")&&h._SPFlight.isEnabled(61281)}function oe(){return!h._SPKillSwitch.isActivated("abc5ca03-f7c8-4d79-b7eb-6ba83b43a929")&&h._SPFlight.isEnabled(62620)}function se(e){let t="";if(e?.italic&&(t=t.concat("font-style: italic;")),e?.fontSize){const n=(0,r.fontSizeToPixel)(e.fontSize);t=t.concat(`font-size: ${n}px;`)}if(e?.fontWeight){const n=function(e){switch(e){case"thin":return 100;case"extra-light":return 200;case"light":return 300;default:return 400;case"medium":return 500;case"semi-bold":return 600;case"bold":return 700;case"extra-bold":return 800;case"black":return 900}}(e.fontWeight);t=t.concat(`font-weight: ${n};`)}return e?.overflow&&(t=t.concat(`overflow: ${(0,i.escape)(e.overflow)};`)),e?.textOverflow&&(t=t.concat(`text-overflow: ${(0,i.escape)(e.textOverflow)};`)),e?.fontColor&&(t=t.concat(`color: ${(0,i.escape)(e.fontColor)};`)),e?.minHeight&&(t=t.concat(`min-height: ${(0,i.escape)(e.minHeight)};`)),e?.lineHeight&&(t=t.concat(`line-height: ${(0,i.escape)(e.lineHeight)};`)),e?.lineClamp&&(t=t.concat("display: -webkit-box;"),t=t.concat(`-webkit-line-clamp: ${e.lineClamp};`),t=t.concat("-webkit-box-orient: vertical;")),e?.textDecoration&&(t=t.concat(`text-decoration: ${(0,i.escape)(e.textDecoration)};`)),t}function ce(e){let t,n="",a="",i="",r=0,o=0,s=0;if(e&&e.includes("rgb")){if(t=e.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/),!t)return!1;n=t[1],a=t[2],i=t[3],r=parseInt(n,10),o=parseInt(a,10),s=parseInt(i,10)}else{if(!e||!e.includes("#")||7!==e.length)return!1;n=e.substring(1,3),a=e.substring(3,5),i=e.substring(5,7),r=parseInt(n,16),o=parseInt(a,16),s=parseInt(i,16)}return Math.sqrt(r*r*.299+o*o*.587+s*s*.114)<=127.5}function de(e=!1){return e?c.PADDING_HEIGHT_WITH_COLOR:c.PADDING_HEIGHT_WITHOUT_COLOR}function le(e,t="body"){return`font-family:${ue(e,t)}`}function ue(e,t="body"){if(!h._SPFlight.isEnabled(61913))return ee;const n=e;let a="";switch(t){default:a=n?.fontSlots?.body?.fontFamily;break;case"title":a=n?.fontSlots?.title?.fontFamily;break;case"heading":a=n?.fontSlots?.heading?.fontFamily}return`${a?fe(a):""}${a?", ":""}${e.fonts.mediumPlus.fontFamily?`${e.fonts.mediumPlus.fontFamily};`:ee}`}function fe(e){return`'${e.replace(/"/g,"").replace(/'/g,"").replace(/-(\d+)$/g,"")}'`}function pe(e,t){if(e)return/^#([0-9A-F]{3}|[0-9A-F]{6})$/i.test(e)||t?.includes(e)?e:void 0}var me=p(277),_e=p(949);const he=JSON.parse('{"mH":"Word Document","iE":"PowerPoint","Bu":"Excel","ZV":"Image","q3":"Text Document","Ee":"Video","Pb":"YouTube Video"}');var be=p(718),ge=p(207);function ve(e,t){Object.keys(t).forEach(n=>{e.setAttribute(n,t[n])})}function ye(e,t){Object.keys(t).forEach(n=>{e.style.setProperty(n,t[n])})}function Se(e,t){const n=document.createElement("div");return n.innerHTML=e,Array.from(n.children).forEach(e=>{t.appendChild(e)}),t}const De=(e,t)=>{const n=document.createElement("span");n.style.position="absolute",n.style.visibility="hidden",n.style.whiteSpace="nowrap",n.style.left="-9999px",n.style.fontSize=t.fontSize||"16px",n.style.fontFamily=t.fontFamily||ee.replace(/;$/,""),n.style.fontWeight=t.fontWeight||"normal",n.style.letterSpacing=t.letterSpacing||"normal",n.style.fontStyle=t.fontStyle||"normal",n.textContent=e,document.body.appendChild(n);const a=n.getBoundingClientRect().width;return document.body.removeChild(n),a},Ie="breaklongword";function xe(e,t="Center",n=8,a=16,i,r,o,s,d,l,u,f,p,m){const _=document.createElement("table");s&&_.setAttribute("data-testid",s),_.setAttribute("align",t.toLowerCase()),_.setAttribute("border","0"),_.setAttribute("cellspacing","0"),_.setAttribute("cellpadding","0"),_.style.margin="Left"===t?"auto auto auto 0":"Right"===t?"auto 0 auto auto":"auto",_.style.padding="0px",_.style.borderSpacing="0px",_.style.borderCollapse="collapse",_.style.width="unset",_.style.backgroundColor=i,_.style.borderRadius=`${c.CORNER_ROUND}px`,T()||(re()?d&&(p||l)&&(_.style.border=`${p||"1px"} solid ${l||"transparent"}`):d&&l&&(_.style.border=`1px solid ${l}`),u&&(_.style.borderRadius="4px"),f&&(_.style.boxShadow="0px 0.6px 1.8px rgba(0, 0, 0, 0.1), 0px 3.2px 7.2px rgba(0, 0, 0, 0.13)"));const h=document.createElement("tr");h.style.padding="0",h.style.margin="0",o&&h.style.setProperty("border","0px hidden","important");const b=document.createElement("td");return b.style.padding="0",b.style.margin="0",b.style.paddingTop=`${n}px`,b.style.paddingRight=`${a}px`,b.style.paddingBottom=`${n}px`,b.style.paddingLeft=`${a}px`,r&&(b.style.color=r),re()&&m&&(b.style.height=`${m}px`),e instanceof HTMLElement?b.appendChild(e):b.appendChild(document.createTextNode(e)),h.appendChild(b),_.appendChild(h),_.outerHTML}function Ce(e,t,n){return`\n  ${e?`\x3c!--[if ${n?`(gte mso ${n})`:"mso"}]>`:"\x3c!--[if !mso]>\x3c!--\x3e"}\n  ${t}\n  ${e?"<![endif]--\x3e":"\x3c!--<![endif]--\x3e"}\n  `}function Oe(e=!1,t){return ne(t)&&t?e?t.maxColumnWidthWithPadding:t.maxColumnWidth:e?c.TABLE_FULL_WIDTH:c.TABLE_RENDER_WIDTH}function we(){return`OWA${me.Guid.generate()}`}function Ee(e){if(_e._PreviewUtility.isVideo(e))return he.Ee;switch(e.toLowerCase()){case"doc":case"docx":return he.mH;case"ppt":case"pptx":return he.iE;case"xls":case"xlsx":return he.Bu;case"heic":return he.ZV;case"txt":return he.q3;default:return e.toUpperCase()}}function Ae(e){try{const t=(new DOMParser).parseFromString(e,"text/html");return Pe(t,"a"),Pe(t,":not(.breaklongword) > span"),Pe(t,":not(.breaklongword) > li"),Pe(t,":not(.breaklongword) > p"),Pe(t,":not(.breaklongword) > div"),t.body.innerHTML}catch(t){return ge._TraceLogger.logError(ge._LogSource.create("SPTranspile"),t,"Exception parsing innerHtml for breaking long word"),e}}function Le(e,t){try{const n=(new DOMParser).parseFromString(e,"text/html");return ke(n,"a",t),ke(n,":not(.breaklongword) > span",t),ke(n,":not(.breaklongword) > li",t),ke(n,":not(.breaklongword) > p",t),ke(n,":not(.breaklongword) > div",t),n.body.innerHTML}catch(t){return ge._TraceLogger.logError(ge._LogSource.create("SPTranspile"),t,"Exception parsing innerHtml for breaking long word"),e}}function ke(e,t,n){if(P()){const a=Oe(!1,n)/8-16;e.querySelectorAll(t).forEach(e=>{const t=e.innerText;t?.length>=a&&(e instanceof HTMLAnchorElement&&C()?[t]:t.split(/\s+/).filter(e=>e.length>=a)).length>0&&(e.style.wordBreak="break-all",e.classList.add(Ie))})}else Me(e,t,Oe(!1,n)-16)}function Me(e,t,n){const a=e.querySelectorAll(t),i=n/8*.6;a.forEach(e=>{const t=function(e){const t=document.createElement("div");return t.innerHTML=e.innerHTML.replace(/<br\s*\/?>/gi," ").replace(/[\n\r]+/g," "),t.innerText}(e);if(!t||t.length<i)return;const a=window.getComputedStyle(e),r={fontSize:a.fontSize,fontFamily:a.fontFamily,fontWeight:a.fontWeight,letterSpacing:a.letterSpacing,fontStyle:a.fontStyle},o=t.split(/\s+/).filter(e=>e.length>=i).sort((e,t)=>t.length-e.length);for(const t of o)if(De(t,r)>n){e.style.wordBreak="break-all",e.classList.add(Ie);break}})}function Pe(e,t){if(P()){const n=Oe()/8-16;e.querySelectorAll(t).forEach(e=>{const t=e.innerText;t?.length>=n&&(e instanceof HTMLAnchorElement&&C()?[t]:t.split(/\s+/).filter(e=>e.length>=n)).length>0&&(e.style.wordBreak="break-all",e.classList.add(Ie))})}else Me(e,t,Oe()-16)}function Te(e,t,n,a){const r=Ue(e,n?.textBoxColor||"dark"),o=document.createElement("h3");o.textContent=w()?(0,i.escape)(t):t??"",o.style.borderRadius=`${c.CORNER_ROUND}px`,o.style.setProperty("margin","0px","important"),o.style.setProperty("padding","0px","important"),o.style.fontSize="20px",o.style.color=Ue(e,n?.textColor||"light"),n&&(o.style.fontWeight=n.isBold?"bold":"",o.style.fontStyle=n.isItalic?"italic":"");const s=xe(o,"Left",8,8,r,void 0,a),d=document.createElement("td");d.align="left",d.style.paddingBottom="16px",d.style.paddingLeft="0px",d.style.setProperty("border","none","important"),d.innerHTML=s;const l=document.createElement("tr");return l.style.setProperty("border","none","important"),l.appendChild(d),l}function Ue(e,t){switch(t){case"dark":return"#000000";case"theme":return e.semanticColors.inputBackgroundChecked;case"accent":return e.semanticColors.accentButtonBackground;default:return"#ffffff"}}function Fe(e){return e??location.origin}function He(e){return _e._PreviewUtility.mediaServiceSupportedMap.has(e.toLowerCase())?e:void 0}function Re(e){return Boolean(e?.source&&(e.source?.url||e.source.sharepointIds?.siteId&&e.source.sharepointIds?.webId&&e.source.sharepointIds?.uniqueId))}const Ne=new RegExp(/^https:\/\/[a-zA-Z0-9-]+\.sharepoint(-df)?\.com\/(:v:\/)?[a-z]+\/([%\w-._]+\/)*(.+?\.(mp4|webm|MP4|WEBM)|[A-Za-z0-9_-]{1,})(\?.+)?$/),Be=250,je=630,Ve="ck-editor-image-container",ze="http://schema.skype.com/Mention",Ge={Red:"#b6424c",Orange:"#cd5a38",Yellow:"#fdc031",GreenLight:"#bdcb4d",Green:"#2c9b63",Jade:"#387a7c",Blue:"#1f54a3",Purple:"#a53a7b"},Ke=Object.values(Ge),We={Red:"#df9299",Orange:"#f4a593",Yellow:"#fdd473",Green:"#e5f18f",DarkGreen:"#82cda8",Teal:"#9dd9db",Blue:"#c7d4e8",Purple:"#ebd3e1"},qe=Object.values(We),Qe="#4f52b2",Ye={text:" ",styles:[]},Je={blockType:"UNSTYLED",spans:[Ye]},Xe={blocks:[],attachments:[]},Ze=700;var $e=p(810);const et=new RegExp(/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i);function tt(e,t=!1){const n=["http","https","ftp","tel","pnm","mms","news"];if(t&&n.push("mailto"),!e)return!1;try{const t=new URL((0,i.escape)(e));if(!n.includes(t.protocol.replace(":","")))return!1;if(!X()){const t=e.trim();if(!t)return!1;const n=t.toLowerCase().replace(/(%3a|&#x3a;|&#58;)/gi,":");if(/^(?:\s)*(?:javascript|vbscript|data)\s*:/.test(n))return!1;if(/(?:\s|%0a|%0d|[#;/])\s*(?:javascript|vbscript)\s*:/.test(n))return!1}return!0}catch{return!1}}function nt(e){let t;return t=O()?new URL(be.UrlUtility.absolutizeUrl(e)).href:new URL(h._SPKillSwitch.isActivated("a01d1b01-2ada-4060-8795-4e138690fb34")?be.UrlUtility.absolutizeUrl(e,!0):function(e){const t=new $e.Uri(be.UrlUtility.absolutizeUrl(e,!0));return`${(0,i.escape)(t.getStringWithoutQueryAndFragment())}${t.getQuery()?`?${t.getQuery()}`:""}${t.getFragment()?`#${t.getFragment()}`:""}`}(e)).href,t}function at(e){const t=e.split("|");return 3===t.length?t[2]:e}const it={as:!0,as3:!0,asc:!0,ascx:!0,asm:!0,awk:!0,ltx:!0,m:!0,mkdn:!0,mm:!0,mud:!0,nfo:!0,opml:!0,osascript:!0,"3g2":!0,"3gp":!0,"3mf":!0,abap:!0,ada:!0,adp:!0,ahk:!0,ai:!0,arw:!0,asf:!0,asp:!0,bas:!0,bash:!0,bash_login:!0,bash_logout:!0,bash_profile:!0,bashrc:!0,bat:!0,bib:!0,bsh:!0,build:!0,bmp:!0,builder:!0,c:!0,"c++":!0,capfile:!0,cbk:!0,cc:!0,cfc:!0,cfm:!0,cfml:!0,cl:!0,clj:!0,cmake:!0,cmd:!0,coffee:!0,cool:!0,cpp:!0,cpt:!0,cpy:!0,cr2:!0,crw:!0,cs:!0,cshtml:!0,cson:!0,csproj:!0,css:!0,csv:!0,ctp:!0,cur:!0,cxx:!0,d:!0,dcm:!0,dcm30:!0,ddl:!0,di:!0,dic:!0,dicm:!0,dicom:!0,dif:!0,diff:!0,disco:!0,dml:!0,dng:!0,doc:!0,docm:!0,docx:!0,dotm:!0,dotx:!0,dtd:!0,dtml:!0,dwg:!0,el:!0,emake:!0,eml:!0,epub:!0,erb:!0,erf:!0,erl:!0,f90:!0,f95:!0,fbx:!0,fs:!0,fsi:!0,fsscript:!0,fsx:!0,gemfile:!0,gemspec:!0,gif:!0,gitconfig:!0,glb:!0,gltf:!0,go:!0,groovy:!0,gvy:!0,h:!0,"h++":!0,haml:!0,handlebars:!0,hbs:!0,hcp:!0,heic:!0,heif:!0,hevc:!0,hrl:!0,hs:!0,htc:!0,htm:!0,html:!0,hxx:!0,ico:!0,icon:!0,idl:!0,iim:!0,inc:!0,inf:!0,ini:!0,inl:!0,ipp:!0,irbrc:!0,jade:!0,jav:!0,java:!0,jpe:!0,jpeg:!0,jpg:!0,js:!0,json:!0,jsp:!0,jsx:!0,key:!0,l:!0,less:!0,lhs:!0,lisp:!0,log:!0,lst:!0,lua:!0,m2ts:!0,m4v:!0,make:!0,markdn:!0,markdown:!0,md:!0,mdown:!0,mef:!0,ml:!0,mli:!0,mll:!0,mly:!0,mov:!0,movie:!0,mp3:!0,mp4:!0,mp4v:!0,mrw:!0,msg:!0,mts:!0,nef:!0,nrw:!0,obj:!0,odp:!0,ods:!0,odt:!0,orf:!0,out:!0,p:!0,pages:!0,pano:!0,pas:!0,patch:!0,pdf:!0,pef:!0,php:!0,php2:!0,php3:!0,php4:!0,php5:!0,pict:!0,pl:!0,plist:!0,ply:!0,pm:!0,png:!0,pod:!0,pot:!0,potm:!0,potx:!0,pp:!0,pps:!0,ppsm:!0,ppsx:!0,ppt:!0,pptm:!0,pptx:!0,profile:!0,properties:!0,ps:!0,ps1:!0,psb:!0,psd:!0,pt:!0,py:!0,pyw:!0,r:!0,rake:!0,rb:!0,rbx:!0,rc:!0,re:!0,readme:!0,reg:!0,rest:!0,resw:!0,resx:!0,rhtml:!0,rjs:!0,rprofile:!0,rpy:!0,rss:!0,rst:!0,rtf:!0,rw2:!0,rxml:!0,s:!0,sass:!0,scala:!0,scm:!0,sconscript:!0,sconstruct:!0,script:!0,scss:!0,sgml:!0,sh:!0,shtml:!0,sketch:!0,sltx:!0,sml:!0,spm:!0,sql:!0,stl:!0,sty:!0,tcl:!0,tex:!0,text:!0,textile:!0,tif:!0,tiff:!0,tld:!0,tli:!0,tmpl:!0,tpl:!0,ts:!0,txt:!0,url:!0,vb:!0,vi:!0,vim:!0,vsd:!0,vsdx:!0,wmv:!0,wsdl:!0,xaml:!0,xbm:!0,xcf:!0,xd:!0,xhtml:!0,xls:!0,xlsb:!0,xlsx:!0,xml:!0,xoml:!0,xsd:!0,xsl:!0,xslt:!0,yaml:!0,yaws:!0,yml:!0,z:!0,zip:!0,zsh:!0};var rt=p(18),ot=p.n(rt);const st=["\x3c!--[if !mso]>","\x3c!--<![endif]--\x3e","\x3c!--<![if !mso]--\x3e","\x3c!--[if gte mso 9]--\x3e","<![endif]--\x3e","\x3c!--[if (gte mso 9)]>","\x3c!--[if mso]>","\x3c!--\x3e"],ct=["<v:roundrect","</v:roundrect>","<v:oval","</v:oval>","<v:fill","</v:fill>"],dt=e=>e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");function lt(e){return st.forEach((t,n)=>{const a=new RegExp(dt(t),"g");e=e.replace(a,`<msotag-${n}>`)}),ct.forEach((t,n)=>{const a=new RegExp(dt(t),"g");e=e.replace(a,`<vtag-${n}${n%2?">":""}`)}),e}function ut(e){e=lt(e);let t=ot().sanitize(e,{ADD_ATTR:["name","style","data-id","class","data-webpartid","backupthumbnailsrc","data-loopstyle","role",s,"data-local-index",l],FORBID_TAGS:["script","iframe","object","embed"],KEEP_CONTENT:!0,ALLOWED_URI_REGEXP:/^(?:(http|https|ftp|pnm|mms|news):\/\/|(tel|mailto):)?(\+?\w+)?(@)?([^\s:@]+)?([^\s:\/]+)(:[0-9]+)?(\/[^\s]*)?$/i,CUSTOM_ELEMENT_HANDLING:{allowCustomizedBuiltInElements:!0,tagNameCheck:e=>[...Array.from({length:ct.length},(e,t)=>`vtag-${t}`),...Array.from({length:st.length},(e,t)=>`msotag-${t}`)].includes(e),attributeNameCheck:e=>"xmlns:v"===e||"xmlns:w"===e||"arcsize"===e||"stroke"===e||"fillcolor"===e}});var n;return t&&(n=t,st.forEach((e,t)=>{const a=new RegExp(dt(`<msotag-${t}>`),"g");n=n.replace(a,e);const i=new RegExp(`</msotag-${t}>`,"g");n=n.replace(i,"")}),ct.forEach((e,t)=>{const a=new RegExp(dt(`<vtag-${t}${t%2?">":""}`),"g");n=n.replace(a,e);const i=new RegExp(`</vtag-${t}>`,"g");n=n.replace(i,"")}),t=n),t}function ft(e,t){t=pt(t||{R:255,G:255,B:255});let n=e=pt(e);return void 0!==e.A&&(n={R:t.R+(e.R-t.R)*e.A,G:t.G+(e.G-t.G)*e.A,B:t.B+(e.B-t.B)*e.A}),function(e){let t=e.Y/100,n=e.Z/108.883,a=e.X/95.047;return a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,{L:116*t-16,a:500*(a-t),b:200*(t-n)}}(function(e){let t=e.R/255,n=e.G/255,a=e.B/255;return t>.04045?t=Math.pow((t+.055)/1.055,2.4):t/=12.92,n>.04045?n=Math.pow((n+.055)/1.055,2.4):n/=12.92,a>.04045?a=Math.pow((a+.055)/1.055,2.4):a/=12.92,t*=100,n*=100,a*=100,{X:.4124*t+.3576*n+.1805*a,Y:.2126*t+.7152*n+.0722*a,Z:.0193*t+.1192*n+.9505*a}}(n))}function pt(e){let t,n,a,i;"R"in e?(t=e.R,n=e.G,a=e.B,i=e.A):(t=e.r,n=e.g,a=e.b,i=e.a);const r={R:t,G:n,B:a};return void 0!==i&&(r.A=i),r}function mt(e,t,n){("R"in e||"r"in e)&&(e=ft(e,n)),("R"in t||"r"in t)&&(t=ft(t,n));const a=e.L,i=e.a,r=e.b,o=t.L,s=t.a,c=t.b,d=Math.sqrt(Math.pow(i,2)+Math.pow(r,2)),l=Math.sqrt(Math.pow(s,2)+Math.pow(c,2)),u=(d+l)/2,f=.5*(1-Math.sqrt(Math.pow(u,7)/(Math.pow(u,7)+Math.pow(25,7)))),p=(1+f)*i,m=(1+f)*s,_=Math.sqrt(Math.pow(p,2)+Math.pow(r,2)),h=Math.sqrt(Math.pow(m,2)+Math.pow(c,2)),b=ht(r,p),g=ht(c,m),v=o-a,y=h-_,S=function(e,t,n,a){if(e*t==0)return 0;if(Math.abs(a-n)<=180)return a-n;if(a-n>180)return a-n-360;if(a-n<-180)return a-n+360;throw new Error}(d,l,b,g),D=2*Math.sqrt(_*h)*Math.sin(_t(S)/2),I=(a+o)/2,x=(_+h)/2,C=function(e,t,n,a){if(e*t==0)return n+a;if(Math.abs(n-a)<=180)return(n+a)/2;if(Math.abs(n-a)>180&&n+a<360)return(n+a+360)/2;if(Math.abs(n-a)>180&&n+a>=360)return(n+a-360)/2;throw new Error}(d,l,b,g),O=1-.17*Math.cos(_t(C-30))+.24*Math.cos(_t(2*C))+.32*Math.cos(_t(3*C+6))-.2*Math.cos(_t(4*C-63)),w=30*Math.exp(-Math.pow((C-275)/25,2)),E=Math.sqrt(Math.pow(x,7)/(Math.pow(x,7)+Math.pow(25,7))),A=1+.015*Math.pow(I-50,2)/Math.sqrt(20+Math.pow(I-50,2)),L=1+.045*x,k=1+.015*x*O,M=-2*E*Math.sin(_t(2*w));return Math.sqrt(Math.pow(v/(1*A),2)+Math.pow(y/(1*L),2)+Math.pow(D/(1*k),2)+M*(y/(1*L))*(D/(1*k)))}function _t(e){return e*(Math.PI/180)}function ht(e,t){if(0===e&&0===t)return 0;{const n=Math.atan2(e,t)*(180/Math.PI);return n>=0?n:n+360}}function bt(e){return 1!==(e=pt(e)).A?`rgba(${e.R}, ${e.G}, ${e.B}, ${e.A})`:`rgb(${e.R}, ${e.G}, ${e.B})`}function gt(e,t,n){const a=bt(e);return function(e,t,n,a){const i={};a=a||{R:255,G:255,B:255},n=n||"closest";for(let r=0;r<e.length;r+=1){const o=e[r];let s,c;for(let e=0;e<t.length;e+=1){const i=t[e],r=mt(o,i,a);s?(void 0!==c&&"closest"===n&&r<c||void 0!==c&&"furthest"===n&&r>c)&&(s=i,c=r):(s=i,c=r)}s&&(i[bt(o)]=s)}return i}([e],t,"closest",n=n||{R:255,G:255,B:255})[a]}function vt(e){e.querySelectorAll("table").forEach(e=>{const t=e.parentElement;t&&(t.removeAttribute("title"),t.removeAttribute("style"))}),e.querySelectorAll("tr, th, td").forEach(e=>{const t=(e.getAttribute("style")||"").split(";"),n=t.filter(e=>!e.includes("color"));n.length!==t.length&&e.setAttribute("style",n.join(";"))})}function yt(e,t){e.querySelectorAll("[style]").forEach(t)}function St(e){return"P"===e.tagName&&"true"===e.getAttribute("aria-hidden")&&"&nbsp;"===e.innerHTML}function Dt(){const e=document.createElement("p");return e.setAttribute("aria-hidden","true"),e.innerHTML="&nbsp;",e}function It(e,t){const n=e.querySelectorAll("[class]"),a=function(e){let t={highlightColorYellow:`background-color:${We.Yellow};`,highlightColorGreen:`background-color:${We.Green};`,highlightColorAqua:`background-color:${We.Blue};`,highlightColorMagenta:`background-color:${We.Purple};`,highlightColorBlue:`background-color:${We.Blue};`,highlightColorRed:`background-color:${We.Red};`,highlightColorDarkBlue:`background-color:${We.Blue};`,highlightColorTeal:`background-color:${We.Teal};`,highlightColorDarkGreen:`background-color:${We.DarkGreen};`,highlightColorPurple:`background-color:${We.Purple};`,highlightColorMaroon:`background-color:${We.Purple};`,highlightColorGold:"background-color:transparent;",highlightColorDarkGrey:"background-color:transparent;",highlightColorGrey:"background-color:transparent;",highlightColorBlack:"background-color:transparent;",fontColorRedDark:`color:${Ge.Red};`,fontColorRed:`color:${Ge.Orange};`,fontColorYellow:`color:${Ge.Yellow};`,fontColorYellowLight:`color:${Ge.Yellow};`,fontColorGreenLight:`color:${Ge.GreenLight};`,fontColorGreen:`color:${Ge.Green};`,fontColorBlueLight:`color:${Ge.Blue};`,fontColorBlue:`color:${Ge.Blue};`,fontColorBlueDark:"color:inherit;",fontColorPurple:`color:${Ge.Purple};`,fontColorThemeDarker:"color:inherit;",fontColorThemeDark:`color:${Ge.Blue};`,fontColorThemeDarkAlt:`color:${Ge.Blue};`,fontColorThemePrimary:`color:${Ge.Blue};`,fontColorThemeSecondary:`color:${Ge.Blue};`,fontColorThemeTertiary:`color:${Ge.Blue};`,fontColorNeutralTertiary:"color:inherit;",fontColorNeutralSecondaryAlt:"color:inherit;",fontColorNeutralSecondary:"color:inherit;",fontColorNeutralPrimaryAlt:"color:inherit;",fontColorNeutralPrimary:"color:inherit;",fontColorNeutralDark:"color:inherit;",fontSizeXSmall:"font-size:xx-small;",fontSizeSmall:"font-size:inherit;",fontSizeMedium:"font-size:inherit;",fontSizeMediumPlus:"font-size:inherit;",fontSizeLarge:"font-size:inherit;",fontSizeXLarge:"font-size:inherit;",fontSizeXLargePlus:"font-size:x-large;",fontSizeXxLarge:"font-size:x-large;",fontSizeXxxLarge:"font-size:x-large;",fontSizeXxLargePlus:"font-size:x-large;",fontSizeSuper:"font-size:x-large;",fontSizeMega:"font-size:x-large;"};if(!h._SPKillSwitch.isActivated("e85378d1-8e29-4e27-bc3f-e6e0018c7cb5")&&h._SPFlight.isEnabled(62409)&&e){const n={fontColorThemeDarker:`color:${e.palette.themeDarker};`,fontColorThemeDark:`color:${e.palette.themeDark};`,fontColorThemeDarkAlt:`color:${e.palette.themeDarkAlt};`,fontColorThemePrimary:`color:${e.palette.themePrimary};`,fontColorThemeSecondary:`color:${e.palette.themeSecondary};`,fontColorThemeTertiary:`color:${e.palette.themeTertiary};`,fontColorNeutralTertiary:`color:${e.palette.neutralTertiary};`,fontColorNeutralSecondaryAlt:`color:${e.palette.neutralSecondaryAlt};`,fontColorNeutralSecondary:`color:${e.palette.neutralSecondary};`,fontColorNeutralPrimaryAlt:`color:${e.palette.neutralPrimaryAlt};`,fontColorNeutralPrimary:`color:${e.palette.neutralPrimary};`,fontColorNeutralDark:`color:${e.palette.neutralDark};`};t={...t,...n}}return t}(t);n.forEach(e=>{const t=e.className.split(" ");t.includes(Ve)||t.includes("imagePlugin")||(t.forEach(t=>{if(a.hasOwnProperty(t)){const n=e.getAttribute("style")||"";e.setAttribute("style",`${n}${a[t]}`)}t!==Ve&&e.classList.remove(t)}),e.removeAttribute("class"))})}function xt(e){e.querySelectorAll("h2, h3, h4").forEach(t=>{const n=t.nodeName.toLowerCase();if("h2"===n&&t.parentNode){const n=e.createElement("h1");n.innerHTML=t.innerHTML,t.parentNode.replaceChild(n,t)}else if("h3"===n&&t.parentNode){const n=e.createElement("h2");n.innerHTML=t.innerHTML,t.parentNode.replaceChild(n,t)}else if("h4"===n&&t.parentNode){const n=e.createElement("h3");n.innerHTML=t.innerHTML,t.parentNode.replaceChild(n,t)}})}function Ct(e){e.querySelectorAll("p").forEach(e=>{if(St(e))return;const t=e.className.split(" ");if(t.includes("spacingAbove")){const t=e.previousElementSibling;!t||["H1","H2","H3","H4"].includes(t.tagName)||St(t)||e.before(Dt())}if(t.includes("spacingBelow")){const t=e.nextElementSibling;!t||["H1","H2","H3","H4"].includes(t.tagName)||St(t)||e.after(Dt())}})}function Ot(e,t,n){const a=(new DOMParser).parseFromString(e,"text/html");return vt(a),t||xt(a),Y()||Ct(a),It(a,n),function(e){e.querySelectorAll("[style]").forEach(e=>{const t=e.getAttribute("style")||"",n=t.split(";").find(e=>e.includes("font-size"));if(n){const a=n.split(":")[1].trim();if(a.includes("px")){const n=parseInt(a.replace("px",""),10);let i="";i=n<12?"xx-small":n<24?"inherit":"x-large",e.setAttribute("style",`${t.replace(a,i)}`),e.removeAttribute("data-fontsize")}}})}(a),function(e){const t=At(Ke),n=At(qe);e.querySelectorAll("[style]").forEach(e=>{const a=e.getAttribute("style")||"",i=a.split(";"),r=i.find(e=>e.includes("color"));if(r){const n=wt(r.split(":")[1].trim());if(n){const i=Et(gt(n,t));e.setAttribute("style",`${a.replace(r.split(":")[1].trim(),i)}`)}}const o=i.find(e=>e.includes("background-color"));if(o){const t=wt(o.split(":")[1].trim());if(t){const i=Et(gt(t,n));e.setAttribute("style",`${a.replace(o.split(":")[1].trim(),i)}`)}}})}(a),function(e){e.querySelectorAll("ul ol > li, ol ol > li").forEach(e=>{const t=e.getAttribute("style")||"";e.setAttribute("style",`${t}list-style: decimal;`)}),e.querySelectorAll("li").forEach(t=>{t.querySelectorAll("div:not(.imagePlugin):not(.teamsImagePlugin):not(.webPartInRte), p").forEach(t=>{const n=e.createElement("span");for(const{name:e,value:a}of Array.from(t.attributes))n.setAttribute(e,a);for(;t.firstChild;)n.appendChild(t.firstChild);t.replaceWith(n)})})}(a),Lt(a),function(e){e.querySelectorAll('[style*="text-align"]').forEach(e=>{e.style.removeProperty("text-align")})}(a),a.body.innerHTML}function wt(e){if("#"!==e[0])return;if(4!==e.length&&5!==e.length||(e="#"+e.substring(1).split("").map(e=>e+e).join("")),7!==e.length&&9!==e.length)return;const t=parseInt(e.slice(1,3),16),n=parseInt(e.slice(3,5),16),a=parseInt(e.slice(5,7),16);let i=1;return 9===e.length&&(i=parseInt(e.slice(7,9),16)/255),{R:t,G:n,B:a,A:i}}function Et(e){return`#${e.R.toString(16).padStart(2,"0")}${e.G.toString(16).padStart(2,"0")}${e.B.toString(16).padStart(2,"0")}${void 0===e.A||1===e.A?"":Math.round(255*e.A).toString(16).padStart(2,"0")}`}function At(e){const t=[];return e.forEach(e=>{const n=wt(e);n&&t.push(n)}),t}function Lt(e){kt(e,"sub")}function kt(e,t){e.querySelectorAll(t).forEach(e=>{const t=e.parentElement;for(;e.firstChild;)t?.insertBefore(e.firstChild,e);t?.removeChild(e)})}function Mt(e,t){const n=(new DOMParser).parseFromString(e,"text/html");return vt(n),Y()||(t?.skipHeadingLevelShift||Pt(n),Ct(n)),It(n),function(e){yt(e,e=>{e.style.fontSize&&(e.removeAttribute("data-fontsize"),e.style.fontSize="")})}(n),function(e){yt(e,e=>{void 0!==e.style.color&&e.style.removeProperty("color"),void 0!==e.style.backgroundColor&&e.style.removeProperty("background-color")})}(n),function(e){yt(e,e=>{void 0!==e.style.textAlign&&e.style.removeProperty("text-align"),void 0!==e.style.marginLeft&&e.style.removeProperty("margin-left")})}(n),Y()&&!t?.skipHeadingLevelShift&&Pt(n),function(e){e.querySelectorAll(":is(ul, ol) :is(ul, ol) :is(ul, ol) :is(ul, ol)").forEach(e=>{let t=e;for(;Tt(t)>3||"LI"!==t.tagName;)t=t.parentElement;const n=t.parentElement;Array.from(e.children).filter(e=>"LI"===e.tagName).forEach(e=>{n.insertBefore(e,t.nextSibling),t.textContent||t.remove(),t=e})});const t=e.querySelectorAll("ol li li li ol, ol li li li ul, ul li li li ol, ul li li li ul");Array.from(t).filter(e=>!e.children.length).forEach(e=>{e.remove()})}(n),function(e){const t=e.querySelectorAll("figure");t.forEach(e=>{e.querySelectorAll("table").forEach(t=>{e.before(t)})}),t.forEach(e=>{e.remove()});const n=e.querySelectorAll("table");n.forEach(t=>{t.querySelectorAll("td, th").forEach(n=>{Array.from(n.childNodes).forEach(n=>{let a=""===n.textContent?.trim();if(!h._SPKillSwitch.isActivated("aefbe52f-d533-4f06-8c97-46beecbc9604")){const e=Array.from(n.childNodes||[]).some(e=>e.nodeType!==Node.TEXT_NODE);a=e||"P"!==n.nodeName?a&&!(e||n.nodeType!==Node.TEXT_NODE):"true"===n.getAttribute("aria-hidden")&&"&nbsp;"===n.innerHTML}if(h._SPKillSwitch.isActivated("faa8a794-5227-40b7-850e-09526f8a3a77")||!a)if("SPAN"===n.nodeName||"#text"===n.nodeName){const a=e.createElement("p");a.appendChild(n),t.before(a)}else t.before(n)})})}),n.forEach(e=>{e.remove()})}(n),function(e){e.querySelectorAll(".floatRight, .floatLeft").forEach(e=>{e.classList.remove("floatRight"),e.classList.remove("floatLeft"),e.dataset.alignment="Center"})}(n),h._SPKillSwitch.isActivated("19c03830-564c-44dd-9591-3d49bee3e403")||(function(e){kt(e,"sup")}(n),Lt(n)),function(e){!function(e,t){e.querySelectorAll("[start]").forEach(e=>{e.removeAttribute("start")})}(e)}(n),n.body.innerHTML}function Pt(e){xt(e),e.querySelectorAll("h3").forEach(t=>{const n=e.createElement("strong");n.innerHTML=t.innerHTML;const a=e.createElement("p");a.appendChild(n),t.parentNode?.replaceChild(a,t)})}function Tt(e){let t=0;for(;e.parentElement;)"OL"!==(e=e.parentElement).tagName&&"UL"!==e.tagName||t++;return t}const Ut=p.p+"odm_GlobeIcon_Dark_22x22_05895617.png",Ft=p.p+"odm_GlobeIcon_Light_22x22_71032462.png",Ht=p.p+"odm_GlobeIcon_Light_16x9_19e656b6.png",Rt=p.p+"odm_GlobeIcon_LightGray_22x22_843c7f52.png",Nt=p.p+"odm_GlobeIcon_LightGray_16x9_dfc9064e.png",Bt=p.p+"odm_GlobeIcon_Dark_16x9_35fb9614.png",jt=p.p+"odm_Excel_16x9_077a1c6e.png",Vt=p.p+"odm_PowerPoint_16x9_63cd9e91.png",zt=p.p+"odm_Word_16x9_1f1d0135.png",Gt=p.p+"odm_SharePoint_16x9_f7cb4621.png",Kt=p.p+"odm_Stream_16x9_6f0e4327.png",Wt=p.p+"odm_ClipChamp_24_f71e74e6.png",qt=p.p+"odm_ClipChamp_16x9_0a830e6c.png",Qt=p.p+"odm_newsCarousel1_3bd855d4.png",Yt="https://res-2-sdf.cdn.office.net",Jt=["pptx","docx","xlsx","spo","video"],Xt=["video"],Zt={pptx:"powerpoint",docx:"word",xlsx:"excel",spo:"sharepoint",video:"stream"},$t={pptx:Vt,docx:zt,xlsx:jt,spo:Gt,video:Kt};var en;function tn(e,t,n=!1){const a=function(e,t){return an(1===e?t?Ht:H()?Bt:Nt:t?Ft:H()?Ut:Rt)}(t,n),i=be.EXTENSIONS_TO_FILENAME_MAP[e];return Jt.includes(i)?nn(i,t):a}function nn(e,t){const n=`${h._SPKillSwitch.isActivated("db5efa28-2e9c-4025-9ecb-59a733278af0")?h._FluentIconVersionedCdnPathTemp:(0,h._getPrimaryVersionedPath)()}/assets/brand-icons/product/png`,a=(e=>0===e?G()?Zt:{...Zt,video:Wt}:G()?$t:{...$t,video:qt})(t)[e];if(0!==t||!G()&&Xt.includes(e))return an(a);{let e=Yt;return sessionStorage.getItem("spfx-debug")||(e=new $e.Uri(Qt).getLeftPart($e.UriPartial.authority)),`${e}${n}/${a}_32x1.png`}}function an(e){if(!sessionStorage.getItem("spfx-debug"))return e;const t=new $e.Uri(e).getLastPathSegment();return-1===t.indexOf(".png")?e:`${Yt}/files/sp-client/${t}`}!function(e){e[e.small=0]="small",e[e.medium=1]="medium"}(en||(en={}));const rn={SPACE:new RegExp("\\s"),AT_SYMBOL:new RegExp("@"),DOLLAR:new RegExp("\\$"),PARENTHESES:new RegExp("[()]"),TILDE:new RegExp("~"),EXCLAMATION:new RegExp("!"),HASH:new RegExp("#"),CARET:new RegExp("\\^"),PLUS:new RegExp("\\+"),PERCENT:new RegExp("%"),PERCENTENCODED:new RegExp("%[0-9A-Fa-f]{2}"),AMPERSAND:new RegExp("&"),SEMICOLON:new RegExp(";"),ANGLE_BRACKETS:new RegExp("[<>]"),QUOTES:new RegExp("[\"']"),EMOJI:new RegExp("([\\u203C-\\u3299]|[\\uD83C-\\uDBFF][\\uDC00-\\uDFFF])","g"),NON_ASCII:new RegExp("[^\\u0020-\\u007E]","g")};var on,sn;function cn(e,t=!1){if(!e||!(n=e)||""===n.trim())return{url:"",hasSpecialCharacters:!1,matchedSpecialCharacters:[],urlType:"blank",urlLocation:"blank"};var n;let a="Unknown";!function(e){try{const t=new URL(e);return!!t.protocol&&!!t.host}catch{return!1}}(e)?function(e){return!new RegExp("^[a-zA-Z][a-zA-Z\\d+\\-.]*:").test(e)}(e)?a="relative":function(e){return e.startsWith("data:image/")&&e.includes(";base64,")}(e)&&(a="Base64"):a="absolute";const i=function(e){return function(e){return new RegExp("\\/driveItem\\/thumbnails\\/").test(e)}(e)?"driveItem":function(e){return new RegExp("^https?:\\/\\/hubblecontent\\.osi\\.office\\.net").test(e)}(e)?"hubble":function(e){return new RegExp("\\/SiteAssets\\/").test(e)}(e)?"siteassets":function(e){return new RegExp("-my").test(e)}(e)?"odb":function(e){return new RegExp("svc\\.ms").test(e)}(e)?"cdn":function(e){return new RegExp("\\/:t:\\/t\\/").test(e)}(e)?"shareLink":function(e){const t=window.location.host;try{return new URL(e).host!==t}catch{return!1}}(e)?"othersite":function(e){return new RegExp("\\/_layouts\\/15\\/userPhoto\\.aspx\\?").test(e)}(e)?"people":"other"}(e),[r]=function(e){const t=e.indexOf("?");return-1===t?[e,""]:[e.substring(0,t),e.substring(t+1)]}(e.trim()),o=Object.entries(rn).filter(([,e])=>e.test(r)).map(([e])=>e);return{url:"Base64"===a?"":e,hasSpecialCharacters:o.length>0,matchedSpecialCharacters:o,urlType:a,urlLocation:i}}function dn(e,t){return nt(e)===nt(t)}function ln(t,n,a){if(!t)return{valid:!1,reason:"validateImageLink: No div provided"};if(W()){const e=t.querySelector("img");if(!e)return{valid:!1,reason:"validateImageLink: No <img> tag found"};const a=e.closest("a");if(!a)return{valid:!1,reason:"validateImageLink: Image not wrapped in <a> tag"};if(""===n&&a)return{valid:!1,reason:"validateImageLink: Expected href is empty but anchor exists"};const i=dn(n,a.href);return{valid:i,reason:i?void 0:"validateImageLink: href does not match expected value"}}{let i=null;if(a!==e.VivaEngage&&(i=t.querySelector("img"),!i))return{valid:!1,reason:"validateImageLink: No <img> tag found"};let r=null;if(a===e.Email){if(i){if(r=i.closest("a"),!r)return{valid:!1,reason:"validateImageLink: Image not wrapped in <a> tag"};if(""===n&&r)return{valid:!1,reason:"validateImageLink: Expected href is empty but anchor exists"}}}else if(r=t.querySelector("a"),!r)return{valid:!1,reason:"validateImageLink: Image not wrapped in <a> tag"};const o=!!r&&dn(n,r?.href);return{valid:o,reason:o?void 0:"validateImageLink: href does not match expected value"}}}function un(e,t){try{const n=new ge._QosMonitor(e);return t.error&&t.error.length>0?void n.writeUnexpectedFailure(t.error[0],void 0,t):void n.writeSuccess(t)}catch(e){new ge._QosMonitor("Transpile.ImageAnalysisHelper.qosEventNorequestValidation").writeUnexpectedFailure("Error while logging QoS event without request validation",pn(e),t)}}function fn(e,t){try{const n=[...t.primaryImageDetails?[t.primaryImageDetails]:[],...t.fallbackImageDetails||[]];if(!n.some(e=>200===e.httpStatus&&!e.errorMessage?.length&&!e.httpErrorName&&!e.httpStatusText)&&!n.every(e=>void 0!==e.httpStatus&&null!==e.httpStatus))return;const a=new ge._QosMonitor(e);if(t.primaryImageDetails&&void 0!==t.primaryImageDetails.httpStatus&&200===t.primaryImageDetails.httpStatus&&t.error&&t.error.length>0)return void a.writeUnexpectedFailure(t.error[0],void 0,t);if(t.primaryImageDetails&&200===t.primaryImageDetails.httpStatus)return void a.writeSuccess(t);let i=!1;t.fallbackImageDetails&&0!==t.fallbackImageDetails.length&&(i=t.fallbackImageDetails.some(e=>200===e.httpStatus&&!e.errorMessage?.length&&!e.httpErrorName&&!e.httpStatusText)),i?a.writeExpectedFailure(t.primaryImageDetails?.httpStatusText,void 0,t):a.writeUnexpectedFailure(t.primaryImageDetails?.httpStatusText,void 0,t)}catch(e){new ge._QosMonitor("Transpile.ImageAnalysisHelper.qosEventBuilder").writeUnexpectedFailure("Error while logging QoS event",pn(e),t)}}function pn(e){if(!(e instanceof Error))return new Error("Unknown error type");const t=e=>e.replace(/[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}/gi,"[REDACTED_EMAIL]").replace(/https?:\/\/[^\s]+/gi,"[REDACTED_URL]").replace(/\b\d{1,3}(\.\d{1,3}){3}\b/g,"[REDACTED_IP]").replace(/(?:[A-Z]:\\|\/)[\w\-./\\]+/gi,"[REDACTED_PATH]"),n=new Error(t(e.message));return n.name=e.name,n.stack=e.stack?t(e.stack):void 0,n}function mn(e,t,n,a,i,r,o,s,c,d){if(!W())try{const d=n?.get("SPRequestGuid")||void 0;if(t&&c&&c.primaryImageDetails)c.primaryImageDetails={...c.primaryImageDetails,httpStatus:void 0!==a?a:c.primaryImageDetails.httpStatus,httpErrorName:i||c.primaryImageDetails.httpErrorName,httpStatusText:r||c.primaryImageDetails.httpStatusText,spRequestGuid:d||c.primaryImageDetails.spRequestGuid,downloadLatency:o?Math.round(o):c.primaryImageDetails.downloadLatency,imageSize:s||c.primaryImageDetails.imageSize};else if(!t&&c?.fallbackImageDetails){const t=c.fallbackImageDetails.findIndex(t=>t.url===e);-1!==t&&(c.fallbackImageDetails[t]={...c.fallbackImageDetails[t],httpStatus:void 0!==a?a:c.fallbackImageDetails[t].httpStatus,httpErrorName:i||c.fallbackImageDetails[t].httpErrorName,httpStatusText:r||c.fallbackImageDetails[t].httpStatusText,spRequestGuid:d||c.fallbackImageDetails[t].spRequestGuid,downloadLatency:o?Math.round(o):c.fallbackImageDetails[t].downloadLatency,imageSize:s||c.fallbackImageDetails[t].imageSize})}}catch(e){new ge._QosMonitor("Transpile.ImageAnalysisHelper.qosEventBuilder").writeUnexpectedFailure("Error while updating QoS event",pn(e),c)}}function _n(t,n,a,i,r,o,s){const c={};c.componentId=n,c.distributionType=a?e[a]:"Uknown",c.transpileCorrelationId=t;const d=cn(o?.imageUrl,!1),l=cn(o?.fallbackImageUrl,!0),u=cn(i,!1),f=cn(r,!0);if(c.inputPrimaryImageDetails=d,c.primaryImageDetails=u,c.inputFallbackImageDetails=l?[l]:[],c.fallbackImageDetails=f?[f]:[],void 0===c.error&&(c.error=[]),d?.errorMessage&&c.error.push(...d.errorMessage),l?.errorMessage&&c.error.push(...l.errorMessage),u?.errorMessage&&c.error.push(...u.errorMessage),d?.errorMessage&&c.error.push(...d.errorMessage),l?.errorMessage&&c.error.push(...l.errorMessage),u?.errorMessage&&c.error.push(...u.errorMessage),f?.errorMessage&&c.error.push(...f.errorMessage),c.hasLinkInProps=!!o?.linkUrl,o?.linkUrl){const t=document.createElement("div");t.innerHTML=s||"";const n=ln(t,o.linkUrl,a??e.Email);c.hasValidLinkInOutput=n.valid,!n.valid&&n.reason&&c.error.push(n.reason)}return c}!function(e){e.Absolute="absolute",e.Relative="relative",e.Blank="blank",e.Unknown="Unknown",e.Base64="Base64"}(on||(on={})),function(e){e.Hubble="hubble",e.SiteAssets="siteassets",e.OtherSite="othersite",e.Odb="odb",e.Cdn="cdn",e.People="people",e.Blank="blank",e.Other="other",e.DriveItem="driveItem",e.ShareLink="shareLink"}(sn||(sn={}));class hn{initialize(e,t){this._context={...e,...t,getComponent:e=>this._components.get(e),processStyles:e=>this._getStyle(e)};for(const e of this._registrations){const t=new e(this._context);this._components.set(t.componentName,t)}}renderComponent(e){return this._components.get(e.componentName)?.render(e)}async renderComponentAsync(e){const t=this._components.get(e.componentName);if(t)return await(t.executeRender?.(e))}_getStyle(t){switch(this._distributionType){case e.VivaEngage:return function(e){const t=[];return e?.italic&&t.push("ITALIC"),"semi-bold"!==e?.fontWeight&&"bold"!==e?.fontWeight&&"extra-bold"!==e?.fontWeight||t.push("BOLD"),t}(t);case e.Teams:return function(e){if(g())return se(e);const t=se({fontColor:e?.fontColor,textDecoration:e?.textDecoration});return e?.fontSize?`font-size: ${function(e){switch(e){case"xxx-small":case"xx-small":case"x-small":case"small":return"x-small";case"large":case"x-large":case"xx-large":return"x-large";default:return"inherit"}}(e.fontSize)}; ${t}`:t}(t);default:return se(t)}}constructor(e,t){this._components=new Map,this._registrations=e,this._distributionType=t}}class bn extends Error{get errorData(){return this._errorData}constructor(e){super(e.errorMessage),this._errorData=e,this.stack=e.error.stack||""}}class gn{get componentId(){return this._componentId||(this._componentId=this._makeComponentId()),this._componentId}async executeRender(e){try{return await this.preRender(e),await this.renderAsync(e)}catch(e){throw e instanceof bn?this.context.addLogging?.({...e.errorData,componentId:this.componentId}):this.context.addError?.([{error:e,errorMessage:"Unexpected error during component execution",errorType:$e.ResultTypeEnum.Failure,componentName:this.componentName}]),e}}async renderAsync(e){return this.render(e)}async preRender(e){}_makeComponentId(){const e=h.Guid.newGuid().toString();return`${this.componentName}-${e}`}createCustomError(e,t,n){const a={errorMessage:e,errorType:t,componentName:this.componentName,error:n||new Error(e),componentId:this.componentId};return new bn(a)}constructor(e){this.context=e}}function vn(e,t,n,a,i){let r=e,o=t,s=1;if(n&&r&&r>n&&(s=r/n),a&&o&&o>a&&(s=Math.max(s,o/a)),s>1){const e=i||Math.round;r=r?e(r/s):r,o=o?e(o/s):o}return{finalWidth:r,finalHeight:o}}var yn,Sn=p(280),Dn=new RegExp(/(\%[0-9][A-F])|(\%[A-F][0-9])|(\%[A-F][A-F])/g),In=new RegExp(/(\%[0-9][a-f])|(\%[a-f][0-9])|(\%[a-f][a-f])/g);!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative"}(yn||(yn={}));var xn=function(){function e(e,t){void 0===e&&(e=""),t&&("/"===e[e.length-1]&&"/"===t[0]?e+=t.slice(1):"/"!==e[e.length-1]&&"/"!==t[0]?e=e+"/"+t:e+=t);var n=e.indexOf("//"),a=e.indexOf("/"),i=e.indexOf("?"),r=n>-1&&n<=a?n+"//".length:-1,o=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,r),s=o&&o.slice(r),c=s&&s.split(":")[0],d=i>0?e.slice(o.length,i):e.slice(o.length),l=o?yn.absolute:"/"===d[0]?yn.serverRelative:yn.relative,u=d.split("/");this._originalSearchString=i>0?e.slice(i):"",this.searchParams=new URLSearchParams(this._originalSearchString),this.authority=o,this.domain=s,this.host=c,this.format=l,this.path=d,this.segments=u,this.value=e}return e._getTenantInfoFromPageContext=function(e){var t,n=null!==(t=null==e?void 0:e.legacyPageContext)&&void 0!==t?t:e,a=!me.KillSwitch.isActivated("78469d39-5abf-45a7-8609-c4f00dab856b");return e?{isMultiGeo:a?n.isMultiGeoTenant:e.legacyPageContext.isMultiGeoTenant,multiGeoInfo:a?n.multiGeoInfo:e.legacyPageContext.multiGeoInfo,singleTenant:a?n.vanityUrls:e.legacyPageContext.vanityUrls}:void 0},e._getHostFromUrl=function(t){return t?new e(t).domain:t},e._getMySiteAndPortalDomain=function(){var e="-my",t="-admin",n="".concat(window.location.protocol,"//").concat(window.location.hostname),a=window.location.hostname.substr(0,window.location.hostname.indexOf("."));if(me.KillSwitch.isActivated("751b021d-5b05-45f0-b649-d8fd0dab3170")||-1===a.indexOf(t))return-1===a.indexOf(e,a.length-e.length)?[n.toString().replace(a,a+e),n]:(i=n.toString().replace(a,a.substring(0,a.length-e.length)),[n,i]);var i,r=a.substring(0,a.length-t.length);return[n.toString().replace(a,r+e),i=n.toString().replace(a,r)]},e.prototype.toString=function(){return this.authority+this.path+this.searchParamString},e.prototype.equals=function(e){return e&&this.toString()===e.toString()},e.prototype.isInternalResource=function(t){var n=this,a=e._getTenantInfoFromPageContext(t);try{if((null==a?void 0:a.isMultiGeo)&&(null==a?void 0:a.multiGeoInfo))return a.multiGeoInfo.some(function(e){return n._isSameHost(e.PortalUrl)||n._isSameHost(e.MySiteHostUrl)||n._isSameHosts(e.AdditionalUrls)});var i=e._getMySiteAndPortalDomain();if(this._isSameHosts(i))return!0;if((null==a?void 0:a.singleTenant)&&(null==a?void 0:a.singleTenant.SingleTenant_AdditionalVanityUrls)&&-1!==a.singleTenant.SingleTenant_AdditionalVanityUrls.split(";").indexOf(this.domain))return!0;if((null==a?void 0:a.singleTenant)&&this._isInternalResourceOfSingleTenant(a.singleTenant))return!0}catch(e){return!1}return!1},e.prototype.setSearchParam=function(e,t){t?this.searchParams.set(e,decodeURIComponent(t.replace(/\+/g," "))):this.searchParams.set(e,t)},Object.defineProperty(e.prototype,"searchParamString",{get:function(){var e,t=null===(e=this.searchParams.toString())||void 0===e?void 0:e.replace(/\+/g,"%20");return t&&this._originalSearchString.match(In)&&(t=t.replace(Dn,function(e){return null==e?void 0:e.toLowerCase()})),t?"?"+t:t},enumerable:!1,configurable:!0}),e.prototype.getQueryParameter=function(e){var t;return null===(t=this.searchParams)||void 0===t?void 0:t.get(e)},e.prototype.removeQueryParameter=function(e){var t;null===(t=this.searchParams)||void 0===t||t.delete(e)},e.prototype._isInternalResourceOfSingleTenant=function(e){return e.SingleTenant_OneDriveUrl===this.domain||e.SingleTenant_PortalUrl===this.domain||e.SingleTenant_TeamSitesUrl===this.domain},e.prototype._isSameHost=function(t){return this.domain.toLowerCase()===e._getHostFromUrl(t).toLowerCase()},e.prototype._isSameHosts=function(e){var t=this;return!!(null==e?void 0:e.some(function(e){return t._isSameHost(e)}))},e}(),Cn=function(){function e(){}var t;return e.isHostApprovedForThumbnail=function(e){if(e.format!==yn.absolute)return!0;var t=e.host.toLowerCase();if(this._allowListHosts.has(t)||this._allowListDomains.has(t))return!0;for(var n=0;n<this._allowListDomainsArray.length;n++)if(t.endsWith(this._allowListDomainsArray[n]))return!0;return!1},t=e,e._stockHostNamesArray=["modern.akamai.odsp.cdn.office.net","az741266.vo.msecnd.net","spoprod-a.akamaihd.net","spoppe-a.akamaihd.net","az742526.vo.msecnd.net","spoppe-b.akamaized.net","spoppe-b.azureedge.net","spoppe-b2.azureedge.net","modernb.akamai.odsp.cdn.office.net","modernb.verizon.odsp.cdn.office.net","res-1-sdf.cdn.office.net","res-2-sdf.cdn.office.net","res-1.cdn.office.net","res-2.cdn.office.net","res.cdn.office.net","res-sdf.cdn.office.net","res-1.df.onecdn.static.microsoft","res-2.df.onecdn.static.microsoft","res.df.onecdn.static.microsoft","res-2.public.onecdn.static.microsoft","res-1.public.onecdn.static.microsoft","res.public.onecdn.static.microsoft","odspwebcidev.z13.web.core.windows.net","odspwebuserdev.z1.web.core.windows.net"],e.STOCK_HOST_NAMES=new Set(t._stockHostNamesArray),e._allowListDomainsArray=["1drv.com","1drv-int.com","livefilestore.com","onedrive.com","protection.office.com","protection.office.de","scc.office365.us","compliance.microsoft.us","security.microsoft.us","scc.protection.apps.mil","compliance.apps.mil","security.apps.mil","scc.eaglex.ic.gov","compliance.eaglex.ic.gov","security.eaglex.ic.gov","scc.microsoft.scloud","compliance.microsoft.scloud","security.microsoft.scloud","scc.microsoftonline.cn","compliance.microsoftonline.cn","security.microsoftonline.cn","odsp.microsoft.scloud","microsoft.eaglex.ic.gov","spo.eaglex.ic.gov","spo.microsoft.scloud","microsoft.scloud","sharepoint.com","sharepoint-df.com","sharepointonline.com","spoppe.com","storage.live.com","yammer.com","yammer.dev","microsoft.com"],e._allowListDomains=new Set(t._allowListDomainsArray),e._allowListHosts=new Set((0,Sn.__spreadArray)((0,Sn.__spreadArray)([],t._stockHostNamesArray,!0),["filevilleprod.blob.core.windows.net","filevillebackupprod.blob.core.windows.net","filevillestaging.blob.core.windows.net","filevillebackupstaging.blob.core.windows.net","mediatestfiles.blob.core.windows.net","metastoragecentralus.blob.core.windows.net","yameufileville.blob.core.windows.net","outlook.live.com","outlook.office.com","outlook-sdf.office.com","exchangelabs.live-int.com","attachment.outlook.live.net","attachment.outlook.office.net","attachments.office.net","attachments-sdf.office.net","attachments.office365-net.cn","attachments.office365-net.de","attachments.office365-net.us","attachments-dod.office365-net.us","media.akamai.odsp.cdn.office.net","cdn.hubblecontent.osi.office.net","cdn.hubblecontent.msit.osi.office.net","res-sdf.cdn.office.net","static2.azure.odsp.microsoft.scloud","static2.azure.odsp.microsoft.eaglex.ic.gov","modern.azure.odsp.microsoft.scloud","modern.azure.odsp.microsoft.eaglex.ic.gov","hubblecontent.azureedge.microsoft.scloud","hubblecontent.azureedge.eaglex.ic.gov","scc.protection.apps.mil","scc.eaglex.ic.gov","compliance.eaglex.ic.gov","security.eaglex.ic.gov","wus2.proxyservice.ediscovery.office365.com","wus.proxyservice.ediscovery.office365.com","eus.proxyservice.ediscovery.office365.com","cus.proxyservice.ediscovery.office365.com","ncus.proxyservice.ediscovery.office365.com","scus.proxyservice.ediscovery.office365.com","weur.proxyservice.ediscovery.office365.com","seas.proxyservice.ediscovery.office365.com","gcc.proxyservice.ediscovery.office365.com","gcch.proxyservice.ediscovery.office365.us","dod.proxyservice.ediscovery.office365.us"],!1)),e}();class On extends gn{async preRender(e){if(this._imageBuildInfo=this.generateThumbnailProps(e),this._props=e,!this._imageBuildInfo.thumbnailUrl)throw new Error("Thumbnail URL is not generated");this._imageBuildInfo.thumbnailUrl&&!e._skipThumbnailRequest&&W()&&this.context.processImage(this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl?[this._imageBuildInfo.fallbackUrl]:void 0)}getTranspileThumbnail(e,t,n,a=!1,i=!1){({finalWidth:e.width,finalHeight:e.height}=vn(e.width,e.height,e.originalWidth,e.originalHeight));const{originalWidth:r,originalHeight:o,width:s,height:c}=e;if(r&&o&&!e.viewportWidth&&!e.viewportHeight&&r>=(e.width||0)&&o>=(e.height||0)){let a=o,i=r,d=0,l=0;if(e.cropMode=_e._CropMode.Fill,(!$()&&void 0!==t&&void 0!==n||$()&&t&&n)&&(50!==t||50!==n)){const u=r/o,f=s&&c?s/c:u,p=Math.round(r*t/100),m=Math.round(o*n/100);u<f?(i=r,l=0,a=Math.min(o,r/f),d=Math.max(m-a/2,0)):f<u&&(a=o,d=0,i=Math.min(r,o*f),l=Math.round(Math.max(p-i/2,0))),e.cropMode=void 0,e.height=99999}e.viewportWidth=Math.min(r,Math.round(i)),e.viewportHeight=Math.min(o,Math.round(a)),e.viewportLeft=Math.min(r-e.viewportWidth,Math.round(l)),e.viewportTop=Math.min(o-e.viewportHeight,Math.round(d))}e.cacheBuster=h._SPKillSwitch.isActivated("ed25ac61-503e-471c-97ac-dfbb2c03d0e1")?h.Guid.newGuid().toString().replace("-",""):this.context.transpileCorrelationId??h.Guid.newGuid().toString().replace("-","");const d=!U()&&e.width?Math.round(e.width):e.width,l=!U()&&e.height?Math.round(e.height):e.height;let u=_e._ThumbnailUrlGenerator.getThumbnailUrl(e,be.DefaultImageHelper.getDefaultImage(new _e._SPResourcePath(e.spResource)));return u!==e.spResource||Cn.isHostApprovedForThumbnail(new _e._SPResourcePath(e.spResource))?(u=u?.replace("preferNoRedirect=true","prefer="+(E()?"NoRedirect":"noRedirect"))?.replace(RegExp("(?<=.*[\\? | \\&]w=)(\\d+)","g"),`${d}`)?.replace(RegExp("(?<=.*[\\? | \\&]width=)(\\d+)","g"),`${d}`)?.replace(RegExp("(?<=\\/0\\/c)\\d+(?=x)","g"),`${d}`)?.replace("clientType=modernWebPart","clientType=transpile"),!E()&&i&&u&&(l&&(u=u.replace(RegExp("(?<=\\/0\\/c\\d+x)\\d+(?=\\/)","g"),`${l}`)),u=u.replace("prefer=noRedirect","prefer="),e.cropMode)&&(/[?&]cm=/i.test(u)||(u=`${u}${u.includes("?")?"&":"?"}cm=${e.cropMode}`)),!a&&u&&ae()&&(u=/[?&]prefer=/i.test(u)?u.replace(/([?&]prefer=)([^&]*)/i,(e,t,n)=>`${t}${n},allowAnimation`):`${u}${u.includes("?")?"&":"?"}prefer=allowAnimation`),u?be.UrlUtility.absolutizeUrl(u,!0):u):u}enhanceThumbnailWidth(e,t,n,a=!1){const i=!E()&&a?1:1.5;return n&&t&&t/n<.4?e:Math.min(Math.round(i*e),1200,t||1200)}constructor(...e){super(...e),this.componentName=r.ComponentName.Image,this._imageBuildInfo={thumbnailUrl:""}}}const wn=250;function En(e,t,n){return{blockType:"UNORDERED_LIST_ITEM",depth:0,spans:[{text:t,styles:[]},{text:e,styles:[],entity:n?{type:"LINK",url:e}:void 0}]}}function An(e,t=[],n){return{text:e,styles:t,entity:n}}function Ln(e){return{blockType:"UNSTYLED",spans:e}}function kn(e,t){return{blocks:e.blocks.concat(t.blocks),attachments:e.attachments.concat(t.attachments),footer:e.footer?e.footer.concat(t.footer??[]):t.footer}}function Mn(e){const t=(new DOMParser).parseFromString(e,"text/html"),n=Array.from(t.getElementsByTagName("attachment"));if(n&&n.length>0)return n[0].id}const Pn=JSON.parse('{"F":"Link: ","C":"Alt text: "}');class Tn extends gn{async preRender(e){const{imageProps:t}=e;if(!t)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("imageProps are expected to be set"));if(!t.source||!t.source.url&&!t.source.sharepointIds)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("imageProps require source with url or sharepointIds"));if(t.cropWindow&&!t.originalDimensions)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("imageProps must include original dimensions when crop window is provided"))}handleCropping(e,t){const{cropWindow:n}=t;n?.type&&("focalPoint"===n.type?(e._focalX=n.focalPoint.offsetLeft,e._focalY=n.focalPoint.offsetTop):e.cropData={cropHeight:n.viewport.height,cropWidth:n.viewport.width,cropX:n.viewport.x,cropY:n.viewport.y})}constructor(...e){super(...e),this.componentName=r.ComponentName.RichImage}}const Un=JSON.parse('{"u":"Caption: ","V":"Overlay text: "}');class Fn extends gn{async preRender(e){const{text:t}=e;if(void 0===t)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Text must be defined"))}getTextElement(e){const{headerLevel:t,text:n,link:a}=e,r=t?document.createElement(`h${this.getHeaderLevel(t)}`):document.createElement("p");if(a){const t=document.createElement("a");t.setAttribute("href",O()?(0,i.escape)(be.UrlUtility.absolutizeUrl(a)):nt(a)),t.textContent=n,t.setAttribute("title",(0,i.escape)(e.altText)||(0,i.escape)(n)),t.setAttribute("aria-label",(0,i.escape)(e.altText)||(0,i.escape)(n)),r.appendChild(t)}else r.textContent=n;return r}getHeaderLevel(e){return e}constructor(e){super(e),this.componentName=r.ComponentName.TextBlock}}class Hn extends gn{async preRender(e){const{button:t}=e,{link:n}=t;if(!n)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Link is expected to be set"))}process(e){return{url:nt(e.url),title:k()?e.title:e?.title??nt(e.url)}}constructor(e){super(e),this.componentName=r.ComponentName.Button}}class Rn extends gn{async preRender(e){if(!e.thumbnailLink||!e.thumbnailLink.link)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("thumbnailLink.url is required for VideoCard component"))}constructor(...e){super(...e),this.componentName=r.ComponentName.VideoCard}}class Nn extends gn{async preRender(e){if(!e.person)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error('The "person" property is required for the PeopleCard component.'));if(!(e.person.email&&""!==e.person.email.trim()||e.person.name&&""!==e.person.name.trim()))throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("The email and name properties of the person are required for the PeopleCard component."));if(!e.CardLayout)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error('The "CardLayout" property is required for the PeopleCard component.'))}generatePersonElement(e){const t=document.createElement("p"),n=this.getPersonName(e),a=this.getPersonRole(e),i=`${n}${a?",&nbsp":""}${a}`;return t.innerHTML=i,t}async generateLinkElementAsync(e){const t={componentName:r.ComponentName.TextBlock,text:e.person.linkName??"",link:e.person.linkUrl??""},n=await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""));if(n)return(new DOMParser).parseFromString(n,"text/html").body.firstChild}async generateDescriptionElementAsync(e){const t={componentName:r.ComponentName.TextBlock,text:e.person.description??""},n=await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""));if(n)return(new DOMParser).parseFromString(n,"text/html").body.firstChild}generateLinkElement(e){const t={componentName:r.ComponentName.TextBlock,text:e.person.linkName??"",link:e.person.linkUrl??""},n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);if(n)return(new DOMParser).parseFromString(n,"text/html").body.firstChild}generateDescriptionElement(e){const t={componentName:r.ComponentName.TextBlock,text:e.person.description??""},n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);if(n)return(new DOMParser).parseFromString(n,"text/html").body.firstChild}getPersonName(e){return(0,i.escape)(e.person.name)}getPersonRole(e){return(0,i.escape)(e.person.role||"")}constructor(...e){super(...e),this.componentName=r.ComponentName.PeopleCard}}function Bn(e,t){return e&&e.length>t?`${e.substring(0,t)}`:e}class jn extends gn{async preRender(e){if(!e.people)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("List of people not provided for People Layout"));if(!e.cardLayout)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Card layout not provided for People Layout"))}generatePeopleCard(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:t},a=this.context?.getComponent(r.ComponentName.PeopleCard)?.render(n);return a.trim()}async generatePeopleCardAsync(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:t};return(await(this.context?.getComponent(r.ComponentName.PeopleCard)?.executeRender(n).catch(()=>""))).trim()}constructor(...e){super(...e),this.componentName=r.ComponentName.PeopleLayout}}class Vn extends gn{async preRender(e){const{length:t,weight:n}=e;if(void 0===t)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Length must be defined"));if(t<1||t>100)throw this.createCustomError("Invalid property value",$e.ResultTypeEnum.ExpectedFailure,new Error("Length must be a value between 1 and 100"));if(void 0===n)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Weight must be defined"));if(n<1||n>6)throw this.createCustomError("Invalid property value",$e.ResultTypeEnum.ExpectedFailure,new Error("Weight must be a value between 1 and 6"))}constructor(...e){super(...e),this.componentName=r.ComponentName.Divider}}class zn extends gn{async preRender(e){const{height:t}=e;if(void 0===t)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("height is expected to be set"));if(t<1||t>320)throw this.createCustomError("Invalid property value",$e.ResultTypeEnum.ExpectedFailure,new Error("height must be between 1 and 320"))}constructor(...e){super(...e),this.componentName=r.ComponentName.Spacer}}class Gn extends gn{async preRender(e){if(!e.thumbnailLink||!e.thumbnailLink.link)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("thumbnailLink or link is undefined"))}getFileLink(e){const{url:t}=e.thumbnailLink.link,n={componentName:r.ComponentName.TextBlock,text:this.getFileName(e),link:t},a=this.context.getComponent(r.ComponentName.TextBlock)?.render(n);return a}async getFileLinkAsync(e){const{url:t}=e.thumbnailLink.link,n={componentName:r.ComponentName.TextBlock,text:this.getFileName(e),link:t};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(n))}getFileName(e){const{fileType:t,thumbnailLink:n}=e,{title:a}=n.link;return(0,i.escape)(`${a}${t?`.${t}`:""}`)}constructor(...e){super(...e),this.componentName=r.ComponentName.FileCard}}const Kn="/_layouts/15/images/sitepagethumbnail.png",Wn=p.p+"odm_YouTube_20x20_fa84d373.png";class qn extends gn{extractYouTubeVideoIdFromLink(e){const t=new URL(e);let n=null;return"youtu.be"===t.hostname?n=t.pathname.slice(1):"www.youtube.com"!==t.hostname&&"www.youtube-nocookie.com"!==t.hostname||("/watch"===t.pathname?n=new URLSearchParams(t.search).get("v"):t.pathname.startsWith("/embed/")&&(n=t.pathname.slice(7))),n||""}async preRender(e){if(!e.thumbnailLink?.link?.url)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Thumbnail link or URL is missing"));if(!this.extractYouTubeVideoIdFromLink(e.thumbnailLink.link.url))throw this.createCustomError("Unexpected error during component execution",$e.ResultTypeEnum.ExpectedFailure,new Error("The provided link does not contain a valid youtube video ID"))}getComponentProps(e,t=!1){const{thumbnailLink:n,caption:a}=e,{title:i,url:o}=n.link,s=this.extractYouTubeVideoIdFromLink(o),c=`https://i.ytimg.com/vi/${s}/hqdefault.jpg`,d=t&&this._convertToWatchLink(s)||o;return{componentName:r.ComponentName.FileCard,thumbnailLink:{link:{title:i,url:d,description:a},thumbnail:{source:{url:c}}},iconProps:{iconUrl:Wn,iconText:he.Pb}}}_convertToWatchLink(e){return e?`https://www.youtube.com/watch?v=${e}`:e}constructor(...e){super(...e),this.componentName=r.ComponentName.YoutubeCard}}class Qn extends gn{async prerender(e){const{thumbnailLink:t,cardSize:n}=e;if(!t?.link?.url)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("thumbnailLink with link.url is required"));if(!n)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("CardSize is expected to be set"))}getLinkElement(e,t=!0){const{thumbnailLink:n}=e,{url:a,description:i}=n.link,o={componentName:r.ComponentName.TextBlock,text:this.getTitleText(e),link:a},s={componentName:r.ComponentName.TextBlock,text:i??""},c=this.context.getComponent(r.ComponentName.TextBlock)?.render(s),d=this.context.getComponent(r.ComponentName.TextBlock)?.render(o);return this.getLinkElementHelper(d,c,t,i)}async getLinkElementAsync(e,t=!0){const{thumbnailLink:n}=e,{url:a,description:i}=n.link,o={componentName:r.ComponentName.TextBlock,text:this.getTitleText(e),link:a},s={componentName:r.ComponentName.TextBlock,text:i??""},c=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(s).catch(()=>"")),d=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(o).catch(()=>""));return this.getLinkElementHelper(d,c,t,i)}getLinkElementHelper(e,t,n,a){const i=document.createElement("div");if(e){const t=document.createElement("div");t.innerHTML=e,i.appendChild(t)}if(n&&a&&t){const e=this.getDescriptionElement(t);i.appendChild(e)}return i}getTitleText(e){return e.thumbnailLink.link.title||""}getDescriptionElement(e){const t=document.createElement("div");return t.innerHTML=e,t}hasThumbnail(e){return Boolean(e&&(e.source.url||e.source.sharepointIds))}constructor(...e){super(...e),this.componentName=r.ComponentName.LinkCard}}const Yn=20,Jn=16/9;class Xn extends gn{async preRender(e){const{thumbnailLinks:t,cardSize:n}=e;if(!t||0===t.length)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("thumbnailLinks are expected to be set"));if(!n)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("cardSize is expected to be set"))}getTitleContent(e,t,n,a){if(oe()&&e)return this.getTitleHTMLContent(e);if(!t)return"";const i={componentName:r.ComponentName.TextBlock,text:t,headerLevel:n,styles:a};return this.context.getComponent(r.ComponentName.TextBlock)?.render(i)}getTitleHTMLContent(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return this.context.getComponent(r.ComponentName.RichText)?.render(t)}async getTitleContentAsync(e,t,n,a){if(oe()&&e)return await this.getTitleHTMLContentAsync(e);if(!t)return"";const i={componentName:r.ComponentName.TextBlock,text:t,headerLevel:n,styles:a};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(i).catch(()=>""))}async getTitleHTMLContentAsync(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return await(this.context.getComponent(r.ComponentName.RichText)?.executeRender(t).catch(()=>""))}getLinkListElement(e){const{thumbnailLinks:t,cardSize:n}=e,a=document.createElement("ul");return t.forEach(e=>{const t=this.getLinkContent(e,n);t&&a.appendChild(t)}),a}async getLinkListElementAsync(e){const{thumbnailLinks:t,cardSize:n}=e,a=document.createElement("ul");for(const e of t){const t=await this.getLinkContentAsync(e,n);t&&a.appendChild(t)}return a}getLinkContent(e,t){const n={componentName:r.ComponentName.LinkCard,thumbnailLink:e,cardSize:t},a=this.context.getComponent(r.ComponentName.LinkCard)?.render(n);if(a){const e=document.createElement("li");return e.innerHTML=a,e}}async getLinkContentAsync(e,t){const n={componentName:r.ComponentName.LinkCard,thumbnailLink:e,cardSize:t},a=await(this.context.getComponent(r.ComponentName.LinkCard)?.executeRender(n).catch(()=>""));if(a){const e=document.createElement("li");return e.innerHTML=a,e}}constructor(...e){super(...e),this.componentName=r.ComponentName.LinkLayout}}class Zn extends gn{async preRender(e){if(!e.latitude||!e.longitude)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Latitude and Longitude are required for MapCard component"));if(this.checkLocations(e.latitude,e.longitude),!e.zoomLevel)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("ZoomLevel is required for MapCard"));if(!e.mapType)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("MapType is required for MapCard"));if(e.mapType&&!["road","aerial","birdseyeV2","streetside"].includes(e.mapType))throw this.createCustomError("Unexpected error during component execution",$e.ResultTypeEnum.ExpectedFailure,new Error("MapType must be one of the following: road, aerial, birdseyeV2, streetside"));if(e.pushPin&&(!e.pushPin.latitude||!e.pushPin.longitude))throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("PushPin latitude and longitude are required for MapCard"));e.pushPin&&this.checkLocations(e.pushPin.latitude,e.pushPin.longitude)}getTitleContent(e){if(!e)return"";const t={componentName:r.ComponentName.TextBlock,text:e,styles:{fontWeight:"bold"}},n=this.context.getComponent(r.ComponentName.TextBlock)?.render(t);return n}getAddressContent(e){if(!e)return"";const t={componentName:r.ComponentName.TextBlock,text:e},n=this.context.getComponent(r.ComponentName.TextBlock)?.render(t);return n}getMapImage(e,t,n){const a={componentName:r.ComponentName.Image,imageUrl:this.getMapUrl(e,t,n),width:t,height:n,_fileType:"png"},i=this.context.getComponent(r.ComponentName.Image)?.render(a);return i}async getTitleContentAsync(e){if(!e)return"";const t={componentName:r.ComponentName.TextBlock,text:e,styles:{fontWeight:"bold"}};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e).catch(()=>{}))??""}async getAddressContentAsync(e){if(!e)return"";const t={componentName:r.ComponentName.TextBlock,text:e};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e).catch(()=>{}))??""}async getMapImageAsync(e,t,n){const a={componentName:r.ComponentName.Image,imageUrl:this.getMapUrl(e,t,n),width:t,height:n,_fileType:"png"};return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(a).then(e=>e).catch(()=>{}))??""}getMapUrl(e,t,n){const{latitude:a,longitude:i,zoomLevel:r,pushPin:o,mapType:s}=e;return this.checkLocations(a,i),o&&this.checkLocations(o.latitude,o.longitude),`https://dev.virtualearth.net/REST/v1/Imagery/Map/${this._getMapType(s)}/${a},${i}/${r}?${o?`pushpin=${o?.latitude},${o?.longitude};56;`:""}&mapSize=${t},${n}&key=AobmrKIjQInHa8zf5IjtCu3zVgIZFewRhY9M8NUzpYfvMdO2RKDO2eKI6uRFrP6b`}checkLocations(e,t){if(e<-90||e>90)throw new Error("Latitude should be between -90 and 90");if(t<-180||t>180)throw new Error("Longitude should be between -180 and 180")}_getMapType(e){switch(e){case"birdseyeV2":return"aerial";case"streetside":return"road";default:return e}}constructor(...e){super(...e),this.componentName=r.ComponentName.MapCard}}const $n=JSON.parse('{"n":"See all {0} Images"}');class ea extends gn{async preRender(e){if(!e.images||0===e.images.length)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("ImageGalleryComponent requires at least one image."));if(!this._getPreviewImage(e.images))throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("ImageGalleryComponent requires at least one image to have a source URL."));if(!e.layout)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("ImageGalleryComponent requires a layout property."))}getImageGalleryComponent(e,t){const{showMoreLink:n,images:a}=e;if(!a.length)return"";const i=this._getPreviewImage(a);if(!i)return"";const o={componentName:r.ComponentName.Image,imageUrl:i.source.url??"",altText:i.alternateText,width:t,cropMode:"fill",_sharepointIds:i.source.sharepointIds},s=this.context.getComponent(r.ComponentName.Image)?.render(o);if(s){let e;if(n){const t={componentName:r.ComponentName.Button,button:{link:{url:nt(n),title:$e.StringHelper.format($n.n,a.length)}}};e=this.context.getComponent(r.ComponentName.Button)?.render(t)}return this._constructImageGalleryHtml(s,e)}return""}async getImageGalleryComponentAsync(e,t){const{showMoreLink:n,images:a}=e,i=this._getPreviewImage(a);if(i){const e={componentName:r.ComponentName.Image,imageUrl:i.source.url??"",altText:i.alternateText,width:t,cropMode:"fill",_sharepointIds:i.source.sharepointIds},o=await this.context.getComponent(r.ComponentName.Image)?.executeRender(e).catch(()=>"");if(!o||0===o.length)return"";let s;if(n){const e={componentName:r.ComponentName.Button,button:{link:{url:nt(n),title:$e.StringHelper.format($n.n,a.length)}}};s=await(this.context.getComponent(r.ComponentName.Button)?.executeRender(e))}return this._constructImageGalleryHtml(o,s)}return""}_constructImageGalleryHtml(e,t){const n=document.createElement("div"),a=document.createElement("div");if(a.innerHTML=e,n.appendChild(a),t){const e=document.createElement("div");e.innerHTML=t,n.appendChild(e)}return n.outerHTML}_getPreviewImage(e){return e&&e[0]?.source?.url?e[0]:e?.find(e=>""!==e.source.url)}constructor(...e){super(...e),this.componentName=r.ComponentName.ImageGallery}}const ta=213,na=JSON.parse('{"o":"People reporting to {0} {1}"}');class aa extends gn{async preRender(e){if(!e.personInFocus)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("personInFocus is required for rendering the organization chart."))}async handleListRenderAsync(e){const{personInFocus:t,directsReports:n,managers:a}=e;if(!t)return"";const i=await this._createPersonListItemAsync(t);if(!i)return"";const r=a&&a.length>0?await this._buildManagerHierarchyAsync(a):void 0,o=n&&n.length>0?await this._buildDirectReportsListAsync(n,i):void 0;return this._constructChartHtml(i,r,o)}handleListRender(e){const{personInFocus:t,directsReports:n,managers:a}=e;if(!t)return"";const i=this._createPersonListItem(t);if(!i)return"";const r=a&&a.length>0?this._buildManagerHierarchy(a):void 0,o=n&&n.length>0?this._buildDirectReportsList(n,i):void 0;return this._constructChartHtml(i,r,o)}handleReportingPeopleHeading(){return document.createElement("h3")}_constructChartHtml(e,t,n){const a=document.createElement("div");if(a.classList.add("org-chart-wrapper"),a.style.marginBottom="15px",a.style.marginTop="15px",e.classList.add("org-chart-person-in-focus"),t)t.appendChild(e),a.appendChild(t);else{const t=document.createElement("ul");t.appendChild(e),a.appendChild(t)}if(n){const t=n.children;for(let n=0;n<t.length;n++)e.appendChild(t[n]);e.appendChild(n)}return a.outerHTML}_buildDirectReportsList(e,t){const n=document.createElement("ul"),a=this.handleReportingPeopleHeading();a.textContent=$e.StringHelper.format(na.o,t.children[0]?.textContent,`(${e.length})`),n.classList.add("org-chart-direct-report-ul"),e.forEach(e=>{const t=this._createPersonListItem(e);t&&(t.classList.add("org-chart-direct-report-li"),n.append(t))});const i=document.createElement("div");return i.appendChild(a),i.appendChild(n),i}async _buildDirectReportsListAsync(e,t){const n=document.createElement("ul"),a=this.handleReportingPeopleHeading();a.textContent=$e.StringHelper.format(na.o,t.children[0]?.textContent,`(${e.length})`),n.classList.add("org-chart-direct-report-ul");for(const t of e){const e=await this._createPersonListItemAsync(t);e&&(e.classList.add("org-chart-direct-report-li"),n.append(e))}const i=document.createElement("div");return i.appendChild(a),i.appendChild(n),i}_buildManagerHierarchy(e){const t=document.createElement("ul");return e.forEach((e,n)=>{const a=this._createPersonListItem(e);a&&(a.classList.add("org-chart-manager"),t.append(a))}),t}async _buildManagerHierarchyAsync(e){const t=document.createElement("ul");for(const n of e){const e=await this._createPersonListItemAsync(n);e&&(e.classList.add("org-chart-manager"),t.append(e))}return t}_createPersonListItem(e){const t={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.SmallCard},n=this.context.getComponent(r.ComponentName.PeopleCard)?.render(t);if(n){const e=(new DOMParser).parseFromString(n,"text/html").body.firstChild||void 0,t=this._convertParagraphToListItem(e);return t.classList.add("org-chart-person-element"),t}}async _createPersonListItemAsync(e){const t={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.SmallCard},n=await(this.context.getComponent(r.ComponentName.PeopleCard)?.executeRender(t).catch(()=>""));if(n){const e=(new DOMParser).parseFromString(n,"text/html").body.firstChild||void 0,t=this._convertParagraphToListItem(e);return t.classList.add("org-chart-person-element"),t}}_convertParagraphToListItem(e){const t=document.createElement("li");return t.innerHTML=e.innerHTML||"",e.replaceWith(t),t}constructor(...e){super(...e),this.componentName=r.ComponentName.OrganizationChart}}const ia=JSON.parse('{"h":"Button"}');class ra extends gn{async preRender(e){if(!e.button||!e.button.link.url)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("CallToActionComponent requires a button with a link URL."))}_shouldSkipRendering(e,t){const n=!e||""===e,a=!t||""===t.link.url&&(!t.link.title||""===t.link.title);return n&&a}getCallToActionElement(e,t,n){const{description:a,button:i,image:o,descriptionHTML:s}=e;if(this._shouldSkipRendering(a,i))return"";const c=oe()&&!!s,d=c?{componentName:r.ComponentName.RichText,input:s,format:"Html"}:{componentName:r.ComponentName.TextBlock,text:a??""},l={...i,link:{...i.link}};""===l.link.url||l.link.title&&""!==l.link.title||(l.link.title=ia.h);const u={componentName:r.ComponentName.Button,button:l},f=this.context.getComponent(c?r.ComponentName.RichText:r.ComponentName.TextBlock)?.render(d),p=this.context.getComponent(r.ComponentName.Button)?.render(u);let m;if(o){const e={componentName:r.ComponentName.Image,imageUrl:o.source.url??"",altText:o.alternateText,width:t,height:n??void 0,cropMode:"fit",_focalX:"focalPoint"===o?.cropWindow?.type?o?.cropWindow.focalPoint.offsetTop:void 0,_focalY:"focalPoint"===o?.cropWindow?.type?o?.cropWindow.focalPoint.offsetLeft:void 0};m=this.context.getComponent(r.ComponentName.Image)?.render(e)}return this._constructCallToActionHtml(f,p,m)}async getCallToActionElementAsync(e,t,n){const{description:a,button:i,image:o,descriptionHTML:s}=e;if(this._shouldSkipRendering(a,i))return"";const c=oe()&&!!s,d=c?{componentName:r.ComponentName.RichText,input:s,format:"Html"}:{componentName:r.ComponentName.TextBlock,text:a??""},l={...i,link:{...i.link}};""===l.link.url||l.link.title&&""!==l.link.title||(l.link.title=ia.h);const u={componentName:r.ComponentName.Button,button:l},f=[];let p;f.push(this.context.getComponent(c?r.ComponentName.RichText:r.ComponentName.TextBlock)?.executeRender(d)),f.push(this.context.getComponent(r.ComponentName.Button)?.executeRender(u)),o&&(p={componentName:r.ComponentName.Image,imageUrl:o.source.url??"",altText:o.alternateText,width:t,height:n??void 0,cropMode:"fit",_focalX:"focalPoint"===o?.cropWindow?.type?o?.cropWindow.focalPoint.offsetTop:void 0,_focalY:"focalPoint"===o?.cropWindow?.type?o?.cropWindow.focalPoint.offsetLeft:void 0},f.push(this.context.getComponent(r.ComponentName.Image)?.executeRender(p)));const[m,_,h]=await Promise.all(f);return this._constructCallToActionHtml(m,_,h)}_constructCallToActionHtml(e,t,n){const a=document.createElement("div"),i=document.createElement("div");if(n){const e=document.createElement("div");e.innerHTML=n,i.appendChild(e)}if(e){const t=document.createElement("div");t.innerHTML=e,i.appendChild(t)}if(t){const e=document.createElement("div");e.innerHTML=t,i.appendChild(e)}return a.appendChild(i),a.innerHTML}constructor(...e){super(...e),this.componentName=r.ComponentName.CallToAction}}class oa extends gn{async preRender(e){const{text:t,backgroundColor:n}=e;if(void 0===t)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Text must be defined"));if(void 0===n)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Background color must be defined"));if("accent"!==n&&"themePrimary"!==n&&"themeSecondary"!==n)throw this.createCustomError("Invalid property value",$e.ResultTypeEnum.ExpectedFailure,new Error('Background color must be either "accent" or "themePrimary" or "themeSecondary"'))}constructor(...e){super(...e),this.componentName=r.ComponentName.TextPill}}class sa extends gn{async preRender(e){const{thumbnail:t,authors:n}=e;t&&(t.source&&t.source.sharepointIds&&t.source.sharepointIds.uniqueId||this.context.addLogging?.({error:new Error("Thumbnail source or SharePoint IDs are missing"),errorMessage:"Expected property is missing",componentName:r.ComponentName.Banner,errorType:$e.ResultTypeEnum.ExpectedFailure})),n&&n.length>0&&(n[0].name&&n[0].email||this.context.addLogging?.({error:new Error("Author requires name and email"),errorMessage:"Expected property is missing",componentName:r.ComponentName.Banner,errorType:$e.ResultTypeEnum.ExpectedFailure}))}getImageContent(e,t,n){const{thumbnail:a}=e;if(!a?.source)return"";const i=this.createImageComponent(a,t,n);return this.context.getComponent(r.ComponentName.Image)?.render(i)}async getImageContentAsync(e,t,n){const{thumbnail:a}=e;if(!a?.source)return"";const i=this.createImageComponent(a,t,n);return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(i).catch(()=>""))}createImageComponent(e,t,n){const a={componentName:r.ComponentName.Image,originalWidth:e.originalDimensions?.width,originalHeight:e.originalDimensions?.height,imageUrl:e.source.url??"",width:t,height:n,cropMode:"fill"};return"focalPoint"===e.cropWindow?.type&&(a._focalX=e.cropWindow.focalPoint.offsetLeft,a._focalY=e.cropWindow.focalPoint.offsetTop),e.source.sharepointIds&&e.source.sharepointIds.siteId&&e.source.sharepointIds.webId&&e.source.sharepointIds.uniqueId&&(h._SPKillSwitch.isActivated("040c9b96-ecf8-484a-abf4-d5813670b959")?a._sharepointIds={siteId:e.source.sharepointIds.siteId,webId:e.source.sharepointIds.webId,listId:e.source.sharepointIds?.listId,uniqueId:e.source.sharepointIds.uniqueId}:a._sharepointIds=e.source.sharepointIds),a}getTopicHeaderContent(e){const{header:t,showHeader:n,textAlignment:a}=e;if(!n||!t)return"";const i=this.getTextPillContent(t,a);return this.context.getComponent(r.ComponentName.TextPill)?.render(i)}async getTopicHeaderContentAsync(e){const{header:t,showHeader:n,textAlignment:a}=e;if(!n||!t)return"";const i=this.getTextPillContent(t,a);return await(this.context.getComponent(r.ComponentName.TextPill)?.executeRender(i).catch(()=>""))}getTextPillContent(e,t){const n=t??"Left";return{componentName:r.ComponentName.TextPill,text:e.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:{fontSize:"small",fontWeight:"bold"},align:n}}getTitleContent(e,t,n){if(oe()&&e)return this.getTitleHTMLContent(e);if(!t)return"";const a={componentName:r.ComponentName.TextBlock,text:t,headerLevel:1,styles:n};return this.context.getComponent(r.ComponentName.TextBlock)?.render(a)}getTitleHTMLContent(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return this.context.getComponent(r.ComponentName.RichText)?.render(t)}async getTitleContentAsync(e,t,n){if(oe()&&e)return await this.getTitleHTMLContentAsync(e);if(!t)return"";const a={componentName:r.ComponentName.TextBlock,text:t,headerLevel:1,styles:n};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""))}async getTitleHTMLContentAsync(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return await(this.context.getComponent(r.ComponentName.RichText)?.executeRender(t).catch(()=>""))}getAuthorContent(e){if(!e||0===e.length)return"";const t={componentName:r.ComponentName.PeopleCard,person:e[0],CardLayout:r.CardLayout.ExtraSmallCard};return this.context.getComponent(r.ComponentName.PeopleCard)?.render(t)}async getAuthorContentAsync(e){if(!e||0===e.length)return"";const t={componentName:r.ComponentName.PeopleCard,person:e[0],CardLayout:r.CardLayout.ExtraSmallCard};return await(this.context.getComponent(r.ComponentName.PeopleCard)?.executeRender(t).catch(()=>""))}constructor(...e){super(...e),this.componentName=r.ComponentName.Banner}}const ca="0px 20px 15px";class da extends gn{async preRender(e){}constructor(...e){super(...e),this.componentName=r.ComponentName.TitleRegion}}const la=JSON.parse('{"S":"{0}: {1}"}');class ua extends gn{async preRender(e){if(!e?.htmlContent||""===e.htmlContent.trim())throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("htmlContent is expected to be set"));if(this._processedHtmlContent=e.htmlContent,e.ck4InlineImages&&e.ck4InlineImages.size>0&&(this._processedHtmlContent=await this._processCK4ImagesAsync(this._processedHtmlContent,e.ck4InlineImages)),this._processedHtmlContent=this._fixLinks(await this.processImagesAsync(this._processedHtmlContent,e?.inlineImages))??"",!this._processedHtmlContent)throw this.createCustomError("Component returned undefined or empty",$e.ResultTypeEnum.Failure,new Error("empty content after processing images and links"))}insertInlineImages(e,t){const n=document.createElement(this._containerType);t.forEach(e=>{const t=document.createElement(this._containerType),a=this.context.getComponent(e.componentName)?.render(e);a&&(t.innerHTML=a,n.appendChild(t))}),n.innerHTML&&e.replaceWith(n)}async insertInlineImagesAsync(e,t){const n=document.createElement(this._containerType);for(const e of t){const t=document.createElement(this._containerType),a=await(this.context.getComponent(e.componentName)?.executeRender(e).then(e=>e));a&&(t.innerHTML=a,n.appendChild(t))}n.innerHTML&&e.replaceWith(n)}_processCK4Images(e,t){const n=(new DOMParser).parseFromString(e,"text/html");return n.querySelectorAll('div.webPartInRte[data-widget="inlineimage"]').forEach(e=>{const n=e.getAttribute("data-instance-id");if(!n||!t.has(n))return;const a=t.get(n);a&&this.insertInlineImages(e,a)}),n.body.innerHTML}async _processCK4ImagesAsync(e,t){const n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelectorAll('div.webPartInRte[data-widget="inlineimage"]');return await Promise.all(Array.from(a).map(async e=>{const n=e.getAttribute("data-instance-id");if(!n||!t.has(n))return;const a=t.get(n);a?await this.insertInlineImagesAsync(e,a):this.context.addLogging?.({error:new Error("No image render props found for CK4 RTE instance"),errorMessage:"Webpart Unknown error",componentName:this.componentName,errorType:$e.ResultTypeEnum.Failure})})),n.body.innerHTML}_fixLinks(e){if(!e||-1===e.indexOf("<a "))return e;const t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("a");let a=!1;return n.forEach(e=>{const t=e.getAttribute("href");t?.startsWith("/")&&(e.setAttribute("href",be.UrlUtility.absolutizeUrl(t)),a=!0);const n=e.getAttribute("class");e.setAttribute("class",n?`${n} OWAAutoLink`:o),e.getAttribute("id")||e.setAttribute("id",we()),a=!0}),a?t.body.innerHTML:e}extractImageProp(e,t){if(!t)return;const n=e.getAttribute("data-imageid");if(!n)return;const a=t.get(n);if(!a)return;const i=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe();let r=(a?.alignment||"center").toLowerCase();if(r=r.indexOf("right")>=0?"right":r.indexOf("left")>=0?"left":"center",a.link){const e=be.UrlUtility.absolutizeUrl(a.link);a.link=e}const{naturalHeight:o,naturalWidth:s,height:c,width:d}=a;let l=a?.colWidth;const u=o&&s?o/s:c/d;return ne(this.context.endpointDetails)&&l&&l>i&&(l=i),{...a,width:d??i,colWidth:l??i,aspectRatio:u,alignment:r,tableWidth:i}}constructor(...e){super(...e),this.componentName=r.ComponentName.RTEWebpart,this._processedHtmlContent="",this._imageClass="div.imagePlugin[data-imageurl]",this._imageTag="transpileimage"}}const fa=JSON.parse('{"D":"image"}'),pa=/<ul>\s*?.*?<\/ul>|<ol>\s*?.*?<\/ol>/g,ma=/<strong>\s*?.*?<\/strong>/g,_a=/<i>\s*?.*?<\/i>/g,ha=/<i><strong>\s*?.*?<\/strong><\/i>/g,ba=/<\/?span[^>]*>/g,ga=/<p\s*?(.*?)>(\s*?.*?)<\/p>/g,va=/<u\s*?(.*?)>(\s*?.*?)<\/u>/g,ya=/<s\s*?(.*?)>(\s*?.*?)<\/s>/g,Sa=/<\/?sub[^>]*>/g,Da=/<\/?sup[^>]*>/g;class Ia extends gn{constructor(...e){super(...e),this.componentName=r.ComponentName.Screenshot}}var xa,Ca;!function(e){e[e.Email=1]="Email",e[e.Teams=2]="Teams",e[e.VivaEngage=3]="VivaEngage",e[e.Web=4]="Web"}(xa||(xa={})),function(e){e.VivaAmplify="VivaAmplify",e.WebTranspile="WebTranspile",e.PageToEmail="PageToEmail",e.ShareByEmail="ShareByEmail",e.AmplifyFromAnywhere="AmplifyFromAnywhere"}(Ca||(Ca={}));class Oa extends gn{async preRender(e){if(!e.cardSize)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("cardSize is required for info card component"))}isImageType(e){return Boolean(e&&"File"!==e.type&&"Video"!==e.type)}getThumbnail(e){if(e)return e&&"File"!==e.type&&"Video"!==e.type?e:e?.thumbnail}getSimpleInfoCard(t,n){const{previewArea:a,topic:i,title:o,description:s,callToActions:c}=t,d=document.createElement("div");let l=!1;if(a){const{previewFile:t}=a,i=this.getThumbnail(t);if(i){const e={componentName:r.ComponentName.Image,imageUrl:i.source.url||"",_sharepointIds:i.source.sharepointIds,width:n,originalWidth:i.originalDimensions?.width,originalHeight:i.originalDimensions?.height},t=this.context.getComponent(r.ComponentName.Image)?.render(e);t&&Se(t,d)}if("Video"===t?.type){const n={componentName:r.ComponentName.Video,video:t},a=this.context.getComponent(r.ComponentName.Video)?.render(n);if(a){if(this.distribution===e.Teams){const e=document.createElement("p");e.innerHTML=a,d.appendChild(e)}else Se(a,d);l=!0}}else if(!this.isImageType(t)&&t?.source.url){const e=this.getTextBlock({text:t.name||t.source.url,link:t.source.url,altText:t.name});e&&(Se(e,d),l=!0)}}if(i?.text){const e=this.getTextBlock(i);e&&(Se(e,d),l=!0)}if(o?.text){const e=this.getTextBlock(o,{fontSize:"x-large",fontWeight:"bold"},1);e&&(Se(e,d),l=!0)}if(s?.text){const e=this.getTextBlock(s);e&&(Se(e,d),l=!0)}let u=!1;return c?.forEach(e=>{if(!e.link.url)return;const t={componentName:r.ComponentName.Button,button:{link:{title:e.link.title??e.link.url,url:nt(e.link.url)},type:e.type}},n=this.context.getComponent(r.ComponentName.Button)?.render(t);n&&(!u&&l&&(Se("<br>",d),u=!0),Se(n,d))}),d}async getSimpleInfoCardAsync(t,n){const{previewArea:a,topic:i,title:o,description:s,callToActions:c}=t,d=document.createElement("div");let l=!1;if(a){const{previewFile:t}=a,i=this.getThumbnail(t);if(i){const e={componentName:r.ComponentName.Image,imageUrl:i.source.url||"",_sharepointIds:i.source.sharepointIds,width:n,originalWidth:i.originalDimensions?.width,originalHeight:i.originalDimensions?.height},t=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(e).catch(()=>""));t&&Se(t,d)}if("Video"===t?.type){const n={componentName:r.ComponentName.Video,video:t},a=await(this.context.getComponent(r.ComponentName.Video)?.executeRender(n).catch(()=>""));if(a){if(this.distribution===e.Teams){const e=document.createElement("p");e.innerHTML=a,d.appendChild(e)}else Se(a,d);l=!0}}else if(!this.isImageType(t)&&t?.source.url){const e=await this.getTextBlockAsync({text:t.name||t.source.url,link:t.source.url,altText:t.name});e&&(Se(e,d),l=!0)}}if(i?.text){const e=await this.getTextBlockAsync(i);e&&(Se(e,d),l=!0)}if(o?.text){const e=await this.getTextBlockAsync(o,{fontSize:"x-large",fontWeight:"bold"},1);e&&(Se(e,d),l=!0)}if(s?.text){const e=await this.getTextBlockAsync(s);e&&(Se(e,d),l=!0)}let u=!1;if(c){const e=c.map(async e=>{if(!e.link.url)return;const t={componentName:r.ComponentName.Button,button:{link:{title:e.link.title??e.link.url,url:nt(e.link.url)},type:e.type}};return await(this.context.getComponent(r.ComponentName.Button)?.executeRender(t).catch(()=>""))||void 0});(await Promise.all(e)).forEach(e=>{e&&(!u&&l&&(Se("<br>",d),u=!0),Se(e,d))})}return d}getTextBlock(e,t,n){const a={componentName:r.ComponentName.TextBlock,text:e.text,link:e.link,altText:e.altText,headerLevel:n,styles:{...t,...e.styles}};return this.context.getComponent(r.ComponentName.TextBlock)?.render(a)}async getTextBlockAsync(e,t,n){const a={componentName:r.ComponentName.TextBlock,text:e.text,link:e.link,altText:e.altText,headerLevel:n,styles:{...t,...e.styles}};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""))}constructor(...e){super(...e),this.componentName=r.ComponentName.InfoCard}}class wa extends gn{_hasVideo(e){return Boolean(e?.source?.url)}constructor(...e){super(...e),this.componentName=r.ComponentName.Video}}function Ea(e,t){if(null==e)return t;const n=Number(e);return isNaN(n)||!isFinite(n)?t:n}function Aa(e,t){if(!(e&&e instanceof Map))return;const n=new Map;return e.forEach((e,a)=>{const i=function(e,t){if(!e||"object"!=typeof e)return;if(!e.source||"object"!=typeof e.source)return;const n=e.source;let a,i;if(n.url&&"string"==typeof n.url){const e=n.url.trim();tt(nt(e))&&(a=e)}else n.sharepointIds&&(i=n.sharepointIds);if(!a&&!i)return;let r=Ea(e.naturalHeight,0),o=Ea(e.naturalWidth,0),s=Ea(e.width,0),c=Ea(e.height,0);(s<0||s>1e4||c<0||c>1e4)&&(s=0,c=0),(o<0||o>5e4||r<0||r>5e4)&&(o=0,r=0);const d={source:{...a&&{url:a}},naturalHeight:r,naturalWidth:o,width:s,height:c,isImageShape:!1,colWidth:Oe(!1,t),widthPercent:100};if(void 0!==i&&(d.source.sharepointIds=i),void 0!==e.link){const t=String(e.link).trim();t&&tt(t)&&(d.link=t)}if(void 0!==e.alignment){const t=String(e.alignment).toLowerCase().trim();["left","center","right"].includes(t)&&(d.alignment=t)}else d.alignment="left";return e.caption&&(d.caption=String(e.caption).trim()),e.altText&&(d.altText=String(e.altText).trim()),d}(e,t);i&&n.set(a,i)}),n.size>0?n:void 0}const La="transpileimage",ka=["color","font-size","font-weight","background-color","width","margin","margin-top","margin-right","margin-bottom","margin-left","padding","padding-top","padding-right","padding-bottom","padding-left","text-align","list-style-type","border","border-left","border-right","border-top","border-bottom"],Ma=["a","p","strong","italic","h1","h2","h3","h4","h5","h6","em","i","b","span","u","sub","sup","pre","mark","small","strike","s","blockquote","code","li","ol","ul","table","th","td","tr","thead","colgroup","col","br","figure"];class Pa extends gn{async renderAsync(e){return await this.processInputAsync(e)}async preRender(e){const{input:t}=e;if(!t||""===t.trim())throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("Input content cannot be empty for RichText component."))}supportedTags(){return Ma}supportedStyles(){return ka}sanitizeContent(e){ot().addHook("beforeSanitizeAttributes",(e,t,n)=>{if(1===e.nodeType&&null!==e?.getAttribute("style")){const t=e?.getAttribute("style"),n=t?.split(";").map(e=>e.trim()).filter(e=>{const[t]=e.split(":").map(e=>e.trim());return this.supportedStyles().includes(t)}).join("; ");n&&e.setAttribute("style",n)}}),ot().addHook("beforeSanitizeElements",(e,t,n)=>{"FIGURE"===e?.tagName&&(e.classList.contains("table")||e.replaceWith(e.textContent??"")),K()||(e?.tagName===La.toUpperCase()&&(e.getAttribute("data-imageId")||e.remove(),Array.from(e.attributes).forEach(t=>{"data-imageid"!==t.name&&e.removeAttribute(t.name)})),"DIV"===e?.tagName&&(e.classList.contains("imagePlugin")&&e.hasAttribute("data-imageurl")?(Array.from(e.attributes).forEach(t=>{"data-imageurl"!==t.name&&e.removeAttribute(t.name)}),e.classList.contains("imagePlugin")||e.classList.add("imagePlugin")):Array.from(e.attributes).forEach(t=>{e.removeAttribute(t.name)})))});const t=this.supportedTags();K()||(t.push(La),t.push("div"));const n=ot().sanitize(e,{ALLOWED_TAGS:t,KEEP_CONTENT:!0,ADD_ATTR:["style"]});return ot().removeAllHooks(),n}processInput(e){const{input:t,inlineImages:n}=e,a={componentName:r.ComponentName.RTEWebpart,htmlContent:this.sanitizeContent(t),parentClass:["rte-webpart","rte--ck5","rte--read-ck5","rte--paragraphSpacing"].join(" "),childClass:"ck-content"};if(!K()){const e=Aa(n,this.context.endpointDetails);e&&(a.inlineImages=e)}return this.context.getComponent(r.ComponentName.RTEWebpart)?.render(a)??""}async processInputAsync(e){const{input:t,inlineImages:n}=e,a={componentName:r.ComponentName.RTEWebpart,htmlContent:this.sanitizeContent(t),parentClass:["rte-webpart","rte--ck5","rte--read-ck5","rte--paragraphSpacing"].join(" "),childClass:"ck-content"};if(!K()){const e=Aa(n,this.context.endpointDetails);e&&(a.inlineImages=e)}return await(this.context.getComponent(r.ComponentName.RTEWebpart)?.executeRender(a).then(e=>e??""))??""}constructor(...e){super(...e),this.componentName=r.ComponentName.RichText}}const Ta=["font-family"],Ua=new hn([class extends Fn{render(e){return this._renderHelper(e)}async renderAsync(e){return this._renderHelper(e)}_renderHelper(e){const{styles:t,headerLevel:n,text:a,link:r}=e;let o=document.createElement("span");n&&(o=document.createElement(`h${this.getHeaderLevel(n)}`));let s=null;const c=t?this.context.processStyles(t):"";if(c&&o.setAttribute("style",c),o.style.margin="0",o.style.setProperty("mso-hyphenate","none"),o.style.wordWrap="break-word",o.textContent=a,r){if(s=document.createElement("a"),s.setAttribute("href",O()?(0,i.escape)(r):nt(r)),re()&&!h._SPKillSwitch.isActivated("b42a5f18-2c2c-4976-be66-4974a3cf8a31")?s.style.setProperty("text-decoration","none"):s.style.setProperty("text-decoration","none","important"),s.style.cursor="pointer",s.id=we(),!e.styles?.fontColor){const e=this.context.localSectionTheme;s.style.setProperty("color",e.semanticColors.link,"important")}return e.altText?(s.setAttribute("title",e.altText),s.setAttribute("aria-label",e.altText)):(s.setAttribute("title",a),s.setAttribute("aria-label",a)),s.appendChild(o),s.outerHTML}return o.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends Hn{render(e){const{button:t}=e,{link:n,align:a,hasBorder:i,hasBorderRadius:o,hasBoxShadow:s,backgroundColor:c,textStyles:d,borderStyles:l,height:u,paddingTopBottom:f,paddingLeftRight:p}=t,{url:m,title:_}=this.process(n),h=this.context.localSectionTheme,b=this.createTextBlockComponent(_??m,m,c,h,d,u),g=this.context.getComponent(r.ComponentName.TextBlock)?.render(b);if(!g)throw this.createCustomError("Component returned undefined or empty",$e.ResultTypeEnum.ExpectedFailure,new Error("Button content is expected to be set"));const v=(new DOMParser).parseFromString(g,"text/html").body.firstChild||"";return this.getEmailButtonPaddedContent(v,a,i,o,s,c,l,u,f,p)}async renderAsync(e){const{button:t}=e,{link:n,align:a,hasBorder:i,hasBorderRadius:o,hasBoxShadow:s,backgroundColor:c,textStyles:d,borderStyles:l,height:u,paddingTopBottom:f,paddingLeftRight:p}=t,{url:m,title:_}=this.process(n),h=this.context.localSectionTheme,b=this.createTextBlockComponent(_??m,m,c,h,d,u),g=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(b).catch(()=>""));if(!g)throw this.createCustomError("Component returned undefined or empty",$e.ResultTypeEnum.ExpectedFailure,new Error("Button content is expected to be set"));const v=(new DOMParser).parseFromString(g,"text/html").body.firstChild||"";return this.getEmailButtonPaddedContent(v,a,i,o,s,c,l,u,f,p)}getEmailButtonPaddedContent(e,t,n,a,i,o,s,c,d=8,l=16){const{borderColor:u,borderWidth:f}=s||{};return xe(e,t??"Center",re()?d:8,re()?l:16,!T()&&(re()?pe(o,r.BUTTON_COLOR_KEYS):o)||this.context.localSectionTheme.semanticColors.primaryButtonBackground||"",void 0,void 0,"button-root-table",!T()&&n,!T()&&n?re()&&pe(u)||this.context.localSectionTheme.semanticColors.bodyDivider:re()?pe(o,r.BUTTON_COLOR_KEYS):o,!T()&&a,!T()&&i,re()&&n?f:void 0,re()?c:void 0)}createTextBlockComponent(e,t,n,a,o,s){const{italic:c,fontWeight:d,textDecoration:l,fontSize:u,fontColor:f}=o||{};return{componentName:r.ComponentName.TextBlock,text:w()?(0,i.escape)(e):k()?e??t:e??"",link:t,styles:re()?{fontSize:u||"medium",italic:c,fontWeight:d||"normal",lineHeight:s?`${s}px`:"22px",textDecoration:l||"none",fontColor:pe(f)||(T()||"theme"!==n?a.semanticColors.primaryButtonText:this.context.localSectionTheme.semanticColors.link)}:{fontSize:"medium",fontWeight:"normal",lineHeight:"22px",textDecoration:"none",fontColor:T()||"theme"!==n?a.semanticColors.primaryButtonText:this.context.localSectionTheme.semanticColors.link}}}constructor(...t){super(...t),this.distribution=e.Email}},class extends Rn{render(e){const t=this.context.getComponent(r.ComponentName.Video)?.render(this._getVideoComponent(e)),n=this.context?.getComponent(r.ComponentName.Image)?.render(this._getImageComponent(e))||"",a=this._getCaptionComponent(e),i=a?this.context.getComponent(r.ComponentName.TextBlock)?.render(a):void 0;return this._processVideo(e,{unfurlElement:t,imageElement:n,captionContent:i})}async renderAsync(e){const t=await(this.context.getComponent(r.ComponentName.Video)?.executeRender(this._getVideoComponent(e))),n=await(this.context?.getComponent(r.ComponentName.Image)?.executeRender(this._getImageComponent(e))),a=this._getCaptionComponent(e),i=a?await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>"")):void 0;return this._processVideo(e,{unfurlElement:t,imageElement:n,captionContent:i})}_getVideoComponent(e){const{thumbnailLink:t}=e,{link:n}=t,a=be.UrlUtility.absolutizeUrl(n.url);return{componentName:r.ComponentName.Video,video:{type:"Video",source:{url:a}}}}_getImageComponent(e){const{thumbnailLink:t}=e,{link:n,thumbnail:a}=t,{title:i}=n,o=ne(this.context.endpointDetails)&&this.context.endpointDetails?Oe(!1,this.context.endpointDetails)*(380/700):380,s=nn("video",en.medium),c={componentName:r.ComponentName.Image,imageUrl:a?.source.url||"",width:ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(),fallbackImageUrl:s,altText:i,cornerRounding:"top",_sharepointIds:a?.source.sharepointIds};return S()&&(c.additionalStyles={height:`${o}px`}),c}_getCaptionComponent(e){if(e.thumbnailLink?.link?.description)return{componentName:r.ComponentName.TextBlock,text:e.thumbnailLink?.link?.description||"",styles:{fontSize:"small",fontWeight:"normal"}}}_processVideo(e,t){const{fileType:n,thumbnailLink:a}=e,{link:r}=a,{url:d,title:l,description:u}=r,f=this.context.localSectionTheme,p=be.UrlUtility.absolutizeUrl(d),m=ne(this.context.endpointDetails)&&this.context.endpointDetails?Oe(!1,this.context.endpointDetails)*(380/700):380,_=document.createElement("table");_.border="0",_.cellPadding="0",_.cellSpacing="0",_.align="center",_.width="100%",_.style.maxWidth=ne(this.context.endpointDetails)?`${Oe(!1,this.context.endpointDetails)}px`:`${c.TABLE_RENDER_WIDTH}px`,_.style.display="block",_.style.borderRadius=`${c.CORNER_ROUND}px`,_.style.border=`1px solid ${f.semanticColors.variantBorder}`,_.style.boxShadow=`${f.semanticColors.cardShadow}`;const g=_.insertRow().insertCell();g.width="100%",g.align="left",g.style.borderRadius=`${c.CORNER_ROUND}px`,g.style.maxWidth=ne(this.context.endpointDetails)?`${Oe(!1,this.context.endpointDetails)}px`:`${c.TABLE_RENDER_WIDTH}px`;let v=document.createElement("a");t.unfurlElement&&(v=(new DOMParser).parseFromString(t.unfurlElement,"text/html").body.firstChild);const y=document.createElement("span");if(S()&&y.style.setProperty("max-height",`${m}px`,"important"),y.style.overflow="hidden",y.innerHTML=t.imageElement,v.appendChild(y),g.appendChild(v),u&&t.captionContent){const e=_.insertRow().insertCell(),n=document.createElement("div");n.style.textAlign="center",n.innerHTML=t.captionContent,e.appendChild(n)}const D=_.insertRow().insertCell();D.width="100%",D.style.padding="8px";const I=document.createElement("a");I.href=b()?(0,i.escape)(p):nt(p),I.id=we(),I.className=o,I.style.setProperty("text-decoration","none","important"),I.style.setProperty("color",f.semanticColors.link,"important");const x=G()?be.Icons.getIconUrl(n,c.ICON_SIZE):nn("video",en.small),C=document.createElement("div");C.align="left";const O=document.createElement("img");O.width=c.ICON_SIZE,O.height=c.ICON_SIZE,O.src=x,O.style.verticalAlign="bottom",O.setAttribute(s,"SPO");const w=document.createElement("span");w.style.fontSize="14px",w.style.display="inline-block",w.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;";const E=document.createElement("span");return E.style.fontSize="14px",E.style.fontWeight="600",E.style.overflow="hidden",E.style.textOverflow="ellipsis",E.style.fontFamily=ue(this.context.globalPageTheme),E.style.display="inline-block",E.style.verticalAlign="bottom",h._SPKillSwitch.isActivated("356e9db2-155e-4904-b24d-e3c34c5c1015")||(E.style.lineHeight="1.5"),E.innerHTML=(0,i.escape)((l||"").substring(0,c.MAX_TITLE_CHAR_CARD))||"",E.style.color=f.semanticColors.link,C.appendChild(O),C.appendChild(w),C.appendChild(E),I.appendChild(C),D.appendChild(I),_.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends On{render(e){const{imageUrl:t,width:n,fallbackImageUrl:a,linkUrl:i,altText:r,cornerRounding:o,additionalStyles:s,_isHeightLocked:c,_msoStyleOverride:d,_skipThumbnailRequest:l}=e;let u=n;const f=this.generateThumbnailProps(e),p=f.thumbnailUrl,m=f.fallbackUrl;u=f.dimensions?.width||Math.min(Oe(!0),n);const _=f.dimensions?.height;f.thumbnailUrl&&!l&&W()&&this.context.processImage(f.thumbnailUrl,f.fallbackUrl?[f.fallbackUrl]:void 0);const h=this._buildImageStyles(u,_,o,s,c),b=this._getImgElement(p||"",m||"",h,r,i,d,{width:u,height:_},s);if(!(ie()||"all"!==o&&"circular"!==o)&&_){const n=this._getMSOCompatibleImgElement("circular"===o,p||"",m||"",u,_,r,i),s=this._getTargetedImgElement(n,b),c=document.createElement("div");if(c.innerHTML=s,!W()&&p&&!l){const e=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,p,m,this._props,c.outerHTML);this.context.processImage(p,m?[m]:void 0,e)}return!R()&&W()&&this._logImageComponentDetails(c,t,a,p,m,e),c.outerHTML}if(!W()){const e=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,p,m,this._props,b);p&&!l?this.context.processImage(p,m?[m]:void 0,e):un("Transpile.ImageComponent",e||{})}return b}async renderAsync(e){const{imageUrl:t,fallbackImageUrl:n,width:a,linkUrl:i,altText:r,cornerRounding:o,additionalStyles:s,_isHeightLocked:c,_msoStyleOverride:d}=e,l=this._imageBuildInfo.dimensions?.width||Math.min(Oe(!0),a),u=this._imageBuildInfo.dimensions?.height,f=this._buildImageStyles(l,u,o,s,c),p=this._getImgElement(this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl||"",f,r,i,d,{width:l,height:u},s);if(!(ie()||"all"!==o&&"circular"!==o)&&this._imageBuildInfo.dimensions?.height){const a=this._getMSOCompatibleImgElement("circular"===o,this._imageBuildInfo.thumbnailUrl||"",this._imageBuildInfo.fallbackUrl||"",l,u,r,i),s=this._getTargetedImgElement(a,p),c=document.createElement("div");if(c.innerHTML=s,!W()&&this._imageBuildInfo.thumbnailUrl&&!e._skipThumbnailRequest){const e=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl,this._props,c.outerHTML);this.context.processImage(this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl?[this._imageBuildInfo.fallbackUrl]:void 0,e)}return!R()&&W()&&this._logImageComponentDetails(c,t,n,this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl,e),c.outerHTML}if(!W()){const t=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl,this._props,p);this._imageBuildInfo.thumbnailUrl&&!e._skipThumbnailRequest&&this.context.processImage(this._imageBuildInfo.thumbnailUrl,this._imageBuildInfo.fallbackUrl?[this._imageBuildInfo.fallbackUrl]:void 0,t)}return p}generateThumbnailProps(e){const{imageUrl:t,width:n,height:a,originalWidth:i,originalHeight:r,cropData:o,cropMode:s,fallbackImageUrl:c,_fileType:d,_focalX:l,_focalY:u,_sharepointIds:f,_shouldEnforceDimensions:p,_skipThumbnailRequest:m}=e,_=Math.min(Oe(!0),n),h=a&&n?a/n:r&&i?r/i:void 0;let b,g=h?Math.round(_*h):void 0,v=t,y=c;if(!m){const e=this.enhanceThumbnailWidth(_,i||0,r||0,p),m=a&&h?Math.round(e*h):void 0;b={width:e,height:m},d&&!He(d)&&ge._TraceLogger.logError(ge._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),`Unsupported image type: ${d}`);const S={callerId:"Transpile-Components",absoluteUrl:D()?window.location.origin:this.context.authority,spResource:t,width:e,height:m,originalWidth:i,originalHeight:r,optimizePublicImage:!1,fileType:d,cropMode:s,nonExpiring:!0};if(!D()&&f&&(S.siteId=f.siteId,S.listId=f.listId,S.webId=f.webId,S.uniqueId=f.uniqueId),o){S.viewportWidth=o.cropWidth,S.viewportHeight=o.cropHeight,S.viewportLeft=o.cropX,S.viewportTop=o.cropY;const e=o.cropHeight/o.cropWidth;g=Math.round(_*e),S.height=a?Math.round(_*e):void 0}v=this.getTranspileThumbnail(S,l,u,void 0,p),y=c||this._getTranspileThumbnailFallbackUrl(S,n)}return{thumbnailUrl:v||"",fallbackUrl:y,dimensions:{width:_,height:g},thumbnailDimensions:b}}_buildImageStyles(e,t,n,a,i){const r={"object-fit":"cover",width:`${e}px`,"max-width":"100%"};return(i||"circular"===n)&&t&&(r.height=`${t}px`),this._setAdditionalStyles(r,a),"circular"===n?(r["border-radius"]=`${c.CORNER_CIRCLE}%`,r.display="block"):n&&(r["border-radius"]=this._getCornerRadius(n)),r}_getTranspileThumbnailFallbackUrl(e,t,n,a,i){return e.width=t,e.height=n??e.height,this.getTranspileThumbnail(e,a,i,!0)}_getFallbackImgAttribute(e){const t={};return e&&(t.backupThumbnailSrc=e),t}_getAltTextAttribute(e){const t={};return e?t.alt=(0,i.escape)(e):t.role="presentation",t}_extractWin32Attribute(e,t){const n={};return(t?.width||e.width)&&(n.width=t?.width?`${t.width}`:e.width?.replace("px","")),(t?.height||e.height)&&(n.height=t?.height?`${t.height}`:e.height?.replace("px","")),n}_getImageCroppingAttribute(e,t){const n={};return!ie()&&q()||(e?.width&&(n[u]=`${e.width}`),e?.height&&(n[f]=`${e.height}`),Z()||(void 0!==t?.opacity&&(n["data-opacity"]=`${t.opacity}`),t?.backgroundColor&&(n["data-bgcolor"]=t.backgroundColor))),n}_getMSOCompatibleImgElement(e,t,n,a,i,r,o){const s=document.createElement(e?"v:oval":"v:roundrect");if(ve(s,{"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:w":"urn:schemas-microsoft-com:office:word",stroke:"f",...this._getAltTextAttribute(r)}),ye(s,{height:`${i}px`,width:`${a}px`}),e)ve(s,{fill:"t"});else{const e=Math.min(a,i||Number.POSITIVE_INFINITY)/2;ve(s,{arcsize:`${Math.round(400/e)}%`,fillcolor:"none"}),o&&ve(s,{href:h._SPKillSwitch.isActivated("ba55991b-52e3-4270-b41e-420c6cba8f2a")?o:nt(o)}),!B()&&this.componentId&&ve(s,{[l]:this.componentId})}const c=document.createElement("v:fill");return ve(c,{type:"frame",src:t,...this._getFallbackImgAttribute(n)}),ye(c,{width:`${a}px`,height:`${i}px`}),s.appendChild(c),s.outerHTML}_getTargetedImgElement(e,t){return`${Ce(!0,e,9)}\n      ${Ce(!1,t)}`}_getImgElement(e,t,n,a,i,r,o,s){const c=document.createElement("img"),d={...this._getAltTextAttribute(a),...this._getFallbackImgAttribute(t),...this._extractWin32Attribute(n,r),...this._getImageCroppingAttribute(o,s)};if(!ie()&&(h._SPKillSwitch.isActivated("d3f3e1b1-2f4e-4e7c-8f0a-2b1e6f3c5a6b")||q())||h._SPKillSwitch.isActivated("4357b025-0721-46e6-88c0-a59bd430443d")?d.src=e:d["data-url"]=e,d["data-scenario-source"]="SPO",ve(c,d),ye(c,n),z()){const t=this.context.getAttachment({link:e||"",fileType:"Image"});t>=0&&ve(c,{"data-local-index":t.toString()})}if(i){const e=document.createElement("a");return e.setAttribute("href",F()?i:nt(i)),e.appendChild(c),e.outerHTML}return!B()&&this.componentId&&ve(c,{[l]:this.componentId}),c.outerHTML}_getCornerRadius(e){const t=["all","top","left"].includes(e)?c.CORNER_ROUND:0,n=["all","top","right"].includes(e)?c.CORNER_ROUND:0,a=["all","bottom","left"].includes(e)?c.CORNER_ROUND:0;return`${t}px ${n}px ${["all","bottom","right"].includes(e)?c.CORNER_ROUND:0}px ${a}px`}_setAdditionalStyles(e,t){t&&(t.width&&(e.width=t.width),t.height&&(e.height=t.height),t.minWidth&&(e["min-width"]=t.minWidth),t.minHeight&&(e["min-height"]=t.minHeight),t.objectFit&&(e["object-fit"]=t.objectFit),t.verticalAlign&&(e["vertical-align"]=t.verticalAlign),!Z()&&ie()||(void 0!==t.opacity&&(e.opacity=`${t.opacity}`),t.backgroundColor&&(e["background-color"]=t.backgroundColor)))}_logImageComponentDetails(t,n,a,i,r,o){try{void 0===this.imageDetails.error&&(this.imageDetails.error=[]),this.imageDetails.componentId=this.componentId;const s=cn(n,!1),c=cn(a,!0),d=cn(i,!1),l=cn(r,!0);if(this.imageDetails.inputPrimaryImageDetails=s,this.imageDetails.inputFallbackImageDetails=c?[c]:[],this.imageDetails.fallbackImageDetails=l?[l]:[],this.imageDetails.primaryImageDetails=d,s?.errorMessage&&this.imageDetails.error.push(...s.errorMessage),c?.errorMessage&&this.imageDetails.error.push(...c.errorMessage),d?.errorMessage&&this.imageDetails.error.push(...d.errorMessage),l?.errorMessage&&this.imageDetails.error.push(...l.errorMessage),this.imageDetails.hasLinkInProps=!!o?.linkUrl,o?.linkUrl){const n=ln(t,o.linkUrl,e.Email);this.imageDetails.hasValidLinkInOutput=n.valid,!n.valid&&n.reason&&this.imageDetails.error.push(n.reason)}this.imageDetails.error?.length>0?this.context.logQosEvent?.("Transpile.EmailImageComponent",$e.ResultTypeEnum.Failure,this.imageDetails):this.context.logQosEvent?.("Transpile.EmailImageComponent",$e.ResultTypeEnum.Success,this.imageDetails)}catch(e){this.context.logQosEvent?.("Transpile.EmailImageComponent.LoggingError",$e.ResultTypeEnum.Failure,this.imageDetails,e)}}constructor(...t){super(...t),this.distribution=e.Email,this.imageDetails={}}},class extends Tn{render(e){const t=this._buildImageComponentProps(e);if(!t)return"";const{imageProp:n,width:a}=t,i=this.context?.getComponent(r.ComponentName.Image)?.render(n);return i?this._buildImageTable(i,e,a):""}async renderAsync(e){const t=this._buildImageComponentProps(e);if(!t)return"";const{imageProp:n,width:a}=t,i=await(this.context?.getComponent(r.ComponentName.Image)?.executeRender(n));return i?this._buildImageTable(i,e,a):""}_buildImageComponentProps(e){const{isFullBleed:t,linkUrl:n,overlayTextStyles:a,imageProps:i}=e,o=this.context.localSectionTheme;if(!Re(i))return;const{source:s,alternateText:c,cropMode:d,targetDimension:l,originalDimensions:u,type:f}=i,p=u?.width||0;let m;m=ne(this.context.endpointDetails)?t?Oe(!0,this.context.endpointDetails):l?.width?Math.min(p||99999,Math.min(Oe(!1,this.context.endpointDetails),l?.width)):Math.min(p||99999,Oe(!1,this.context.endpointDetails)):t?Oe(!0):l?.width?Math.min(p||99999,Math.min(Oe(),l?.width)):Math.min(p||99999,Oe());const _=void 0!==a?.overlayTransparency&&1!==a.overlayTransparency,b={componentName:r.ComponentName.Image,imageUrl:s?.url||"",width:m,originalWidth:u?.width,originalHeight:u?.height,linkUrl:n,altText:c,cornerRounding:t||ae()&&f===r.ImageFileType.Gif?void 0:"all",_isHeightLocked:h._SPKillSwitch.isActivated("3b8acbfb-41b4-44b7-96a9-a3af08b08008")?t:void 0,additionalStyles:{opacity:_?a?.overlayTransparency:void 0,backgroundColor:_?Ue(o,a?.overlayColor||"light"):void 0,width:t?"100%":void 0},cropMode:d};return this.handleCropping(b,i),s?.sharepointIds&&(b._sharepointIds=s.sharepointIds),{imageProp:b,width:m}}_buildImageTable(e,t,n){const a=this.context.localSectionTheme,{alignment:o,caption:s,overlayText:c,overlayTextStyles:d,overlayTextHTML:l}=t,u=document.createElement("table");u.classList.add("image-table"),u.align=o?.toLowerCase()||"center",o&&"Center"!==o&&(u.style.float=o.toLowerCase()),u.width="100%",u.border="0",u.cellSpacing="0",u.cellPadding="0",u.style.maxWidth=`${n}px`,l&&oe()?u.appendChild(function(e,t){const n={componentName:r.ComponentName.RichText,input:e,format:"Html"},a=t.getComponent(r.ComponentName.RichText)?.render(n),i=document.createElement("tr"),o=document.createElement("td");return o.innerHTML=a||"",i.appendChild(o),i}(l,this.context)):c&&""!==c&&u.appendChild(Te(a,c,d));const f=document.createElement("tr"),p=document.createElement("td");p.classList.add("image-column"),p.align="center";let m="";if(s&&""!==s){const e=document.createElement("div");e.classList.add("image-caption"),e.style.fontSize="14px",e.style.fontWeight="normal",e.style.textAlign="center",e.textContent=w()?(0,i.escape)(s):s,m=e.outerHTML}return p.innerHTML=`${e}${m}`,f.appendChild(p),u.appendChild(f),u.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends Vn{render(e){return this._renderHelper(e)}async _renderAsync(e){return this._renderHelper(e)}_renderHelper(e){const{length:t,weight:n}=e,a=this.context.localSectionTheme.palette.neutralTertiaryAlt??"#c7c7c7",i=document.createElement("div");i.setAttribute("aria-hidden","true"),i.setAttribute("role","presentation");const r=document.createElement("table");r.setAttribute("role","presentation"),r.style.border="0px",r.style.width=`${t}%`,r.style.padding="0px",h._SPKillSwitch.isActivated("0a669d94-1b01-4d26-9eb7-56ffed5b3de6")||(r.style.paddingTop="20px"),r.style.borderSpacing="0px",r.setAttribute("align","center");const o=document.createElement("tr"),s=document.createElement("td");return s.style.height="0px",s.style.width="100%",s.style.margin="0",s.style.borderTop=`${n}px solid`,s.style.borderColor=a,s.style.borderLeftStyle="none",s.style.borderRightStyle="none",s.style.borderBottomStyle="none",o.appendChild(s),r.appendChild(o),i.appendChild(r),i.innerHTML+="<br>",i.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends zn{render(e){return this._renderHelper(e)}async renderAsync(e){return this._renderHelper(e)}_renderHelper(e){const{height:t}=e,n=this._getHeight(t),a=document.createElement("div");return a.setAttribute("aria-hidden","true"),a.setAttribute("role","presentation"),a.setAttribute("tabIndex","-1"),a.setAttribute("height",`${n}`),a.style.height=`${n}px`,a.style.lineHeight=`${n}px`,a.style.outline="0",a.style.position="relative",a.innerHTML="&nbsp;",a.outerHTML}_getHeight(e){return 2*de()>e?e:Math.abs(e-2*de())}constructor(...t){super(...t),this.distribution=e.Email}},class extends Gn{render(e){const{thumbnailLink:t,fileType:n,iconProps:a}=e,{link:i}=t,{url:r,description:o}=i;if(!r)return"";const s=be.UrlUtility.absolutizeUrl(Kn),c=n??be.ExtensionHelper.getExtension(r)??"",d=this._getImageContent(e,s,c),l=this._getCaptionIconContent(c,a),u=o?this._getDescriptionBlock(o):void 0,f=this._getTypeNameBlock(c,a);return this._buildFileCard(e,{imageContent:d,captionIconContent:l,descriptionBlock:u,typeNameBlock:f})}async renderAsync(e){const{thumbnailLink:t,fileType:n,iconProps:a}=e,{link:i}=t,{url:r,description:o}=i;if(!r)return"";const s=be.UrlUtility.absolutizeUrl(Kn),c=n??be.ExtensionHelper.getExtension(r)??"",d=await this._getImageContentAsync(e,s,c),l=await this._getCaptionIconContentAsync(c,a),u=o?await this._getDescriptionBlockAsync(o):void 0,f=await this._getTypeNameBlockAsync(c,a);return this._buildFileCard(e,{imageContent:d,captionIconContent:l,descriptionBlock:u,typeNameBlock:f})}_getImageContentProps(e,t,n){const{thumbnailLink:a}=e,{link:i,thumbnail:o}=a,{url:s,title:d}=i,l=.4*c.TABLE_RENDER_WIDTH,u=l*c.IMAGE_HEIGHT_RATIO,f=tn(n,en.medium),p=o?.source?o.source.url:void 0,m={componentName:r.ComponentName.Image,imageUrl:p??s??t??f,altText:d,fallbackImageUrl:f,height:u,width:l,cropMode:_e._CropMode.Fill,cornerRounding:y()?"top":"left",additionalStyles:{minHeight:"110px",objectFit:"contain",width:"100%",height:`${u}px`,verticalAlign:"bottom"},_fileType:n};return o?.source?.sharepointIds&&(m._sharepointIds=o.source.sharepointIds),m}_getImageContent(e,t,n){return this.context.getComponent(r.ComponentName.Image)?.render(this._getImageContentProps(e,t,n))}async _getImageContentAsync(e,t,n){return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(this._getImageContentProps(e,t,n)).catch(()=>""))}_getCaptionIconProps(e,t){const n=t?.iconUrl?t.iconUrl:G()?function(e,t=20){return be.Icons.getIconUrl(e||"",t)}(e):tn(e,en.small);return{componentName:r.ComponentName.Image,imageUrl:n,altText:e,width:20,height:20,cropMode:_e._CropMode.Fill,additionalStyles:{verticalAlign:"bottom"}}}_getCaptionIconContent(e,t){return this.context.getComponent(r.ComponentName.Image)?.render(this._getCaptionIconProps(e,t))}async _getCaptionIconContentAsync(e,t){return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(this._getCaptionIconProps(e,t)).catch(()=>""))}_getDescriptionBlockProps(e){const t=e.substring(0,c.MAX_TITLE_CHAR_CARD);return{componentName:r.ComponentName.TextBlock,text:t,styles:{fontWeight:"normal",fontSize:"x-small"}}}_getDescriptionBlock(e){return this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getDescriptionBlockProps(e))}async _getDescriptionBlockAsync(e){return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getDescriptionBlockProps(e)))}_getTypeNameBlockProps(e,t){return{componentName:r.ComponentName.TextBlock,text:t?.iconText??Ee(e),styles:{fontSize:"xx-small",lineHeight:"14px"}}}_getTypeNameBlock(e,t){return this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getTypeNameBlockProps(e,t))}async _getTypeNameBlockAsync(e,t){return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getTypeNameBlockProps(e,t)).catch(()=>""))}_buildFileCard(e,t){const{thumbnailLink:n}=e,{link:a}=n,{url:r,title:o,description:s}=a;if(!r)return"";const d=document.createElement("table");d.border="0",d.cellPadding="0",d.cellSpacing="0",d.width="100%",d.align="center",d.style.maxWidth=`${c.TABLE_RENDER_WIDTH}px`,d.style.boxShadow=this.context.localSectionTheme.semanticColors.cardShadow,d.style.borderRadius=`${c.CORNER_ROUND}px`,d.style.border=`1px solid ${this.context.localSectionTheme.semanticColors.variantBorder}`,d.style.display="block",d.className="emailFileCard";const l=d.insertRow(),u=l.insertCell();u.rowSpan=2,u.width="40%",u.align="left",u.style.borderRadius=`${c.CORNER_ROUND}px 0 0 ${c.CORNER_ROUND}px`,u.style.maxWidth=`${c.TABLE_RENDER_WIDTH}px`,u.style.padding="0px",u.className="emailFileCardImage";const f=document.createElement("a");f.href=b()?(0,i.escape)(r):nt(r),f.style.setProperty("text-decoration","none","important"),f.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),f.style.cursor="pointer",f.style.display="inline-block",f.id=we(),f.className="emailFileCardImageLink",f.style.wordBreak="break-word",t.imageContent&&""!==t.imageContent&&(f.innerHTML=t.imageContent),u.appendChild(f);const p=l.insertCell();p.width="60%",p.style.verticalAlign="top",p.style.padding="0px 12px";const m=document.createElement("table");m.border="0",m.cellPadding="0",m.cellSpacing="0",m.align="left",m.style.padding="0px",m.className="emailFileCardContentTable";const _=m.insertRow().insertCell();_.vAlign="top",_.style.verticalAlign="top";const h=document.createElement("div");h.align="left",h.style.verticalAlign="top";const g=document.createElement("a");g.href=b()?(0,i.escape)(r):nt(r),g.style.setProperty("text-decoration","none","important"),g.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),g.style.cursor="pointer",g.id=we(),g.className="OWAAutoLink";const v=document.createElement("p");v.className="emailFileCardContentLink",v.style.fontFamily=le(this.context.globalPageTheme),v.style.margin="5px 0px",v.style.overflow="hidden",v.style.textOverflow="ellipsis",v.style.fontSize="14px",v.style.fontWeight="600";const S=(o||"").substring(0,c.MAX_TITLE_CHAR_CARD);if(v.innerHTML=S,g.appendChild(v),h.appendChild(g),!s){const e=document.createElement("p");e.setAttribute("height","16"),e.style.height="16px",e.style.fontSize="10px",e.style.margin="0",e.innerHTML="&nbsp;",_.appendChild(e)}if(_.appendChild(h),s&&t.descriptionBlock&&""!==t?.descriptionBlock){const e=m.insertRow().insertCell();e.vAlign="bottom",e.style.verticalAlign="bottom";const n=document.createElement("div");n.align="left",n.style.verticalAlign="bottom";const a=document.createElement("p");a.style.fontFamily=le(this.context.globalPageTheme),a.style.overflow="hidden",a.style.textOverflow="ellipsis",a.style.minHeight="40px",a.className="emailFileCardDescription",y()||(a.style.fontSize="12px"),a.innerHTML=t.descriptionBlock,n.appendChild(a),e.appendChild(n)}const D=d.insertRow().insertCell();D.vAlign="bottom",D.style.verticalAlign="bottom",D.style.padding="0px 12px",p.appendChild(m);const I=document.createElement("table");I.border="0",I.cellPadding="0",I.cellSpacing="0",I.align="left",I.style.padding="12px 0px",D.appendChild(I);const x=I.insertRow(),C=x.insertCell();C.style.verticalAlign="bottom",C.style.paddingRight="8px";const O=document.createElement("span");t.captionIconContent&&""!==t.captionIconContent&&(O.innerHTML=t.captionIconContent),C.appendChild(O);const w=x.insertCell();w.style.verticalAlign="middle";const E=(new DOMParser).parseFromString(t.typeNameBlock,"text/html").body.querySelector("span");return E.className="emailFileCardIconName",w.appendChild(E),d.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends qn{render(e){const t=this.getComponentProps(e);return this.context.getComponent(r.ComponentName.FileCard)?.render(t)}async renderAsync(e){const t=this.getComponentProps(e);return await(this.context.getComponent(r.ComponentName.FileCard)?.executeRender(t))}constructor(...t){super(...t),this.componentName=r.ComponentName.YoutubeCard,this.distribution=e.Email}},class extends Zn{render(e){const{title:t,address:n}=e,a=document.createElement("table");a.style.maxWidth="100%",a.width="100%",a.cellPadding="0",a.cellSpacing="0";const i=a.insertRow().insertCell();i.width="100%",i.align="left";const o=document.createElement("div");if(o.style.margin="16px 0",o.style.wordWrap="break-word",t){const e={componentName:r.ComponentName.TextBlock,text:t,headerLevel:4},n=this.context.getComponent(r.ComponentName.TextBlock)?.render(e);n&&(o.innerHTML=n)}if(n){const e={componentName:r.ComponentName.TextBlock,text:n,styles:{fontSize:"medium"}},t=this.context.getComponent(r.ComponentName.TextBlock)?.render(e);if(t){const e=document.createElement("p");e.style.margin="0",e.innerHTML=t,o.appendChild(e)}}i.appendChild(o);const s=a.insertRow().insertCell();s.width="100%",s.align="center";const d=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(),l=Math.round(d*c.IMAGE_HEIGHT_RATIO),u=this.getMapUrl(e,d,l),f={componentName:r.ComponentName.Image,imageUrl:u,width:d,height:l,cornerRounding:"all",additionalStyles:{objectFit:"cover"}},p=this.context.getComponent(r.ComponentName.Image)?.render(f);return p&&(s.innerHTML+=p),a.outerHTML}async renderAsync(e){const{title:t,address:n}=e,a=document.createElement("table");a.style.maxWidth="100%",a.width="100%",a.cellPadding="0",a.cellSpacing="0";const i=a.insertRow().insertCell();i.width="100%",i.align="left";const o=document.createElement("div");if(o.style.margin="16px 0",o.style.wordWrap="break-word",t){const e={componentName:r.ComponentName.TextBlock,text:t,headerLevel:4},n=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e).then(e=>e).catch(()=>{}));n&&(o.innerHTML=n)}if(n){const e={componentName:r.ComponentName.TextBlock,text:n,styles:{fontSize:"medium"}},t=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e).then(e=>e).catch(()=>{}));if(t){const e=document.createElement("p");e.style.margin="0",e.innerHTML=t,o.appendChild(e)}}i.appendChild(o);const s=a.insertRow().insertCell();s.width="100%",s.align="center";const d=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(),l=Math.round(d*c.IMAGE_HEIGHT_RATIO),u=this.getMapUrl(e,d,l),f={componentName:r.ComponentName.Image,imageUrl:u,width:d,height:l,cornerRounding:"all",additionalStyles:{objectFit:"cover"}},p=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(f).then(e=>e).catch(e=>{throw e}));return p&&(s.innerHTML+=p),a.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends Qn{render(e){const{thumbnailLink:t,isDisplayLink:n,cardSize:a,callToAction:i,topic:o}=e,{link:s}=t,c={...s,url:be.UrlUtility.absolutizeUrl(s.url)},{url:d,title:l,description:u}=c,f=this._getImageContent(e);let p,m;f&&(p=this.context.getComponent(r.ComponentName.Image)?.render(f)),o&&a===r.CardLayout.ExtraLargeCard&&(m=this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getTopicHeaderContent(o)));const _=this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getTitleContent(l,d,a));let h,b,g;return a===r.CardLayout.LargeCard&&n&&(h=this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getHostNameContent(d,!!l))),a!==r.CardLayout.LargeCard&&a!==r.CardLayout.ExtraLargeCard||!u||(b=this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getDescriptionContent(u,a))),a===r.CardLayout.ExtraLargeCard&&i&&(g=this.context.getComponent(r.ComponentName.TextBlock)?.render(this._getCallToActionContent(i,a))),this._processLinkCardElements(e,p,m,_,h,b,g)}async renderAsync(e){const{thumbnailLink:t,isDisplayLink:n,cardSize:a,callToAction:i,topic:o}=e,{link:s}=t,c={...s,url:be.UrlUtility.absolutizeUrl(s.url)},{url:d,title:l,description:u}=c,f=this._getImageContent(e);let p,m;f&&(p=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(f).catch(()=>""))),o&&a===r.CardLayout.ExtraLargeCard&&(m=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getTopicHeaderContent(o)).catch(()=>"")));const _=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getTitleContent(l,d,a)).catch(()=>""));let h,b,g;return a===r.CardLayout.LargeCard&&n&&(h=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getHostNameContent(d,!!l)).catch(()=>""))),a!==r.CardLayout.LargeCard&&a!==r.CardLayout.ExtraLargeCard||!u||(b=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getDescriptionContent(u,a)).catch(()=>""))),a===r.CardLayout.ExtraLargeCard&&i&&(g=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(this._getCallToActionContent(i,a)).catch(()=>""))),this._processLinkCardElements(e,p,m,_,h,b,g)}_createLinkCard(e,t,n,a){const{imageElement:i,titleElement:o,descriptionElement:s,hostNameElement:d,topicElement:l,callToActionElement:u}=e,f=document.createElement("table");switch(this._applyRootTableStyles(f,t,n,a),t){case r.CardLayout.SmallCard:const e=f.insertRow();i&&e.appendChild(i),o&&e.appendChild(o);break;case r.CardLayout.MediumCard:case r.CardLayout.ExtraLargeCard:i&&f.appendChild(i),t===r.CardLayout.ExtraLargeCard&&l&&f.appendChild(l),o&&f.appendChild(o),t===r.CardLayout.ExtraLargeCard&&s&&f.appendChild(s),t===r.CardLayout.ExtraLargeCard&&u&&f.appendChild(u);break;case r.CardLayout.LargeCard:const n=.4*c.TABLE_RENDER_WIDTH/Jn,a=f.insertRow();i&&a.appendChild(i);const p=a.insertCell();p.width="60%",p.style.verticalAlign="top",p.vAlign="bottom",p.height=""+(n-44);const m=p.appendChild(document.createElement("table"));m.border="0",m.cellPadding="0",m.cellSpacing="12",m.align="left",m.style.padding="0px",o&&m.appendChild(o),s&&m.appendChild(s);const _=f.insertRow().insertCell();_.vAlign="bottom",_.style.verticalAlign="bottom",_.height="44";const h=document.createElement("table");h.border="0",h.cellPadding="0",h.cellSpacing="12",h.align="left",_.appendChild(h),d&&h.appendChild(d)}return f.outerHTML}_applyRootTableStyles(e,t,n,a){const i=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),o=t===r.CardLayout.LargeCard?"link-root-table":"quicklinks-cardtable";e.setAttribute("data-testId",o),e.setAttribute("cellpadding","0"),e.setAttribute("cellspacing","0"),e.setAttribute("width","100%"),t===r.CardLayout.LargeCard?(e.setAttribute("align","center"),e.style.maxWidth=`${i}px`,e.setAttribute("border","0"),e.style.maxWidth=`${c.TABLE_RENDER_WIDTH}px`,e.style.boxShadow=this.context.localSectionTheme.semanticColors.cardShadow,e.style.borderRadius=`${c.CORNER_ROUND}px`,e.style.border=`1px solid ${this.context.localSectionTheme.semanticColors.variantBorder}`):(e.setAttribute("border","0"),e.setAttribute("height","100%"),e.style.borderCollapse="separate",e.style.borderRadius="4px",e.style.backgroundColor=a,t===r.CardLayout.MediumCard?(e.style.borderSpacing="0px",e.style.border=`1px solid ${n.semanticColors.variantBorder}`,e.style.boxShadow="rgba(0, 0, 0, 0.14) 0px 2px 4px, rgba(0, 0, 0, 0.12) 0px 0px 2px"):(e.style.paddingLeft="12px",e.style.paddingRight="12px"))}_getMainTable(e,t,n){const a=document.createElement("table");return this._applyRootTableStyles(a,e,t,n),a}_getImageContent(e){const{thumbnailLink:t,cardSize:n}=e,{link:a,thumbnail:i}=t,o={...a,url:be.UrlUtility.absolutizeUrl(a.url)},{url:s}=o,d=this.context.localSectionTheme,l=n===r.CardLayout.LargeCard||n===r.CardLayout.ExtraLargeCard?"":n===r.CardLayout.MediumCard?d.palette.white:d.semanticColors.primaryButtonBackground,u=this._getMainTable(n,d,l);if(n===r.CardLayout.SmallCard){const e=document.createElement("tr");u.appendChild(e)}const f=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),p=n===r.CardLayout.LargeCard?.4*c.TABLE_RENDER_WIDTH:n===r.CardLayout.MediumCard?c.THUMBNAIL_WIDTH_MEDIUM:c.THUMBNAIL_WIDTH_SMALL,m=n===r.CardLayout.LargeCard?p/Jn:n===r.CardLayout.MediumCard?c.THUMBNAIL_HEIGHT_MEDIUM:p;return this._getImageProps(n,i,s,f,p,m,l)}_getImageProps(e,t,n,a,i,o,s){const d=(e===r.CardLayout.MediumCard||e===r.CardLayout.LargeCard?c.ICON_SIZE_MEDIUM:c.ICON_SIZE_SMALL)+c.ICON_PADDING;let l;if(e===r.CardLayout.ExtraLargeCard&&this.hasThumbnail(t)){const e=Math.round(a/Jn);l={componentName:r.ComponentName.Image,imageUrl:t?.source.url??"",width:a,height:e,cornerRounding:"all",_sharepointIds:t?.source.sharepointIds}}else if(e!==r.CardLayout.ExtraLargeCard){const a=_e._PreviewUtility.getFileExtension(new _e._SPResourcePath(n)),u=e===r.CardLayout.SmallCard?ce(s):ce(this.context.localSectionTheme.semanticColors.defaultStateBackground),f=tn(a||"",e===r.CardLayout.MediumCard||e===r.CardLayout.LargeCard?en.medium:en.small,h._SPKillSwitch.isActivated("1d2bc7bf-8539-4e51-a14d-43e1ac5e70bd")?ce(s):u),p=e===r.CardLayout.MediumCard||e===r.CardLayout.LargeCard,m=this.hasThumbnail(t)||p,_=e===r.CardLayout.SmallCard?d:m?i:d,b=e===r.CardLayout.SmallCard?d:m?o:d,g="aspx"!==a||!E()&&e===r.CardLayout.LargeCard||!h._SPKillSwitch.isActivated("f42d85cc-4fb8-4d91-bc70-41586d5d84c0")&&e===r.CardLayout.MediumCard?_e._CropMode.Fill:void 0;l={componentName:r.ComponentName.Image,imageUrl:t?.source.url||f,fallbackImageUrl:f,width:_,height:b,altText:t?.alternateText,cropMode:ie()&&!J()?void 0:g,cornerRounding:e===r.CardLayout.LargeCard?"left":e===r.CardLayout.MediumCard?"top":void 0,additionalStyles:{width:e===r.CardLayout.MediumCard?"100%":`${_}px`,height:`${b}px`,verticalAlign:e===r.CardLayout.LargeCard?"bottom":"middle",display:e===r.CardLayout.MediumCard?"block":void 0,minHeight:e===r.CardLayout.LargeCard?"110px":void 0},_msoStyleOverride:e===r.CardLayout.MediumCard?{width:c.THUMBNAIL_MSO_WIDTH_MEDIUM,height:c.THUMBNAIL_MSO_HEIGHT_MEDIUM}:void 0,_sharepointIds:t?.source.sharepointIds,_shouldEnforceDimensions:!(ie()&&!J()||E())}}return l}_getImageTdElement(e,t,n,a){const i=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),o=t===r.CardLayout.LargeCard?.4*c.TABLE_RENDER_WIDTH:t===r.CardLayout.MediumCard?c.THUMBNAIL_WIDTH_MEDIUM:c.THUMBNAIL_WIDTH_SMALL,s=t===r.CardLayout.LargeCard?o/Jn:t===r.CardLayout.MediumCard?c.THUMBNAIL_HEIGHT_MEDIUM:o,d=document.createElement("td");if(t===r.CardLayout.LargeCard)d.rowSpan=2,d.width="40%",d.align="center",d.style.borderRadius=`${c.CORNER_ROUND}px 0 0 ${c.CORNER_ROUND}px`,d.style.maxWidth=`${c.TABLE_RENDER_WIDTH}px`,d.style.padding="0px",d.setAttribute("data-testid","link-thumbnail-cell");else if(t===r.CardLayout.ExtraLargeCard){const e=c.UNIVERSAL_PADDING;d.setAttribute("data-testid","link-thumbnail-cell"),d.setAttribute("width","100%"),d.setAttribute("align","left"),d.style.maxWidth=`${i}px`,d.style.paddingTop=`${e}px`,d.style.paddingBottom=`${t===r.CardLayout.ExtraLargeCard?0:e}px`}else d.setAttribute("width",t===r.CardLayout.MediumCard?"100%":`${o}`),d.setAttribute("height",`${s}`),d.setAttribute("align","center"),d.style.width=t===r.CardLayout.MediumCard?"100%":`${o}px`,d.style.height=`${s}px`,d.style.backgroundColor=t===r.CardLayout.MediumCard?a.semanticColors.defaultStateBackground:a.semanticColors.primaryButtonBackground,t===r.CardLayout.MediumCard?(d.style.padding="0px",d.style.borderRadius="4px"):(d.style.paddingTop="12px",d.style.paddingBottom="12px");let l;if(t===r.CardLayout.ExtraLargeCard?l=document.createElement("span"):(l=document.createElement("a"),l.setAttribute("href",n),l.style.setProperty("text-decoration","none","important"),l.style.cursor="pointer"),l.innerHTML=e,d.appendChild(l),t===r.CardLayout.SmallCard||t===r.CardLayout.LargeCard)return d;const u=document.createElement("tr");return u.appendChild(d),u}_getTitleContent(e,t,n){return{componentName:r.ComponentName.TextBlock,text:e??"",link:n!==r.CardLayout.ExtraLargeCard?t:void 0,styles:this._getTitleStyles(n,this.context.localSectionTheme)}}_getTitleTdElement(e,t,n,a){const i=document.createElement("td");if(i.setAttribute("data-testid","link-title-cell"),t===r.CardLayout.LargeCard?(i.vAlign="top",i.style.verticalAlign="top"):t===r.CardLayout.ExtraLargeCard?(i.setAttribute("width","100%"),i.setAttribute("height","36px"),i.style.margin="0",i.style.overflowWrap="break-word",v()&&(i.style.margin="0px 5px")):(i.setAttribute("align","left"),i.style.height=t===r.CardLayout.MediumCard?"65px":"40px",i.style.paddingLeft=t===r.CardLayout.MediumCard?"10px":"12px",i.style.backgroundColor=a,t===r.CardLayout.MediumCard&&(i.style.borderBottomLeftRadius="4px",i.style.borderBottomRightRadius="4px",i.style.paddingRight="10px")),t===r.CardLayout.LargeCard){const t=document.createElement("div");t.setAttribute("align","left"),t.style.verticalAlign="top",t.innerHTML=e,i.appendChild(t)}else if(h._SPKillSwitch.isActivated("0e28ffe4-8151-4029-99e1-0c691435178d")||t!==r.CardLayout.MediumCard&&t!==r.CardLayout.SmallCard)i.innerHTML=e;else{const t=`<p style="padding: 0; margin: 0;">${e}</p>`;e=ne(this.context.endpointDetails)?Le(t,this.context.endpointDetails):Ae(t),i.innerHTML=e}if(t===r.CardLayout.SmallCard)return i;const o=document.createElement("tr");return o.appendChild(i),o}_getHostNameContent(e,t){const n=new URL(e).hostname.replace("www.","");return{componentName:r.ComponentName.TextBlock,text:n,link:t?void 0:e,styles:{fontSize:"xx-small",lineHeight:"14px"}}}_getHostNameTdElement(e,t){const n=document.createElement("tr"),a=document.createElement("td");return a.setAttribute("data-testid","link-host-cell"),a.style.verticalAlign="middle",a.style.lineHeight="20px",a.innerHTML=e??"",n.appendChild(a),n}_getDescriptionContent(e,t){return{componentName:r.ComponentName.TextBlock,text:h._SPKillSwitch.isActivated("de1968d6-d5ba-461f-9a66-a71d10b6b4f0")&&t===r.CardLayout.LargeCard?e.substring(0,c.MAX_TITLE_CHAR_CARD):e,styles:{fontSize:t===r.CardLayout.ExtraLargeCard?"small":"x-small",lineHeight:t===r.CardLayout.ExtraLargeCard?"20px":void 0}}}_getDescriptionTdElement(e,t){const n=document.createElement("tr"),a=document.createElement("td");a.setAttribute("data-testid","link-desc-cell"),t===r.CardLayout.LargeCard?(a.vAlign="bottom",a.style.verticalAlign="bottom",a.setAttribute("data-testid","link-desc-cell")):(a.setAttribute("width","100%"),a.style.verticalAlign="top",t===r.CardLayout.ExtraLargeCard?v()?a.style.padding="5px 0px":a.style.margin="5px 0px":a.style.padding="0 16px 20px 16px");const i=document.createElement("div");i.setAttribute("align","left"),t===r.CardLayout.LargeCard&&(i.style.verticalAlign="bottom");const o=document.createElement("p");return o.style.fontFamily=le(this.context.globalPageTheme),o.style.margin="0",t===r.CardLayout.LargeCard?(o.style.overflow="hidden",o.style.textOverflow="ellipsis",o.style.minHeight="40px",o.style.fontSize="12px"):(o.style.whiteSpace="break-spaces",o.style.overflow="break-word"),o.innerHTML=e,i.appendChild(o),a.appendChild(i),n.appendChild(a),n}_getTopicHeaderContent(e){return{componentName:r.ComponentName.TextBlock,text:e,styles:{fontSize:"small",fontWeight:"semi-bold",lineHeight:"20px"}}}_getTopicHeaderTdElement(e){const t=document.createElement("tr"),n=document.createElement("td");return n.setAttribute("data-testid","link-topic-cell"),n.setAttribute("width","100%"),n.setAttribute("height","20px"),n.innerHTML=e,t.appendChild(n),t}_getCallToActionContent(e,t){return{componentName:r.ComponentName.TextBlock,link:t,text:e,styles:{textDecoration:"underline",lineHeight:"20px",fontSize:"small",fontWeight:"semi-bold"}}}_getCallToActionTdElement(e){if(!e)return;const t=document.createElement("tr"),n=document.createElement("td");return n.setAttribute("data-testid","link-call-to-action-cell"),n.setAttribute("width","100%"),n.style.overflowWrap="break-word",n.innerHTML=e,t.appendChild(n),t}_processLinkCardElements(e,t,n,a,i,o,s){const{thumbnailLink:c,cardSize:d}=e,{link:l}=c,u={...l,url:be.UrlUtility.absolutizeUrl(l.url)},{url:f}=u,p=this.context.localSectionTheme,m=d===r.CardLayout.LargeCard||d===r.CardLayout.ExtraLargeCard?"":d===r.CardLayout.MediumCard?p.palette.white:p.semanticColors.primaryButtonBackground,_=this._getMainTable(d,p,m);if(d===r.CardLayout.SmallCard){const e=document.createElement("tr");_.appendChild(e)}const h={};if(t){const e=this._getImageTdElement(t,d,f,p);h.imageElement=e}if(n){const e=this._getTopicHeaderTdElement(n);h.topicElement=e}if(a){const e=this._getTitleTdElement(a,d,!!t,m);h.titleElement=e}if(i){const e=this._getHostNameTdElement(i,p);h.hostNameElement=e}if(o){const e=this._getDescriptionTdElement(o,d);h.descriptionElement=e}if(s){const e=this._getCallToActionTdElement(s);h.callToActionElement=e}return this._createLinkCard(h,d,p,m)}_getTitleStyles(e,t){if(e===r.CardLayout.ExtraLargeCard)return{fontSize:"x-large",fontWeight:"semi-bold",lineHeight:"20px"};if(e===r.CardLayout.LargeCard)return{overflow:"hidden",textOverflow:"ellipsis",fontSize:"small",fontWeight:"semi-bold"};{const n={fontSize:"small",lineHeight:"20px",textOverflow:"ellipsis",overflow:"hidden",lineClamp:2};return e===r.CardLayout.MediumCard?{...n,fontWeight:"semi-bold",fontColor:t.semanticColors.bodyText}:{...n,fontColor:t.semanticColors.primaryButtonText}}}constructor(...t){super(...t),this.distribution=e.Email}},class extends Nn{render(e){const t=this._generateEmailPeopleCardProps(e);return this._generateCards(t)}async renderAsync(e){const t=this._generateEmailPeopleCardProps(e);return this._generateCardsAsync(t)}_generateEmailPeopleCardProps(e){switch(e.CardLayout){case r.CardLayout.ExtraSmallCard:return this._generateExtraSmallCardProps(e);case r.CardLayout.SmallCard:return this._generateSmallCardProps(e);case r.CardLayout.MediumCard:return this._generateMediumCardProps(e);case r.CardLayout.LargeCard:return this._generateLargeCardProps(e);default:return this._generateSmallCardProps(e)}}_generateCardProps(e,t,n,a,i,r,o,s,c,d,l,u){return{...e,personaImageUrl:this._getUserPhotoUrl(Fe(this.context.authority),e.person.email,t),fallbackImageUrl:this._getFallbackUserPhotoUrl(Fe(this.context.authority),t),imageNaturalDimensions:this._getPersonaImageDimensionsBySize(t),trimmedDescription:Bn(e.person.description,a),trimmedLinkName:Bn(e.person.linkName,n),fullLinkName:e.person.linkName??"",cardPadding:i,cardPaddingLeft:r,cardPaddingTop:o,cardPaddingRight:s,cardPaddingBottom:c,linkHeight:16,horzPadding:8,descPaddingTop:12,descHeight:50,cardRadius:8,nameHeight:20,roleHeight:16,nameFontSize:"small",roleFontSize:"x-small",imagePaddingRight:d,imagePaddingTop:l,imagePaddingBottom:u,nameColor:this.context.localSectionTheme.semanticColors.bodyText,roleColor:this.context.localSectionTheme.semanticColors.bodySubtext,linkColor:this.context.localSectionTheme.semanticColors.link,descriptionColor:this.context.localSectionTheme.palette.neutralPrimary,borderColor:this.context.localSectionTheme.semanticColors.variantBorder,backgroundColor:this.context.localSectionTheme.semanticColors.bodyBackground}}_getPersonaImageDimensionsBySize(e){switch(e){case"XS":return{width:35,height:35};default:return{width:48,height:48};case"M":return{width:56,height:56};case"L":return{width:100,height:100}}}_generateExtraSmallCardProps(e){return this._generateCardProps(e,"XS",24,50,c.PADDING_PERSONA_TABLE_EXTRA_SMALL,0,c.PADDING_PERSONA_TABLE_EXTRA_SMALL,c.PADDING_PERSONA_TABLE_EXTRA_SMALL,c.PADDING_PERSONA_TABLE_EXTRA_SMALL,c.PERSONA_GAP,28,12)}_generateSmallCardProps(e){return this._generateCardProps(e,"S",24,50,c.PADDING_PERSONA_TABLE_SMALL,0,c.PADDING_PERSONA_TABLE_SMALL,c.PADDING_PERSONA_TABLE_SMALL,c.PADDING_PERSONA_TABLE_SMALL,c.PERSONA_GAP,28,12)}_generateMediumCardProps(e){return this._generateCardProps(e,"M",24,50,c.PADDING_PERSONA_TABLE_SMALL,0,c.COL_SPACING_CARD/2,c.COL_SPACING_CARD/2,c.COL_SPACING_CARD/2,16,28,12)}_generateLargeCardProps(e){return this._generateCardProps(e,"L",35,Q()?190:255,0,0,c.COL_SPACING_CARD/2,c.COL_SPACING_CARD/2,c.COL_SPACING_CARD/2,16,20,12)}_getUserPhotoUrl(e,t,n){return`${e}/_layouts/15/userPhoto.aspx?size=${n}&accountName=${escape(t)}&forceRedirectToCDN=true&default=user`}_getFallbackUserPhotoUrl(e,t){return`${e}/_layouts/15/userPhoto.aspx?size=${t}`}_generateCards(e){switch(e.CardLayout){case r.CardLayout.ExtraSmallCard:case r.CardLayout.SmallCard:return this._getProfileNameRoleTable(e);case r.CardLayout.MediumCard:return this._generateMediumCardWithLink(e);case r.CardLayout.LargeCard:return this._generateLargeCard(e);default:return""}}async _generateCardsAsync(e){switch(e.CardLayout){case r.CardLayout.ExtraSmallCard:case r.CardLayout.SmallCard:return this._getProfileNameRoleTableAsync(e);case r.CardLayout.MediumCard:return this._generateMediumCardWithLinkAsync(e);case r.CardLayout.LargeCard:return this._generateLargeCardAsync(e);default:return""}}_generateMediumCardWithLink(e){return this._getProfileSkeleton({personaCard:this._getProfileNameRoleTable(e),linkUrlElement:e.person.linkUrl?this._generateLinkElement(e):"",linkDescElement:e.person.description?this._generateLinkDescriptionElement(e):""},e)}async _generateMediumCardWithLinkAsync(e){return this._getProfileSkeleton({personaCard:await this._getProfileNameRoleTableAsync(e),linkUrlElement:e.person.linkUrl?await this._generateLinkElementAsync(e):"",linkDescElement:e.person.description?await this._generateLinkDescriptionElementAsync(e):""},e)}_getProfileSkeleton(e,t){const n=e.personaCard,a=this._generateLargeAndMediumCardOuterTable(t),i=a.insertRow().insertCell();i.style.paddingTop=`${t.imagePaddingTop}px`,i.style.paddingBottom=`${t.imagePaddingBottom}px`,i.innerHTML=n;const r=a.insertRow().insertCell();return r.dataset.testid="person-desc-cell",r.width="100%",Q()?r.height=`${t.descHeight}`:(r.style.minHeight=`${t.descHeight}px`,r.style.paddingBottom=`${t.descPaddingTop}px`),r.style.whiteSpace="normal",r.style.wordBreak="break-all",r.style.verticalAlign="top",r.style.display="block",r.style.overflow="hidden",r.style.textOverflow="ellipsis",t.person.description&&e.linkDescElement?r.innerHTML=e.linkDescElement:r.innerHTML="<div></div>",a.outerHTML}_generateLinkProps(e){return{componentName:r.ComponentName.TextBlock,text:e.trimmedLinkName??"",altText:e.fullLinkName,link:e.person.linkUrl,styles:{fontSize:"small",fontColor:e.linkColor}}}_generateLinkElement(e){const t=this._generateLinkProps(e),n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);return n.trim()}async _generateLinkElementAsync(e){const t=this._generateLinkProps(e);return(await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""))).trim()}_generateListDescriptionProps(e){return{componentName:r.ComponentName.TextBlock,text:e.trimmedDescription??"",styles:{fontSize:"small",fontColor:e.descriptionColor}}}_generateLinkDescriptionElement(e){const t=this._generateListDescriptionProps(e),n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);return n.trim()}async _generateLinkDescriptionElementAsync(e){const t=this._generateListDescriptionProps(e);return(await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""))).trim()}_generateLargeAndMediumCardOuterTable(e){const t=document.createElement("table");return t.dataset.testid="person-card-table",t.width="100%",t.border="0",t.cellSpacing="0",t.cellPadding="0",t.style.borderCollapse="separate",t.style.height="100%",t.style.paddingLeft="16px",t.style.paddingRight="16px",t.style.backgroundColor=e.backgroundColor,t.style.border="1px solid",t.style.borderColor=e.borderColor,t.style.borderRadius=`${e.cardRadius}px`,t.style.boxSizing="border-box",t.style.boxShadow="rgba(0, 0, 0, 0.14) 0px 2px 4px, rgba(0, 0, 0, 0.12) 0px 0px 2px",t}_generatePersonDetailsDiv(e){const t=this._generateTitleDivBlock(e),n=this._generateRoleDivBlock(e),a=document.createElement("div");return a.style.textAlign="left",a.dataset.id="topicHeader",a.appendChild(t),a.appendChild(n),e.person.linkUrl&&a.appendChild(this._generateLinkDivBlock(e)),a}async _generatePersonDetailsDivAsync(e){const t=await this._generateTitleDivBlockAsync(e),n=await this._generateRoleDivBlockAsync(e),a=document.createElement("div");return a.style.textAlign="left",a.dataset.id="topicHeader",a.appendChild(t),a.appendChild(n),e.person.linkUrl&&a.appendChild(this._generateLinkDivBlock(e)),a}_generateLinkDivBlock(e){const t=document.createElement("div");t.dataset.testid="person-link-text";const n=this._generateLinkElement(e);return t.innerHTML=n.trim(),t}_generateRoleProps(e){const t={fontSize:`${e.roleFontSize}`,fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",fontColor:e.roleColor};return{componentName:r.ComponentName.TextBlock,text:e.person.role??"",styles:t}}_generateRoleDivBlock(e){const t=this._generateRoleProps(e),n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);return this._buildRoleDivBlock(n,e)}async _generateRoleDivBlockAsync(e){const t=this._generateRoleProps(e),n=await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""));return this._buildRoleDivBlock(n,e)}_buildRoleDivBlock(e,t){const n=document.createElement("div");return n.innerHTML=e.trim(),n.style.lineHeight=`${t.roleHeight}px`,n.dataset.testid="person-role-text",n.style.fontFamily=le(this.context.globalPageTheme),n}_generateTitleProps(e){const t={fontSize:`${e.nameFontSize}`,fontWeight:"semi-bold",overflow:"hidden",textOverflow:"ellipsis",fontColor:e.nameColor};return{componentName:r.ComponentName.TextBlock,text:e.person.name,styles:t}}_generateTitleDivBlock(e){const t=this._generateTitleProps(e),n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(t);return this._buildTitleDivBlock(n,e)}async _generateTitleDivBlockAsync(e){const t=this._generateTitleProps(e),n=await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(t).then(e=>e||"").catch(()=>""));return this._buildTitleDivBlock(n,e)}_buildTitleDivBlock(e,t){const n=document.createElement("div");if(n.innerHTML=e.trim(),n.title=escape(t.person.name),n.dataset.testid="person-name-text",n.style.lineHeight=`${t.nameHeight}px`,n.style.fontFamily=le(this.context.globalPageTheme),!A()&&((t.person.name??"").split(/\s+/).reduce((e,t)=>t.length>e.length?t:e,"")||"").length>16){const e=document.createElement("p");e.style.wordBreak="break-all",e.style.margin="0px";const t=n.querySelector("span");t&&e.appendChild(t),n.appendChild(e)}return n}_generateLargeCard(e){const t=this._generatePersonImage(e),n=this._generatePersonDetailsDiv(e);return this._generateLargeCardSkeleton({imageElement:t,detailsDiv:n,linkDescElement:e.person.description?this._generateLinkDescriptionElement(e):""},e)}async _generateLargeCardAsync(e){const t=await this._generatePersonImageAsync(e),n=await this._generatePersonDetailsDivAsync(e);return this._generateLargeCardSkeleton({imageElement:t,detailsDiv:n,linkDescElement:e.person.description?await this._generateLinkDescriptionElementAsync(e):""},e)}_generateLargeCardSkeleton(e,t){const n=e.imageElement,a=this._generateLargeAndMediumCardOuterTable(t),i=document.createElement("tr"),r=document.createElement("td");r.width=`${t.imageNaturalDimensions.width}`,r.height=`${t.imageNaturalDimensions.height}`,r.style.paddingTop=`${t.imagePaddingTop}px`,r.style.paddingBottom=`${t.imagePaddingBottom}px`,r.align="center",r.dataset.testid="person-profile-cell",r.setAttribute("role","presentation"),r.appendChild(n),i.appendChild(r);const o=document.createElement("tr"),s=document.createElement("td"),c=e.detailsDiv;s.appendChild(c),s.style.paddingTop="8px",s.style.paddingBottom="8px",s.align="left",s.height="21",s.dataset.testid="person-name-cell",o.appendChild(s);const d=document.createElement("tr"),l=document.createElement("td");return l.style.minHeight="130px",l.style.verticalAlign="top",l.width="100%",l.dataset.testid="person-desc-cell",Q()?(l.style.display="block",l.style.overflow="hidden",l.style.textOverflow="ellipsis",l.height="130"):(l.style.whiteSpace="normal",l.style.wordBreak="break-word",l.style.paddingBottom="16px"),t.person.description&&e.linkDescElement?l.innerHTML=e.linkDescElement:l.innerHTML="<div></div>",d.appendChild(l),a.appendChild(i),a.appendChild(o),a.appendChild(d),a.outerHTML}_getProfileNameRoleTable(e){const t=this._generatePersonImage(e),n=this._generatePersonDetailsDiv(e);return this._getProfileNameRoleTableSkeleton({personImage:t,detailsElement:n},e)}async _getProfileNameRoleTableAsync(e){const t=await this._generatePersonImageAsync(e),n=await this._generatePersonDetailsDivAsync(e);return this._getProfileNameRoleTableSkeleton({personImage:t,detailsElement:n},e)}_getProfileNameRoleTableSkeleton(e,t){const n=e.personImage,a=document.createElement("table");a.dataset.testid="person-profile-table",t._align&&(a.align=t._align),t._align&&"Center"===t._align||(a.width="100%"),a.border="0",a.cellSpacing="0",a.cellPadding="0",a.style.paddingLeft="0px",a.style.paddingRight=`${t.cardPadding}px`,a.style.paddingTop=`${t.cardPadding}px`,a.style.paddingBottom=`${t.cardPadding}px`;const i=a.insertRow(),r=i.insertCell();r.dataset.testid="person-profile-cell",r.width=`${t.imageNaturalDimensions.width}`,r.height=`${t.imageNaturalDimensions.height}`,r.align="center",r.setAttribute("role","presentation"),r.style.paddingRight=`${t.imagePaddingRight}px`,r.appendChild(n);const o=i.insertCell();o.dataset.testid="person-name-cell",o.height=`${t.nameHeight}`;const s=e.detailsElement;return o.appendChild(s),a.outerHTML}_generatePersonImageProps(e){return{componentName:r.ComponentName.Image,imageUrl:e.personaImageUrl,fallbackImageUrl:e.fallbackImageUrl,width:e.imageNaturalDimensions.width,height:e.imageNaturalDimensions.height,cornerRounding:"circular"}}_generatePersonImage(e){const t=this._generatePersonImageProps(e),n=this.context?.getComponent(r.ComponentName.Image)?.render(t)??"";return this._buildPersonImage(n)}async _generatePersonImageAsync(e){const t=this._generatePersonImageProps(e),n=await(this.context?.getComponent(r.ComponentName.Image)?.executeRender(t).then(e=>e||"").catch(()=>""));return this._buildPersonImage(n)}_buildPersonImage(e){const t=(new DOMParser).parseFromString(e,"text/html").body.firstChild;return t.dataset.testid="person-image",t.align="center",t}constructor(...t){super(...t),this.distribution=e.Email}},class extends jn{render(e){if(!e.people||e.people&&0===e.people.length)return"";const t=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),n=document.createElement("table");n.dataset.testid="people-main-table",n.width="100%",n.border="0",n.cellPadding="0",n.cellSpacing="0",n.align="center",n.style.maxWidth=`${t}px`,!A()&&this.context.endpointDetails?.isMultiColumnSection&&(n.style.margin="0px");for(let a=0;e.people.length>0&&a<e.people.length;a++){const i=document.createElement("tr");i.dataset.testid="people-row",i.style.display="flex",i.style.flexWrap="wrap",i.style.justifyContent="left";const r=this._generatePeopleCell(e.cardLayout,this._renderPeopleCard(e.people[a],e.cardLayout));if(i.appendChild(r),ne(this.context.endpointDetails)&&this.context.endpointDetails?.isMultiColumnSection&&(x()||this.context.endpointDetails?.maxColumnPercentage<=50))n.appendChild(i);else{if(a++,a<e.people.length){const t=this._generatePeopleCell(e.cardLayout,this._renderPeopleCard(e.people[a],e.cardLayout));i.appendChild(t)}else{const n=document.createElement("td");if(ne(this.context.endpointDetails))this._applyPersonCardMultiColumnCellStyle(n,e.cardLayout,t);else{const a=this._getPersonCardCellStyle(e.cardLayout,t);n.style.cssText=a}n.dataset.testid="person-empty-cell",i.appendChild(n)}n.appendChild(i)}}return n.outerHTML}async renderAsync(e){if(!e.people||e.people&&0===e.people.length)return"";const t=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),n=document.createElement("table");n.dataset.testid="people-main-table",n.width="100%",n.border="0",n.cellPadding="0",n.cellSpacing="0",n.align="center",n.style.maxWidth=`${t}px`,!A()&&this.context.endpointDetails?.isMultiColumnSection&&(n.style.margin="0px");for(let a=0;e.people.length>0&&a<e.people.length;a++){const i=document.createElement("tr");i.dataset.testid="people-row",i.style.display="flex",i.style.flexWrap="wrap",i.style.justifyContent="left";const r=this._generatePeopleCell(e.cardLayout,await this._renderPeopleCardAsync(e.people[a],e.cardLayout));if(i.appendChild(r),ne(this.context.endpointDetails)&&this.context.endpointDetails?.isMultiColumnSection&&(x()||this.context.endpointDetails?.maxColumnPercentage<=50))n.appendChild(i);else{if(a++,a<e.people.length){const t=this._generatePeopleCell(e.cardLayout,await this._renderPeopleCardAsync(e.people[a],e.cardLayout));i.appendChild(t)}else{const n=document.createElement("td");if(ne(this.context.endpointDetails))this._applyPersonCardMultiColumnCellStyle(n,e.cardLayout,t);else{const a=this._getPersonCardCellStyle(e.cardLayout,t);n.style.cssText=a}n.dataset.testid="person-empty-cell",i.appendChild(n)}n.appendChild(i)}}return n.outerHTML}_generatePeopleCell(e,t){const n=ne(this.context.endpointDetails)&&this.context.endpointDetails?this.context.endpointDetails.maxColumnWidth:700;if(ne(this.context.endpointDetails)){const a=document.createElement("td"),i="person-card-"+e;return a.dataset.testid=i,this._applyPersonCardMultiColumnCellStyle(a,e,n),a.innerHTML=t,a}{const a=this.context.globalPageTheme.palette.neutralPrimary,i=this._getPersonCardCellStyle(e,n,a),r=this._getCardWidthPerc(e,n),o=document.createElement("td"),s="person-card-"+e;return o.dataset.testid=s,o.style.cssText=i,o.width=`${r}%`,o.innerHTML=t,o}}_renderPeopleCard(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:t},a=this.context?.getComponent(r.ComponentName.PeopleCard)?.render(n);return a.trim()}async _renderPeopleCardAsync(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:t};return(await(this.context?.getComponent(r.ComponentName.PeopleCard)?.executeRender(n).catch(()=>""))).trim()}_applyPersonCardMultiColumnCellStyle(e,t,n,a){const i=this._getCardWidth(t,n),o=this._getCardWidthPerc(t,n);switch(t){case r.CardLayout.LargeCard:case r.CardLayout.MediumCard:L()&&(e.style.padding=c.COL_SPACING_CARD/2+"px"),this._applyPersonCellFlexStyle(e,i);break;case r.CardLayout.SmallCard:default:e.width=`${o}%`,e.style.width=`${o}%`,e.style.color=a??"",e.style.padding=c.MARGIN_ROW_NS/2+"px 0",this._applyPersonCellFlexStyle(e,i)}!A()&&this.context.endpointDetails&&this.context.endpointDetails.maxColumnPercentage>60&&(e.width="50%",e.style.width="50%"),!L()&&this.context.endpointDetails&&(e.style.paddingLeft="0px",e.style.paddingTop="8px",e.style.paddingBottom="8px",e.style.paddingRight=(this.context.endpointDetails.maxColumnPercentage>60?8:c.MARGIN_ROW_NS/2)+"px")}_applyPersonCellFlexStyle(e,t){e.style.flex="45%",e.style.minWidth=this.context.endpointDetails?.isMultiColumnSection?(x()?190:90)+"px":"210px",e.style.maxWidth=`${t}px`}_getPersonCardCellStyle(e,t,n){const a=this._getCardWidth(e,t),i=this._getCardWidthPerc(e,t),o=this._getFlexStyle(a);switch(e){case r.CardLayout.LargeCard:case r.CardLayout.MediumCard:return`padding:${c.COL_SPACING_CARD/2}px; ${o}`;case r.CardLayout.SmallCard:default:return`width:${i}%; ${n?`color:${n};`:""} padding:${c.MARGIN_ROW_NS/2}px 0; ${o}`}}_getFlexStyle(e){return`flex:45%; min-width:210px; max-width:${e}px;`}_getCardWidth(e,t){return ne(this.context.endpointDetails)&&this.context.endpointDetails?.isMultiColumnSection?t-(e===r.CardLayout.SmallCard?0:c.COL_SPACING_CARD):t/2-(e===r.CardLayout.SmallCard?0:c.COL_SPACING_CARD)}_getCardWidthPerc(e,t){const n=this._getCardWidth(e,t);return ne(this.context.endpointDetails)&&this.context.endpointDetails?.isMultiColumnSection?Math.round(100*n/t):e===r.CardLayout.SmallCard?50:Math.round(100*n/t)}constructor(...t){super(...t),this.distribution=e.Email}},class extends Xn{render(e){const{thumbnailLinks:t,cardSize:n,title:a,titleHTML:i}=e;if(!t)return"";const o=n===r.CardLayout.MediumCard?Math.min(t.length,10):t.length;if(0===o)return"";const s=[];for(let e=0;e<o;e++)s.push(this._getLinkCardContent(t[e],n)),e++,e<o&&s.push(this._getLinkCardContent(t[e],n));return this._renderHelper(e,s,this.getTitleContent(i,a,3))}async renderAsync(e){const{thumbnailLinks:t,cardSize:n,title:a,titleHTML:i}=e;if(!t)return"";const o=n===r.CardLayout.MediumCard?Math.min(t.length,10):t.length;if(0===o)return"";const s=[];for(let e=0;e<o;e++)s.push(await this._getLinkCardContentAsync(t[e],n)),e++,e<o&&s.push(await this._getLinkCardContentAsync(t[e],n));return this._renderHelper(e,s,await this.getTitleContentAsync(i,a,3))}_createContentRow(e){const t=document.createElement("tr");return t.classList.add("quicklinks-row"),ye(t,{display:"flex","flex-wrap":"wrap","justify-content":"center","padding-top":`${e}px`,"padding-bottom":`${e}px`}),t}_getContentCell(e,t){const n=document.createElement("td");return n.classList.add("quicklinks-card"),ve(n,{width:"50%"}),ye(n,{padding:`10px ${e===r.CardLayout.MediumCard?15:12}px`,"border-collapse":"collapse",flex:"42%","min-width":"200px","max-width":"280px"}),t&&(n.innerHTML=t),n}_getLinkCardContent(e,t){const n={componentName:r.ComponentName.LinkCard,thumbnailLink:e,cardSize:t};return this.context.getComponent(r.ComponentName.LinkCard)?.render(n)}async _getLinkCardContentAsync(e,t){const n={componentName:r.ComponentName.LinkCard,thumbnailLink:e,cardSize:t};return await(this.context.getComponent(r.ComponentName.LinkCard)?.executeRender(n).catch(()=>""))}_renderHelper(e,t,n){const{thumbnailLinks:a,cardSize:i}=e;if(!a)return"";const o=i===r.CardLayout.MediumCard?Math.min(a.length,10):a.length;if(0===o)return"";const s=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),c=document.createElement("table");if(c.classList.add("quicklinks-main-table"),ve(c,{border:"0",cellpadding:"0",cellspacing:"0",align:"center",width:"100%"}),ye(c,{"max-width":`${s}px`}),n){const e=document.createElement("tr");e.classList.add("quicklinks-title"),ve(e,{width:"100%"}),e.innerHTML=n,c.appendChild(e)}const d=i===r.CardLayout.MediumCard?6.5:5;for(let e=0;e<o;e++){const n=this._createContentRow(d);n.appendChild(this._getContentCell(i,t[e])),e++,e<o?n.appendChild(this._getContentCell(i,t[e])):n.appendChild(this._getContentCell(i)),c.appendChild(n)}return c.outerHTML}constructor(...t){super(...t),this.distribution=e.Email}},class extends aa{render(e){const{personInFocus:t,directsReports:n,managers:a,title:i}=e;if(!t)return"";let o="";if(i){const e={componentName:r.ComponentName.TextBlock,text:i,styles:{fontColor:this.context.localSectionTheme.semanticColors.bodyText,fontWeight:"semi-bold",fontSize:"x-large",lineHeight:"32px"}};o=M()&&i?this.context.getComponent(r.ComponentName.TextBlock)?.render(e):void 0}const s=a?.map(e=>this._getPersonHtml(e,!1)?.outerHTML)??[],c=this._getPersonHtml(t,!1);let d="";if(n&&n.length>0){const e={componentName:r.ComponentName.PeopleLayout,people:n,cardLayout:r.CardLayout.SmallCard};d=this.context.getComponent(r.ComponentName.PeopleLayout)?.render(e)}return this._buildOrgChartBase(e,{titleHtml:o,managerHTMLs:s,personInFocusHtml:c,directsReportsHtml:d})}async renderAsync(e){const{personInFocus:t,directsReports:n,managers:a,title:i}=e;if(!t)return"";let o="";if(i){const e={componentName:r.ComponentName.TextBlock,text:i,styles:{fontColor:this.context.localSectionTheme.semanticColors.bodyText,fontWeight:"semi-bold",fontSize:"x-large",lineHeight:"32px"}};o=M()&&i?await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e)):void 0}const s=[];for(const e of a||[]){const t=(await this._getPersonHtmlAsync(e,!1))?.outerHTML;t&&s.push(t)}const c=await this._getPersonHtmlAsync(t,!1);let d="";if(n&&n.length>0){const e={componentName:r.ComponentName.PeopleLayout,people:n,cardLayout:r.CardLayout.SmallCard};d=await(this.context.getComponent(r.ComponentName.PeopleLayout)?.executeRender(e))}return this._buildOrgChartBase(e,{titleHtml:o,managerHTMLs:s,personInFocusHtml:c,directsReportsHtml:d})}_buildOrgChartBase(e,t){const{personInFocus:n,directsReports:a,managers:i,title:r}=e,{titleHtml:o,managerHTMLs:s,personInFocusHtml:c,directsReportsHtml:d}=t,l=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe();if(!n)return"";const u=document.createElement("table");if(u.className="org-chart-table",u.cellSpacing="0",u.cellPadding="0",u.align="center",M()||(u.style.paddingTop="15px"),u.style.maxWidth=`${l}px`,u.style.color=this.context.localSectionTheme.semanticColors.bodyText,u.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground,u.style.borderRadius="4px",u.width="100%",M()&&r){const e=document.createElement("p");if(e.className="org-title",e.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground,o){e.innerHTML=o;const t=u.insertRow().insertCell();t.style.padding="16px",t.appendChild(e)}u.appendChild(e)}const f=u.insertRow().insertCell();a&&a.length>0?f.style.paddingBottom="":f.style.paddingBottom="16px";const p=document.createElement("table");p.cellSpacing="0",p.cellPadding="0",p.align="center",p.width="50%",p.style.color=this.context.localSectionTheme.semanticColors.bodyText,p.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground,p.style.maxWidth=l/2+"px",i&&i.length>0&&s&&s?.length>0&&s.forEach(e=>{if(e){const t=p.insertRow();t.className="org-manager-row";const n=this._buildPersonHtml(!1,e);n&&(t.appendChild(n),p.appendChild(this._getOrgReportRow()))}});const m=p.insertRow();if(m.className="org-personInFocus-row",c&&(m.appendChild(c),a&&a.length>0&&p.appendChild(this._getOrgReportRow())),f.appendChild(p),a&&a.length>0){if(!h._SPKillSwitch.isActivated("607ca7b0-ffa7-4eef-8c5f-5a85ace582c2")){const e=u.insertRow();e.className="org-reports-summary-row";const t=e.insertCell();t.colSpan=1,t.textContent=$e.StringHelper.format(na.o,n.name,`(${a.length})`),t.style.padding="4px 16px 8px 16px",t.style.fontWeight="bold",t.style.fontSize="14px"}const e=u.insertRow();e.className="org-directs-reports-container-row";const t=e.insertCell();t.style.padding="0 16px";const i=document.createElement("table");i.setAttribute("cellpadding","0"),i.setAttribute("cellspacing","0"),i.style.border=`1px solid ${this.context.localSectionTheme.semanticColors.variantBorder}`,i.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyStandoutBackground,i.style.width="100%",i.style.paddingLeft="6px",i.insertRow().insertCell().innerHTML=d??"",t.appendChild(i)}return u.outerHTML}_getPersonHtml(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.SmallCard},a=this.context.getComponent(r.ComponentName.PeopleCard)?.render(n);if(a)return this._buildPersonHtml(t,a)}async _getPersonHtmlAsync(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.SmallCard},a=await(this.context.getComponent(r.ComponentName.PeopleCard)?.executeRender(n));if(a)return this._buildPersonHtml(t,a)}_buildPersonHtml(e,t){const n=e?50:100,a=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe(!1),i=document.createElement("td");if(i.style.width=`${n}%`,i.style.padding="6px",i.style.borderRadius="4px",e?(i.style.flex="45%",i.style.minWidth="210px",i.style.maxWidth=a/2+"px",i.style.boxSizing="border-box",i.style.border="1px solid transparent",i.colSpan=2,i.align="center"):(i.style.minWidth=a/2+"px",i.style.border=`1px solid ${this.context.localSectionTheme.semanticColors.variantBorder}`,i.style.background="none transparent"),t)return i.innerHTML=t,i}_getOrgReportRow(){const e=document.createElement("tr"),t=document.createElement("td");t.className="org-report-link";const n=document.createElement("div");return n.style.width="1px",n.style.height="12px",n.style.paddingLeft="50%",n.style.borderRight=`1px solid ${this.context.localSectionTheme.semanticColors.variantBorder}`,n.style.boxSizing="border-box",t.appendChild(n),e.appendChild(t),e}constructor(...t){super(...t),this.distribution=e.Email}},class extends ra{render(e){const{description:t,button:n,image:a,descriptionHTML:i}=e;if(this._shouldSkipRendering(t,n))return"";const r=Oe(),o=this._createWrapperTable(r);return a&&o.appendChild(this._createImageCell(a,r)),(t||i)&&o.appendChild(this._createDescriptionCell(t||"",i,n.align)),n&&(0!==n.link.url.length||n.link.title?.length)&&o.appendChild(this._createButtonCell(n)),o.outerHTML}async preRender(e){await super.preRender(e),$()||"focalPoint"!==e.image?.cropWindow?.type||(this._imageMetaData=await this.context.getImageMetaData(e.image?.source.url??""))}async renderAsync(e){const{description:t,button:n,image:a,descriptionHTML:i}=e;if(this._shouldSkipRendering(t,n))return"";const r=Oe(),o=this._createWrapperTable(r);return a&&o.appendChild(await this._createImageCellAsync(a,r)),(t||i)&&o.appendChild(await this._createDescriptionCellAsync(t||"",i,n.align)),n&&(0!==n.link.url.length||n.link.title?.length)&&o.appendChild(await this._createButtonCellAsync(n)),o.outerHTML}_createWrapperTable(e){const t=document.createElement("table");return t.setAttribute("align","center"),t.setAttribute("width","100%"),t.style.maxWidth=`${e}px`,t.setAttribute("data-testid","callToAction-root-table"),t}_getButtonProps(e){const t={...e,link:{...e.link}};return""===t.link.url||t.link.title&&""!==t.link.title||(t.link.title=ia.h),{componentName:r.ComponentName.Button,button:t}}_buildButtonElement(e){const t=document.createElement("tr"),n=document.createElement("td");return n.setAttribute("data-testid","callToAction-button-cell"),n.style.textAlign="left",n.innerHTML=e,t.appendChild(n),t}_createButtonCell(e){const t=this._getButtonProps(e),n=this.context.getComponent(r.ComponentName.Button)?.render(t);return this._buildButtonElement(n)}async _createButtonCellAsync(e){const t=this._getButtonProps(e),n=await(this.context.getComponent(r.ComponentName.Button)?.executeRender(t));return this._buildButtonElement(n)}_getDescriptionProps(e,t,n){return n&&t?{componentName:r.ComponentName.RichText,input:t,format:"Html"}:{componentName:r.ComponentName.TextBlock,text:e,styles:{fontSize:"large",fontWeight:"semi-bold",fontColor:this.context.localSectionTheme.palette.neutralPrimary}}}_buildDescriptionElement(e,t){const n=document.createElement("tr"),a=document.createElement("td");a.setAttribute("data-testid","callToAction-description-cell"),a.style.textAlign="left";const i=document.createElement("table");i.style.margin="Left"===t?"auto auto auto 0":"Right"===t?"auto 0 auto auto":"auto",i.style.padding="0",i.style.borderSpacing="0",i.style.borderCollapse="collapse",i.style.width="unset",i.setAttribute("cellpadding","0"),i.setAttribute("cellspacing","0"),i.setAttribute("border","0"),i.setAttribute("align",t?.toLowerCase()??"center");const r=document.createElement("tr");r.style.padding="0",r.style.margin="0";const o=document.createElement("td");o.style.margin="0",o.style.padding="0px 0px 8px",o.innerHTML=e;const s=o.getElementsByTagName("span")[0];return s&&(s.style.lineHeight="27px",s.style.display="inline-block",s.style.verticalAlign="middle"),r.appendChild(o),i.appendChild(r),a.appendChild(i),n.appendChild(a),n}_createDescriptionCell(e,t,n){const a=oe()&&!!t,i=this._getDescriptionProps(e,t,a),o=this.context.getComponent(a?r.ComponentName.RichText:r.ComponentName.TextBlock)?.render(i);return this._buildDescriptionElement(o,n)}async _createDescriptionCellAsync(e,t,n){const a=oe()&&!!t,i=this._getDescriptionProps(e,t,a),o=await(this.context.getComponent(a?r.ComponentName.RichText:r.ComponentName.TextBlock)?.executeRender(i));return this._buildDescriptionElement(o,n)}_getImageProps(e,t){return{componentName:r.ComponentName.Image,imageUrl:e.source.url??"",altText:e.alternateText??"",width:t,height:140,originalWidth:$()||"focalPoint"!==e.cropWindow?.type?void 0:this._imageMetaData?.width,originalHeight:$()||"focalPoint"!==e.cropWindow?.type?void 0:this._imageMetaData?.height,cropMode:"fill",cornerRounding:"all",_focalX:"focalPoint"===e.cropWindow?.type?e.cropWindow.focalPoint.offsetTop:void 0,_focalY:"focalPoint"===e.cropWindow?.type?e.cropWindow.focalPoint.offsetLeft:void 0,_sharepointIds:e.source.sharepointIds}}_buildImageElement(e){const t=document.createElement("tr"),n=document.createElement("td");return n.style.paddingBottom="8px",n.setAttribute("data-testid","callToAction-image-cell"),n.innerHTML=e,t.appendChild(n),t}_createImageCell(e,t){const n=this._getImageProps(e,t),a=this.context.getComponent(r.ComponentName.Image)?.render(n);return this._buildImageElement(a)}async _createImageCellAsync(e,t){const n=this._getImageProps(e,t),a=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(n));return this._buildImageElement(a)}constructor(...t){super(...t),this.distribution=e.Email}},class extends oa{render(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n},i=a?this.context.getComponent(r.ComponentName.TextBlock)?.render(a):void 0;return this._getRenderHelper(e,i)}async renderAsync(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n},i=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""));return this._getRenderHelper(e,i)}_getRenderHelper(e,t){const{backgroundColor:n,borderRadius:a,textStyles:i,align:o}=e,s=this._getPillColors(n);let c=0;i&&i.fontSize&&(c=(0,r.fontSizeToPixel)(i.fontSize),i.fontSize=void 0);const d=document.createElement("table");d.setAttribute("align",o?o.toLowerCase():"left");const l=document.createElement("td");l.setAttribute("width","100%"),l.style.lineHeight="24px",s.textColor&&(l.style.color=s.textColor);const u=document.createElement("div");u.setAttribute("data-testid","email-text-pill"),u.style.height="24px",u.style.borderWidth="4px 12px",u.style.borderStyle="solid",u.style.boxSizing="border-box",u.style.lineHeight="24px",u.style.display="flex",u.style.justifyContent="center",a&&(u.style.borderRadius=`${a}px`),u.style.backgroundColor=`${s.pillBackgroundColor}`,u.style.borderColor=`${s.pillBackgroundColor}`,u.style.setProperty("color",s.textColor,"important"),u.style.letterSpacing="1px",u.style.fontSize=`${c}px`,u.style.textOverflow="ellipsis",u.style.whiteSpace="nowrap",u.style.overflow="hidden",u.style.maxWidth="294px",u.style.alignItems="center",u.innerHTML=t??"",l.appendChild(u);const f=document.createElement("tr");return f.appendChild(l),d.appendChild(f),d.outerHTML}_getPillColors(e){let t="",n="";switch(e){case"accent":t=this.context.globalPageTheme.palette.accent,n=this.context.globalPageTheme.palette.white;break;case"themePrimary":t=this.context.localSectionTheme.palette.themePrimary,n=this.context.localSectionTheme.semanticColors.buttonText;break;case"themeSecondary":t=this.context.localSectionTheme.palette.themeSecondary,n=this.context.localSectionTheme.semanticColors.buttonText}return{pillBackgroundColor:t,textColor:n}}constructor(...t){super(...t),this.distribution=e.Email}},class extends ea{async renderAsync(e){const{showMoreLink:t,images:n,layout:a}=e,i=this._createImageGalleryTable(),o=[];if("Grid"===a){for(const e of n){const t=this._buildImageProps(e,ta,ta),n=await this._renderImageAsync(t);n?.length>0&&o.push(n)}this._appendGridLayoutImageRows(i,o)}else{const e=this._createSingleLayoutImageRow(),t=e.cells[0],a=this._buildImageProps(n[0],Oe()),r=await this._renderImageAsync(a);if(!r||0===r.length)return"";t.innerHTML=r,i.appendChild(e)}if(t)if(T()){const e=this._createSeeAllAnchorRow(t,n.length);i.appendChild(e)}else{const e={componentName:r.ComponentName.Button,button:{link:{title:$e.StringHelper.format($n.n,n.length),url:b()?t:nt(t)},align:"Right",hasBorder:!0,hasBorderRadius:!0,hasBoxShadow:!0,backgroundColor:"theme"}},a=await(this.context.getComponent(r.ComponentName.Button)?.executeRender(e)),o=this._createSeeAllButtonRow(a);i.appendChild(o)}return i.outerHTML}render(e){const{showMoreLink:t,images:n,layout:a}=e;if(!n.length||0===n.length)return"";const i=this._createImageGalleryTable();if("Grid"===a){const e=[];n.forEach(t=>{const n={componentName:r.ComponentName.Image,imageUrl:t.source.url??"",altText:t.alternateText,width:ta,height:ta,cornerRounding:"all",cropMode:"fill",_sharepointIds:t.source.sharepointIds};if(n.imageUrl){const t=this.context.getComponent(r.ComponentName.Image)?.render(n);t&&e.push(t)}}),this._appendGridLayoutImageRows(i,e)}else{const e=this._createSingleLayoutImageRow(),t=e.cells[0],a={componentName:r.ComponentName.Image,imageUrl:n[0].source.url??"",altText:n[0].alternateText,width:Oe(),cornerRounding:"all",cropMode:"fill",_sharepointIds:n[0].source.sharepointIds},o=this.context.getComponent(r.ComponentName.Image)?.render(a);o&&(t.innerHTML=o,i.appendChild(e))}if(t)if(T()){const e=this._createSeeAllAnchorRow(t,n.length);i.appendChild(e)}else{const e={componentName:r.ComponentName.Button,button:{link:{title:$e.StringHelper.format($n.n,n.length),url:b()?t:nt(t)},align:"Right",hasBorder:!0,hasBorderRadius:!0,hasBoxShadow:!0,backgroundColor:"theme"}},a=this.context.getComponent(r.ComponentName.Button)?.render(e),o=this._createSeeAllButtonRow(a);i.appendChild(o)}return i.outerHTML}_createEmptyCell(){const e=document.createElement("td");return h._SPKillSwitch.isActivated("5ef04176-d71e-4952-9af6-746ae6168571")?e.style.paddingRight="20px":(e.style.paddingLeft="10px",e.style.paddingRight="10px"),e.style.paddingBottom="20px",e.style.maxWidth=Oe()/3+"px",e.width="33%",e}_createEmptyRow(){const e=document.createElement("tr");return e.style.paddingTop="6.5px",e.style.paddingBottom="6.5px",e}_createImageGalleryTable(){const e=document.createElement("table");e.style.maxWidth=ne(this.context.endpointDetails)?`${Oe(!1,this.context.endpointDetails)}px`:`${Oe()}px`,e.align="center",e.width="100%";const t=document.createElement("tr");return e.appendChild(t),e}_appendGridLayoutImageRows(e,t){if(0!==t.length)for(let n=0;n<6;n+=3){const a=this._createEmptyRow();for(let e=0;e<3;e++){const i=n+e;if(i<t.length){const e=this._createEmptyCell();e.innerHTML=t[i],a.appendChild(e)}}if(a.children.length<3){const e=3-a.children.length;for(let t=0;t<e;t++){const e=this._createEmptyCell();a.appendChild(e)}}e.appendChild(a)}}_createSingleLayoutImageRow(){const e=this._createEmptyRow(),t=e.insertCell();return t.style.maxHeight=`${Oe()}px`,t.style.paddingBottom="20px",t.width="100%",e}_createSeeAllButtonRow(e){const t=this._createEmptyRow(),n=document.createElement("td");n.colSpan=3,n.width="100%",n.style.paddingBottom="20px",n.innerHTML=e;const a=n.querySelector("table");return a&&a.style.removeProperty("border-collapse"),t.appendChild(n),t}_createSeeAllAnchorRow(e,t){const n=this._createEmptyRow(),a=document.createElement("td");a.style.paddingBottom="20px",a.width="100%",a.colSpan=3;const i=document.createElement("div");i.style.textAlign="right",i.style.padding="4px";const r=document.createElement("a");r.href=b()?e:nt(e),r.style.border=`1px solid ${this.context.localSectionTheme.semanticColors.bodyDivider}`,r.style.borderRadius="4px",r.style.boxShadow="0px 0.6px 1.8px rgba(0, 0, 0, 0.1), 0px 3.2px 7.2px rgba(0, 0, 0, 0.13)",r.style.padding="8px 12px",r.style.textDecoration="none",r.style.fontSize="16px",r.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),r.style.lineHeight="16px";const o=document.createElement("div");return o.style.textAlign="center",o.style.verticalAlign="middle",o.style.display="table-cell",o.innerHTML=$e.StringHelper.format($n.n,t),r.appendChild(o),i.appendChild(r),a.appendChild(i),n.appendChild(a),n}_buildImageProps(e,t,n){return{componentName:r.ComponentName.Image,imageUrl:e.source?.url??"",altText:e.alternateText,width:t,height:n,cornerRounding:"all",cropMode:"fill",_sharepointIds:e.source?.sharepointIds}}async _renderImageAsync(e){return e.imageUrl?await this.context.getComponent(r.ComponentName.Image)?.executeRender(e).catch(e=>(this.context.addError?.([{error:e,errorMessage:"Unexpected error during component execution",errorType:$e.ResultTypeEnum.Failure,componentName:this.componentName}]),"")):""}constructor(...t){super(...t),this.distribution=e.Email}},class extends sa{render(e){const{textAlignment:t,_isCustomFullWidth:n}=e,a=Oe(n),i=t??"Left",r=this._extractAuthor(e.authors),o=this._createStyles(),s=this._renderContentElements(e,r,o),c=this._createRootTable(a,n);return this._appendContentToTable(c,s,i,n),c.outerHTML}async renderAsync(e){const{textAlignment:t,_isCustomFullWidth:n}=e,a=Oe(n),i=t??"Left",r=this._extractAuthor(e.authors),o=this._createStyles(),s=await this._renderContentElementsAsync(e,r,o),c=this._createRootTable(a,n);return this._appendContentToTable(c,s,i,n),c.outerHTML}_extractAuthor(e){if(e&&e.length>0){const{email:t,name:n,role:a,aadObjectId:i}=e[0];return{name:n,email:t,aadObjectId:i,role:a}}}_createStyles(){const e={fontSize:"xx-large",lineHeight:"40px"};return h._SPKillSwitch.isActivated("afaf03eb-ff00-4068-a0a5-b46a0746eecb")||(e.fontColor=this.context.localSectionTheme.palette.black),{titleStyles:e,textAboveTitleStyles:{fontSize:"x-small",fontWeight:"semi-bold",overflow:"hidden",textOverflow:"ellipsis",lineHeight:"16px"}}}_renderContentElements(e,t,n){const{title:a,thumbnail:i,header:r,showHeader:o,textAlignment:s,layout:c,titleHtml:d}=e,l=s??"Left";return{imageContent:this._renderImage(i,c),topicHeaderContent:this._renderTopicHeader(r,o,l,n.textAboveTitleStyles),titleContent:this._renderTitle(d,a,n.titleStyles),authorContent:this._renderAuthor(t,s)}}async _renderContentElementsAsync(e,t,n){const{title:a,thumbnail:i,header:r,showHeader:o,textAlignment:s,layout:c,titleHtml:d}=e,l=s??"Left";return{imageContent:await this._renderImageAsync(i,c),topicHeaderContent:await this._renderTopicHeaderAsync(r,o,l,n.textAboveTitleStyles),titleContent:await this._renderTitleAsync(d,a,n.titleStyles),authorContent:await this._renderAuthorAsync(t,s)}}_renderImage(e,t){if(!Re(e))return"";const n=this._createImageComponent(e,t);return this.context.getComponent(r.ComponentName.Image)?.render(n)}async _renderImageAsync(e,t){if(h._SPKillSwitch.isActivated("d994964e-cf8e-4552-ae23-8879b43a0454")?!e:!Re(e))return"";const n=this._createImageComponent(e,t);return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(n).catch(()=>""))}_renderTopicHeader(e,t,n,a){if(!t||!e)return"";const i={componentName:r.ComponentName.TextPill,text:e.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:a,align:n??"left"};return this.context.getComponent(r.ComponentName.TextPill)?.render(i)}async _renderTopicHeaderAsync(e,t,n,a){if(!t||!e)return"";const i={componentName:r.ComponentName.TextPill,text:e.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:a,align:n??"left"};return await(this.context.getComponent(r.ComponentName.TextPill)?.executeRender(i).catch(()=>""))}_renderTitle(e,t,n){if(oe()&&e)return this._getTitleHTMLContent(e);if(!t)return"";const a={componentName:r.ComponentName.TextBlock,text:t,headerLevel:1,styles:n};return this.context.getComponent(r.ComponentName.TextBlock)?.render(a)}_getTitleHTMLContent(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return this.context.getComponent(r.ComponentName.RichText)?.render(t)}async _renderTitleAsync(e,t,n){if(oe()&&e)return await this._renderHTMLTitleAsync(e);if(!t)return"";const a={componentName:r.ComponentName.TextBlock,text:t,headerLevel:1,styles:n};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""))}async _renderHTMLTitleAsync(e){if(!e)return"";const t={componentName:r.ComponentName.RichText,input:e,format:"Html"};return await(this.context.getComponent(r.ComponentName.RichText)?.executeRender(t).catch(()=>""))}_renderAuthor(e,t){if(!e)return"";const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.ExtraSmallCard,_align:t};return this.context.getComponent(r.ComponentName.PeopleCard)?.render(n)}async _renderAuthorAsync(e,t){if(!e)return"";const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:r.CardLayout.ExtraSmallCard,_align:t};return await(this.context.getComponent(r.ComponentName.PeopleCard)?.executeRender(n).catch(()=>""))}_createRootTable(e,t){const n=document.createElement("table");return n.setAttribute("data-testid","banner-root-table"),n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","0"),n.setAttribute("align","center"),n.setAttribute("width","100%"),h._SPKillSwitch.isActivated("e690e299-36e6-4bb1-9847-61b93c5f8801")||(n.style.backgroundColor=this.context.localSectionTheme.semanticColors.bodyBackground??""),n.style.maxWidth=`${e}px`,t&&(n.style.padding="0px"),n}_appendContentToTable(e,t,n,a){const{imageContent:i,topicHeaderContent:r,titleContent:o,authorContent:s}=t;if(i){const t=document.createElement("tr"),n=document.createElement("td");n.innerHTML=i,t.appendChild(n),e.appendChild(t)}if(o||s||r){const t=document.createElement("tr"),n=document.createElement("td");n.style.width="100%",n.style.padding="0px 15px 15px 15px",t.appendChild(n),e.appendChild(t)}if(r){const t=document.createElement("tr"),n=document.createElement("td");n.setAttribute("width","100%"),n.setAttribute("data-testid","topic-header"),a&&(n.style.padding=ca),n.innerHTML=r,t.appendChild(n),e.appendChild(t)}if(o){const t=document.createElement("tr"),i=document.createElement("td");i.setAttribute("data-testid","banner-title"),i.width="100%",i.align=n,a&&(i.style.padding=ca),i.innerHTML=o,t.appendChild(i),e.appendChild(t)}if(s){const t=document.createElement("tr"),i=document.createElement("td");i.setAttribute("data-testid","banner-author"),i.align=n,a&&(i.style.padding=ca),i.innerHTML=s,t.appendChild(i),e.appendChild(t)}}_getImageHeight(e){return e&&"Tall"===e?200:140}_createImageComponent(e,t){const n={componentName:r.ComponentName.Image,originalWidth:e?.originalDimensions?.width,originalHeight:e?.originalDimensions?.height,imageUrl:e?.source.url??"",width:740,height:this._getImageHeight(t),cropMode:"fill",additionalStyles:{width:"100%"}};return"focalPoint"===e?.cropWindow?.type&&(n._focalX=e?.cropWindow?.focalPoint.offsetLeft,n._focalY=e?.cropWindow?.focalPoint.offsetTop),e?.source?.sharepointIds?.siteId&&e.source.sharepointIds.webId&&e.source.sharepointIds.uniqueId&&(n._sharepointIds={siteId:e.source.sharepointIds.siteId,webId:e.source.sharepointIds.webId,listId:e.source.sharepointIds.listId,uniqueId:e.source.sharepointIds.uniqueId}),n}constructor(...t){super(...t),this.distribution=e.Email}},class extends da{render(e){const t=this._createBannerComponent(e);return this.context.getComponent(r.ComponentName.Banner)?.render(t)??""}async renderAsync(e){const t=this._createBannerComponent(e);return await(this.context.getComponent(r.ComponentName.Banner)?.executeRender(t).catch(()=>""))}_createBannerComponent(e){const{title:t,authors:n,thumbnail:a,header:i,showHeader:o,textAlignment:s,layout:c,titleHtml:d}=e;return{componentName:r.ComponentName.Banner,title:t,titleHtml:d,authors:n,thumbnail:a,header:i,showHeader:o,textAlignment:s,layout:c,_isCustomFullWidth:!0}}constructor(...t){super(...t),this.distribution=e.Email}},class extends ua{render(e){const{htmlContent:t,ck4InlineImages:n,parentClass:a,childClass:i,inlineImages:r}=e;let o=t;if(n&&n.size>0&&(o=this._processCK4Images(o,n)),o=this._fixLinks(this.processImages(o,r))??"",!o)return"";o=this._convertRTETablesForTranspile(o),o=ne(this.context.endpointDetails)?Le(o,this.context.endpointDetails):Ae(o),o=h._SPKillSwitch.isActivated("c900bcbb-d346-4deb-9ac8-24d43db6f627")?o:this._addHeaderPadding(o),o=h._SPKillSwitch.isActivated("1aaf6ee5-5756-4416-b21d-8203c73453e4")?o:this._fixBlockQuotesForMSO(o);const s=document.createElement("div");s.className=a;const c=document.createElement("div");return c.className=i,c.style.fontSize="16px",c.style.cssText+=`${le(this.context.globalPageTheme)} word-break:break-word;`,c.innerHTML=o,s.appendChild(c),s.outerHTML}async preRender(e){if(await super.preRender(e),!e.parentClass)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("parentClass is expected to be set"));if(!e.childClass)throw this.createCustomError("Expected property is missing",$e.ResultTypeEnum.ExpectedFailure,new Error("childClass is expected to be set"))}async renderAsync(e){this._processedHtmlContent=this._convertRTETablesForTranspile(this._processedHtmlContent),this._processedHtmlContent=ne(this.context.endpointDetails)?Le(this._processedHtmlContent,this.context.endpointDetails):Ae(this._processedHtmlContent),this._processedHtmlContent=this._addHeaderPadding(this._processedHtmlContent),this._processedHtmlContent=this._fixBlockQuotesForMSO(this._processedHtmlContent);const t=document.createElement("div");t.className=e.parentClass;const n=document.createElement("div");return n.className=e.childClass,n.style.fontSize="16px",n.style.cssText+=`${le(this.context.globalPageTheme)} word-break:break-word;`,n.innerHTML=this._processedHtmlContent,t.appendChild(n),t.outerHTML}async processImagesAsync(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelectorAll(this._imageClass);for(const e of Array.from(a)){const a=e.querySelector(this._imageTag);if(!a)continue;const i=this._prepareImageComponent(a,e,t);if(!i)continue;const o=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(i.component).catch(()=>""));o&&this._renderImage(n,e,o,i)}return n.body.innerHTML}processImages(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html");return n.querySelectorAll(this._imageClass).forEach(e=>{const a=e.querySelector(this._imageTag);if(!a)return;const i=this._prepareImageComponent(a,e,t);if(!i)return;const o=this.context.getComponent(r.ComponentName.Image)?.render(i.component);this._renderImage(n,e,o,i)}),n.body.innerHTML}_prepareImageComponent(e,t,n){const a=this.extractImageProp(e,n);if(t.removeChild(e),!a)return;const{source:{url:i,sharepointIds:o},tableWidth:s,widthPercent:c,naturalHeight:d,naturalWidth:l,aspectRatio:u,colWidth:f,isImageShape:p,link:m,overlay:_,width:h,height:b,alignment:g,caption:v,altText:y}=a;if(!i)return;let S=h,I=b;S=f*c/100,S=Math.round(Math.min(f-(p&&f===s?140:0),Math.max(S,50))),I=Math.round(u*S);const x={componentName:r.ComponentName.Image,imageUrl:i,width:S,originalHeight:d,originalWidth:l,cornerRounding:"all",altText:y,additionalStyles:{height:`${I}px`}};if(m&&(x.linkUrl=m),ae()){const e=new xn(i),t=be.ExtensionHelper.getExtension(e.value)||"";x.cornerRounding=(0,r.getImageFileTypeFromExtension)(t)===r.ImageFileType.Gif?void 0:x.cornerRounding}return D()||(x._sharepointIds=o),{component:x,imageWidth:S,alignment:g,caption:v,overlay:_}}_renderImage(e,t,n,a){if(!n)return;const i=e.createElement("span");i.innerHTML=n,this._createInlineImage(e,t,i,a.imageWidth,a.alignment,a.caption,a.overlay)}_createInlineImage(e,t,n,a,i,r,o){const s=e.createElement("div");let c;t.appendChild(s),s.setAttribute("align",i?.toLowerCase()||"center");const d=this._createTableElementForImageOverlay(e,a);if(o?.text&&o?.styles){const e=o.styles,t=Te(this.context.localSectionTheme,o.text,e,!0);d.prepend(t),s.appendChild(d)}if(r){c=e.createElement("div"),c.innerText=r,h._SPKillSwitch.isActivated("05c3f8d4-58e1-4d86-b941-e9ba2c65b30e")&&(c.innerHTML=r);const a="imgCaption";c.setAttribute("id",a),c.style.textAlign="center",c.style.fontSize="14px",c.style.fontWeight="normal";const i=e.createElement("tr"),o=e.createElement("td");i.style.setProperty("border","none","important"),i.style.padding="0",o.style.setProperty("border","none","important"),o.style.padding="0",o.insertAdjacentHTML("beforeend",n.innerHTML),i.appendChild(o),d.appendChild(i);const s=e.createElement("tr"),l=e.createElement("td");if(s.style.setProperty("border","none","important"),s.style.padding="0",l.style.setProperty("border","none","important"),l.style.padding="0",l.style.textAlign="center",c.outerHTML){const t=e.createElement("div");t.innerHTML=ne(this.context.endpointDetails)?Le(c.outerHTML,this.context.endpointDetails):Ae(c.outerHTML),l.appendChild(t)}else l.appendChild(c);s.appendChild(l),d.appendChild(s),t.setAttribute("role","figure"),t.setAttribute("aria-labelledby",a)}else n.setAttribute("role","presentation"),s.insertAdjacentHTML("beforeend",n.innerHTML);c&&s.appendChild(d)}_createTableElementForImageOverlay(e,t){const n=e.createElement("table");return n.style.padding="0",n.cellPadding="0",n.cellSpacing="0",n.style.textAlign="center",n.style.tableLayout="fixed",n.style.width="100%",n.style.setProperty("border","none","important"),n.style.maxWidth=`${t}`,n}_convertRTETablesForTranspile(e){const t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("table");return n.forEach(e=>{this._applyTableColumnWidthInlineStyle(e)}),n.forEach(e=>{this._removePastedTableStyles(e)}),t.querySelectorAll('figure[title="Table"]').forEach(e=>{e.style.width&&"100%"!==e.style.width&&e.style.removeProperty("width"),!h._SPKillSwitch.isActivated("bfbc7bcd-8690-4622-b08f-8fa141b55e0e")&&ne(this.context.endpointDetails)&&this.context.endpointDetails&&(e.style.setProperty("width","100%"),e.style.setProperty("max-width",`${this.context.endpointDetails.maxColumnWidth}px`))}),t.body.innerHTML}_applyTableColumnWidthInlineStyle(e){const t=this._getTableColumnWidthList(e);if(e.getAttribute("class")?.includes("ck-table-resized")){const n=e.querySelector("tr");n&&Array.from(n.cells).forEach((e,n)=>{n<t.length&&(e.style.width=`${t[n]}%`)})}}_getTableColumnWidthList(e){const t=[],n=e.querySelector("colgroup");return n&&n.querySelectorAll("col").forEach(e=>{const n=e.getAttribute("style")?.match(/width:(\d+(\.\d+)?)%/)?.[1]??"0";t.push(parseFloat(n))}),t}_removePastedTableStyles(e){const t=e.querySelectorAll("th"),n=e.querySelectorAll("td");t.forEach(e=>{this._removePastedCellStyleHelper(e)}),n.forEach(e=>{this._removePastedCellStyleHelper(e)})}_removePastedCellStyleHelper(e){e.style.removeProperty("border-left-color"),e.style.removeProperty("border-right-color"),e.style.removeProperty("border-top-color"),e.style.removeProperty("border-bottom-color"),e.style.removeProperty("border-left-width"),e.style.removeProperty("border-right-width")}_addHeaderPadding(e){const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(e=>{const n=t.createElement("p");n.style.lineHeight="1",n.innerHTML="&nbsp;";const a=e.nextSibling;a&&e.parentNode?.insertBefore(n,a)}),t.body.innerHTML}_fixBlockQuotesForMSO(e){const t=(new DOMParser).parseFromString(e,"text/html");return t.querySelectorAll("blockquote:not(.semanticQuote)").forEach(e=>{let n="center";const a=e.className||"";a.includes("floatRight")?n="right":a.includes("floatLeft")&&(n="left");const i=t.createElement("div"),r=e.cloneNode(!0),o=e.cloneNode(!0);o.style.borderTop||(o.style.borderTop=`1px solid ${this.context.localSectionTheme?.palette?.neutralLighter}`),o.style.borderBottom||(o.style.borderBottom=`1px solid ${this.context.localSectionTheme?.palette?.neutralLighter}`),o.style.borderLeft||(o.style.borderLeft="none"),o.style.borderRight||(o.style.borderRight="none"),o.style.margin||(o.style.margin="28px 0"),o.style.padding||(o.style.padding="32px");const s=o.querySelector("p");s&&(s.style.textAlign=n,s.style.fontStyle="italic",s.style.fontWeight="600",s.style.lineHeight="130%"),i.innerHTML=`\x3c!--[if !mso]>\x3c!--\x3e${r.outerHTML}\x3c!--<![endif]--\x3e\x3c!--[if mso]>${o.outerHTML}<![endif]--\x3e`,e.parentNode?.replaceChild(i,e)}),t.body.innerHTML}constructor(...t){super(...t),this.distribution=e.Email,this._containerType="span"}},class extends Ia{render(e){const t=this._generateImageProps(e),n=this.context.getComponent(r.ComponentName.Image)?.render(t)??"";return this._getScreenshotElement(e,n)}async renderAsync(e){const t=this._generateImageProps(e),n=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(t));return this._getScreenshotElement(e,n)}_generateImageProps(e){return{componentName:r.ComponentName.Image,imageUrl:e.url,width:Oe(!0,this.context.endpointDetails),altText:e.altText,_skipThumbnailRequest:!0,additionalStyles:{width:"100%"}}}_getScreenshotElement(e,t){const n=document.createElement("table");n.setAttribute("data-testid","link-root-table"),n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","0"),n.setAttribute("align","center"),n.setAttribute("width","100%");const a=document.createElement("tr"),i=document.createElement("td");if(e.link){const n=document.createElement("a");n.href=F()?e.link.url:nt(e.link.url),n.setAttribute("target","_blank"),n.setAttribute("rel","noopener noreferrer"),n.innerHTML=t,i.innerHTML=n.outerHTML}else i.innerHTML=t;if(e.altText){const t=document.createElement("div");if(t.style.visibility="hidden",t.setAttribute("width","0"),t.setAttribute("height","0"),t.style.width="0px",t.style.height="0px",t.style.fontSize="0px",t.style.color=this.context.localSectionTheme.semanticColors.bodyBackground,t.setAttribute("tabindex","-1"),t.setAttribute("aria-hidden","true"),t.innerText=e.altText||"",h._SPKillSwitch.isActivated("ead6bbc9-4326-449b-a3d0-3d7aa52bc2e7"))i.appendChild(t);else{const e=`\x3c!--[if !mso]>\x3c!--\x3e${t.outerHTML}\x3c!--<![endif]--\x3e`;i.insertAdjacentHTML("beforeend",e)}}return a.appendChild(i),n.appendChild(a),n.outerHTML}constructor(...e){super(...e),this.distribution=xa.Email}},class extends Oa{render(e){const{cardSize:t,previewArea:n,topic:a,title:i,description:r,callToActions:o}=e,s={previewElement:this._getPreviewArea(n,t,{imageContent:this._getImageContent(n,t),videoUnfurl:this._getVideo(n),previewContent:this._getPreviewText(n,t)}),topicElement:this._getTopicElement(a),titleElement:this._getTitleElement(i,t),descriptionElement:this._getDescriptionElement(r),callToActionElements:this._getCallToActionElements(o)};return this._createInfoCard(s,t)}async renderAsync(e){const{cardSize:t,previewArea:n,topic:a,title:i,description:r,callToActions:o}=e,s={previewElement:this._getPreviewArea(n,t,{imageContent:await this._getImageContentAsync(n,t),videoUnfurl:await this._getVideoAsync(n),previewContent:await this._getPreviewTextAsync(n,t)}),topicElement:await this._getTopicElementAsync(a),titleElement:await this._getTitleElementAsync(i,t),descriptionElement:await this._getDescriptionElementAsync(r),callToActionElements:await this._getCallToActionElementsAsync(o)};return this._createInfoCard(s,t)}_createInfoCard(e,t){const n=t===r.CardLayout.MediumCard?this._createMediumInfoCardTable(e):this._createLargelInfoCardTable(e);return n?n.outerHTML:""}_createMediumInfoCardTable(e){const t=this._createBaseTableForInfoCard(),n=t.insertRow();n.setAttribute("data-testid","info-medium-card-main-row"),n.style.margin="0",n.style.padding="0",e.previewElement&&n.appendChild(e.previewElement);const a=n.insertCell();a.setAttribute("data-testid","info-medium-card-content-column"),a.width=e.previewElement?"67%":"100%",a.setAttribute("width",e.previewElement?"67%":"100%"),a.setAttribute("valign","top"),a.setAttribute("align","left"),a.style.textAlign="left",a.style.verticalAlign="top",a.style.padding=e.previewElement?"0 0 0 16px":"0",a.style.margin="0";const i=document.createElement("table");if(i.setAttribute("data-testid","info-medium-card-content-table"),i.width="100%",i.border="0",i.cellPadding="0",i.cellSpacing="0",i.style.paddingTop="8",i.setAttribute("cellPadding","0"),i.setAttribute("cellSpacing","0"),i.setAttribute("border","0"),V()){this._appendRow(i,e.topicElement),this._appendRow(i,e.titleElement),this._appendRow(i,e.descriptionElement);const t=!!e.topicElement||!!e.titleElement||!!e.descriptionElement;e.callToActionElements?.forEach((e,n)=>{0===n&&t&&(e.style.padding="8px 0 0 0"),this._appendRow(i,e)})}else this._appendContentElements(i,e);return a.appendChild(i),t}_createLargelInfoCardTable(e){const t=this._createBaseTableForInfoCard();return e.previewElement&&this._appendRow(t,e.previewElement),V()?(e.topicElement&&this._appendRow(t,e.topicElement),e.titleElement&&this._appendRow(t,e.titleElement),e.descriptionElement&&this._appendRow(t,e.descriptionElement),e.callToActionElements&&e.callToActionElements.forEach(e=>{this._appendRow(t,e)})):this._appendContentElements(t,e),t.childElementCount>0?t:void 0}_createBaseTableForInfoCard(){const e=document.createElement("table");return e.border="0",e.cellPadding="0",e.cellSpacing="0",e.align="center",e.width="100%",e.style.maxWidth=ne(this.context.endpointDetails)?`${Oe(!1,this.context.endpointDetails)}px`:`${c.TABLE_RENDER_WIDTH}px`,e}_getPreviewArea(e,t,n){if(!e?.previewFile)return;const{previewFile:a}=e,i=document.createElement("td");i.setAttribute("data-testid","info-preview-cell"),i.width=t===r.CardLayout.LargeCard?"100%":"33%",i.setAttribute("valign","top"),i.setAttribute("align","left"),t!==r.CardLayout.MediumCard&&(i.style.padding="8px 0"),i.style.margin="0",i.style.maxWidth=ne(this.context.endpointDetails)?`${Oe(!1,this.context.endpointDetails)}px`:`${c.TABLE_RENDER_WIDTH}px`;let o="";if(this.getThumbnail(a)){const e=n?.imageContent??"";if(t===r.CardLayout.LargeCard&&"Video"===a.type){const t=n?.videoUnfurl??"";if(t){const n=(new DOMParser).parseFromString(t,"text/html").body.firstChild,a=document.createElement("span");a.style.overflow="hidden",a.innerHTML=e,n.appendChild(a),o=n.outerHTML}}else o=e}else t===r.CardLayout.LargeCard&&a?.source.url&&(o=n?.previewContent??"");return o?(i.innerHTML=o,i):void 0}_processPreviewText(e){if(!e?.previewFile||!e.previewFile.source.url)return;const{previewFile:t}=e;return{componentName:r.ComponentName.TextBlock,text:t.name||t.source.url||"",link:t.source.url,altText:t.name,styles:{fontSize:"small",textDecoration:"underline"}}}_getPreviewText(e,t){const n=this._processPreviewText(e);if(!n)return;const a=this.context.getComponent(r.ComponentName.TextBlock)?.render(n);return a||""}async _getPreviewTextAsync(e,t){const n=this._processPreviewText(e);return n?await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(n).catch(()=>""))||"":Promise.resolve(void 0)}_getVideo(e){if(!e?.previewFile||"Video"!==e.previewFile.type)return;const t={componentName:r.ComponentName.Video,video:e.previewFile},n=this.context.getComponent(r.ComponentName.Video)?.render(t);return n??""}async _getVideoAsync(e){if(!e?.previewFile||"Video"!==e.previewFile.type)return;const t={componentName:r.ComponentName.Video,video:e.previewFile};return await(this.context.getComponent(r.ComponentName.Video)?.executeRender(t).catch(()=>""))??""}_processImage(e,t){if(!e?.previewFile)return;const{previewFile:n}=e,a=this.getThumbnail(n);if(!a)return;let i=ne(this.context.endpointDetails)?Oe(!1,this.context.endpointDetails):Oe();t===r.CardLayout.MediumCard&&(i*=.4);const o=a.originalDimensions,s=o?.height,d=o?.width,l=s&&d?s/d:void 0,u=l?Math.round(i*l):i*c.IMAGE_HEIGHT_RATIO;return{componentName:r.ComponentName.Image,imageUrl:a.source.url||"",_sharepointIds:a.source.sharepointIds,width:i,height:t===r.CardLayout.MediumCard?u:void 0,originalHeight:s,originalWidth:d,cornerRounding:"all",linkUrl:"File"===n.type?n?.source.url:void 0,altText:a.alternateText,fallbackImageUrl:"Video"===n.type?nn("video",en.medium):void 0}}_getImageContent(e,t){const n=this._processImage(e,t);if(!n)return;const a=this.context.getComponent(r.ComponentName.Image)?.render(n);return a||void 0}async _getImageContentAsync(e,t){const n=this._processImage(e,t);if(n)return await(this.context.getComponent(r.ComponentName.Image)?.executeRender(n).catch(()=>""))||void 0}_getTopicElement(e){if(!e?.text)return;const t=this.getTextBlock(e,{fontSize:j()?"small":"x-small",fontWeight:"semi-bold",lineHeight:j()?"20px":"16px"});return this._generateTopicText(e,t)}async _getTopicElementAsync(e){if(!e?.text)return;const t=await this.getTextBlockAsync(e,{fontSize:j()?"small":"x-small",fontWeight:"semi-bold",lineHeight:j()?"20px":"16px"});return this._generateTopicText(e,t)}_generateTopicText(e,t){if(e?.text&&t){const e=document.createElement("td");return e.setAttribute("data-testid","info-topic-cell"),V()&&(e.style.padding="0 0 8px 0",e.style.margin="0"),e.innerHTML=t,e}}_getTitleElement(e,t){if(!e?.text)return;const n=this.getTextBlock(e,{fontSize:"x-large",fontWeight:"semi-bold",lineHeight:j()?void 0:"32px"});return this._buildTitleElement(t,n)}async _getTitleElementAsync(e,t){if(!e?.text)return;const n=await this.getTextBlockAsync(e,{fontSize:"x-large",fontWeight:"semi-bold",lineHeight:j()?void 0:"32px"});return this._buildTitleElement(t,n)}_buildTitleElement(e,t){if(t){const n=document.createElement("td");return n.setAttribute("data-testid","info-title-cell"),V()&&(n.style.padding=e===r.CardLayout.MediumCard?"0 0 4px 0":"0 0 8px 0",n.style.margin="0"),n.innerHTML=t,n}}_getDescriptionElement(e){if(!e?.text)return;const t=this.getTextBlock(e,{fontSize:j()?"small":"medium",lineHeight:j()?"20px":"22px"});return t?this._buildDescriptionCell(t):void 0}_buildDescriptionCell(e){if(e){const t=document.createElement("td");if(t.setAttribute("data-testid","info-description-cell"),V()&&(t.style.padding="0 0 8px 0",t.style.margin="0"),V()){const n=t.appendChild(document.createElement("p"));n.style.margin="0",n.style.padding="0",n.innerHTML=e}else t.innerHTML=e;return t}}async _getDescriptionElementAsync(e){if(!e?.text)return;const t=await this.getTextBlockAsync(e,{fontSize:j()?"small":"medium",lineHeight:j()?"20px":"22px"});return t?this._buildDescriptionCell(t):void 0}async _getCallToActionElementsAsync(e){if(!e||0===e.length)return;const t=e.map(async e=>{if(!e.link.url)return;const t=document.createElement("td");t.setAttribute("data-testid","info-cta-cell");let n="";if("link"===e.type)n=await this.getTextBlockAsync({text:e.link.title??e.link.url,link:e.link.url},{fontSize:"small",textDecoration:"underline"});else{const t={componentName:r.ComponentName.Button,button:{link:{title:e.link.title??e.link.url,url:nt(e.link.url)},align:e.align}};n=await(this.context.getComponent(r.ComponentName.Button)?.executeRender(t).catch(()=>""))}return n?(t.innerHTML=n,t):void 0});return(await Promise.all(t)).filter(e=>Boolean(e))}_getCallToActionElements(e){const t=[];return e?.forEach(e=>{if(!e.link.url)return;const n=document.createElement("td");n.setAttribute("data-testid","info-cta-cell");let a="";if("link"===e.type)a=this.getTextBlock({text:e.link.title??e.link.url,link:e.link.url},{fontSize:"small",textDecoration:"underline"});else{const t={componentName:r.ComponentName.Button,button:{link:{title:e.link.title??e.link.url,url:nt(e.link.url)},align:e.align}};a=this.context.getComponent(r.ComponentName.Button)?.render(t)}a&&(n.innerHTML=a,t.push(n))}),t}constructor(...t){super(...t),this.distribution=e.Email,this._appendRow=(e,t)=>{if(t){const n=e.insertRow();V()&&(n.style.padding="0",n.style.margin="0"),n.appendChild(t)}},this._appendContentElements=(e,t)=>{const n=[];t.topicElement&&n.push(t.topicElement),t.titleElement&&n.push(t.titleElement),t.descriptionElement&&n.push(t.descriptionElement),t.callToActionElements&&n.push(...t.callToActionElements),n.forEach((t,n)=>{n>0&&(t.style.padding="8px 0 0 0"),t.style.fontSize="0",this._appendRow(e,t)})}}},class extends wa{render(e){const{video:t}=e;if(!this._hasVideo(t))return"";const n=t.source.url??"",a=document.createElement("a");return a.href=nt(n),a.setAttribute("data-loopstyle","embedded"),a.style.setProperty("text-decoration","none","important"),a.style.cursor="pointer",a.id=we(),a.className=o,a.style.setProperty("color",this.context.localSectionTheme.semanticColors.link,"important"),a.outerHTML}async renderAsync(e){return this.render(e)}constructor(...t){super(...t),this.distribution=e.Email}},class extends Pa{render(e){return this.processInput(e)}supportedStyles(){return[...ka,...Ta]}constructor(...t){super(...t),this.distribution=e.Email}}],e.Email),Fa=new hn([class extends Fn{render(e){return this._renderHelper(e)}async renderAsync(e){return this._renderHelper(e)}getHeaderLevel(e){return e>3?3:e}_renderHelper(e){const{styles:t,text:n}=e;if(!n)return"";const a=this.getTextElement(e);if(!g()){if(["bold","extra-bold","semi-bold","black"].includes(t?.fontWeight??"")){const e=document.createElement("strong");e.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(e)}if(t?.italic){const e=document.createElement("i");e.innerHTML=a.innerHTML,a.innerHTML="",a.appendChild(e)}}const i=t?this.context.processStyles(t):"";return i&&a.setAttribute("style",i),a.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Hn{render(e){const{button:t}=e,{url:n,title:a}=this.process(t.link),i={componentName:r.ComponentName.TextBlock,text:a??n,link:n,styles:{fontWeight:"link"===t.type?void 0:"bold"}},o=this.context.getComponent(r.ComponentName.TextBlock)?.render(i);return o||""}async renderAsync(e){const{button:t}=e,{url:n,title:a}=this.process(t.link),i={componentName:r.ComponentName.TextBlock,text:a??n,link:n,styles:{fontWeight:"link"===t.type?void 0:"bold"}};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(i).catch(()=>""))||""}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Rn{render(e){const t=this.context.getComponent(r.ComponentName.Video)?.render(this._getComponent(e));return this._processRender(e,t)}async _renderAsync(e){const t=await(this.context.getComponent(r.ComponentName.Video)?.executeRender(this._getComponent(e)));return this._processRender(e,t)}_getComponent(e){const{thumbnailLink:t,_spItem:n}=e,{title:a,url:i}=t.link;return{componentName:r.ComponentName.Video,video:{type:"Video",source:{url:i,sharepointIds:n?{siteId:n.siteId,uniqueId:n.uniqueId,webId:n.webId,listId:n.listId}:void 0},filePath:n?.filePath,siteUrl:n?.siteUrl,name:a}}}_processRender(e,t){const{thumbnailLink:n}=e,{description:a}=n.link,r=document.createElement("p"),o=document.createElement("span");let s=document.createElement("a");return t&&(s=(new DOMParser).parseFromString(t,"text/html").body.firstChild),o.appendChild(s),a&&(r.textContent=w()?(0,i.escape)(a):a,o.appendChild(r)),o.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends On{render(e){const{imageUrl:t,width:n,linkUrl:a,altText:i,additionalStyles:r}=e;this._props=e;let o="",s={width:Math.min(n,630),height:0};const c=this.generateThumbnailProps(e);o=c.thumbnailUrl;const d=c.fallbackUrl;return c.dimensions&&(s={width:c.dimensions.width,height:c.dimensions.height||0}),this._generateImageElement({thumbnailUrl:o,imageDimension:s,altText:i,imageUrl:t,imageExtension:this._getFileType(e),originalImageUrl:d,additionalStyles:r},a)}async renderAsync(e){const{imageUrl:t,width:n,linkUrl:a,altText:i,additionalStyles:r}=e,o=Math.min(n,630),s={width:this._imageBuildInfo.dimensions?.width||o,height:this._imageBuildInfo.dimensions?.height||0};return this._generateImageElement({thumbnailUrl:this._imageBuildInfo.thumbnailUrl??"",imageDimension:s,altText:i,imageUrl:t,imageExtension:this._getFileType(e),originalImageUrl:this._imageBuildInfo.fallbackUrl??"",additionalStyles:r},a)}generateThumbnailProps(e){const{imageUrl:t,width:n,height:a,originalWidth:i,originalHeight:r,cropData:o,cropMode:s,_fileType:c,_focalX:d,_focalY:l,_sharepointIds:u,_shouldEnforceDimensions:f}=e,p=Math.min(n,630),m=a&&n?a/n:r&&i?r/i:void 0;let _=m?Math.round(p*m):void 0;c&&!He(c)&&ge._TraceLogger.logError(ge._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),`Unsupported image type: ${c}`);const h={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:t,nonExpiring:!0,fileType:c,cropMode:s,optimizePublicImage:!1};!D()&&u&&(h.siteId=u.siteId,h.listId=u.listId,h.webId=u.webId,h.uniqueId=u.uniqueId),o?(h.viewportWidth=o.cropWidth,h.viewportHeight=o.cropHeight,h.originalWidth=i,h.originalHeight=r,h.viewportLeft=o.cropX,h.viewportTop=o.cropY,_=Math.round(p*(o.cropHeight/o.cropWidth))):(h.originalWidth=i,h.originalHeight=r);const b={width:p,height:_??0},g={width:i??0,height:r??0},v=this._computeTeamsDimension(b,g);h.width=v.width,h.height=v.height;let y={width:v.width,height:v.height};const{finalWidth:S,finalHeight:I}=vn(p,_,void 0,wn,e=>parseFloat(e.toFixed(1)));return h.width=S,h.height=I,y={width:S||0,height:I||0},{thumbnailUrl:this.getTranspileThumbnail(h,d,l,void 0,f)||t,fallbackUrl:i&&r?this.getTranspileThumbnail({...h,width:i,height:r}):void 0,dimensions:y}}_generateImageElement(e,t){const n=this._generateImageComponentForTeams(e);let a="";if(t&&tt(t)&&(a=`<a href="${F()?t:nt(t)}">${(0,i.escape)(t)}</a><br>`),!W()&&e.thumbnailUrl){const t=`${a}${n.outerHTML}`,i=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,e.thumbnailUrl,void 0,this._props,t);return this.context.processImage(e.thumbnailUrl,void 0,i),t}return`${a}${n.outerHTML}`}_getFileType(e){const{imageUrl:t,_fileType:n}=e;return n??_e._PreviewUtility.getFileExtension(new _e._SPResourcePath(be.UrlUtility.absolutizeUrl(t)))??""}_computeTeamsDimension(e,t){let n=e.width,a=e.height;return t.height&&t.height<=wn?{width:t.width,height:t.height}:(a&&a>wn&&(n=parseFloat((wn*n/a).toFixed(1)),a=wn),{width:n,height:a})}_generateImageComponentForTeams(e){try{const{thumbnailUrl:t,imageDimension:n,altText:a,imageUrl:r,imageExtension:o,originalImageUrl:s,additionalStyles:c}=e;t&&W()&&this.context.processImage(t);const d=o??_e._PreviewUtility.getFileExtension(new _e._SPResourcePath(be.UrlUtility.absolutizeUrl(r)))??"",l=document.createElement("div");l.classList.add("imagePlugin"),l.classList.add("teamsImagePlugin"),l.setAttribute("data-original-image-url",s??"");const u=X()||tt(t)?t:"",f=document.createElement("img");f.setAttribute("alt",(0,i.escape)(a||"")),f.setAttribute("src",u||""),f.setAttribute("href",u||""),f.setAttribute("data-sp-originalimgsrc",""!==r?r:u),f.setAttribute("width",n.width.toString()),f.setAttribute("itemscope",He(d)??""),f.setAttribute("data-teams-height",n.height.toString()),f.setAttribute("ck-editor-image","true"),f.setAttribute("data-inline-image","false"),f.setAttribute("style","vertical-align: bottom;"),f.setAttribute("itemtype","http://schema.skype.com/AMSImage"),!N()&&c?.width&&(f.style.width=c.width);const p=document.createElement("p");return p.classList.add("ck-editor-image-container"),p.appendChild(f),p.setAttribute("style",`width: ${n.width}px;`),l.appendChild(p),l}catch(e){return document.createElement("div")}}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Tn{render(e){const t=this._buildImageComponentProps(e);if(!t)return"";const n=this.context?.getComponent(r.ComponentName.Image)?.render(t);return n?this._buildHtml(e,n):""}async renderAsync(e){const t=this._buildImageComponentProps(e);if(!t)return"";const n=await(this.context?.getComponent(r.ComponentName.Image)?.executeRender(t));return n?this._buildHtml(e,n):""}_buildImageComponentProps(e){const{linkUrl:t,imageProps:n,isFullBleed:a}=e;if(!Re(n))return;const{source:i,alternateText:o,cropMode:s,targetDimension:c,originalDimensions:d}=n,l=a?630:c?.width?Math.min(d?.width||Number.POSITIVE_INFINITY,Math.min(630,c?.width)):Math.min(d?.width||Number.POSITIVE_INFINITY,630),u={componentName:r.ComponentName.Image,imageUrl:i?.url||"",width:l,originalWidth:d?.width,originalHeight:d?.height,linkUrl:t,altText:o,cropMode:s};return N()||(u.additionalStyles={width:"100%"}),this.handleCropping(u,n),i?.sharepointIds&&(u._sharepointIds=i.sharepointIds),u}_buildHtml(e,t){const{caption:n,overlayText:a,overlayTextStyles:o}=e;let s="";if(n&&""!==n){const e=document.createElement("p");e.classList.add("teams-caption"),e.style.fontSize="font-size:'inherit';",e.innerHTML=(0,i.escape)(n),s=e.outerHTML}let c="";if(e.overlayTextHTML&&oe()){const t={componentName:r.ComponentName.RichText,input:e.overlayTextHTML,format:"Html"};c=this.context?.getComponent(r.ComponentName.RichText)?.render(t)||""}else if(a&&""!==a){const e="",t=document.createElement("h1");e&&t.setAttribute("style",e);let n=t;if(o?.isItalic){const e=document.createElement("i");n.appendChild(e),n=e}if(o?.isBold){const e=document.createElement("strong");n.appendChild(e),n=e}n.textContent=w()?(0,i.escape)(a):a,c=t.outerHTML}return`${c}${t}${s}`}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Vn{render(e){return document.createElement("hr").outerHTML}async _renderAsync(e){return document.createElement("hr").outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends zn{render(e){return this._renderHelper(e)}async renderAsync(e){return this._renderHelper(e)}_renderHelper(e){const{height:t}=e,n=document.createElement("div"),a=(t-2*de())/19;for(let e=0;e<a;e++)n.appendChild(document.createElement("br"));return n.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Gn{render(e){const{url:t,description:n}=e.thumbnailLink.link;if(!t)return"";const a=this.getFileLink(e);if(n){const e={componentName:r.ComponentName.TextBlock,text:n},t=this.context.getComponent(r.ComponentName.TextBlock)?.render(e);return`${a} ${t}`}return a}async renderAsync(e){const{url:t,description:n}=e.thumbnailLink.link;if(!t)return"";const a=await this.getFileLinkAsync(e);if(n){const e={componentName:r.ComponentName.TextBlock,text:n};return`${a} ${await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e).catch(()=>""))}`}return a}constructor(...t){super(...t),this.distribution=e.Teams}},class extends qn{render(e){const t=this.getComponentProps(e);return this.context.getComponent(r.ComponentName.FileCard)?.render(t)}async renderAsync(e){const t=this.getComponentProps(e);return await(this.context.getComponent(r.ComponentName.FileCard)?.executeRender(t))}constructor(...t){super(...t),this.componentName=r.ComponentName.YoutubeCard,this.distribution=e.Teams}},class extends Zn{render(e){const{title:t,address:n}=e,a=document.createElement("span"),i=this.getTitleContent(t);i&&(a.innerHTML+=i);const r=this.getAddressContent(n);r&&(a.innerHTML+=r);const o=this.getMapImage(e,je,Be);return o&&(a.innerHTML+=o),a.outerHTML}async renderAsync(e){const{title:t,address:n}=e,a=document.createElement("span"),i=await this.getTitleContentAsync(t);i&&(a.innerHTML+=i);const r=await this.getAddressContentAsync(n);r&&(a.innerHTML+=r);const o=await this.getMapImageAsync(e,je,Be);return o&&(a.innerHTML+=o),a.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Qn{render(e){return e.cardSize===r.CardLayout.ExtraLargeCard?this._renderExtraLargeCard(e):this._renderLinkCard(e)}async renderAsync(e){return e.cardSize===r.CardLayout.ExtraLargeCard?this._renderExtraLargeCardAsync(e):this._renderLinkCardAsync(e)}getTitleText(e){const{thumbnailLink:t,cardSize:n}=e,{url:a,title:o}=t.link,s=be.UrlUtility.absolutizeUrl(a);if(n===r.CardLayout.LargeCard){const e=new URL(s).hostname.replace("www.","");return o||e}{const e=$e.HtmlEncoding.encodeText(o||""),t=new me.Uri(s),n=_e._PreviewUtility.getFileExtension(new _e._SPResourcePath(s))||"";let a="";return c=n.toLowerCase(),it[c.replace(".","")]&&(a=`.${n.toLowerCase()}`),`${(0,i.escape)(`${e.substring(0,I()?Yn:40)}${a}`)} (${t.getHost()})`}var c}_renderLinkCard(e){const{url:t}=e.thumbnailLink.link;return t?this.getLinkElement(e).outerHTML:""}_renderExtraLargeCard(e){const{thumbnailLink:t,callToAction:n,topic:a}=e,{link:i,thumbnail:o}=t,{description:s,title:c,url:d}=i,l=document.createElement("div");if(a){const e={componentName:r.ComponentName.TextBlock,text:a.substring(0,Yn),styles:{fontWeight:"bold"}};!I()&&e.styles&&(e.text=a.substring(0,40),e.styles.fontSize="medium"),this._generateTextContentForExtraLargeCard(e,l)}if(c){const e={componentName:r.ComponentName.TextBlock,text:c.substring(0,Yn),headerLevel:1};I()||(e.text=c.substring(0,110),e.headerLevel=2,e.styles={fontSize:"large"}),this._generateTextContentForExtraLargeCard(e,l)}if(s){const e={componentName:r.ComponentName.TextBlock,text:s.substring(0,I()?Yn:500)};this._generateTextContentForExtraLargeCard(e,l)}if(n){const e={componentName:r.ComponentName.TextBlock,text:n?.substring(0,Yn),link:d,styles:{textDecoration:"underline"}};!I()&&e.styles&&(e.text=n?.substring(0,40),e.styles.fontWeight="bold"),this._generateTextContentForExtraLargeCard(e,l)}if(this.hasThumbnail(o)){const e={componentName:r.ComponentName.Image,imageUrl:o?.source.url??"",width:je,height:Be,altText:o?.alternateText,_sharepointIds:o?.source.sharepointIds},t=this.context.getComponent(r.ComponentName.Image)?.render(e);if(t){const e=document.createElement("span");e.innerHTML=t,l.appendChild(e)}}return l.outerHTML}async _renderExtraLargeCardAsync(e){const{thumbnailLink:t,callToAction:n,topic:a}=e,{link:i,thumbnail:o}=t,{description:s,title:c,url:d}=i,l=document.createElement("div");if(a){const e={componentName:r.ComponentName.TextBlock,text:a.substring(0,Yn),styles:{fontWeight:"bold"}};!I()&&e.styles&&(e.text=a.substring(0,40),e.styles.fontSize="medium"),await this._generateTextContentForExtraLargeCardAsync(e,l)}if(c){const e={componentName:r.ComponentName.TextBlock,text:c.substring(0,Yn),headerLevel:1};I()||(e.text=c.substring(0,110),e.headerLevel=2,e.styles={fontSize:"large"}),await this._generateTextContentForExtraLargeCardAsync(e,l)}if(s){const e={componentName:r.ComponentName.TextBlock,text:s.substring(0,I()?Yn:500)};await this._generateTextContentForExtraLargeCardAsync(e,l)}if(n){const e={componentName:r.ComponentName.TextBlock,text:n?.substring(0,Yn),link:d,styles:{textDecoration:"underline"}};!I()&&e.styles&&(e.text=n?.substring(0,40),e.styles.fontWeight="bold"),await this._generateTextContentForExtraLargeCardAsync(e,l)}if(this.hasThumbnail(o)){const e={componentName:r.ComponentName.Image,imageUrl:o?.source.url??"",width:je,height:Be,altText:o?.alternateText,_sharepointIds:o?.source.sharepointIds},t=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(e).catch(()=>""));if(t){const e=document.createElement("span");e.innerHTML=t,l.appendChild(e)}}return l.outerHTML}async _renderLinkCardAsync(e){const{url:t}=e.thumbnailLink.link;return t?(await this.getLinkElementAsync(e)).outerHTML:""}_generateTextContentForExtraLargeCard(e,t){const n=this.context?.getComponent(r.ComponentName.TextBlock)?.render(e);if(n){const e=document.createElement("span");e.innerHTML=n,t.appendChild(e)}}async _generateTextContentForExtraLargeCardAsync(e,t){const n=await(this.context?.getComponent(r.ComponentName.TextBlock)?.executeRender(e).catch(()=>""));if(n){const e=document.createElement("span");e.innerHTML=n,t.appendChild(e)}}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Nn{render(e){if(!e.person.name)return"";switch(e.CardLayout){case r.CardLayout.ExtraSmallCard:case r.CardLayout.SmallCard:return this._generateSmallCard(e);case r.CardLayout.MediumCard:case r.CardLayout.LargeCard:return this._generateLargeAndMediumCard(e);default:return""}}async renderAsync(e){if(!e.person.name)return"";switch(e.CardLayout){case r.CardLayout.ExtraSmallCard:case r.CardLayout.SmallCard:return this._generateSmallCard(e);case r.CardLayout.MediumCard:case r.CardLayout.LargeCard:return this._generateLargeAndMediumCardAsync(e);default:return""}}getPersonName(e){return e.person.aadObjectId?this._populateAtMentionList(e.person):this._createNonMentionTag(e.person)}_generateLargeAndMediumCard(e){const t=document.createElement("div"),n=this.generatePersonElement(e);t.appendChild(n);const a=this.generateLinkElement(e);a&&t.appendChild(a);const i=this.generateDescriptionElement(e);return i&&t.appendChild(i),t.innerHTML}async _generateLargeAndMediumCardAsync(e){const t=document.createElement("div"),n=this.generatePersonElement(e);t.appendChild(n);const a=await this.generateLinkElementAsync(e);a&&t.appendChild(a);const i=await this.generateDescriptionElementAsync(e);return i&&t.appendChild(i),t.innerHTML}_generateSmallCard(e){return this.generatePersonElement(e).outerHTML}_createNonMentionTag(e){const t=document.createElement("span");return t.style.color=Qe,t.textContent=w()?(0,i.escape)(e.name):e.name,t.outerHTML}_populateAtMentionList(e){let t="";const n=this.context.getPerson(e);return t=this._createTeamsAtMention(e.name,n),t}_createTeamsAtMention(e,t){const n=document.createElement("readonly");n.className="skipProofing",n.contentEditable="false",n.setAttribute("itemtype",ze);const a=document.createElement("span");a.className="personTag",a.setAttribute("itemtype",ze),a.setAttribute("itemscope",""),a.setAttribute("itemid",t.toString());const r=document.createElement("span");return r.style.color=Qe,r.textContent=w()?(0,i.escape)(e):e,a.appendChild(r),n.appendChild(a),n.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends jn{render(e){const t=[];if(e.people.forEach((n,a)=>{r.CardLayout.SmallCard===e.cardLayout?t.push(this._generateSmallPeopleLinkItem(n,e.cardLayout)):(t.push(this._generateMediumAndLargePeopleLinkItem(n,e.cardLayout)),t.push(a!==e.people.length-1||1===e.people.length?"<hr>":""))}),r.CardLayout.SmallCard===e.cardLayout){if(t.length>0){const e=document.createElement("ul");return e.innerHTML=t.join(""),e.outerHTML}return""}return t.length>0?`${t.join("")}`:""}async renderAsync(e){const t=[];if(await Promise.all(e.people.map(async(n,a)=>{r.CardLayout.SmallCard===e.cardLayout?t.push(await this._generateSmallPeopleLinkItemAsync(n,e.cardLayout)):(t.push(await this._generateMediumAndLargePeopleLinkItemAsync(n,e.cardLayout)),t.push(a!==e.people.length-1||1===e.people.length?"<hr>":""))})),r.CardLayout.SmallCard===e.cardLayout){if(t.length>0){const e=document.createElement("ul");return e.innerHTML=t.join(""),e.outerHTML}return""}return t.length>0?`${t.join("")}`:""}_generateSmallPeopleLinkItem(e,t){const n=this.generatePeopleCard(e,t),a=document.createElement("li");return a.innerHTML=n,a.outerHTML}_generateMediumAndLargePeopleLinkItem(e,t){return this.generatePeopleCard(e,t)}async _generateSmallPeopleLinkItemAsync(e,t){const n=await this.generatePeopleCardAsync(e,t),a=document.createElement("li");return a.innerHTML=n,a.outerHTML}async _generateMediumAndLargePeopleLinkItemAsync(e,t){return await this.generatePeopleCardAsync(e,t)}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Xn{render(e){const{thumbnailLinks:t,title:n,titleHTML:a}=e;if(0===t.length)return"";const i=document.createElement("div"),r=this.getTitleContent(a,n,void 0,{fontWeight:"bold"});r&&(i.innerHTML=r);const o=this.getLinkListElement(e);return i.appendChild(o),i.outerHTML}async renderAsync(e){const{thumbnailLinks:t,title:n,titleHTML:a}=e;if(0===t.length)return"";const i=document.createElement("div"),r=await this.getTitleContentAsync(a,n,void 0,{fontWeight:"bold"});r&&(i.innerHTML=r);const o=await this.getLinkListElementAsync(e);return i.appendChild(o),i.outerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends aa{render(e){const{personInFocus:t}=e;return t?this.handleListRender(e):""}async renderAsync(e){const{personInFocus:t}=e;return t?this.handleListRenderAsync(e):""}constructor(...t){super(...t),this.distribution=e.Teams}},class extends ra{render(e){return this.getCallToActionElement(e,630,121)}async renderAsync(e){return this.getCallToActionElementAsync(e,630,121)}constructor(...t){super(...t),this.distribution=e.Teams}},class extends oa{render(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n};return this.context.getComponent(r.ComponentName.TextBlock)?.render(a)}async renderAsync(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""))}constructor(...t){super(...t),this.distribution=e.Teams}},class extends ea{render(e){return this.getImageGalleryComponent(e,je)}async renderAsync(e){return this.getImageGalleryComponentAsync(e,je)}constructor(...t){super(...t),this.distribution=e.Teams}},class extends sa{render(e){const{title:t,authors:n,thumbnail:a,titleHtml:i}=e,r=Re(a)?this.getImageContent(e,740,140):"",o=this.getTopicHeaderContent(e),{titleContent:s,authorContent:c}=this._generateTitleAndAuthorContent(i,t,n);return this._assembleBannerContent(r,o,s,c)}async renderAsync(e){const{title:t,authors:n,titleHtml:a}=e,i=await this.getImageContentAsync(e,740,140),r=await this.getTopicHeaderContentAsync(e),{titleContent:o,authorContent:s}=await this._generateTitleAndAuthorContentAsync(a,t,n);return this._assembleBannerContent(i,r,o,s)}_generateTitleAndAuthorContent(e,t,n){return{titleContent:this.getTitleContent(e||"",t,{fontSize:"x-large"}),authorContent:this.getAuthorContent(n)}}async _generateTitleAndAuthorContentAsync(e,t,n){return{titleContent:await this.getTitleContentAsync(e||"",t,{fontSize:"x-large"}),authorContent:await this.getAuthorContentAsync(n)}}_assembleBannerContent(e,t,n,a){return`${e??""}${t??""}${n??""}${a??""}`}constructor(...t){super(...t),this.distribution=e.Teams,this.componentName=r.ComponentName.Banner}},class extends da{render(e){return this._buildTeamsResponse(e)}async renderAsync(e){return this._buildTeamsResponse(e)}_buildTeamsResponse(e){const{title:t,header:n,showHeader:a,announcementBanner:i}=e,r={subject:a&&n&&t?$e.StringHelper.format(la.S,n,t).substring(0,250):t??""};let o;if(i&&"Announcement"===this.context?.postType&&(r.headlineColor=i.headlineColor,r.headline=i.headline.substring(0,44),h._SPFlight.isEnabled(61900))){const e=Number(r.headlineColor);o=this._announcementCardForColor(isNaN(e)?0:e)}return o&&(r.cards=[o]),JSON.stringify(r)}_announcementCardForColor(e=0){return{appId:"announcement-card",contentType:"application/vnd.microsoft.teams.messaging-announcementBanner",cardClientId:`announcement-card-${h.Guid.newGuid().toString().replace(/-/g,"")}`,content:{colorTheme:e.toString()}}}constructor(...t){super(...t),this.distribution=e.Teams}},class extends ua{render(e){const{htmlContent:t,ck4InlineImages:n,inlineImages:a}=e;let i=t;return n&&n.size>0&&(i=this._processCK4Images(t,n)),i=this._fixLinks(this.processImages(i,a))??"",i?Ot(i??"",e.rteStylingOptions?.skipHeadingLevelShift,this.context.localSectionTheme):""}async renderAsync(e){return Ot(this._processedHtmlContent,e.rteStylingOptions?.skipHeadingLevelShift,this.context.localSectionTheme)}async processImagesAsync(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelectorAll(this._imageClass);for(const e of Array.from(a)){const n=this._prepareImageComponent(e,t);n&&await this.insertInlineImagesAsync(e,[n])}return n.body.innerHTML}processImages(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html");return n.querySelectorAll(this._imageClass).forEach(e=>{const n=this._prepareImageComponent(e,t);n&&this.insertInlineImages(e,[n])}),n.body.innerHTML}_prepareImageComponent(e,t){const n=e.querySelector(this._imageTag);if(!n)return;const a=this.extractImageProp(n,t);if(e.removeChild(n),!a||!a.source||!a.source.url)return;const{source:{url:i,sharepointIds:o},naturalHeight:s,naturalWidth:c,isImageShape:d,link:l,overlay:u,width:f,caption:p,altText:m}=a,_={componentName:r.ComponentName.RichImage,imageProps:{source:{url:i},alternateText:m||fa.D,originalDimensions:{width:c,height:s},targetDimension:{width:f}},caption:p};return!d&&s&&c&&c>f&&(_.imageProps.cropWindow={type:"viewport",viewport:{width:c,height:s,x:0,y:0}}),l&&(_.linkUrl=l),u&&u?.text&&u?.styles&&(_.overlayText=u.text,_.overlayTextStyles=u.styles),D()||(_.imageProps.source.sharepointIds=o),_}constructor(...t){super(...t),this.distribution=e.Teams,this._containerType="span"}},class extends Ia{render(e){return""}constructor(...e){super(...e),this.componentName=r.ComponentName.Screenshot,this.distribution=xa.Teams}},class extends Oa{render(e){return this.getSimpleInfoCard(e,je).innerHTML}async renderAsync(e){return(await this.getSimpleInfoCardAsync(e,je)).innerHTML}constructor(...t){super(...t),this.distribution=e.Teams}},class extends wa{render(e){return this._processVideo(e)}async renderAsync(e){return this._processVideo(e)}_processVideo(e){if(!this._hasVideo(e?.video))return"";const{video:t}=e,{source:n,filePath:a,name:i,siteUrl:r}=t,o=nt(n.url??""),s=be.ExtensionHelper.getExtension(nt(a??"")),c=document.createElement("a");if(c.href=o,c.target="_blank",c.textContent=i??n?.url??"",c.title=escape(i??""),t.source.sharepointIds&&this._checkForSharepointIds(t)&&function(e,t=!1){return t?Ne.test(e):d.test(e)}(o,!0)){const e={link:o,title:i,fileType:s,spItem:{...t.source.sharepointIds,filePath:a??"",siteUrl:r??"",listId:t.source.sharepointIds.listId??""}};if(-1!==this.context.getAttachment(e)){const e=this._createUnfurlPropsFromProps(t);e&&Object.keys(e).forEach(t=>{c.setAttribute(t,e[t])})}}return c.outerHTML}_checkForSharepointIds(e){return Boolean(e.source.sharepointIds&&e.source.sharepointIds.siteId&&e.source.sharepointIds.listId&&e.source.sharepointIds.uniqueId&&e.source.sharepointIds.webId&&e.filePath&&e.siteUrl)}_createUnfurlPropsFromProps(e){if(e.source.url&&e.source.sharepointIds){const t=nt(e.source.url),{uniqueId:n}=e.source.sharepointIds,a=be.ExtensionHelper.getExtension(nt(t));return{"data-item-props":JSON.stringify({objectUrl:t,type:a??"",title:e.name}),itemtype:"http://schema.skype.com/HyperLink/File",itemid:escape(n||"").toUpperCase(),"data-processed-url":"true",title:escape(t||"")}}}constructor(...t){super(...t),this.distribution=e.Teams}},class extends Pa{render(e){return this.processInput(e)}constructor(...t){super(...t),this.distribution=e.Teams}}],e.Teams),Ha=new hn([class extends Fn{render(e){const{text:t,styles:n,headerLevel:a,link:i}=e,r={blocks:[],attachments:[]},o={blockType:"UNSTYLED",spans:[]},s=new Set;return a&&s.add("BOLD"),n&&(this.context?.processStyles(n)??[]).forEach(e=>s.add(e)),i?(o.spans.push({text:t,styles:Array.from(s),entity:{type:"LINK",url:i.toString()}}),r.blocks.push(o),r):(o.spans.push({text:t,styles:Array.from(s)}),r.blocks.push(o),r)}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Hn{render(e){const{button:t}=e,{url:n,title:a}=this.process(t.link),r={blocks:[],attachments:[]},o={blockType:"UNSTYLED",spans:[{text:(0,i.escape)(a),styles:[],entity:{type:"LINK",url:n}}]};return r.blocks.push(o),r}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Rn{render(e){const{url:t,title:n}=e.thumbnailLink.link;return{blocks:[{blockType:"UNSTYLED",spans:[{text:n||"",styles:[],entity:{type:"LINK",url:b()?be.UrlUtility.absolutizeUrl(t):nt(t)}}]}],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends On{render(e){const{imageUrl:t,width:n,originalWidth:a,originalHeight:i,linkUrl:r,altText:o,cropMode:s,_fileType:c,_sharepointIds:d}=e,l=Math.min(Oe(!0),n),u=this.enhanceThumbnailWidth(l,a||0,i||0);c&&!He(c)&&ge._TraceLogger.logError(ge._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),`Unsupported image type: ${c}`);const f={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:t,width:u,originalWidth:a,originalHeight:i,nonExpiring:!0,cropMode:s,optimizePublicImage:!1,fileType:c};!D()&&d&&(f.siteId=d.siteId,f.listId=d.listId,f.webId=d.webId,f.uniqueId=d.uniqueId);const p={blocks:[],attachments:[this.getTranspileThumbnail(f)||t],footer:[]};return r&&p.footer?.push(En(r,Pn.F,!0)),o&&p.footer?.push(En(o,Pn.C)),p}generateThumbnailProps(e){return{thumbnailUrl:""}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Tn{render(e){const{isFullBleed:t,caption:n,linkUrl:a,overlayText:i,imageProps:o}=e;if(!Re(o))return Xe;const{source:s,alternateText:c,cropMode:d,cropWindow:l,targetDimension:u,originalDimensions:f}=o,p=t?Oe(!0):u?.width?Math.min(f?.width||Number.POSITIVE_INFINITY,Math.min(Oe(),u?.width)):Math.min(f?.width||Number.POSITIVE_INFINITY,Oe()),m={componentName:r.ComponentName.Image,imageUrl:s?.url||"",width:p,originalWidth:f?.width,originalHeight:f?.height,linkUrl:a,altText:c,cropMode:d};l?.type&&("focalPoint"===l.type?(m._focalX=l.focalPoint.offsetLeft,m._focalY=l.focalPoint.offsetTop):m.cropData={cropHeight:l.viewport.height,cropWidth:l.viewport.width,cropX:l.viewport.x,cropY:l.viewport.y}),s?.sharepointIds&&(m._sharepointIds=s.sharepointIds);const _=this.context?.getComponent(r.ComponentName.Image)?.render(m);if(!_)return{blocks:[],attachments:[]};const h=[];return n&&""!==n&&h.push(En(n,Un.u)),i&&""!==i&&h.push(En(i,Un.V)),_.footer=h.concat(_.footer??[]),_}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Vn{render(e){return{blocks:[],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends zn{render(e){return{blocks:[],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Gn{render(e){const{url:t,title:n}=e.thumbnailLink.link,a={componentName:r.ComponentName.TextBlock,text:n||"",link:t},i=this.context.getComponent(r.ComponentName.TextBlock)?.render(a);return i}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends qn{render(e){const t=this.getComponentProps(e,!0);return this.context.getComponent(r.ComponentName.FileCard)?.render(t)}constructor(...t){super(...t),this.componentName=r.ComponentName.YoutubeCard,this.distribution=e.VivaEngage}},class extends Zn{render(e){const{title:t,address:n,zoomLevel:a,mapType:r,latitude:o,longitude:s}=e;this.checkLocations(o,s);const c=`https://bing.com/maps/default.aspx?cp=${o.toFixed(5)}~${s.toFixed(5)}&lvl=${a}${r?`&style=${this._getEngageMapType(r)}`:""}`,d={blocks:[],attachments:[]};return t&&d.blocks.push({blockType:"UNSTYLED",spans:[{text:t,styles:[]}]}),d.blocks.push({blockType:"UNSTYLED",spans:[{text:n||(0,i.escape)(c),styles:[],entity:{type:"LINK",url:c}}]}),d}_getEngageMapType(e){switch(e){case"aerial":return"a";default:return"r";case"aerialWithLabels":return"h";case"birdseye":case"birdseyeV2":case"birdseyeWithLabels":return"b"}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Qn{render(e){const{url:t,title:n}=e.thumbnailLink.link,a=be.UrlUtility.absolutizeUrl(t),i=new URL(a).hostname.replace("www.","").replace("https://",""),o={componentName:r.ComponentName.TextBlock,text:n||i,link:a},s=this.context.getComponent(r.ComponentName.TextBlock)?.render(o);return s}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Nn{render(e){const t={blocks:[],attachments:[]};if(!e.person.name)return t;const n=[An(`${e.person.name}, `),An(e.person.role??"")];if(t.blocks.push(Ln(n)),e.CardLayout!==r.CardLayout.SmallCard){const n=e.person.linkUrl;if(n){const a=be.UrlUtility.absolutizeUrl(n),i=[An(`${e.person.linkName??n}`,[],{type:"LINK",url:a})];t.blocks.push(Ln(i))}const a=e.person.description;if(a){const e=[An(`${a}`)];t.blocks.push(Ln(e))}t.blocks.push(Je)}return t}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends jn{render(e){let t={blocks:[],attachments:[]};return e.people.forEach((n,a)=>{const i=this._renderPeopleCard(n,e.cardLayout);t=kn(t,i)}),t}_renderPeopleCard(e,t){const n={componentName:r.ComponentName.PeopleCard,person:e,CardLayout:t},a=this.context?.getComponent(r.ComponentName.PeopleCard)?.render(n);return a}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Xn{render(e){const{thumbnailLinks:t,title:n,cardSize:a}=e,i=[];return n&&i.push({blockType:"UNSTYLED",spans:[{text:n,styles:["BOLD"]}]}),t.forEach(e=>{const t=this._getLinkContent(e,a);t&&i.push(t)}),{blocks:i,attachments:[]}}_getLinkContent(e,t){const n={componentName:r.ComponentName.LinkCard,thumbnailLink:e,cardSize:t},a=this.context.getComponent(r.ComponentName.LinkCard)?.render(n);if(a&&a.blocks.length>0){const e=a.blocks[0];return e.blockType="UNORDERED_LIST_ITEM",e.depth=0,e}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends aa{render(e){return{blocks:[],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ra{render(e){const{button:t}=e,n={componentName:r.ComponentName.Button,button:t},a=this.context.getComponent(r.ComponentName.Button)?.render(n);return a}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends oa{render(e){const{text:t}=e,n={componentName:r.ComponentName.TextBlock,text:t},a=this.context.getComponent(r.ComponentName.TextBlock)?.render(n);return a}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ea{render(e){return{blocks:[],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends sa{render(e){const{title:t,header:n,showHeader:a,authors:i,titleHtml:o}=e;let s;if(i&&i.length>0){const{email:e,name:t,role:n,aadObjectId:a}=i[0];s={name:t,email:e,aadObjectId:a,role:n}}const c={fontSize:"x-small",fontWeight:"semi-bold",overflow:"hidden",lineHeight:"16px"};let d={blocks:[],attachments:[]};if(a&&n){const e={componentName:r.ComponentName.TextPill,text:n.toUpperCase(),backgroundColor:"accent",borderRadius:2,textStyles:c};d=this.context.getComponent(r.ComponentName.TextPill)?.render(e)}let l={blocks:[],attachments:[]};if(oe()&&o)this.context.getComponent(r.ComponentName.TextBlock)?.render({componentName:r.ComponentName.RichText,input:o,format:"Html"});else if(t){const e={componentName:r.ComponentName.TextBlock,text:t,headerLevel:1,styles:{fontWeight:"bold"}};l=this.context.getComponent(r.ComponentName.TextBlock)?.render(e)}let u={blocks:[],attachments:[]};if(s){const e={componentName:r.ComponentName.PeopleCard,person:s,CardLayout:r.CardLayout.ExtraSmallCard};u=this.context.getComponent(r.ComponentName.PeopleCard)?.render(e)}return{blocks:[...d.blocks,...l.blocks,...u.blocks],attachments:[...d.attachments,...l.attachments,...u.attachments]}}constructor(...t){super(...t),this.distribution=e.VivaEngage,this.componentName=r.ComponentName.Banner}},class extends da{render(e){const{title:t,showHeader:n,header:a}=e;if(!t)return{attachments:[],blocks:[],footer:[]};const i={blocks:[],attachments:[]};return n&&a&&i.blocks.push({blockType:"UNSTYLED",spans:[{text:a.toUpperCase(),styles:[]}]}),i.blocks.push({blockType:"UNSTYLED",spans:[{text:t,styles:["BOLD"]}]}),i}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ua{render(e){const{htmlContent:t,ck4InlineImages:n,inlineImages:a}=e;let i=t;n&&n.size>0&&(i=this._processCK4Images(i,n)),i=this._fixLinks(this.processImages(t,a))??"";const r=document.createElement("div");return r.innerHTML=i||"",r.children.length>0&&this._transpileHtmlElementToJson(r,0,"UNSTYLED",!1,!0),this._vivaEngageTranspiledBlocks}insertInlineImages(e,t){const n=[];t.forEach(e=>{const t=this.context.getComponent(e.componentName)?.render(e);t&&n.push(t)}),e.setAttribute("engage-content",JSON.stringify(n))}async processImagesAsync(e,t){return""}processImages(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html");return n.querySelectorAll(this._imageClass).forEach(e=>{const n=e.querySelector(this._imageTag);if(!n)return;const a=this.extractImageProp(n,t);if(e.removeChild(n),!a)return;const{source:{url:i},naturalHeight:o,naturalWidth:s,isImageShape:c,link:d,overlay:l,width:u,caption:f,altText:p}=a;if(!i)return;const m={componentName:r.ComponentName.RichImage,imageProps:{source:{url:i},alternateText:p,originalDimensions:{width:s,height:o},targetDimension:{width:u}},caption:f};if(!c&&o&&s&&s>u&&(m.imageProps.cropWindow={type:"viewport",viewport:{width:s,height:o,x:0,y:0}}),d&&(m.linkUrl=d),l?.text&&l?.styles){m.overlayText=l.text;const e=l.styles;m.overlayTextStyles={isBold:e?.isBold,isItalic:e?.isItalic}}this.insertInlineImages(e,[m])}),n.body.innerHTML}_transpileHtmlElementToJson(e,t,n,a,i=!1){for(let r=0;r<e.children.length;r++)switch(e.children[r].tagName){case"UL":this._transpileHtmlElementToJson(e.children[r],t+1,"UNORDERED_LIST_ITEM",a);break;case"OL":this._transpileHtmlElementToJson(e.children[r],t+1,"ORDERED_LIST_ITEM",a);break;case"LI":const o=["DIV","OL","UL","H1","H2","H3","H4"],s=Array.from(e.children[r].childNodes),c=[],d=[];if(s.forEach(e=>{o.includes(e.nodeName)?d.push(e):"P"===e.nodeName?c.push(...Array.from(e.childNodes)):c.push(e)}),c.length>0&&this._transpileInlineLinkSentence(n,{nodeList:c},t,a?["ITALIC"]:void 0),d.length>0){const e=document.createElement("div");d.forEach(t=>e.appendChild(t)),this._transpileHtmlElementToJson(e,t,n,a)}break;case"FIGURE":case"TABLE":this._transpileHtmlElementToJson(e.children[r],t,"UNSTYLED",a);break;case"COLGROUP":break;case"THEAD":case"TBODY":const l=e.children[r].children,u=["DIV","P","OL","UL","BLOCKQUOTE","H1","H2","H3","H4"];for(let t=0;t<l.length;t++){const n=l[t].children;for(let e=0;e<n.length;e++){const t=Array.from(n[e].childNodes),i=t.filter(e=>!u.includes(e.nodeName)),r=t.filter(e=>u.includes(e.nodeName));if(i.length>0&&this._transpileInlineLinkSentence("UNSTYLED",{nodeList:i},void 0,a?["ITALIC"]:void 0),r.length>0){const e=document.createElement("div");r.forEach(t=>e.appendChild(t)),this._transpileHtmlElementToJson(e,0,"UNSTYLED",a)}}(t<l.length-1||"THEAD"===e.children[r].tagName)&&this._vivaEngageTranspiledBlocks.blocks.push(Je)}break;case"BLOCKQUOTE":this._transpileHtmlElementToJson(e.children[r],t,"UNSTYLED",!0,i);break;case"H1":case"H2":case"H3":case"H4":this._transpileInlineLinkSentence(n,{nodeList:e.children[r].childNodes},t,a?["ITALIC","BOLD"]:["BOLD"]);break;case"DIV":if(e.children[r].classList.contains("imagePlugin")||e.children[r].matches('div.webPartInRte[data-widget="inlineimage"]')){const t=e.children[r];this._transpileEngageImage(t)}break;case"P":this._transpileInlineLinkSentence("UNSTYLED",{nodeList:e.children[r].childNodes},void 0,a?i?["ITALIC","BOLD"]:["ITALIC"]:void 0);break;default:this._vivaEngageTranspiledBlocks.blocks.push({blockType:"UNSTYLED",spans:this._transpileStyledSentence(e.children[r].innerHTML)})}}_transpileInlineLinkSentence(e,t,n,a){let i={blockType:e,depth:n&&"UNSTYLED"!==e?n>2?2:n-1:void 0,spans:[]};for(let n=0;n<t.nodeList.length;n++)switch(t.nodeList[n].nodeName){case"A":i.spans.push({text:(t.nodeList[n].textContent||"").replace(String.fromCharCode(160)," "),styles:[],entity:{type:"LINK",url:t.nodeList[n].getAttribute("href")||""}});break;case"DIV":const r=document.createElement("div");r.appendChild(t.nodeList[n]),this._transpileHtmlElementToJson(r,0,"UNSTYLED",!1);break;case"#text":i.spans.push({text:(t.nodeList[n].textContent||"").replace(String.fromCharCode(160)," "),styles:[]});break;case"BR":"UNSTYLED"!==e?i.spans.push(Ye):(i.spans.length>0?a&&i.spans.forEach(e=>{e.styles=Array.from(new Set(a.concat(e.styles)))}):i.spans.push(Ye),this._vivaEngageTranspiledBlocks.blocks.push(i),i={blockType:"UNSTYLED",spans:[]});break;default:this._transpileStyledSentence(t.nodeList[n].outerHTML).forEach(e=>{i.spans.push(e)})}a&&i.spans.forEach(e=>{e.styles=Array.from(new Set(a.concat(e.styles)))}),this._vivaEngageTranspiledBlocks.blocks.push(i)}_transpileStyledSentence(e){const t=[];let n=e.replace(pa,"").replace(ba,"").replace(ga,"$2").replace(va,"$2").replace(ya,"$2").replace(Sa,"").replace(Da,"");for(;n.length>0;){const e=n.match(ha)||[],a=n.match(ma)||[],i=n.match(_a)||[],r=e.length>0?n.indexOf(i[0]):n.length,o=a.length>0?n.indexOf(a[0]):n.length,s=i.length>0?n.indexOf(i[0]):n.length;if(0===r)t.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(n.split("</strong></i>")[0].replace("<i><strong>","")),styles:["ITALIC","BOLD"]}),n=n.slice(n.indexOf("</strong></i>")+13);else if(0===o)t.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(n.split("</strong>")[0].replace("<strong>","")),styles:["BOLD"]}),n=n.slice(n.indexOf("</strong>")+9);else if(0===s){const e=n.split("</i>")[0].replace("<i>","");this._transpileStyledSentence(e).forEach(e=>{const n=Array.from(new Set(["ITALIC"].concat(e.styles)));t.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(e.text),styles:n})}),n=n.slice(n.indexOf("</i>")+4)}else t.push({text:this._convertSpecialHTMLSymbolsInVivaEngage(n.slice(0,Math.min(o,s,r))),styles:[]}),n=n.slice(Math.min(o,s,r))}return t}_transpileEngageImage(e){try{const t=e.getAttribute("engage-content");t&&JSON.parse(t).forEach(e=>{this._vivaEngageTranspiledBlocks.footer?.length&&e.footer?.length&&this._vivaEngageTranspiledBlocks.footer.push(Je),this._vivaEngageTranspiledBlocks=kn(this._vivaEngageTranspiledBlocks,e)})}catch(e){ge._TraceLogger.logError(ge._LogSource.create("EngageTranspile"),e,"EngageRTEWebpart")}}constructor(...t){super(...t),this.distribution=e.VivaEngage,this._containerType="",this._vivaEngageTranspiledBlocks={blocks:[],attachments:[]},this._convertSpecialHTMLSymbolsInVivaEngage=e=>e.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")}},class extends Ia{render(e){return{blocks:[],attachments:[]}}constructor(...e){super(...e),this.componentName=r.ComponentName.Screenshot,this.distribution=xa.VivaEngage}},class extends Oa{render(e){return{blocks:[],attachments:[]}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends wa{render(e){return Xe}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Pa{render(e){return Xe}constructor(...t){super(...t),this.distribution=e.VivaEngage}}],e.VivaEngage),Ra=new hn([class extends Fn{render(e){return this._renderHelper(e)}async renderAsync(e){return this._renderHelper(e)}getHeaderLevel(e){return e>2?2:e}_renderHelper(e){if(!e.text)return"";let t=this.getTextElement(e);return e.styles&&(t=function(e,t,n=!1){let a=t;const i=t.childNodes[0];if(!i)return t;if(e.italic){const e=document.createElement("i");a.appendChild(e),a=e}if(!n&&e.fontWeight&&["semi-bold","bold","extra-bold"].includes(e.fontWeight)){const e=document.createElement("b");a.appendChild(e),a=e}if("underline"===e.textDecoration){const e=document.createElement("u");a.appendChild(e),a=e}return a.appendChild(i),t}(e.styles,t,Boolean(e.headerLevel))),t.outerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Hn{render(e){const{button:t}=e,{url:n,title:a}=this.process(t.link),i=this.createTextBlockComponent(t,a??n,n),o=this.context.getComponent(r.ComponentName.TextBlock)?.render(i);return o||""}async renderAsync(e){const{button:t}=e,{url:n,title:a}=this.process(t.link),i=this.createTextBlockComponent(t,a??n,n);return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(i).catch(()=>""))}createTextBlockComponent(e,t,n){return{componentName:r.ComponentName.TextBlock,text:t??n,link:n,styles:{textDecoration:"underline",fontWeight:"link"===e.type?void 0:"bold"}}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Rn{render(e){const{thumbnailLink:t}=e,{title:n,description:a,url:i,_showAsAttachment:o}=t.link,s={componentName:r.ComponentName.Video,video:{type:"Video",source:{url:i},name:n,thumbnail:t?.thumbnail,_showAsAttachment:o,description:a}};return this.context.getComponent(r.ComponentName.Video)?.render(s)}async _renderAsync(e){const{thumbnailLink:t}=e,{title:n,description:a,url:i,_showAsAttachment:o}=t.link,s={componentName:r.ComponentName.Video,video:{type:"Video",source:{url:i},name:n,thumbnail:t?.thumbnail,_showAsAttachment:o,description:a}};return this.context.getComponent(r.ComponentName.Video)?.executeRender(s)}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends On{render(e){const{linkUrl:t,altText:n}=e;this._props=e;let a="";return a=this.generateThumbnailProps(e).thumbnailUrl,this._generateImageElement(a,n,t)}async renderAsync(e){const{linkUrl:t,altText:n}=e;return this._generateImageElement(this._imageBuildInfo.thumbnailUrl,n,t)}generateThumbnailProps(e){const{imageUrl:t,width:n,height:a,originalWidth:i,originalHeight:r,cropMode:o,_fileType:s,_sharepointIds:c,cropData:d,_focalX:l,_focalY:u}=e;s&&!He(s)&&ge._TraceLogger.logError(ge._LogSource.create("SPTranspileComponents"),new Error("Unsupported Image Type"),`Unsupported image type: ${s}`);const f={callerId:"Transpile-Components",absoluteUrl:window.location.origin,spResource:t,width:n,height:a,originalWidth:i,originalHeight:r,nonExpiring:!0,cropMode:o,optimizePublicImage:!1,fileType:s};let p;return!D()&&c&&(f.siteId=c.siteId,f.listId=c.listId,f.webId=c.webId,f.uniqueId=c.uniqueId),h._SPKillSwitch.isActivated("def7cb3b-f7d7-4909-aa5e-1ee3cb25d9f0")?p=this.getTranspileThumbnail(f)||t:(d&&(f.viewportWidth=d.cropWidth,f.viewportHeight=d.cropHeight,f.viewportLeft=d.cropX,f.viewportTop=d.cropY),p=this.getTranspileThumbnail(f,l,u)||t),{thumbnailUrl:p}}_generateImageElement(e,t,n){const i={link:e,fileType:a.Image,description:t||void 0},o=this.context.getAttachment(i);if(-1===o)return"";e&&W()&&this.context.processImage(e);const s=document.createElement("div");if(n&&tt(n)){const e={componentName:r.ComponentName.TextBlock,text:n,link:n},t=this.context.getComponent(r.ComponentName.TextBlock)?.render(e);if(t){const e=document.createElement("div");e.innerHTML=t,s.appendChild(e)}}const c=document.createElement("attachment");if(c.id=o.toString(),s.appendChild(c),!W()&&e){const t=_n(this.context.transpileCorrelationId??"",this.componentId,this.distribution,e,void 0,this._props,s.innerHTML);this.context.processImage(e,void 0,t)}return s.innerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Tn{render(e){const t=this._buildImageComponentProps(e);if(!t)return"";const{caption:n,overlayText:a,overlayTextStyles:i,overlayTextHTML:o}=e,s=this.context?.getComponent(r.ComponentName.Image)?.render(t);if(!s)return"";let c,d;if(o&&oe()){const e={componentName:r.ComponentName.RichText,input:o,format:"Html"};c=this.context.getComponent(r.ComponentName.RichText)?.render(e)}else if(a){const e={componentName:r.ComponentName.TextBlock,text:a,styles:{italic:i?.isItalic,fontWeight:i?.isBold?"bold":void 0}};c=this.context.getComponent(r.ComponentName.TextBlock)?.render(e)}if(n){const e={componentName:r.ComponentName.TextBlock,text:n};d=this.context.getComponent(r.ComponentName.TextBlock)?.render(e)}return this._buildWrapper(s,c,d)}async renderAsync(e){const t=this._buildImageComponentProps(e);if(!t)return"";const{caption:n,overlayText:a,overlayTextStyles:i,overlayTextHTML:o}=e,s=await(this.context?.getComponent(r.ComponentName.Image)?.executeRender(t));if(!s)return"";let c,d;if(o&&oe()){const e={componentName:r.ComponentName.RichText,input:o,format:"Html"};c=await(this.context.getComponent(r.ComponentName.RichText)?.executeRender(e))}else if(a){const e={componentName:r.ComponentName.TextBlock,text:a,styles:{italic:i?.isItalic,fontWeight:i?.isBold?"bold":void 0}};c=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e))}if(n){const e={componentName:r.ComponentName.TextBlock,text:n};d=await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(e))}return this._buildWrapper(s,c,d)}_buildImageComponentProps(e){const{linkUrl:t,imageProps:n}=e;if(!Re(n))return;const{source:a,alternateText:i,cropMode:o,targetDimension:s,originalDimensions:c}=n,d=s?.width||c?.width||652,l={componentName:r.ComponentName.Image,imageUrl:a?.url||"",width:d,originalWidth:c?.width,originalHeight:c?.height,linkUrl:t,altText:i,cropMode:o};return this.handleCropping(l,n),a?.sharepointIds&&(l._sharepointIds=a.sharepointIds),l}_buildWrapper(e,t,n){const a=document.createElement("div");if(t){const e=document.createElement("div");e.innerHTML=t,a.appendChild(e)}const i=document.createElement("div");if(i.innerHTML=e,a.appendChild(i),n){const e=document.createElement("div");e.innerHTML=n,a.appendChild(e)}return a.outerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Vn{render(e){return document.createElement("hr").outerHTML}async _renderAsync(e){return document.createElement("hr").outerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends zn{render(e){return h._SPKillSwitch.isActivated("a1329131-bbfb-4644-ab26-c0552e82e0be")?"containerBlocks":"<p>&nbsp;</p>"}async renderAsync(e){return"<p>&nbsp;</p>"}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Gn{render(e){if(!e.thumbnailLink.link.url)return"";const t=this.getFileLink(e);return e.thumbnailLink.link._showAsAttachment?(this._handleAttachment(e),t):t}async executeRenderAsync(e){if(!e.thumbnailLink.link.url)return"";const t=await this.getFileLinkAsync(e);return e.thumbnailLink.link._showAsAttachment?(this._handleAttachment(e),t):t}_handleAttachment(e){const t={link:be.UrlUtility.absolutizeUrl(e.thumbnailLink.link.url),fileType:a.WebLink};this.context.getAttachment(t)}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends qn{render(e){const t=this.getComponentProps(e,!0);return t.thumbnailLink.link._showAsAttachment=e.thumbnailLink.link._showAsAttachment,this.context.getComponent(r.ComponentName.FileCard)?.render(t)}async renderAsync(e){const t=this.getComponentProps(e,!0);return t.thumbnailLink.link._showAsAttachment=e.thumbnailLink.link._showAsAttachment,await(this.context.getComponent(r.ComponentName.FileCard)?.executeRender(t))}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Zn{render(e){const{title:t,address:n}=e,a=document.createElement("div"),i=this.getTitleContent(t);if(i){const e=document.createElement("div");e.innerHTML=i,a.appendChild(e)}const r=this.getAddressContent(n);if(r){const e=document.createElement("div");e.innerHTML=r,a.appendChild(e)}const o=this.getMapImage(e,Ze,Math.round(Ze*c.IMAGE_HEIGHT_RATIO));if(o){const e=document.createElement("div");e.innerHTML=o,a.appendChild(e)}return a.innerHTML}async renderAsync(e){const{title:t,address:n}=e,a=document.createElement("div"),i=await this.getTitleContentAsync(t);if(i){const e=document.createElement("div");e.innerHTML=i,a.appendChild(e)}const r=await this.getAddressContentAsync(n);if(r){const e=document.createElement("div");e.innerHTML=r,a.appendChild(e)}const o=await this.getMapImageAsync(e,Ze,Math.round(Ze*c.IMAGE_HEIGHT_RATIO));if(o){const e=document.createElement("div");e.innerHTML=o,a.appendChild(e)}return a.innerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Qn{render(e){const{cardSize:t,thumbnailLink:n}=e,{url:i,_showAsAttachment:o}=n.link;if(!i)return"";const s=t===r.CardLayout.SmallCard||t===r.CardLayout.MediumCard,c=this.getLinkElement(e,s);if(!o)return c.innerHTML;const d={link:nt(i),fileType:a.WebLink};return this.context.getAttachment(d),c.innerHTML}async renderAsync(e){const{cardSize:t,thumbnailLink:n}=e,{url:i,_showAsAttachment:o}=n.link;if(!i)return"";const s=t===r.CardLayout.SmallCard||t===r.CardLayout.MediumCard,c=await this.getLinkElementAsync(e,s);if(!o)return c.innerHTML;const d={link:nt(i),fileType:a.WebLink};return this.context.getAttachment(d),c.innerHTML}getTitleText(e){const t=be.UrlUtility.absolutizeUrl(e.thumbnailLink.link.url),n=new URL(t).hostname.replace("www.","").replace("https://","");return e.thumbnailLink.link.title?e.thumbnailLink.link.title:n}getDescriptionElement(e){const t=document.createElement("ul"),n=document.createElement("li");return n.innerHTML=e,t.appendChild(n),t}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Nn{render(e){if(!e.person.name)return"";const t=this.generatePersonElement(e);if(e.CardLayout===r.CardLayout.SmallCard)return t.outerHTML;const n=document.createElement("div");n.appendChild(t);const a=this.generateLinkElement(e);a&&n.appendChild(a);const i=this.generateDescriptionElement(e);return i&&n.appendChild(i),n.innerHTML}async renderAsync(e){if(!e.person.name)return"";const t=this.generatePersonElement(e);if(e.CardLayout===r.CardLayout.SmallCard)return t.outerHTML;const n=document.createElement("div");n.appendChild(t);const a=await this.generateLinkElementAsync(e);a&&n.appendChild(a);const i=await this.generateDescriptionElementAsync(e);return i&&n.appendChild(i),n.innerHTML}getPersonName(e){return t=at(e.person.email),et.test(t)?this._getMailToLink(e):super.getPersonName(e);var t}_getMailToLink(e){const t=document.createElement("a");return t.textContent=e.person.name,t.setAttribute("href",`mailto:${at(e.person.email)}`),t.outerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends jn{render(e){if(e.people.length<1)return"";const{cardLayout:t}=e,n=document.createElement("div");return e.people.forEach(e=>{const a=this.generatePeopleCard(e,t);if(a){t!==r.CardLayout.SmallCard&&n.childElementCount>0&&n.appendChild(document.createElement("br"));const e=document.createElement("div");e.innerHTML=a,n.appendChild(e)}}),n.innerHTML}async renderAsync(e){if(e.people.length<1)return"";const{cardLayout:t}=e,n=document.createElement("div");return(await Promise.all(e.people.map(async e=>await this.generatePeopleCardAsync(e,t)))).forEach(e=>{if(e){t!==r.CardLayout.SmallCard&&n.childElementCount>0&&n.appendChild(document.createElement("br"));const a=document.createElement("div");a.innerHTML=e,n.appendChild(a)}}),n.innerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Xn{render(e){const{thumbnailLinks:t,title:n,titleHTML:a}=e;if(0===t.length)return"";const i=document.createElement("div"),r=this.getTitleContent(a,n,void 0,{fontWeight:"bold"});r&&(i.innerHTML=r);const o=this.getLinkListElement(e);return i.appendChild(o),i.outerHTML}async renderAsync(e){const{thumbnailLinks:t,title:n,titleHTML:a}=e;if(0===t.length)return"";const i=document.createElement("div"),r=await this.getTitleContentAsync(a,n,void 0,{fontWeight:"bold"});r&&(i.innerHTML=r);const o=await this.getLinkListElementAsync(e);return i.appendChild(o),i.outerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends aa{render(e){const{personInFocus:t}=e;return t?this.handleListRender(e):""}async renderAsync(e){const{personInFocus:t}=e;return t?this.handleListRenderAsync(e):""}handleReportingPeopleHeading(){const e=document.createElement("div");return e.style.fontWeight="bold",e.style.fontSize="14px",e.style.marginTop="5px",e}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ra{render(e){return this.getCallToActionElement(e,700)}async renderAsync(e){return this.getCallToActionElementAsync(e,700)}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends oa{render(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n};return this.context.getComponent(r.ComponentName.TextBlock)?.render(a)}async renderAsync(e){const{text:t,textStyles:n}=e,a={componentName:r.ComponentName.TextBlock,text:t,styles:n};return await(this.context.getComponent(r.ComponentName.TextBlock)?.executeRender(a).catch(()=>""))}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ea{render(e){return this.getImageGalleryComponent(e,728)}async renderAsync(e){return this.getImageGalleryComponentAsync(e,728)}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends sa{render(e){const{title:t,authors:n,thumbnail:a,titleHtml:i}=e,r=Re(a)?this.getImageContent(e,700,150):"",o=this.getTopicHeaderContent(e),s=this.getTitleContent(i,t),c=this.getAuthorContent(n);return this._assembleBannerContent(r,o,s,c)}async renderAsync(e){const{title:t,authors:n,titleHtml:a}=e,i=await this.getImageContent(e,700,150),r=await this.getTopicHeaderContentAsync(e),o=await this.getTitleContentAsync(a,t),s=await this.getAuthorContentAsync(n);return this._assembleBannerContent(i,r,o,s)}_assembleBannerContent(e,t,n,a){const i=document.createElement("div");if(e){const t=document.createElement("div");t.innerHTML=e,i.appendChild(t)}if(t){const e=document.createElement("div");e.innerHTML=t,i.appendChild(e)}if(n){const e=document.createElement("div");e.innerHTML=n,i.appendChild(e)}if(a){const e=document.createElement("div");e.innerHTML=a,i.appendChild(e)}return i.innerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage,this.componentName=r.ComponentName.Banner}},class extends da{render(e){const{title:t,header:n,showHeader:a,thumbnail:i}=e,o={title:a&&n&&t?$e.StringHelper.format(la.S,n,t):t??""};if(Re(i)){const e=this.createImageComponent(i),t=this.context.getComponent(r.ComponentName.Image)?.render(e);t&&(o.headerImageId=Mn(t))}return JSON.stringify(o)}async renderAsync(e){const{title:t,header:n,showHeader:a,thumbnail:i}=e,o={title:a&&n&&t?$e.StringHelper.format(la.S,n,t):t??""};if(Re(i)){const e=await this.createImageComponent(i),t=await(this.context.getComponent(r.ComponentName.Image)?.executeRender(e).catch(()=>""));t&&(o.headerImageId=Mn(t))}return JSON.stringify(o)}createImageComponent(e){const t={componentName:r.ComponentName.Image,originalWidth:e?.originalDimensions?.width,originalHeight:e?.originalDimensions?.height,imageUrl:e?.source.url??"",width:1e3,height:200,cropMode:"fill"};return"focalPoint"===e?.cropWindow?.type&&(t._focalX=e?.cropWindow?.focalPoint.offsetLeft,t._focalY=e?.cropWindow?.focalPoint.offsetTop),e?.source?.sharepointIds?.siteId&&e?.source?.sharepointIds?.webId&&e?.source?.sharepointIds?.uniqueId&&(t._sharepointIds={siteId:e.source.sharepointIds.siteId,webId:e.source.sharepointIds.webId,listId:e.source.sharepointIds?.listId,uniqueId:e.source.sharepointIds.uniqueId}),t}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends ua{render(e){const{htmlContent:t,ck4InlineImages:n,inlineImages:a}=e;let i=t;return n&&n.size>0&&(i=this._processCK4Images(t,n)),i=this._fixLinks(this.processImages(i,a))??"",i?Mt(i??"",e?.rteStylingOptions):""}async renderAsync(e){return Mt(this._processedHtmlContent,e?.rteStylingOptions)}processImages(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html");return n.querySelectorAll(this._imageClass).forEach(e=>{const n=this._prepareImageComponent(e,t);n&&this.insertInlineImages(e,[n])}),n.body.innerHTML}async processImagesAsync(e,t){if(!e||-1===e.indexOf("imagePlugin"))return e;const n=(new DOMParser).parseFromString(e,"text/html"),a=n.querySelectorAll(this._imageClass);for(const e of Array.from(a)){const n=this._prepareImageComponent(e,t);n&&await this.insertInlineImagesAsync(e,[n])}return n.body.innerHTML}_prepareImageComponent(e,t){const n=e.querySelector(this._imageTag);if(!n)return;const a=this.extractImageProp(n,t);if(e.removeChild(n),!a)return;const{source:{url:i,sharepointIds:o},naturalHeight:s,naturalWidth:c,isImageShape:d,link:l,overlay:u,width:f,caption:p,altText:m}=a;if(!i)return;const _={componentName:r.ComponentName.RichImage,imageProps:{source:{url:i},alternateText:m,originalDimensions:{width:c,height:s},targetDimension:{width:f}},caption:p};if(!d&&s&&c&&c>f&&(_.imageProps.cropWindow={type:"viewport",viewport:{width:c,height:s,x:0,y:0}}),l&&(_.linkUrl=l),u&&u?.text&&u?.styles){_.overlayText=u?.text;const e=u?.styles;_.overlayTextStyles={isBold:e?.isBold,isItalic:e?.isItalic}}return D()||(_.imageProps.source.sharepointIds=o),_}constructor(...t){super(...t),this.distribution=e.VivaEngage,this._containerType="div"}},class extends Ia{render(e){return""}constructor(...e){super(...e),this.componentName=r.ComponentName.Screenshot,this.distribution=xa.VivaEngage}},class extends Oa{render(e){return this.getSimpleInfoCard(e,Ze).innerHTML}async renderAsync(e){return(await this.getSimpleInfoCardAsync(e,Ze)).innerHTML}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends wa{render(e){const t=this._getFileCardProps(e);return t?this.context.getComponent(r.ComponentName.FileCard)?.render(t):""}async renderAsync(e){const t=this._getFileCardProps(e);return t?this.context.getComponent(r.ComponentName.FileCard)?.executeRender(t):""}_getFileCardProps(e){const{video:t}=e;if(!this._hasVideo(t))return;const{source:n,name:a,_showAsAttachment:i,thumbnail:o,description:s}=t;return{componentName:r.ComponentName.FileCard,thumbnailLink:{link:{title:a??n.url??"",url:nt(n.url??""),_showAsAttachment:i,description:s},thumbnail:o}}}constructor(...t){super(...t),this.distribution=e.VivaEngage}},class extends Pa{render(e){return this.processInput(e)}constructor(...t){super(...t),this.distribution=e.VivaEngage}}],e.VivaEngage),Na={[e.Email]:Ua,[e.Teams]:Fa,[e.Web]:Ua,[e.VivaEngage]:Ha};class Ba{build(e){const{componentList:n,distributionType:a,context:i,componentLogging:r}=e,o=new ge._QosMonitor("TranspileWebpartBuilder"),s={alias:r.webpartAlias,webpartId:r.webpartId,transpileCorrelationId:r.eventId,distributionType:t[a],product:r.product,errorList:[],componentList:[]},c=[],d=[],l=this._getFactory(a,i,{addError:e=>{s.errorList.push(...e)},addWarning:e=>d.push(e),logQosEvent:(e,t,n,a)=>{R()||this._qosEventLogger(e,t,{...s,...n},a)}});if(!l){const e="Factory failed to initialize";s.errorList.push({errorType:$e.ResultTypeEnum.Failure,error:new Error(e),errorMessage:e})}for(const e of n){s.componentList.push(e.componentName);try{const t=l?.renderComponent(e);if(t)c.push(t);else{const t="Returned undefined or empty";s.errorList.push({errorType:$e.ResultTypeEnum.ExpectedFailure,errorMessage:t,error:new Error(t),componentName:e.componentName})}}catch(t){s.errorList.push({errorType:$e.ResultTypeEnum.Failure,error:t,errorMessage:t.message,componentName:e.componentName})}}let u,f;if(0===s.errorList.length)o.writeSuccess(s);else{f=s.errorList.find(e=>e.errorType===$e.ResultTypeEnum.Failure),f?o.writeUnexpectedFailure(f.error.message,f.error,s):(f=s.errorList[0],o.writeExpectedFailure(f.error.message,f.error,s));const e=f?.errorMessage??"Webpart Unknown error";u={errorType:f?.errorType??$e.ResultTypeEnum.Failure,error:f?.error??new Error(e),errorMessage:e,componentName:f?.componentName}}return{content:c,errorData:u,warningList:d}}async buildAsync(e){const{componentList:n,distributionType:a,context:i,componentLogging:r}=e,o=new ge._QosMonitor("TranspileWebpartBuilderAsync"),s={alias:r.webpartAlias,webpartId:r.webpartId,transpileCorrelationId:r.eventId,distributionType:t[a],product:r.product,errorList:[],componentList:[],logList:[]},c=[],d=[],l=this._getFactory(a,i,{addError:e=>{s.errorList.push(...e)},addWarning:e=>c.push(e),addLogging:e=>{s.logList?.push(e)},logQosEvent:(e,t,n,a)=>{R()||this._qosEventLogger(e,t,{...s,...n},a)}});if(!l){const e="Factory failed to initialize";s.errorList.push({errorType:$e.ResultTypeEnum.Failure,error:new Error(e),errorMessage:e})}for(const e of n){s.componentList.push(e.componentName);try{const t=await(l?.renderComponentAsync(e));if(t)d.push(t);else{const t="Returned undefined or empty";s.errorList.push({errorType:$e.ResultTypeEnum.ExpectedFailure,errorMessage:t,error:new Error(t),componentName:e.componentName})}}catch(t){s.errorList.push({errorType:$e.ResultTypeEnum.Failure,error:t,errorMessage:t.message,componentName:e.componentName})}}let u,f;if(0===s.errorList.length)o.writeSuccess(s);else{f=s.errorList.find(e=>e.errorType===$e.ResultTypeEnum.Failure),f?o.writeUnexpectedFailure(f.error.message,f.error,s):(f=s.errorList[0],o.writeExpectedFailure(f.error.message,f.error,s));const e=f?.errorMessage??"Webpart Unknown error";u={errorType:f?.errorType??$e.ResultTypeEnum.Failure,error:f?.error??new Error(e),errorMessage:e,componentName:f?.componentName}}return{content:d,errorData:u,warningList:c}}_getFactory(t,n,a){let i=this._factories.get(t);return void 0===i&&(i=Na[t],t===e.VivaEngage&&n.transpileEngageAsHtml&&(i=Ra),i&&(i?.initialize(n,a),this._factories.set(t,i))),i}_qosEventLogger(e,t,n,a){const i=new ge._QosMonitor(e);t===$e.ResultTypeEnum.Success?i.writeSuccess(n):t===$e.ResultTypeEnum.ExpectedFailure?i.writeExpectedFailure("Expected failure occurred",a,n):t===$e.ResultTypeEnum.Failure&&i.writeUnexpectedFailure("Unexpected failure occurred",a,n)}constructor(){this._factories=new Map}}function ja(e,t){e=lt(e),t=lt(t);const n=new DOMParser,a=n.parseFromString(e.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html"),i=n.parseFromString(t.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html");za(a.body,i.body)}function Va(e,t){if(e!==t)throw new Error(`Expected: ${e} | Received: ${t}`)}function za(e,t){const n=Array.from(e.childNodes).sort((e,t)=>e.nodeName.localeCompare(t.nodeName)),a=Array.from(t.childNodes).sort((e,t)=>e.nodeName.localeCompare(t.nodeName)),i=n.map(e=>e.nodeName).join(", "),r=a.map(e=>e.nodeName).join(", ");Va(`ChildElementCheck: Node: ${e.nodeName} | Children Count: ${n.length} Names: ${i}`,`ChildElementCheck: Node: ${t.nodeName} | Children Count: ${a.length} Names: ${r}`),function(e,t){try{Va(`AttributeCount Node: ${e.nodeName} | AttributeLength: ${e.attributes.length} Name: ${Array.from(e.attributes).sort((e,t)=>e.name.localeCompare(t.name)).map(e=>e.name).join(", ")}`,`AttributeCount Node: ${t.nodeName} | AttributeLength: ${t.attributes.length} Name: ${Array.from(t.attributes).sort((e,t)=>e.name.localeCompare(t.name)).map(e=>e.name).join(", ")}`);for(let n=0;n<e.attributes.length;n++){const a=Ga(e.attributes[n]),i=Ga(t.attributes.getNamedItem(e.attributes[n].name)??void 0);Va(`Node: ${e.nodeName} | AttrName: ${e.attributes[n].name} AttributeValue: ${a}`,`Node: ${t.nodeName} | AttrName: ${e.attributes[n].name} AttributeValue: ${i}`)}}catch(n){throw new Error(`Error in compareElementAttributes failed:\n      Failure : ${n}\n      SourceElement : ${e.outerHTML}\n      TargetElement : ${t.outerHTML}`)}}(e,t),function(e,t){const n=e.style.length,a=t.style.length;Va(`StyleCount: Element: ${e.nodeName} Value: ${n}`,`StyleCount: Element: ${t.nodeName} Value: ${a}`);for(let n=0;n<e.style.length;n++){const a=e.style[n],i=e.style.getPropertyValue(a),r=t.style.getPropertyValue(a);if(!r)throw new Error(`StyleCompare: Element: ${e.nodeName} Value: ${a} not found in target`);Va(`StyleCompare: Element: ${e.nodeName} Name: ${a} Value: ${i}`,`StyleCompare: Element: ${e.nodeName} Name: ${a} Value: ${r}`)}}(e,t);for(let t=0;t<n.length;t++)if("styles"!==n[t].nodeName)if(n[t].nodeType===Node.TEXT_NODE){const e=n[t].textContent??"",i=a[t].textContent??"";Va(`TextNodeCompare: Element: ${n[t].nodeName} Value: ${e}`,`TextNodeCompare: Element: ${a[t].nodeName} Value: ${i}`)}else if(n[t].nodeType===Node.ELEMENT_NODE)za(n[t],a[t]);else{if(n[t].nodeType!==Node.COMMENT_NODE)throw new Error(`Node Type is not supported ${e.childNodes[t].nodeType}`);Va(`CommentNode: ${n[t].textContent}`,`CommentNode: ${a[t].textContent}`)}}function Ga(e){return e?e.value.split(":").map(e=>e.trim().replace(";","")).join(":"):""}var Ka;function Wa(e,t){const n=e.getAttribute(t);return n?parseFloat(n):NaN}function qa(e){const t=function(e){const t=window.getComputedStyle(e);return parseFloat(t.width)+parseFloat(t.paddingLeft)+parseFloat(t.paddingRight)}(e),n=function(e){return Wa(e,"width")}(e);return isNaN(n)?t:n}function Qa(e){e.forEach(e=>{if(1===e.type){const t=e;ge._TraceLogger.logVerbose(ge._LogSource.create("EmailTranspiler"),`Parent: ${t.parent.tagName}, Parent TestId: ${t.parent.dataset.testid} Parent Width: ${t.parentWidth}, Render Width: ${t.renderWidth}`)}else if(0===e.type){const t=e;ge._TraceLogger.logVerbose(ge._LogSource.create("EmailTranspiler"),`Parent: ${t.parent.tagName}, Parent TestId: ${t.parent.dataset.testid} Child: ${t.child.tagName}, Child TestId: ${t.child.dataset.testid} Parent Width: ${t.parentWidth}, Child Width: ${t.childWidth}`)}})}function Ya(e,t=[]){const n=qa(e),a=Array.from(e.children),i=Wa(e,"max-width");return i>0&&n>i&&t.push({parent:e,parentWidth:n,renderWidth:i,type:1}),a.forEach(a=>{const i=qa(a);i>n&&t.push({parent:e,child:a,parentWidth:n,childWidth:i,type:0}),Ya(a,t)}),t}function Ja(e){return Xa((new DOMParser).parseFromString(e.replace(/\s*(<[^>]+>)\s*/g,"$1"),"text/html").body)}function Xa(e){return Ya(e,[])}!function(e){e[e.ParentChild=0]="ParentChild",e[e.WidthRender=1]="WidthRender"}(Ka||(Ka={}))})(),m})())})();