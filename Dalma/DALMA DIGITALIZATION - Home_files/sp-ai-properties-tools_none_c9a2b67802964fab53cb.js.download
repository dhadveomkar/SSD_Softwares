define("032387a1-2bf5-4391-9c65-77a9f103d0af_0.12.7",["@microsoft/sp-lodash-subset","@msinternal/sp-ai-properties","@msinternal/sp-canvas-types"],(e,t,n)=>(()=>{"use strict";var a={529:t=>{t.exports=e},232:e=>{e.exports=t},560:e=>{e.exports=n}},i={};function r(e){var t=i[e];if(void 0!==t)return t.exports;var n=i[e]={exports:{}};return a[e](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};return(()=>{r.r(o),r.d(o,{AICanvas:()=>M,AIColumn:()=>w,AIControl:()=>O,AIControlFlexibleLayoutPosition:()=>C,AIPage:()=>K,AIPropertiesDataProcessByProduct:()=>Z,AIPropertiesIntegration:()=>xe,AIPropertiesLevel:()=>W,AIPropertiesRegistration:()=>Y,AIRegularLayout:()=>L,AIRte:()=>V,AISection:()=>A,AISectionBackground:()=>E,AIVerticalLayout:()=>k,AI_PROPERTIES_DESCRIPTION_KEY:()=>f,CAN_BE_USED_IN_FULL_WIDTH_SECTION_KEY:()=>p,CONTROL_AI_PROPERTIES_ALIAS_KEY:()=>t,CONTROL_AI_PROPERTIES_ID_KEY:()=>n,CONTROL_AI_PROPERTIES_JSON_SCHEMA_KEY:()=>a,CONTROL_AI_PROPERTIES_KEY:()=>e,DATA_CONTRACT_SYSTEM_PROMPTS:()=>x,READ_ONLY_WEB_PART_AI_PROPERTIES_ALIAS:()=>d,READ_ONLY_WEB_PART_AI_PROPERTIES_DESCRIPTION:()=>l,READ_ONLY_WEB_PART_AI_PROPERTIES_ID:()=>c,READ_ONLY_WEB_PART_AI_PROPERTIES_SCHEMA:()=>G,READ_ONLY_WEB_PART_DATA_FIELD:()=>u,RTE_AI_PROPERTIES_ALIAS:()=>s,RTE_AI_PROPERTIES_ID:()=>i,RTE_AI_PROPERTIES_SCHEMA:()=>z,VIBE_AUTHORING_EVENT_NAME:()=>m,createRichTextPrompt:()=>N,forEachControlInAICanvas:()=>g,forEachControlInAICanvasAsync:()=>v,fromCanvasBackgroundDataToSectionBackgroundResult:()=>ae,fromCanvasBackgroundStringToSectionBackgroundResult:()=>ne,fromSPVariantThemeTypeToSectionEmphasisName:()=>te,fromSectionBackgroundResultToCanvasBackgroundData:()=>ie,fromSectionBackgroundResultToCanvasBackgroundString:()=>re,getAIPropertiesFromSchema:()=>Q,getControlAIPropertiesSchemaFromManifests:()=>X,getDefaultAIPropertiesSystemPromptValues:()=>j,getLevelFromAIPropertiesData:()=>He,getSectionAlignmentFromZoneGroupMetadata:()=>se,getSectionFactorsFromLayoutType:()=>_,getSectionLayoutFromSectionFactors:()=>q,getWebPartAIPropertiesSchemaFromManifest:()=>J,getZoneGroupDisplayName:()=>ce,immutableMerge:()=>b,isAICanvasData:()=>we,isAIColumnDataOrVerticalLayoutData:()=>Ce,isAIControlData:()=>Pe,isAIControlDataAIProperties:()=>Me,isAIControlDataRaw:()=>ke,isAIControlDataRawRTE:()=>Le,isAIControlDataRawWebPart:()=>Ae,isAIImageReadyData:()=>ee,isAIPageData:()=>Te,isAIRegularLayoutData:()=>Oe,isAISectionData:()=>Ee,mapFlexibleLayoutPositionToRaw:()=>S,mapRawToFlexibleLayoutPosition:()=>D,mergeFavoringOverrides:()=>de,parseZoneGroupMetadata:()=>oe,validateAIPropertiesLevel:()=>Ue,validateRewriteLevel:()=>Fe});const e="control_AI_properties",t="control_AI_properties_alias",n="control_AI_properties_id",a="control_AI_properties_JSON_schema",i="SP_RTE",s="RichTextEditor",c="AIReadOnlyWebPart",d="ReadOnlyWebPart",l="This is a wrapper schema for all web parts that do not support AI-properties.",u="data_DO_NOT_CHANGE",f="when_to_use",p="can_be_used_in_full_width_section",m="vibe_event";function _(e){switch(e){case"fullWidth":return[0];case"twoColumns":return[6,6];case"threeColumns":return[4,4,4];case"oneThirdLeftColumn":return[4,8];case"oneThirdRightColumn":return[8,4];case"flexible":return[100];default:return[12]}}var h=r(529);function b(e,t){return(0,h.merge)({},e,t)}function g(e,t){for(const n of e.regularLayout.sections)for(const e of n.columns)for(const n of e.controls)t(n);if(e.verticalLayout?.controls)for(const n of e.verticalLayout.controls)t(n)}async function v(e,t){const n=[];for(const a of e.regularLayout.sections)for(const e of a.columns)for(const a of e.controls)n.push(t(a));if(e.verticalLayout?.controls)for(const a of e.verticalLayout.controls)n.push(t(a));await Promise.all(n)}function y(e){return void 0!==e.lg}function S(e,t){if(!e)return;const n=y(e)?e.lg:e;if(!n)return;const{x:a,y:i,w:r,h:o,dataVersion:s}=n,c={x:a,y:i,width:r,height:o,dataVersion:s},d=y(e)?e.groupId:t?.groupIdOverride;return d&&(c.groupId=d),c}function D(e){if(!e)return;const{x:t,y:n,width:a,height:i,dataVersion:r,groupId:o}=e;if("number"!=typeof t||"number"!=typeof n)return;if("number"!=typeof a||"number"!=typeof i)return;const s={x:t,y:n,w:a,h:i};return r&&(s.dataVersion=r),{lg:s,...o?{groupId:o}:{}}}var I=r(232);const x={[e]:{id:`The id of the ${e}. It must match ${n} from one of the available ${e}.`,data:`The data of the ${e}. It must be an object that follows the JSON schema defined in ${a} from one of the available ${e}.`},[f]:{[i]:"Rich-text editor to render HTML markup, powered by CKEditor 5."},canvas:{control:"Control is primitive UX building blocks in SharePoint Pages. It is either a RTE or a SPFX web part.",column:"A column is a vertical space inside a section. Columns provide the structure for placing controls. When editing a page, you first add a section, then choose its layout, which determines the number and arrangement of columns.",section:"A section is a horizontal building block used to design modern SharePoint pages. It provides the structure for how content is organized, acting as a row that can contain one or more columns. Sections are added when a page is in Edit mode and appear as part of the page layout.",title_of_collapsible_section:"The title of a collapsible section is the visible header shown at the top of the section. A collapsible section is a standard section with an added option that allows it to expand or collapse on demand. This is empty in most cases. Only used when section is collapsible.",section_layout:"Section layout defines how columns are arranged within a section. The layout determines the number of columns, their relative widths, and how web parts can be placed. When adding a section in Edit mode, you choose a layout to control how content will be organized.",section_alignment:"Section alignment is how content inside multiple columns is vertically aligned. This setting controls whether web parts in different columns start at the same top position, are centered, or aligned to the bottom of the section.",section_emphasis:"Section emphasis controls the visual background style of a section. It helps distinguish one section from another, highlight important content, or provide visual rhythm on a page. Emphasis is applied at the section level and affects all its columns and web parts.",section_background:"Section background defines the visual treatment behind all columns and controls. It can include images, overlays, or other styling that ensures foreground content remains readable.",section_background_overlay:"The overlay applied to a section background is a translucent color or gradient that sits above the background image. Use it to improve contrast for text and web parts. Provide color and opacity when needed.",section_background_use_light_text:"Set this to true when the background requires light-colored foreground text to maintain readability. Keep it false when standard or dark text provides sufficient contrast.",control_flexible_layout_position:"Flexible layout positioning allows controls to be placed precisely on a grid. Provide integer x and y coordinates (measured in grid columns and rows) along with optional width and height in grid units. Use this only when the section layout is flexible. Flexible sections contain a grid that has 70 columns total.",canvas:"The canvas is the main surface of a modern SharePoint page. Regular layouts are horizontal sections with columns for main content. A vertical layout is an optional side column for supporting web parts.",instance_id:"A unique identifier for a specific instance on the page. It must be globally unique within the page and remain stable once assigned — it should never change for the same instance across updates."},page:{page_description:"Each page can have a description set in the Page details pane. This description summarizes the purpose or content of the page. It does not appear directly on the page body but is used in search results, link previews, and some page listings (such as in News web parts or site search).",page:"A page is a list item in the Site Pages library with metadata fields and canvas content."}};class C extends I.BaseAIObject{get classUniqueId(){return C.classUniqueId}getDefaultSystemPrompt(){return x.canvas.control_flexible_layout_position}initDefaultMetadata(){return{dataUsage:I.VIBE_AUTHORING_ONLY_DATA_USAGE}}initStructure(){return{x:new I.AINumber({customMetadata:{dataUsage:"required"}}),y:new I.AINumber({customMetadata:{dataUsage:"required"}}),width:new I.AINumber({customMetadata:{dataUsage:"optional"}}),height:new I.AINumber({customMetadata:{dataUsage:"optional"}})}}}C.classUniqueId="ec0477d6-1702-4f88-ba56-62c41f3012dc";class O extends I.BaseAIObject{get classUniqueId(){return O.classUniqueId}getDefaultSystemPrompt(){return x.canvas.control}initStructure(){return{controlAIPropertiesId:new I.AIText({customPrompts:{systemPromptForAI:x.control_AI_properties.id}}),controlAIPropertiesData:new I._AIFreeFormObject({customPrompts:{systemPromptForAI:x.control_AI_properties.data}}),instanceId:new I.AIText({customPrompts:{systemPromptForAI:x.canvas.instance_id},customMetadata:{regex:"^c_[a-z0-9]{4}$",dataUsage:{generationUsage:I.UsageLevel.SHOULD_NOT,vibeAuthoringUsage:I.UsageLevel.MUST,informationUsage:I.UsageLevel.MUST_NOT}}}),flexibleLayoutPosition:new C({customMetadata:{dataUsage:I.VIBE_AUTHORING_ONLY_DATA_USAGE}})}}}O.classUniqueId="a462f512-f021-4e03-a8f0-4bb9321bf498";class w extends I.BaseAIObject{get classUniqueId(){return w.classUniqueId}getDefaultSystemPrompt(){return x.canvas.column}initStructure(){return{controls:new I.AIArray({element:new O})}}}w.classUniqueId="556057d2-0e2b-4f56-9bf0-7760164592b6";class E extends I.BaseAIObject{get classUniqueId(){return E.classUniqueId}getDefaultSystemPrompt(){return x.canvas.section_background}initStructure(){return{image:new I.AIImage({variantConfiguration:{readyVariantOverrides:{customPrompts:{systemPromptForAI:"Background image for the section."}}},imageUsage:"Background"}),overlay:new I._AIFreeFormObject({customPrompts:{systemPromptForAI:x.canvas.section_background_overlay},customMetadata:{dataUsage:I.VIBE_AUTHORING_ONLY_DATA_USAGE}}),useLightText:new I.AIBoolean({customPrompts:{systemPromptForAI:x.canvas.section_background_use_light_text},customMetadata:{dataUsage:I.VIBE_AUTHORING_ONLY_DATA_USAGE}})}}}E.classUniqueId="d913ec4a-532a-4021-b7f9-79384e38a0ca";class A extends I.BaseAIObject{get classUniqueId(){return A.classUniqueId}initStructure(){return{id:new I.AIText({customPrompts:{systemPromptForAI:x.canvas.instance_id},customMetadata:{regex:"^s_[a-z0-9]{4}$",dataUsage:{generationUsage:I.UsageLevel.SHOULD_NOT,vibeAuthoringUsage:I.UsageLevel.MUST,informationUsage:I.UsageLevel.MUST_NOT}}}),columns:new I.AIArray({customMetadata:{minItems:1,maxItems:3},element:new w}),sectionBackground:new E({customMetadata:{dataUsage:"optional"}}),titleOfCollapsibleSection:new I.AIText({customPrompts:{systemPromptForAI:x.canvas.title_of_collapsible_section},customMetadata:{dataUsage:"optional"}}),layout:new I.AIStringUnion({customPrompts:{systemPromptForAI:x.canvas.section_layout},union:[{value:"oneColumn",description:"Contains one column spanning the section. Can host multiple web parts stacked vertically."},{value:"twoColumns",description:"Contains two equal-width columns. Each column can hold multiple web parts stacked vertically."},{value:"threeColumns",description:"Contains three equal-width columns. Each column can hold multiple web parts stacked vertically."},{value:"oneThirdLeftColumn",description:"Contains 2-column split: left 1/3, right 2/3. Each column can hold multiple web parts stacked vertically."},{value:"oneThirdRightColumn",description:"Contains 2-column split: left 2/3, right 1/3. Each column can hold multiple web parts stacked vertically."},{value:"flexible",description:"Enables a free-form grid where controls can be positioned using x/y coordinates. Use this layout to place controls precisely within the section.",dataUsage:I.VIBE_AUTHORING_ONLY_DATA_USAGE},{value:"fullWidth",description:`Contains a special edge-to-edge column that spans the page and can contain only one web part. Prefer this layout for large visual or banner-style web parts such as Hero, Banner. Prefer this layout over others when the section contains a single control that supports fullWidth. Only supported controls may be placed here. Whether a control can be placed in a full-width column is indicated by "${p}".`}],defaultValue:"oneColumn"}),alignment:new I.AIStringUnion({customPrompts:{systemPromptForAI:x.canvas.section_alignment},union:["Top","Center","Bottom"],defaultValue:"Top",customMetadata:{dataUsage:"optional"}}),emphasis:new I.AIStringUnion({customPrompts:{systemPromptForAI:x.canvas.section_emphasis},union:[{value:"None",description:"Default and most common, no special background; the section inherits the default page background."},{value:"Soft",description:"A light background shade that adds subtle contrast without being distracting."},{value:"Neutral",description:"A mid-tone background that provides clear separation between sections."},{value:"Strong",description:"A darker or more saturated background to highlight or call out important content."}],defaultValue:"None",customMetadata:{dataUsage:"optional"}})}}getDefaultSystemPrompt(){return x.canvas.section}}A.classUniqueId="09abf971-d4f8-4708-baf9-7c7036e3e564";class L extends I.BaseAIObject{get classUniqueId(){return L.classUniqueId}initStructure(){return{sections:new I.AIArray({element:new A})}}getDefaultSystemPrompt(){}}L.classUniqueId="78c04bbe-1722-4cff-a397-2bef4e1a69e4";class k extends I.BaseAIObject{get classUniqueId(){return k.classUniqueId}initStructure(){return{controls:new I.AIArray({element:new O})}}getDefaultSystemPrompt(){return x.canvas.canvas}initDefaultMetadata(){return{dataUsage:{generationUsage:I.UsageLevel.SHOULD_NOT,vibeAuthoringUsage:I.UsageLevel.MAY}}}}k.classUniqueId="041a011f-af37-4248-a38a-11ddbcff27f1";class M extends I.BaseAIObject{get classUniqueId(){return M.classUniqueId}initStructure(){return{regularLayout:new L,verticalLayout:new k}}getDefaultSystemPrompt(){return x.canvas.canvas}}M.classUniqueId="9f3d08f4-d262-4ff8-b8d9-85c0bb342aa0";const P=["p","br","hr","strong","em","b","i","u","s","sub","sup","mark"],T=["h1","h2","h3","h4","h5","h6"],U=["ul","ol","li"],F=["a","code","pre","blockquote"],H=["table","thead","tbody","tr","th","td"],R=["div","span"];function N(e={includeBasicText:!0,includeHeadings:!0,includeLists:!0,includeInteractive:!0,includeTables:!0,includeContainers:!0}){const t=[];return e.includeBasicText&&t.push(...P),e.includeHeadings&&t.push(...T),e.includeLists&&t.push(...U),e.includeInteractive&&t.push(...F),e.includeTables&&t.push(...H),e.includeContainers&&t.push(...R),`Rich formatted text using following tags - ${n=t,n.map(e=>`<${e}>`).join(", ")}. Tables should avoid overcrowding when placed in narrow page columns: there are no constraints on the number of table columns in a "oneColumn" section layout, but in a "twoColumns" layout tables should preferably have fewer than six columns per row, and in a "threeColumns" layout tables should preferably have fewer than four columns per row.`;var n}const B={primitives:{text:"Plain text.",readOnlyWebPartManifestId:"Manifest ID of a SPFx web part. Never update this value.",readOnlyWebPartDataString:"Serialized SharePoint web part payload preserved as an opaque string. Keep it exactly as provided—never rewrite, reformat, or fabricate any portion of it.",identifier:{default:"An identifier which can be a guid, file name, or other reference format. Do not fabricate or guess identifiers. Use the identifiers provided in the input. Focus on extracting exact identifiers without modification. Do not fabricate GUIDs or file paths.",imageReference:"Use the identifier to reference images accurately without modification or fabrication.",instanceId:"A unique instance identifier.",task:"A unique identifier for an asynchronous task."},richText:N(),richTextForTextWebPart:{additionalSystemPrompt:"Prefer to include bullet points or tables."},emailAddress:"A valid email address.",peopleDisplayName:"A valid person display name.",url:"A valid, real-world URL. Never fabricate or guess URLs.",decorativeImageKeyword:'Identify the core visual theme and pick exactly one keyword (1–3 English words, noun or noun phrase) that isn\'t an internal code or generic header (e.g., "Overview"), ensure it maps to a common, high-quality stock-photo subject, and output only that keyword.',boolean:"Must be either true or false.",webPartTitle:"Title of the web part.",date:"Must be a valid date string supported by JS Date.parse()."},objects:{heroItem:"An actionable item with link, name, description and optional decorative image to highlight or promote.",people:"A valid person (e.g., Can be found via Microsoft Graph API).",link:"A link that includes a name and a URL.",linkExternal:"A real url (DO NOT MAKE IT UP)",linkExternalOrSPFile:"Either a real url (DO NOT MAKE IT UP) or an entity reference with `<File>` that wrap entity from search results.You **must always** annotate all named entities **exactly as they appear** in tool outputs (e.g., `<File>document title</File>`).",linkSPFile:"An entity reference with `<File>` that wrap entity from search results.You **must always** annotate all named entities **exactly as they appear** in tool outputs (e.g., `<File>document title</File>`).",aiImageStock:"Search for an APPROVED stock source (preferred default) for decorative images.",aiImageReference:"Point to an EXISTING asset by its exact identifier. No edits, no generation, no guesses—identifier only.",aiImageReady:"Describe FINALIZED image data. Avoid using same image on same page by default.",spFileMetadata:"Provide the SharePoint identifiers (siteId, webId, listId, uniqueId) exactly as supplied; do not fabricate or alter GUIDs. Omit the entire field if any identifier is missing.",readOnlyWebPart:"A read-only SharePoint web part payload. Preserve manifestId and data exactly as provided; You can duplicate/delete/move the entire payload, but never create/update the payload."},arrays:{default:"An array of items. Only create as many as the content justifies; Do not invent additional material or using unrelated material. Do not generate duplicate items.",defaultRequireGrounding:"Only create as many as the content justifies; Do not invent additional material or using unrelated material; Do not generate duplicate items."}};function j(){return B}class V extends I.BaseAIObject{get classUniqueId(){return V.classUniqueId}getDefaultSystemPrompt(){}initStructure(){return{innerHTML:new I.AIRichTextForTextWebPart}}}V.classUniqueId="d7fc5d13-f7cd-4623-ae04-5dac09bbb5fa";const z={[n]:i,[t]:s,[a]:(0,I._getAIPropertiesJSON)(new V,{description:void 0,includingReinstantiationParams:!0,systemPrompts:j(),useSchemaId:!0}),[f]:x.when_to_use.SP_RTE,[p]:!1},G={[n]:c,[t]:d,[a]:(0,I._getAIPropertiesJSON)(new I._AIReadOnlyWebPart,{description:void 0,includingReinstantiationParams:!0,systemPrompts:j(),useSchemaId:!0}),[f]:l,[p]:!1};class K extends I.BaseAIObject{get classUniqueId(){return K.classUniqueId}initStructure(){return{pageDescription:new I.AIText({customPrompts:{systemPromptForAI:x.page.page_description},customMetadata:{dataUsage:"optional"}}),canvas:new M}}getDefaultSystemPrompt(){return x.page.page}}var W;function q(e){try{return 0===e[0]?"fullWidth":12===e[0]?"oneColumn":6===e[0]?"twoColumns":8===e[0]?"oneThirdRightColumn":100===e[0]?"flexible":4===e[1]?"threeColumns":8===e[1]?"oneThirdLeftColumn":"oneColumn"}catch(e){return"oneColumn"}}function Q(e,t){const n={},a=function(e,t){return function(e){const t=e.definitions;if(!t||Array.isArray(t))return;const n=t[I._AI_PROPERTIES_SCHEMA_CLASS_ID_DEFINITION_KEY];if(!n||"boolean"==typeof n)return;const a=n.const;return"string"==typeof a&&a?a:void 0}(e)??function(e,t){if(!e)return;if(t.registration.has(e))return e;const n=e.lastIndexOf("_");if(-1===n)return;const a=e.substring(n+1);return t.registration.has(a)?a:void 0}(e.$id,t)}(t,e);if(a){const i=e.registration.get(a)?.constructor;if(!i)throw new Error(`Schema id ${t.$id??"<unknown>"} does not map to any registered AI-properties.`);const r=t.definitions?.params,o=r&&"boolean"!=typeof r&&r.description?JSON.parse(r.description):void 0;let s;if(a===I.AIArray.classUniqueId){if(!t.items)throw new Error('Missing "items" in array schema');const n=Q(e,t.items);s=new i({...o,element:n})}else if(a===I.AIPropertiesUnion.classUniqueId){if(!t.oneOf)throw new Error("Union schema must contain oneOf branches");const n=t.oneOf.map(t=>{if("boolean"==typeof t)throw new Error("Boolean schema branch unsupported for union");const n=t.properties;if(!n||"object"!=typeof n.variantKey)throw new Error("Invalid union branch: missing variantKey");const a=n.variantKey.const;if("string"!=typeof a)throw new Error("variantKey const must be string");const i=n.variantKey.description,{properties:r,required:o,...s}=t;if(!r)throw new Error("Union branch missing properties");const c={...r};let d;if(delete c.variantKey,1===Object.keys(c).length&&Object.prototype.hasOwnProperty.call(c,"value")&&"boolean"!=typeof c.value)d=c.value;else{const e=Array.isArray(o)?o.filter(e=>"variantKey"!==e):void 0;d={...s,properties:c,...e&&e.length>0?{required:e}:{},type:"object"}}const l=Q(e,d);if(!(l instanceof Object))throw new Error("Variant AI-properties instantiation failed");return{key:a,aiProperties:l,description:i}});s=new I.AIPropertiesUnion({options:{variants:n}})}else if(a===I.CustomAIObject.classUniqueId){const a=t.properties;for(const t in a)Object.prototype.hasOwnProperty.call(a,t)&&(n[t]=Q(e,a[t]));s=new i({...o,structure:n})}else if(a===I._AIFreeFormObject.classUniqueId){const e=o??{},n=function(e){const t={...e},{definitions:n}=e;if(n&&!Array.isArray(n)){const e=Object.entries(n).filter(([e])=>"params"!==e&&e!==I._AI_PROPERTIES_SCHEMA_CLASS_ID_DEFINITION_KEY);t.definitions=e.length>0?Object.fromEntries(e):void 0}return t}(t),a={...e,options:{...e.options??{},schema:{type:"jsonSchema7",schema:n}}};s=new I._AIFreeFormObject(a)}else s=new i(o);return s}const i=t.properties;if(i){for(const t in i)Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=Q(e,i[t]));return n}throw new Error("Invalid schema. Every left of a valid AI-properties schema must be a registered AI-properties.")}K.classUniqueId="82d039e1-3377-4c40-9b8d-7a9ca780e353",function(e){e.Control="Control",e.Column="Column",e.Section="Section",e.MultiSections="MultiSections",e.RegularLayout="RegularLayout",e.VerticalLayout="VerticalLayout",e.Canvas="Canvas"}(W||(W={}));class Y{get registration(){return this._registration}get aiPropertiesMissingDataProcessor(){return this._aiPropertiesMissingDataProcessor}injectProcessor(e,t){if(!this._registration.has(e.classUniqueId))throw new Error(`AI-properties ${e.name} is not registered yet. Please register it before injecting a processor.`);const n=e.classUniqueId,a=this._registration.get(n);this._aiPropertiesMissingDataProcessor.indexOf(n)>=0&&this._aiPropertiesMissingDataProcessor.splice(this._aiPropertiesMissingDataProcessor.indexOf(n),1),a.processor=t}_registerAll(){this._registerAIPropertiesWithDefaultProcessor(),this._registerAIPropertiesWithNotImplementedProcessor(),this._registerAIPropertiesWithBuiltInProcessor()}_registerAIPropertiesWithDefaultProcessor(){this._registerOneAIPropertiesWithDefaultProcessor(I.AINumber),this._registerOneAIPropertiesWithDefaultProcessor(I.AIInteger),this._registerOneAIPropertiesWithDefaultProcessor(I.AIText),this._registerOneAIPropertiesWithDefaultProcessor(I.AIWebPartTitle),this._registerOneAIPropertiesWithDefaultProcessor(I.AIPeopleDisplayName),this._registerOneAIPropertiesWithDefaultProcessor(I.AIUrl),this._registerOneAIPropertiesWithDefaultProcessor(I.AIImageSearchKeyword),this._registerOneAIPropertiesWithDefaultProcessor(I.AIEmailAddress),this._registerOneAIPropertiesWithDefaultProcessor(I.AIBoolean),this._registerOneAIPropertiesWithDefaultProcessor(I._AIFreeFormObject),this._registerOneAIPropertiesWithDefaultProcessor(I.AIRichText),this._registerOneAIPropertiesWithDefaultProcessor(I.AIRichTextForTextWebPart),this._registerOneAIPropertiesWithDefaultProcessor(I.AIDate),this._registerOneAIPropertiesWithDefaultProcessor(I._AIReadOnlyWebPart)}_registerAIPropertiesWithNotImplementedProcessor(){this._registerOneAIPropertiesWithNotImplementedProcessor(I.AILink),this._registerOneAIPropertiesWithNotImplementedProcessor(I.AISPImage),this._registerOneAIPropertiesWithNotImplementedProcessor(I.AISPReferenceImage),this._registerOneAIPropertiesWithNotImplementedProcessor(I.AISPPeople),this._registerOneAIPropertiesWithNotImplementedProcessor(O),this._registerOneAIPropertiesWithNotImplementedProcessor(A)}_registerAIPropertiesWithBuiltInProcessor(){this._registerOneAIPropertiesWithUndefinedProcessor(I.AIArray),this._registerOneAIPropertiesWithUndefinedProcessor(I.AISPHeroItem),this._registerOneAIPropertiesWithUndefinedProcessor(I.CustomAIObject),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIStockImage),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIImageReady),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIReferenceImage),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIStringUnion),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIStringUnionOptional),this._registerOneAIPropertiesWithUndefinedProcessor(I.AINumberUnion),this._registerOneAIPropertiesWithUndefinedProcessor(I.AINumberUnionOptional),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIPropertiesUnion),this._registerOneAIPropertiesWithUndefinedProcessor(I.AIImage),this._registerOneAIPropertiesWithUndefinedProcessor(K),this._registerOneAIPropertiesWithUndefinedProcessor(M),this._registerOneAIPropertiesWithUndefinedProcessor(L),this._registerOneAIPropertiesWithUndefinedProcessor(k),this._registerOneAIPropertiesWithUndefinedProcessor(w),this._registerOneAIPropertiesWithUndefinedProcessor(V)}_registerOneAIProperties(e,t){const n={name:e.name,classUniqueId:e.classUniqueId,constructor:e,processor:t};if(this._registration.has(e.classUniqueId))throw new Error(`AI-properties with id ${e.classUniqueId} is already registered. Make sure AI-properties are not using duplicate IDs.`);this._registration.set(e.classUniqueId,n)}_registerOneAIPropertiesWithUndefinedProcessor(e){this._registerOneAIProperties(e,void 0)}_registerOneAIPropertiesWithNotImplementedProcessor(e){this._registerOneAIProperties(e,(0,I._getDefaultAIPropertiesDataProcessorNotImplemented)()),this._aiPropertiesMissingDataProcessor.push(e.classUniqueId)}_registerOneAIPropertiesWithDefaultProcessor(e){this._registerOneAIProperties(e,(0,I._getDefaultAIPropertiesDataProcessor)())}constructor(){this._registration=new Map,this._aiPropertiesMissingDataProcessor=[],this.getProcessor=e=>this._registration.get(e)?.processor,this._registerAll()}}function J(e){if(e&&e.experimentalData&&e.experimentalData.aiProperties)try{const i=e.experimentalData.aiProperties,r=i.structure,o=("string"==typeof r.aliasForAI?r.aliasForAI.trim():void 0)||e.alias;return{[n]:r.webPartId,[t]:o,[a]:r.schema,[f]:r.description,[p]:e.supportsFullBleed||!1,mapping:i.mapping,propertiesMetadataForReInstate:e.experimentalData.propertiesMetadataForReInstate,dataVersionString:r.dataVersionString}}catch(e){return void I._AIPropertiesLogger.error(e)}}function X({manifests:e,includeRTE:i=!0,includeReadOnlyWebPart:r=!1,useCleanSchema:o=!0,useExperimentalFreeFormSchema:s=!1,dataUsageMatrix:c,systemPrompts:d}){let l=e.map(J).filter(e=>!!e).map(e=>({[n]:e[n],[t]:e[t],[a]:e[a],[f]:e[f],[p]:e[p]}));return i&&l.push(z),r&&l.push(G),o&&(l=function({controlAIPropertiesSchemas:e,registration:t=new Y,dataUsageMatrix:n,systemPrompts:i,useExperimentalFreeFormSchema:r}){return e.map(e=>{const o=function({dataUsageMatrix:e,registration:t,schema:n,includingReinstantiationParams:a=!1,useSchemaId:i=!1,systemPrompts:r=j(),useExperimentalFreeFormSchema:o=!1}){const s=Q(t,n),c={includingReinstantiationParams:a,systemPrompts:r,useSchemaId:i,dataUsageMatrix:e,description:void 0,...o?{useExperimentalFreeFormSchema:o}:{}},d=(0,I._getAIPropertiesJSON)(s,c);if(!d){const e=new Error(`Invalid AI-properties JSON schema: ${d}`);throw I._AIPropertiesLogger.error(e),e}return d}({schema:e[a],registration:t,dataUsageMatrix:n,systemPrompts:i,useExperimentalFreeFormSchema:r});return{...e,[a]:o}})}({controlAIPropertiesSchemas:l,dataUsageMatrix:c,systemPrompts:d,useExperimentalFreeFormSchema:s})),l}class Z{serialize(){return JSON.stringify(this._byProductRecord)}set(e,t){try{this._byProductRecord[e]=JSON.parse(JSON.stringify(t))}catch(e){throw I._AIPropertiesLogger.error(e),new Error("Failed to set by-product, it is likely not a JSONable object")}}get(e){return this._byProductRecord[e]}constructor(e){this._byProductRecord=e?JSON.parse(e):{}}}var $=r(560);function ee(e){return e?.variantKey===I.AIImageType.Ready}function te(e){if(null!=e)switch($.SPVariantThemeType[e]){case"None":return"None";case"Neutral":return"Neutral";case"Soft":return"Soft";case"Strong":return"Strong";default:return}}function ne(e){if(e)try{return ae(JSON.parse(e))}catch(e){return}}function ae(e){if(!e||"image"!==e.type)return;const{imageData:t}=e,{overlay:n,useLightText:a}=e,{width:i,height:r,url:o,stockMediaId:s,contentProvider:c,fileName:d,insertionISOTimestamp:l,siteId:u,webId:f,listId:p,uniqueId:m}=t;return{image:{variantKey:I.AIImageType.Ready,urlOrBlob:o,width:i,height:r,stockMediaId:s,contentProvider:c,isDecorative:!0,fileName:d,insertionISOTimestamp:l,...u&&f&&p&&m?{fileMetadata:{siteId:u,webId:f,listId:p,uniqueId:m}}:{}},overlay:n,useLightText:a}}function ie(e){if(!e)return;const{image:t,overlay:n,useLightText:a}=e;if(!n||"boolean"!=typeof a)return;if(!ee(t))return;const i=t,{urlOrBlob:r,width:o,height:s,fileName:c,insertionISOTimestamp:d,stockMediaId:l,fileMetadata:u}=i;return r&&void 0!==o&&void 0!==s?{type:"image",imageData:Boolean(u?.siteId&&u?.webId&&u?.listId&&u?.uniqueId)?{url:r,width:o,height:s,fileName:c??"",source:$.ImageSource.SP,siteId:u?.siteId??"",webId:u?.webId??"",listId:u?.listId??"",uniqueId:u?.uniqueId??"",stockMediaId:l,insertionISOTimestamp:d}:{url:r,width:o,height:s,fileName:c??"",source:$.ImageSource.Hubble,stockMediaId:l,insertionISOTimestamp:d},overlay:n,useLightText:a}:void 0}function re(e){const t=ie(e);return t?JSON.stringify(t):void 0}function oe(e){if(e)try{return JSON.parse(e)}catch(e){return}}function se(e){if(e?.alignment||0===e?.alignment)switch(e.alignment){case $.ZoneGroupAlignment.Top:return"Top";case $.ZoneGroupAlignment.Center:return"Center";case $.ZoneGroupAlignment.Bottom:return"Bottom";default:return}}function ce(e){if(e?.displayName&&(e.type!==$.CanvasGroupType.Default||0!==e.displayName.trim().length))return e.displayName}function de(e,t){return void 0===t?(n=e,Array.isArray(n)?[...n]:ue(n)?{...n}:n):le(e,t);var n}function le(e,t){if(void 0!==t){if(Array.isArray(t))return[...t];if(ue(t)){const n=ue(e),a=n?{...e}:{},i=t;for(const t of Object.keys(i)){const r=n?e[t]:void 0;a[t]=le(r,i[t])}return a}return t}}function ue(e){return"[object Object]"===Object.prototype.toString.call(e)}const fe={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let pe;const me=new Uint8Array(16);function _e(){if(!pe&&(pe="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!pe))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return pe(me)}const he=[];for(let e=0;e<256;++e)he.push((e+256).toString(16).slice(1));function be(e,t=0){return he[e[t+0]]+he[e[t+1]]+he[e[t+2]]+he[e[t+3]]+"-"+he[e[t+4]]+he[e[t+5]]+"-"+he[e[t+6]]+he[e[t+7]]+"-"+he[e[t+8]]+he[e[t+9]]+"-"+he[e[t+10]]+he[e[t+11]]+he[e[t+12]]+he[e[t+13]]+he[e[t+14]]+he[e[t+15]]}const ge=function(e,t,n){if(fe.randomUUID&&!t&&!e)return fe.randomUUID();const a=(e=e||{}).random||(e.rng||_e)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return be(a)},ve=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ye(e,t,n,a){switch(e){case 0:return t&n^~t&a;case 1:case 3:return t^n^a;case 2:return t&n^t&a^n&a}}function Se(e,t){return e<<t|e>>>32-t}const De=function(e,t,n){function a(e,t,n,a){var i;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof t&&(t=function(e){if(!function(e){return"string"==typeof e&&ve.test(e)}(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}(t)),16!==(null===(i=t)||void 0===i?void 0:i.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let r=new Uint8Array(16+e.length);if(r.set(t),r.set(e,t.length),r=function(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const a=e.length/4+2,i=Math.ceil(a/16),r=new Array(i);for(let t=0;t<i;++t){const n=new Uint32Array(16);for(let a=0;a<16;++a)n[a]=e[64*t+4*a]<<24|e[64*t+4*a+1]<<16|e[64*t+4*a+2]<<8|e[64*t+4*a+3];r[t]=n}r[i-1][14]=8*(e.length-1)/Math.pow(2,32),r[i-1][14]=Math.floor(r[i-1][14]),r[i-1][15]=8*(e.length-1)&4294967295;for(let e=0;e<i;++e){const a=new Uint32Array(80);for(let t=0;t<16;++t)a[t]=r[e][t];for(let e=16;e<80;++e)a[e]=Se(a[e-3]^a[e-8]^a[e-14]^a[e-16],1);let i=n[0],o=n[1],s=n[2],c=n[3],d=n[4];for(let e=0;e<80;++e){const n=Math.floor(e/20),r=Se(i,5)+ye(n,o,s,c)+d+t[n]+a[e]>>>0;d=c,c=s,s=Se(o,30)>>>0,o=i,i=r}n[0]=n[0]+i>>>0,n[1]=n[1]+o>>>0,n[2]=n[2]+s>>>0,n[3]=n[3]+c>>>0,n[4]=n[4]+d>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}(r),r[6]=15&r[6]|80,r[8]=63&r[8]|128,n){a=a||0;for(let e=0;e<16;++e)n[a+e]=r[e];return n}return be(r)}try{a.name="v5"}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}();function Ie(e){if(void 0===e)return ge();const t=e.trim();return De(t,"5a3e0c5d-5d86-4e2a-9c2b-2c1d7f9b7e10")}class xe{get byProduct(){return this._byProduct}get registration(){return this._registration}_initAIControlProcessor(){this._registration.injectProcessor(O,this._processAIControl),this._registration.injectProcessor(A,this._processAISection)}constructor(e){this._registration=new Y,this._processAISection=async({data:e,instance:t,getDataProcessor:n,path:a})=>({...await(0,I._processAIPropertiesDataOnObject)(t.structure,{data:e,getDataProcessor:n,path:a}),id:Ie(a)}),this._processAIControl=async({data:e,getDataProcessor:t,path:n})=>{const{controlAIPropertiesData:a}=e;let i,{controlAIPropertiesId:r}=e,o=this._controlSchemas.find(e=>e.control_AI_properties_id===r);if(o||(o=this._controlSchemas.find(e=>e.control_AI_properties_alias===r),o&&(I._AIPropertiesLogger.warning("Control AI-properties schema not found by id but found by alias: "+r),r=o.control_AI_properties_id)),!o)return void I._AIPropertiesLogger.error("Control AI-properties schema not found for id/alias: "+r);const s=()=>JSON.stringify(o?.control_AI_properties_JSON_schema);try{i=Q(this._registration,o.control_AI_properties_JSON_schema)}catch(e){throw I._AIPropertiesLogger.error(e),new Error("Failed to reinstantiate AI-properties from schema: "+s())}let c;try{c=await(0,I._processAIPropertiesDataOnObject)(i,{data:a,getDataProcessor:t,path:n}),c={...c,__aiResultStatus:"Raw"}}catch(e){throw I._AIPropertiesLogger.error(e),new Error(`Failed to process controlAIPropertiesData for schema. Error: '${e.message}'. Schema: ${s()}`)}return{instanceId:Ie(n),controlAIPropertiesId:r,controlAIPropertiesData:c}};const{controlAIPropertiesSchemas:t,logger:n,serializedByProductRecord:a}=e;this._controlSchemas=t,this._initAIControlProcessor(),this._byProduct=new Z(a),n&&I._AIPropertiesLogger.set(n)}}function Ce(e){return Boolean(e&&Array.isArray(e.controls))}function Oe(e){return Boolean(e&&Array.isArray(e.sections))}function we(e){return Boolean(e&&Oe(e.regularLayout)&&(void 0===e.verticalLayout||Ce(e.verticalLayout)))}function Ee(e){return Boolean(e&&void 0!==e.id&&void 0!==e.layout&&Array.isArray(e.columns))}function Ae(e){return e.controlType===$.CanvasControlType.WebPartZone}function Le(e){return e.controlType===$.CanvasControlType.RTE}function ke(e){return Boolean(e&&void 0!==e.control&&void 0!==e.instanceId)}function Me(e){return Boolean(e&&void 0!==e.controlAIPropertiesId&&void 0!==e.controlAIPropertiesData)}function Pe(e){return ke(e)||Me(e)}function Te(e){return Boolean(e&&e.canvas&&Oe(e.canvas.regularLayout))}function Ue(e,t){if(t===W.Control)return Pe(e);if(t===W.Column||t===W.VerticalLayout)return Ce(e);if(t===W.Section)return Ee(e);if(t===W.MultiSections||t===W.RegularLayout)return Oe(e);if(t===W.Canvas)return we(e);throw new Error(`Unknown AIPropertiesLevel: ${t}`)}function Fe(e,t){return!!Ue(e,t)||!(t!==W.MultiSections||!Ue(e,W.Section))}function He(e){return Pe(e)?W.Control:Ce(e)?W.Column:Ee(e)?W.Section:Oe(e)?W.RegularLayout:we(e)?W.Canvas:void 0}})(),o})());