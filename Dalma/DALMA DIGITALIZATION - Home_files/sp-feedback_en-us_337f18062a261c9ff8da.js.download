(()=>{var e=document.currentScript;define("2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0",["@microsoft/load-themed-styles","@microsoft/sp-core-library","@microsoft/sp-diagnostics","@microsoft/sp-page-context","@ms/office-ui-fabric-react-bundle","@msinternal/sp-a11y","@msinternal/sp-office-browser-feedback","@msinternal/sp-telemetry","@msinternal/odsp-core-bundle","@msinternal/sp-topic-dataproviders","@microsoft/sp-loader"],(t,n,a,i,r,o,s,c,d,l,u)=>(()=>{var f={1545:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.IFloodgateHostPlatform=t.GovernedChannelType=t.ICampaignDefinitions=t.Api=void 0,i(n(4857),t),t.Api=n(4857),i(n(2619),t),i(n(7063),t),i(n(5756),t);var r=n(4139);Object.defineProperty(t,"ICampaignDefinitions",{enumerable:!0,get:function(){return r.ICampaignDefinitions}});var o=n(4122);Object.defineProperty(t,"GovernedChannelType",{enumerable:!0,get:function(){return o.GovernedChannelType}}),i(n(2657),t);var s=n(8830);Object.defineProperty(t,"IFloodgateHostPlatform",{enumerable:!0,get:function(){return s.IFloodgateHostPlatform}}),i(n(7807),t),i(n(2220),t)}
,7966:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EcsConfigType=void 0,(n=t.EcsConfigType||(t.EcsConfigType={}))[n.Default=0]="Default",n[n.User=1]="User"}
,2711:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActivityName=void 0;var n=function(){function e(){}return e.AppLaunch="AppLaunch",e.AppUsageTime="AppUsageTime",e.AppResume="AppResume",e}();t.ActivityName=n}
,3025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,7111:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,3378:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,3806:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RoamingSettingIdMap=void 0,t.RoamingSettingIdMap={CampaignStates:1258,GovernedChannelStates:1257,SurveyActivationStats:1259}}
,5287:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.FloodgateStorageProviderFileType=void 0,(n=t.FloodgateStorageProviderFileType||(t.FloodgateStorageProviderFileType={}))[n.FloodgateSettings=0]="FloodgateSettings",n[n.SurveyActivationStats=1]="SurveyActivationStats",n[n.SurveyEventActivityStats=2]="SurveyEventActivityStats",n[n.CampaignDefinitions=3]="CampaignDefinitions",n[n.CampaignStates=4]="CampaignStates",n[n.GovernedChannelStates=5]="GovernedChannelStates",n[n.TmsCache_MessageMetadata=6]="TmsCache_MessageMetadata",n[n.TmsCache_UserGovernance=7]="TmsCache_UserGovernance",n[n.TmsCache_CampaignContent=8]="TmsCache_CampaignContent",n[n.Tms_DynamicSettings=9]="Tms_DynamicSettings",n[n.LogLevelSettings=10]="LogLevelSettings",n[n.UserFacts=11]="UserFacts",n[n.DebugOverrides=12]="DebugOverrides",n[n.DynamicCampaignDefinitions=13]="DynamicCampaignDefinitions",n[n.FeatureGateOverrides=14]="FeatureGateOverrides"}
,3967:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,2184:(e,t)=>{"use strict";var n,a;Object.defineProperty(t,"__esModule",{value:!0}),t.GovernanceServiceClientState=t.GovernanceServiceSurveyType=void 0,(a=t.GovernanceServiceSurveyType||(t.GovernanceServiceSurveyType={}))[a.Unknown=0]="Unknown",a[a.Feedback=1]="Feedback",a[a.Nps=2]="Nps",a[a.Psat=4]="Psat",a[a.Bps=6]="Bps",a[a.Fps=8]="Fps",a[a.Nlqs=18]="Nlqs",a[a.GenericMessagingSurface=22]="GenericMessagingSurface",a[a.Intercept=24]="Intercept",(n=t.GovernanceServiceClientState||(t.GovernanceServiceClientState={}))[n.Disabled=0]="Disabled",n[n.InitializationFailed=1]="InitializationFailed",n[n.Enabled=2]="Enabled"}
,2478:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,7790:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,4069:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,2036:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,9672:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.LAUNCHER_TYPE_DEFAULT=t.DOM_INTERCEPT_TAGNAME=t.DOM_NLQS_TAGNAME=t.DOM_FPS_TAGNAME=t.DOM_BPS_TAGNAME=t.DOM_PSAT_TAGNAME=t.DOM_NPS_TAGNAME=t.DOM_FEEDBACKSURVEY_TAGNAME=t.SurveyType=void 0,(n=t.SurveyType||(t.SurveyType={}))[n.Feedback=0]="Feedback",n[n.Nps=1]="Nps",n[n.Psat=2]="Psat",n[n.Bps=3]="Bps",n[n.Fps=4]="Fps",n[n.Nlqs=5]="Nlqs",n[n.Intercept=6]="Intercept",n[n.GenericMessagingSurface=12]="GenericMessagingSurface",t.DOM_FEEDBACKSURVEY_TAGNAME="FeedbackSurvey",t.DOM_NPS_TAGNAME="Nps",t.DOM_PSAT_TAGNAME="Psat",t.DOM_BPS_TAGNAME="Bps",t.DOM_FPS_TAGNAME="Fps",t.DOM_NLQS_TAGNAME="Nlqs",t.DOM_INTERCEPT_TAGNAME="Intercept",t.LAUNCHER_TYPE_DEFAULT="survey"}
,7449:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_SURVEYSPECIFICDATA_KEYNAME=t.JSON_SURVEYSTRINGS_KEYNAME=t.JSON_EXTENDEDMANIFESTDATA_KEYNAME=t.JSON_APPLICATION_KEYNAME=t.JSON_MULTIPLECHOICE_KEYNAME=t.JSON_QUESTION_KEYNAME=t.JSON_TITLE_KEYNAME=t.JSON_CVSURVEYPLATFORM_KEYNAME=t.JSON_CVSURVEYUIHOST_KEYNAME=t.JSON_CVSURVEYPRODUCTNAME_KEYNAME=t.JSON_RATINGOPTIONS_KEYNAME=t.JSON_CVSURVEYTHEME_KEYNAME=t.JSON_CVSURVEYFORMID_KEYNAME=t.JSON_CVSURVEY_KEYNAME=t.JSON_RATING_KEYNAME=t.JSON_COMMENT_KEYNAME=t.JSON_PROMPTNOTEXT_KEYNAME=t.JSON_PROMPTYESTEXT_KEYNAME=t.JSON_PROMPT_KEYNAME=t.JSON_INTERCEPTURL_KEYNAME=t.JSON_INTERCEPT_KEYNAME=t.DOM_MULTIPLECHOICE_TAGNAME=t.DOM_CVSURVEY_TAGNAME=t.DOM_RATING_TAGNAME=t.DOM_COMMENT_TAGNAME=t.DOM_PROMPT_TAGNAME=void 0,t.DOM_PROMPT_TAGNAME="Prompt",t.DOM_COMMENT_TAGNAME="Comment",t.DOM_RATING_TAGNAME="Rating",t.DOM_CVSURVEY_TAGNAME="CVSurvey",t.DOM_MULTIPLECHOICE_TAGNAME="MultipleChoice",t.JSON_INTERCEPT_KEYNAME="intercept",t.JSON_INTERCEPTURL_KEYNAME="url",t.JSON_PROMPT_KEYNAME="prompt",t.JSON_PROMPTYESTEXT_KEYNAME="yesButtonText",t.JSON_PROMPTNOTEXT_KEYNAME="noButtonText",t.JSON_COMMENT_KEYNAME="comment",t.JSON_RATING_KEYNAME="rating",t.JSON_CVSURVEY_KEYNAME="cvSurvey",t.JSON_CVSURVEYFORMID_KEYNAME="formId",t.JSON_CVSURVEYTHEME_KEYNAME="theme",t.JSON_RATINGOPTIONS_KEYNAME="options",t.JSON_CVSURVEYPRODUCTNAME_KEYNAME="productName",t.JSON_CVSURVEYUIHOST_KEYNAME="uiHost",t.JSON_CVSURVEYPLATFORM_KEYNAME="platform",t.JSON_TITLE_KEYNAME="title",t.JSON_QUESTION_KEYNAME="question",t.JSON_MULTIPLECHOICE_KEYNAME="multipleChoice",t.JSON_APPLICATION_KEYNAME="application",t.JSON_EXTENDEDMANIFESTDATA_KEYNAME="extendedManifestData",t.JSON_SURVEYSTRINGS_KEYNAME="surveyStrings",t.JSON_SURVEYSPECIFICDATA_KEYNAME="surveySpecificData"}
,4857:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(2619),t),i(n(2711),t),i(n(9672),t),i(n(7449),t),i(n(3378),t),i(n(3806),t),i(n(5287),t),i(n(3967),t),i(n(2478),t),i(n(2036),t),i(n(7790),t),i(n(4069),t),i(n(3025),t),i(n(7111),t),i(n(2184),t),i(n(7966),t)}
,3300:(e,t)=>{"use strict";var n,a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.BranchingTargetType=t.ConditionSourceType=t.ConditionType=void 0,(i=t.ConditionType||(t.ConditionType={})).Equals="Equals",i.NotEquals="NotEquals",i.GreaterThan="GreaterThan",i.GreaterThanOrEqual="GreaterThanOrEqual",i.LessThan="LessThan",i.LessThanOrEqual="LessThanOrEqual",i.IsAnswered="IsAnswered",(a=t.ConditionSourceType||(t.ConditionSourceType={})).Question="Question",a.Variable="Variable",(n=t.BranchingTargetType||(t.BranchingTargetType={})).Page="Page",n.Override="Override"}
,6659:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.QuestionType=void 0,(n=t.QuestionType||(t.QuestionType={})).Comment="Comment",n.ContactMe="ContactMe",n.MultipleChoice="MultipleChoice",n.Label="Label",n.Rating="Rating",n.SingleSelect="SingleSelect",n.Likert="Likert"}
,7905:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.SurveySurfaceSize=void 0,(n=t.SurveySurfaceSize||(t.SurveySurfaceSize={})).Compact="Compact",n.Medium="Medium"}
,9402:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.IUxSchemaAdditionalCapabilitiesTypes=void 0,(n=t.IUxSchemaAdditionalCapabilitiesTypes||(t.IUxSchemaAdditionalCapabilitiesTypes={})).Email="email",n.Screenshot="screenshot",n.Diagnostics="diagnostics"}
,8121:(e,t,n)=>{"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),t.SurveyRestrictions=t.MAX_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS=t.MIN_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS=t.MAX_VERTICAL_OPTIONS_LIKERT_QUESTIONS=t.MIN_VERTICAL_OPTIONS_LIKERT_QUESTIONS=t.MAX_OPTIONS_NON_LIKERT_QUESTIONS=t.MIN_OPTIONS_NON_LIKERT_QUESTIONS=void 0;var i=n(9672);t.MIN_OPTIONS_NON_LIKERT_QUESTIONS=2,t.MAX_OPTIONS_NON_LIKERT_QUESTIONS=10,t.MIN_VERTICAL_OPTIONS_LIKERT_QUESTIONS=2,t.MAX_VERTICAL_OPTIONS_LIKERT_QUESTIONS=7,t.MIN_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS=1,t.MAX_HORIZONTAL_OPTIONS_LIKERT_QUESTIONS=10,t.SurveyRestrictions=((a={})[i.SurveyType.Fps]={MinNumberOfPages:2,FirstTemplateId:"0e19ac6f-d831-499c-9e83-a709e27784b6"},a)}
,5756:function(e,t,n){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,n,a){void 0===a&&(a=n),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,a){void 0===a&&(a=n),e[a]=t[n]}),i=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),i(n(7905),t),i(n(6659),t),i(n(3300),t),i(n(9402),t),i(n(8121),t)}
,2657:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,8830:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.IFloodgateHostPlatform=void 0,(n=t.IFloodgateHostPlatform||(t.IFloodgateHostPlatform={})).Web="Web",n.Android="Android",n.Win32="Win32",n.iOS="iOS"}
,7807:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,4139:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ICampaignDefinitions=void 0,t.ICampaignDefinitions=function(){}}
,4122:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.GovernedChannelType=void 0,(n=t.GovernedChannelType||(t.GovernedChannelType={}))[n.Standard=0]="Standard",n[n.Urgent=1]="Urgent",n[n.Banner=2]="Banner",n[n.TeachingMessage=3]="TeachingMessage",n[n.BusinessBar=4]="BusinessBar",function(e){e.getDefault=function(){return e.Standard}}(t.GovernedChannelType||(t.GovernedChannelType={}))}
,7063:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})}
,2619:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.JSON_ID_KEYNAME=t.JSON_SURVEY_KEYNAME=t.DOM_ID_TAGNAME=t.DOM_TYPE_VALUE=t.DOM_TYPE_TAGNAME=t.SurveyInfoBusinessLevel=void 0,(n=t.SurveyInfoBusinessLevel||(t.SurveyInfoBusinessLevel={}))[n.None=0]="None",n[n.Critical=1]="Critical",t.DOM_TYPE_TAGNAME="Type",t.DOM_TYPE_VALUE="Survey",t.DOM_ID_TAGNAME="SurveyID",t.JSON_SURVEY_KEYNAME="survey",t.JSON_ID_KEYNAME="surveyId"}
,2220:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationType=void 0,(n=t.AuthenticationType||(t.AuthenticationType={}))[n.MSA=0]="MSA",n[n.AAD=1]="AAD",n[n.Unauthenticated=2]="Unauthenticated"}
,1837:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2780),i=function(){function e(){this._isAllowed=!1}return e.prototype.putBackgroundFetchAllowed=function(e){if(this._isAllowed=e,this.isBackgroundFetchAllowed()&&this._isAllowedDeferral){var t=this._isAllowedDeferral;this._isAllowedDeferral=void 0,t.resolve(void 0)}},e.prototype.isBackgroundFetchAllowed=function(){return this._isAllowed},e.prototype.waitForBackgroundFetchAllowed=function(){return this.isBackgroundFetchAllowed()?a.Resolved():(this._isAllowedDeferral||(this._isAllowedDeferral=a.Defer()),this._isAllowedDeferral.promise())},e}();t.default=i}
,9765:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2780),i=function(){function e(){this._isActive=!1}return e.prototype.putAppActive=function(e){if(this._isActive=e,this.isAppActive()&&this._appActiveDeferral){var t=this._appActiveDeferral;this._appActiveDeferral=void 0,t.resolve(void 0)}},e.prototype.isAppActive=function(){return this._isActive},e.prototype.waitForAppActive=function(){return this.isAppActive()?a.Resolved():(this._appActiveDeferral||(this._appActiveDeferral=a.Defer()),this._appActiveDeferral.promise())},e}();t.default=i}
,2610:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5557),i=n(2780),r=n(9116),o=function(){function e(e){this._config=e,this.configUpdated=new a.default,this._cachedConfigs={}}return e.prototype.initialize=function(){return this.updateConfigsToFetch()},e.prototype.updateConfigsToFetch=function(){var e=this,t=this._config.getConfig(),n=t.databaseInterface,a=t.configsToFetch;if(!n)return i.Resolved();for(var r=[],o=function(t){if(s._cachedConfigs[t])return"continue";r.push(n.getData(t).then(function(n){n&&(e._cachedConfigs[t]=n)}).catch(function(){return i.Resolved()}))},s=this,c=0,d=a;c<d.length;c++)o(d[c]);return i.all(r).then(function(){r.length>0&&e.configUpdated.fire()})},e.prototype.getEcsConfig=function(){return this._cachedConfigs[r.EcsConfigType.User]||this._cachedConfigs[r.EcsConfigType.Default]},e.prototype.getEcsConfigByType=function(e){return this._cachedConfigs[e]},e.prototype.putConfig=function(e){var t=this.getEcsConfig();this._cachedConfigs[e.configType]=e;var n=this.getEcsConfig();(n&&n.configType===e.configType||t&&n&&t.configType!==n.configType)&&this.configUpdated.fire();var a=this._config.getConfig().databaseInterface;return a?a.putData(e.configType,e):i.Resolved()},e}();t.default=o}
,2384:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.initialize=function(e){if(this._config)throw new Error("ECS Configuration already initialized");this._config=e},e.prototype.getConfig=function(){if(!this._config)throw new Error("ECS Configuration not yet initialized");return this._config},e.prototype.setConfigsToFetch=function(e){if(!this._config)throw new Error("ECS Configuration not yet initialized");this._config=n(n({},this._config),{configsToFetch:e})},e.prototype.setFetchTimeout=function(e){if(!this._config)throw new Error("ECS Configuration not yet initialized");this._config=n(n({},this._config),{fetchTimeout:e})},e}();t.default=a}
,5514:(e,t,n)=>{"use strict";var a=n(1837),i=n(9765),r=n(2610),o=n(2384);n(9116);var s=n(4937),c=n(7681),d=n(9176),l=function(){function e(){this._allowBackgroundFetchData=new a.default,this._appActiveData=new i.default,this._config=new o.default,this._cache=new r.default(this._config),this._skypeTokenData=new c.default,this._telemetryManager=new d.default(this._cache),this._scheduler=new s.default(this._config,this._skypeTokenData,this._cache,this._appActiveData,this._allowBackgroundFetchData,this._telemetryManager),this.telemetryEventAdded=this._telemetryManager.telemetryEventAdded,this.configUpdated=this._cache.configUpdated}return e.prototype.initialize=function(e){var t=this;return this._config.initialize(e),this._skypeTokenData.putSkypeTokenData(e.initialSkypeTokenData),this._appActiveData.putAppActive(e.initialAppActiveState),this._cache.initialize().then(function(){t._scheduler.initialize()})},e.prototype.dispose=function(){var e;(null===(e=this._config.getConfig().Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled)&&this._scheduler.dispose()},e.prototype.getConfig=function(){return this._cache.getEcsConfig()},e.prototype.getConfigType=function(){var e=this._cache.getEcsConfig();if(e)return e.configType},e.prototype.requestUpdate=function(){this._scheduler.requestUpdate()},e.prototype.pause=function(){this._scheduler.pause()},e.prototype.resume=function(){this._scheduler.resume()},e.prototype.setAllowBackgroundFetch=function(e){this._allowBackgroundFetchData.putBackgroundFetchAllowed(e)},e.prototype.useSkypeToken=function(e,t){this._skypeTokenData.putSkypeTokenData({skypeToken:e,skypeTokenExpiration:t})},e.prototype.setAppActive=function(e){this._appActiveData.putAppActive(e)},e.prototype.setConfigsToFetch=function(e){var t=this;return this._config.setConfigsToFetch(e),this._cache.updateConfigsToFetch().then(function(){t._scheduler.updateConfigsToFetch()})},e.prototype.setFetchTimeout=function(e){this._config.setFetchTimeout(e)},e}();t.Oy=l}
,9116:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.EcsConfigType||(t.EcsConfigType={}))[n.Default=0]="Default",n[n.User=1]="User"}
,9715:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,s,c=n(7311),d=n(2780),l=n(9116),u=n(3558),f=function(e){function t(t,n,a,i,r,o,s,c){var d=e.call(this,t)||this;d._config=n,d._skypeTokenData=a,d._appActiveData=i,d._allowBackgroundFetchData=r,d._etag=o,d._getUserConfig=s;var l=d._config.getConfig();if(d._apiPath=l.clientTeam?"/config/v1/"+l.clientName+"/"+l.clientVersion+"/"+l.clientTeam:"/config/v1/"+l.clientName+"/"+l.clientVersion,c){var u=Object.keys(c).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(c[e].toString())});u&&(d._apiPath+="?"+u.join("&"))}return d}return i(t,e),t.prototype._blockRequestUntil=function(e){var t=this;if(this._getUserConfig&&!this._skypeTokenData.isSkypeTokenValid()&&console.log("ECS - Delaying User config fetch until we have a valid SkypeToken"),!this._appActiveData.isAppActive()&&!this._allowBackgroundFetchData.isBackgroundFetchAllowed()){var n=this._getUserConfig?"User config":"config";console.log("ECS - Delaying "+n+" fetch until the app is active (or background fetch is allowed)")}return d.race([this._appActiveData.waitForAppActive(),this._allowBackgroundFetchData.waitForBackgroundFetchAllowed()]).then(function(){if(t._getUserConfig)return t._skypeTokenData.waitForValidSkypeToken()}).then(function(){s=Date.now()})},t.prototype._getHeaders=function(){var e={};return this._etag&&(e["If-None-Match"]=this._etag),this._getUserConfig&&(e.Authorization=this._skypeTokenData.getSkypeToken()),e},t.prototype.getConfig=function(){var t=this._config.getConfig().fetchTimeout;return void 0!==t&&(t<0?t=0:t>0&&t<3e4&&(t=3e4)),e.prototype.performApiGetDetailed.call(this,this._apiPath,{timeout:t})},t}(c.GenericRestClient),p=function(){function e(e,t,n,a,i){this._config=e,this._skypeTokenData=t,this._appActiveData=n,this._allowBackgroundFetchData=a,this._telemetryManager=i,this._ecsFailureBackoffTimer=new c.ExponentialTime(1e3,3e5),this._cacheMaxAgeRegex=/.*max-age=(\d+).*/gi,this._serverIndex=NaN}return e.prototype.getConfig=function(e,t,n){var a=this,i=this._config.getConfig().hosts;if((isNaN(this._serverIndex)||this._serverIndex>i.length-1)&&(this._serverIndex=Math.floor(Math.random()*i.length)),!i||!i.length)return d.Rejected(new Error("no configuration service endpoint"));var o=d.Defer(),c=0,p=function(){var m=e&&e.eTag?e.eTag:void 0,_=new f(i[a._serverIndex],a._config,a._skypeTokenData,a._appActiveData,a._allowBackgroundFetchData,m,t,n);c++,_.getConfig().then(function(n){var f=n.headers.etag,p=n.headers.expires;n.body&&n.body.Headers&&(f||(f=n.body.Headers.ETag),p||(p=n.body.Headers.Expires));var _=a._calculateResponseTimeInfo(e);if(!f||!p)return console.warn("ECS - Service returned an empty ETag or Expiration header: "+JSON.stringify(n)),d.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned empty ETag or Expiration header"),responseCode:n.statusCode});var h,b=new Date(a._calculateExpirationDate(n.headers)).getTime();if(304===n.statusCode&&e)(h=r({},e)).configType=t?l.EcsConfigType.User:l.EcsConfigType.Default,h.eTag=f,h.expiration=b,h.cacheUpdateTime=_.lastResponseTime,h.lastFetchTokenHash=a._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization);else{if("object"!=typeof n.body)return console.warn("ECS - Service returned invalid response "+JSON.stringify(n)),d.Rejected({timedOut:!1,responseParsingException:new Error("ECS Service returned invalid response body"),responseCode:n.statusCode});h={config:n.body,configType:t?l.EcsConfigType.User:l.EcsConfigType.Default,eTag:f,expiration:b,cacheUpdateTime:s,lastFetchTokenHash:a._skypeTokenData.getSkypeTokenHash(n.requestHeaders.Authorization),appVersion:a._config.getConfig().clientVersion}}a._telemetryManager.sendTelemetryEvent(new u.EcsConfigFetchResponse(_.fetchDelayMs,n.statusCode,c,a._skypeTokenData.isSkypeTokenValid(),i[a._serverIndex],_.fetchDurationValid,!!m,JSON.stringify(n).length,_.cacheAge,!(e&&e.expiration-Date.now()>0),s,_.lastResponseTime,t,f)),a._ecsFailureBackoffTimer.reset(),o.resolve(h)}).catch(function(n){var r={timedOut:n&&n.timedOut||!1,responseParseError:n&&n.responseParsingException,responseCode:n&&n.statusCode||0,message:a._getErrorMessage(n)};console.error("ECS - Service request failed to return a response (timedOut: "+r.timedOut+", responseParseError: "+r.responseParseError+")");var o=a._calculateResponseTimeInfo(e);a._telemetryManager.sendTelemetryEvent(new u.EcsConfigFetchResponse(o.fetchDelayMs,r.responseCode,c,a._skypeTokenData.isSkypeTokenValid(),i[a._serverIndex],o.fetchDurationValid,!!m,0,o.cacheAge,!(e&&e.expiration-Date.now()>0),s,o.lastResponseTime,t,void 0,r.timedOut,r.responseParseError,r.message));var d=a._config.getConfig().fetchAttemptMax;d&&c>d||setTimeout(function(){p()},a._ecsFailureBackoffTimer.getTimeAndCalculateNext())})};return p(),o.promise()},e.prototype._calculateExpirationDate=function(e){var t=Date.now()+1728e5;if(e.date&&e.expires){var n=new Date(e.date).getTime(),a=Date.now()-n,i=new Date(e.expires).getTime();return isNaN(i)?t:Math.min(t,i+a)}var r=this._cacheMaxAgeRegex.exec(e["cache-control"]);return this._cacheMaxAgeRegex.lastIndex=0,r&&2===r.length?Math.min(t,Date.now()+1e3*Number(r[1])):Date.now()+18e5},e.prototype._calculateResponseTimeInfo=function(e){var t=(o=Date.now())-s;return{lastResponseTime:o,fetchDelayMs:t,fetchDurationValid:!(t<0||t>31536e6),cacheAge:e?o-e.cacheUpdateTime:0}},e.prototype._getErrorMessage=function(e){if(e)return"string"==typeof e?e:"object"==typeof e&&(e.statusText||e.message)?e.statusText||e.message:void 0},e}();t.default=p}
,4937:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(9116),i=n(9715),r=function(){function e(e,t,n,r,o,s){var c=this;this._config=e,this._skypeTokenData=t,this._cache=n,this._isFetchingSettings={},this._pendingFetch={},this._pendingTimers={},this._subscriptionToken=null,this._paused=!1,this._fetchEcsSettingsIfNeeded=function(e){var t,n=c._config.getConfig(),i=c._cache.getEcsConfigByType(e);if(-1!==n.configsToFetch.indexOf(e)&&!c._isFetchingSettings[e])if(i||!c._pendingFetch[e]){var r=i?i.expiration-Date.now():-1;r<=0||i&&e===a.EcsConfigType.User&&c._skypeTokenData.isSkypeTokenValid()&&i.lastFetchTokenHash!==c._skypeTokenData.getSkypeTokenHash(c._skypeTokenData.getSkypeToken())?c._fetchSkypeEcsSettings(e):(null===(t=n.Killswitches)||void 0===t?void 0:t.isSkypeTokenDataLeakFixEnabled)?(c._pendingTimers[e]>0&&clearTimeout(c._pendingTimers[e]),c._pendingTimers[e]=window.setTimeout(function(){return c._fetchEcsSettingsIfNeeded(e)},r)):window.setTimeout(function(){return c._fetchEcsSettingsIfNeeded(e)},r)}else c._fetchSkypeEcsSettings(e)},this._fetchSkypeEcsSettings=function(e,t){void 0===t&&(t=!1),c._isFetchingSettings[e]||c._paused&&!t?c._pendingFetch[e]=!0:(c._pendingFetch[e]=!1,c._isFetchingSettings[e]=!0,c._config.getConfig().getEcsParameters().catch(function(){return console.warn("ECS - Failed to fetch ECS fetching parameters"),{}}).then(function(t){return c._ecsClient.getConfig(c._cache.getEcsConfig(),e===a.EcsConfigType.User,t)}).then(function(t){console.log("ECS - Config fetch complete"),c._isFetchingSettings[e]=!1,c._cache.putConfig(t),c._fetchEcsSettingsIfNeeded(e)}))},this._ecsClient=new i.default(this._config,this._skypeTokenData,r,o,s)}return e.prototype.initialize=function(){var e=this;this.updateConfigsToFetch(),this._subscriptionToken=this._skypeTokenData.skypeTokenChanged.subscribe(function(){return e._fetchEcsSettingsIfNeeded(a.EcsConfigType.User)})},e.prototype.dispose=function(){var e,t,n=this._config.getConfig();if(null===(e=n.Killswitches)||void 0===e?void 0:e.isSkypeTokenDataLeakFixEnabled){for(var a=0,i=n.configsToFetch;a<i.length;a++){var r=i[a];clearTimeout(this._pendingTimers[r]),this._pendingTimers[r]=0}null===(t=this._subscriptionToken)||void 0===t||t.unsubscribe(),this._subscriptionToken=null,this._skypeTokenData.skypeTokenChanged.dispose()}},e.prototype.updateConfigsToFetch=function(){for(var e=this._config.getConfig(),t=0,n=e.configsToFetch;t<n.length;t++)(r=n[t])in this._isFetchingSettings||(this._isFetchingSettings[r]=!1),r in this._isFetchingSettings||(this._pendingFetch[r]=!1);for(var a=0,i=e.configsToFetch;a<i.length;a++){var r=i[a],o=this._cache.getEcsConfigByType(r);!o||o.appVersion&&o.appVersion!==e.clientVersion?this._fetchSkypeEcsSettings(r,!0):this._fetchEcsSettingsIfNeeded(r)}},e.prototype.requestUpdate=function(){for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchSkypeEcsSettings(n)}},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1;for(var e=0,t=this._config.getConfig().configsToFetch;e<t.length;e++){var n=t[e];this._fetchEcsSettingsIfNeeded(n)}},e}();t.default=r}
,7681:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5557),i=n(2780),r=function(){function e(){this.skypeTokenChanged=new a.default}return e.prototype.putSkypeTokenData=function(e){if(this._data=e,this.isSkypeTokenValid()&&this.skypeTokenChanged.fire(),this.isSkypeTokenValid()&&this._validSkypeTokenDeferral){var t=this._validSkypeTokenDeferral;this._validSkypeTokenDeferral=void 0,t.resolve(void 0)}},e.prototype.isSkypeTokenValid=function(){var e=this._data;return!!e&&!!e.skypeToken&&e.skypeTokenExpiration>Date.now()},e.prototype.getSkypeToken=function(){var e=this._data;if(!e||!e.skypeToken)throw new Error("No Skype Token provided");return e.skypeToken},e.prototype.getSkypeTokenHash=function(e){return void 0===e?0:e.split("").reduce(function(e,t){return(101*e+t.charCodeAt(0))%999727999},e.length)},e.prototype.waitForValidSkypeToken=function(){return this.isSkypeTokenValid()?i.Resolved():(this._validSkypeTokenDeferral||(this._validSkypeTokenDeferral=i.Defer()),this._validSkypeTokenDeferral.promise())},e}();t.default=r}
,2138:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.getAttributes=function(){return{Source:"ecs_client"}},e}();t.TelemetryEventBase=n}
,3558:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n,a,i,r,o,s,c,d,l,u,f,p,m,_,h,b){var g=e.call(this)||this;return g._responseTime=t,g._responseCode=n,g._fetchAttempts=a,g._hasValidToken=i,g._serverEndpoint=r,g._fetchDurationValid=o,g._cacheAvailable=s,g._responseSize=c,g._configAge=d,g._configExpired=l,g._fetchStart=u,g._fetchEnd=f,g._isUserConfig=p,g._etag=m,g._timedOut=_,g._responseParsingException=h,g._errorMessage=b,g}return i(t,e),t.prototype.getEventName=function(){return"ecs_tsclient_fetch_config"},t.prototype.getAttributes=function(){var t=e.prototype.getAttributes.call(this);return t.fetch_delay_ms=this._responseTime,t.fetch_response_code=this._responseCode,t.fetch_attempts=this._fetchAttempts,t.authenticated_user=this._hasValidToken,t.url=this._serverEndpoint,t.fetch_duration_valid=this._fetchDurationValid,t.cache_available=this._cacheAvailable,t.response_size=this._responseSize,t.config_age=this._configAge,t.config_expired=this._configExpired,t.fetch_start=this._fetchStart,t.fetch_end=this._fetchEnd,t.is_user_config=this._isUserConfig,this._etag&&(t.fetched_etag=this._etag),void 0!==this._timedOut&&(t.fetch_timed_out=this._timedOut),this._responseParsingException&&(t.fetch_response_parsing_error=this._responseParsingException.message),this._errorMessage&&(t.fetch_error_message=this._errorMessage),t},t}(n(2138).TelemetryEventBase);t.EcsConfigFetchResponse=r}
,9176:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5557),i=function(){function e(e){this._cache=e,this.telemetryEventAdded=new a.default}return e.prototype.sendTelemetryEvent=function(t){var n=t.getEventName(),a=t.getAttributes(),i=!1,r=this._cache.getEcsConfig();if(r){if(e._containsEcsClientTelemetryConfig(r.config)){var o=r.config.ECSCONFIG;o&&o.ecsClientTelemetry&&(i=!!o.ecsClientTelemetry[n])}}else console.warn("No previously cached ECS telemetry config exists - fallback to sending event"),i=!0;i&&this.telemetryEventAdded.fire(n,a)},e._containsEcsClientTelemetryConfig=function(e){return!!e&&!!e.ECSCONFIG&&!!e.ECSCONFIG.ecsClientTelemetry},e}();t.default=i}
,4030:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(5773);t.DEFAULT_TIME_GROW_FACTOR=2.718281828459045,t.DEFAULT_TIME_JITTER=.11962656472;var i=function(){function e(e,n,i,r){void 0===i&&(i=t.DEFAULT_TIME_GROW_FACTOR),void 0===r&&(r=t.DEFAULT_TIME_JITTER),this._initialTime=e,this._maxTime=n,this._growFactor=i,this._jitterFactor=r,a.assert(this._initialTime>0,"Initial delay must be positive"),a.assert(this._maxTime>0,"Delay upper bound must be positive"),a.assert(this._growFactor>=0,"Ratio must be non-negative"),a.assert(this._jitterFactor>=0,"Jitter factor must be non-negative"),this.reset()}return e.prototype.reset=function(){this._incrementCount=0,this._currentTime=Math.round(this._initialTime*(1+Math.random()*this._jitterFactor))},e.prototype.getTime=function(){return this._currentTime},e.prototype.getIncrementCount=function(){return this._incrementCount},e.prototype.calculateNext=function(){var e=this._currentTime*this._growFactor;return e>this._maxTime&&(e=this._maxTime),this._jitterFactor<1e-5?this._currentTime=e:this._currentTime=Math.round(Math.random()*e*this._jitterFactor+e),this._currentTime<this._initialTime&&(this._currentTime=this._initialTime),this._currentTime>this._maxTime&&(this._currentTime=this._maxTime),this._incrementCount++,this._currentTime},e.prototype.getTimeAndCalculateNext=function(){var e=this.getTime();return this.calculateNext(),e},e}();t.ExponentialTime=i}
,5176:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},a.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(5773),r=n(9875),o=function(){function e(e){this._defaultOptions={excludeEndpointUrl:!1,withCredentials:!1,retries:0},this._endpointUrl=e}return e.prototype._performApiCall=function(e,t,n,o){var s=this;void 0===o&&(o={});var c=a(a({},this._defaultOptions),o);n&&(c.sendData=n),c.eTag&&(c.augmentHeaders||(c.augmentHeaders={}),c.augmentHeaders["If-None-Match"]=c.eTag),c.contentType||(c.contentType=i.isString(c.sendData)?"form":"json");var d=c.excludeEndpointUrl?e:this._endpointUrl+e;return new r.SimpleWebRequest(t,d,c,function(){return s._getHeaders(c)},function(){return s._blockRequestUntil(c)}).start().then(function(e){return s._processSuccessResponse(e),e})},e.prototype._getHeaders=function(e){return{}},e.prototype._blockRequestUntil=function(e){},e.prototype._processSuccessResponse=function(e){},e.prototype.performApiGet=function(e,t){return this.performApiGetDetailed(e,t).then(function(e){return e.body})},e.prototype.performApiGetDetailed=function(e,t){return this._performApiCall(e,"GET",void 0,t)},e.prototype.performApiPost=function(e,t,n){return this.performApiPostDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPostDetailed=function(e,t,n){return this._performApiCall(e,"POST",t,n)},e.prototype.performApiPatch=function(e,t,n){return this.performApiPatchDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPatchDetailed=function(e,t,n){return this._performApiCall(e,"PATCH",t,n)},e.prototype.performApiPut=function(e,t,n){return this.performApiPutDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiPutDetailed=function(e,t,n){return this._performApiCall(e,"PUT",t,n)},e.prototype.performApiDelete=function(e,t,n){return this.performApiDeleteDetailed(e,t,n).then(function(e){return e.body})},e.prototype.performApiDeleteDetailed=function(e,t,n){return this._performApiCall(e,"DELETE",t,n)},e}();t.GenericRestClient=o}
,3428:(e,t,n)=>{"use strict";function a(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),a(n(4030)),a(n(5176)),a(n(9875))}
,9875:function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},a(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,s,c=n(2780),d=n(5773),l=n(4030);function u(e){return!!e&&0===e.indexOf("application/json")}function f(e,t){return t.canceled||!t.statusCode||t.statusCode>=400&&t.statusCode<600?s.DoNotRetry:s.RetryCountedWithBackoff}!function(e){e[e.DontCare=0]="DontCare",e[e.Low=1]="Low",e[e.Normal=2]="Normal",e[e.High=3]="High",e[e.Critical=4]="Critical"}(o=t.WebRequestPriority||(t.WebRequestPriority={})),function(e){e[e.DoNotRetry=0]="DoNotRetry",e[e.RetryUncountedImmediately=1]="RetryUncountedImmediately",e[e.RetryUncountedWithBackoff=2]="RetryUncountedWithBackoff",e[e.RetryCountedWithBackoff=3]="RetryCountedWithBackoff",e[e.PauseUntilResumed=4]="PauseUntilResumed"}(s=t.ErrorHandlingType||(t.ErrorHandlingType={})),t.DefaultOptions={priority:o.Normal},t.SimpleWebRequestOptions={MaxSimultaneousRequests:5,HungRequestCleanupIntervalMs:1e4,setTimeout:function(e,t){return setTimeout(e,t)},clearTimeout:function(e){return clearTimeout(e)}},t.DefaultErrorHandler=f;var p,m=[],_=[],h=[],b=0,g=0,v=function(){function e(e,n,a,i,o){this._action=e,this._url=n,this.options=a,this._getHeaders=i,this._blockRequestUntil=o,this._aborted=!1,this._timedOut=!1,this._paused=!1,this._created=Date.now(),this._finishHandled=!1,this._retryExponentialTime=new l.ExponentialTime(1e3,3e5),this._options=r(r({},t.DefaultOptions),a)}return e.prototype.getPriority=function(){return this._options.priority||o.DontCare},e.checkQueueProcessing=function(){for(var e=function(){var e=m.shift();_.push(e),(e._blockRequestUntil&&e._blockRequestUntil()||c.Resolved()).finally(function(){d.remove(_,e)}).then(function(){h.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests&&!e._aborted?(h.push(e),y._scheduleHungRequestCleanupIfNeeded(),e._fire()):e._enqueue()},function(t){e._respond("_blockRequestUntil rejected: "+t)})};m.length>0&&h.length<t.SimpleWebRequestOptions.MaxSimultaneousRequests;)e()},e._scheduleHungRequestCleanupIfNeeded=function(){h.length>0&&void 0===p?p=t.SimpleWebRequestOptions.setTimeout(this._hungRequestCleanupTimerCallback,t.SimpleWebRequestOptions.HungRequestCleanupIntervalMs):0===h.length&&p&&(t.SimpleWebRequestOptions.clearTimeout(p),p=void 0)},e.prototype._removeFromQueue=function(){d.remove(h,this),d.remove(m,this)},e.prototype._assertAndClean=function(e,t){e||(this._removeFromQueue(),console.error(t),d.assert(e,t))},e.prototype._fire=function(){var n=this;this._xhr=new XMLHttpRequest,this._xhrRequestHeaders={};var a=d.attempt(function(){n._xhr.open(n._action,n._url,!0)});if(a)this._respond(a.toString());else{if(this._options.timeout){var i=g;3!==i&&(this._assertAndClean(!this._requestTimeoutTimer,"Double-fired requestTimeoutTimer"),this._requestTimeoutTimer=t.SimpleWebRequestOptions.setTimeout(function(){n._requestTimeoutTimer=void 0,n._timedOut=!0,n.abort()},this._options.timeout)),(3===i||i<=1)&&(this._xhr.timeout=this._options.timeout,this._xhr.ontimeout=function(){g=3,3===i&&(n._timedOut=!0,n._aborted=!0,n._respond("TimedOut"))})}var r=b;3!==r?(0===r&&(b=1),this._xhr.onreadystatechange=function(){n._xhr&&(3!==n._xhr.readyState||!n._options.streamingDownloadProgress||n._aborted?4===n._xhr.readyState&&(0===r&&1===b&&t.SimpleWebRequestOptions.setTimeout(function(){3!==b&&(b=2)},1e4),n._respond()):n._options.streamingDownloadProgress(n._xhr.responseText))}):this._options.streamingDownloadProgress&&(this._xhr.onreadystatechange=function(){n._xhr&&3===n._xhr.readyState&&n._options.streamingDownloadProgress&&!n._aborted&&n._options.streamingDownloadProgress(n._xhr.responseText)}),2!==r&&(this._xhr.onload=function(){b=3,3===r&&n._respond()},this._xhr.onerror=function(){b=3,3===r&&n._respond()}),this._xhr.onabort=function(){n._aborted=!0,n._respond("Aborted")},this._xhr.upload&&this._options.onProgress&&(this._xhr.upload.onprogress=this._options.onProgress);var o=this._options.acceptType||"json",s=this._options.customResponseType||e._getResponseType(o),c=d.attempt(function(){n._xhr.responseType=s});if(c&&"json"!==s)throw c;y._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Accept",e.mapContentType(o)),this._xhr.withCredentials=!!this._options.withCredentials;var l=this.getRequestHeaders(),u={};if(Object.keys(l).forEach(function(e){var t=l[e],a=e.toLowerCase();"content-type"!==a?"accept"!==a?(n._assertAndClean(!u[a],"Setting duplicate header key: "+u[a]+" and "+e),null!=t?(u[a]=!0,y._setRequestHeader(n._xhr,n._xhrRequestHeaders,e,t)):console.warn('Tried to set header "'+e+'" on request with "'+t+'" value, header will be dropped')):n._assertAndClean(!1,"Don't set Accept with options.headers -- use it with the options.acceptType property"):n._assertAndClean(!1,"Don't set Content-Type with options.headers -- use it with the options.contentType property")}),this._options.sendData){var f=e.mapContentType(this._options.contentType||"json");y._setRequestHeader(this._xhr,this._xhrRequestHeaders,"Content-Type",f);var p=e.mapBody(this._options.sendData,f);this._xhr.send(p)}else this._xhr.send()}},e._setRequestHeader=function(e,t,n,a){e.setRequestHeader(n,a),t[n]=a},e.mapContentType=function(e){return"json"===e?"application/json":"form"===e?"application/x-www-form-urlencoded":e},e.mapBody=function(e,t){if(u(t)){if(!d.isString(e))return JSON.stringify(e)}else if((r=t)&&0===r.indexOf("application/x-www-form-urlencoded")){if(!d.isString(e)&&d.isObject(e)){var n=e;return Object.keys(n).map(function(e){return encodeURIComponent(e)+(n[e]?"="+encodeURIComponent(n[e].toString()):"")}).join("&")}}else if(function(e){return!!e&&0===e.indexOf("multipart/form-data")}(t)){if(d.isObject(e)){var a=new FormData,i=e;return Object.keys(i).forEach(function(e){return a.append(e,i[e])}),a}d.assert(!1,"contentType multipart/form-data must include an object as sendData")}var r;return e},e.prototype.setUrl=function(e){this._url=e},e.prototype.setHeader=function(e,t){this._options.augmentHeaders||(this._options.augmentHeaders={}),t?this._options.augmentHeaders[e]=t:delete this._options.augmentHeaders[e]},e.prototype.getRequestHeaders=function(){var e={};return!this._getHeaders||this._options.overrideGetHeaders||this._options.headers||(e=r(r({},e),this._getHeaders())),this._options.overrideGetHeaders&&(e=r(r({},e),this._options.overrideGetHeaders)),this._options.headers&&(e=r(r({},e),this._options.headers)),this._options.augmentHeaders&&(e=r(r({},e),this._options.augmentHeaders)),e},e.prototype.getOptions=function(){return d.clone(this._options)},e.prototype.setPriority=function(e){this._options.priority!==e&&(this._options.priority=e,this._paused||this._xhr||(d.remove(m,this),this._enqueue()))},e.prototype.resumeRetrying=function(){this._paused?(this._paused=!1,this._enqueue()):d.assert(!1,"resumeRetrying() called but not paused!")},e.prototype._enqueue=function(){var t=this;if(!this._aborted&&!(h.indexOf(this)>=0||_.indexOf(this)>=0||m.indexOf(this)>=0)){var n=m.findIndex(function(e){return e.getPriority()===t.getPriority()&&e._created>t._created||e.getPriority()<t.getPriority()});n>-1?m.splice(n,0,this):m.push(this),e.checkQueueProcessing()}},e._getResponseType=function(e){return"blob"===e?"arraybuffer":"text/xml"===e||"application/xml"===e?"document":"text/plain"===e?"text":"json"},e._hungRequestCleanupTimerCallback=function(){p=void 0,h.filter(function(e){return!(!e._xhr||4!==e._xhr.readyState||(console.warn("SimpleWebRequests found a completed XHR that hasn't invoked it's callback functions, manually responding"),0))}).forEach(function(e){e._respond()}),y._scheduleHungRequestCleanupIfNeeded()},e}();t.SimpleWebRequestBase=v;var y=function(e){function n(t,n,a,i,r){return e.call(this,t,n,a,i,r)||this}return i(n,e),n.prototype.abort=function(){this._aborted?d.assert(!1,"Already aborted "+this._action+" request to "+this._url):(this._aborted=!0,this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._deferred?(this._respond("Aborted"),this._xhr&&this._xhr.abort()):d.assert(!1,"Haven't even fired start() yet -- can't abort"))},n.prototype.start=function(){var e=this;return this._deferred?(d.assert(!1,"WebRequest already started"),c.Rejected("WebRequest already started")):(this._deferred=c.Defer(),this._deferred.onCancel(function(){e.abort()}),this._enqueue(),this._deferred.promise())},n.prototype._respond=function(e){var n=this;if(!this._finishHandled){this._finishHandled=!0,this._removeFromQueue(),this._retryTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._retryTimer),this._retryTimer=void 0),this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0);var a,i=0;if(this._xhr)try{i=this._xhr.status,a=this._xhr.statusText||e}catch(e){}else a=e||"Browser Error - Possible CORS or Connectivity Issue";var r,o,c={};if(this._xhr){if((this._xhr.getAllResponseHeaders()||"").split(/\r?\n/).forEach(function(e){if(0!==e.length){var t=e.indexOf(":");-1===t?c[e]="":c[e.substr(0,t).toLowerCase()]=e.substr(t+1).trim()}}),!c["content-type"]){var l=this._xhr.getResponseHeader("content-type");l&&(c["content-type"]=l)}if(r=this._xhr.response,c["content-type"]&&u(c["content-type"])&&(!r||!d.isObject(r))&&("text"===this._xhr.responseType||""===this._xhr.responseType)&&this._xhr.responseText)try{r=JSON.parse(this._xhr.responseText)}catch(e){o=e,console.warn("Failed to parse XHR JSON response")}}if(this._xhr&&4===this._xhr.readyState&&(i>=200&&i<300||304===i)){var p={url:this._xhr.responseURL||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:a,headers:c,body:r,responseParsingException:o};this._deferred.resolve(p)}else{var m={url:(this._xhr?this._xhr.responseURL:void 0)||this._url,method:this._action,requestOptions:this._options,requestHeaders:this._xhrRequestHeaders||{},statusCode:i,statusText:a,headers:c,body:r,canceled:this._aborted,timedOut:this._timedOut,responseParsingException:o};this._options.augmentErrorResponse&&this._options.augmentErrorResponse(m);var _=this._options.customErrorHandler?this._options.customErrorHandler(this,m):f(0,m);_!==s.DoNotRetry&&(this._options.retries&&this._options.retries>0||_===s.PauseUntilResumed||_===s.RetryUncountedImmediately||_===s.RetryUncountedWithBackoff)?(_===s.RetryCountedWithBackoff&&this._options.retries--,this._requestTimeoutTimer&&(t.SimpleWebRequestOptions.clearTimeout(this._requestTimeoutTimer),this._requestTimeoutTimer=void 0),this._aborted=!1,this._timedOut=!1,this._finishHandled=!1,this._xhr&&(this._xhr.onabort=null,this._xhr.onerror=null,this._xhr.onload=null,this._xhr.onprogress=null,this._xhr.onreadystatechange=null,this._xhr.ontimeout=null,this._xhr=void 0,this._xhrRequestHeaders=void 0),_===s.PauseUntilResumed?this._paused=!0:_===s.RetryUncountedImmediately?this._enqueue():this._retryTimer=t.SimpleWebRequestOptions.setTimeout(function(){n._retryTimer=void 0,n._enqueue()},this._retryExponentialTime.getTimeAndCalculateNext())):this._deferred.reject(m)}v.checkQueueProcessing()}},n}(v);t.SimpleWebRequest=y}
,5773:function(e,t){"use strict";var n=this&&this.__assign||function(){return n=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},n.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.assert=function(e,t){if(!e)throw new Error(t)},t.isObject=function(e){return null!==e&&"object"==typeof e},t.isString=function(e){return"string"==typeof e},t.attempt=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];try{return e.apply(void 0,t)}catch(e){return new Error(e)}},t.remove=function(e,t){for(var n=e.length-1;n>=0;n--)e[n]===t&&e.splice(n,1)},t.clone=function(e){return Array.isArray(e)?e.map(t.clone):t.isObject(e)?Object.keys(e).reduce(function(a,i){var r;return n(n({},a),((r={})[i]=t.clone(e[i]),r))},{}):e}}
,7311:(e,t,n)=>{e.exports=n(3428)}
,5557:(e,t,n)=>{"use strict";n.r(t),n.d(t,{SubscriptionToken:()=>a,default:()=>i});var a=function(){function e(e,t){this._event=e,this._callback=t}return e.prototype.unsubscribe=function(){this._event.unsubscribe(this._callback)},e}();const i=function(){function e(e){void 0===e&&(e=!1);var t=this;this._allowStopPropagation=e,this.fire=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var a=t._subscribers,i=a.length-1;i>=0;i--){var r=a[i].apply(null,e);if(t._allowStopPropagation&&r)return!0}return!1},this._subscribers=[]}return e.prototype.dispose=function(){this._subscribers=[]},e.prototype.subscribe=function(e){return this._subscribers=this._subscribers.concat(e),new a(this,e)},e.prototype.unsubscribe=function(e){this._subscribers=this._subscribers.filter(function(t){return t!==e})},e}()}
,2780:(e,t)=>{"use strict";function n(e){return null!=e&&"function"==typeof e.then}function a(e){return null!=e&&"function"==typeof e.cancel}function i(e,n){if(!t.config.catchExceptions)return e();try{return e()}catch(e){return n(e)}}Object.defineProperty(t,"__esModule",{value:!0}),t.config={exceptionsToConsole:!0,catchExceptions:!0,traceEnabled:!1,exceptionHandler:void 0,unhandledErrorHandler:function(e){throw e}},t.fromThenable=function(e){var t=l();return e.then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise().thenAsync(function(e){return e})};var r,o=[],s="undefined"!=typeof setImmediate;function c(e){o.push(e),1===o.length&&(s?setImmediate(d):setTimeout(d,0))}function d(){var e=o;o=[];for(var t=0;t<e.length;t++)e[t]()}function l(){return new r.SyncTask}function u(e){return(new r.SyncTask).resolve(e).promise()}function f(e){var t=l(),i=!1;return t.onCancel(function(t){e.forEach(function(e){a(e)&&r.SyncTask.cancelOtherInternal(e,t)})}),e.forEach(function(e){n(e)?e.then(function(e){i||(i=!0,t.resolve(e))},function(e){i||(i=!0,t.reject(e))}):i||(i=!0,t.resolve(e))}),t.promise()}t.asyncCallback=c,function(e){var r=function(){function e(){this._completedSuccess=!1,this._completedFail=!1,this._traceEnabled=!1,this._cancelCallbacks=[],this._wasCanceled=!1,this._wasExplicitlyCanceled=!1,this._resolving=!1,this._storedCallbackSets=[],this._mustHandleError=!0}return e.prototype._addCallbackSet=function(t,n){var a=this,i=new e;return i.onCancel(function(e){t.wasCanceled=!0,t.cancelContext=e,a._cancelInternal(e)}),t.task=i,this._storedCallbackSets.push(t),n?this._mustHandleError=!1:i._mustHandleError=!1,this._resolving||(this._completedSuccess?this._resolveSuccesses():this._completedFail&&this._resolveFailures()),i.promise()},e.prototype.onCancel=function(e){return this._completedSuccess||this._completedFail||(this._wasCanceled?e(this._cancelContext):this._cancelCallbacks.push(e)),this},e.prototype.then=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t},!0)},e.prototype.thenAsync=function(e,t){return this._addCallbackSet({successFunc:e,failFunc:t,asyncCallback:!0},!0)},e.prototype.catch=function(e){return this._addCallbackSet({failFunc:e},!0)},e.prototype.always=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!0)},e.prototype.setTracingEnabled=function(e){return this._traceEnabled=e,this},e.prototype.finally=function(e){return this._addCallbackSet({successFunc:e,failFunc:e},!1),this},e.prototype.done=function(e){return this._addCallbackSet({successFunc:e},!1),this},e.prototype.fail=function(e){return this._addCallbackSet({failFunc:e},!1),this},e.prototype.resolve=function(e){return this._checkState(!0),this._completedSuccess=!0,this._storedResolution=e,this._cancelCallbacks=[],this._resolveSuccesses(),this},e.prototype.reject=function(t){return this._checkState(!1),this._completedFail=!0,this._storedErrResolution=t,this._cancelCallbacks=[],this._resolveFailures(),e._enforceErrorHandled(this),this},e.prototype._checkState=function(e){if(this._completedSuccess||this._completedFail){this._completeStack&&console.error(this._completeStack.message,this._completeStack.stack);var n="Failed to "+(e?"resolve":"reject")+": the task is already "+(this._completedSuccess?"resolved":"rejected");throw new Error(n)}(t.config.traceEnabled||this._traceEnabled)&&(this._completeStack=new Error("resolve"))},e._enforceErrorHandled=function(n){n._mustHandleError&&(e._rejectedTasks.push(n),e._enforceErrorHandledTimer||(e._enforceErrorHandledTimer=setTimeout(function(){e._enforceErrorHandledTimer=void 0;var n=e._rejectedTasks;e._rejectedTasks=[],n.forEach(function(e,n){e._mustHandleError&&t.config.unhandledErrorHandler(e._storedErrResolution)})},0)))},e.prototype.cancel=function(e){if(this._wasExplicitlyCanceled)throw new Error("Already Canceled");this._wasExplicitlyCanceled=!0,this._cancelInternal(e)},e.prototype._cancelInternal=function(e){var t=this;if(!this._wasCanceled){this._wasCanceled=!0,this._cancelContext=e;var n=this._cancelCallbacks;this._cancelCallbacks=[],n.length>0&&n.forEach(function(e){t._completedSuccess||t._completedFail||e(t._cancelContext)})}},e.cancelOtherInternal=function(e,t){var n=e;n._storedCallbackSets&&n._cancelInternal?n._cancelInternal(t):e.cancel(t)},e.prototype.promise=function(){return this},e.prototype._resolveSuccesses=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?c(function(){return e._resolveSuccessCallback(t)}):e._resolveSuccessCallback(t)})}this._resolving=!1},e.prototype._resolveSuccessCallback=function(t){var r=this;t.successFunc?i(function(){var i=t.successFunc(r._storedResolution);a(i)&&(t.wasCanceled?e.cancelOtherInternal(i,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(i,t)})),n(i)?i.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(i)},function(e){r._handleException(e,"SyncTask caught exception in success block: "+e.toString()),t.task.reject(e)}):t.task.resolve(this._storedResolution)},e.prototype._resolveFailures=function(){var e=this;for(this._resolving=!0;this._storedCallbackSets.length;){var t=this._storedCallbackSets;this._storedCallbackSets=[],t.forEach(function(t){t.asyncCallback?c(function(){return e._resolveFailureCallback(t)}):e._resolveFailureCallback(t)})}this._resolving=!1},e.prototype._resolveFailureCallback=function(t){var r=this;t.failFunc?i(function(){var i=t.failFunc(r._storedErrResolution);a(i)&&(t.wasCanceled?e.cancelOtherInternal(i,t.cancelContext):t.task.onCancel(function(t){return e.cancelOtherInternal(i,t)})),n(i)?i.then(function(e){t.task.resolve(e)},function(e){t.task.reject(e)}):t.task.resolve(i)},function(e){r._handleException(e,"SyncTask caught exception in failure block: "+e.toString()),t.task.reject(e)}):t.task.reject(this._storedErrResolution)},e.prototype._handleException=function(e,n){t.config.exceptionsToConsole&&console.error(n),t.config.exceptionHandler&&t.config.exceptionHandler(e)},e.prototype.toEs6Promise=function(){var e=this;return new Promise(function(t,n){return e.then(t,n)})},e._rejectedTasks=[],e}();e.SyncTask=r}(r||(r={})),t.all=function(e){if(0===e.length)return u([]);var t,i=l(),o=e.length,s=Array(e.length);i.onCancel(function(t){e.forEach(function(e){a(e)&&r.SyncTask.cancelOtherInternal(e,t)})});var c=function(){0==--o&&(void 0!==t?i.reject(t):i.resolve(s))};return e.forEach(function(e,a){n(e)?e.then(function(e){s[a]=e,c()},function(e){void 0===t&&(t=void 0===e||e),c()}):(s[a]=e,c())}),i.promise()},t.Defer=l,t.Resolved=u,t.Rejected=function(e){return(new r.SyncTask).reject(e).promise()},t.race=f,t.raceTimer=function(e,t){var n=l(),a=setTimeout(function(){n.resolve({timedOut:!0})},t);return f([e.then(function(e){return clearTimeout(a),{timedOut:!1,result:e}}),n.promise()])}}
,8424:e=>{"use strict";e.exports=t},9676:e=>{"use strict";e.exports=n},2207:e=>{"use strict";e.exports=a},8414:e=>{"use strict";e.exports=u},7408:e=>{"use strict";e.exports=i},2141:e=>{"use strict";e.exports=r},6277:e=>{"use strict";e.exports=d},9392:e=>{"use strict";e.exports=o},75:e=>{"use strict";e.exports=s},5519:e=>{"use strict";e.exports=c},8660:e=>{"use strict";e.exports=l}},p={};function m(e){var t=p[e];if(void 0!==t)return t.exports;var n=p[e]={exports:{}};return f[e].call(n.exports,n,n.exports,m),n.exports}m.m=f;var _,h,b,g={"231":"6zAsgUI/wqWMpMoKmDMzop4lUI+2Fm8IWXy3BeDfhOA=","435":"dtsbCDadwAGHbMtzzdAsLpAEyLohfGQbCyJKC4Bxvbc=","706":"/Y05hMg4kiS6gAH8IqRND7JMuWkqA4NCB5VxcJXsHCk=","927":"xewqoLD9HSdW8FDs8TqeVmkqeoo8o/QTFIJOe2hWiHA="};m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},m.d=(e,t)=>{for(var n in t)m.o(t,n)&&!m.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce((t,n)=>(m.f[n](e,t),t),[])),m.u=e=>"chunk."+{231:"CopilotDebugTools",435:"copilotCampaignDefinitions",706:"sp-feedback-getFeedbackOptions",927:"custom-gpt-graphUtilities"}[e]+"_"+({435:1}[e]?"en-us":"none")+"_"+{231:"822376421c229be60653",435:"3517bb33d61ab3a008e2",706:"d7749fa276cd9b1cd901",927:"fe7922896eb9e78b7c75"}[e]+".js",m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),_={},h="2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0:",m.l=(e,t,n,a)=>{if(_[e])_[e].push(t);else{var i,r;if(void 0!==n)for(var o=document.getElementsByTagName("script"),s=0;s<o.length;s++){var c=o[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==h+n){i=c;break}}if(!i){r=!0,(i=document.createElement("script")).charset="utf-8",i.timeout=120,m.nc&&i.setAttribute("nonce",m.nc),i.setAttribute("data-webpack",h+n),i.src=e,0!==i.src.indexOf(window.location.origin+"/")&&(i.crossOrigin="anonymous");var d=function(e){return"sha256-"+(g[e]||"Missing+Integrity+Hash+For+Script+Aborting=")}(a);d&&(i.integrity=d)}_[e]=[t];var l=(t,n)=>{i.onerror=i.onload=null,clearTimeout(u);var a=_[e];if(delete _[e],i.parentNode&&i.parentNode.removeChild(i),a&&a.forEach(e=>e(n)),t)return t(n)},u=setTimeout(l.bind(null,void 0,{type:"timeout",target:i}),12e4);i.onerror=l.bind(null,i.onerror),i.onload=l.bind(null,i.onload),r&&document.head.appendChild(i)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},b=e?e.src:"",m.p=b.slice(0,b.lastIndexOf("/")+1),m.f.compat=(e,t)=>{for(var n=function(e){return{706:[{i:"8494e7d7-6b99-47b2-a741-59873e42f16f",v:"13.12.44",m:718}],927:[{i:"01c4df03-e775-48cb-aa14-171ee5199a15",v:"2.3.1",m:280},{i:"cc2cc925-b5be-41bb-880a-f0f8030c6aff",v:"5.6.542",m:8810}]}[e]||[]}(e),a=0;a<n.length;a++)m.m[n[a].m]||(e=>{t.push(v.SPComponentLoader.loadComponentById(e.i,e.v).then(t=>{m.m[e.m]=e=>e.exports=t}))})(n[a])};var v=m(8414);(()=>{var e={834:0};m.f.j=(t,n)=>{var a=m.o(e,t)?e[t]:void 0;if(0!==a)if(a)n.push(a[2]);else{var i=new Promise((n,i)=>a=e[t]=[n,i]);n.push(a[2]=i);var r=m.p+m.u(t),o=new Error;m.l(r,n=>{if(m.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=n&&("load"===n.type?"missing":n.type),r=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed.\n("+i+": "+r+")",o.name="ChunkLoadError",o.type=i,o.request=r,a[1](o)}},"chunk-"+t,t)}};var t=(t,n)=>{var a,i,[r,o,s]=n,c=0;if(r.some(t=>0!==e[t])){for(a in o)m.o(o,a)&&(m.m[a]=o[a]);s&&s(m)}for(t&&t(n);c<r.length;c++)i=r[c],m.o(e,i)&&e[i]&&e[i][0](),e[i]=0},n=self["webpackJsonp_2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0"]=self["webpackJsonp_2ade42ba-c2c8-4cc4-9b7b-bd962efd6162_1.0.0"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var y={};return(()=>{"use strict";m.r(y),m.d(y,{SPFeedback:()=>Z,spFeedbackServiceKey:()=>$}),m(8424).loadStyles("#obf-TFormContainer{color:#000!important}",!0);var e=m(9676),t=m(2207),n=m(7408),a=m(2141),i=m(9392);class r extends class{dispose(){this._isDisposed||(this.onDispose(),this._isDisposed=!0)}get componentConfiguration(){return this._componentConfiguration}set componentConfiguration(e){this._componentConfiguration=e}get serviceConfiguration(){return this._serviceConfiguration}get serviceScope(){return this._serviceScope}get isDisposed(){return this._isDisposed}createServiceComponent(t,n){e.Validate.isNotNullOrUndefined(n,"componentFactory"),void 0===this._serviceComponent&&(this._componentConfiguration=t,this._serviceComponent=n(t))}get serviceComponent(){return this._serviceComponent}onDispose(){}constructor(t,n){e.Validate.isNotNullOrUndefined(t,"serviceScope"),e.Validate.isNotNullOrUndefined(n,"serviceConfiguration"),e.Validate.isNotNullOrUndefined(n.serviceKey,"serviceConfiguration.serviceKey"),this._serviceScope=t,this._serviceConfiguration=n,this._isDisposed=!1}}{createA11yManager(t){e.Validate.isNotNullOrUndefined(t,"domElement"),super.createServiceComponent(this.componentConfiguration,e=>i.A11yManager.create(t,this.componentConfiguration||void 0))}get a11yManager(){return this.serviceComponent}constructor(e){super(e,{serviceKey:r.serviceKey,isShared:!1})}}r.a11yServiceName="sp-pages-core:A11yManager",r.serviceKey=e.ServiceKey.create(r.a11yServiceName,r);var o=m(75),s=m(1545),c=m(2780),d=m(5557),l=m(5514);const u=function(){function e(e){this.hostStorageProvider=e}return e.prototype.put=function(e){return this.hostStorageProvider.write(s.FloodgateStorageProviderFileType.DynamicCampaignDefinitions,JSON.stringify(e)),Promise.resolve()},e.prototype.pull=function(){var e;try{e=JSON.parse(this.hostStorageProvider.read(s.FloodgateStorageProviderFileType.DynamicCampaignDefinitions))}catch(t){e={}}return new Promise(function(t){return t(e)})},e.prototype.putData=function(e,t){return this.put(t),c.Resolved()},e.prototype.getData=function(e){return c.fromThenable(this.pull())},e}();var f=new Map;f.set("disableexperiments","true"),f.set("disablerollouts","false");const p={host:"https://config.edge.skype.com",clientName:"CHILL",clientVersion:"0.0.13",timeout:6e4,allowBackgroundFetch:!0,filters:f};var _;!function(e){e.EcsClientStartFailed="FloodgateCore_ECSClient_Start_Failed"}(_||(_={}));var h=function(){return h=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},h.apply(this,arguments)},b=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,i,r=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(a=r.next()).done;)o.push(a.value)}catch(e){i={error:e}}finally{try{a&&!a.done&&(n=r.return)&&n.call(r)}finally{if(i)throw i.error}}return o},g=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))};const v=function(){function e(e){var t,n,a;if(this.telemetryEvents=new d.default,null==e.localStorageProvider)throw new Error("[Dynamic Campaign] - The Storage provider is not defined but it is a required field.");a=new u(e.localStorageProvider),e.filters=new Map(g(g([],b(Array.from(p.filters.entries())),!1),b(Array.from(null!==(n=null===(t=e.filters)||void 0===t?void 0:t.entries())&&void 0!==n?n:[])),!1)),e.appName&&e.filters.set("Application",e.appName),e.appVersion&&e.filters.set("version",e.appVersion),e.language&&e.filters.set("language",e.language),e.filters.has("agents")&&(e.filters.has("agent")||e.filters.set("agent",e.filters.get("agents")),e.filters.delete("agents"));var i=h(h({},p),e);this._skypeClientConfig={hosts:[i.host],clientName:i.clientName,clientVersion:i.clientVersion,configsToFetch:[s.EcsConfigType.Default],initialAppActiveState:!0,fetchTimeout:i.timeout,getEcsParameters:function(){var e,t,n={};try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i.filters.keys()),r=a.next();!r.done;r=a.next()){var o=r.value;n[o]=i.filters.get(o)}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return c.Resolved(n)},databaseInterface:a,fetchAttemptMax:e.fetchAttemptMax||10},this.ecsClient=new l.Oy,this.ecsClient.setAllowBackgroundFetch(i.allowBackgroundFetch),[].findIndex(function(e){return void 0===e})}return e.prototype.start=function(){return e=this,void 0,n=function(){var e,t=this;return function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}}(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),this.ecsClient.telemetryEventAdded.subscribe(function(e,n){t.telemetryEvents.fire(e,n)}),[4,this.ecsClient.initialize(this._skypeClientConfig).toEs6Promise()];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),this.telemetryEvents.fire(_.EcsClientStartFailed,{ErrorMessage:e}),[3,3];case 3:return[2]}})},new((t=void 0)||(t=Promise))(function(a,i){function r(e){try{s(n.next(e))}catch(e){i(e)}}function o(e){try{s(n.throw(e))}catch(e){i(e)}}function s(e){var n;e.done?a(e.value):(n=e.value,n instanceof t?n:new t(function(e){e(n)})).then(r,o)}s((n=n.apply(e,[])).next())});var e,t,n},e.prototype.getConfig=function(){return this.ecsClient.getConfig()},e.prototype.queueManualRefresh=function(){this.ecsClient.requestUpdate()},e.prototype.pause=function(){this.ecsClient.pause()},e.prototype.resume=function(){this.ecsClient.resume()},e}();var S=m(5519);const D=JSON.parse('{"yU":"You just published a page! Tell us how it went.","rC":"We have just two questions for you.","c_":"Sure","VO":"Not now","$4":"How likely are you to recommend creating and publishing pages in SharePoint to others, if asked?","kW":"1 - Very dissatisfied","BQ":"2","Pc":"3","xx":"4","qs":"5 - Very satisfied","Vp":"1 - Not at all likely","My":"5 - Extremely likely","BI":"Press alt + down arrow key to go to feedback form.","xI":"Please tell us more. Why did you choose that rating?","$P":"You just edited a page! Tell us how it went.","MN":"How easy was it for you to use the text web part?","Y_":"1 - Very hard","Y4":"5 - Very easy","sT":"We have just one question for you.","Rf":"Sure","iv":"Not now","Th":"How likely are you to recommend SharePoint Agreements to a friend or colleague?","Yr":"1 - Not at all likely","np":"2","YM":"3","V4":"4","d3":"5 - Extremely likely","Nv":"Please tell us how we can improve your experience.","Ks":"Tell us how it went."}'),I={CampaignId:"dd025788-0c5d-4dde-812e-2b30af0d3bf9",StartTimeUtc:"2020-03-19T00:00:00Z",EndTimeUtc:"2026-01-01T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Activity:"PublishFeatureUsage",Count:1,IsAggregate:!0},Content:{Prompt:{Title:D.yU,Question:D.rC,YesLabel:D.c_,NoLabel:D.VO},Rating:{isZeroBased:!1,Question:D.$4,RatingValuesAscending:[D.Vp,D.BQ,D.Pc,D.xx,D.My]},Question:{Question:D.xI}}},PrimaryPriority:3},x=JSON.parse('{"Lm":"You\\u0027ve created a new page! Tell us how it went.","kJ":"How satisfied are you with creating and finding your page?","kT":"Tell us more. Why did you choose that rating?"}'),C={CampaignId:"f75eef0a-4a84-4533-a546-1948d664e5b1",StartTimeUtc:"2024-01-01T00:00:00Z",EndTimeUtc:"2026-12-01T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:10368e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!0,Activity:"SharePointStartCreatePage",Count:1},{Type:0,IsAggregate:!0,Activity:"SharePointStartUsage",Count:1}],IsAggregate:!0},Content:{Prompt:{Title:x.Lm,Question:D.rC,YesLabel:D.c_,NoLabel:D.VO},Rating:{isZeroBased:!1,Question:x.kJ,RatingValuesAscending:[D.kW,D.BQ,D.Pc,D.xx,D.qs]},Question:{Question:x.kT}}},PrimaryPriority:3},O={CampaignId:"37cdaeac-09cf-40a4-b22a-1c0af173f566",StartTimeUtc:"2025-01-16T00:00:00Z",EndTimeUtc:"2025-02-22T00:00:00Z",GovernedChannelType:0,Scope:{Type:1},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!1,Activity:"RichTextEditorUsage",Count:2},{Type:0,IsAggregate:!1,Activity:"PageAuthoringEndUsage",Count:1}]},Content:{Prompt:{Title:D.$P,Question:D.rC,YesLabel:D.c_,NoLabel:D.VO},Rating:{isZeroBased:!1,Question:D.MN,RatingValuesAscending:[D.Y_,D.BQ,D.Pc,D.xx,D.Y4]},Question:{Question:D.xI}}},PrimaryPriority:3},w={CampaignId:"049eae42-7cae-4f45-b362-134673bcdf23",StartTimeUtc:"2024-07-11T07:00:00Z",EndTimeUtc:"2024-12-31T08:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1296e3},CooldownPeriod:{Type:0,IntervalSeconds:7884e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,IsAggregate:!1,Activity:"AgreementsTriggerAction",Count:1}]},Content:{Prompt:{Title:D.Ks,Question:D.sT,YesLabel:D.Rf,NoLabel:D.iv},Rating:{isZeroBased:!1,Question:D.Th,RatingValuesAscending:[D.Yr,D.np,D.YM,D.V4,D.d3]},Question:{Question:D.Nv}}},PrimaryPriority:3};function E(){return e._SPKillSwitch.isActivated("663a16f6-7f7a-4a50-a27b-6ba9eefd899c")}function A(){return e._SPKillSwitch.isActivated("9230528e-0c67-477b-b182-d7fae341c74e")}let L,k,M=[];async function P(){if(!L&&(L=m.e(231).then(m.bind(m,8939)),k=(await L).tools,M.length)){for(const e of M)await e(k);M=[]}}function T(e){k?e(k):M.push(e)}function U(){return window.$copilot||(window.$copilot={availability:{},loadDebugTools:P,get tools(){if(!k)throw Error("Call `await $copilot.loadDebugTools()` first to load the tools");return k},context:{},get perfCounters(){return{featuresOn:void 0,featuresOff:void 0,killSwitchesOn:void 0,killSwitchesOff:void 0}},internal:{onDebugToolsLoaded:T}}),window.$copilot}var F=m(6277),H={ODB:61554},R={ODB:62043};function N(){return F.FeatureOverrides.isFeatureEnabled(R)}var B=!1;function j(e){var t,n=V("Error"),a=U();a.availability.customCopilotEAPCheckErrorType=e,null===(t=window.localStorage)||void 0===t||t.setItem(n,a.availability.customCopilotEAPCheckErrorType)}function V(e){return"UserInEAPGroup_".concat(e)}var z={ODB:61346};const G=[I,C,O,w],K=t._LogSource.create("SPFeedback.CampaignDefinitions");class W{}W.EDOG="edog",W.SPDF="spdf",W.PROD_BUBBLE="prodbubble",W.PROD="prod";var q=m(8660);const Q="SPFeedback",Y=o.officeFeedbackIntlBaseUrl,J="AppUsageTime",X="UpdateFlightsForOfficeFeedback";class Z{static _translateOfficeFeedbackPolicies(e){const t={...Z._defaultFeedbackPolicy};return e.forEach(e=>{if("common\\feedback"===e.key&&"Web"===e.platform)switch(e.settingId){case"office16;L_SendFeedback":t.policyAllowFeedback="1"===e.value;break;case"office16;L_SendSurvey":t.policyAllowSurvey="1"===e.value;break;case"office16;L_Screenshot":t.policyAllowScreenshot="1"===e.value;break;case"office16;L_EmailCollection":t.policyAllowContact="1"===e.value;break;case"office16;L_LogCollection":t.policyAllowContent="1"===e.value}}),t}static _getOCPSPolicies(t){if(Z._policies)return Promise.resolve(Z._policies);if(e._SPKillSwitch.isActivated("a2b5b55a-894a-47fe-9cee-7fc7e40ddf4b"))return new q.OCPSPolicyDataProvider(t).getPolicies().then(e=>{if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];if(t)return Z._policies=Z._translateOfficeFeedbackPolicies(t),Z._policies}return Z._defaultFeedbackPolicy}).catch(e=>(Z._floodgateLogError("getOCPSPolicies",!1),Z._defaultFeedbackPolicy));try{return new q.OCPSPolicyDataProvider(t).getPolicies().then(e=>{if(e.value&&e.value.length>0){const{policiesPayload:t}=e.value[0];if(t)return Z._policies=Z._translateOfficeFeedbackPolicies(t),Z._policies}return Z._defaultFeedbackPolicy}).catch(e=>(Z._floodgateLogError("getOCPSPolicies",!1),Z._defaultFeedbackPolicy))}catch(e){return Z._floodgateLogError("getOCPSPolicies",!1),Promise.resolve(Z._defaultFeedbackPolicy)}}static _getMonitor(e){const n=!A();return new t._AutoAlertableQosMonitor(e,t._AutoAlertableMonitorType.DynamicReliabilityQosMediumSev4,n)}static _handleDismiss(n,a){const i={campaignId:n},r=new t._LogEntry(Q,a?"Submitted":"Dismissed",t._LogType.Event,i);if(t._EngagementLogger.logEventWithLogEntry(r),a){const a=Z._spFloodgate?.getEngine();let r="Unknown";if(a){const o=a.launchedSurveys;if(!o)return r="NoSurveys",void Z._logNoBackupScore(r);let s;for(const a in o)if(o[a]?.surveyInfo?.data?.backEndIdentifier===n){if(s=o[a].rating?.selectedIndex,void 0!==s){e._SPKillSwitch.isActivated("df6b8fa1-9edf-4ec2-a859-75bd16f78810")||(i.rating=(++s).toString());const n=new t._LogEntry(Q,"Rated",t._LogType.Event,i);t._EngagementLogger.logEventWithLogEntry(n)}else r="NoSurveyResult",Z._logNoBackupScore(r);return}r="CampaignMismatch"}else r="NoEngine";Z._logNoBackupScore(r)}}static _logNoBackupScore(e){Z._getMonitor("SPFeedback.NoBackupScore").writeUnexpectedFailure(e)}static _setFloodgateWindowEvents(){this&&(window.addEventListener("focus",Z._resumeUsage),window.addEventListener("blur",Z._pauseUsage),window.addEventListener("unload",Z._stopFloodgate),E()&&document.addEventListener(X,this._handleFlightsForOfficeFeedback))}static _stopFloodgate(){Z._spFloodgate?(Z._pauseUsage(),Z._spFloodgate.stop()):Z._floodgateLogError("floodGateUndefinedAtStop",!1)}static _startFloodgateAsync(){return Z._spFloodgate||Z._floodgateLogError("floodGateUndefinedAtStart",!0),Z._spFloodgate.start().then(()=>Z._resumeUsage()).catch(e=>{Z._floodgateLogError("floodGateStartFailed",!0,e)})}static _pauseUsage(){Z._activityListener?(Z._activityListener.logActivityStopTime(J,new Date),Z._usageActivityName&&Z._activityListener.logActivityStopTime(Z._usageActivityName,new Date)):Z._floodgateLogError("floodGateUndefinedAtPause",!1),Z._spFloodgate&&Z._spFloodgate.stop()}static _resumeUsage(){Z._spFloodgate&&Z._spFloodgate.start().catch(()=>{}),Z._activityListener?(Z._activityListener.logActivity("AppResume"),Z._activityListener.logActivityStartTime(J),Z._usageActivityName&&Z._activityListener.logActivityStartTime(Z._usageActivityName)):Z._floodgateLogError("floodGateUndefinedAtResume",!1)}static _initializeStartFloodgateAsync(){let e;return E()||(e=Z._getMonitor("SPFeedback._initializeStartFloodgateAsync")),Z._spFloodgate.initialize().then(()=>Z._startFloodgateAsync()).then(()=>{t._TraceLogger.logVerbose(Z._logSource,"Initialized and started floodgate successfully"),E()||e.writeSuccess()}).catch(n=>{if(!E())throw t._TraceLogger.logError(Z._logSource,n,"_initializeStartFloodgateAsync"),e.writeExpectedFailure(void 0,n),n;Z._floodgateLogError("_initializeStartFloodgateAsync",!0,n)})}static _floodgateLogError(e,n,a){if(a=a||new Error(e),t._TraceLogger.logError(Z._logSource,a,e),n)throw Z._getMonitor(`SPFeedback.${e}`).writeUnexpectedFailure(void 0,a),a}static _getTheme(){let e,t;const n=window.__themeState__;return n?.theme&&(e=n.theme.themePrimary,t=n.theme.themeSecondary),{themePrimary:e||"#0078d4",themeSecondary:t||"#2b88d8"}}static get _buildNumber(){const e=S._Telemetry.buildNumber,t=/[0-9]{1,4}-?[0-9]{1,2}-?[0-9]{1,2}\.[0-9]{1,9}/;let n;return n=t.test(e)?e.match(t)[0].replace(/-/g,""):"0",n}static get _activityListener(){return Z._spFloodgate?.getEngine()?.getActivityListener()}static get _infoOnUIAppHost(){let t="Default";return e._BrowserUtilities.isTeamsWebViewHosted()||e._BrowserUtilities.isTeamsBrowserHosted()||e._BrowserUtilities.isEmbeddedInSite()?t="TeamsNonMobile":(e._BrowserUtilities.isTeamsAndroidHosted()||e._BrowserUtilities.isTeamsIOSHosted())&&(t="TeamsMobile"),t}startAppUsageAsync(e){return this._feedbackOptions=e,this.setupFloodgate().then(()=>{Z._activityListener&&Z._activityListener.logActivityStartTime(J)}).catch(e=>{t._TraceLogger.logError(Z._logSource,e,"SPFeedbackUtility.startAppUsageAsync")})}logActivityStartTime(e,n){this._feedbackOptions=n,Z._usageActivityName=e,this.setupFloodgate().then(e=>e.floodgate.start()).then(()=>{Z._activityListener&&Z._activityListener.logActivityStartTime(e)}).catch(e=>{t._TraceLogger.logError(Z._logSource,e,"SPFeedbackUtility.logActivityStartTime")})}logActivityStopTime(e){Z._usageActivityName=void 0,Z._activityListener&&Z._activityListener.logActivityStopTime(e),Z._spFloodgate&&Z._spFloodgate.stop()}setupFeedback(e){if(Z._isFeedbackInitialized)return Promise.resolve(Z._spFeedback);{const t=Z._getMonitor("SPFeedback.setupFeedback");return(0,o.loadFloodgateAsync)().then(async()=>(Z._spFeedback=window.OfficeBrowserFeedback,await this._initializeFeedback(e),t.writeSuccess(),Z._spFeedback)).catch(e=>{throw t.writeUnexpectedFailure("SetUpFail",e),e})}}setupFloodgate(){if(Z._isFloodgateInitialized)return Promise.resolve(Z._spFeedback);{const e=Z._getMonitor("SPFeedback.setupFloodgate");return(0,o.loadFloodgateAsync)().then(async()=>(Z._spFeedback=window.OfficeBrowserFeedback,Z._spFloodgate=Z._spFeedback.floodgate,await this._initializeFloodgate(),e.writeSuccess(),Z._spFeedback)).catch(t=>{throw e.writeUnexpectedFailure("SetUpFail",t),t})}}logActivityForFeedbackAsync(t){if(t&&(void 0===t.isDependentExpGroup||t?.isDependentExpGroup)){const n=Z._getMonitor("SPFeedback.logActivityForFeedbackAsync");if(!e._SPKillSwitch.isActivated("4ef779fb-e575-4122-a8f4-1a609eb4ceb8")&&this._isDisallowedforFloodgate()){const e=new Error("Disallowed for Floodgate");return n.writeExpectedFailure("FeedbackLogActivitySkipped",e),Promise.reject(e)}return this.setupFloodgate().then(()=>{Z._activityListener.logActivity(t.name),n.writeSuccess()}).catch(e=>(n.writeUnexpectedFailure("FeedbackLogActivityFail",e),Promise.reject(e)))}}onSurveyActivated(e,n){const a="SurveyActivated",i=`SPFeedback.${a}`,r=!A(),o=new t._AutoAlertableQosMonitor(i,t._AutoAlertableMonitorType.DynamicReliabilityQosMediumSev4,r),s=n?.getCampaignId(),c={alias:s};try{if(s){const e={campaignId:s},n=new t._LogEntry(Q,a,t._LogType.Event,e);t._EngagementLogger.logEventWithLogEntry(n),o?.writeSuccess(c)}else t._EngagementLogger.logEvent(i),o?.writeSuccess();window.addEventListener("keydown",this._handleKeyDown,!1)}catch(e){const t="onSurveyActivatedPreLog";o?.writeUnexpectedFailure("onSurveyActivated",e,c),Z._floodgateLogError(t,!1,e)}e.launch(),this._a11yService.a11yManager.alert(D.BI)}dispose(){window.removeEventListener("focus",Z._resumeUsage),window.removeEventListener("blur",Z._pauseUsage),window.removeEventListener("unload",Z._stopFloodgate),window.removeEventListener("keydown",this._handleKeyDown,!1),e._SPEventManager.instance.unregisterEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync),e._SPKillSwitch.isActivated("bc00a23b-8f5e-4929-9025-709cd3198957")?document.removeEventListener(X,Z._handleFlightsForOfficeFeedback):e._SPEventManager.instance.unregisterEvent(X,this,Z._handleFlightsForOfficeFeedback),Z._isFeedbackInitialized=!1,Z._isFloodgateInitialized=!1,this.isDisposed=!0}async _initializeFeedback(n){const a=await this._getFeedbackOptions();if(Z._isFeedbackInitialized||!a)return;const i=this._pageContext;await async function(n){try{const a=!e._SPKillSwitch.isActivated("5a3badec-fe8e-4903-a033-9636ac4ae139")&&function(e){var t,n,a=e.pageContextForEAPCheck,i=U();if(!F.KillSwitch.isActivated("87a98255-e313-4151-a344-a023c75eaadb","10/18/2024","isgulati - enable rcd check before enabling copilot")&&(null==a?void 0:a.IsRestrictedContentDiscoverabilityEnabled))return i.availability.isRCDEnabled=!0,!1;if(!F.KillSwitch.isActivated("99f050db-9dd7-4098-8772-9cee7e595faf","10/03/2024","isgulati - enable site check before enabling copilot")&&!function(e){var t=!0;return F.KillSwitch.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7")||F.FeatureOverrides.isFeatureEnabled(z)||!e||(t=0===(0,F.getVariantAndLogExposure)(90214,e)),U().availability.isSiteAllowed=t,t}(a))return i.availability.isSiteAllowed=!1,!1;if(F.FeatureOverrides.isFeatureEnabled(H))return!0;if(N()){if(i.availability.customCopilotEAPCheckEnabled=!0,!a||!a.aadUserId)return j(a?"MissingAADUserId":"MissingPageContext"),!1;i.availability.aadUserId=a.aadUserId;var r=(t=a.aadUserId,"true"===(null===(n=window.localStorage)||void 0===n?void 0:n.getItem(V(t))));return i.availability.isUserInEAP=r,function(e,t){if(!N()||B||!e||!e.aadUserId)return Promise.resolve();var n=V(e.aadUserId);return B=!0,m.e(927).then(m.bind(m,5589)).then(function(a){return a.isCurrentUserInEAPGroup(e,t).then(function(e){var t;null===(t=window.localStorage)||void 0===t||t.setItem(n,e.toString())})})}(a,e.getAuthToken).catch(function(){j("CacheRefreshError")}),r}return!1}({pageContextForEAPCheck:n?.legacyPageContext});let i=[...G];if(e._SPKillSwitch.isActivated("6ece1d9b-9fbf-4cae-b3e1-b14c6cc0c9fa")||(i=i.filter(e=>e!==I)),a){const e=await async function(){return await m.e(435).then(m.bind(m,7993)).then(e=>e.customCopilotCampaignDefinitions).catch(e=>(t._TraceLogger.logError(K,e,"FailedCustomCopilotCampaignDefinitions"),[]))}();i=i.concat(e)}for(const e of i)void 0===e.PrimaryPriority&&(e.PrimaryPriority=3,t._TraceLogger.logVerbose(K,`Ensured ${e.CampaignId} PrimaryPriority is 3`));window.localStorage?window.localStorage.setItem("obf-CampaignDefinitions",JSON.stringify(i)):t._TraceLogger.logVerbose(K,"LocalStorageNotAvailable")}catch(e){new t._QosMonitor("SPFeedback.CampaignDefinitions").writeUnexpectedFailure("StorageFailure",e)}}(i);const r=e.Environment.type===e.EnvironmentType.Local?1:0,s=Z._getTheme(),c=i.aadInfo?.tenantId.toString(),d=`a:${i.aadInfo?.userId.toString()}`,l={feedbackTenant:window.location.hostname};l.appData=JSON.stringify({UiHost:Z._infoOnUIAppHost});const u=Z._buildNumber,{legacyPageContext:f}=i;let p=n;p||(p=await Z._getOCPSPolicies(this._serviceScope));const _=[];if(!e._SPKillSwitch.isActivated("b0c1f2d3-4e8a-4b5c-9f6d-7e8f9a0b1c2d")){const e=new URL(Y).origin;e&&_.push(e.split(".").splice(-2).join("."))}Z._spFeedback.initOptions={appId:a.appId,applicationGroup:l,build:u,environment:r,intlFilename:"officebrowserfeedbackstrings.js",intlUrl:Y,locale:i.cultureInfo.currentUICultureName,onError:e=>{Z._getMonitor("SPFeedback.initOnError").writeUnexpectedFailure("SDKErrorHandler",new Error(e))},primaryColour:s.themePrimary,sessionId:i.site.correlationId.toString(),sendFeedbackPolicyValue:p.policyAllowSurvey?1:0,screenshot:p.policyAllowScreenshot,secondaryColour:s.themeSecondary,stylesUrl:o.officeFeedbackCssUrl,telemetryGroup:{audienceGroup:this._pageEnvironment,deviceType:navigator.userAgent,loggableUserId:d,officeUILang:i.legacyPageContext.currentLanguage,platform:navigator.platform,tenantId:c,featureArea:a.featureArea},showEmailAddress:p.policyAllowContact,userEmail:i.user.email,webGroup:{browser:navigator.appCodeName,browserVersion:navigator.appVersion},bugForm:a.bugForm,isShowThanks:a.isShowThanks,telemetrySink:(0,o.getTelemetrySink)({featureArea:a.featureArea,legacyPageContext:f,pageContext:i,version:u}),allowedDomains:_},Z._spFeedback.initOptions.telemetryGroup.flights=Array.from(Z._flightsForTelemetryGroup).join(","),Z._isFeedbackInitialized=!0,e._SPEventManager.instance.registerEvent("recordSurveyEvent",this,this.logActivityForFeedbackAsync)}async _initializeFloodgate(){if(await this._initializeFeedback(),!Z._isFloodgateInitialized){const e={enabled:!1,ecsClient:void 0},n={enabled:!1,theme:"M365Light",cdnStringConfig:{uiStringsCdnEnabled:!0}},a=Z._getMonitor("SPFeedback.dynamicCampaign"),i=new Map([["agent","ChillSharePoint"]]);try{const r=new v({appName:"SharePoint",appVersion:Z._buildNumber,language:this._pageContext.cultureInfo.currentUICultureName,filters:i,localStorageProvider:Z._spFloodgate.getStorageProvider()});await r.start(),e.ecsClient=r,r.telemetryEvents.subscribe((e,n)=>{t._TraceLogger.logVerbose(Z._logSource,`Dynamic Campaign Telemetry event '${e}' with details: ${n}`)}),e.enabled=!0,n.enabled=!0,a.writeSuccess()}catch(e){a.writeUnexpectedFailure("FailedToStartOrSubscribe",e),t._TraceLogger.logError(Z._logSource,e)}Z._spFloodgate.initOptions={onSurveyActivatedCallback:this,onDismiss:Z._handleDismiss,dynamicCampaignConfig:e,dynamicUxConfig:n,governanceServiceEnabled:!0},await Z._getOCPSPolicies(this._serviceScope).then(e=>{Z._spFloodgate.initOptions.surveyEnabled=e.policyAllowSurvey,Z._spFloodgate.initOptions.showEmailAddress=e.policyAllowContact}).catch(e=>{Z._floodgateLogError("_initializeFloodgate",!1,e)}),Z._setFloodgateWindowEvents(),Z._initializeStartFloodgateAsync().then(()=>{Z._isFloodgateInitialized=!0})}}_handleKeyDown(e){if(e.altKey&&e.which===a.KeyCodes.pageDown){const e=document.getElementById("obf-TPromptContainer")||void 0;e?this._a11yService.a11yManager.focusTo(e):Z._floodgateLogError("toastContainerNotFound",!1)}}get _pageEnvironment(){const t=this._pageContext;let n="";switch(n=e._SPKillSwitch.isActivated("49fc95f5-1bfc-4136-978d-06615413d636")?t.legacyPageContext&&t.legacyPageContext.env||"":t.legacyPageContext&&t.legacyPageContext.env2||"",n.toLowerCase()){case W.EDOG:case W.PROD_BUBBLE:case W.SPDF:return"Dogfood";default:return"Production"}}async _getFeedbackOptions(){return this._feedbackOptions||(this._feedbackOptions=await m.e(706).then(m.bind(m,4824)).then(e=>e.getFeedbackOptions(this._pageContext,this._serviceScope))),this._feedbackOptions}_isDisallowedforFloodgate(){const e=this._pageContext?.legacyPageContext?.cloudType?.toLowerCase()||"prod";return"dod"===e||"gcc"===e||"gcch"===e||"ag08"===e||"ag09"===e}constructor(t){this.instanceId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.componentId="f709c1cd-2daf-4093-a99a-a167b55ebc23",this.isDisposed=!1,t.whenFinished(()=>{this._serviceScope=t,this._pageContext=t.consume(n.PageContext.serviceKey),this._a11yService=t.consume(r.serviceKey)}),E()||e._SPEventManager.instance.registerEvent(X,this,Z._handleFlightsForOfficeFeedback)}}Z.feedbackServiceName="sp-feedback:SPFeedback",Z._defaultFeedbackPolicy={policyAllowFeedback:!0,policyAllowSurvey:!0,policyAllowScreenshot:!1,policyAllowContact:!1,policyAllowContent:!1},Z._flightsForTelemetryGroup=new Set,Z._logSource=t._LogSource.create(Q),Z._isFeedbackInitialized=!1,Z._isFloodgateInitialized=!1,Z._handleFlightsForOfficeFeedback=e=>{const t=e;if(t&&t.detail&&t.detail.flights){let e=!1;const n=t=>{const n=t.split("_"),a=2===n.length?n[1]:void 0;let i;void 0!==a&&(i="0"===a?"1":"0",i=n[0]+"_"+i),i&&Z._flightsForTelemetryGroup.has(i)&&(Z._flightsForTelemetryGroup.delete(i),e=!0)};if("string"==typeof t.detail.flights){const a=t.detail.flights;n(a),Z._flightsForTelemetryGroup.has(a)||(Z._flightsForTelemetryGroup.add(a),e=!0)}else t.detail.flights.forEach(t=>{n(t),Z._flightsForTelemetryGroup.has(t)||(Z._flightsForTelemetryGroup.add(t),e=!0)});e&&Z._isFloodgateInitialized&&(Z._isFloodgateInitialized=!1,Z._stopFloodgate(),Z._spFeedback.initOptions.telemetryGroup.flights=Array.from(Z._flightsForTelemetryGroup).join(","),Z._startFloodgateAsync().then(()=>{Z._isFloodgateInitialized=!0}))}};const $=e.ServiceKey.create(Z.feedbackServiceName,Z)})(),y})())})();